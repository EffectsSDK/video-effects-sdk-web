/*! For license information please see tsvb-web.js.LICENSE.txt */
var __webpack_modules__={9452:e=>{var t=Object.prototype.hasOwnProperty,r="~";function n(){}function i(e,t,r){this.fn=e,this.context=t,this.once=r||!1}function o(e,t,n,o,a){if("function"!=typeof n)throw new TypeError("The listener must be a function");var s=new i(n,o||e,a),u=r?r+t:t;return e._events[u]?e._events[u].fn?e._events[u]=[e._events[u],s]:e._events[u].push(s):(e._events[u]=s,e._eventsCount++),e}function a(e,t){0==--e._eventsCount?e._events=new n:delete e._events[t]}function s(){this._events=new n,this._eventsCount=0}Object.create&&(n.prototype=Object.create(null),(new n).__proto__||(r=!1)),s.prototype.eventNames=function(){var e,n,i=[];if(0===this._eventsCount)return i;for(n in e=this._events)t.call(e,n)&&i.push(r?n.slice(1):n);return Object.getOwnPropertySymbols?i.concat(Object.getOwnPropertySymbols(e)):i},s.prototype.listeners=function(e){var t=r?r+e:e,n=this._events[t];if(!n)return[];if(n.fn)return[n.fn];for(var i=0,o=n.length,a=new Array(o);i<o;i++)a[i]=n[i].fn;return a},s.prototype.listenerCount=function(e){var t=r?r+e:e,n=this._events[t];return n?n.fn?1:n.length:0},s.prototype.emit=function(e,t,n,i,o,a){var s=r?r+e:e;if(!this._events[s])return!1;var u,l,h=this._events[s],c=arguments.length;if(h.fn){switch(h.once&&this.removeListener(e,h.fn,void 0,!0),c){case 1:return h.fn.call(h.context),!0;case 2:return h.fn.call(h.context,t),!0;case 3:return h.fn.call(h.context,t,n),!0;case 4:return h.fn.call(h.context,t,n,i),!0;case 5:return h.fn.call(h.context,t,n,i,o),!0;case 6:return h.fn.call(h.context,t,n,i,o,a),!0}for(l=1,u=new Array(c-1);l<c;l++)u[l-1]=arguments[l];h.fn.apply(h.context,u)}else{var f,d=h.length;for(l=0;l<d;l++)switch(h[l].once&&this.removeListener(e,h[l].fn,void 0,!0),c){case 1:h[l].fn.call(h[l].context);break;case 2:h[l].fn.call(h[l].context,t);break;case 3:h[l].fn.call(h[l].context,t,n);break;case 4:h[l].fn.call(h[l].context,t,n,i);break;default:if(!u)for(f=1,u=new Array(c-1);f<c;f++)u[f-1]=arguments[f];h[l].fn.apply(h[l].context,u)}}return!0},s.prototype.on=function(e,t,r){return o(this,e,t,r,!1)},s.prototype.once=function(e,t,r){return o(this,e,t,r,!0)},s.prototype.removeListener=function(e,t,n,i){var o=r?r+e:e;if(!this._events[o])return this;if(!t)return a(this,o),this;var s=this._events[o];if(s.fn)s.fn!==t||i&&!s.once||n&&s.context!==n||a(this,o);else{for(var u=0,l=[],h=s.length;u<h;u++)(s[u].fn!==t||i&&!s[u].once||n&&s[u].context!==n)&&l.push(s[u]);l.length?this._events[o]=1===l.length?l[0]:l:a(this,o)}return this},s.prototype.removeAllListeners=function(e){var t;return e?(t=r?r+e:e,this._events[t]&&a(this,t)):(this._events=new n,this._eventsCount=0),this},s.prototype.off=s.prototype.removeListener,s.prototype.addListener=s.prototype.on,s.prefixed=r,s.EventEmitter=s,e.exports=s},3161:function(e){var t;t=function(){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={exports:{},id:n,loaded:!1};return e[n].call(i.exports,i,i.exports,r),i.loaded=!0,i.exports}return r.m=e,r.c=t,r.p="",r(0)}([function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.isNotPNG=function(e){return e===s},t.isNotAPNG=function(e){return e===u},t.default=function(e){var t=new Uint8Array(e);if(Array.prototype.some.call(l,(function(e,r){return e!==t[r]})))return s;var r=!1;if(h(t,(function(e){return!(r="acTL"===e)})),!r)return u;var n=[],i=[],o=null,c=null,y=0,m=new a.APNG;if(h(t,(function(e,t,r,s){var u=new DataView(t.buffer);switch(e){case"IHDR":o=t.subarray(r+8,r+8+s),m.width=u.getUint32(r+8),m.height=u.getUint32(r+12);break;case"acTL":m.numPlays=u.getUint32(r+8+4);break;case"fcTL":c&&(m.frames.push(c),y++),(c=new a.Frame).width=u.getUint32(r+8+4),c.height=u.getUint32(r+8+8),c.left=u.getUint32(r+8+12),c.top=u.getUint32(r+8+16);var l=u.getUint16(r+8+20),h=u.getUint16(r+8+22);0===h&&(h=100),c.delay=1e3*l/h,c.delay<=10&&(c.delay=100),m.playTime+=c.delay,c.disposeOp=u.getUint8(r+8+24),c.blendOp=u.getUint8(r+8+25),c.dataParts=[],0===y&&2===c.disposeOp&&(c.disposeOp=1);break;case"fdAT":c&&c.dataParts.push(t.subarray(r+8+4,r+8+s));break;case"IDAT":c&&c.dataParts.push(t.subarray(r+8,r+8+s));break;case"IEND":i.push(f(t,r,12+s));break;default:n.push(f(t,r,12+s))}})),c&&m.frames.push(c),0==m.frames.length)return u;var g=new Blob(n),w=new Blob(i);return m.frames.forEach((function(e){var t=[];t.push(l),o.set(p(e.width),0),o.set(p(e.height),4),t.push(d("IHDR",o)),t.push(g),e.dataParts.forEach((function(e){return t.push(d("IDAT",e))})),t.push(w),e.imageData=new Blob(t,{type:"image/png"}),delete e.dataParts,t=null})),m};var n,i=r(1),o=(n=i)&&n.__esModule?n:{default:n},a=r(2),s=new Error("Not a PNG"),u=new Error("Not an animated PNG"),l=new Uint8Array([137,80,78,71,13,10,26,10]);function h(e,t){var r=new DataView(e.buffer),n=8,i=void 0,o=void 0,a=void 0;do{o=r.getUint32(n),a=t(i=c(e,n+4,4),e,n,o),n+=12+o}while(!1!==a&&"IEND"!=i&&n<e.length)}function c(e,t,r){var n=Array.prototype.slice.call(e.subarray(t,t+r));return String.fromCharCode.apply(String,n)}function f(e,t,r){var n=new Uint8Array(r);return n.set(e.subarray(t,t+r)),n}var d=function(e,t){var r=e.length+t.length,n=new Uint8Array(r+8),i=new DataView(n.buffer);i.setUint32(0,t.length),n.set(function(e){for(var t=new Uint8Array(e.length),r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t}(e),4),n.set(t,8);var a=(0,o.default)(n,4,r);return i.setUint32(r+4,a),n},p=function(e){return new Uint8Array([e>>>24&255,e>>>16&255,e>>>8&255,255&e])}},function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=-1,i=t,o=t+(arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.length-t);i<o;i++)n=n>>>8^r[255&(n^e[i])];return~n};for(var r=new Uint32Array(256),n=0;n<256;n++){for(var i=n,o=0;o<8;o++)i=1&i?3988292384^i>>>1:i>>>1;r[n]=i}},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.Frame=t.APNG=void 0;var n,i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=r(3),a=(n=o)&&n.__esModule?n:{default:n};function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}t.APNG=function(){function e(){s(this,e),this.width=0,this.height=0,this.numPlays=0,this.playTime=0,this.frames=[]}return i(e,[{key:"createImages",value:function(){return Promise.all(this.frames.map((function(e){return e.createImage()})))}},{key:"getPlayer",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.createImages().then((function(){return new a.default(t,e,r)}))}}]),e}(),t.Frame=function(){function e(){s(this,e),this.left=0,this.top=0,this.width=0,this.height=0,this.delay=0,this.disposeOp=0,this.blendOp=0,this.imageData=null,this.imageElement=null}return i(e,[{key:"createImage",value:function(){var e=this;return this.imageElement?Promise.resolve():new Promise((function(t,r){var n=URL.createObjectURL(e.imageData);e.imageElement=document.createElement("img"),e.imageElement.onload=function(){URL.revokeObjectURL(n),t()},e.imageElement.onerror=function(){URL.revokeObjectURL(n),e.imageElement=null,r(new Error("Image creation error"))},e.imageElement.src=n}))}}]),e}()},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n,i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=r(4),a=function(e){function t(e,r,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var i=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return i.playbackRate=1,i._currentFrameNumber=0,i._ended=!1,i._paused=!0,i._numPlays=0,i._rafId=null,i._apng=e,i.context=r,i.stop(),n&&i.play(),i}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),i(t,[{key:"renderNextFrame",value:function(){this._currentFrameNumber=(this._currentFrameNumber+1)%this._apng.frames.length,this._currentFrameNumber===this._apng.frames.length-1&&(this._numPlays++,0!==this._apng.numPlays&&this._numPlays>=this._apng.numPlays&&(this._ended=!0,this._paused=!0)),this._prevFrame&&1==this._prevFrame.disposeOp?this.context.clearRect(this._prevFrame.left,this._prevFrame.top,this._prevFrame.width,this._prevFrame.height):this._prevFrame&&2==this._prevFrame.disposeOp&&this.context.putImageData(this._prevFrameData,this._prevFrame.left,this._prevFrame.top);var e=this.currentFrame;this._prevFrame=e,this._prevFrameData=null,2==e.disposeOp&&(this._prevFrameData=this.context.getImageData(e.left,e.top,e.width,e.height)),0==e.blendOp&&this.context.clearRect(e.left,e.top,e.width,e.height),this.context.drawImage(e.imageElement,e.left,e.top),this.emit("frame",this._currentFrameNumber),this._ended&&this.emit("end")}},{key:"play",value:function(){var e=this;this._rafId&&cancelAnimationFrame(this._rafId),this.emit("play"),this._ended&&this.stop(),this._paused=!1;var t=performance.now()+this.currentFrame.delay/this.playbackRate;this._rafId=requestAnimationFrame((function r(n){if(!e._ended&&!e._paused){if(n>=t){for(;n-t>=e._apng.playTime/e.playbackRate;)t+=e._apng.playTime/e.playbackRate,e._numPlays++;do{e.renderNextFrame(),t+=e.currentFrame.delay/e.playbackRate}while(!e._ended&&!e._paused&&n>t)}e._rafId=requestAnimationFrame(r)}}))}},{key:"pause",value:function(){this._paused||(this._rafId&&(cancelAnimationFrame(this._rafId),this._rafId=null),this.emit("pause"),this._paused=!0)}},{key:"stop",value:function(){this._rafId&&(cancelAnimationFrame(this._rafId),this._rafId=null),this.emit("stop"),this._numPlays=0,this._ended=!1,this._paused=!0,this._currentFrameNumber=-1,this.context.clearRect(0,0,this._apng.width,this._apng.height),this.renderNextFrame()}},{key:"currentFrameNumber",get:function(){return this._currentFrameNumber}},{key:"currentFrame",get:function(){return this._apng.frames[this._currentFrameNumber]}},{key:"paused",get:function(){return this._paused}},{key:"ended",get:function(){return this._ended}}]),t}(((n=o)&&n.__esModule?n:{default:n}).default);t.default=a},function(e,t){function r(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function n(e){return"function"==typeof e}function i(e){return"object"==typeof e&&null!==e}function o(e){return void 0===e}e.exports=r,r.EventEmitter=r,r.prototype._events=void 0,r.prototype._maxListeners=void 0,r.defaultMaxListeners=10,r.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},r.prototype.emit=function(e){var t,r,a,s,u,l;if(this._events||(this._events={}),"error"===e&&(!this._events.error||i(this._events.error)&&!this._events.error.length)){if((t=arguments[1])instanceof Error)throw t;var h=new Error('Uncaught, unspecified "error" event. ('+t+")");throw h.context=t,h}if(o(r=this._events[e]))return!1;if(n(r))switch(arguments.length){case 1:r.call(this);break;case 2:r.call(this,arguments[1]);break;case 3:r.call(this,arguments[1],arguments[2]);break;default:s=Array.prototype.slice.call(arguments,1),r.apply(this,s)}else if(i(r))for(s=Array.prototype.slice.call(arguments,1),a=(l=r.slice()).length,u=0;u<a;u++)l[u].apply(this,s);return!0},r.prototype.addListener=function(e,t){var a;if(!n(t))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,n(t.listener)?t.listener:t),this._events[e]?i(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,i(this._events[e])&&!this._events[e].warned&&(a=o(this._maxListeners)?r.defaultMaxListeners:this._maxListeners)&&a>0&&this._events[e].length>a&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace()),this},r.prototype.on=r.prototype.addListener,r.prototype.once=function(e,t){if(!n(t))throw TypeError("listener must be a function");var r=!1;function i(){this.removeListener(e,i),r||(r=!0,t.apply(this,arguments))}return i.listener=t,this.on(e,i),this},r.prototype.removeListener=function(e,t){var r,o,a,s;if(!n(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(a=(r=this._events[e]).length,o=-1,r===t||n(r.listener)&&r.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(i(r)){for(s=a;s-- >0;)if(r[s]===t||r[s].listener&&r[s].listener===t){o=s;break}if(o<0)return this;1===r.length?(r.length=0,delete this._events[e]):r.splice(o,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},r.prototype.removeAllListeners=function(e){var t,r;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(n(r=this._events[e]))this.removeListener(e,r);else if(r)for(;r.length;)this.removeListener(e,r[r.length-1]);return delete this._events[e],this},r.prototype.listeners=function(e){return this._events&&this._events[e]?n(this._events[e])?[this._events[e]]:this._events[e].slice():[]},r.prototype.listenerCount=function(e){if(this._events){var t=this._events[e];if(n(t))return 1;if(t)return t.length}return 0},r.listenerCount=function(e,t){return e.listenerCount(t)}}])},e.exports=t()},2505:(e,t,r)=>{e.exports=r(8015)},5592:(e,t,r)=>{var n=r(9516),i=r(7522),o=r(3948),a=r(9106),s=r(9615),u=r(2012),l=r(4202),h=r(7763),c=r(4896),f=r(1928);e.exports=function(e){return new Promise((function(t,r){var d,p=e.data,y=e.headers,m=e.responseType;function g(){e.cancelToken&&e.cancelToken.unsubscribe(d),e.signal&&e.signal.removeEventListener("abort",d)}n.isFormData(p)&&delete y["Content-Type"];var w=new XMLHttpRequest;if(e.auth){var v=e.auth.username||"",b=e.auth.password?unescape(encodeURIComponent(e.auth.password)):"";y.Authorization="Basic "+btoa(v+":"+b)}var x=s(e.baseURL,e.url);function _(){if(w){var n="getAllResponseHeaders"in w?u(w.getAllResponseHeaders()):null,o={data:m&&"text"!==m&&"json"!==m?w.response:w.responseText,status:w.status,statusText:w.statusText,headers:n,config:e,request:w};i((function(e){t(e),g()}),(function(e){r(e),g()}),o),w=null}}if(w.open(e.method.toUpperCase(),a(x,e.params,e.paramsSerializer),!0),w.timeout=e.timeout,"onloadend"in w?w.onloadend=_:w.onreadystatechange=function(){w&&4===w.readyState&&(0!==w.status||w.responseURL&&0===w.responseURL.indexOf("file:"))&&setTimeout(_)},w.onabort=function(){w&&(r(h("Request aborted",e,"ECONNABORTED",w)),w=null)},w.onerror=function(){r(h("Network Error",e,null,w)),w=null},w.ontimeout=function(){var t=e.timeout?"timeout of "+e.timeout+"ms exceeded":"timeout exceeded",n=e.transitional||c;e.timeoutErrorMessage&&(t=e.timeoutErrorMessage),r(h(t,e,n.clarifyTimeoutError?"ETIMEDOUT":"ECONNABORTED",w)),w=null},n.isStandardBrowserEnv()){var S=(e.withCredentials||l(x))&&e.xsrfCookieName?o.read(e.xsrfCookieName):void 0;S&&(y[e.xsrfHeaderName]=S)}"setRequestHeader"in w&&n.forEach(y,(function(e,t){void 0===p&&"content-type"===t.toLowerCase()?delete y[t]:w.setRequestHeader(t,e)})),n.isUndefined(e.withCredentials)||(w.withCredentials=!!e.withCredentials),m&&"json"!==m&&(w.responseType=e.responseType),"function"==typeof e.onDownloadProgress&&w.addEventListener("progress",e.onDownloadProgress),"function"==typeof e.onUploadProgress&&w.upload&&w.upload.addEventListener("progress",e.onUploadProgress),(e.cancelToken||e.signal)&&(d=function(e){w&&(r(!e||e&&e.type?new f("canceled"):e),w.abort(),w=null)},e.cancelToken&&e.cancelToken.subscribe(d),e.signal&&(e.signal.aborted?d():e.signal.addEventListener("abort",d))),p||(p=null),w.send(p)}))}},8015:(e,t,r)=>{var n=r(9516),i=r(9012),o=r(5155),a=r(5343);var s=function e(t){var r=new o(t),s=i(o.prototype.request,r);return n.extend(s,o.prototype,r),n.extend(s,r),s.create=function(r){return e(a(t,r))},s}(r(7412));s.Axios=o,s.Cancel=r(1928),s.CancelToken=r(3191),s.isCancel=r(3864),s.VERSION=r(9641).version,s.all=function(e){return Promise.all(e)},s.spread=r(7980),s.isAxiosError=r(5019),e.exports=s,e.exports.default=s},1928:e=>{function t(e){this.message=e}t.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},t.prototype.__CANCEL__=!0,e.exports=t},3191:(e,t,r)=>{var n=r(1928);function i(e){if("function"!=typeof e)throw new TypeError("executor must be a function.");var t;this.promise=new Promise((function(e){t=e}));var r=this;this.promise.then((function(e){if(r._listeners){var t,n=r._listeners.length;for(t=0;t<n;t++)r._listeners[t](e);r._listeners=null}})),this.promise.then=function(e){var t,n=new Promise((function(e){r.subscribe(e),t=e})).then(e);return n.cancel=function(){r.unsubscribe(t)},n},e((function(e){r.reason||(r.reason=new n(e),t(r.reason))}))}i.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},i.prototype.subscribe=function(e){this.reason?e(this.reason):this._listeners?this._listeners.push(e):this._listeners=[e]},i.prototype.unsubscribe=function(e){if(this._listeners){var t=this._listeners.indexOf(e);-1!==t&&this._listeners.splice(t,1)}},i.source=function(){var e;return{token:new i((function(t){e=t})),cancel:e}},e.exports=i},3864:e=>{e.exports=function(e){return!(!e||!e.__CANCEL__)}},5155:(e,t,r)=>{var n=r(9516),i=r(9106),o=r(3471),a=r(4490),s=r(5343),u=r(4841),l=u.validators;function h(e){this.defaults=e,this.interceptors={request:new o,response:new o}}h.prototype.request=function(e,t){"string"==typeof e?(t=t||{}).url=e:t=e||{},(t=s(this.defaults,t)).method?t.method=t.method.toLowerCase():this.defaults.method?t.method=this.defaults.method.toLowerCase():t.method="get";var r=t.transitional;void 0!==r&&u.assertOptions(r,{silentJSONParsing:l.transitional(l.boolean),forcedJSONParsing:l.transitional(l.boolean),clarifyTimeoutError:l.transitional(l.boolean)},!1);var n=[],i=!0;this.interceptors.request.forEach((function(e){"function"==typeof e.runWhen&&!1===e.runWhen(t)||(i=i&&e.synchronous,n.unshift(e.fulfilled,e.rejected))}));var o,h=[];if(this.interceptors.response.forEach((function(e){h.push(e.fulfilled,e.rejected)})),!i){var c=[a,void 0];for(Array.prototype.unshift.apply(c,n),c=c.concat(h),o=Promise.resolve(t);c.length;)o=o.then(c.shift(),c.shift());return o}for(var f=t;n.length;){var d=n.shift(),p=n.shift();try{f=d(f)}catch(e){p(e);break}}try{o=a(f)}catch(e){return Promise.reject(e)}for(;h.length;)o=o.then(h.shift(),h.shift());return o},h.prototype.getUri=function(e){return e=s(this.defaults,e),i(e.url,e.params,e.paramsSerializer).replace(/^\?/,"")},n.forEach(["delete","get","head","options"],(function(e){h.prototype[e]=function(t,r){return this.request(s(r||{},{method:e,url:t,data:(r||{}).data}))}})),n.forEach(["post","put","patch"],(function(e){h.prototype[e]=function(t,r,n){return this.request(s(n||{},{method:e,url:t,data:r}))}})),e.exports=h},3471:(e,t,r)=>{var n=r(9516);function i(){this.handlers=[]}i.prototype.use=function(e,t,r){return this.handlers.push({fulfilled:e,rejected:t,synchronous:!!r&&r.synchronous,runWhen:r?r.runWhen:null}),this.handlers.length-1},i.prototype.eject=function(e){this.handlers[e]&&(this.handlers[e]=null)},i.prototype.forEach=function(e){n.forEach(this.handlers,(function(t){null!==t&&e(t)}))},e.exports=i},9615:(e,t,r)=>{var n=r(9137),i=r(4680);e.exports=function(e,t){return e&&!n(t)?i(e,t):t}},7763:(e,t,r)=>{var n=r(5449);e.exports=function(e,t,r,i,o){var a=new Error(e);return n(a,t,r,i,o)}},4490:(e,t,r)=>{var n=r(9516),i=r(2881),o=r(3864),a=r(7412),s=r(1928);function u(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new s("canceled")}e.exports=function(e){return u(e),e.headers=e.headers||{},e.data=i.call(e,e.data,e.headers,e.transformRequest),e.headers=n.merge(e.headers.common||{},e.headers[e.method]||{},e.headers),n.forEach(["delete","get","head","post","put","patch","common"],(function(t){delete e.headers[t]})),(e.adapter||a.adapter)(e).then((function(t){return u(e),t.data=i.call(e,t.data,t.headers,e.transformResponse),t}),(function(t){return o(t)||(u(e),t&&t.response&&(t.response.data=i.call(e,t.response.data,t.response.headers,e.transformResponse))),Promise.reject(t)}))}},5449:e=>{e.exports=function(e,t,r,n,i){return e.config=t,r&&(e.code=r),e.request=n,e.response=i,e.isAxiosError=!0,e.toJSON=function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code,status:this.response&&this.response.status?this.response.status:null}},e}},5343:(e,t,r)=>{var n=r(9516);e.exports=function(e,t){t=t||{};var r={};function i(e,t){return n.isPlainObject(e)&&n.isPlainObject(t)?n.merge(e,t):n.isPlainObject(t)?n.merge({},t):n.isArray(t)?t.slice():t}function o(r){return n.isUndefined(t[r])?n.isUndefined(e[r])?void 0:i(void 0,e[r]):i(e[r],t[r])}function a(e){if(!n.isUndefined(t[e]))return i(void 0,t[e])}function s(r){return n.isUndefined(t[r])?n.isUndefined(e[r])?void 0:i(void 0,e[r]):i(void 0,t[r])}function u(r){return r in t?i(e[r],t[r]):r in e?i(void 0,e[r]):void 0}var l={url:a,method:a,data:a,baseURL:s,transformRequest:s,transformResponse:s,paramsSerializer:s,timeout:s,timeoutMessage:s,withCredentials:s,adapter:s,responseType:s,xsrfCookieName:s,xsrfHeaderName:s,onUploadProgress:s,onDownloadProgress:s,decompress:s,maxContentLength:s,maxBodyLength:s,transport:s,httpAgent:s,httpsAgent:s,cancelToken:s,socketPath:s,responseEncoding:s,validateStatus:u};return n.forEach(Object.keys(e).concat(Object.keys(t)),(function(e){var t=l[e]||o,i=t(e);n.isUndefined(i)&&t!==u||(r[e]=i)})),r}},7522:(e,t,r)=>{var n=r(7763);e.exports=function(e,t,r){var i=r.config.validateStatus;r.status&&i&&!i(r.status)?t(n("Request failed with status code "+r.status,r.config,null,r.request,r)):e(r)}},2881:(e,t,r)=>{var n=r(9516),i=r(7412);e.exports=function(e,t,r){var o=this||i;return n.forEach(r,(function(r){e=r.call(o,e,t)})),e}},7412:(e,t,r)=>{var n=r(5606),i=r(9516),o=r(7018),a=r(5449),s=r(4896),u={"Content-Type":"application/x-www-form-urlencoded"};function l(e,t){!i.isUndefined(e)&&i.isUndefined(e["Content-Type"])&&(e["Content-Type"]=t)}var h,c={transitional:s,adapter:(("undefined"!=typeof XMLHttpRequest||void 0!==n&&"[object process]"===Object.prototype.toString.call(n))&&(h=r(5592)),h),transformRequest:[function(e,t){return o(t,"Accept"),o(t,"Content-Type"),i.isFormData(e)||i.isArrayBuffer(e)||i.isBuffer(e)||i.isStream(e)||i.isFile(e)||i.isBlob(e)?e:i.isArrayBufferView(e)?e.buffer:i.isURLSearchParams(e)?(l(t,"application/x-www-form-urlencoded;charset=utf-8"),e.toString()):i.isObject(e)||t&&"application/json"===t["Content-Type"]?(l(t,"application/json"),function(e,t,r){if(i.isString(e))try{return(t||JSON.parse)(e),i.trim(e)}catch(e){if("SyntaxError"!==e.name)throw e}return(r||JSON.stringify)(e)}(e)):e}],transformResponse:[function(e){var t=this.transitional||c.transitional,r=t&&t.silentJSONParsing,n=t&&t.forcedJSONParsing,o=!r&&"json"===this.responseType;if(o||n&&i.isString(e)&&e.length)try{return JSON.parse(e)}catch(e){if(o){if("SyntaxError"===e.name)throw a(e,this,"E_JSON_PARSE");throw e}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};i.forEach(["delete","get","head"],(function(e){c.headers[e]={}})),i.forEach(["post","put","patch"],(function(e){c.headers[e]=i.merge(u)})),e.exports=c},4896:e=>{e.exports={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1}},9641:e=>{e.exports={version:"0.26.1"}},9012:e=>{e.exports=function(e,t){return function(){for(var r=new Array(arguments.length),n=0;n<r.length;n++)r[n]=arguments[n];return e.apply(t,r)}}},9106:(e,t,r)=>{var n=r(9516);function i(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}e.exports=function(e,t,r){if(!t)return e;var o;if(r)o=r(t);else if(n.isURLSearchParams(t))o=t.toString();else{var a=[];n.forEach(t,(function(e,t){null!=e&&(n.isArray(e)?t+="[]":e=[e],n.forEach(e,(function(e){n.isDate(e)?e=e.toISOString():n.isObject(e)&&(e=JSON.stringify(e)),a.push(i(t)+"="+i(e))})))})),o=a.join("&")}if(o){var s=e.indexOf("#");-1!==s&&(e=e.slice(0,s)),e+=(-1===e.indexOf("?")?"?":"&")+o}return e}},4680:e=>{e.exports=function(e,t){return t?e.replace(/\/+$/,"")+"/"+t.replace(/^\/+/,""):e}},3948:(e,t,r)=>{var n=r(9516);e.exports=n.isStandardBrowserEnv()?{write:function(e,t,r,i,o,a){var s=[];s.push(e+"="+encodeURIComponent(t)),n.isNumber(r)&&s.push("expires="+new Date(r).toGMTString()),n.isString(i)&&s.push("path="+i),n.isString(o)&&s.push("domain="+o),!0===a&&s.push("secure"),document.cookie=s.join("; ")},read:function(e){var t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove:function(e){this.write(e,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}}},9137:e=>{e.exports=function(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}},5019:(e,t,r)=>{var n=r(9516);e.exports=function(e){return n.isObject(e)&&!0===e.isAxiosError}},4202:(e,t,r)=>{var n=r(9516);e.exports=n.isStandardBrowserEnv()?function(){var e,t=/(msie|trident)/i.test(navigator.userAgent),r=document.createElement("a");function i(e){var n=e;return t&&(r.setAttribute("href",n),n=r.href),r.setAttribute("href",n),{href:r.href,protocol:r.protocol?r.protocol.replace(/:$/,""):"",host:r.host,search:r.search?r.search.replace(/^\?/,""):"",hash:r.hash?r.hash.replace(/^#/,""):"",hostname:r.hostname,port:r.port,pathname:"/"===r.pathname.charAt(0)?r.pathname:"/"+r.pathname}}return e=i(window.location.href),function(t){var r=n.isString(t)?i(t):t;return r.protocol===e.protocol&&r.host===e.host}}():function(){return!0}},7018:(e,t,r)=>{var n=r(9516);e.exports=function(e,t){n.forEach(e,(function(r,n){n!==t&&n.toUpperCase()===t.toUpperCase()&&(e[t]=r,delete e[n])}))}},2012:(e,t,r)=>{var n=r(9516),i=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];e.exports=function(e){var t,r,o,a={};return e?(n.forEach(e.split("\n"),(function(e){if(o=e.indexOf(":"),t=n.trim(e.substr(0,o)).toLowerCase(),r=n.trim(e.substr(o+1)),t){if(a[t]&&i.indexOf(t)>=0)return;a[t]="set-cookie"===t?(a[t]?a[t]:[]).concat([r]):a[t]?a[t]+", "+r:r}})),a):a}},7980:e=>{e.exports=function(e){return function(t){return e.apply(null,t)}}},4841:(e,t,r)=>{var n=r(9641).version,i={};["object","boolean","number","function","string","symbol"].forEach((function(e,t){i[e]=function(r){return typeof r===e||"a"+(t<1?"n ":" ")+e}}));var o={};i.transitional=function(e,t,r){function i(e,t){return"[Axios v"+n+"] Transitional option '"+e+"'"+t+(r?". "+r:"")}return function(r,n,a){if(!1===e)throw new Error(i(n," has been removed"+(t?" in "+t:"")));return t&&!o[n]&&(o[n]=!0,console.warn(i(n," has been deprecated since v"+t+" and will be removed in the near future"))),!e||e(r,n,a)}},e.exports={assertOptions:function(e,t,r){if("object"!=typeof e)throw new TypeError("options must be an object");for(var n=Object.keys(e),i=n.length;i-- >0;){var o=n[i],a=t[o];if(a){var s=e[o],u=void 0===s||a(s,o,e);if(!0!==u)throw new TypeError("option "+o+" must be "+u)}else if(!0!==r)throw Error("Unknown option "+o)}},validators:i}},9516:(e,t,r)=>{var n=r(9012),i=Object.prototype.toString;function o(e){return Array.isArray(e)}function a(e){return void 0===e}function s(e){return"[object ArrayBuffer]"===i.call(e)}function u(e){return null!==e&&"object"==typeof e}function l(e){if("[object Object]"!==i.call(e))return!1;var t=Object.getPrototypeOf(e);return null===t||t===Object.prototype}function h(e){return"[object Function]"===i.call(e)}function c(e,t){if(null!=e)if("object"!=typeof e&&(e=[e]),o(e))for(var r=0,n=e.length;r<n;r++)t.call(null,e[r],r,e);else for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.call(null,e[i],i,e)}e.exports={isArray:o,isArrayBuffer:s,isBuffer:function(e){return null!==e&&!a(e)&&null!==e.constructor&&!a(e.constructor)&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)},isFormData:function(e){return"[object FormData]"===i.call(e)},isArrayBufferView:function(e){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&s(e.buffer)},isString:function(e){return"string"==typeof e},isNumber:function(e){return"number"==typeof e},isObject:u,isPlainObject:l,isUndefined:a,isDate:function(e){return"[object Date]"===i.call(e)},isFile:function(e){return"[object File]"===i.call(e)},isBlob:function(e){return"[object Blob]"===i.call(e)},isFunction:h,isStream:function(e){return u(e)&&h(e.pipe)},isURLSearchParams:function(e){return"[object URLSearchParams]"===i.call(e)},isStandardBrowserEnv:function(){return("undefined"==typeof navigator||"ReactNative"!==navigator.product&&"NativeScript"!==navigator.product&&"NS"!==navigator.product)&&("undefined"!=typeof window&&"undefined"!=typeof document)},forEach:c,merge:function e(){var t={};function r(r,n){l(t[n])&&l(r)?t[n]=e(t[n],r):l(r)?t[n]=e({},r):o(r)?t[n]=r.slice():t[n]=r}for(var n=0,i=arguments.length;n<i;n++)c(arguments[n],r);return t},extend:function(e,t,r){return c(t,(function(t,i){e[i]=r&&"function"==typeof t?n(t,r):t})),e},trim:function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")},stripBOM:function(e){return 65279===e.charCodeAt(0)&&(e=e.slice(1)),e}}},2111:(e,t,r)=>{r.d(t,{U:()=>Vi,Z:()=>Ki});const n={modelHeight:256,modelWidth:256,modelPediod_ms:1e3,filterPart:100,cc_power:100};r(8592);var i=r(9672);function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}function a(){a=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,i=Object.defineProperty||function(e,t,r){e[t]=r.value},s="function"==typeof Symbol?Symbol:{},u=s.iterator||"@@iterator",l=s.asyncIterator||"@@asyncIterator",h=s.toStringTag||"@@toStringTag";function c(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(e){c=function(e,t,r){return e[t]=r}}function f(e,t,r,n){var o=t&&t.prototype instanceof v?t:v,a=Object.create(o.prototype),s=new $(n||[]);return i(a,"_invoke",{value:I(e,r,s)}),a}function d(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=f;var p="suspendedStart",y="suspendedYield",m="executing",g="completed",w={};function v(){}function b(){}function x(){}var _={};c(_,u,(function(){return this}));var S=Object.getPrototypeOf,T=S&&S(S(R([])));T&&T!==r&&n.call(T,u)&&(_=T);var E=x.prototype=v.prototype=Object.create(_);function O(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function A(e,t){function r(i,a,s,u){var l=d(e[i],e,a);if("throw"!==l.type){var h=l.arg,c=h.value;return c&&"object"==o(c)&&n.call(c,"__await")?t.resolve(c.__await).then((function(e){r("next",e,s,u)}),(function(e){r("throw",e,s,u)})):t.resolve(c).then((function(e){h.value=e,s(h)}),(function(e){return r("throw",e,s,u)}))}u(l.arg)}var a;i(this,"_invoke",{value:function(e,n){function i(){return new t((function(t,i){r(e,n,t,i)}))}return a=a?a.then(i,i):i()}})}function I(t,r,n){var i=p;return function(o,a){if(i===m)throw Error("Generator is already running");if(i===g){if("throw"===o)throw a;return{value:e,done:!0}}for(n.method=o,n.arg=a;;){var s=n.delegate;if(s){var u=P(s,n);if(u){if(u===w)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===p)throw i=g,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i=m;var l=d(t,r,n);if("normal"===l.type){if(i=n.done?g:y,l.arg===w)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(i=g,n.method="throw",n.arg=l.arg)}}}function P(t,r){var n=r.method,i=t.iterator[n];if(i===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,P(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),w;var o=d(i,t.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,w;var a=o.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,w):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,w)}function k(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function C(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function $(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(k,this),this.reset(!0)}function R(t){if(t||""===t){var r=t[u];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,a=function r(){for(;++i<t.length;)if(n.call(t,i))return r.value=t[i],r.done=!1,r;return r.value=e,r.done=!0,r};return a.next=a}}throw new TypeError(o(t)+" is not iterable")}return b.prototype=x,i(E,"constructor",{value:x,configurable:!0}),i(x,"constructor",{value:b,configurable:!0}),b.displayName=c(x,h,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===b||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,x):(e.__proto__=x,c(e,h,"GeneratorFunction")),e.prototype=Object.create(E),e},t.awrap=function(e){return{__await:e}},O(A.prototype),c(A.prototype,l,(function(){return this})),t.AsyncIterator=A,t.async=function(e,r,n,i,o){void 0===o&&(o=Promise);var a=new A(f(e,r,n,i),o);return t.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},O(E),c(E,h,"Generator"),c(E,u,(function(){return this})),c(E,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=R,$.prototype={constructor:$,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(C),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function i(n,i){return s.type="throw",s.arg=t,r.next=n,i&&(r.method="next",r.arg=e),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),l=n.call(a,"finallyLoc");if(u&&l){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return i(a.catchLoc,!0)}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,w):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),w},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),C(r),w}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;C(r)}return i}}throw Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:R(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),w}},t}function s(e,t,r,n,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void r(e)}s.done?t(u):Promise.resolve(u).then(n,i)}function u(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var o=e.apply(t,r);function a(e){s(o,n,i,a,u,"next",e)}function u(e){s(o,n,i,a,u,"throw",e)}a(void 0)}))}}function l(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,c(n.key),n)}}function h(e,t,r){return t&&l(e.prototype,t),r&&l(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function c(e){var t=function(e,t){if("object"!=o(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=o(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==o(t)?t:t+""}function f(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var d=function(){return h((function e(t){f(this,e),this.enabled=!1,this.requireSyncDraw=!1,this.requireDraw=!0,this.requireNextFrame=!1,this.sdkOptions=t}),[{key:"useResources",value:function(e){this.resources=e}},{key:"init",value:(t=u(a().mark((function e(t){var r;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.inference=t,e.prev=1,this.modelConfig){e.next=4;break}throw Error("Model configuration not found for ".concat(this.name));case 4:return e.next=6,this.inference.sessionManager.init(this.modelConfig);case 6:e.next=12;break;case 8:return e.prev=8,e.t0=e.catch(1),i.bv.notify({message:null!==(r=e.t0.message)&&void 0!==r?r:"Effect inference initialization issue for ".concat(this.name),type:i.By.ERROR,code:i.O4.EFFECT_INITIALIZATION_ISSUE,emitter:i.JK.ABSTRACT_EFFECT,data:{effect_name:this.name}}),e.abrupt("return");case 12:i.bv.notify({message:"Effect inference succesfully initialized for ".concat(this.name),type:i.By.INFO,code:i.O4.EFFECT_INITIALIZATION_SUCCESS,emitter:i.JK.ABSTRACT_EFFECT,data:{effect_name:this.name}});case 13:case"end":return e.stop()}}),e,this,[[1,8]])}))),function(e){return t.apply(this,arguments)})},{key:"process",value:(e=u(a().mark((function e(t){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),function(t){return e.apply(this,arguments)})},{key:"nextFrame",value:function(e){}},{key:"enable",value:function(){this.enabled=!0}},{key:"disable",value:function(){this.enabled=!1}},{key:"prepare",value:function(){}},{key:"clearBuffers",value:function(){}},{key:"destroy",value:function(){}}]);var e,t}();function p(e,t,r,n){for(var i=r*t,o=2*r*t,a=0;a<n.length/3;a++)n[0+a]=e[4*a],n[i+a]=e[4*a+1],n[o+a]=e[4*a+2];return n}var y=33;function m(e,t){var r=e.tensor,n=35937,i=r.output.data,o=new Uint8ClampedArray(t.buffer),a={value:0,isNil:function(){return 0===a.value},setDefault:function(){return a.value=1089},dec:function(){return a.value--}};a.setDefault();for(var s=0,u=0,l=function(e,t){return 4*(y*(6*u+s)+t%y)+e},h=function(e){[e,n+e,71874+e].forEach((function(t,r){o[l(r,e)]=255*i[t]})),o[l(3,e)]=255,a.dec(),e%y==32&&u++,a.isNil()&&(a.setDefault(),++s>=6?s=0:u-=y)},c=0;c<n;c++)h(c)}var g=r(5034);function w(e){return w="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},w(e)}function v(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,b(n.key),n)}}function b(e){var t=function(e,t){if("object"!=w(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=w(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==w(t)?t:t+""}function x(e,t,r){return t=S(t),function(e,t){if(t&&("object"==w(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,_()?Reflect.construct(t,r||[],S(e).constructor):t.apply(e,r))}function _(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(_=function(){return!!e})()}function S(e){return S=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},S(e)}function T(e,t){return T=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},T(e,t)}var E=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=x(this,t,[void 0,"varying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform sampler2D uLUT;\nuniform float uFilterPart;\nuniform float uFilterPower;\n\nfloat clampedCoord(float coord) {\n  float min = 0.5 / 198.0;\n  float max = 1.0 - min;\n  return clamp(coord, min, max);\n}\n\nfloat clampColor(float color) {\n  float min = 1.0 / 256.0;\n  float max = 1.0 / 6.0 - min;\n  return clamp(color, min, max);\n}\n\nvec4 newColor(float rectNum, vec2 coord) {\n  vec2 bCoord = vec2(mod(rectNum, 6.0) / 6.0, floor(rectNum / 6.0) / 6.0);\n  vec2 lutTextureCoord = vec2(clampedCoord(coord.r + bCoord.r), clampedCoord(coord.g + bCoord.g));\n  return texture2D(uLUT, lutTextureCoord);\n}\n\nvoid main() {\n  vec4 color = texture2D(uSampler, vTextureCoord);\n\n  if (vTextureCoord.x > uFilterPart) {\n    gl_FragColor = color;\n    return;\n  }\n\n  vec2 rgCoord = vec2(clampColor(color.r / 6.0), clampColor(color.g / 6.0));\n\n  //. Count number of the LUT-cell\n  float rectNumReal = color.b * 32.0;\n  float rectNumMin = floor(rectNumReal);\n  float rectNumMax = ceil(rectNumReal);\n\n  vec4 colorLut1 = newColor(rectNumMin, rgCoord);\n  vec4 colorLut2 = newColor(rectNumMax, rgCoord);\n\n  vec3 interpolatedColor = mix(colorLut1.rgb, colorLut2.rgb, rectNumReal - rectNumMin);\n\n  //. Add filter power\n  vec3 resultColor = mix(color.rgb, interpolatedColor.rgb, uFilterPower);\n\n  gl_FragColor = vec4(resultColor.rgb, color.a);\n}\n",{uFilterPart:1,uFilterPower:1}])).lutTextureHeight=198,e.lutTextureWidth=198,e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&T(e,t)}(t,e),r=t,(n=[{key:"setLUT",value:function(e,t){var r;null===(r=this.lutTexture)||void 0===r||r.destroy(!0),this.onLutDestroyedCallback&&this.onLutDestroyedCallback(),this.lutTexture=g.Texture.fromBuffer(e,this.lutTextureWidth,this.lutTextureHeight,{scaleMode:1}),this.onLutDestroyedCallback=t,this.uniforms.uLUT=this.lutTexture}},{key:"setFilterPart",value:function(e){e=Math.min(1,Math.max(0,e)),this.uniforms.uFilterPart=e}},{key:"setFilterPower",value:function(e){e=Math.min(1,Math.max(0,e)),this.uniforms.uFilterPower=e}}])&&v(r.prototype,n),i&&v(r,i),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,i}(g.Filter),O=r(8380);function A(e){return A="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},A(e)}function I(){I=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,i=Object.defineProperty||function(e,t,r){e[t]=r.value},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function l(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,r){return e[t]=r}}function h(e,t,r,n){var o=t&&t.prototype instanceof g?t:g,a=Object.create(o.prototype),s=new $(n||[]);return i(a,"_invoke",{value:O(e,r,s)}),a}function c(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=h;var f="suspendedStart",d="suspendedYield",p="executing",y="completed",m={};function g(){}function w(){}function v(){}var b={};l(b,a,(function(){return this}));var x=Object.getPrototypeOf,_=x&&x(x(R([])));_&&_!==r&&n.call(_,a)&&(b=_);var S=v.prototype=g.prototype=Object.create(b);function T(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function E(e,t){function r(i,o,a,s){var u=c(e[i],e,o);if("throw"!==u.type){var l=u.arg,h=l.value;return h&&"object"==A(h)&&n.call(h,"__await")?t.resolve(h.__await).then((function(e){r("next",e,a,s)}),(function(e){r("throw",e,a,s)})):t.resolve(h).then((function(e){l.value=e,a(l)}),(function(e){return r("throw",e,a,s)}))}s(u.arg)}var o;i(this,"_invoke",{value:function(e,n){function i(){return new t((function(t,i){r(e,n,t,i)}))}return o=o?o.then(i,i):i()}})}function O(t,r,n){var i=f;return function(o,a){if(i===p)throw Error("Generator is already running");if(i===y){if("throw"===o)throw a;return{value:e,done:!0}}for(n.method=o,n.arg=a;;){var s=n.delegate;if(s){var u=P(s,n);if(u){if(u===m)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===f)throw i=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i=p;var l=c(t,r,n);if("normal"===l.type){if(i=n.done?y:d,l.arg===m)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(i=y,n.method="throw",n.arg=l.arg)}}}function P(t,r){var n=r.method,i=t.iterator[n];if(i===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,P(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),m;var o=c(i,t.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,m;var a=o.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,m):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,m)}function k(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function C(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function $(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(k,this),this.reset(!0)}function R(t){if(t||""===t){var r=t[a];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,o=function r(){for(;++i<t.length;)if(n.call(t,i))return r.value=t[i],r.done=!1,r;return r.value=e,r.done=!0,r};return o.next=o}}throw new TypeError(A(t)+" is not iterable")}return w.prototype=v,i(S,"constructor",{value:v,configurable:!0}),i(v,"constructor",{value:w,configurable:!0}),w.displayName=l(v,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===w||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,v):(e.__proto__=v,l(e,u,"GeneratorFunction")),e.prototype=Object.create(S),e},t.awrap=function(e){return{__await:e}},T(E.prototype),l(E.prototype,s,(function(){return this})),t.AsyncIterator=E,t.async=function(e,r,n,i,o){void 0===o&&(o=Promise);var a=new E(h(e,r,n,i),o);return t.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},T(S),l(S,u,"Generator"),l(S,a,(function(){return this})),l(S,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=R,$.prototype={constructor:$,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(C),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function i(n,i){return s.type="throw",s.arg=t,r.next=n,i&&(r.method="next",r.arg=e),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),l=n.call(a,"finallyLoc");if(u&&l){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return i(a.catchLoc,!0)}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,m):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),C(r),m}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;C(r)}return i}}throw Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:R(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),m}},t}function P(e,t,r,n,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void r(e)}s.done?t(u):Promise.resolve(u).then(n,i)}function k(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var o=e.apply(t,r);function a(e){P(o,n,i,a,s,"next",e)}function s(e){P(o,n,i,a,s,"throw",e)}a(void 0)}))}}function C(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,$(n.key),n)}}function $(e){var t=function(e,t){if("object"!=A(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=A(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==A(t)?t:t+""}function R(e,t,r){return t=B(t),function(e,t){if(t&&("object"==A(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,D()?Reflect.construct(t,r||[],B(e).constructor):t.apply(e,r))}function D(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(D=function(){return!!e})()}function M(e,t,r,n){var i=L(B(1&n?e.prototype:e),t,r);return 2&n&&"function"==typeof i?function(e){return i.apply(r,e)}:i}function L(){return L="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=function(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=B(e)););return e}(e,t);if(n){var i=Object.getOwnPropertyDescriptor(n,t);return i.get?i.get.call(arguments.length<3?e:r):i.value}},L.apply(null,arguments)}function B(e){return B=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},B(e)}function N(e,t){return N=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},N(e,t)}var F=function(e){function t(e){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(r=R(this,t,[e])).name=Vi.COLOR_CORRECION,r.priority=7,r.hasLUT=!1,r.inWork=!1,r.config=Object.assign({},n),r.filterName="color-correction",r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&N(e,t)}(t,e),r=t,o=[{key:"init",value:(l=k(I().mark((function e(r){return I().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.modelConfig||(this.modelConfig={modelPath:O.y.getModelUrl(O.y.MODELS.colorcorrector),backend:"wasm",nchw:!1}),e.next=3,M(t,"init",this,3)([r]);case 3:case"end":return e.stop()}}),e,this)}))),function(e){return l.apply(this,arguments)})},{key:"prepare",value:function(){this.ccFilter=new E}},{key:"process",value:(u=k(I().mark((function e(t){return I().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.enabled){e.next=2;break}return e.abrupt("return");case 2:this.modelTexture||(this.modelTexture=this.resources.texturePool.get(this.config.modelWidth,this.config.modelHeight)),t.sprite.width=this.config.modelWidth,t.sprite.height=this.config.modelHeight,this.resources.renderer.renderTo(t.sprite,this.modelTexture),t.sprite.width=this.sdkOptions.width,t.sprite.height=this.sdkOptions.height,this.modelProcess(),this.hasLUT&&this.resources.filters.set(this.filterName,this.ccFilter);case 10:case"end":return e.stop()}}),e,this)}))),function(e){return u.apply(this,arguments)})},{key:"disable",value:function(){M(t,"disable",this,3)([]),this.resources.filters.delete(this.filterName)}},{key:"modelProcess",value:(s=k(I().mark((function e(){var t,r,n,o,a,s,u,l=this;return I().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.inWork){e.next=2;break}return e.abrupt("return");case 2:if(this.checkTimer()){e.next=4;break}return e.abrupt("return");case 4:return this.inWork=!0,t=this.config,r=t.modelHeight,n=t.modelWidth,e.next=8,this.resources.renderer.pixelsAsync(this.modelTexture,{pool:this.resources.bufferPool});case 8:return o=e.sent,a=this.resources.bufferPool.getBuffer("f32",r*n*3),p(o,n,r,a),this.resources.bufferPool.returnBuffer(o),s={output:{data:this.resources.bufferPool.getBuffer("f32",107811),dims:[3,33,33,33]}},u=this.inference.sessionManager.getSession(this.modelConfig.modelPath),e.abrupt("return",this.inference.run(u,a,n,r,3,s).then((function(e){l.resources.bufferPool.returnBuffer(e.inputBack.data);var t=l.resources.bufferPool.getBuffer("u8",4*Math.pow(198,2));m({tensor:e},t),l.resources.bufferPool.returnBuffer(e.output.data),l.ccFilter.setLUT(t,(function(){l.resources.bufferPool.returnBuffer(t)})),l.hasLUT=!0})).catch((function(e){var t;i.bv.notify({message:null!==(t=e.message)&&void 0!==t?t:e,type:i.By.ERROR,code:i.O4.INFERENCE_RUN_ISSUE,emitter:i.JK.EFFECT_COLOR_CORRECTION,cause:e})})).finally((function(){l.inWork=!1})));case 15:case"end":return e.stop()}}),e,this)}))),function(){return s.apply(this,arguments)})},{key:"setConfig",value:function(e,t){this.config[e]=t,"filterPart"===e&&this.ccFilter.setFilterPart(t),"cc_power"===e&&this.ccFilter.setFilterPower(t)}},{key:"checkTimer",value:function(){return this.modelTimer?(performance.now()-this.modelTimer<this.config.modelPediod_ms||(this.modelTimer=0),!1):(this.modelTimer=performance.now(),!0)}},{key:"destroy",value:function(){this.inference.sessionManager.releaseSession(this.modelConfig.modelPath)}}],o&&C(r.prototype,o),a&&C(r,a),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,o,a,s,u,l}(d);function U(e){return U="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},U(e)}function j(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,z(n.key),n)}}function z(e){var t=function(e,t){if("object"!=U(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=U(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==U(t)?t:t+""}function G(e,t,r){return t=W(t),function(e,t){if(t&&("object"==U(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,V()?Reflect.construct(t,r||[],W(e).constructor):t.apply(e,r))}function V(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(V=function(){return!!e})()}function W(e){return W=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},W(e)}function H(e,t){return H=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},H(e,t)}var q=function(e){function t(e){var r,n,i,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(r=G(this,t,[void 0,"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform sampler2D uLUT;\n\nuniform float uFilterPart;\nuniform float uFilterPower;\nuniform float uLutSize;\nuniform float uNormalizator;\nuniform float uHalfPx;\nuniform int uEdges;\nuniform int uEnabled;\n\nvec4 newColor(float rectNum, vec2 coord) {\n  int num = int(rectNum);\n  int red = num - uEdges * (num / uEdges);\n  int green = num / uEdges;\n\n  vec2 bCoord = vec2(float(red) / float(uEdges), float(green) / float(uEdges));\n\n  vec2 lutTextureCoord = vec2(coord.r + bCoord.r, coord.g + bCoord.g);\n  return texture2D(uLUT, lutTextureCoord);\n}\n\nfloat normalizeColor(float color) {\n  return color * uNormalizator + uHalfPx;\n}\n\nvoid main() {\n  vec4 color = texture2D(uSampler, vTextureCoord);\n\n  //. Check enabled\n  if (uEnabled < 1) {\n    gl_FragColor = color;\n    return;\n  }\n\n  //. Check filter part\n  if (vTextureCoord.x > uFilterPart) {\n    gl_FragColor = color;\n    return;\n  }\n\n  vec2 rgCoord = vec2(normalizeColor(color.r), normalizeColor(color.g));\n\n  //. Count number of the LUT-cell\n  float rectNumReal = color.b * (uLutSize - 1.0);\n\n  float rectNumMin = floor(rectNumReal);\n  float rectNumMax = ceil(rectNumReal);\n\n  vec4 colorLut1 = newColor(rectNumMin, rgCoord);\n  vec4 colorLut2 = newColor(rectNumMax, rgCoord);\n\n  vec4 colorInterpolated = mix(colorLut1, colorLut2, rectNumReal - rectNumMin);\n  vec3 resultColor = mix(color.rgb, colorInterpolated.rgb, uFilterPower);\n\n  gl_FragColor = vec4(resultColor.rgb, color.a);\n}\n\n",{uFilterPart:1,uFilterPower:1,uEnabled:0,uLutSize:null!==(n=null==e?void 0:e.lutSize)&&void 0!==n?n:36,uEdges:null!==(i=null==e?void 0:e.edges)&&void 0!==i?i:6,uLUT:null!==(o=null==e?void 0:e.texture)&&void 0!==o?o:g.Texture.WHITE}])).calcNormatizator(),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&H(e,t)}(t,e),r=t,n=[{key:"setLUT",value:function(e){var t;(!(arguments.length>1&&void 0!==arguments[1])||arguments[1])&&(null===(t=this.uniforms.uLUT)||void 0===t||t.destroy(!0)),(null==e?void 0:e.edges)&&(this.uniforms.uEdges=e.edges),(null==e?void 0:e.lutSize)&&(this.uniforms.uLutSize=e.lutSize),this.calcNormatizator(),(null==e?void 0:e.texture)?(this.uniforms.uLUT=e.texture,this.uniforms.uEnabled=1):this.uniforms.uEnabled=0}},{key:"setFilterPart",value:function(e){e=Math.min(1,Math.max(0,e)),this.uniforms.uFilterPart=e}},{key:"setFilterPower",value:function(e){e=Math.min(1,Math.max(0,e)),this.uniforms.uFilterPower=e}},{key:"calcNormatizator",value:function(){var e=this.uniforms,t=e.uLutSize,r=e.uEdges;this.uniforms.uNormalizator=(t-1)/(t*r),this.uniforms.uHalfPx=.5/(t*r)}}],n&&j(r.prototype,n),i&&j(r,i),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,i}(g.Filter);function Y(e){return Y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Y(e)}function X(e){return function(e){if(Array.isArray(e))return K(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return K(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?K(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function K(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function Z(){Z=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,i=Object.defineProperty||function(e,t,r){e[t]=r.value},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function l(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,r){return e[t]=r}}function h(e,t,r,n){var o=t&&t.prototype instanceof g?t:g,a=Object.create(o.prototype),s=new k(n||[]);return i(a,"_invoke",{value:O(e,r,s)}),a}function c(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=h;var f="suspendedStart",d="suspendedYield",p="executing",y="completed",m={};function g(){}function w(){}function v(){}var b={};l(b,a,(function(){return this}));var x=Object.getPrototypeOf,_=x&&x(x(C([])));_&&_!==r&&n.call(_,a)&&(b=_);var S=v.prototype=g.prototype=Object.create(b);function T(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function E(e,t){function r(i,o,a,s){var u=c(e[i],e,o);if("throw"!==u.type){var l=u.arg,h=l.value;return h&&"object"==Y(h)&&n.call(h,"__await")?t.resolve(h.__await).then((function(e){r("next",e,a,s)}),(function(e){r("throw",e,a,s)})):t.resolve(h).then((function(e){l.value=e,a(l)}),(function(e){return r("throw",e,a,s)}))}s(u.arg)}var o;i(this,"_invoke",{value:function(e,n){function i(){return new t((function(t,i){r(e,n,t,i)}))}return o=o?o.then(i,i):i()}})}function O(t,r,n){var i=f;return function(o,a){if(i===p)throw Error("Generator is already running");if(i===y){if("throw"===o)throw a;return{value:e,done:!0}}for(n.method=o,n.arg=a;;){var s=n.delegate;if(s){var u=A(s,n);if(u){if(u===m)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===f)throw i=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i=p;var l=c(t,r,n);if("normal"===l.type){if(i=n.done?y:d,l.arg===m)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(i=y,n.method="throw",n.arg=l.arg)}}}function A(t,r){var n=r.method,i=t.iterator[n];if(i===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,A(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),m;var o=c(i,t.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,m;var a=o.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,m):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,m)}function I(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function P(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function k(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(I,this),this.reset(!0)}function C(t){if(t||""===t){var r=t[a];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,o=function r(){for(;++i<t.length;)if(n.call(t,i))return r.value=t[i],r.done=!1,r;return r.value=e,r.done=!0,r};return o.next=o}}throw new TypeError(Y(t)+" is not iterable")}return w.prototype=v,i(S,"constructor",{value:v,configurable:!0}),i(v,"constructor",{value:w,configurable:!0}),w.displayName=l(v,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===w||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,v):(e.__proto__=v,l(e,u,"GeneratorFunction")),e.prototype=Object.create(S),e},t.awrap=function(e){return{__await:e}},T(E.prototype),l(E.prototype,s,(function(){return this})),t.AsyncIterator=E,t.async=function(e,r,n,i,o){void 0===o&&(o=Promise);var a=new E(h(e,r,n,i),o);return t.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},T(S),l(S,u,"Generator"),l(S,a,(function(){return this})),l(S,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=C,k.prototype={constructor:k,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(P),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function i(n,i){return s.type="throw",s.arg=t,r.next=n,i&&(r.method="next",r.arg=e),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),l=n.call(a,"finallyLoc");if(u&&l){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return i(a.catchLoc,!0)}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,m):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),P(r),m}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;P(r)}return i}}throw Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:C(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),m}},t}function J(e,t,r,n,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void r(e)}s.done?t(u):Promise.resolve(u).then(n,i)}function Q(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var o=e.apply(t,r);function a(e){J(o,n,i,a,s,"next",e)}function s(e){J(o,n,i,a,s,"throw",e)}a(void 0)}))}}function ee(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,te(n.key),n)}}function te(e){var t=function(e,t){if("object"!=Y(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=Y(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Y(t)?t:t+""}var re=["cube"],ne=function(){return e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)},t=[{key:"parse",value:function(e){var t,r=this;return new Promise(function(){var n=Q(Z().mark((function n(i,o){var a,s,u,l,h;return Z().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!(e instanceof File)){n.next=14;break}if(r.checkFileExtention(e.name)){n.next=4;break}return o('[ Lut Parser ] - Invalid file extention (file "'.concat(e.name,'", available extentions: ').concat(re.join(", "),")")),n.abrupt("return");case 4:return n.prev=4,n.next=7,r.readFile(e);case 7:t=n.sent,n.next=14;break;case 10:return n.prev=10,n.t0=n.catch(4),o(n.t0),n.abrupt("return");case 14:if("string"!=typeof e){n.next=25;break}return n.prev=15,n.next=18,fetch(e).then((function(e){return e.text()}));case 18:t=n.sent,n.next=25;break;case 21:return n.prev=21,n.t1=n.catch(15),o(n.t1),n.abrupt("return");case 25:if("3D"===(a=r.parseCUBE(t)).type.toUpperCase()){n.next=29;break}return o("[ Lut Parser ] - invalid lut type(".concat(a.type,"). Support 3DLUT only")),n.abrupt("return");case 29:return s=Math.ceil(Math.sqrt(a.size)),u=r.prepareTextureArray(a,s),l=a.size*s,h=g.Texture.fromBuffer(u,l,l,{scaleMode:1,mipmap:g.MIPMAP_MODES.OFF}),i({texture:h,lutSize:a.size,textureSize:l,edges:s}),n.abrupt("return");case 35:case"end":return n.stop()}}),n,null,[[4,10],[15,21]])})));return function(e,t){return n.apply(this,arguments)}}())}},{key:"parseCUBE",value:function(e){for(var t,r={title:"",type:"",size:0,domain:[[0,0,0],[1,1,1]],data:[]},n=e.split("\n"),i=0;i<n.length;i++){var o=n[i].trim();if("#"!==o[0]&&""!==o){var a=o.split(/\s+/);switch(a[0]){case"TITLE":r.title=o.slice(7,-1);break;case"DOMAIN_MIN":r.domain[0]=a.slice(1).map(Number);break;case"DOMAIN_MAX":r.domain[1]=a.slice(1).map(Number);break;case"LUT_1D_SIZE":r.type="1D",r.size=Number(a[1]);break;case"LUT_3D_SIZE":r.type="3D",r.size=Number(a[1]);break;default:(t=r.data).push.apply(t,X(a.map(Number)))}}}return r}},{key:"prepareTextureArray",value:function(e,t){var r=e.data,n=e.size,i=n*n*n,o=new Uint8ClampedArray(4*Math.pow(n*t,2)),a={value:0,isNil:function(){return 0===a.value},setDefault:function(){return a.value=n*n},dec:function(){return a.value--}};a.setDefault();for(var s=0,u=0,l=function(e,r){return 4*(n*(t*u+s)+r%n)+e},h=0;h<3*i;h+=3)o[l(0,h/3)]=255*r[h+0],o[l(1,h/3)]=255*r[h+1],o[l(2,h/3)]=255*r[h+2],o[l(3,h/3)]=255,a.dec(),h/3%n==n-2&&u++,a.isNil()&&(a.setDefault(),++s>=t?s=0:u-=n);return o}},{key:"checkFileExtention",value:function(e){var t=e.split(".").pop();return!!t&&re.includes(t.toLowerCase())}},{key:"readFile",value:(n=Q(Z().mark((function e(t){return Z().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,r){var n=new FileReader;n.readAsText(t),n.onload=function(){e(n.result)},n.onerror=function(){r("[ Lut Parser ] - filereader: ".concat(n.error))}})));case 1:case"end":return e.stop()}}),e)}))),function(e){return n.apply(this,arguments)})}],t&&ee(e.prototype,t),r&&ee(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,r,n}();function ie(e){return ie="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ie(e)}function oe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ae(n.key),n)}}function ae(e){var t=function(e,t){if("object"!=ie(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=ie(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==ie(t)?t:t+""}var se=function(){return e=function e(t){var r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.size=null!==(r=t.size)&&void 0!==r?r:1,this.store=[]},(t=[{key:"add",value:function(e){var t=this,r=this.store.find((function(t){return t.id===e})),n=Date.now();if(r)return r.time=n,{hasItem:!0};var i={id:e,time:n};if(this.store.push(i),this.store.length<=this.size)return{};var o=this.store.reduce((function(e,r,n){return t.store[e].time<r.time?e:n}),0);return{removedID:this.store.splice(o,1)[0].id}}},{key:"setSize",value:function(e){var t;if(this.size=e,!(this.store.length<=e)){this.store=this.store.sort((function(e,t){return t.time-e.time}));for(var r=[];this.store.length>this.size;){var n=null===(t=this.store.pop())||void 0===t?void 0:t.id;void 0!==n&&r.push(n)}return r}}},{key:"checkItemByID",value:function(e){return!!~this.store.findIndex((function(t){return t.id===e}))}}])&&oe(e.prototype,t),r&&oe(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,r}();function ue(e){return ue="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ue(e)}function le(){le=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,i=Object.defineProperty||function(e,t,r){e[t]=r.value},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function l(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,r){return e[t]=r}}function h(e,t,r,n){var o=t&&t.prototype instanceof g?t:g,a=Object.create(o.prototype),s=new k(n||[]);return i(a,"_invoke",{value:O(e,r,s)}),a}function c(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=h;var f="suspendedStart",d="suspendedYield",p="executing",y="completed",m={};function g(){}function w(){}function v(){}var b={};l(b,a,(function(){return this}));var x=Object.getPrototypeOf,_=x&&x(x(C([])));_&&_!==r&&n.call(_,a)&&(b=_);var S=v.prototype=g.prototype=Object.create(b);function T(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function E(e,t){function r(i,o,a,s){var u=c(e[i],e,o);if("throw"!==u.type){var l=u.arg,h=l.value;return h&&"object"==ue(h)&&n.call(h,"__await")?t.resolve(h.__await).then((function(e){r("next",e,a,s)}),(function(e){r("throw",e,a,s)})):t.resolve(h).then((function(e){l.value=e,a(l)}),(function(e){return r("throw",e,a,s)}))}s(u.arg)}var o;i(this,"_invoke",{value:function(e,n){function i(){return new t((function(t,i){r(e,n,t,i)}))}return o=o?o.then(i,i):i()}})}function O(t,r,n){var i=f;return function(o,a){if(i===p)throw Error("Generator is already running");if(i===y){if("throw"===o)throw a;return{value:e,done:!0}}for(n.method=o,n.arg=a;;){var s=n.delegate;if(s){var u=A(s,n);if(u){if(u===m)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===f)throw i=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i=p;var l=c(t,r,n);if("normal"===l.type){if(i=n.done?y:d,l.arg===m)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(i=y,n.method="throw",n.arg=l.arg)}}}function A(t,r){var n=r.method,i=t.iterator[n];if(i===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,A(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),m;var o=c(i,t.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,m;var a=o.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,m):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,m)}function I(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function P(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function k(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(I,this),this.reset(!0)}function C(t){if(t||""===t){var r=t[a];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,o=function r(){for(;++i<t.length;)if(n.call(t,i))return r.value=t[i],r.done=!1,r;return r.value=e,r.done=!0,r};return o.next=o}}throw new TypeError(ue(t)+" is not iterable")}return w.prototype=v,i(S,"constructor",{value:v,configurable:!0}),i(v,"constructor",{value:w,configurable:!0}),w.displayName=l(v,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===w||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,v):(e.__proto__=v,l(e,u,"GeneratorFunction")),e.prototype=Object.create(S),e},t.awrap=function(e){return{__await:e}},T(E.prototype),l(E.prototype,s,(function(){return this})),t.AsyncIterator=E,t.async=function(e,r,n,i,o){void 0===o&&(o=Promise);var a=new E(h(e,r,n,i),o);return t.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},T(S),l(S,u,"Generator"),l(S,a,(function(){return this})),l(S,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=C,k.prototype={constructor:k,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(P),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function i(n,i){return s.type="throw",s.arg=t,r.next=n,i&&(r.method="next",r.arg=e),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),l=n.call(a,"finallyLoc");if(u&&l){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return i(a.catchLoc,!0)}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,m):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),P(r),m}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;P(r)}return i}}throw Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:C(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),m}},t}function he(e,t,r,n,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void r(e)}s.done?t(u):Promise.resolve(u).then(n,i)}function ce(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var o=e.apply(t,r);function a(e){he(o,n,i,a,s,"next",e)}function s(e){he(o,n,i,a,s,"throw",e)}a(void 0)}))}}function fe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,de(n.key),n)}}function de(e){var t=function(e,t){if("object"!=ue(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=ue(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==ue(t)?t:t+""}function pe(e,t,r){return t=me(t),function(e,t){if(t&&("object"==ue(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,ye()?Reflect.construct(t,r||[],me(e).constructor):t.apply(e,r))}function ye(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(ye=function(){return!!e})()}function me(e){return me=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},me(e)}function ge(e,t){return ge=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},ge(e,t)}var we=function(e){function t(e){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(r=pe(this,t,[e])).name=Vi.COLOR_FILTERS,r.priority=5,r.parser=new ne,r.lutStore={},r.config={lut:"none",part:1,power:1,capacity:1},r.activityIndexator=new se({size:r.config.capacity}),r.filterName="color-filter",r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ge(e,t)}(t,e),r=t,n=[{key:"prepare",value:function(){this.filter=new q,this.setConfig(this.config)}},{key:"process",value:(a=ce(le().mark((function e(t){return le().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.enabled&&"none"!==this.config.lut){e.next=3;break}return this.resources.filters.has(this.filterName)&&this.resources.filters.delete(this.filterName),e.abrupt("return");case 3:this.resources.filters.set(this.filterName,this.filter);case 4:case"end":return e.stop()}}),e,this)}))),function(e){return a.apply(this,arguments)})},{key:"setConfig",value:function(e){this.setFilterPart(e.part),this.setFilterPower(e.power),this.setFilterLut(e.lut,e.promise),this.setCapacity(e.capacity)}},{key:"setFilterPart",value:function(e){void 0!==e&&(this.config.part=e,this.filter.setFilterPart(e))}},{key:"setFilterPower",value:function(e){void 0!==e&&(this.config.power=e,this.filter.setFilterPower(e))}},{key:"setFilterLut",value:(o=ce(le().mark((function e(t,r){var n,i,o,a,s;return le().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==t){e.next=2;break}return e.abrupt("return");case 2:if("none"!==t){e.next=5;break}return this.config.lut="none",e.abrupt("return");case 5:if(n=this.countID(t),this.config.lut=t,this.selectedID=n,i=this.activityIndexator.add(n),o=i.hasItem,a=i.removedID,o){e.next=19;break}return e.next=12,this.parser.parse(t);case 12:if(s=e.sent,this.activityIndexator.checkItemByID(n)){e.next=18;break}return s.texture.destroy(),this.removeLutByID(a),this.resolver(n,null==r?void 0:r.resolve()),e.abrupt("return");case 18:this.lutStore[n]=s;case 19:this.filter.setLUT(this.lutStore[this.selectedID],!1),this.removeLutByID(a),this.resolver(n,null==r?void 0:r.resolve());case 22:case"end":return e.stop()}}),e,this)}))),function(e,t){return o.apply(this,arguments)})},{key:"setCapacity",value:function(e){var t=this;if(void 0!==e){this.config.capacity=e;var r=this.activityIndexator.setSize(e);(null==r?void 0:r.length)&&r.forEach((function(e){return t.removeLutByID(e)}))}}},{key:"removeLutByID",value:function(e){var t,r;void 0!==e&&(null===(r=null===(t=this.lutStore[e])||void 0===t?void 0:t.texture)||void 0===r||r.destroy(),delete this.lutStore[e])}},{key:"countID",value:function(e){return e instanceof File?e.name:e}},{key:"onSuccess",value:function(e){var t="function"==typeof e;this.onSuccessFunction=t?e:void 0}},{key:"resolver",value:function(e,t){"function"==typeof this.onSuccessFunction&&this.onSuccessFunction(e),"function"==typeof t&&t()}},{key:"destroy",value:function(){}}],n&&fe(r.prototype,n),i&&fe(r,i),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,i,o,a}(d);function ve(e){return ve="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ve(e)}function be(){be=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,i=Object.defineProperty||function(e,t,r){e[t]=r.value},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function l(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,r){return e[t]=r}}function h(e,t,r,n){var o=t&&t.prototype instanceof g?t:g,a=Object.create(o.prototype),s=new k(n||[]);return i(a,"_invoke",{value:O(e,r,s)}),a}function c(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=h;var f="suspendedStart",d="suspendedYield",p="executing",y="completed",m={};function g(){}function w(){}function v(){}var b={};l(b,a,(function(){return this}));var x=Object.getPrototypeOf,_=x&&x(x(C([])));_&&_!==r&&n.call(_,a)&&(b=_);var S=v.prototype=g.prototype=Object.create(b);function T(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function E(e,t){function r(i,o,a,s){var u=c(e[i],e,o);if("throw"!==u.type){var l=u.arg,h=l.value;return h&&"object"==ve(h)&&n.call(h,"__await")?t.resolve(h.__await).then((function(e){r("next",e,a,s)}),(function(e){r("throw",e,a,s)})):t.resolve(h).then((function(e){l.value=e,a(l)}),(function(e){return r("throw",e,a,s)}))}s(u.arg)}var o;i(this,"_invoke",{value:function(e,n){function i(){return new t((function(t,i){r(e,n,t,i)}))}return o=o?o.then(i,i):i()}})}function O(t,r,n){var i=f;return function(o,a){if(i===p)throw Error("Generator is already running");if(i===y){if("throw"===o)throw a;return{value:e,done:!0}}for(n.method=o,n.arg=a;;){var s=n.delegate;if(s){var u=A(s,n);if(u){if(u===m)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===f)throw i=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i=p;var l=c(t,r,n);if("normal"===l.type){if(i=n.done?y:d,l.arg===m)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(i=y,n.method="throw",n.arg=l.arg)}}}function A(t,r){var n=r.method,i=t.iterator[n];if(i===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,A(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),m;var o=c(i,t.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,m;var a=o.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,m):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,m)}function I(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function P(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function k(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(I,this),this.reset(!0)}function C(t){if(t||""===t){var r=t[a];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,o=function r(){for(;++i<t.length;)if(n.call(t,i))return r.value=t[i],r.done=!1,r;return r.value=e,r.done=!0,r};return o.next=o}}throw new TypeError(ve(t)+" is not iterable")}return w.prototype=v,i(S,"constructor",{value:v,configurable:!0}),i(v,"constructor",{value:w,configurable:!0}),w.displayName=l(v,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===w||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,v):(e.__proto__=v,l(e,u,"GeneratorFunction")),e.prototype=Object.create(S),e},t.awrap=function(e){return{__await:e}},T(E.prototype),l(E.prototype,s,(function(){return this})),t.AsyncIterator=E,t.async=function(e,r,n,i,o){void 0===o&&(o=Promise);var a=new E(h(e,r,n,i),o);return t.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},T(S),l(S,u,"Generator"),l(S,a,(function(){return this})),l(S,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=C,k.prototype={constructor:k,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(P),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function i(n,i){return s.type="throw",s.arg=t,r.next=n,i&&(r.method="next",r.arg=e),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),l=n.call(a,"finallyLoc");if(u&&l){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return i(a.catchLoc,!0)}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,m):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),P(r),m}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;P(r)}return i}}throw Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:C(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),m}},t}function xe(e,t,r,n,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void r(e)}s.done?t(u):Promise.resolve(u).then(n,i)}function _e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Se(n.key),n)}}function Se(e){var t=function(e,t){if("object"!=ve(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=ve(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==ve(t)?t:t+""}function Te(e,t,r){return t=Oe(t),function(e,t){if(t&&("object"==ve(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,Ee()?Reflect.construct(t,r||[],Oe(e).constructor):t.apply(e,r))}function Ee(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Ee=function(){return!!e})()}function Oe(e){return Oe=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Oe(e)}function Ae(e,t){return Ae=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Ae(e,t)}var Ie=function(e){function t(e){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(r=Te(this,t,[e])).name=Vi.CUSTOM_RESOLUTION,r.priority=1,r.requireSyncDraw=!0,r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Ae(e,t)}(t,e),r=t,n=[{key:"process",value:(o=be().mark((function e(t){var r;return be().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.sdkOptions.isCustomSize()){e.next=2;break}return e.abrupt("return");case 2:r=this.resources.texturePool.get(this.sdkOptions.width,this.sdkOptions.height),t.sprite.width=this.sdkOptions.width,t.sprite.height=this.sdkOptions.height,this.resources.renderer.renderTo(t.sprite,r),this.resources.texturePool.put(t.update(r));case 7:case"end":return e.stop()}}),e,this)})),a=function(){var e=this,t=arguments;return new Promise((function(r,n){var i=o.apply(e,t);function a(e){xe(i,r,n,a,s,"next",e)}function s(e){xe(i,r,n,a,s,"throw",e)}a(void 0)}))},function(e){return a.apply(this,arguments)})}],n&&_e(r.prototype,n),i&&_e(r,i),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,i,o,a}(d);function Pe(e){return Pe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Pe(e)}function ke(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Ce(n.key),n)}}function Ce(e){var t=function(e,t){if("object"!=Pe(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=Pe(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Pe(t)?t:t+""}function $e(e,t,r){return t=De(t),function(e,t){if(t&&("object"==Pe(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,Re()?Reflect.construct(t,r||[],De(e).constructor):t.apply(e,r))}function Re(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Re=function(){return!!e})()}function De(e){return De=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},De(e)}function Me(e,t){return Me=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Me(e,t)}var Le=function(e){function t(e,r){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=$e(this,t,[void 0,"varying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform vec2 pixelSize;\nuniform vec2 quarter;\nuniform vec2 _vrScale;\nuniform vec4 toPosTransform;\nuniform vec4 fromPosTransform;\nvec4 readTex(vec2 uv)\n{\n    return texture2D(uSampler, uv);\n}\nvec2 mapInsideChannel(vec2 pos)\n{\n    vec2 result = mod(pos, quarter) * 4.0;\n    result.y += floor(pos.x / quarter.x);\n    \n    return result;\n}\nvec4 extractChannel(vec4 c0, vec4 c1, vec4 c2, vec4 c3, float yPos)\n{\n    vec4 result = vec4(c0.r, c1.r, c2.r, c3.r);\n    \n    float condition = step(quarter.y, yPos);\n    result = mix(result, vec4(c0.g, c1.g, c2.g, c3.g), condition);\n    condition = step(2.0 * quarter.y, yPos);\n    result = mix(result, vec4(c0.b, c1.b, c2.b, c3.b), condition);\n    \n    \n    return result;\n}\nvec2 toPos(vec2 uv)\n{\n    return uv * toPosTransform.xy + toPosTransform.zw;\n}\nvec2 fromPos(vec2 pos)\n{\n    return ( pos * fromPosTransform.xy ) + fromPosTransform.zw;\n}\nvoid main()\n{\n    vec2 uv = vTextureCoord;\n    \n    vec2 pos = toPos(uv);\n    vec2 chPos = mapInsideChannel(pos);\n    uv = fromPos(chPos);\n    \n    vec4 c0 = readTex(uv);\n    uv.x += pixelSize.x; \n    vec4 c1 = readTex(uv);\n    uv.x += pixelSize.x; \n    vec4 c2 = readTex(uv);\n    uv.x += pixelSize.x; \n    vec4 c3 = readTex(uv);\n    gl_FragColor = extractChannel(c0, c1, c2, c3, pos.y);\n}"])).setSize(e,r),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Me(e,t)}(t,e),r=t,(n=[{key:"setSize",value:function(e,t){var r=e,n=t;t>128&&(n=256),e<256&&(r=256),this.virtualSize=new g.Point(e,t),this.realSize=new g.Point(r,n),this._vrScale=new g.Point(this.realSize.x/this.virtualSize.x,this.realSize.y/this.virtualSize.y),this.pixelSize=new g.Point(1/this.realSize.x,1/this.realSize.y),this.quarter=new g.Point(this.virtualSize.x/4,this.virtualSize.y/4),this.toPosTransform=[1/((this.virtualSize.x-1)*this.pixelSize.x)*(this.virtualSize.x-1),1/((this.virtualSize.y-1)*this.pixelSize.y)*(this.virtualSize.y-1),-.5*this.pixelSize.x*(1/((this.virtualSize.x-1)*this.pixelSize.x)*(this.virtualSize.x-1)),-.5*this.pixelSize.y*(1/((this.virtualSize.y-1)*this.pixelSize.y)*(this.virtualSize.y-1))],this.fromPosTransform=[(this.virtualSize.x-1)*this.pixelSize.x/(this.virtualSize.x-1),(this.virtualSize.y-1)*this.pixelSize.y/(this.virtualSize.y-1),.5*this.pixelSize.x,.5*this.pixelSize.y],this.uniforms.pixelSize=this.pixelSize,this.uniforms.quarter=this.quarter,this.uniforms.toPosTransform=this.toPosTransform,this.uniforms.fromPosTransform=this.fromPosTransform}}])&&ke(r.prototype,n),i&&ke(r,i),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,i}(g.Filter);function Be(e){return Be="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Be(e)}function Ne(){Ne=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,i=Object.defineProperty||function(e,t,r){e[t]=r.value},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function l(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,r){return e[t]=r}}function h(e,t,r,n){var o=t&&t.prototype instanceof g?t:g,a=Object.create(o.prototype),s=new k(n||[]);return i(a,"_invoke",{value:O(e,r,s)}),a}function c(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=h;var f="suspendedStart",d="suspendedYield",p="executing",y="completed",m={};function g(){}function w(){}function v(){}var b={};l(b,a,(function(){return this}));var x=Object.getPrototypeOf,_=x&&x(x(C([])));_&&_!==r&&n.call(_,a)&&(b=_);var S=v.prototype=g.prototype=Object.create(b);function T(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function E(e,t){function r(i,o,a,s){var u=c(e[i],e,o);if("throw"!==u.type){var l=u.arg,h=l.value;return h&&"object"==Be(h)&&n.call(h,"__await")?t.resolve(h.__await).then((function(e){r("next",e,a,s)}),(function(e){r("throw",e,a,s)})):t.resolve(h).then((function(e){l.value=e,a(l)}),(function(e){return r("throw",e,a,s)}))}s(u.arg)}var o;i(this,"_invoke",{value:function(e,n){function i(){return new t((function(t,i){r(e,n,t,i)}))}return o=o?o.then(i,i):i()}})}function O(t,r,n){var i=f;return function(o,a){if(i===p)throw Error("Generator is already running");if(i===y){if("throw"===o)throw a;return{value:e,done:!0}}for(n.method=o,n.arg=a;;){var s=n.delegate;if(s){var u=A(s,n);if(u){if(u===m)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===f)throw i=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i=p;var l=c(t,r,n);if("normal"===l.type){if(i=n.done?y:d,l.arg===m)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(i=y,n.method="throw",n.arg=l.arg)}}}function A(t,r){var n=r.method,i=t.iterator[n];if(i===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,A(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),m;var o=c(i,t.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,m;var a=o.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,m):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,m)}function I(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function P(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function k(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(I,this),this.reset(!0)}function C(t){if(t||""===t){var r=t[a];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,o=function r(){for(;++i<t.length;)if(n.call(t,i))return r.value=t[i],r.done=!1,r;return r.value=e,r.done=!0,r};return o.next=o}}throw new TypeError(Be(t)+" is not iterable")}return w.prototype=v,i(S,"constructor",{value:v,configurable:!0}),i(v,"constructor",{value:w,configurable:!0}),w.displayName=l(v,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===w||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,v):(e.__proto__=v,l(e,u,"GeneratorFunction")),e.prototype=Object.create(S),e},t.awrap=function(e){return{__await:e}},T(E.prototype),l(E.prototype,s,(function(){return this})),t.AsyncIterator=E,t.async=function(e,r,n,i,o){void 0===o&&(o=Promise);var a=new E(h(e,r,n,i),o);return t.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},T(S),l(S,u,"Generator"),l(S,a,(function(){return this})),l(S,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=C,k.prototype={constructor:k,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(P),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function i(n,i){return s.type="throw",s.arg=t,r.next=n,i&&(r.method="next",r.arg=e),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),l=n.call(a,"finallyLoc");if(u&&l){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return i(a.catchLoc,!0)}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,m):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),P(r),m}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;P(r)}return i}}throw Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:C(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),m}},t}function Fe(e,t,r,n,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void r(e)}s.done?t(u):Promise.resolve(u).then(n,i)}function Ue(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var o=e.apply(t,r);function a(e){Fe(o,n,i,a,s,"next",e)}function s(e){Fe(o,n,i,a,s,"throw",e)}a(void 0)}))}}function je(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ze(n.key),n)}}function ze(e){var t=function(e,t){if("object"!=Be(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=Be(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Be(t)?t:t+""}function Ge(e,t,r){return t=He(t),function(e,t){if(t&&("object"==Be(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,Ve()?Reflect.construct(t,r||[],He(e).constructor):t.apply(e,r))}function Ve(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Ve=function(){return!!e})()}function We(){return We="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=function(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=He(e)););return e}(e,t);if(n){var i=Object.getOwnPropertyDescriptor(n,t);return i.get?i.get.call(arguments.length<3?e:r):i.value}},We.apply(null,arguments)}function He(e){return He=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},He(e)}function qe(e,t){return qe=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},qe(e,t)}var Ye=function(e){function t(e){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(r=Ge(this,t,[e])).name=Vi.EYE_CONTACT,r.priority=18,r.requireNextFrame=!0,r.faceDetect={modelWidth:640,modelHeight:640,modelPath:"https://vbsdk.com/sdk/build/models/mnet.25_v2.simplify.onnx",backend:"wasm",nchw:!0},r.facePose={modelWidth:100,modelHeight:100,modelPath:"https://vbsdk.com/sdk/build/models/face_2dpose_106_static.onnx",backend:"wasm",nchw:!0},r.pixels=[],r.nchw=new Le(e.width,e.height),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&qe(e,t)}(t,e),r=t,n=[{key:"init",value:(a=Ue(Ne().mark((function e(t){return Ne().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.inference=t,e.next=3,this.inference.sessionManager.init(this.faceDetect,"data");case 3:return e.next=5,this.inference.sessionManager.init(this.facePose,"data");case 5:console.log("LOADED");case 6:case"end":return e.stop()}}),e,this)}))),function(e){return a.apply(this,arguments)})},{key:"nextFrame",value:function(e){this.pixels.length}},{key:"prepare",value:function(){}},{key:"process",value:(o=Ue(Ne().mark((function e(t){return Ne().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.pixels.length){e.next=2;break}return e.abrupt("return");case 2:case"end":return e.stop()}}),e,this)}))),function(e){return o.apply(this,arguments)})},{key:"disable",value:function(){var e,r,n,i,o;(e=t,r="disable",n=this,o=We(He(1&(i=3)?e.prototype:e),r,n),2&i&&"function"==typeof o?function(e){return o.apply(n,e)}:o)([])}},{key:"destroy",value:function(){}}],n&&je(r.prototype,n),i&&je(r,i),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,i,o,a}(d);function Xe(e){return Xe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Xe(e)}function Ke(){Ke=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,i=Object.defineProperty||function(e,t,r){e[t]=r.value},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function l(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,r){return e[t]=r}}function h(e,t,r,n){var o=t&&t.prototype instanceof g?t:g,a=Object.create(o.prototype),s=new k(n||[]);return i(a,"_invoke",{value:O(e,r,s)}),a}function c(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=h;var f="suspendedStart",d="suspendedYield",p="executing",y="completed",m={};function g(){}function w(){}function v(){}var b={};l(b,a,(function(){return this}));var x=Object.getPrototypeOf,_=x&&x(x(C([])));_&&_!==r&&n.call(_,a)&&(b=_);var S=v.prototype=g.prototype=Object.create(b);function T(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function E(e,t){function r(i,o,a,s){var u=c(e[i],e,o);if("throw"!==u.type){var l=u.arg,h=l.value;return h&&"object"==Xe(h)&&n.call(h,"__await")?t.resolve(h.__await).then((function(e){r("next",e,a,s)}),(function(e){r("throw",e,a,s)})):t.resolve(h).then((function(e){l.value=e,a(l)}),(function(e){return r("throw",e,a,s)}))}s(u.arg)}var o;i(this,"_invoke",{value:function(e,n){function i(){return new t((function(t,i){r(e,n,t,i)}))}return o=o?o.then(i,i):i()}})}function O(t,r,n){var i=f;return function(o,a){if(i===p)throw Error("Generator is already running");if(i===y){if("throw"===o)throw a;return{value:e,done:!0}}for(n.method=o,n.arg=a;;){var s=n.delegate;if(s){var u=A(s,n);if(u){if(u===m)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===f)throw i=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i=p;var l=c(t,r,n);if("normal"===l.type){if(i=n.done?y:d,l.arg===m)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(i=y,n.method="throw",n.arg=l.arg)}}}function A(t,r){var n=r.method,i=t.iterator[n];if(i===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,A(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),m;var o=c(i,t.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,m;var a=o.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,m):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,m)}function I(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function P(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function k(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(I,this),this.reset(!0)}function C(t){if(t||""===t){var r=t[a];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,o=function r(){for(;++i<t.length;)if(n.call(t,i))return r.value=t[i],r.done=!1,r;return r.value=e,r.done=!0,r};return o.next=o}}throw new TypeError(Xe(t)+" is not iterable")}return w.prototype=v,i(S,"constructor",{value:v,configurable:!0}),i(v,"constructor",{value:w,configurable:!0}),w.displayName=l(v,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===w||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,v):(e.__proto__=v,l(e,u,"GeneratorFunction")),e.prototype=Object.create(S),e},t.awrap=function(e){return{__await:e}},T(E.prototype),l(E.prototype,s,(function(){return this})),t.AsyncIterator=E,t.async=function(e,r,n,i,o){void 0===o&&(o=Promise);var a=new E(h(e,r,n,i),o);return t.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},T(S),l(S,u,"Generator"),l(S,a,(function(){return this})),l(S,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=C,k.prototype={constructor:k,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(P),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function i(n,i){return s.type="throw",s.arg=t,r.next=n,i&&(r.method="next",r.arg=e),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),l=n.call(a,"finallyLoc");if(u&&l){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return i(a.catchLoc,!0)}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,m):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),P(r),m}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;P(r)}return i}}throw Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:C(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),m}},t}function Ze(e,t,r,n,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void r(e)}s.done?t(u):Promise.resolve(u).then(n,i)}function Je(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Qe(n.key),n)}}function Qe(e){var t=function(e,t){if("object"!=Xe(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=Xe(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Xe(t)?t:t+""}function et(e,t,r){return t=rt(t),function(e,t){if(t&&("object"==Xe(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,tt()?Reflect.construct(t,r||[],rt(e).constructor):t.apply(e,r))}function tt(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(tt=function(){return!!e})()}function rt(e){return rt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},rt(e)}function nt(e,t){return nt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},nt(e,t)}var it=function(e){function t(e){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(r=et(this,t,[e])).name=Vi.FILTER_DRAW,r.priority=8,r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&nt(e,t)}(t,e),r=t,n=[{key:"process",value:(o=Ke().mark((function e(t){var r;return Ke().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.resources.filters.size){e.next=2;break}return e.abrupt("return");case 2:t.sprite.filters=[],this.resources.filters.forEach((function(e){var r;null===(r=t.sprite.filters)||void 0===r||r.push(e)})),r=this.resources.texturePool.get(this.sdkOptions.width,this.sdkOptions.height),this.resources.renderer.renderTo(t.sprite,r),t.sprite.filters=[],this.resources.texturePool.put(t.update(r));case 8:case"end":return e.stop()}}),e,this)})),a=function(){var e=this,t=arguments;return new Promise((function(r,n){var i=o.apply(e,t);function a(e){Ze(i,r,n,a,s,"next",e)}function s(e){Ze(i,r,n,a,s,"throw",e)}a(void 0)}))},function(e){return a.apply(this,arguments)})}],n&&Je(r.prototype,n),i&&Je(r,i),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,i,o,a}(d);function ot(e){return ot="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ot(e)}function at(){at=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,i=Object.defineProperty||function(e,t,r){e[t]=r.value},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function l(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,r){return e[t]=r}}function h(e,t,r,n){var o=t&&t.prototype instanceof g?t:g,a=Object.create(o.prototype),s=new k(n||[]);return i(a,"_invoke",{value:O(e,r,s)}),a}function c(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=h;var f="suspendedStart",d="suspendedYield",p="executing",y="completed",m={};function g(){}function w(){}function v(){}var b={};l(b,a,(function(){return this}));var x=Object.getPrototypeOf,_=x&&x(x(C([])));_&&_!==r&&n.call(_,a)&&(b=_);var S=v.prototype=g.prototype=Object.create(b);function T(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function E(e,t){function r(i,o,a,s){var u=c(e[i],e,o);if("throw"!==u.type){var l=u.arg,h=l.value;return h&&"object"==ot(h)&&n.call(h,"__await")?t.resolve(h.__await).then((function(e){r("next",e,a,s)}),(function(e){r("throw",e,a,s)})):t.resolve(h).then((function(e){l.value=e,a(l)}),(function(e){return r("throw",e,a,s)}))}s(u.arg)}var o;i(this,"_invoke",{value:function(e,n){function i(){return new t((function(t,i){r(e,n,t,i)}))}return o=o?o.then(i,i):i()}})}function O(t,r,n){var i=f;return function(o,a){if(i===p)throw Error("Generator is already running");if(i===y){if("throw"===o)throw a;return{value:e,done:!0}}for(n.method=o,n.arg=a;;){var s=n.delegate;if(s){var u=A(s,n);if(u){if(u===m)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===f)throw i=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i=p;var l=c(t,r,n);if("normal"===l.type){if(i=n.done?y:d,l.arg===m)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(i=y,n.method="throw",n.arg=l.arg)}}}function A(t,r){var n=r.method,i=t.iterator[n];if(i===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,A(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),m;var o=c(i,t.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,m;var a=o.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,m):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,m)}function I(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function P(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function k(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(I,this),this.reset(!0)}function C(t){if(t||""===t){var r=t[a];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,o=function r(){for(;++i<t.length;)if(n.call(t,i))return r.value=t[i],r.done=!1,r;return r.value=e,r.done=!0,r};return o.next=o}}throw new TypeError(ot(t)+" is not iterable")}return w.prototype=v,i(S,"constructor",{value:v,configurable:!0}),i(v,"constructor",{value:w,configurable:!0}),w.displayName=l(v,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===w||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,v):(e.__proto__=v,l(e,u,"GeneratorFunction")),e.prototype=Object.create(S),e},t.awrap=function(e){return{__await:e}},T(E.prototype),l(E.prototype,s,(function(){return this})),t.AsyncIterator=E,t.async=function(e,r,n,i,o){void 0===o&&(o=Promise);var a=new E(h(e,r,n,i),o);return t.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},T(S),l(S,u,"Generator"),l(S,a,(function(){return this})),l(S,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=C,k.prototype={constructor:k,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(P),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function i(n,i){return s.type="throw",s.arg=t,r.next=n,i&&(r.method="next",r.arg=e),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),l=n.call(a,"finallyLoc");if(u&&l){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return i(a.catchLoc,!0)}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,m):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),P(r),m}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;P(r)}return i}}throw Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:C(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),m}},t}function st(e,t,r,n,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void r(e)}s.done?t(u):Promise.resolve(u).then(n,i)}function ut(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,lt(n.key),n)}}function lt(e){var t=function(e,t){if("object"!=ot(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=ot(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==ot(t)?t:t+""}function ht(e,t,r){return t=ft(t),function(e,t){if(t&&("object"==ot(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,ct()?Reflect.construct(t,r||[],ft(e).constructor):t.apply(e,r))}function ct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(ct=function(){return!!e})()}function ft(e){return ft=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},ft(e)}function dt(e,t){return dt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},dt(e,t)}var pt=function(e){function t(e){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(r=ht(this,t,[e])).name=Vi.FINAL_DRAW,r.priority=100,r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&dt(e,t)}(t,e),r=t,n=[{key:"process",value:(o=at().mark((function e(t){return at().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.resources.renderer.addToEffects(t.sprite),this.resources.renderer.addStatistics(),this.resources.renderer.render(),this.resources.renderer.removeStatistics(),this.resources.renderer.removeFromEffects(t.sprite);case 5:case"end":return e.stop()}}),e,this)})),a=function(){var e=this,t=arguments;return new Promise((function(r,n){var i=o.apply(e,t);function a(e){st(i,r,n,a,s,"next",e)}function s(e){st(i,r,n,a,s,"throw",e)}a(void 0)}))},function(e){return a.apply(this,arguments)})}],n&&ut(r.prototype,n),i&&ut(r,i),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,i,o,a}(d);function yt(e){return yt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},yt(e)}function mt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,gt(n.key),n)}}function gt(e){var t=function(e,t){if("object"!=yt(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=yt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==yt(t)?t:t+""}function wt(e,t,r){return t=bt(t),function(e,t){if(t&&("object"==yt(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,vt()?Reflect.construct(t,r||[],bt(e).constructor):t.apply(e,r))}function vt(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(vt=function(){return!!e})()}function bt(e){return bt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},bt(e)}function xt(e,t){return xt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},xt(e,t)}var _t=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),wt(this,t,[void 0,"varying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform sampler2D uLL;\nuniform int uEnabled;\n\nvoid main() {\n  vec4 texel = texture2D(uSampler, vTextureCoord);\n\n  if (uEnabled == 0) {\n    gl_FragColor = vec4(texel);\n    return;\n  }\n\n  vec3 curve = texture2D(uLL, vTextureCoord).rgb * -0.5;\n\n  vec3 x = texel.rgb;\n\n  x = x + curve * (x * x - x);\n  x = x + curve * (x * x - x);\n  x = x + curve * (x * x - x);\n  x = x + curve * (x * x - x);\n  x = x + curve * (x * x - x);\n  x = x + curve * (x * x - x);\n\n  x = clamp(x, 0.0, 1.0);\n\n  gl_FragColor = vec4(x, texel.a);\n}\n",{uLL:g.Texture.EMPTY,uEnabled:0}])}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&xt(e,t)}(t,e),r=t,(n=[{key:"setLowLightTexture",value:function(e){this.uniforms.uLL=e,this.uniforms.uEnabled=1}}])&&mt(r.prototype,n),i&&mt(r,i),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,i}(g.Filter);var St={modelHeight:144,modelWidth:144,power:1};const Tt=Symbol("Comlink.proxy"),Et=Symbol("Comlink.endpoint"),Ot=Symbol("Comlink.releaseProxy"),At=Symbol("Comlink.finalizer"),It=Symbol("Comlink.thrown"),Pt=e=>"object"==typeof e&&null!==e||"function"==typeof e,kt=new Map([["proxy",{canHandle:e=>Pt(e)&&e[Tt],serialize(e){const{port1:t,port2:r}=new MessageChannel;return Ct(e,t),[r,[r]]},deserialize:e=>(e.start(),Rt(e))}],["throw",{canHandle:e=>Pt(e)&&It in e,serialize({value:e}){let t;return t=e instanceof Error?{isError:!0,value:{message:e.message,name:e.name,stack:e.stack}}:{isError:!1,value:e},[t,[]]},deserialize(e){if(e.isError)throw Object.assign(new Error(e.value.message),e.value);throw e.value}}]]);function Ct(e,t=globalThis,r=["*"]){t.addEventListener("message",(function n(i){if(!i||!i.data)return;if(!function(e,t){for(const r of e){if(t===r||"*"===r)return!0;if(r instanceof RegExp&&r.test(t))return!0}return!1}(r,i.origin))return void console.warn(`Invalid origin '${i.origin}' for comlink proxy`);const{id:o,type:a,path:s}=Object.assign({path:[]},i.data),u=(i.data.argumentList||[]).map(zt);let l;try{const t=s.slice(0,-1).reduce(((e,t)=>e[t]),e),r=s.reduce(((e,t)=>e[t]),e);switch(a){case"GET":l=r;break;case"SET":t[s.slice(-1)[0]]=zt(i.data.value),l=!0;break;case"APPLY":l=r.apply(t,u);break;case"CONSTRUCT":l=function(e){return Object.assign(e,{[Tt]:!0})}(new r(...u));break;case"ENDPOINT":{const{port1:t,port2:r}=new MessageChannel;Ct(e,r),l=function(e,t){return Ut.set(e,t),e}(t,[t])}break;case"RELEASE":l=void 0;break;default:return}}catch(e){l={value:e,[It]:0}}Promise.resolve(l).catch((e=>({value:e,[It]:0}))).then((r=>{const[i,s]=jt(r);t.postMessage(Object.assign(Object.assign({},i),{id:o}),s),"RELEASE"===a&&(t.removeEventListener("message",n),$t(t),At in e&&"function"==typeof e[At]&&e[At]())})).catch((e=>{const[r,n]=jt({value:new TypeError("Unserializable return value"),[It]:0});t.postMessage(Object.assign(Object.assign({},r),{id:o}),n)}))})),t.start&&t.start()}function $t(e){(function(e){return"MessagePort"===e.constructor.name})(e)&&e.close()}function Rt(e,t){const r=new Map;return e.addEventListener("message",(function(e){const{data:t}=e;if(!t||!t.id)return;const n=r.get(t.id);if(n)try{n(t)}finally{r.delete(t.id)}})),Nt(e,r,[],t)}function Dt(e){if(e)throw new Error("Proxy has been released and is not useable")}function Mt(e){return Gt(e,new Map,{type:"RELEASE"}).then((()=>{$t(e)}))}const Lt=new WeakMap,Bt="FinalizationRegistry"in globalThis&&new FinalizationRegistry((e=>{const t=(Lt.get(e)||0)-1;Lt.set(e,t),0===t&&Mt(e)}));function Nt(e,t,r=[],n=function(){}){let i=!1;const o=new Proxy(n,{get(n,a){if(Dt(i),a===Ot)return()=>{!function(e){Bt&&Bt.unregister(e)}(o),Mt(e),t.clear(),i=!0};if("then"===a){if(0===r.length)return{then:()=>o};const n=Gt(e,t,{type:"GET",path:r.map((e=>e.toString()))}).then(zt);return n.then.bind(n)}return Nt(e,t,[...r,a])},set(n,o,a){Dt(i);const[s,u]=jt(a);return Gt(e,t,{type:"SET",path:[...r,o].map((e=>e.toString())),value:s},u).then(zt)},apply(n,o,a){Dt(i);const s=r[r.length-1];if(s===Et)return Gt(e,t,{type:"ENDPOINT"}).then(zt);if("bind"===s)return Nt(e,t,r.slice(0,-1));const[u,l]=Ft(a);return Gt(e,t,{type:"APPLY",path:r.map((e=>e.toString())),argumentList:u},l).then(zt)},construct(n,o){Dt(i);const[a,s]=Ft(o);return Gt(e,t,{type:"CONSTRUCT",path:r.map((e=>e.toString())),argumentList:a},s).then(zt)}});return function(e,t){const r=(Lt.get(t)||0)+1;Lt.set(t,r),Bt&&Bt.register(e,t,e)}(o,e),o}function Ft(e){const t=e.map(jt);return[t.map((e=>e[0])),(r=t.map((e=>e[1])),Array.prototype.concat.apply([],r))];var r}const Ut=new WeakMap;function jt(e){for(const[t,r]of kt)if(r.canHandle(e)){const[n,i]=r.serialize(e);return[{type:"HANDLER",name:t,value:n},i]}return[{type:"RAW",value:e},Ut.get(e)||[]]}function zt(e){switch(e.type){case"HANDLER":return kt.get(e.name).deserialize(e.value);case"RAW":return e.value}}function Gt(e,t,r,n){return new Promise((i=>{const o=new Array(4).fill(0).map((()=>Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16))).join("-");t.set(o,i),e.start&&e.start(),e.postMessage(Object.assign({id:o},r),n)}))}var Vt=r(9380);function Wt(e){return Wt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Wt(e)}function Ht(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,qt(n.key),n)}}function qt(e){var t=function(e,t){if("object"!=Wt(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=Wt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Wt(t)?t:t+""}function Yt(e){return Yt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Yt(e)}function Xt(){Xt=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,i=Object.defineProperty||function(e,t,r){e[t]=r.value},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function l(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,r){return e[t]=r}}function h(e,t,r,n){var o=t&&t.prototype instanceof g?t:g,a=Object.create(o.prototype),s=new k(n||[]);return i(a,"_invoke",{value:O(e,r,s)}),a}function c(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=h;var f="suspendedStart",d="suspendedYield",p="executing",y="completed",m={};function g(){}function w(){}function v(){}var b={};l(b,a,(function(){return this}));var x=Object.getPrototypeOf,_=x&&x(x(C([])));_&&_!==r&&n.call(_,a)&&(b=_);var S=v.prototype=g.prototype=Object.create(b);function T(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function E(e,t){function r(i,o,a,s){var u=c(e[i],e,o);if("throw"!==u.type){var l=u.arg,h=l.value;return h&&"object"==Yt(h)&&n.call(h,"__await")?t.resolve(h.__await).then((function(e){r("next",e,a,s)}),(function(e){r("throw",e,a,s)})):t.resolve(h).then((function(e){l.value=e,a(l)}),(function(e){return r("throw",e,a,s)}))}s(u.arg)}var o;i(this,"_invoke",{value:function(e,n){function i(){return new t((function(t,i){r(e,n,t,i)}))}return o=o?o.then(i,i):i()}})}function O(t,r,n){var i=f;return function(o,a){if(i===p)throw Error("Generator is already running");if(i===y){if("throw"===o)throw a;return{value:e,done:!0}}for(n.method=o,n.arg=a;;){var s=n.delegate;if(s){var u=A(s,n);if(u){if(u===m)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===f)throw i=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i=p;var l=c(t,r,n);if("normal"===l.type){if(i=n.done?y:d,l.arg===m)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(i=y,n.method="throw",n.arg=l.arg)}}}function A(t,r){var n=r.method,i=t.iterator[n];if(i===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,A(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),m;var o=c(i,t.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,m;var a=o.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,m):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,m)}function I(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function P(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function k(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(I,this),this.reset(!0)}function C(t){if(t||""===t){var r=t[a];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,o=function r(){for(;++i<t.length;)if(n.call(t,i))return r.value=t[i],r.done=!1,r;return r.value=e,r.done=!0,r};return o.next=o}}throw new TypeError(Yt(t)+" is not iterable")}return w.prototype=v,i(S,"constructor",{value:v,configurable:!0}),i(v,"constructor",{value:w,configurable:!0}),w.displayName=l(v,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===w||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,v):(e.__proto__=v,l(e,u,"GeneratorFunction")),e.prototype=Object.create(S),e},t.awrap=function(e){return{__await:e}},T(E.prototype),l(E.prototype,s,(function(){return this})),t.AsyncIterator=E,t.async=function(e,r,n,i,o){void 0===o&&(o=Promise);var a=new E(h(e,r,n,i),o);return t.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},T(S),l(S,u,"Generator"),l(S,a,(function(){return this})),l(S,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=C,k.prototype={constructor:k,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(P),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function i(n,i){return s.type="throw",s.arg=t,r.next=n,i&&(r.method="next",r.arg=e),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),l=n.call(a,"finallyLoc");if(u&&l){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return i(a.catchLoc,!0)}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,m):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),P(r),m}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;P(r)}return i}}throw Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:C(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),m}},t}function Kt(e,t,r,n,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void r(e)}s.done?t(u):Promise.resolve(u).then(n,i)}function Zt(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var o=e.apply(t,r);function a(e){Kt(o,n,i,a,s,"next",e)}function s(e){Kt(o,n,i,a,s,"throw",e)}a(void 0)}))}}function Jt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Qt(n.key),n)}}function Qt(e){var t=function(e,t){if("object"!=Yt(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=Yt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Yt(t)?t:t+""}function er(e,t,r){return t=ir(t),function(e,t){if(t&&("object"==Yt(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,tr()?Reflect.construct(t,r||[],ir(e).constructor):t.apply(e,r))}function tr(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(tr=function(){return!!e})()}function rr(e,t,r,n){var i=nr(ir(1&n?e.prototype:e),t,r);return 2&n&&"function"==typeof i?function(e){return i.apply(r,e)}:i}function nr(){return nr="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=function(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=ir(e)););return e}(e,t);if(n){var i=Object.getOwnPropertyDescriptor(n,t);return i.get?i.get.call(arguments.length<3?e:r):i.value}},nr.apply(null,arguments)}function ir(e){return ir=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},ir(e)}function or(e,t){return or=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},or(e,t)}var ar=new(function(){return e=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var r=URL.createObjectURL(new Blob([t.toString()],{type:"application/javascript"}));this.worker=new Worker(r),setTimeout((function(){return URL.revokeObjectURL(r)}))},(t=[{key:"getWorker",value:function(){return this.worker}}])&&Ht(e.prototype,t),r&&Ht(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,r}())('/*! For license information please see lowLight-worker.js.LICENSE.txt */\n(()=>{"use strict";function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(e)}function e(t,e){for(var r=0;r<e.length;r++){var a=e[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,n(a.key),a)}}function n(e){var n=function(e,n){if("object"!=t(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,n||"default");if("object"!=t(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(e)}(e,"string");return"symbol"==t(n)?n:n+""}var r=.008856,a=1/Math.sqrt(2),o=1/Math.sqrt(3),i=1/Math.sqrt(6),u=Math.log(10),s=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)},s=[{key:"RGBtoXYZ",value:function(t){var e=t.R,n=t.G,r=t.B;return{X:.412453*(e=a(e))+.35758*(n=a(n))+.180423*(r=a(r)),Y:.212671*e+.71516*n+.072169*r,Z:.019334*e+.119193*n+.950227*r};function a(t){return(t/=255)>.04045?Math.pow((t+.055)/1.055,2.4):t/12.92}}},{key:"RGBtoCIELab",value:function(t){return this.XYZtoCIELab(this.RGBtoXYZ(t))}},{key:"RGBtoLMS",value:function(t){var e=t.R,n=t.G,r=t.B;return{L:(.3811*e+.5783*n+.0402*r)/255,M:(.1967*e+.7244*n+.0782*r)/255,S:(.0241*e+.1288*n+.8444*r)/255}}},{key:"RGBtoLab",value:function(t){return this.LMStoLab(this.RGBtoLMS(t))}},{key:"RGBtoY",value:function(t){return{Y:(.299*t.R+.587*t.G+.114*t.B)/255}}},{key:"XYZtoRGB",value:function(t){var e=t.X,n=t.Y,r=t.Z,a=u(3.2406*e+-1.5372*n+-.4986*r),o=u(-.9689*e+1.8758*n+.0415*r),i=u(.0557*e+-.204*n+1.057*r);return{R:l(255*a),G:l(255*o),B:l(255*i)};function u(t){return t>.0031308?1.055*Math.pow(t,1/2.4)-.055:12.92*t}}},{key:"XYZtoCIELab",value:function(t){var e=t.X,n=t.Y,a=t.Z,o=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=n>r?116*Math.pow(n,1/3)-16:903.3*n,u=500*(l(e)-l(n)),s=200*(l(n)-l(a));return o?this.normalizeCIELab({L:i,a:u,b:s}):{L:i,a:u,b:s};function l(t){return t>r?Math.pow(t,1/3):7.787*t+16/116}}},{key:"CIELabtoXYZ",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&!arguments[1]?t:this.normalizeBackCIELab(t),n=e.L,a=e.a,o=e.b,i=(n+16)/116,u=l(a/500+i),s=l(i-o/200);return{X:u,Y:l(i),Z:s};function l(t){var e=Math.pow(t,3);return e>r?e:(t-16/116)/7.787}}},{key:"CIELabtoRGB",value:function(t){return this.XYZtoRGB(this.CIELabtoXYZ(t))}},{key:"normalizeCIELab",value:function(t){return{L:t.L/100,a:(t.a+128)/255,b:(t.b+128)/255}}},{key:"normalizeBackCIELab",value:function(t){var e=t.L,n=t.a,r=t.b;return{L:Math.min(100,Math.max(0,100*e)),a:Math.min(127,Math.max(-127,255*n-128)),b:Math.min(127,Math.max(-127,255*r-128))}}},{key:"LMStoRGB",value:function(t){var e=t.L,n=t.M,r=t.S;return{R:l(255*(4.4686*e-3.5886*n+.1196*r)),G:l(255*(-1.2197*e+2.383*n-.1626*r)),B:l(255*(.0585*e-.261*n+1.2056*r))}}},{key:"LMStoLab",value:function(t){var e=t.L,n=t.M,r=t.S;e=Math.max(e,1/255),n=Math.max(n,1/255),r=Math.max(r,1/255);var s=Math.log(e)/u,l=Math.log(n)/u,c=Math.log(r)/u;return{L:(s+l+c)*o,a:(s+l-2*c)*i,b:(s-l)*a}}},{key:"LabtoRGB",value:function(t){return this.LMStoRGB(this.LabtoLMS(t))}},{key:"LabtoLMS",value:function(t){var e=t.L,n=t.a,r=t.b;return e*=o,n*=i,r*=a,{L:Math.pow(10,e+n+r),M:Math.pow(10,e+n-r),S:Math.pow(10,e-2*n)}}}],(n=null)&&e(t.prototype,n),s&&e(t,s),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,n,s}();function l(t){return Math.min(255,Math.max(0,t))}function c(t){return c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},c(t)}function f(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,h(r.key),r)}}function h(t){var e=function(t,e){if("object"!=c(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=c(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==c(e)?e:e+""}var v=function(){return t=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.aAverage={},this.stdDev={},this.sum={},this.sumSqr={},this.pixelsCount=e},(e=[{key:"addPixel",value:function(t){var e=this;Object.keys(t).forEach((function(n){var r,a;e.sum[n]=(null!==(r=e.sum[n])&&void 0!==r?r:0)+t[n],e.sumSqr[n]=(null!==(a=e.sumSqr[n])&&void 0!==a?a:0)+Math.pow(t[n],2)}))}},{key:"countAverage",value:function(){var t=this;return Object.keys(this.sum).forEach((function(e){var n;t.aAverage[e]=(null!==(n=t.sum[e])&&void 0!==n?n:0)/t.pixelsCount})),this.aAverage}},{key:"countStdDev",value:function(){var t=this;return Object.keys(this.sumSqr).forEach((function(e){var n,r,a=(null!==(n=t.sumSqr[e])&&void 0!==n?n:0)-t.pixelsCount*Math.pow(null!==(r=t.aAverage[e])&&void 0!==r?r:0,2);t.stdDev[e]=Math.sqrt(+a.toFixed(5)/(t.pixelsCount-1))})),this.stdDev}}])&&f(t.prototype,e),n&&f(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n}();function b(t){return b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},b(t)}function y(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,m(r.key),r)}}function m(t){var e=function(t,e){if("object"!=b(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=b(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==b(e)?e:e+""}var p=function(){return t=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.dataRGBa=e,this.pixelsCount=e.length/4,this.channelsCIELab=new v(this.pixelsCount),this.channelsLab=new v(this.pixelsCount),this.channelsY=new v(this.pixelsCount)},(e=[{key:"countAverage",value:function(){this.channelsCIELab.countAverage(),this.channelsLab.countAverage(),this.channelsY.countAverage()}},{key:"countStdDev",value:function(){this.channelsCIELab.countStdDev(),this.channelsLab.countStdDev(),this.channelsY.countStdDev()}}])&&y(t.prototype,e),n&&y(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n}();function d(t){return d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},d(t)}function g(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,S(r.key),r)}}function L(t,e,n){return e&&g(t.prototype,e),n&&g(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function S(t){var e=function(t,e){if("object"!=d(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=d(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==d(e)?e:e+""}function w(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var E=36;function M(t,e,n){return t*(1-n)+e*n}var R=L((function t(e,n,r){w(this,t),this.refMean=e,this.targetMean=n,this.stdDev=r})),k=function(){return L((function t(e,n){w(this,t),this.cieL=this.makeTransferStatsFromChannel(n.channelsCIELab,e.channelsCIELab,"L",1),this.cieA=this.makeTransferStatsFromChannel(n.channelsCIELab,e.channelsCIELab,"a",1),this.cieB=this.makeTransferStatsFromChannel(n.channelsCIELab,e.channelsCIELab,"b",1),this.L=this.makeTransferStatsFromChannel(n.channelsLab,e.channelsLab,"L",1),this.A=this.makeTransferStatsFromChannel(n.channelsLab,e.channelsLab,"a",1),this.B=this.makeTransferStatsFromChannel(n.channelsLab,e.channelsLab,"b",1),this.grayY=this.makeTransferStatsFromChannel(n.channelsY,e.channelsY,"Y",1)}),[{key:"transfer",value:function(t){var e=s.RGBtoCIELab(t);e.L=this.transferValue(e.L,this.cieL),e.a=this.transferValue(e.a,this.cieA),e.b=this.transferValue(e.b,this.cieB);var n=s.CIELabtoRGB(e),r=s.RGBtoLab(t);r.L=this.transferValue(r.L,this.L),r.a=this.transferValue(r.a,this.A),r.b=this.transferValue(r.b,this.B);var a=s.LabtoRGB(r),o={R:M(n.R,a.R,.4),G:M(n.G,a.G,.4),B:M(n.B,a.B,.4)},i=s.RGBtoY(t).Y,u=this.recoverShadowsByFullShading(o,i);return{R:M(u.R,255*i,.1),G:M(u.G,255*i,.1),B:M(u.B,255*i,.1)}}},{key:"transferValue",value:function(t,e){return(t-e.targetMean)*e.stdDev+e.refMean}},{key:"recoverShadowsByFullShading",value:function(t,e){var n=Math.max(s.RGBtoY(t).Y,1/255),r=Math.max(this.transferValue(e,this.grayY),0);return{R:t.R/n*r,G:t.G/n*r,B:t.B/n*r}}},{key:"makeTransferStats",value:function(t,e,n,r,a){var o=M(n,t,a),i=1/r*M(r,e,a);return new R(o,n,i)}},{key:"makeTransferStatsFromChannel",value:function(t,e,n,r){var a,o,i,u;return this.makeTransferStats(null!==(a=t.aAverage[n])&&void 0!==a?a:0,null!==(o=t.stdDev[n])&&void 0!==o?o:0,null!==(i=e.aAverage[n])&&void 0!==i?i:0,null!==(u=e.stdDev[n])&&void 0!==u?u:0,r)}}])}();var C=function(){return L((function t(){w(this,t)}),[{key:"process",value:function(t,e){for(var n=new p(t),r=new p(e),a=0;a<n.dataRGBa.length;a+=4){var o={R:n.dataRGBa[a+0],G:n.dataRGBa[a+1],B:n.dataRGBa[a+2]},i={R:r.dataRGBa[a+0],G:r.dataRGBa[a+1],B:r.dataRGBa[a+2]},u=s.RGBtoCIELab(o),l=s.RGBtoCIELab(i);n.channelsCIELab.addPixel(u),r.channelsCIELab.addPixel(l);var c=s.RGBtoLab(o),f=s.RGBtoLab(i);n.channelsLab.addPixel(c),r.channelsLab.addPixel(f);var h=s.RGBtoY(o),v=s.RGBtoY(i);n.channelsY.addPixel(h),r.channelsY.addPixel(v)}n.countAverage(),r.countAverage(),n.countStdDev(),r.countStdDev();for(var b,y,m,d=new k(n,r),g=new Uint8ClampedArray(186624),L=255/35,S=0;S<E;++S)for(var w=0;w<E;++w)for(var M=0;M<E;++M){var R={R:M*L,G:w*L,B:S*L},C=d.transfer(R),B=4*(b=M,y=w,m=S,216*(Math.trunc(m/6)*E+y)+(m%6*E+b));g[B++]=C.R,g[B++]=C.G,g[B++]=C.B,g[B]=255}return g}}])}();const B=Symbol("Comlink.proxy"),G=Symbol("Comlink.endpoint"),P=Symbol("Comlink.releaseProxy"),T=Symbol("Comlink.finalizer"),x=Symbol("Comlink.thrown"),A=t=>"object"==typeof t&&null!==t||"function"==typeof t,Y={canHandle:t=>A(t)&&t[B],serialize(t){const{port1:e,port2:n}=new MessageChannel;return I(t,e),[n,[n]]},deserialize:t=>(t.start(),function(t,e){const n=new Map;return t.addEventListener("message",(function(t){const{data:e}=t;if(!e||!e.id)return;const r=n.get(e.id);if(r)try{r(e)}finally{n.delete(e.id)}})),X(t,n,[],e)}(t))},j=new Map([["proxy",Y],["throw",{canHandle:t=>A(t)&&x in t,serialize({value:t}){let e;return e=t instanceof Error?{isError:!0,value:{message:t.message,name:t.name,stack:t.stack}}:{isError:!1,value:t},[e,[]]},deserialize(t){if(t.isError)throw Object.assign(new Error(t.value.message),t.value);throw t.value}}]]);function I(t,e=globalThis,n=["*"]){e.addEventListener("message",(function r(a){if(!a||!a.data)return;if(!function(t,e){for(const n of t){if(e===n||"*"===n)return!0;if(n instanceof RegExp&&n.test(e))return!0}return!1}(n,a.origin))return void console.warn(`Invalid origin \'${a.origin}\' for comlink proxy`);const{id:o,type:i,path:u}=Object.assign({path:[]},a.data),s=(a.data.argumentList||[]).map(U);let l;try{const e=u.slice(0,-1).reduce(((t,e)=>t[e]),t),n=u.reduce(((t,e)=>t[e]),t);switch(i){case"GET":l=n;break;case"SET":e[u.slice(-1)[0]]=U(a.data.value),l=!0;break;case"APPLY":l=n.apply(e,s);break;case"CONSTRUCT":l=function(t){return Object.assign(t,{[B]:!0})}(new n(...s));break;case"ENDPOINT":{const{port1:e,port2:n}=new MessageChannel;I(t,n),l=function(t,e){return q.set(t,e),t}(e,[e])}break;case"RELEASE":l=void 0;break;default:return}}catch(t){l={value:t,[x]:0}}Promise.resolve(l).catch((t=>({value:t,[x]:0}))).then((n=>{const[a,u]=V(n);e.postMessage(Object.assign(Object.assign({},a),{id:o}),u),"RELEASE"===i&&(e.removeEventListener("message",r),O(e),T in t&&"function"==typeof t[T]&&t[T]())})).catch((t=>{const[n,r]=V({value:new TypeError("Unserializable return value"),[x]:0});e.postMessage(Object.assign(Object.assign({},n),{id:o}),r)}))})),e.start&&e.start()}function O(t){(function(t){return"MessagePort"===t.constructor.name})(t)&&t.close()}function D(t){if(t)throw new Error("Proxy has been released and is not useable")}function F(t){return H(t,new Map,{type:"RELEASE"}).then((()=>{O(t)}))}const z=new WeakMap,N="FinalizationRegistry"in globalThis&&new FinalizationRegistry((t=>{const e=(z.get(t)||0)-1;z.set(t,e),0===e&&F(t)}));function X(t,e,n=[],r=function(){}){let a=!1;const o=new Proxy(r,{get(r,i){if(D(a),i===P)return()=>{!function(t){N&&N.unregister(t)}(o),F(t),e.clear(),a=!0};if("then"===i){if(0===n.length)return{then:()=>o};const r=H(t,e,{type:"GET",path:n.map((t=>t.toString()))}).then(U);return r.then.bind(r)}return X(t,e,[...n,i])},set(r,o,i){D(a);const[u,s]=V(i);return H(t,e,{type:"SET",path:[...n,o].map((t=>t.toString())),value:u},s).then(U)},apply(r,o,i){D(a);const u=n[n.length-1];if(u===G)return H(t,e,{type:"ENDPOINT"}).then(U);if("bind"===u)return X(t,e,n.slice(0,-1));const[s,l]=Z(i);return H(t,e,{type:"APPLY",path:n.map((t=>t.toString())),argumentList:s},l).then(U)},construct(r,o){D(a);const[i,u]=Z(o);return H(t,e,{type:"CONSTRUCT",path:n.map((t=>t.toString())),argumentList:i},u).then(U)}});return function(t,e){const n=(z.get(e)||0)+1;z.set(e,n),N&&N.register(t,e,t)}(o,t),o}function Z(t){const e=t.map(V);return[e.map((t=>t[0])),(n=e.map((t=>t[1])),Array.prototype.concat.apply([],n))];var n}const q=new WeakMap;function V(t){for(const[e,n]of j)if(n.canHandle(t)){const[r,a]=n.serialize(t);return[{type:"HANDLER",name:e,value:r},a]}return[{type:"RAW",value:t},q.get(t)||[]]}function U(t){switch(t.type){case"HANDLER":return j.get(t.name).deserialize(t.value);case"RAW":return t.value}}function H(t,e,n,r){return new Promise((a=>{const o=new Array(4).fill(0).map((()=>Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16))).join("-");e.set(o,a),t.start&&t.start(),t.postMessage(Object.assign({id:o},n),r)}))}var W=new C;I({getLUTTexture:function(t,e){return W.process(t,e)},prepareCurveTexture:function(t,e,n){for(var r=e*n,a=r,o=new Float32Array(e*n*4),i=0;i<a;i++)o[4*i+0]=-2*t[i+0]*255,o[4*i+1]=-2*t[i+r]*255,o[4*i+2]=-2*t[i+2*r]*255,o[4*i+3]=255;return new Uint8ClampedArray(o)}})})();'),sr=function(e){function t(e){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(r=er(this,t,[e])).name=Vi.LOW_LIGHT,r.priority=4,r.setConfig(St),r.worker=Rt(ar.getWorker()),r.filterName="low-light",r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&or(e,t)}(t,e),r=t,n=[{key:"init",value:(s=Zt(Xt().mark((function e(r){return Xt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.modelConfig||(this.modelConfig={modelPath:O.y.getModelUrl(O.y.MODELS.lowlighter),backend:"wasm",nchw:!1}),e.next=3,rr(t,"init",this,3)([r]);case 3:case"end":return e.stop()}}),e,this)}))),function(e){return s.apply(this,arguments)})},{key:"prepare",value:function(){this.filterLowLight=new _t,this.filterLUT=new q}},{key:"process",value:(a=Zt(Xt().mark((function e(t){return Xt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.enabled){e.next=2;break}return e.abrupt("return");case 2:this.isOutdatedLUT&&this.updateLUT(t),this.resources.filters.set(this.filterName,this.filterLUT);case 4:case"end":return e.stop()}}),e,this)}))),function(e){return a.apply(this,arguments)})},{key:"setConfig",value:function(e){var t;this.config=Object.assign(null!==(t=this.config)&&void 0!==t?t:{},e),this.setFilterPower(e.power)}},{key:"onSuccess",value:function(e){var t="function"==typeof e;this.onSuccessFunction=t?e:void 0}},{key:"enable",value:function(){rr(t,"enable",this,3)([]),this.isOutdatedLUT=!this.inWork}},{key:"disable",value:function(){rr(t,"disable",this,3)([]),this.resources.filters.delete(this.filterName)}},{key:"updateLUT",value:function(e){var t=this;if(!this.inWork){this.inWork=!0;var r=this.config,n=r.modelHeight,o=r.modelWidth,a=this.resources.texturePool.get(this.sdkOptions.width,this.sdkOptions.height),s=this.resources.texturePool.get(this.sdkOptions.width,this.sdkOptions.height),u=this.resources.texturePool.get(o,n),l=new Vt.w(a,{width:this.sdkOptions.width,height:this.sdkOptions.height});l.sprite.width=this.sdkOptions.width,l.sprite.height=this.sdkOptions.height,this.resources.renderer.renderTo(e.sprite,a),l.sprite.width=o,l.sprite.height=n,this.resources.renderer.renderTo(l.sprite,u);var h=this.resources.renderer.pixels(u),c=this.resources.bufferPool.getBuffer("f32",3*o*n);!function(e,t,r,n){for(var i=r*t,o=2*r*t,a=0;a<n.length/3;a++)n[0+a]=e[4*a+2]/255,n[i+a]=e[4*a+1]/255,n[o+a]=e[4*a]/255}(new Uint8ClampedArray(h),o,n,c);var f=this.inference.sessionManager.getSession(this.modelConfig.modelPath);this.inference.run(f,c,o,n,3).then(function(){var e=Zt(Xt().mark((function e(r){var n,i,o,a;return Xt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.coefs.dims[3],i=r.coefs.dims[2],e.next=4,t.worker.prepareCurveTexture(r.coefs.data,n,i);case 4:return o=e.sent,a=t.resources.renderer.createTextureFromBuffer(new Uint8Array(o),n,i),e.abrupt("return",a);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).then((function(e){l.sprite.width=t.sdkOptions.width,l.sprite.height=t.sdkOptions.height,l.sprite.filters=[t.filterLowLight],t.filterLowLight.setLowLightTexture(e),t.resources.renderer.renderTo(l.sprite,s),l.sprite.filters=[];var r=t.resources.renderer.pixels(s),n=t.resources.renderer.pixels(a);return t.worker.getLUTTexture(new Uint8ClampedArray(n),new Uint8ClampedArray(r))})).then((function(e){t.applyLowlightLUT(e),t.emitSuccess()})).catch((function(e){var t;i.bv.notify({message:null!==(t=e.message)&&void 0!==t?t:e,type:i.By.ERROR,code:i.O4.INFERENCE_RUN_ISSUE,emitter:i.JK.EFFECT_LOW_LIGHT,cause:e})})).finally((function(){t.inWork=!1,t.isOutdatedLUT=!1,t.resources.texturePool.put(a),t.resources.texturePool.put(s),t.resources.texturePool.put(u)}))}}},{key:"applyLowlightLUT",value:function(e){var t=this.getLutTextureData(e).LUTTexture;this.filterLUT.setLUT({texture:t})}},{key:"getLutTextureData",value:function(e){var t=Math.sqrt(e.length/4);return{LUTTexture:g.Texture.fromBuffer(new Uint8Array(e),t,t,{scaleMode:1}),LUTSize:t}}},{key:"setFilterPower",value:function(e){var t;void 0!==e&&(this.config.power=e,null===(t=this.filterLUT)||void 0===t||t.setFilterPower(e))}},{key:"emitSuccess",value:function(){"function"==typeof this.onSuccessFunction&&this.onSuccessFunction()}},{key:"destroy",value:function(){this.inference.sessionManager.releaseSession(this.modelConfig.modelPath)}}],n&&Jt(r.prototype,n),o&&Jt(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o,a,s}(d);function ur(e){return ur="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ur(e)}function lr(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,hr(n.key),n)}}function hr(e){var t=function(e,t){if("object"!=ur(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=ur(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==ur(t)?t:t+""}function cr(e,t,r){return t=dr(t),function(e,t){if(t&&("object"==ur(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,fr()?Reflect.construct(t,r||[],dr(e).constructor):t.apply(e,r))}function fr(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(fr=function(){return!!e})()}function dr(e){return dr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},dr(e)}function pr(e,t){return pr=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},pr(e,t)}var yr=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),cr(this,t,["attribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\nuniform mat3 uTransformMatrix;\n\nvec4 filterVertexPosition(void ) {\n  vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.0)) + outputFrame.xy;\n\n  return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord(void ) {\n  return vec2(1.0 - aVertexPosition.x, aVertexPosition.y) * (outputFrame.zw * inputSize.zw);\n}\n\nvoid main(void ) {\n  gl_Position = filterVertexPosition();\n  vTextureCoord = filterTextureCoord();\n}\n",void 0])}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&pr(e,t)}(t,e),r=t,n&&lr(r.prototype,n),i&&lr(r,i),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,i}(g.Filter);function mr(e){return mr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},mr(e)}function gr(){gr=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,i=Object.defineProperty||function(e,t,r){e[t]=r.value},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function l(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,r){return e[t]=r}}function h(e,t,r,n){var o=t&&t.prototype instanceof g?t:g,a=Object.create(o.prototype),s=new k(n||[]);return i(a,"_invoke",{value:O(e,r,s)}),a}function c(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=h;var f="suspendedStart",d="suspendedYield",p="executing",y="completed",m={};function g(){}function w(){}function v(){}var b={};l(b,a,(function(){return this}));var x=Object.getPrototypeOf,_=x&&x(x(C([])));_&&_!==r&&n.call(_,a)&&(b=_);var S=v.prototype=g.prototype=Object.create(b);function T(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function E(e,t){function r(i,o,a,s){var u=c(e[i],e,o);if("throw"!==u.type){var l=u.arg,h=l.value;return h&&"object"==mr(h)&&n.call(h,"__await")?t.resolve(h.__await).then((function(e){r("next",e,a,s)}),(function(e){r("throw",e,a,s)})):t.resolve(h).then((function(e){l.value=e,a(l)}),(function(e){return r("throw",e,a,s)}))}s(u.arg)}var o;i(this,"_invoke",{value:function(e,n){function i(){return new t((function(t,i){r(e,n,t,i)}))}return o=o?o.then(i,i):i()}})}function O(t,r,n){var i=f;return function(o,a){if(i===p)throw Error("Generator is already running");if(i===y){if("throw"===o)throw a;return{value:e,done:!0}}for(n.method=o,n.arg=a;;){var s=n.delegate;if(s){var u=A(s,n);if(u){if(u===m)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===f)throw i=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i=p;var l=c(t,r,n);if("normal"===l.type){if(i=n.done?y:d,l.arg===m)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(i=y,n.method="throw",n.arg=l.arg)}}}function A(t,r){var n=r.method,i=t.iterator[n];if(i===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,A(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),m;var o=c(i,t.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,m;var a=o.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,m):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,m)}function I(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function P(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function k(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(I,this),this.reset(!0)}function C(t){if(t||""===t){var r=t[a];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,o=function r(){for(;++i<t.length;)if(n.call(t,i))return r.value=t[i],r.done=!1,r;return r.value=e,r.done=!0,r};return o.next=o}}throw new TypeError(mr(t)+" is not iterable")}return w.prototype=v,i(S,"constructor",{value:v,configurable:!0}),i(v,"constructor",{value:w,configurable:!0}),w.displayName=l(v,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===w||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,v):(e.__proto__=v,l(e,u,"GeneratorFunction")),e.prototype=Object.create(S),e},t.awrap=function(e){return{__await:e}},T(E.prototype),l(E.prototype,s,(function(){return this})),t.AsyncIterator=E,t.async=function(e,r,n,i,o){void 0===o&&(o=Promise);var a=new E(h(e,r,n,i),o);return t.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},T(S),l(S,u,"Generator"),l(S,a,(function(){return this})),l(S,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=C,k.prototype={constructor:k,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(P),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function i(n,i){return s.type="throw",s.arg=t,r.next=n,i&&(r.method="next",r.arg=e),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),l=n.call(a,"finallyLoc");if(u&&l){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return i(a.catchLoc,!0)}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,m):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),P(r),m}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;P(r)}return i}}throw Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:C(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),m}},t}function wr(e,t,r,n,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void r(e)}s.done?t(u):Promise.resolve(u).then(n,i)}function vr(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,br(n.key),n)}}function br(e){var t=function(e,t){if("object"!=mr(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=mr(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==mr(t)?t:t+""}function xr(e,t,r){return t=Sr(t),function(e,t){if(t&&("object"==mr(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,_r()?Reflect.construct(t,r||[],Sr(e).constructor):t.apply(e,r))}function _r(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(_r=function(){return!!e})()}function Sr(e){return Sr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Sr(e)}function Tr(e,t){return Tr=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Tr(e,t)}var Er=function(e){function t(e){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(r=xr(this,t,[e])).name=Vi.MIRRORING,r.priority=1,r.requireSyncDraw=!0,r.filterName="mirroring",r.filterMirror=new yr,r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Tr(e,t)}(t,e),r=t,n=[{key:"prepare",value:function(){}},{key:"process",value:(o=gr().mark((function e(t){var r;return gr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.enabled){e.next=2;break}return e.abrupt("return");case 2:r=this.resources.texturePool.get(this.sdkOptions.width,this.sdkOptions.height),t.sprite.filters=[this.filterMirror],this.resources.renderer.renderTo(t.sprite,r),t.sprite.filters=[],this.resources.texturePool.put(t.update(r));case 7:case"end":return e.stop()}}),e,this)})),a=function(){var e=this,t=arguments;return new Promise((function(r,n){var i=o.apply(e,t);function a(e){wr(i,r,n,a,s,"next",e)}function s(e){wr(i,r,n,a,s,"throw",e)}a(void 0)}))},function(e){return a.apply(this,arguments)})}],n&&vr(r.prototype,n),i&&vr(r,i),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,i,o,a}(d);function Or(e){return Or="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Or(e)}function Ar(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Ir(n.key),n)}}function Ir(e){var t=function(e,t){if("object"!=Or(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=Or(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Or(t)?t:t+""}function Pr(e,t,r){return t=Cr(t),function(e,t){if(t&&("object"==Or(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,kr()?Reflect.construct(t,r||[],Cr(e).constructor):t.apply(e,r))}function kr(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(kr=function(){return!!e})()}function Cr(e){return Cr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Cr(e)}function $r(e,t){return $r=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},$r(e,t)}var Rr=function(e){function t(e){var r,n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=Pr(this,t,[void 0,"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nuniform vec2 uStep;\nuniform float uSharpnessPower;\n\nconst float FSR_RCAS_LIMIT = 0.25 - 1.0 / 16.0;\n\nfloat calcLuma(vec3 texel) {\n  float luma = texel.b * 0.5 + (texel.r * 0.5 + texel.g);\n  return luma;\n}\n\nvec3 min4_vec3(vec3 a, vec3 b, vec3 c, vec3 d) {\n  vec3 min_ab = min(a, b);\n  vec3 min_cd = min(c, d);\n\n  return min(min_ab, min_cd);\n}\n\nvec3 max4_vec3(vec3 a, vec3 b, vec3 c, vec3 d) {\n  vec3 max_ab = max(a, b);\n  vec3 max_cd = max(c, d);\n\n  return max(max_ab, max_cd);\n}\n\nfloat max3_float(float a, float b, float c) {\n  float max_ab = max(a, b);\n\n  return max(max_ab, c);\n}\n\nfloat max5_float(float a, float b, float c, float d, float e) {\n  float max_ab = max(a, b);\n  float max_cd = max(c, d);\n  float max_ab_cd = max(max_ab, max_cd);\n\n  return max(max_ab_cd, e);\n}\n\nfloat min5_float(float a, float b, float c, float d, float e) {\n  float min_ab = min(a, b);\n  float min_cd = min(c, d);\n  float min_ab_cd = min(min_ab, min_cd);\n\n  return min(min_ab_cd, e);\n}\n\nfloat saturate(float val) {\n  return min(1.0, max(0.0, val));\n}\n\nfloat rcp(float val) {\n  return 1.0 / val;\n}\n\nvoid main() {\n  vec4 color = texture2D(uSampler, vTextureCoord);\n  // Algorithm uses minimal 3x3 pixel neighborhood.\n  //    b\n  //  d e f\n  //    h\n\n  vec3 e_texel = color.rgb;\n  vec3 b_texel = texture2D(uSampler, vTextureCoord + vec2(0, -uStep.y)).rgb;\n  vec3 h_texel = texture2D(uSampler, vTextureCoord + vec2(0, +uStep.y)).rgb;\n  vec3 d_texel = texture2D(uSampler, vTextureCoord + vec2(-uStep.x, 0)).rgb;\n  vec3 f_texel = texture2D(uSampler, vTextureCoord + vec2(+uStep.x, 0)).rgb;\n\n  float e_luma = calcLuma(e_texel);\n  float b_luma = calcLuma(b_texel);\n  float h_luma = calcLuma(h_texel);\n  float d_luma = calcLuma(d_texel);\n  float f_luma = calcLuma(f_texel);\n\n  // Min and max of ring.\n  vec3 min_ring = min4_vec3(b_texel, h_texel, d_texel, f_texel);\n  vec3 max_ring = max4_vec3(b_texel, h_texel, d_texel, f_texel);\n  // Immediate constants for peak range.\n  vec2 peakC = vec2(1.0, 1.0 * 4.0);\n  // Limiters, these need to be high precision RCPs.\n  vec3 hit_min = min_ring / (4.0 * max_ring);\n  vec3 hit_max = (1.0 - max_ring) / (4.0 * min_ring - peakC.y);\n  vec3 lobeC = max(-hit_min, hit_max);\n\n  float max_lobeC = max3_float(lobeC.r, lobeC.g, lobeC.b);\n  float lobe = max(-FSR_RCAS_LIMIT, min(max_lobeC, 0.0)) * uSharpnessPower;\n\n  // Noise detection.\n  float noise = 0.25 * b_luma + 0.25 * d_luma + 0.25 * f_luma + 0.25 * h_luma - e_luma;\n  float max_luma = max5_float(e_luma, b_luma, h_luma, d_luma, f_luma);\n  float min_luma = min5_float(e_luma, b_luma, h_luma, d_luma, f_luma);\n  noise = saturate(abs(noise) * rcp(max_luma - min_luma));\n  noise = -0.5 * noise + 1.0;\n  lobe = lobe * noise;\n\n  vec3 result = (lobe * (b_texel + d_texel + h_texel + f_texel) + e_texel) / (4.0 * lobe + 1.0);\n\n  gl_FragColor = vec4(result, color.a);\n}\n"]),e.outputResolution&&r.setOutputResolution(e.outputResolution),r.setPower(null!==(n=e.power)&&void 0!==n?n:0),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&$r(e,t)}(t,e),r=t,(n=[{key:"setOutputResolution",value:function(e){var t=1/(e.width-1),r=1/(e.height-1);this.uniforms.uStep=[t,r]}},{key:"setPower",value:function(e){e=Math.max(0,e),e=Math.min(1,e),this.uniforms.uSharpnessPower=.3*e+1}}])&&Ar(r.prototype,n),i&&Ar(r,i),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,i}(g.Filter);function Dr(e){return Dr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Dr(e)}function Mr(){Mr=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,i=Object.defineProperty||function(e,t,r){e[t]=r.value},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function l(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,r){return e[t]=r}}function h(e,t,r,n){var o=t&&t.prototype instanceof g?t:g,a=Object.create(o.prototype),s=new k(n||[]);return i(a,"_invoke",{value:O(e,r,s)}),a}function c(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=h;var f="suspendedStart",d="suspendedYield",p="executing",y="completed",m={};function g(){}function w(){}function v(){}var b={};l(b,a,(function(){return this}));var x=Object.getPrototypeOf,_=x&&x(x(C([])));_&&_!==r&&n.call(_,a)&&(b=_);var S=v.prototype=g.prototype=Object.create(b);function T(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function E(e,t){function r(i,o,a,s){var u=c(e[i],e,o);if("throw"!==u.type){var l=u.arg,h=l.value;return h&&"object"==Dr(h)&&n.call(h,"__await")?t.resolve(h.__await).then((function(e){r("next",e,a,s)}),(function(e){r("throw",e,a,s)})):t.resolve(h).then((function(e){l.value=e,a(l)}),(function(e){return r("throw",e,a,s)}))}s(u.arg)}var o;i(this,"_invoke",{value:function(e,n){function i(){return new t((function(t,i){r(e,n,t,i)}))}return o=o?o.then(i,i):i()}})}function O(t,r,n){var i=f;return function(o,a){if(i===p)throw Error("Generator is already running");if(i===y){if("throw"===o)throw a;return{value:e,done:!0}}for(n.method=o,n.arg=a;;){var s=n.delegate;if(s){var u=A(s,n);if(u){if(u===m)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===f)throw i=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i=p;var l=c(t,r,n);if("normal"===l.type){if(i=n.done?y:d,l.arg===m)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(i=y,n.method="throw",n.arg=l.arg)}}}function A(t,r){var n=r.method,i=t.iterator[n];if(i===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,A(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),m;var o=c(i,t.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,m;var a=o.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,m):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,m)}function I(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function P(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function k(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(I,this),this.reset(!0)}function C(t){if(t||""===t){var r=t[a];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,o=function r(){for(;++i<t.length;)if(n.call(t,i))return r.value=t[i],r.done=!1,r;return r.value=e,r.done=!0,r};return o.next=o}}throw new TypeError(Dr(t)+" is not iterable")}return w.prototype=v,i(S,"constructor",{value:v,configurable:!0}),i(v,"constructor",{value:w,configurable:!0}),w.displayName=l(v,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===w||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,v):(e.__proto__=v,l(e,u,"GeneratorFunction")),e.prototype=Object.create(S),e},t.awrap=function(e){return{__await:e}},T(E.prototype),l(E.prototype,s,(function(){return this})),t.AsyncIterator=E,t.async=function(e,r,n,i,o){void 0===o&&(o=Promise);var a=new E(h(e,r,n,i),o);return t.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},T(S),l(S,u,"Generator"),l(S,a,(function(){return this})),l(S,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=C,k.prototype={constructor:k,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(P),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function i(n,i){return s.type="throw",s.arg=t,r.next=n,i&&(r.method="next",r.arg=e),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),l=n.call(a,"finallyLoc");if(u&&l){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return i(a.catchLoc,!0)}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,m):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),P(r),m}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;P(r)}return i}}throw Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:C(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),m}},t}function Lr(e,t,r,n,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void r(e)}s.done?t(u):Promise.resolve(u).then(n,i)}function Br(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Nr(n.key),n)}}function Nr(e){var t=function(e,t){if("object"!=Dr(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=Dr(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Dr(t)?t:t+""}function Fr(e,t,r){return t=zr(t),function(e,t){if(t&&("object"==Dr(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,Ur()?Reflect.construct(t,r||[],zr(e).constructor):t.apply(e,r))}function Ur(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Ur=function(){return!!e})()}function jr(){return jr="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=function(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=zr(e)););return e}(e,t);if(n){var i=Object.getOwnPropertyDescriptor(n,t);return i.get?i.get.call(arguments.length<3?e:r):i.value}},jr.apply(null,arguments)}function zr(e){return zr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},zr(e)}function Gr(e,t){return Gr=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Gr(e,t)}var Vr=function(e){function t(e){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(r=Fr(this,t,[e])).name=Vi.SHARPNESS,r.priority=6,r.config={power:0},r.filterName="sharpness",r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Gr(e,t)}(t,e),r=t,n=[{key:"prepare",value:function(){var e=this.sdkOptions,t=e.width,r=e.height;this.filterSharpness=new Rr({outputResolution:{height:r,width:t}}),this.sdkOptions.on("update",this.onOptionsUpdate,this)}},{key:"onOptionsUpdate",value:function(){var e=this.sdkOptions,t=e.width,r=e.height;this.filterSharpness.setOutputResolution({height:r,width:t})}},{key:"process",value:(o=Mr().mark((function e(){return Mr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.enabled){e.next=2;break}return e.abrupt("return");case 2:this.resources.filters.set(this.filterName,this.filterSharpness);case 3:case"end":return e.stop()}}),e,this)})),a=function(){var e=this,t=arguments;return new Promise((function(r,n){var i=o.apply(e,t);function a(e){Lr(i,r,n,a,s,"next",e)}function s(e){Lr(i,r,n,a,s,"throw",e)}a(void 0)}))},function(){return a.apply(this,arguments)})},{key:"disable",value:function(){var e,r,n,i,o;(e=t,r="disable",n=this,o=jr(zr(1&(i=3)?e.prototype:e),r,n),2&i&&"function"==typeof o?function(e){return o.apply(n,e)}:o)([]),this.resources.filters.delete(this.filterName)}},{key:"setConfig",value:function(e){this.setPower(e.power)}},{key:"setPower",value:function(e){void 0!==e&&(this.config.power=e,this.filterSharpness.setPower(e))}},{key:"destroy",value:function(){this.sdkOptions.off("update",this.onOptionsUpdate,this)}}],n&&Br(r.prototype,n),i&&Br(r,i),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,i,o,a}(d);const Wr={smoothPower:20,sensitivityValue:.15,faceAreaProportion:.1,modelHeight:240,modelWidth:320,faceDetectorAccuracy:.75,waiterSeconds:1,isFaceSquareDrawingEnabled:!1,isPreFaceSquareDrawingEnabled:!1,faceDetectorPediod_ms:250};function Hr(e){return Hr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Hr(e)}function qr(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Yr(n.key),n)}}function Yr(e){var t=function(e,t){if("object"!=Hr(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=Hr(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Hr(t)?t:t+""}var Xr=function(){return e=function e(t,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.setCoord(t),this.id=null!=r?r:Math.round(100*Math.random())},(t=[{key:"setID",value:function(e){this.id=e}},{key:"getID",value:function(){return this.id}},{key:"checkSame",value:function(e){if(void 0===this.x1)return!1;if(!(e.x1>this.x1&&e.x1<this.x2||e.x2>this.x1&&e.x2<this.x2||this.x1>e.x1&&this.x1<e.x2||this.x2>e.x1&&this.x2<e.x2))return!1;if(!(e.y1>this.y1&&e.y1<this.y2||e.y2>this.y1&&e.y2<this.y2||this.y1>e.y1&&this.y1<e.y2||this.y2>e.y1&&this.y2<e.y2))return!1;var t=this.calcSquare(e),r=Math.abs(Math.max(this.x1,e.x1)-Math.min(this.x2,e.x2));return!!(Math.abs(Math.max(this.y1,e.y1)-Math.min(this.y2,e.y2))*r/Math.min(this.square,t)>.7)&&(this.setCoord(e),!0)}},{key:"getRect",value:function(){return{x1:this.x1,y1:this.y1,width:this.x2-this.x1,height:this.y2-this.y1}}},{key:"getCoord",value:function(){return{x1:this.x1,y1:this.y1,x2:this.x2,y2:this.y2}}},{key:"getSquare",value:function(){return this.square}},{key:"getCenter",value:function(){return{x:this.x1+(this.x2-this.x1)/2,y:this.y1+(this.y2-this.y1)/2}}},{key:"isEqual",value:function(e,t,r,n){if(!e)return!1;var i=e.getCoord();return!(Math.abs(this.x1-i.x1)/(null!=n?n:this.x2-this.x1)>t||Math.abs(this.x2-i.x2)/(null!=n?n:this.x2-this.x1)>t||Math.abs(this.y1-i.y1)/(null!=r?r:this.y2-this.y1)>t||Math.abs(this.y2-i.y2)/(null!=r?r:this.y2-this.y1)>t)}},{key:"setCoord",value:function(e){var t=void 0===this.x1;this.x1=t?e.x1:Math.min(this.x1,e.x1),this.y1=t?e.y1:Math.min(this.y1,e.y1),this.x2=t?e.x2:Math.max(this.x2,e.x2),this.y2=t?e.y2:Math.max(this.y2,e.y2),this.square=this.calcSquare(e)}},{key:"calcSquare",value:function(e){return(e.x2-e.x1)*(e.y2-e.y1)}}])&&qr(e.prototype,t),r&&qr(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,r}();const Kr=[{x:.0125,y:.016666666666666666,w:.03125,h:.041666666666666664},{x:.0125,y:.016666666666666666,w:.05,h:.06666666666666667},{x:.0125,y:.016666666666666666,w:.075,h:.1},{x:.0375,y:.016666666666666666,w:.03125,h:.041666666666666664},{x:.0375,y:.016666666666666666,w:.05,h:.06666666666666667},{x:.0375,y:.016666666666666666,w:.075,h:.1},{x:.0625,y:.016666666666666666,w:.03125,h:.041666666666666664},{x:.0625,y:.016666666666666666,w:.05,h:.06666666666666667},{x:.0625,y:.016666666666666666,w:.075,h:.1},{x:.0875,y:.016666666666666666,w:.03125,h:.041666666666666664},{x:.0875,y:.016666666666666666,w:.05,h:.06666666666666667},{x:.0875,y:.016666666666666666,w:.075,h:.1},{x:.1125,y:.016666666666666666,w:.03125,h:.041666666666666664},{x:.1125,y:.016666666666666666,w:.05,h:.06666666666666667},{x:.1125,y:.016666666666666666,w:.075,h:.1},{x:.1375,y:.016666666666666666,w:.03125,h:.041666666666666664},{x:.1375,y:.016666666666666666,w:.05,h:.06666666666666667},{x:.1375,y:.016666666666666666,w:.075,h:.1},{x:.1625,y:.016666666666666666,w:.03125,h:.041666666666666664},{x:.1625,y:.016666666666666666,w:.05,h:.06666666666666667},{x:.1625,y:.016666666666666666,w:.075,h:.1},{x:.1875,y:.016666666666666666,w:.03125,h:.041666666666666664},{x:.1875,y:.016666666666666666,w:.05,h:.06666666666666667},{x:.1875,y:.016666666666666666,w:.075,h:.1},{x:.2125,y:.016666666666666666,w:.03125,h:.041666666666666664},{x:.2125,y:.016666666666666666,w:.05,h:.06666666666666667},{x:.2125,y:.016666666666666666,w:.075,h:.1},{x:.2375,y:.016666666666666666,w:.03125,h:.041666666666666664},{x:.2375,y:.016666666666666666,w:.05,h:.06666666666666667},{x:.2375,y:.016666666666666666,w:.075,h:.1},{x:.2625,y:.016666666666666666,w:.03125,h:.041666666666666664},{x:.2625,y:.016666666666666666,w:.05,h:.06666666666666667},{x:.2625,y:.016666666666666666,w:.075,h:.1},{x:.2875,y:.016666666666666666,w:.03125,h:.041666666666666664},{x:.2875,y:.016666666666666666,w:.05,h:.06666666666666667},{x:.2875,y:.016666666666666666,w:.075,h:.1},{x:.3125,y:.016666666666666666,w:.03125,h:.041666666666666664},{x:.3125,y:.016666666666666666,w:.05,h:.06666666666666667},{x:.3125,y:.016666666666666666,w:.075,h:.1},{x:.3375,y:.016666666666666666,w:.03125,h:.041666666666666664},{x:.3375,y:.016666666666666666,w:.05,h:.06666666666666667},{x:.3375,y:.016666666666666666,w:.075,h:.1},{x:.3625,y:.016666666666666666,w:.03125,h:.041666666666666664},{x:.3625,y:.016666666666666666,w:.05,h:.06666666666666667},{x:.3625,y:.016666666666666666,w:.075,h:.1},{x:.3875,y:.016666666666666666,w:.03125,h:.041666666666666664},{x:.3875,y:.016666666666666666,w:.05,h:.06666666666666667},{x:.3875,y:.016666666666666666,w:.075,h:.1},{x:.4125,y:.016666666666666666,w:.03125,h:.041666666666666664},{x:.4125,y:.016666666666666666,w:.05,h:.06666666666666667},{x:.4125,y:.016666666666666666,w:.075,h:.1},{x:.4375,y:.016666666666666666,w:.03125,h:.041666666666666664},{x:.4375,y:.016666666666666666,w:.05,h:.06666666666666667},{x:.4375,y:.016666666666666666,w:.075,h:.1},{x:.4625,y:.016666666666666666,w:.03125,h:.041666666666666664},{x:.4625,y:.016666666666666666,w:.05,h:.06666666666666667},{x:.4625,y:.016666666666666666,w:.075,h:.1},{x:.4875,y:.016666666666666666,w:.03125,h:.041666666666666664},{x:.4875,y:.016666666666666666,w:.05,h:.06666666666666667},{x:.4875,y:.016666666666666666,w:.075,h:.1},{x:.5125,y:.016666666666666666,w:.03125,h:.041666666666666664},{x:.5125,y:.016666666666666666,w:.05,h:.06666666666666667},{x:.5125,y:.016666666666666666,w:.075,h:.1},{x:.5375,y:.016666666666666666,w:.03125,h:.041666666666666664},{x:.5375,y:.016666666666666666,w:.05,h:.06666666666666667},{x:.5375,y:.016666666666666666,w:.075,h:.1},{x:.5625,y:.016666666666666666,w:.03125,h:.041666666666666664},{x:.5625,y:.016666666666666666,w:.05,h:.06666666666666667},{x:.5625,y:.016666666666666666,w:.075,h:.1},{x:.5875,y:.016666666666666666,w:.03125,h:.041666666666666664},{x:.5875,y:.016666666666666666,w:.05,h:.06666666666666667},{x:.5875,y:.016666666666666666,w:.075,h:.1},{x:.6125,y:.016666666666666666,w:.03125,h:.041666666666666664},{x:.6125,y:.016666666666666666,w:.05,h:.06666666666666667},{x:.6125,y:.016666666666666666,w:.075,h:.1},{x:.6375,y:.016666666666666666,w:.03125,h:.041666666666666664},{x:.6375,y:.016666666666666666,w:.05,h:.06666666666666667},{x:.6375,y:.016666666666666666,w:.075,h:.1},{x:.6625,y:.016666666666666666,w:.03125,h:.041666666666666664},{x:.6625,y:.016666666666666666,w:.05,h:.06666666666666667},{x:.6625,y:.016666666666666666,w:.075,h:.1},{x:.6875,y:.016666666666666666,w:.03125,h:.041666666666666664},{x:.6875,y:.016666666666666666,w:.05,h:.06666666666666667},{x:.6875,y:.016666666666666666,w:.075,h:.1},{x:.7125,y:.016666666666666666,w:.03125,h:.041666666666666664},{x:.7125,y:.016666666666666666,w:.05,h:.06666666666666667},{x:.7125,y:.016666666666666666,w:.075,h:.1},{x:.7375,y:.016666666666666666,w:.03125,h:.041666666666666664},{x:.7375,y:.016666666666666666,w:.05,h:.06666666666666667},{x:.7375,y:.016666666666666666,w:.075,h:.1},{x:.7625,y:.016666666666666666,w:.03125,h:.041666666666666664},{x:.7625,y:.016666666666666666,w:.05,h:.06666666666666667},{x:.7625,y:.016666666666666666,w:.075,h:.1},{x:.7875,y:.016666666666666666,w:.03125,h:.041666666666666664},{x:.7875,y:.016666666666666666,w:.05,h:.06666666666666667},{x:.7875,y:.016666666666666666,w:.075,h:.1},{x:.8125,y:.016666666666666666,w:.03125,h:.041666666666666664},{x:.8125,y:.016666666666666666,w:.05,h:.06666666666666667},{x:.8125,y:.016666666666666666,w:.075,h:.1},{x:.8375,y:.016666666666666666,w:.03125,h:.041666666666666664},{x:.8375,y:.016666666666666666,w:.05,h:.06666666666666667},{x:.8375,y:.016666666666666666,w:.075,h:.1},{x:.8625,y:.016666666666666666,w:.03125,h:.041666666666666664},{x:.8625,y:.016666666666666666,w:.05,h:.06666666666666667},{x:.8625,y:.016666666666666666,w:.075,h:.1},{x:.8875,y:.016666666666666666,w:.03125,h:.041666666666666664},{x:.8875,y:.016666666666666666,w:.05,h:.06666666666666667},{x:.8875,y:.016666666666666666,w:.075,h:.1},{x:.9125,y:.016666666666666666,w:.03125,h:.041666666666666664},{x:.9125,y:.016666666666666666,w:.05,h:.06666666666666667},{x:.9125,y:.016666666666666666,w:.075,h:.1},{x:.9375,y:.016666666666666666,w:.03125,h:.041666666666666664},{x:.9375,y:.016666666666666666,w:.05,h:.06666666666666667},{x:.9375,y:.016666666666666666,w:.075,h:.1},{x:.9625,y:.016666666666666666,w:.03125,h:.041666666666666664},{x:.9625,y:.016666666666666666,w:.05,h:.06666666666666667},{x:.9625,y:.016666666666666666,w:.075,h:.1},{x:.9875,y:.016666666666666666,w:.03125,h:.041666666666666664},{x:.9875,y:.016666666666666666,w:.05,h:.06666666666666667},{x:.9875,y:.016666666666666666,w:.075,h:.1},{x:.0125,y:.05,w:.03125,h:.041666666666666664},{x:.0125,y:.05,w:.05,h:.06666666666666667},{x:.0125,y:.05,w:.075,h:.1},{x:.0375,y:.05,w:.03125,h:.041666666666666664},{x:.0375,y:.05,w:.05,h:.06666666666666667},{x:.0375,y:.05,w:.075,h:.1},{x:.0625,y:.05,w:.03125,h:.041666666666666664},{x:.0625,y:.05,w:.05,h:.06666666666666667},{x:.0625,y:.05,w:.075,h:.1},{x:.0875,y:.05,w:.03125,h:.041666666666666664},{x:.0875,y:.05,w:.05,h:.06666666666666667},{x:.0875,y:.05,w:.075,h:.1},{x:.1125,y:.05,w:.03125,h:.041666666666666664},{x:.1125,y:.05,w:.05,h:.06666666666666667},{x:.1125,y:.05,w:.075,h:.1},{x:.1375,y:.05,w:.03125,h:.041666666666666664},{x:.1375,y:.05,w:.05,h:.06666666666666667},{x:.1375,y:.05,w:.075,h:.1},{x:.1625,y:.05,w:.03125,h:.041666666666666664},{x:.1625,y:.05,w:.05,h:.06666666666666667},{x:.1625,y:.05,w:.075,h:.1},{x:.1875,y:.05,w:.03125,h:.041666666666666664},{x:.1875,y:.05,w:.05,h:.06666666666666667},{x:.1875,y:.05,w:.075,h:.1},{x:.2125,y:.05,w:.03125,h:.041666666666666664},{x:.2125,y:.05,w:.05,h:.06666666666666667},{x:.2125,y:.05,w:.075,h:.1},{x:.2375,y:.05,w:.03125,h:.041666666666666664},{x:.2375,y:.05,w:.05,h:.06666666666666667},{x:.2375,y:.05,w:.075,h:.1},{x:.2625,y:.05,w:.03125,h:.041666666666666664},{x:.2625,y:.05,w:.05,h:.06666666666666667},{x:.2625,y:.05,w:.075,h:.1},{x:.2875,y:.05,w:.03125,h:.041666666666666664},{x:.2875,y:.05,w:.05,h:.06666666666666667},{x:.2875,y:.05,w:.075,h:.1},{x:.3125,y:.05,w:.03125,h:.041666666666666664},{x:.3125,y:.05,w:.05,h:.06666666666666667},{x:.3125,y:.05,w:.075,h:.1},{x:.3375,y:.05,w:.03125,h:.041666666666666664},{x:.3375,y:.05,w:.05,h:.06666666666666667},{x:.3375,y:.05,w:.075,h:.1},{x:.3625,y:.05,w:.03125,h:.041666666666666664},{x:.3625,y:.05,w:.05,h:.06666666666666667},{x:.3625,y:.05,w:.075,h:.1},{x:.3875,y:.05,w:.03125,h:.041666666666666664},{x:.3875,y:.05,w:.05,h:.06666666666666667},{x:.3875,y:.05,w:.075,h:.1},{x:.4125,y:.05,w:.03125,h:.041666666666666664},{x:.4125,y:.05,w:.05,h:.06666666666666667},{x:.4125,y:.05,w:.075,h:.1},{x:.4375,y:.05,w:.03125,h:.041666666666666664},{x:.4375,y:.05,w:.05,h:.06666666666666667},{x:.4375,y:.05,w:.075,h:.1},{x:.4625,y:.05,w:.03125,h:.041666666666666664},{x:.4625,y:.05,w:.05,h:.06666666666666667},{x:.4625,y:.05,w:.075,h:.1},{x:.4875,y:.05,w:.03125,h:.041666666666666664},{x:.4875,y:.05,w:.05,h:.06666666666666667},{x:.4875,y:.05,w:.075,h:.1},{x:.5125,y:.05,w:.03125,h:.041666666666666664},{x:.5125,y:.05,w:.05,h:.06666666666666667},{x:.5125,y:.05,w:.075,h:.1},{x:.5375,y:.05,w:.03125,h:.041666666666666664},{x:.5375,y:.05,w:.05,h:.06666666666666667},{x:.5375,y:.05,w:.075,h:.1},{x:.5625,y:.05,w:.03125,h:.041666666666666664},{x:.5625,y:.05,w:.05,h:.06666666666666667},{x:.5625,y:.05,w:.075,h:.1},{x:.5875,y:.05,w:.03125,h:.041666666666666664},{x:.5875,y:.05,w:.05,h:.06666666666666667},{x:.5875,y:.05,w:.075,h:.1},{x:.6125,y:.05,w:.03125,h:.041666666666666664},{x:.6125,y:.05,w:.05,h:.06666666666666667},{x:.6125,y:.05,w:.075,h:.1},{x:.6375,y:.05,w:.03125,h:.041666666666666664},{x:.6375,y:.05,w:.05,h:.06666666666666667},{x:.6375,y:.05,w:.075,h:.1},{x:.6625,y:.05,w:.03125,h:.041666666666666664},{x:.6625,y:.05,w:.05,h:.06666666666666667},{x:.6625,y:.05,w:.075,h:.1},{x:.6875,y:.05,w:.03125,h:.041666666666666664},{x:.6875,y:.05,w:.05,h:.06666666666666667},{x:.6875,y:.05,w:.075,h:.1},{x:.7125,y:.05,w:.03125,h:.041666666666666664},{x:.7125,y:.05,w:.05,h:.06666666666666667},{x:.7125,y:.05,w:.075,h:.1},{x:.7375,y:.05,w:.03125,h:.041666666666666664},{x:.7375,y:.05,w:.05,h:.06666666666666667},{x:.7375,y:.05,w:.075,h:.1},{x:.7625,y:.05,w:.03125,h:.041666666666666664},{x:.7625,y:.05,w:.05,h:.06666666666666667},{x:.7625,y:.05,w:.075,h:.1},{x:.7875,y:.05,w:.03125,h:.041666666666666664},{x:.7875,y:.05,w:.05,h:.06666666666666667},{x:.7875,y:.05,w:.075,h:.1},{x:.8125,y:.05,w:.03125,h:.041666666666666664},{x:.8125,y:.05,w:.05,h:.06666666666666667},{x:.8125,y:.05,w:.075,h:.1},{x:.8375,y:.05,w:.03125,h:.041666666666666664},{x:.8375,y:.05,w:.05,h:.06666666666666667},{x:.8375,y:.05,w:.075,h:.1},{x:.8625,y:.05,w:.03125,h:.041666666666666664},{x:.8625,y:.05,w:.05,h:.06666666666666667},{x:.8625,y:.05,w:.075,h:.1},{x:.8875,y:.05,w:.03125,h:.041666666666666664},{x:.8875,y:.05,w:.05,h:.06666666666666667},{x:.8875,y:.05,w:.075,h:.1},{x:.9125,y:.05,w:.03125,h:.041666666666666664},{x:.9125,y:.05,w:.05,h:.06666666666666667},{x:.9125,y:.05,w:.075,h:.1},{x:.9375,y:.05,w:.03125,h:.041666666666666664},{x:.9375,y:.05,w:.05,h:.06666666666666667},{x:.9375,y:.05,w:.075,h:.1},{x:.9625,y:.05,w:.03125,h:.041666666666666664},{x:.9625,y:.05,w:.05,h:.06666666666666667},{x:.9625,y:.05,w:.075,h:.1},{x:.9875,y:.05,w:.03125,h:.041666666666666664},{x:.9875,y:.05,w:.05,h:.06666666666666667},{x:.9875,y:.05,w:.075,h:.1},{x:.0125,y:.08333333333333333,w:.03125,h:.041666666666666664},{x:.0125,y:.08333333333333333,w:.05,h:.06666666666666667},{x:.0125,y:.08333333333333333,w:.075,h:.1},{x:.0375,y:.08333333333333333,w:.03125,h:.041666666666666664},{x:.0375,y:.08333333333333333,w:.05,h:.06666666666666667},{x:.0375,y:.08333333333333333,w:.075,h:.1},{x:.0625,y:.08333333333333333,w:.03125,h:.041666666666666664},{x:.0625,y:.08333333333333333,w:.05,h:.06666666666666667},{x:.0625,y:.08333333333333333,w:.075,h:.1},{x:.0875,y:.08333333333333333,w:.03125,h:.041666666666666664},{x:.0875,y:.08333333333333333,w:.05,h:.06666666666666667},{x:.0875,y:.08333333333333333,w:.075,h:.1},{x:.1125,y:.08333333333333333,w:.03125,h:.041666666666666664},{x:.1125,y:.08333333333333333,w:.05,h:.06666666666666667},{x:.1125,y:.08333333333333333,w:.075,h:.1},{x:.1375,y:.08333333333333333,w:.03125,h:.041666666666666664},{x:.1375,y:.08333333333333333,w:.05,h:.06666666666666667},{x:.1375,y:.08333333333333333,w:.075,h:.1},{x:.1625,y:.08333333333333333,w:.03125,h:.041666666666666664},{x:.1625,y:.08333333333333333,w:.05,h:.06666666666666667},{x:.1625,y:.08333333333333333,w:.075,h:.1},{x:.1875,y:.08333333333333333,w:.03125,h:.041666666666666664},{x:.1875,y:.08333333333333333,w:.05,h:.06666666666666667},{x:.1875,y:.08333333333333333,w:.075,h:.1},{x:.2125,y:.08333333333333333,w:.03125,h:.041666666666666664},{x:.2125,y:.08333333333333333,w:.05,h:.06666666666666667},{x:.2125,y:.08333333333333333,w:.075,h:.1},{x:.2375,y:.08333333333333333,w:.03125,h:.041666666666666664},{x:.2375,y:.08333333333333333,w:.05,h:.06666666666666667},{x:.2375,y:.08333333333333333,w:.075,h:.1},{x:.2625,y:.08333333333333333,w:.03125,h:.041666666666666664},{x:.2625,y:.08333333333333333,w:.05,h:.06666666666666667},{x:.2625,y:.08333333333333333,w:.075,h:.1},{x:.2875,y:.08333333333333333,w:.03125,h:.041666666666666664},{x:.2875,y:.08333333333333333,w:.05,h:.06666666666666667},{x:.2875,y:.08333333333333333,w:.075,h:.1},{x:.3125,y:.08333333333333333,w:.03125,h:.041666666666666664},{x:.3125,y:.08333333333333333,w:.05,h:.06666666666666667},{x:.3125,y:.08333333333333333,w:.075,h:.1},{x:.3375,y:.08333333333333333,w:.03125,h:.041666666666666664},{x:.3375,y:.08333333333333333,w:.05,h:.06666666666666667},{x:.3375,y:.08333333333333333,w:.075,h:.1},{x:.3625,y:.08333333333333333,w:.03125,h:.041666666666666664},{x:.3625,y:.08333333333333333,w:.05,h:.06666666666666667},{x:.3625,y:.08333333333333333,w:.075,h:.1},{x:.3875,y:.08333333333333333,w:.03125,h:.041666666666666664},{x:.3875,y:.08333333333333333,w:.05,h:.06666666666666667},{x:.3875,y:.08333333333333333,w:.075,h:.1},{x:.4125,y:.08333333333333333,w:.03125,h:.041666666666666664},{x:.4125,y:.08333333333333333,w:.05,h:.06666666666666667},{x:.4125,y:.08333333333333333,w:.075,h:.1},{x:.4375,y:.08333333333333333,w:.03125,h:.041666666666666664},{x:.4375,y:.08333333333333333,w:.05,h:.06666666666666667},{x:.4375,y:.08333333333333333,w:.075,h:.1},{x:.4625,y:.08333333333333333,w:.03125,h:.041666666666666664},{x:.4625,y:.08333333333333333,w:.05,h:.06666666666666667},{x:.4625,y:.08333333333333333,w:.075,h:.1},{x:.4875,y:.08333333333333333,w:.03125,h:.041666666666666664},{x:.4875,y:.08333333333333333,w:.05,h:.06666666666666667},{x:.4875,y:.08333333333333333,w:.075,h:.1},{x:.5125,y:.08333333333333333,w:.03125,h:.041666666666666664},{x:.5125,y:.08333333333333333,w:.05,h:.06666666666666667},{x:.5125,y:.08333333333333333,w:.075,h:.1},{x:.5375,y:.08333333333333333,w:.03125,h:.041666666666666664},{x:.5375,y:.08333333333333333,w:.05,h:.06666666666666667},{x:.5375,y:.08333333333333333,w:.075,h:.1},{x:.5625,y:.08333333333333333,w:.03125,h:.041666666666666664},{x:.5625,y:.08333333333333333,w:.05,h:.06666666666666667},{x:.5625,y:.08333333333333333,w:.075,h:.1},{x:.5875,y:.08333333333333333,w:.03125,h:.041666666666666664},{x:.5875,y:.08333333333333333,w:.05,h:.06666666666666667},{x:.5875,y:.08333333333333333,w:.075,h:.1},{x:.6125,y:.08333333333333333,w:.03125,h:.041666666666666664},{x:.6125,y:.08333333333333333,w:.05,h:.06666666666666667},{x:.6125,y:.08333333333333333,w:.075,h:.1},{x:.6375,y:.08333333333333333,w:.03125,h:.041666666666666664},{x:.6375,y:.08333333333333333,w:.05,h:.06666666666666667},{x:.6375,y:.08333333333333333,w:.075,h:.1},{x:.6625,y:.08333333333333333,w:.03125,h:.041666666666666664},{x:.6625,y:.08333333333333333,w:.05,h:.06666666666666667},{x:.6625,y:.08333333333333333,w:.075,h:.1},{x:.6875,y:.08333333333333333,w:.03125,h:.041666666666666664},{x:.6875,y:.08333333333333333,w:.05,h:.06666666666666667},{x:.6875,y:.08333333333333333,w:.075,h:.1},{x:.7125,y:.08333333333333333,w:.03125,h:.041666666666666664},{x:.7125,y:.08333333333333333,w:.05,h:.06666666666666667},{x:.7125,y:.08333333333333333,w:.075,h:.1},{x:.7375,y:.08333333333333333,w:.03125,h:.041666666666666664},{x:.7375,y:.08333333333333333,w:.05,h:.06666666666666667},{x:.7375,y:.08333333333333333,w:.075,h:.1},{x:.7625,y:.08333333333333333,w:.03125,h:.041666666666666664},{x:.7625,y:.08333333333333333,w:.05,h:.06666666666666667},{x:.7625,y:.08333333333333333,w:.075,h:.1},{x:.7875,y:.08333333333333333,w:.03125,h:.041666666666666664},{x:.7875,y:.08333333333333333,w:.05,h:.06666666666666667},{x:.7875,y:.08333333333333333,w:.075,h:.1},{x:.8125,y:.08333333333333333,w:.03125,h:.041666666666666664},{x:.8125,y:.08333333333333333,w:.05,h:.06666666666666667},{x:.8125,y:.08333333333333333,w:.075,h:.1},{x:.8375,y:.08333333333333333,w:.03125,h:.041666666666666664},{x:.8375,y:.08333333333333333,w:.05,h:.06666666666666667},{x:.8375,y:.08333333333333333,w:.075,h:.1},{x:.8625,y:.08333333333333333,w:.03125,h:.041666666666666664},{x:.8625,y:.08333333333333333,w:.05,h:.06666666666666667},{x:.8625,y:.08333333333333333,w:.075,h:.1},{x:.8875,y:.08333333333333333,w:.03125,h:.041666666666666664},{x:.8875,y:.08333333333333333,w:.05,h:.06666666666666667},{x:.8875,y:.08333333333333333,w:.075,h:.1},{x:.9125,y:.08333333333333333,w:.03125,h:.041666666666666664},{x:.9125,y:.08333333333333333,w:.05,h:.06666666666666667},{x:.9125,y:.08333333333333333,w:.075,h:.1},{x:.9375,y:.08333333333333333,w:.03125,h:.041666666666666664},{x:.9375,y:.08333333333333333,w:.05,h:.06666666666666667},{x:.9375,y:.08333333333333333,w:.075,h:.1},{x:.9625,y:.08333333333333333,w:.03125,h:.041666666666666664},{x:.9625,y:.08333333333333333,w:.05,h:.06666666666666667},{x:.9625,y:.08333333333333333,w:.075,h:.1},{x:.9875,y:.08333333333333333,w:.03125,h:.041666666666666664},{x:.9875,y:.08333333333333333,w:.05,h:.06666666666666667},{x:.9875,y:.08333333333333333,w:.075,h:.1},{x:.0125,y:.11666666666666667,w:.03125,h:.041666666666666664},{x:.0125,y:.11666666666666667,w:.05,h:.06666666666666667},{x:.0125,y:.11666666666666667,w:.075,h:.1},{x:.0375,y:.11666666666666667,w:.03125,h:.041666666666666664},{x:.0375,y:.11666666666666667,w:.05,h:.06666666666666667},{x:.0375,y:.11666666666666667,w:.075,h:.1},{x:.0625,y:.11666666666666667,w:.03125,h:.041666666666666664},{x:.0625,y:.11666666666666667,w:.05,h:.06666666666666667},{x:.0625,y:.11666666666666667,w:.075,h:.1},{x:.0875,y:.11666666666666667,w:.03125,h:.041666666666666664},{x:.0875,y:.11666666666666667,w:.05,h:.06666666666666667},{x:.0875,y:.11666666666666667,w:.075,h:.1},{x:.1125,y:.11666666666666667,w:.03125,h:.041666666666666664},{x:.1125,y:.11666666666666667,w:.05,h:.06666666666666667},{x:.1125,y:.11666666666666667,w:.075,h:.1},{x:.1375,y:.11666666666666667,w:.03125,h:.041666666666666664},{x:.1375,y:.11666666666666667,w:.05,h:.06666666666666667},{x:.1375,y:.11666666666666667,w:.075,h:.1},{x:.1625,y:.11666666666666667,w:.03125,h:.041666666666666664},{x:.1625,y:.11666666666666667,w:.05,h:.06666666666666667},{x:.1625,y:.11666666666666667,w:.075,h:.1},{x:.1875,y:.11666666666666667,w:.03125,h:.041666666666666664},{x:.1875,y:.11666666666666667,w:.05,h:.06666666666666667},{x:.1875,y:.11666666666666667,w:.075,h:.1},{x:.2125,y:.11666666666666667,w:.03125,h:.041666666666666664},{x:.2125,y:.11666666666666667,w:.05,h:.06666666666666667},{x:.2125,y:.11666666666666667,w:.075,h:.1},{x:.2375,y:.11666666666666667,w:.03125,h:.041666666666666664},{x:.2375,y:.11666666666666667,w:.05,h:.06666666666666667},{x:.2375,y:.11666666666666667,w:.075,h:.1},{x:.2625,y:.11666666666666667,w:.03125,h:.041666666666666664},{x:.2625,y:.11666666666666667,w:.05,h:.06666666666666667},{x:.2625,y:.11666666666666667,w:.075,h:.1},{x:.2875,y:.11666666666666667,w:.03125,h:.041666666666666664},{x:.2875,y:.11666666666666667,w:.05,h:.06666666666666667},{x:.2875,y:.11666666666666667,w:.075,h:.1},{x:.3125,y:.11666666666666667,w:.03125,h:.041666666666666664},{x:.3125,y:.11666666666666667,w:.05,h:.06666666666666667},{x:.3125,y:.11666666666666667,w:.075,h:.1},{x:.3375,y:.11666666666666667,w:.03125,h:.041666666666666664},{x:.3375,y:.11666666666666667,w:.05,h:.06666666666666667},{x:.3375,y:.11666666666666667,w:.075,h:.1},{x:.3625,y:.11666666666666667,w:.03125,h:.041666666666666664},{x:.3625,y:.11666666666666667,w:.05,h:.06666666666666667},{x:.3625,y:.11666666666666667,w:.075,h:.1},{x:.3875,y:.11666666666666667,w:.03125,h:.041666666666666664},{x:.3875,y:.11666666666666667,w:.05,h:.06666666666666667},{x:.3875,y:.11666666666666667,w:.075,h:.1},{x:.4125,y:.11666666666666667,w:.03125,h:.041666666666666664},{x:.4125,y:.11666666666666667,w:.05,h:.06666666666666667},{x:.4125,y:.11666666666666667,w:.075,h:.1},{x:.4375,y:.11666666666666667,w:.03125,h:.041666666666666664},{x:.4375,y:.11666666666666667,w:.05,h:.06666666666666667},{x:.4375,y:.11666666666666667,w:.075,h:.1},{x:.4625,y:.11666666666666667,w:.03125,h:.041666666666666664},{x:.4625,y:.11666666666666667,w:.05,h:.06666666666666667},{x:.4625,y:.11666666666666667,w:.075,h:.1},{x:.4875,y:.11666666666666667,w:.03125,h:.041666666666666664},{x:.4875,y:.11666666666666667,w:.05,h:.06666666666666667},{x:.4875,y:.11666666666666667,w:.075,h:.1},{x:.5125,y:.11666666666666667,w:.03125,h:.041666666666666664},{x:.5125,y:.11666666666666667,w:.05,h:.06666666666666667},{x:.5125,y:.11666666666666667,w:.075,h:.1},{x:.5375,y:.11666666666666667,w:.03125,h:.041666666666666664},{x:.5375,y:.11666666666666667,w:.05,h:.06666666666666667},{x:.5375,y:.11666666666666667,w:.075,h:.1},{x:.5625,y:.11666666666666667,w:.03125,h:.041666666666666664},{x:.5625,y:.11666666666666667,w:.05,h:.06666666666666667},{x:.5625,y:.11666666666666667,w:.075,h:.1},{x:.5875,y:.11666666666666667,w:.03125,h:.041666666666666664},{x:.5875,y:.11666666666666667,w:.05,h:.06666666666666667},{x:.5875,y:.11666666666666667,w:.075,h:.1},{x:.6125,y:.11666666666666667,w:.03125,h:.041666666666666664},{x:.6125,y:.11666666666666667,w:.05,h:.06666666666666667},{x:.6125,y:.11666666666666667,w:.075,h:.1},{x:.6375,y:.11666666666666667,w:.03125,h:.041666666666666664},{x:.6375,y:.11666666666666667,w:.05,h:.06666666666666667},{x:.6375,y:.11666666666666667,w:.075,h:.1},{x:.6625,y:.11666666666666667,w:.03125,h:.041666666666666664},{x:.6625,y:.11666666666666667,w:.05,h:.06666666666666667},{x:.6625,y:.11666666666666667,w:.075,h:.1},{x:.6875,y:.11666666666666667,w:.03125,h:.041666666666666664},{x:.6875,y:.11666666666666667,w:.05,h:.06666666666666667},{x:.6875,y:.11666666666666667,w:.075,h:.1},{x:.7125,y:.11666666666666667,w:.03125,h:.041666666666666664},{x:.7125,y:.11666666666666667,w:.05,h:.06666666666666667},{x:.7125,y:.11666666666666667,w:.075,h:.1},{x:.7375,y:.11666666666666667,w:.03125,h:.041666666666666664},{x:.7375,y:.11666666666666667,w:.05,h:.06666666666666667},{x:.7375,y:.11666666666666667,w:.075,h:.1},{x:.7625,y:.11666666666666667,w:.03125,h:.041666666666666664},{x:.7625,y:.11666666666666667,w:.05,h:.06666666666666667},{x:.7625,y:.11666666666666667,w:.075,h:.1},{x:.7875,y:.11666666666666667,w:.03125,h:.041666666666666664},{x:.7875,y:.11666666666666667,w:.05,h:.06666666666666667},{x:.7875,y:.11666666666666667,w:.075,h:.1},{x:.8125,y:.11666666666666667,w:.03125,h:.041666666666666664},{x:.8125,y:.11666666666666667,w:.05,h:.06666666666666667},{x:.8125,y:.11666666666666667,w:.075,h:.1},{x:.8375,y:.11666666666666667,w:.03125,h:.041666666666666664},{x:.8375,y:.11666666666666667,w:.05,h:.06666666666666667},{x:.8375,y:.11666666666666667,w:.075,h:.1},{x:.8625,y:.11666666666666667,w:.03125,h:.041666666666666664},{x:.8625,y:.11666666666666667,w:.05,h:.06666666666666667},{x:.8625,y:.11666666666666667,w:.075,h:.1},{x:.8875,y:.11666666666666667,w:.03125,h:.041666666666666664},{x:.8875,y:.11666666666666667,w:.05,h:.06666666666666667},{x:.8875,y:.11666666666666667,w:.075,h:.1},{x:.9125,y:.11666666666666667,w:.03125,h:.041666666666666664},{x:.9125,y:.11666666666666667,w:.05,h:.06666666666666667},{x:.9125,y:.11666666666666667,w:.075,h:.1},{x:.9375,y:.11666666666666667,w:.03125,h:.041666666666666664},{x:.9375,y:.11666666666666667,w:.05,h:.06666666666666667},{x:.9375,y:.11666666666666667,w:.075,h:.1},{x:.9625,y:.11666666666666667,w:.03125,h:.041666666666666664},{x:.9625,y:.11666666666666667,w:.05,h:.06666666666666667},{x:.9625,y:.11666666666666667,w:.075,h:.1},{x:.9875,y:.11666666666666667,w:.03125,h:.041666666666666664},{x:.9875,y:.11666666666666667,w:.05,h:.06666666666666667},{x:.9875,y:.11666666666666667,w:.075,h:.1},{x:.0125,y:.15,w:.03125,h:.041666666666666664},{x:.0125,y:.15,w:.05,h:.06666666666666667},{x:.0125,y:.15,w:.075,h:.1},{x:.0375,y:.15,w:.03125,h:.041666666666666664},{x:.0375,y:.15,w:.05,h:.06666666666666667},{x:.0375,y:.15,w:.075,h:.1},{x:.0625,y:.15,w:.03125,h:.041666666666666664},{x:.0625,y:.15,w:.05,h:.06666666666666667},{x:.0625,y:.15,w:.075,h:.1},{x:.0875,y:.15,w:.03125,h:.041666666666666664},{x:.0875,y:.15,w:.05,h:.06666666666666667},{x:.0875,y:.15,w:.075,h:.1},{x:.1125,y:.15,w:.03125,h:.041666666666666664},{x:.1125,y:.15,w:.05,h:.06666666666666667},{x:.1125,y:.15,w:.075,h:.1},{x:.1375,y:.15,w:.03125,h:.041666666666666664},{x:.1375,y:.15,w:.05,h:.06666666666666667},{x:.1375,y:.15,w:.075,h:.1},{x:.1625,y:.15,w:.03125,h:.041666666666666664},{x:.1625,y:.15,w:.05,h:.06666666666666667},{x:.1625,y:.15,w:.075,h:.1},{x:.1875,y:.15,w:.03125,h:.041666666666666664},{x:.1875,y:.15,w:.05,h:.06666666666666667},{x:.1875,y:.15,w:.075,h:.1},{x:.2125,y:.15,w:.03125,h:.041666666666666664},{x:.2125,y:.15,w:.05,h:.06666666666666667},{x:.2125,y:.15,w:.075,h:.1},{x:.2375,y:.15,w:.03125,h:.041666666666666664},{x:.2375,y:.15,w:.05,h:.06666666666666667},{x:.2375,y:.15,w:.075,h:.1},{x:.2625,y:.15,w:.03125,h:.041666666666666664},{x:.2625,y:.15,w:.05,h:.06666666666666667},{x:.2625,y:.15,w:.075,h:.1},{x:.2875,y:.15,w:.03125,h:.041666666666666664},{x:.2875,y:.15,w:.05,h:.06666666666666667},{x:.2875,y:.15,w:.075,h:.1},{x:.3125,y:.15,w:.03125,h:.041666666666666664},{x:.3125,y:.15,w:.05,h:.06666666666666667},{x:.3125,y:.15,w:.075,h:.1},{x:.3375,y:.15,w:.03125,h:.041666666666666664},{x:.3375,y:.15,w:.05,h:.06666666666666667},{x:.3375,y:.15,w:.075,h:.1},{x:.3625,y:.15,w:.03125,h:.041666666666666664},{x:.3625,y:.15,w:.05,h:.06666666666666667},{x:.3625,y:.15,w:.075,h:.1},{x:.3875,y:.15,w:.03125,h:.041666666666666664},{x:.3875,y:.15,w:.05,h:.06666666666666667},{x:.3875,y:.15,w:.075,h:.1},{x:.4125,y:.15,w:.03125,h:.041666666666666664},{x:.4125,y:.15,w:.05,h:.06666666666666667},{x:.4125,y:.15,w:.075,h:.1},{x:.4375,y:.15,w:.03125,h:.041666666666666664},{x:.4375,y:.15,w:.05,h:.06666666666666667},{x:.4375,y:.15,w:.075,h:.1},{x:.4625,y:.15,w:.03125,h:.041666666666666664},{x:.4625,y:.15,w:.05,h:.06666666666666667},{x:.4625,y:.15,w:.075,h:.1},{x:.4875,y:.15,w:.03125,h:.041666666666666664},{x:.4875,y:.15,w:.05,h:.06666666666666667},{x:.4875,y:.15,w:.075,h:.1},{x:.5125,y:.15,w:.03125,h:.041666666666666664},{x:.5125,y:.15,w:.05,h:.06666666666666667},{x:.5125,y:.15,w:.075,h:.1},{x:.5375,y:.15,w:.03125,h:.041666666666666664},{x:.5375,y:.15,w:.05,h:.06666666666666667},{x:.5375,y:.15,w:.075,h:.1},{x:.5625,y:.15,w:.03125,h:.041666666666666664},{x:.5625,y:.15,w:.05,h:.06666666666666667},{x:.5625,y:.15,w:.075,h:.1},{x:.5875,y:.15,w:.03125,h:.041666666666666664},{x:.5875,y:.15,w:.05,h:.06666666666666667},{x:.5875,y:.15,w:.075,h:.1},{x:.6125,y:.15,w:.03125,h:.041666666666666664},{x:.6125,y:.15,w:.05,h:.06666666666666667},{x:.6125,y:.15,w:.075,h:.1},{x:.6375,y:.15,w:.03125,h:.041666666666666664},{x:.6375,y:.15,w:.05,h:.06666666666666667},{x:.6375,y:.15,w:.075,h:.1},{x:.6625,y:.15,w:.03125,h:.041666666666666664},{x:.6625,y:.15,w:.05,h:.06666666666666667},{x:.6625,y:.15,w:.075,h:.1},{x:.6875,y:.15,w:.03125,h:.041666666666666664},{x:.6875,y:.15,w:.05,h:.06666666666666667},{x:.6875,y:.15,w:.075,h:.1},{x:.7125,y:.15,w:.03125,h:.041666666666666664},{x:.7125,y:.15,w:.05,h:.06666666666666667},{x:.7125,y:.15,w:.075,h:.1},{x:.7375,y:.15,w:.03125,h:.041666666666666664},{x:.7375,y:.15,w:.05,h:.06666666666666667},{x:.7375,y:.15,w:.075,h:.1},{x:.7625,y:.15,w:.03125,h:.041666666666666664},{x:.7625,y:.15,w:.05,h:.06666666666666667},{x:.7625,y:.15,w:.075,h:.1},{x:.7875,y:.15,w:.03125,h:.041666666666666664},{x:.7875,y:.15,w:.05,h:.06666666666666667},{x:.7875,y:.15,w:.075,h:.1},{x:.8125,y:.15,w:.03125,h:.041666666666666664},{x:.8125,y:.15,w:.05,h:.06666666666666667},{x:.8125,y:.15,w:.075,h:.1},{x:.8375,y:.15,w:.03125,h:.041666666666666664},{x:.8375,y:.15,w:.05,h:.06666666666666667},{x:.8375,y:.15,w:.075,h:.1},{x:.8625,y:.15,w:.03125,h:.041666666666666664},{x:.8625,y:.15,w:.05,h:.06666666666666667},{x:.8625,y:.15,w:.075,h:.1},{x:.8875,y:.15,w:.03125,h:.041666666666666664},{x:.8875,y:.15,w:.05,h:.06666666666666667},{x:.8875,y:.15,w:.075,h:.1},{x:.9125,y:.15,w:.03125,h:.041666666666666664},{x:.9125,y:.15,w:.05,h:.06666666666666667},{x:.9125,y:.15,w:.075,h:.1},{x:.9375,y:.15,w:.03125,h:.041666666666666664},{x:.9375,y:.15,w:.05,h:.06666666666666667},{x:.9375,y:.15,w:.075,h:.1},{x:.9625,y:.15,w:.03125,h:.041666666666666664},{x:.9625,y:.15,w:.05,h:.06666666666666667},{x:.9625,y:.15,w:.075,h:.1},{x:.9875,y:.15,w:.03125,h:.041666666666666664},{x:.9875,y:.15,w:.05,h:.06666666666666667},{x:.9875,y:.15,w:.075,h:.1},{x:.0125,y:.18333333333333332,w:.03125,h:.041666666666666664},{x:.0125,y:.18333333333333332,w:.05,h:.06666666666666667},{x:.0125,y:.18333333333333332,w:.075,h:.1},{x:.0375,y:.18333333333333332,w:.03125,h:.041666666666666664},{x:.0375,y:.18333333333333332,w:.05,h:.06666666666666667},{x:.0375,y:.18333333333333332,w:.075,h:.1},{x:.0625,y:.18333333333333332,w:.03125,h:.041666666666666664},{x:.0625,y:.18333333333333332,w:.05,h:.06666666666666667},{x:.0625,y:.18333333333333332,w:.075,h:.1},{x:.0875,y:.18333333333333332,w:.03125,h:.041666666666666664},{x:.0875,y:.18333333333333332,w:.05,h:.06666666666666667},{x:.0875,y:.18333333333333332,w:.075,h:.1},{x:.1125,y:.18333333333333332,w:.03125,h:.041666666666666664},{x:.1125,y:.18333333333333332,w:.05,h:.06666666666666667},{x:.1125,y:.18333333333333332,w:.075,h:.1},{x:.1375,y:.18333333333333332,w:.03125,h:.041666666666666664},{x:.1375,y:.18333333333333332,w:.05,h:.06666666666666667},{x:.1375,y:.18333333333333332,w:.075,h:.1},{x:.1625,y:.18333333333333332,w:.03125,h:.041666666666666664},{x:.1625,y:.18333333333333332,w:.05,h:.06666666666666667},{x:.1625,y:.18333333333333332,w:.075,h:.1},{x:.1875,y:.18333333333333332,w:.03125,h:.041666666666666664},{x:.1875,y:.18333333333333332,w:.05,h:.06666666666666667},{x:.1875,y:.18333333333333332,w:.075,h:.1},{x:.2125,y:.18333333333333332,w:.03125,h:.041666666666666664},{x:.2125,y:.18333333333333332,w:.05,h:.06666666666666667},{x:.2125,y:.18333333333333332,w:.075,h:.1},{x:.2375,y:.18333333333333332,w:.03125,h:.041666666666666664},{x:.2375,y:.18333333333333332,w:.05,h:.06666666666666667},{x:.2375,y:.18333333333333332,w:.075,h:.1},{x:.2625,y:.18333333333333332,w:.03125,h:.041666666666666664},{x:.2625,y:.18333333333333332,w:.05,h:.06666666666666667},{x:.2625,y:.18333333333333332,w:.075,h:.1},{x:.2875,y:.18333333333333332,w:.03125,h:.041666666666666664},{x:.2875,y:.18333333333333332,w:.05,h:.06666666666666667},{x:.2875,y:.18333333333333332,w:.075,h:.1},{x:.3125,y:.18333333333333332,w:.03125,h:.041666666666666664},{x:.3125,y:.18333333333333332,w:.05,h:.06666666666666667},{x:.3125,y:.18333333333333332,w:.075,h:.1},{x:.3375,y:.18333333333333332,w:.03125,h:.041666666666666664},{x:.3375,y:.18333333333333332,w:.05,h:.06666666666666667},{x:.3375,y:.18333333333333332,w:.075,h:.1},{x:.3625,y:.18333333333333332,w:.03125,h:.041666666666666664},{x:.3625,y:.18333333333333332,w:.05,h:.06666666666666667},{x:.3625,y:.18333333333333332,w:.075,h:.1},{x:.3875,y:.18333333333333332,w:.03125,h:.041666666666666664},{x:.3875,y:.18333333333333332,w:.05,h:.06666666666666667},{x:.3875,y:.18333333333333332,w:.075,h:.1},{x:.4125,y:.18333333333333332,w:.03125,h:.041666666666666664},{x:.4125,y:.18333333333333332,w:.05,h:.06666666666666667},{x:.4125,y:.18333333333333332,w:.075,h:.1},{x:.4375,y:.18333333333333332,w:.03125,h:.041666666666666664},{x:.4375,y:.18333333333333332,w:.05,h:.06666666666666667},{x:.4375,y:.18333333333333332,w:.075,h:.1},{x:.4625,y:.18333333333333332,w:.03125,h:.041666666666666664},{x:.4625,y:.18333333333333332,w:.05,h:.06666666666666667},{x:.4625,y:.18333333333333332,w:.075,h:.1},{x:.4875,y:.18333333333333332,w:.03125,h:.041666666666666664},{x:.4875,y:.18333333333333332,w:.05,h:.06666666666666667},{x:.4875,y:.18333333333333332,w:.075,h:.1},{x:.5125,y:.18333333333333332,w:.03125,h:.041666666666666664},{x:.5125,y:.18333333333333332,w:.05,h:.06666666666666667},{x:.5125,y:.18333333333333332,w:.075,h:.1},{x:.5375,y:.18333333333333332,w:.03125,h:.041666666666666664},{x:.5375,y:.18333333333333332,w:.05,h:.06666666666666667},{x:.5375,y:.18333333333333332,w:.075,h:.1},{x:.5625,y:.18333333333333332,w:.03125,h:.041666666666666664},{x:.5625,y:.18333333333333332,w:.05,h:.06666666666666667},{x:.5625,y:.18333333333333332,w:.075,h:.1},{x:.5875,y:.18333333333333332,w:.03125,h:.041666666666666664},{x:.5875,y:.18333333333333332,w:.05,h:.06666666666666667},{x:.5875,y:.18333333333333332,w:.075,h:.1},{x:.6125,y:.18333333333333332,w:.03125,h:.041666666666666664},{x:.6125,y:.18333333333333332,w:.05,h:.06666666666666667},{x:.6125,y:.18333333333333332,w:.075,h:.1},{x:.6375,y:.18333333333333332,w:.03125,h:.041666666666666664},{x:.6375,y:.18333333333333332,w:.05,h:.06666666666666667},{x:.6375,y:.18333333333333332,w:.075,h:.1},{x:.6625,y:.18333333333333332,w:.03125,h:.041666666666666664},{x:.6625,y:.18333333333333332,w:.05,h:.06666666666666667},{x:.6625,y:.18333333333333332,w:.075,h:.1},{x:.6875,y:.18333333333333332,w:.03125,h:.041666666666666664},{x:.6875,y:.18333333333333332,w:.05,h:.06666666666666667},{x:.6875,y:.18333333333333332,w:.075,h:.1},{x:.7125,y:.18333333333333332,w:.03125,h:.041666666666666664},{x:.7125,y:.18333333333333332,w:.05,h:.06666666666666667},{x:.7125,y:.18333333333333332,w:.075,h:.1},{x:.7375,y:.18333333333333332,w:.03125,h:.041666666666666664},{x:.7375,y:.18333333333333332,w:.05,h:.06666666666666667},{x:.7375,y:.18333333333333332,w:.075,h:.1},{x:.7625,y:.18333333333333332,w:.03125,h:.041666666666666664},{x:.7625,y:.18333333333333332,w:.05,h:.06666666666666667},{x:.7625,y:.18333333333333332,w:.075,h:.1},{x:.7875,y:.18333333333333332,w:.03125,h:.041666666666666664},{x:.7875,y:.18333333333333332,w:.05,h:.06666666666666667},{x:.7875,y:.18333333333333332,w:.075,h:.1},{x:.8125,y:.18333333333333332,w:.03125,h:.041666666666666664},{x:.8125,y:.18333333333333332,w:.05,h:.06666666666666667},{x:.8125,y:.18333333333333332,w:.075,h:.1},{x:.8375,y:.18333333333333332,w:.03125,h:.041666666666666664},{x:.8375,y:.18333333333333332,w:.05,h:.06666666666666667},{x:.8375,y:.18333333333333332,w:.075,h:.1},{x:.8625,y:.18333333333333332,w:.03125,h:.041666666666666664},{x:.8625,y:.18333333333333332,w:.05,h:.06666666666666667},{x:.8625,y:.18333333333333332,w:.075,h:.1},{x:.8875,y:.18333333333333332,w:.03125,h:.041666666666666664},{x:.8875,y:.18333333333333332,w:.05,h:.06666666666666667},{x:.8875,y:.18333333333333332,w:.075,h:.1},{x:.9125,y:.18333333333333332,w:.03125,h:.041666666666666664},{x:.9125,y:.18333333333333332,w:.05,h:.06666666666666667},{x:.9125,y:.18333333333333332,w:.075,h:.1},{x:.9375,y:.18333333333333332,w:.03125,h:.041666666666666664},{x:.9375,y:.18333333333333332,w:.05,h:.06666666666666667},{x:.9375,y:.18333333333333332,w:.075,h:.1},{x:.9625,y:.18333333333333332,w:.03125,h:.041666666666666664},{x:.9625,y:.18333333333333332,w:.05,h:.06666666666666667},{x:.9625,y:.18333333333333332,w:.075,h:.1},{x:.9875,y:.18333333333333332,w:.03125,h:.041666666666666664},{x:.9875,y:.18333333333333332,w:.05,h:.06666666666666667},{x:.9875,y:.18333333333333332,w:.075,h:.1},{x:.0125,y:.21666666666666667,w:.03125,h:.041666666666666664},{x:.0125,y:.21666666666666667,w:.05,h:.06666666666666667},{x:.0125,y:.21666666666666667,w:.075,h:.1},{x:.0375,y:.21666666666666667,w:.03125,h:.041666666666666664},{x:.0375,y:.21666666666666667,w:.05,h:.06666666666666667},{x:.0375,y:.21666666666666667,w:.075,h:.1},{x:.0625,y:.21666666666666667,w:.03125,h:.041666666666666664},{x:.0625,y:.21666666666666667,w:.05,h:.06666666666666667},{x:.0625,y:.21666666666666667,w:.075,h:.1},{x:.0875,y:.21666666666666667,w:.03125,h:.041666666666666664},{x:.0875,y:.21666666666666667,w:.05,h:.06666666666666667},{x:.0875,y:.21666666666666667,w:.075,h:.1},{x:.1125,y:.21666666666666667,w:.03125,h:.041666666666666664},{x:.1125,y:.21666666666666667,w:.05,h:.06666666666666667},{x:.1125,y:.21666666666666667,w:.075,h:.1},{x:.1375,y:.21666666666666667,w:.03125,h:.041666666666666664},{x:.1375,y:.21666666666666667,w:.05,h:.06666666666666667},{x:.1375,y:.21666666666666667,w:.075,h:.1},{x:.1625,y:.21666666666666667,w:.03125,h:.041666666666666664},{x:.1625,y:.21666666666666667,w:.05,h:.06666666666666667},{x:.1625,y:.21666666666666667,w:.075,h:.1},{x:.1875,y:.21666666666666667,w:.03125,h:.041666666666666664},{x:.1875,y:.21666666666666667,w:.05,h:.06666666666666667},{x:.1875,y:.21666666666666667,w:.075,h:.1},{x:.2125,y:.21666666666666667,w:.03125,h:.041666666666666664},{x:.2125,y:.21666666666666667,w:.05,h:.06666666666666667},{x:.2125,y:.21666666666666667,w:.075,h:.1},{x:.2375,y:.21666666666666667,w:.03125,h:.041666666666666664},{x:.2375,y:.21666666666666667,w:.05,h:.06666666666666667},{x:.2375,y:.21666666666666667,w:.075,h:.1},{x:.2625,y:.21666666666666667,w:.03125,h:.041666666666666664},{x:.2625,y:.21666666666666667,w:.05,h:.06666666666666667},{x:.2625,y:.21666666666666667,w:.075,h:.1},{x:.2875,y:.21666666666666667,w:.03125,h:.041666666666666664},{x:.2875,y:.21666666666666667,w:.05,h:.06666666666666667},{x:.2875,y:.21666666666666667,w:.075,h:.1},{x:.3125,y:.21666666666666667,w:.03125,h:.041666666666666664},{x:.3125,y:.21666666666666667,w:.05,h:.06666666666666667},{x:.3125,y:.21666666666666667,w:.075,h:.1},{x:.3375,y:.21666666666666667,w:.03125,h:.041666666666666664},{x:.3375,y:.21666666666666667,w:.05,h:.06666666666666667},{x:.3375,y:.21666666666666667,w:.075,h:.1},{x:.3625,y:.21666666666666667,w:.03125,h:.041666666666666664},{x:.3625,y:.21666666666666667,w:.05,h:.06666666666666667},{x:.3625,y:.21666666666666667,w:.075,h:.1},{x:.3875,y:.21666666666666667,w:.03125,h:.041666666666666664},{x:.3875,y:.21666666666666667,w:.05,h:.06666666666666667},{x:.3875,y:.21666666666666667,w:.075,h:.1},{x:.4125,y:.21666666666666667,w:.03125,h:.041666666666666664},{x:.4125,y:.21666666666666667,w:.05,h:.06666666666666667},{x:.4125,y:.21666666666666667,w:.075,h:.1},{x:.4375,y:.21666666666666667,w:.03125,h:.041666666666666664},{x:.4375,y:.21666666666666667,w:.05,h:.06666666666666667},{x:.4375,y:.21666666666666667,w:.075,h:.1},{x:.4625,y:.21666666666666667,w:.03125,h:.041666666666666664},{x:.4625,y:.21666666666666667,w:.05,h:.06666666666666667},{x:.4625,y:.21666666666666667,w:.075,h:.1},{x:.4875,y:.21666666666666667,w:.03125,h:.041666666666666664},{x:.4875,y:.21666666666666667,w:.05,h:.06666666666666667},{x:.4875,y:.21666666666666667,w:.075,h:.1},{x:.5125,y:.21666666666666667,w:.03125,h:.041666666666666664},{x:.5125,y:.21666666666666667,w:.05,h:.06666666666666667},{x:.5125,y:.21666666666666667,w:.075,h:.1},{x:.5375,y:.21666666666666667,w:.03125,h:.041666666666666664},{x:.5375,y:.21666666666666667,w:.05,h:.06666666666666667},{x:.5375,y:.21666666666666667,w:.075,h:.1},{x:.5625,y:.21666666666666667,w:.03125,h:.041666666666666664},{x:.5625,y:.21666666666666667,w:.05,h:.06666666666666667},{x:.5625,y:.21666666666666667,w:.075,h:.1},{x:.5875,y:.21666666666666667,w:.03125,h:.041666666666666664},{x:.5875,y:.21666666666666667,w:.05,h:.06666666666666667},{x:.5875,y:.21666666666666667,w:.075,h:.1},{x:.6125,y:.21666666666666667,w:.03125,h:.041666666666666664},{x:.6125,y:.21666666666666667,w:.05,h:.06666666666666667},{x:.6125,y:.21666666666666667,w:.075,h:.1},{x:.6375,y:.21666666666666667,w:.03125,h:.041666666666666664},{x:.6375,y:.21666666666666667,w:.05,h:.06666666666666667},{x:.6375,y:.21666666666666667,w:.075,h:.1},{x:.6625,y:.21666666666666667,w:.03125,h:.041666666666666664},{x:.6625,y:.21666666666666667,w:.05,h:.06666666666666667},{x:.6625,y:.21666666666666667,w:.075,h:.1},{x:.6875,y:.21666666666666667,w:.03125,h:.041666666666666664},{x:.6875,y:.21666666666666667,w:.05,h:.06666666666666667},{x:.6875,y:.21666666666666667,w:.075,h:.1},{x:.7125,y:.21666666666666667,w:.03125,h:.041666666666666664},{x:.7125,y:.21666666666666667,w:.05,h:.06666666666666667},{x:.7125,y:.21666666666666667,w:.075,h:.1},{x:.7375,y:.21666666666666667,w:.03125,h:.041666666666666664},{x:.7375,y:.21666666666666667,w:.05,h:.06666666666666667},{x:.7375,y:.21666666666666667,w:.075,h:.1},{x:.7625,y:.21666666666666667,w:.03125,h:.041666666666666664},{x:.7625,y:.21666666666666667,w:.05,h:.06666666666666667},{x:.7625,y:.21666666666666667,w:.075,h:.1},{x:.7875,y:.21666666666666667,w:.03125,h:.041666666666666664},{x:.7875,y:.21666666666666667,w:.05,h:.06666666666666667},{x:.7875,y:.21666666666666667,w:.075,h:.1},{x:.8125,y:.21666666666666667,w:.03125,h:.041666666666666664},{x:.8125,y:.21666666666666667,w:.05,h:.06666666666666667},{x:.8125,y:.21666666666666667,w:.075,h:.1},{x:.8375,y:.21666666666666667,w:.03125,h:.041666666666666664},{x:.8375,y:.21666666666666667,w:.05,h:.06666666666666667},{x:.8375,y:.21666666666666667,w:.075,h:.1},{x:.8625,y:.21666666666666667,w:.03125,h:.041666666666666664},{x:.8625,y:.21666666666666667,w:.05,h:.06666666666666667},{x:.8625,y:.21666666666666667,w:.075,h:.1},{x:.8875,y:.21666666666666667,w:.03125,h:.041666666666666664},{x:.8875,y:.21666666666666667,w:.05,h:.06666666666666667},{x:.8875,y:.21666666666666667,w:.075,h:.1},{x:.9125,y:.21666666666666667,w:.03125,h:.041666666666666664},{x:.9125,y:.21666666666666667,w:.05,h:.06666666666666667},{x:.9125,y:.21666666666666667,w:.075,h:.1},{x:.9375,y:.21666666666666667,w:.03125,h:.041666666666666664},{x:.9375,y:.21666666666666667,w:.05,h:.06666666666666667},{x:.9375,y:.21666666666666667,w:.075,h:.1},{x:.9625,y:.21666666666666667,w:.03125,h:.041666666666666664},{x:.9625,y:.21666666666666667,w:.05,h:.06666666666666667},{x:.9625,y:.21666666666666667,w:.075,h:.1},{x:.9875,y:.21666666666666667,w:.03125,h:.041666666666666664},{x:.9875,y:.21666666666666667,w:.05,h:.06666666666666667},{x:.9875,y:.21666666666666667,w:.075,h:.1},{x:.0125,y:.25,w:.03125,h:.041666666666666664},{x:.0125,y:.25,w:.05,h:.06666666666666667},{x:.0125,y:.25,w:.075,h:.1},{x:.0375,y:.25,w:.03125,h:.041666666666666664},{x:.0375,y:.25,w:.05,h:.06666666666666667},{x:.0375,y:.25,w:.075,h:.1},{x:.0625,y:.25,w:.03125,h:.041666666666666664},{x:.0625,y:.25,w:.05,h:.06666666666666667},{x:.0625,y:.25,w:.075,h:.1},{x:.0875,y:.25,w:.03125,h:.041666666666666664},{x:.0875,y:.25,w:.05,h:.06666666666666667},{x:.0875,y:.25,w:.075,h:.1},{x:.1125,y:.25,w:.03125,h:.041666666666666664},{x:.1125,y:.25,w:.05,h:.06666666666666667},{x:.1125,y:.25,w:.075,h:.1},{x:.1375,y:.25,w:.03125,h:.041666666666666664},{x:.1375,y:.25,w:.05,h:.06666666666666667},{x:.1375,y:.25,w:.075,h:.1},{x:.1625,y:.25,w:.03125,h:.041666666666666664},{x:.1625,y:.25,w:.05,h:.06666666666666667},{x:.1625,y:.25,w:.075,h:.1},{x:.1875,y:.25,w:.03125,h:.041666666666666664},{x:.1875,y:.25,w:.05,h:.06666666666666667},{x:.1875,y:.25,w:.075,h:.1},{x:.2125,y:.25,w:.03125,h:.041666666666666664},{x:.2125,y:.25,w:.05,h:.06666666666666667},{x:.2125,y:.25,w:.075,h:.1},{x:.2375,y:.25,w:.03125,h:.041666666666666664},{x:.2375,y:.25,w:.05,h:.06666666666666667},{x:.2375,y:.25,w:.075,h:.1},{x:.2625,y:.25,w:.03125,h:.041666666666666664},{x:.2625,y:.25,w:.05,h:.06666666666666667},{x:.2625,y:.25,w:.075,h:.1},{x:.2875,y:.25,w:.03125,h:.041666666666666664},{x:.2875,y:.25,w:.05,h:.06666666666666667},{x:.2875,y:.25,w:.075,h:.1},{x:.3125,y:.25,w:.03125,h:.041666666666666664},{x:.3125,y:.25,w:.05,h:.06666666666666667},{x:.3125,y:.25,w:.075,h:.1},{x:.3375,y:.25,w:.03125,h:.041666666666666664},{x:.3375,y:.25,w:.05,h:.06666666666666667},{x:.3375,y:.25,w:.075,h:.1},{x:.3625,y:.25,w:.03125,h:.041666666666666664},{x:.3625,y:.25,w:.05,h:.06666666666666667},{x:.3625,y:.25,w:.075,h:.1},{x:.3875,y:.25,w:.03125,h:.041666666666666664},{x:.3875,y:.25,w:.05,h:.06666666666666667},{x:.3875,y:.25,w:.075,h:.1},{x:.4125,y:.25,w:.03125,h:.041666666666666664},{x:.4125,y:.25,w:.05,h:.06666666666666667},{x:.4125,y:.25,w:.075,h:.1},{x:.4375,y:.25,w:.03125,h:.041666666666666664},{x:.4375,y:.25,w:.05,h:.06666666666666667},{x:.4375,y:.25,w:.075,h:.1},{x:.4625,y:.25,w:.03125,h:.041666666666666664},{x:.4625,y:.25,w:.05,h:.06666666666666667},{x:.4625,y:.25,w:.075,h:.1},{x:.4875,y:.25,w:.03125,h:.041666666666666664},{x:.4875,y:.25,w:.05,h:.06666666666666667},{x:.4875,y:.25,w:.075,h:.1},{x:.5125,y:.25,w:.03125,h:.041666666666666664},{x:.5125,y:.25,w:.05,h:.06666666666666667},{x:.5125,y:.25,w:.075,h:.1},{x:.5375,y:.25,w:.03125,h:.041666666666666664},{x:.5375,y:.25,w:.05,h:.06666666666666667},{x:.5375,y:.25,w:.075,h:.1},{x:.5625,y:.25,w:.03125,h:.041666666666666664},{x:.5625,y:.25,w:.05,h:.06666666666666667},{x:.5625,y:.25,w:.075,h:.1},{x:.5875,y:.25,w:.03125,h:.041666666666666664},{x:.5875,y:.25,w:.05,h:.06666666666666667},{x:.5875,y:.25,w:.075,h:.1},{x:.6125,y:.25,w:.03125,h:.041666666666666664},{x:.6125,y:.25,w:.05,h:.06666666666666667},{x:.6125,y:.25,w:.075,h:.1},{x:.6375,y:.25,w:.03125,h:.041666666666666664},{x:.6375,y:.25,w:.05,h:.06666666666666667},{x:.6375,y:.25,w:.075,h:.1},{x:.6625,y:.25,w:.03125,h:.041666666666666664},{x:.6625,y:.25,w:.05,h:.06666666666666667},{x:.6625,y:.25,w:.075,h:.1},{x:.6875,y:.25,w:.03125,h:.041666666666666664},{x:.6875,y:.25,w:.05,h:.06666666666666667},{x:.6875,y:.25,w:.075,h:.1},{x:.7125,y:.25,w:.03125,h:.041666666666666664},{x:.7125,y:.25,w:.05,h:.06666666666666667},{x:.7125,y:.25,w:.075,h:.1},{x:.7375,y:.25,w:.03125,h:.041666666666666664},{x:.7375,y:.25,w:.05,h:.06666666666666667},{x:.7375,y:.25,w:.075,h:.1},{x:.7625,y:.25,w:.03125,h:.041666666666666664},{x:.7625,y:.25,w:.05,h:.06666666666666667},{x:.7625,y:.25,w:.075,h:.1},{x:.7875,y:.25,w:.03125,h:.041666666666666664},{x:.7875,y:.25,w:.05,h:.06666666666666667},{x:.7875,y:.25,w:.075,h:.1},{x:.8125,y:.25,w:.03125,h:.041666666666666664},{x:.8125,y:.25,w:.05,h:.06666666666666667},{x:.8125,y:.25,w:.075,h:.1},{x:.8375,y:.25,w:.03125,h:.041666666666666664},{x:.8375,y:.25,w:.05,h:.06666666666666667},{x:.8375,y:.25,w:.075,h:.1},{x:.8625,y:.25,w:.03125,h:.041666666666666664},{x:.8625,y:.25,w:.05,h:.06666666666666667},{x:.8625,y:.25,w:.075,h:.1},{x:.8875,y:.25,w:.03125,h:.041666666666666664},{x:.8875,y:.25,w:.05,h:.06666666666666667},{x:.8875,y:.25,w:.075,h:.1},{x:.9125,y:.25,w:.03125,h:.041666666666666664},{x:.9125,y:.25,w:.05,h:.06666666666666667},{x:.9125,y:.25,w:.075,h:.1},{x:.9375,y:.25,w:.03125,h:.041666666666666664},{x:.9375,y:.25,w:.05,h:.06666666666666667},{x:.9375,y:.25,w:.075,h:.1},{x:.9625,y:.25,w:.03125,h:.041666666666666664},{x:.9625,y:.25,w:.05,h:.06666666666666667},{x:.9625,y:.25,w:.075,h:.1},{x:.9875,y:.25,w:.03125,h:.041666666666666664},{x:.9875,y:.25,w:.05,h:.06666666666666667},{x:.9875,y:.25,w:.075,h:.1},{x:.0125,y:.2833333333333333,w:.03125,h:.041666666666666664},{x:.0125,y:.2833333333333333,w:.05,h:.06666666666666667},{x:.0125,y:.2833333333333333,w:.075,h:.1},{x:.0375,y:.2833333333333333,w:.03125,h:.041666666666666664},{x:.0375,y:.2833333333333333,w:.05,h:.06666666666666667},{x:.0375,y:.2833333333333333,w:.075,h:.1},{x:.0625,y:.2833333333333333,w:.03125,h:.041666666666666664},{x:.0625,y:.2833333333333333,w:.05,h:.06666666666666667},{x:.0625,y:.2833333333333333,w:.075,h:.1},{x:.0875,y:.2833333333333333,w:.03125,h:.041666666666666664},{x:.0875,y:.2833333333333333,w:.05,h:.06666666666666667},{x:.0875,y:.2833333333333333,w:.075,h:.1},{x:.1125,y:.2833333333333333,w:.03125,h:.041666666666666664},{x:.1125,y:.2833333333333333,w:.05,h:.06666666666666667},{x:.1125,y:.2833333333333333,w:.075,h:.1},{x:.1375,y:.2833333333333333,w:.03125,h:.041666666666666664},{x:.1375,y:.2833333333333333,w:.05,h:.06666666666666667},{x:.1375,y:.2833333333333333,w:.075,h:.1},{x:.1625,y:.2833333333333333,w:.03125,h:.041666666666666664},{x:.1625,y:.2833333333333333,w:.05,h:.06666666666666667},{x:.1625,y:.2833333333333333,w:.075,h:.1},{x:.1875,y:.2833333333333333,w:.03125,h:.041666666666666664},{x:.1875,y:.2833333333333333,w:.05,h:.06666666666666667},{x:.1875,y:.2833333333333333,w:.075,h:.1},{x:.2125,y:.2833333333333333,w:.03125,h:.041666666666666664},{x:.2125,y:.2833333333333333,w:.05,h:.06666666666666667},{x:.2125,y:.2833333333333333,w:.075,h:.1},{x:.2375,y:.2833333333333333,w:.03125,h:.041666666666666664},{x:.2375,y:.2833333333333333,w:.05,h:.06666666666666667},{x:.2375,y:.2833333333333333,w:.075,h:.1},{x:.2625,y:.2833333333333333,w:.03125,h:.041666666666666664},{x:.2625,y:.2833333333333333,w:.05,h:.06666666666666667},{x:.2625,y:.2833333333333333,w:.075,h:.1},{x:.2875,y:.2833333333333333,w:.03125,h:.041666666666666664},{x:.2875,y:.2833333333333333,w:.05,h:.06666666666666667},{x:.2875,y:.2833333333333333,w:.075,h:.1},{x:.3125,y:.2833333333333333,w:.03125,h:.041666666666666664},{x:.3125,y:.2833333333333333,w:.05,h:.06666666666666667},{x:.3125,y:.2833333333333333,w:.075,h:.1},{x:.3375,y:.2833333333333333,w:.03125,h:.041666666666666664},{x:.3375,y:.2833333333333333,w:.05,h:.06666666666666667},{x:.3375,y:.2833333333333333,w:.075,h:.1},{x:.3625,y:.2833333333333333,w:.03125,h:.041666666666666664},{x:.3625,y:.2833333333333333,w:.05,h:.06666666666666667},{x:.3625,y:.2833333333333333,w:.075,h:.1},{x:.3875,y:.2833333333333333,w:.03125,h:.041666666666666664},{x:.3875,y:.2833333333333333,w:.05,h:.06666666666666667},{x:.3875,y:.2833333333333333,w:.075,h:.1},{x:.4125,y:.2833333333333333,w:.03125,h:.041666666666666664},{x:.4125,y:.2833333333333333,w:.05,h:.06666666666666667},{x:.4125,y:.2833333333333333,w:.075,h:.1},{x:.4375,y:.2833333333333333,w:.03125,h:.041666666666666664},{x:.4375,y:.2833333333333333,w:.05,h:.06666666666666667},{x:.4375,y:.2833333333333333,w:.075,h:.1},{x:.4625,y:.2833333333333333,w:.03125,h:.041666666666666664},{x:.4625,y:.2833333333333333,w:.05,h:.06666666666666667},{x:.4625,y:.2833333333333333,w:.075,h:.1},{x:.4875,y:.2833333333333333,w:.03125,h:.041666666666666664},{x:.4875,y:.2833333333333333,w:.05,h:.06666666666666667},{x:.4875,y:.2833333333333333,w:.075,h:.1},{x:.5125,y:.2833333333333333,w:.03125,h:.041666666666666664},{x:.5125,y:.2833333333333333,w:.05,h:.06666666666666667},{x:.5125,y:.2833333333333333,w:.075,h:.1},{x:.5375,y:.2833333333333333,w:.03125,h:.041666666666666664},{x:.5375,y:.2833333333333333,w:.05,h:.06666666666666667},{x:.5375,y:.2833333333333333,w:.075,h:.1},{x:.5625,y:.2833333333333333,w:.03125,h:.041666666666666664},{x:.5625,y:.2833333333333333,w:.05,h:.06666666666666667},{x:.5625,y:.2833333333333333,w:.075,h:.1},{x:.5875,y:.2833333333333333,w:.03125,h:.041666666666666664},{x:.5875,y:.2833333333333333,w:.05,h:.06666666666666667},{x:.5875,y:.2833333333333333,w:.075,h:.1},{x:.6125,y:.2833333333333333,w:.03125,h:.041666666666666664},{x:.6125,y:.2833333333333333,w:.05,h:.06666666666666667},{x:.6125,y:.2833333333333333,w:.075,h:.1},{x:.6375,y:.2833333333333333,w:.03125,h:.041666666666666664},{x:.6375,y:.2833333333333333,w:.05,h:.06666666666666667},{x:.6375,y:.2833333333333333,w:.075,h:.1},{x:.6625,y:.2833333333333333,w:.03125,h:.041666666666666664},{x:.6625,y:.2833333333333333,w:.05,h:.06666666666666667},{x:.6625,y:.2833333333333333,w:.075,h:.1},{x:.6875,y:.2833333333333333,w:.03125,h:.041666666666666664},{x:.6875,y:.2833333333333333,w:.05,h:.06666666666666667},{x:.6875,y:.2833333333333333,w:.075,h:.1},{x:.7125,y:.2833333333333333,w:.03125,h:.041666666666666664},{x:.7125,y:.2833333333333333,w:.05,h:.06666666666666667},{x:.7125,y:.2833333333333333,w:.075,h:.1},{x:.7375,y:.2833333333333333,w:.03125,h:.041666666666666664},{x:.7375,y:.2833333333333333,w:.05,h:.06666666666666667},{x:.7375,y:.2833333333333333,w:.075,h:.1},{x:.7625,y:.2833333333333333,w:.03125,h:.041666666666666664},{x:.7625,y:.2833333333333333,w:.05,h:.06666666666666667},{x:.7625,y:.2833333333333333,w:.075,h:.1},{x:.7875,y:.2833333333333333,w:.03125,h:.041666666666666664},{x:.7875,y:.2833333333333333,w:.05,h:.06666666666666667},{x:.7875,y:.2833333333333333,w:.075,h:.1},{x:.8125,y:.2833333333333333,w:.03125,h:.041666666666666664},{x:.8125,y:.2833333333333333,w:.05,h:.06666666666666667},{x:.8125,y:.2833333333333333,w:.075,h:.1},{x:.8375,y:.2833333333333333,w:.03125,h:.041666666666666664},{x:.8375,y:.2833333333333333,w:.05,h:.06666666666666667},{x:.8375,y:.2833333333333333,w:.075,h:.1},{x:.8625,y:.2833333333333333,w:.03125,h:.041666666666666664},{x:.8625,y:.2833333333333333,w:.05,h:.06666666666666667},{x:.8625,y:.2833333333333333,w:.075,h:.1},{x:.8875,y:.2833333333333333,w:.03125,h:.041666666666666664},{x:.8875,y:.2833333333333333,w:.05,h:.06666666666666667},{x:.8875,y:.2833333333333333,w:.075,h:.1},{x:.9125,y:.2833333333333333,w:.03125,h:.041666666666666664},{x:.9125,y:.2833333333333333,w:.05,h:.06666666666666667},{x:.9125,y:.2833333333333333,w:.075,h:.1},{x:.9375,y:.2833333333333333,w:.03125,h:.041666666666666664},{x:.9375,y:.2833333333333333,w:.05,h:.06666666666666667},{x:.9375,y:.2833333333333333,w:.075,h:.1},{x:.9625,y:.2833333333333333,w:.03125,h:.041666666666666664},{x:.9625,y:.2833333333333333,w:.05,h:.06666666666666667},{x:.9625,y:.2833333333333333,w:.075,h:.1},{x:.9875,y:.2833333333333333,w:.03125,h:.041666666666666664},{x:.9875,y:.2833333333333333,w:.05,h:.06666666666666667},{x:.9875,y:.2833333333333333,w:.075,h:.1},{x:.0125,y:.31666666666666665,w:.03125,h:.041666666666666664},{x:.0125,y:.31666666666666665,w:.05,h:.06666666666666667},{x:.0125,y:.31666666666666665,w:.075,h:.1},{x:.0375,y:.31666666666666665,w:.03125,h:.041666666666666664},{x:.0375,y:.31666666666666665,w:.05,h:.06666666666666667},{x:.0375,y:.31666666666666665,w:.075,h:.1},{x:.0625,y:.31666666666666665,w:.03125,h:.041666666666666664},{x:.0625,y:.31666666666666665,w:.05,h:.06666666666666667},{x:.0625,y:.31666666666666665,w:.075,h:.1},{x:.0875,y:.31666666666666665,w:.03125,h:.041666666666666664},{x:.0875,y:.31666666666666665,w:.05,h:.06666666666666667},{x:.0875,y:.31666666666666665,w:.075,h:.1},{x:.1125,y:.31666666666666665,w:.03125,h:.041666666666666664},{x:.1125,y:.31666666666666665,w:.05,h:.06666666666666667},{x:.1125,y:.31666666666666665,w:.075,h:.1},{x:.1375,y:.31666666666666665,w:.03125,h:.041666666666666664},{x:.1375,y:.31666666666666665,w:.05,h:.06666666666666667},{x:.1375,y:.31666666666666665,w:.075,h:.1},{x:.1625,y:.31666666666666665,w:.03125,h:.041666666666666664},{x:.1625,y:.31666666666666665,w:.05,h:.06666666666666667},{x:.1625,y:.31666666666666665,w:.075,h:.1},{x:.1875,y:.31666666666666665,w:.03125,h:.041666666666666664},{x:.1875,y:.31666666666666665,w:.05,h:.06666666666666667},{x:.1875,y:.31666666666666665,w:.075,h:.1},{x:.2125,y:.31666666666666665,w:.03125,h:.041666666666666664},{x:.2125,y:.31666666666666665,w:.05,h:.06666666666666667},{x:.2125,y:.31666666666666665,w:.075,h:.1},{x:.2375,y:.31666666666666665,w:.03125,h:.041666666666666664},{x:.2375,y:.31666666666666665,w:.05,h:.06666666666666667},{x:.2375,y:.31666666666666665,w:.075,h:.1},{x:.2625,y:.31666666666666665,w:.03125,h:.041666666666666664},{x:.2625,y:.31666666666666665,w:.05,h:.06666666666666667},{x:.2625,y:.31666666666666665,w:.075,h:.1},{x:.2875,y:.31666666666666665,w:.03125,h:.041666666666666664},{x:.2875,y:.31666666666666665,w:.05,h:.06666666666666667},{x:.2875,y:.31666666666666665,w:.075,h:.1},{x:.3125,y:.31666666666666665,w:.03125,h:.041666666666666664},{x:.3125,y:.31666666666666665,w:.05,h:.06666666666666667},{x:.3125,y:.31666666666666665,w:.075,h:.1},{x:.3375,y:.31666666666666665,w:.03125,h:.041666666666666664},{x:.3375,y:.31666666666666665,w:.05,h:.06666666666666667},{x:.3375,y:.31666666666666665,w:.075,h:.1},{x:.3625,y:.31666666666666665,w:.03125,h:.041666666666666664},{x:.3625,y:.31666666666666665,w:.05,h:.06666666666666667},{x:.3625,y:.31666666666666665,w:.075,h:.1},{x:.3875,y:.31666666666666665,w:.03125,h:.041666666666666664},{x:.3875,y:.31666666666666665,w:.05,h:.06666666666666667},{x:.3875,y:.31666666666666665,w:.075,h:.1},{x:.4125,y:.31666666666666665,w:.03125,h:.041666666666666664},{x:.4125,y:.31666666666666665,w:.05,h:.06666666666666667},{x:.4125,y:.31666666666666665,w:.075,h:.1},{x:.4375,y:.31666666666666665,w:.03125,h:.041666666666666664},{x:.4375,y:.31666666666666665,w:.05,h:.06666666666666667},{x:.4375,y:.31666666666666665,w:.075,h:.1},{x:.4625,y:.31666666666666665,w:.03125,h:.041666666666666664},{x:.4625,y:.31666666666666665,w:.05,h:.06666666666666667},{x:.4625,y:.31666666666666665,w:.075,h:.1},{x:.4875,y:.31666666666666665,w:.03125,h:.041666666666666664},{x:.4875,y:.31666666666666665,w:.05,h:.06666666666666667},{x:.4875,y:.31666666666666665,w:.075,h:.1},{x:.5125,y:.31666666666666665,w:.03125,h:.041666666666666664},{x:.5125,y:.31666666666666665,w:.05,h:.06666666666666667},{x:.5125,y:.31666666666666665,w:.075,h:.1},{x:.5375,y:.31666666666666665,w:.03125,h:.041666666666666664},{x:.5375,y:.31666666666666665,w:.05,h:.06666666666666667},{x:.5375,y:.31666666666666665,w:.075,h:.1},{x:.5625,y:.31666666666666665,w:.03125,h:.041666666666666664},{x:.5625,y:.31666666666666665,w:.05,h:.06666666666666667},{x:.5625,y:.31666666666666665,w:.075,h:.1},{x:.5875,y:.31666666666666665,w:.03125,h:.041666666666666664},{x:.5875,y:.31666666666666665,w:.05,h:.06666666666666667},{x:.5875,y:.31666666666666665,w:.075,h:.1},{x:.6125,y:.31666666666666665,w:.03125,h:.041666666666666664},{x:.6125,y:.31666666666666665,w:.05,h:.06666666666666667},{x:.6125,y:.31666666666666665,w:.075,h:.1},{x:.6375,y:.31666666666666665,w:.03125,h:.041666666666666664},{x:.6375,y:.31666666666666665,w:.05,h:.06666666666666667},{x:.6375,y:.31666666666666665,w:.075,h:.1},{x:.6625,y:.31666666666666665,w:.03125,h:.041666666666666664},{x:.6625,y:.31666666666666665,w:.05,h:.06666666666666667},{x:.6625,y:.31666666666666665,w:.075,h:.1},{x:.6875,y:.31666666666666665,w:.03125,h:.041666666666666664},{x:.6875,y:.31666666666666665,w:.05,h:.06666666666666667},{x:.6875,y:.31666666666666665,w:.075,h:.1},{x:.7125,y:.31666666666666665,w:.03125,h:.041666666666666664},{x:.7125,y:.31666666666666665,w:.05,h:.06666666666666667},{x:.7125,y:.31666666666666665,w:.075,h:.1},{x:.7375,y:.31666666666666665,w:.03125,h:.041666666666666664},{x:.7375,y:.31666666666666665,w:.05,h:.06666666666666667},{x:.7375,y:.31666666666666665,w:.075,h:.1},{x:.7625,y:.31666666666666665,w:.03125,h:.041666666666666664},{x:.7625,y:.31666666666666665,w:.05,h:.06666666666666667},{x:.7625,y:.31666666666666665,w:.075,h:.1},{x:.7875,y:.31666666666666665,w:.03125,h:.041666666666666664},{x:.7875,y:.31666666666666665,w:.05,h:.06666666666666667},{x:.7875,y:.31666666666666665,w:.075,h:.1},{x:.8125,y:.31666666666666665,w:.03125,h:.041666666666666664},{x:.8125,y:.31666666666666665,w:.05,h:.06666666666666667},{x:.8125,y:.31666666666666665,w:.075,h:.1},{x:.8375,y:.31666666666666665,w:.03125,h:.041666666666666664},{x:.8375,y:.31666666666666665,w:.05,h:.06666666666666667},{x:.8375,y:.31666666666666665,w:.075,h:.1},{x:.8625,y:.31666666666666665,w:.03125,h:.041666666666666664},{x:.8625,y:.31666666666666665,w:.05,h:.06666666666666667},{x:.8625,y:.31666666666666665,w:.075,h:.1},{x:.8875,y:.31666666666666665,w:.03125,h:.041666666666666664},{x:.8875,y:.31666666666666665,w:.05,h:.06666666666666667},{x:.8875,y:.31666666666666665,w:.075,h:.1},{x:.9125,y:.31666666666666665,w:.03125,h:.041666666666666664},{x:.9125,y:.31666666666666665,w:.05,h:.06666666666666667},{x:.9125,y:.31666666666666665,w:.075,h:.1},{x:.9375,y:.31666666666666665,w:.03125,h:.041666666666666664},{x:.9375,y:.31666666666666665,w:.05,h:.06666666666666667},{x:.9375,y:.31666666666666665,w:.075,h:.1},{x:.9625,y:.31666666666666665,w:.03125,h:.041666666666666664},{x:.9625,y:.31666666666666665,w:.05,h:.06666666666666667},{x:.9625,y:.31666666666666665,w:.075,h:.1},{x:.9875,y:.31666666666666665,w:.03125,h:.041666666666666664},{x:.9875,y:.31666666666666665,w:.05,h:.06666666666666667},{x:.9875,y:.31666666666666665,w:.075,h:.1},{x:.0125,y:.35,w:.03125,h:.041666666666666664},{x:.0125,y:.35,w:.05,h:.06666666666666667},{x:.0125,y:.35,w:.075,h:.1},{x:.0375,y:.35,w:.03125,h:.041666666666666664},{x:.0375,y:.35,w:.05,h:.06666666666666667},{x:.0375,y:.35,w:.075,h:.1},{x:.0625,y:.35,w:.03125,h:.041666666666666664},{x:.0625,y:.35,w:.05,h:.06666666666666667},{x:.0625,y:.35,w:.075,h:.1},{x:.0875,y:.35,w:.03125,h:.041666666666666664},{x:.0875,y:.35,w:.05,h:.06666666666666667},{x:.0875,y:.35,w:.075,h:.1},{x:.1125,y:.35,w:.03125,h:.041666666666666664},{x:.1125,y:.35,w:.05,h:.06666666666666667},{x:.1125,y:.35,w:.075,h:.1},{x:.1375,y:.35,w:.03125,h:.041666666666666664},{x:.1375,y:.35,w:.05,h:.06666666666666667},{x:.1375,y:.35,w:.075,h:.1},{x:.1625,y:.35,w:.03125,h:.041666666666666664},{x:.1625,y:.35,w:.05,h:.06666666666666667},{x:.1625,y:.35,w:.075,h:.1},{x:.1875,y:.35,w:.03125,h:.041666666666666664},{x:.1875,y:.35,w:.05,h:.06666666666666667},{x:.1875,y:.35,w:.075,h:.1},{x:.2125,y:.35,w:.03125,h:.041666666666666664},{x:.2125,y:.35,w:.05,h:.06666666666666667},{x:.2125,y:.35,w:.075,h:.1},{x:.2375,y:.35,w:.03125,h:.041666666666666664},{x:.2375,y:.35,w:.05,h:.06666666666666667},{x:.2375,y:.35,w:.075,h:.1},{x:.2625,y:.35,w:.03125,h:.041666666666666664},{x:.2625,y:.35,w:.05,h:.06666666666666667},{x:.2625,y:.35,w:.075,h:.1},{x:.2875,y:.35,w:.03125,h:.041666666666666664},{x:.2875,y:.35,w:.05,h:.06666666666666667},{x:.2875,y:.35,w:.075,h:.1},{x:.3125,y:.35,w:.03125,h:.041666666666666664},{x:.3125,y:.35,w:.05,h:.06666666666666667},{x:.3125,y:.35,w:.075,h:.1},{x:.3375,y:.35,w:.03125,h:.041666666666666664},{x:.3375,y:.35,w:.05,h:.06666666666666667},{x:.3375,y:.35,w:.075,h:.1},{x:.3625,y:.35,w:.03125,h:.041666666666666664},{x:.3625,y:.35,w:.05,h:.06666666666666667},{x:.3625,y:.35,w:.075,h:.1},{x:.3875,y:.35,w:.03125,h:.041666666666666664},{x:.3875,y:.35,w:.05,h:.06666666666666667},{x:.3875,y:.35,w:.075,h:.1},{x:.4125,y:.35,w:.03125,h:.041666666666666664},{x:.4125,y:.35,w:.05,h:.06666666666666667},{x:.4125,y:.35,w:.075,h:.1},{x:.4375,y:.35,w:.03125,h:.041666666666666664},{x:.4375,y:.35,w:.05,h:.06666666666666667},{x:.4375,y:.35,w:.075,h:.1},{x:.4625,y:.35,w:.03125,h:.041666666666666664},{x:.4625,y:.35,w:.05,h:.06666666666666667},{x:.4625,y:.35,w:.075,h:.1},{x:.4875,y:.35,w:.03125,h:.041666666666666664},{x:.4875,y:.35,w:.05,h:.06666666666666667},{x:.4875,y:.35,w:.075,h:.1},{x:.5125,y:.35,w:.03125,h:.041666666666666664},{x:.5125,y:.35,w:.05,h:.06666666666666667},{x:.5125,y:.35,w:.075,h:.1},{x:.5375,y:.35,w:.03125,h:.041666666666666664},{x:.5375,y:.35,w:.05,h:.06666666666666667},{x:.5375,y:.35,w:.075,h:.1},{x:.5625,y:.35,w:.03125,h:.041666666666666664},{x:.5625,y:.35,w:.05,h:.06666666666666667},{x:.5625,y:.35,w:.075,h:.1},{x:.5875,y:.35,w:.03125,h:.041666666666666664},{x:.5875,y:.35,w:.05,h:.06666666666666667},{x:.5875,y:.35,w:.075,h:.1},{x:.6125,y:.35,w:.03125,h:.041666666666666664},{x:.6125,y:.35,w:.05,h:.06666666666666667},{x:.6125,y:.35,w:.075,h:.1},{x:.6375,y:.35,w:.03125,h:.041666666666666664},{x:.6375,y:.35,w:.05,h:.06666666666666667},{x:.6375,y:.35,w:.075,h:.1},{x:.6625,y:.35,w:.03125,h:.041666666666666664},{x:.6625,y:.35,w:.05,h:.06666666666666667},{x:.6625,y:.35,w:.075,h:.1},{x:.6875,y:.35,w:.03125,h:.041666666666666664},{x:.6875,y:.35,w:.05,h:.06666666666666667},{x:.6875,y:.35,w:.075,h:.1},{x:.7125,y:.35,w:.03125,h:.041666666666666664},{x:.7125,y:.35,w:.05,h:.06666666666666667},{x:.7125,y:.35,w:.075,h:.1},{x:.7375,y:.35,w:.03125,h:.041666666666666664},{x:.7375,y:.35,w:.05,h:.06666666666666667},{x:.7375,y:.35,w:.075,h:.1},{x:.7625,y:.35,w:.03125,h:.041666666666666664},{x:.7625,y:.35,w:.05,h:.06666666666666667},{x:.7625,y:.35,w:.075,h:.1},{x:.7875,y:.35,w:.03125,h:.041666666666666664},{x:.7875,y:.35,w:.05,h:.06666666666666667},{x:.7875,y:.35,w:.075,h:.1},{x:.8125,y:.35,w:.03125,h:.041666666666666664},{x:.8125,y:.35,w:.05,h:.06666666666666667},{x:.8125,y:.35,w:.075,h:.1},{x:.8375,y:.35,w:.03125,h:.041666666666666664},{x:.8375,y:.35,w:.05,h:.06666666666666667},{x:.8375,y:.35,w:.075,h:.1},{x:.8625,y:.35,w:.03125,h:.041666666666666664},{x:.8625,y:.35,w:.05,h:.06666666666666667},{x:.8625,y:.35,w:.075,h:.1},{x:.8875,y:.35,w:.03125,h:.041666666666666664},{x:.8875,y:.35,w:.05,h:.06666666666666667},{x:.8875,y:.35,w:.075,h:.1},{x:.9125,y:.35,w:.03125,h:.041666666666666664},{x:.9125,y:.35,w:.05,h:.06666666666666667},{x:.9125,y:.35,w:.075,h:.1},{x:.9375,y:.35,w:.03125,h:.041666666666666664},{x:.9375,y:.35,w:.05,h:.06666666666666667},{x:.9375,y:.35,w:.075,h:.1},{x:.9625,y:.35,w:.03125,h:.041666666666666664},{x:.9625,y:.35,w:.05,h:.06666666666666667},{x:.9625,y:.35,w:.075,h:.1},{x:.9875,y:.35,w:.03125,h:.041666666666666664},{x:.9875,y:.35,w:.05,h:.06666666666666667},{x:.9875,y:.35,w:.075,h:.1},{x:.0125,y:.38333333333333336,w:.03125,h:.041666666666666664},{x:.0125,y:.38333333333333336,w:.05,h:.06666666666666667},{x:.0125,y:.38333333333333336,w:.075,h:.1},{x:.0375,y:.38333333333333336,w:.03125,h:.041666666666666664},{x:.0375,y:.38333333333333336,w:.05,h:.06666666666666667},{x:.0375,y:.38333333333333336,w:.075,h:.1},{x:.0625,y:.38333333333333336,w:.03125,h:.041666666666666664},{x:.0625,y:.38333333333333336,w:.05,h:.06666666666666667},{x:.0625,y:.38333333333333336,w:.075,h:.1},{x:.0875,y:.38333333333333336,w:.03125,h:.041666666666666664},{x:.0875,y:.38333333333333336,w:.05,h:.06666666666666667},{x:.0875,y:.38333333333333336,w:.075,h:.1},{x:.1125,y:.38333333333333336,w:.03125,h:.041666666666666664},{x:.1125,y:.38333333333333336,w:.05,h:.06666666666666667},{x:.1125,y:.38333333333333336,w:.075,h:.1},{x:.1375,y:.38333333333333336,w:.03125,h:.041666666666666664},{x:.1375,y:.38333333333333336,w:.05,h:.06666666666666667},{x:.1375,y:.38333333333333336,w:.075,h:.1},{x:.1625,y:.38333333333333336,w:.03125,h:.041666666666666664},{x:.1625,y:.38333333333333336,w:.05,h:.06666666666666667},{x:.1625,y:.38333333333333336,w:.075,h:.1},{x:.1875,y:.38333333333333336,w:.03125,h:.041666666666666664},{x:.1875,y:.38333333333333336,w:.05,h:.06666666666666667},{x:.1875,y:.38333333333333336,w:.075,h:.1},{x:.2125,y:.38333333333333336,w:.03125,h:.041666666666666664},{x:.2125,y:.38333333333333336,w:.05,h:.06666666666666667},{x:.2125,y:.38333333333333336,w:.075,h:.1},{x:.2375,y:.38333333333333336,w:.03125,h:.041666666666666664},{x:.2375,y:.38333333333333336,w:.05,h:.06666666666666667},{x:.2375,y:.38333333333333336,w:.075,h:.1},{x:.2625,y:.38333333333333336,w:.03125,h:.041666666666666664},{x:.2625,y:.38333333333333336,w:.05,h:.06666666666666667},{x:.2625,y:.38333333333333336,w:.075,h:.1},{x:.2875,y:.38333333333333336,w:.03125,h:.041666666666666664},{x:.2875,y:.38333333333333336,w:.05,h:.06666666666666667},{x:.2875,y:.38333333333333336,w:.075,h:.1},{x:.3125,y:.38333333333333336,w:.03125,h:.041666666666666664},{x:.3125,y:.38333333333333336,w:.05,h:.06666666666666667},{x:.3125,y:.38333333333333336,w:.075,h:.1},{x:.3375,y:.38333333333333336,w:.03125,h:.041666666666666664},{x:.3375,y:.38333333333333336,w:.05,h:.06666666666666667},{x:.3375,y:.38333333333333336,w:.075,h:.1},{x:.3625,y:.38333333333333336,w:.03125,h:.041666666666666664},{x:.3625,y:.38333333333333336,w:.05,h:.06666666666666667},{x:.3625,y:.38333333333333336,w:.075,h:.1},{x:.3875,y:.38333333333333336,w:.03125,h:.041666666666666664},{x:.3875,y:.38333333333333336,w:.05,h:.06666666666666667},{x:.3875,y:.38333333333333336,w:.075,h:.1},{x:.4125,y:.38333333333333336,w:.03125,h:.041666666666666664},{x:.4125,y:.38333333333333336,w:.05,h:.06666666666666667},{x:.4125,y:.38333333333333336,w:.075,h:.1},{x:.4375,y:.38333333333333336,w:.03125,h:.041666666666666664},{x:.4375,y:.38333333333333336,w:.05,h:.06666666666666667},{x:.4375,y:.38333333333333336,w:.075,h:.1},{x:.4625,y:.38333333333333336,w:.03125,h:.041666666666666664},{x:.4625,y:.38333333333333336,w:.05,h:.06666666666666667},{x:.4625,y:.38333333333333336,w:.075,h:.1},{x:.4875,y:.38333333333333336,w:.03125,h:.041666666666666664},{x:.4875,y:.38333333333333336,w:.05,h:.06666666666666667},{x:.4875,y:.38333333333333336,w:.075,h:.1},{x:.5125,y:.38333333333333336,w:.03125,h:.041666666666666664},{x:.5125,y:.38333333333333336,w:.05,h:.06666666666666667},{x:.5125,y:.38333333333333336,w:.075,h:.1},{x:.5375,y:.38333333333333336,w:.03125,h:.041666666666666664},{x:.5375,y:.38333333333333336,w:.05,h:.06666666666666667},{x:.5375,y:.38333333333333336,w:.075,h:.1},{x:.5625,y:.38333333333333336,w:.03125,h:.041666666666666664},{x:.5625,y:.38333333333333336,w:.05,h:.06666666666666667},{x:.5625,y:.38333333333333336,w:.075,h:.1},{x:.5875,y:.38333333333333336,w:.03125,h:.041666666666666664},{x:.5875,y:.38333333333333336,w:.05,h:.06666666666666667},{x:.5875,y:.38333333333333336,w:.075,h:.1},{x:.6125,y:.38333333333333336,w:.03125,h:.041666666666666664},{x:.6125,y:.38333333333333336,w:.05,h:.06666666666666667},{x:.6125,y:.38333333333333336,w:.075,h:.1},{x:.6375,y:.38333333333333336,w:.03125,h:.041666666666666664},{x:.6375,y:.38333333333333336,w:.05,h:.06666666666666667},{x:.6375,y:.38333333333333336,w:.075,h:.1},{x:.6625,y:.38333333333333336,w:.03125,h:.041666666666666664},{x:.6625,y:.38333333333333336,w:.05,h:.06666666666666667},{x:.6625,y:.38333333333333336,w:.075,h:.1},{x:.6875,y:.38333333333333336,w:.03125,h:.041666666666666664},{x:.6875,y:.38333333333333336,w:.05,h:.06666666666666667},{x:.6875,y:.38333333333333336,w:.075,h:.1},{x:.7125,y:.38333333333333336,w:.03125,h:.041666666666666664},{x:.7125,y:.38333333333333336,w:.05,h:.06666666666666667},{x:.7125,y:.38333333333333336,w:.075,h:.1},{x:.7375,y:.38333333333333336,w:.03125,h:.041666666666666664},{x:.7375,y:.38333333333333336,w:.05,h:.06666666666666667},{x:.7375,y:.38333333333333336,w:.075,h:.1},{x:.7625,y:.38333333333333336,w:.03125,h:.041666666666666664},{x:.7625,y:.38333333333333336,w:.05,h:.06666666666666667},{x:.7625,y:.38333333333333336,w:.075,h:.1},{x:.7875,y:.38333333333333336,w:.03125,h:.041666666666666664},{x:.7875,y:.38333333333333336,w:.05,h:.06666666666666667},{x:.7875,y:.38333333333333336,w:.075,h:.1},{x:.8125,y:.38333333333333336,w:.03125,h:.041666666666666664},{x:.8125,y:.38333333333333336,w:.05,h:.06666666666666667},{x:.8125,y:.38333333333333336,w:.075,h:.1},{x:.8375,y:.38333333333333336,w:.03125,h:.041666666666666664},{x:.8375,y:.38333333333333336,w:.05,h:.06666666666666667},{x:.8375,y:.38333333333333336,w:.075,h:.1},{x:.8625,y:.38333333333333336,w:.03125,h:.041666666666666664},{x:.8625,y:.38333333333333336,w:.05,h:.06666666666666667},{x:.8625,y:.38333333333333336,w:.075,h:.1},{x:.8875,y:.38333333333333336,w:.03125,h:.041666666666666664},{x:.8875,y:.38333333333333336,w:.05,h:.06666666666666667},{x:.8875,y:.38333333333333336,w:.075,h:.1},{x:.9125,y:.38333333333333336,w:.03125,h:.041666666666666664},{x:.9125,y:.38333333333333336,w:.05,h:.06666666666666667},{x:.9125,y:.38333333333333336,w:.075,h:.1},{x:.9375,y:.38333333333333336,w:.03125,h:.041666666666666664},{x:.9375,y:.38333333333333336,w:.05,h:.06666666666666667},{x:.9375,y:.38333333333333336,w:.075,h:.1},{x:.9625,y:.38333333333333336,w:.03125,h:.041666666666666664},{x:.9625,y:.38333333333333336,w:.05,h:.06666666666666667},{x:.9625,y:.38333333333333336,w:.075,h:.1},{x:.9875,y:.38333333333333336,w:.03125,h:.041666666666666664},{x:.9875,y:.38333333333333336,w:.05,h:.06666666666666667},{x:.9875,y:.38333333333333336,w:.075,h:.1},{x:.0125,y:.4166666666666667,w:.03125,h:.041666666666666664},{x:.0125,y:.4166666666666667,w:.05,h:.06666666666666667},{x:.0125,y:.4166666666666667,w:.075,h:.1},{x:.0375,y:.4166666666666667,w:.03125,h:.041666666666666664},{x:.0375,y:.4166666666666667,w:.05,h:.06666666666666667},{x:.0375,y:.4166666666666667,w:.075,h:.1},{x:.0625,y:.4166666666666667,w:.03125,h:.041666666666666664},{x:.0625,y:.4166666666666667,w:.05,h:.06666666666666667},{x:.0625,y:.4166666666666667,w:.075,h:.1},{x:.0875,y:.4166666666666667,w:.03125,h:.041666666666666664},{x:.0875,y:.4166666666666667,w:.05,h:.06666666666666667},{x:.0875,y:.4166666666666667,w:.075,h:.1},{x:.1125,y:.4166666666666667,w:.03125,h:.041666666666666664},{x:.1125,y:.4166666666666667,w:.05,h:.06666666666666667},{x:.1125,y:.4166666666666667,w:.075,h:.1},{x:.1375,y:.4166666666666667,w:.03125,h:.041666666666666664},{x:.1375,y:.4166666666666667,w:.05,h:.06666666666666667},{x:.1375,y:.4166666666666667,w:.075,h:.1},{x:.1625,y:.4166666666666667,w:.03125,h:.041666666666666664},{x:.1625,y:.4166666666666667,w:.05,h:.06666666666666667},{x:.1625,y:.4166666666666667,w:.075,h:.1},{x:.1875,y:.4166666666666667,w:.03125,h:.041666666666666664},{x:.1875,y:.4166666666666667,w:.05,h:.06666666666666667},{x:.1875,y:.4166666666666667,w:.075,h:.1},{x:.2125,y:.4166666666666667,w:.03125,h:.041666666666666664},{x:.2125,y:.4166666666666667,w:.05,h:.06666666666666667},{x:.2125,y:.4166666666666667,w:.075,h:.1},{x:.2375,y:.4166666666666667,w:.03125,h:.041666666666666664},{x:.2375,y:.4166666666666667,w:.05,h:.06666666666666667},{x:.2375,y:.4166666666666667,w:.075,h:.1},{x:.2625,y:.4166666666666667,w:.03125,h:.041666666666666664},{x:.2625,y:.4166666666666667,w:.05,h:.06666666666666667},{x:.2625,y:.4166666666666667,w:.075,h:.1},{x:.2875,y:.4166666666666667,w:.03125,h:.041666666666666664},{x:.2875,y:.4166666666666667,w:.05,h:.06666666666666667},{x:.2875,y:.4166666666666667,w:.075,h:.1},{x:.3125,y:.4166666666666667,w:.03125,h:.041666666666666664},{x:.3125,y:.4166666666666667,w:.05,h:.06666666666666667},{x:.3125,y:.4166666666666667,w:.075,h:.1},{x:.3375,y:.4166666666666667,w:.03125,h:.041666666666666664},{x:.3375,y:.4166666666666667,w:.05,h:.06666666666666667},{x:.3375,y:.4166666666666667,w:.075,h:.1},{x:.3625,y:.4166666666666667,w:.03125,h:.041666666666666664},{x:.3625,y:.4166666666666667,w:.05,h:.06666666666666667},{x:.3625,y:.4166666666666667,w:.075,h:.1},{x:.3875,y:.4166666666666667,w:.03125,h:.041666666666666664},{x:.3875,y:.4166666666666667,w:.05,h:.06666666666666667},{x:.3875,y:.4166666666666667,w:.075,h:.1},{x:.4125,y:.4166666666666667,w:.03125,h:.041666666666666664},{x:.4125,y:.4166666666666667,w:.05,h:.06666666666666667},{x:.4125,y:.4166666666666667,w:.075,h:.1},{x:.4375,y:.4166666666666667,w:.03125,h:.041666666666666664},{x:.4375,y:.4166666666666667,w:.05,h:.06666666666666667},{x:.4375,y:.4166666666666667,w:.075,h:.1},{x:.4625,y:.4166666666666667,w:.03125,h:.041666666666666664},{x:.4625,y:.4166666666666667,w:.05,h:.06666666666666667},{x:.4625,y:.4166666666666667,w:.075,h:.1},{x:.4875,y:.4166666666666667,w:.03125,h:.041666666666666664},{x:.4875,y:.4166666666666667,w:.05,h:.06666666666666667},{x:.4875,y:.4166666666666667,w:.075,h:.1},{x:.5125,y:.4166666666666667,w:.03125,h:.041666666666666664},{x:.5125,y:.4166666666666667,w:.05,h:.06666666666666667},{x:.5125,y:.4166666666666667,w:.075,h:.1},{x:.5375,y:.4166666666666667,w:.03125,h:.041666666666666664},{x:.5375,y:.4166666666666667,w:.05,h:.06666666666666667},{x:.5375,y:.4166666666666667,w:.075,h:.1},{x:.5625,y:.4166666666666667,w:.03125,h:.041666666666666664},{x:.5625,y:.4166666666666667,w:.05,h:.06666666666666667},{x:.5625,y:.4166666666666667,w:.075,h:.1},{x:.5875,y:.4166666666666667,w:.03125,h:.041666666666666664},{x:.5875,y:.4166666666666667,w:.05,h:.06666666666666667},{x:.5875,y:.4166666666666667,w:.075,h:.1},{x:.6125,y:.4166666666666667,w:.03125,h:.041666666666666664},{x:.6125,y:.4166666666666667,w:.05,h:.06666666666666667},{x:.6125,y:.4166666666666667,w:.075,h:.1},{x:.6375,y:.4166666666666667,w:.03125,h:.041666666666666664},{x:.6375,y:.4166666666666667,w:.05,h:.06666666666666667},{x:.6375,y:.4166666666666667,w:.075,h:.1},{x:.6625,y:.4166666666666667,w:.03125,h:.041666666666666664},{x:.6625,y:.4166666666666667,w:.05,h:.06666666666666667},{x:.6625,y:.4166666666666667,w:.075,h:.1},{x:.6875,y:.4166666666666667,w:.03125,h:.041666666666666664},{x:.6875,y:.4166666666666667,w:.05,h:.06666666666666667},{x:.6875,y:.4166666666666667,w:.075,h:.1},{x:.7125,y:.4166666666666667,w:.03125,h:.041666666666666664},{x:.7125,y:.4166666666666667,w:.05,h:.06666666666666667},{x:.7125,y:.4166666666666667,w:.075,h:.1},{x:.7375,y:.4166666666666667,w:.03125,h:.041666666666666664},{x:.7375,y:.4166666666666667,w:.05,h:.06666666666666667},{x:.7375,y:.4166666666666667,w:.075,h:.1},{x:.7625,y:.4166666666666667,w:.03125,h:.041666666666666664},{x:.7625,y:.4166666666666667,w:.05,h:.06666666666666667},{x:.7625,y:.4166666666666667,w:.075,h:.1},{x:.7875,y:.4166666666666667,w:.03125,h:.041666666666666664},{x:.7875,y:.4166666666666667,w:.05,h:.06666666666666667},{x:.7875,y:.4166666666666667,w:.075,h:.1},{x:.8125,y:.4166666666666667,w:.03125,h:.041666666666666664},{x:.8125,y:.4166666666666667,w:.05,h:.06666666666666667},{x:.8125,y:.4166666666666667,w:.075,h:.1},{x:.8375,y:.4166666666666667,w:.03125,h:.041666666666666664},{x:.8375,y:.4166666666666667,w:.05,h:.06666666666666667},{x:.8375,y:.4166666666666667,w:.075,h:.1},{x:.8625,y:.4166666666666667,w:.03125,h:.041666666666666664},{x:.8625,y:.4166666666666667,w:.05,h:.06666666666666667},{x:.8625,y:.4166666666666667,w:.075,h:.1},{x:.8875,y:.4166666666666667,w:.03125,h:.041666666666666664},{x:.8875,y:.4166666666666667,w:.05,h:.06666666666666667},{x:.8875,y:.4166666666666667,w:.075,h:.1},{x:.9125,y:.4166666666666667,w:.03125,h:.041666666666666664},{x:.9125,y:.4166666666666667,w:.05,h:.06666666666666667},{x:.9125,y:.4166666666666667,w:.075,h:.1},{x:.9375,y:.4166666666666667,w:.03125,h:.041666666666666664},{x:.9375,y:.4166666666666667,w:.05,h:.06666666666666667},{x:.9375,y:.4166666666666667,w:.075,h:.1},{x:.9625,y:.4166666666666667,w:.03125,h:.041666666666666664},{x:.9625,y:.4166666666666667,w:.05,h:.06666666666666667},{x:.9625,y:.4166666666666667,w:.075,h:.1},{x:.9875,y:.4166666666666667,w:.03125,h:.041666666666666664},{x:.9875,y:.4166666666666667,w:.05,h:.06666666666666667},{x:.9875,y:.4166666666666667,w:.075,h:.1},{x:.0125,y:.45,w:.03125,h:.041666666666666664},{x:.0125,y:.45,w:.05,h:.06666666666666667},{x:.0125,y:.45,w:.075,h:.1},{x:.0375,y:.45,w:.03125,h:.041666666666666664},{x:.0375,y:.45,w:.05,h:.06666666666666667},{x:.0375,y:.45,w:.075,h:.1},{x:.0625,y:.45,w:.03125,h:.041666666666666664},{x:.0625,y:.45,w:.05,h:.06666666666666667},{x:.0625,y:.45,w:.075,h:.1},{x:.0875,y:.45,w:.03125,h:.041666666666666664},{x:.0875,y:.45,w:.05,h:.06666666666666667},{x:.0875,y:.45,w:.075,h:.1},{x:.1125,y:.45,w:.03125,h:.041666666666666664},{x:.1125,y:.45,w:.05,h:.06666666666666667},{x:.1125,y:.45,w:.075,h:.1},{x:.1375,y:.45,w:.03125,h:.041666666666666664},{x:.1375,y:.45,w:.05,h:.06666666666666667},{x:.1375,y:.45,w:.075,h:.1},{x:.1625,y:.45,w:.03125,h:.041666666666666664},{x:.1625,y:.45,w:.05,h:.06666666666666667},{x:.1625,y:.45,w:.075,h:.1},{x:.1875,y:.45,w:.03125,h:.041666666666666664},{x:.1875,y:.45,w:.05,h:.06666666666666667},{x:.1875,y:.45,w:.075,h:.1},{x:.2125,y:.45,w:.03125,h:.041666666666666664},{x:.2125,y:.45,w:.05,h:.06666666666666667},{x:.2125,y:.45,w:.075,h:.1},{x:.2375,y:.45,w:.03125,h:.041666666666666664},{x:.2375,y:.45,w:.05,h:.06666666666666667},{x:.2375,y:.45,w:.075,h:.1},{x:.2625,y:.45,w:.03125,h:.041666666666666664},{x:.2625,y:.45,w:.05,h:.06666666666666667},{x:.2625,y:.45,w:.075,h:.1},{x:.2875,y:.45,w:.03125,h:.041666666666666664},{x:.2875,y:.45,w:.05,h:.06666666666666667},{x:.2875,y:.45,w:.075,h:.1},{x:.3125,y:.45,w:.03125,h:.041666666666666664},{x:.3125,y:.45,w:.05,h:.06666666666666667},{x:.3125,y:.45,w:.075,h:.1},{x:.3375,y:.45,w:.03125,h:.041666666666666664},{x:.3375,y:.45,w:.05,h:.06666666666666667},{x:.3375,y:.45,w:.075,h:.1},{x:.3625,y:.45,w:.03125,h:.041666666666666664},{x:.3625,y:.45,w:.05,h:.06666666666666667},{x:.3625,y:.45,w:.075,h:.1},{x:.3875,y:.45,w:.03125,h:.041666666666666664},{x:.3875,y:.45,w:.05,h:.06666666666666667},{x:.3875,y:.45,w:.075,h:.1},{x:.4125,y:.45,w:.03125,h:.041666666666666664},{x:.4125,y:.45,w:.05,h:.06666666666666667},{x:.4125,y:.45,w:.075,h:.1},{x:.4375,y:.45,w:.03125,h:.041666666666666664},{x:.4375,y:.45,w:.05,h:.06666666666666667},{x:.4375,y:.45,w:.075,h:.1},{x:.4625,y:.45,w:.03125,h:.041666666666666664},{x:.4625,y:.45,w:.05,h:.06666666666666667},{x:.4625,y:.45,w:.075,h:.1},{x:.4875,y:.45,w:.03125,h:.041666666666666664},{x:.4875,y:.45,w:.05,h:.06666666666666667},{x:.4875,y:.45,w:.075,h:.1},{x:.5125,y:.45,w:.03125,h:.041666666666666664},{x:.5125,y:.45,w:.05,h:.06666666666666667},{x:.5125,y:.45,w:.075,h:.1},{x:.5375,y:.45,w:.03125,h:.041666666666666664},{x:.5375,y:.45,w:.05,h:.06666666666666667},{x:.5375,y:.45,w:.075,h:.1},{x:.5625,y:.45,w:.03125,h:.041666666666666664},{x:.5625,y:.45,w:.05,h:.06666666666666667},{x:.5625,y:.45,w:.075,h:.1},{x:.5875,y:.45,w:.03125,h:.041666666666666664},{x:.5875,y:.45,w:.05,h:.06666666666666667},{x:.5875,y:.45,w:.075,h:.1},{x:.6125,y:.45,w:.03125,h:.041666666666666664},{x:.6125,y:.45,w:.05,h:.06666666666666667},{x:.6125,y:.45,w:.075,h:.1},{x:.6375,y:.45,w:.03125,h:.041666666666666664},{x:.6375,y:.45,w:.05,h:.06666666666666667},{x:.6375,y:.45,w:.075,h:.1},{x:.6625,y:.45,w:.03125,h:.041666666666666664},{x:.6625,y:.45,w:.05,h:.06666666666666667},{x:.6625,y:.45,w:.075,h:.1},{x:.6875,y:.45,w:.03125,h:.041666666666666664},{x:.6875,y:.45,w:.05,h:.06666666666666667},{x:.6875,y:.45,w:.075,h:.1},{x:.7125,y:.45,w:.03125,h:.041666666666666664},{x:.7125,y:.45,w:.05,h:.06666666666666667},{x:.7125,y:.45,w:.075,h:.1},{x:.7375,y:.45,w:.03125,h:.041666666666666664},{x:.7375,y:.45,w:.05,h:.06666666666666667},{x:.7375,y:.45,w:.075,h:.1},{x:.7625,y:.45,w:.03125,h:.041666666666666664},{x:.7625,y:.45,w:.05,h:.06666666666666667},{x:.7625,y:.45,w:.075,h:.1},{x:.7875,y:.45,w:.03125,h:.041666666666666664},{x:.7875,y:.45,w:.05,h:.06666666666666667},{x:.7875,y:.45,w:.075,h:.1},{x:.8125,y:.45,w:.03125,h:.041666666666666664},{x:.8125,y:.45,w:.05,h:.06666666666666667},{x:.8125,y:.45,w:.075,h:.1},{x:.8375,y:.45,w:.03125,h:.041666666666666664},{x:.8375,y:.45,w:.05,h:.06666666666666667},{x:.8375,y:.45,w:.075,h:.1},{x:.8625,y:.45,w:.03125,h:.041666666666666664},{x:.8625,y:.45,w:.05,h:.06666666666666667},{x:.8625,y:.45,w:.075,h:.1},{x:.8875,y:.45,w:.03125,h:.041666666666666664},{x:.8875,y:.45,w:.05,h:.06666666666666667},{x:.8875,y:.45,w:.075,h:.1},{x:.9125,y:.45,w:.03125,h:.041666666666666664},{x:.9125,y:.45,w:.05,h:.06666666666666667},{x:.9125,y:.45,w:.075,h:.1},{x:.9375,y:.45,w:.03125,h:.041666666666666664},{x:.9375,y:.45,w:.05,h:.06666666666666667},{x:.9375,y:.45,w:.075,h:.1},{x:.9625,y:.45,w:.03125,h:.041666666666666664},{x:.9625,y:.45,w:.05,h:.06666666666666667},{x:.9625,y:.45,w:.075,h:.1},{x:.9875,y:.45,w:.03125,h:.041666666666666664},{x:.9875,y:.45,w:.05,h:.06666666666666667},{x:.9875,y:.45,w:.075,h:.1},{x:.0125,y:.48333333333333334,w:.03125,h:.041666666666666664},{x:.0125,y:.48333333333333334,w:.05,h:.06666666666666667},{x:.0125,y:.48333333333333334,w:.075,h:.1},{x:.0375,y:.48333333333333334,w:.03125,h:.041666666666666664},{x:.0375,y:.48333333333333334,w:.05,h:.06666666666666667},{x:.0375,y:.48333333333333334,w:.075,h:.1},{x:.0625,y:.48333333333333334,w:.03125,h:.041666666666666664},{x:.0625,y:.48333333333333334,w:.05,h:.06666666666666667},{x:.0625,y:.48333333333333334,w:.075,h:.1},{x:.0875,y:.48333333333333334,w:.03125,h:.041666666666666664},{x:.0875,y:.48333333333333334,w:.05,h:.06666666666666667},{x:.0875,y:.48333333333333334,w:.075,h:.1},{x:.1125,y:.48333333333333334,w:.03125,h:.041666666666666664},{x:.1125,y:.48333333333333334,w:.05,h:.06666666666666667},{x:.1125,y:.48333333333333334,w:.075,h:.1},{x:.1375,y:.48333333333333334,w:.03125,h:.041666666666666664},{x:.1375,y:.48333333333333334,w:.05,h:.06666666666666667},{x:.1375,y:.48333333333333334,w:.075,h:.1},{x:.1625,y:.48333333333333334,w:.03125,h:.041666666666666664},{x:.1625,y:.48333333333333334,w:.05,h:.06666666666666667},{x:.1625,y:.48333333333333334,w:.075,h:.1},{x:.1875,y:.48333333333333334,w:.03125,h:.041666666666666664},{x:.1875,y:.48333333333333334,w:.05,h:.06666666666666667},{x:.1875,y:.48333333333333334,w:.075,h:.1},{x:.2125,y:.48333333333333334,w:.03125,h:.041666666666666664},{x:.2125,y:.48333333333333334,w:.05,h:.06666666666666667},{x:.2125,y:.48333333333333334,w:.075,h:.1},{x:.2375,y:.48333333333333334,w:.03125,h:.041666666666666664},{x:.2375,y:.48333333333333334,w:.05,h:.06666666666666667},{x:.2375,y:.48333333333333334,w:.075,h:.1},{x:.2625,y:.48333333333333334,w:.03125,h:.041666666666666664},{x:.2625,y:.48333333333333334,w:.05,h:.06666666666666667},{x:.2625,y:.48333333333333334,w:.075,h:.1},{x:.2875,y:.48333333333333334,w:.03125,h:.041666666666666664},{x:.2875,y:.48333333333333334,w:.05,h:.06666666666666667},{x:.2875,y:.48333333333333334,w:.075,h:.1},{x:.3125,y:.48333333333333334,w:.03125,h:.041666666666666664},{x:.3125,y:.48333333333333334,w:.05,h:.06666666666666667},{x:.3125,y:.48333333333333334,w:.075,h:.1},{x:.3375,y:.48333333333333334,w:.03125,h:.041666666666666664},{x:.3375,y:.48333333333333334,w:.05,h:.06666666666666667},{x:.3375,y:.48333333333333334,w:.075,h:.1},{x:.3625,y:.48333333333333334,w:.03125,h:.041666666666666664},{x:.3625,y:.48333333333333334,w:.05,h:.06666666666666667},{x:.3625,y:.48333333333333334,w:.075,h:.1},{x:.3875,y:.48333333333333334,w:.03125,h:.041666666666666664},{x:.3875,y:.48333333333333334,w:.05,h:.06666666666666667},{x:.3875,y:.48333333333333334,w:.075,h:.1},{x:.4125,y:.48333333333333334,w:.03125,h:.041666666666666664},{x:.4125,y:.48333333333333334,w:.05,h:.06666666666666667},{x:.4125,y:.48333333333333334,w:.075,h:.1},{x:.4375,y:.48333333333333334,w:.03125,h:.041666666666666664},{x:.4375,y:.48333333333333334,w:.05,h:.06666666666666667},{x:.4375,y:.48333333333333334,w:.075,h:.1},{x:.4625,y:.48333333333333334,w:.03125,h:.041666666666666664},{x:.4625,y:.48333333333333334,w:.05,h:.06666666666666667},{x:.4625,y:.48333333333333334,w:.075,h:.1},{x:.4875,y:.48333333333333334,w:.03125,h:.041666666666666664},{x:.4875,y:.48333333333333334,w:.05,h:.06666666666666667},{x:.4875,y:.48333333333333334,w:.075,h:.1},{x:.5125,y:.48333333333333334,w:.03125,h:.041666666666666664},{x:.5125,y:.48333333333333334,w:.05,h:.06666666666666667},{x:.5125,y:.48333333333333334,w:.075,h:.1},{x:.5375,y:.48333333333333334,w:.03125,h:.041666666666666664},{x:.5375,y:.48333333333333334,w:.05,h:.06666666666666667},{x:.5375,y:.48333333333333334,w:.075,h:.1},{x:.5625,y:.48333333333333334,w:.03125,h:.041666666666666664},{x:.5625,y:.48333333333333334,w:.05,h:.06666666666666667},{x:.5625,y:.48333333333333334,w:.075,h:.1},{x:.5875,y:.48333333333333334,w:.03125,h:.041666666666666664},{x:.5875,y:.48333333333333334,w:.05,h:.06666666666666667},{x:.5875,y:.48333333333333334,w:.075,h:.1},{x:.6125,y:.48333333333333334,w:.03125,h:.041666666666666664},{x:.6125,y:.48333333333333334,w:.05,h:.06666666666666667},{x:.6125,y:.48333333333333334,w:.075,h:.1},{x:.6375,y:.48333333333333334,w:.03125,h:.041666666666666664},{x:.6375,y:.48333333333333334,w:.05,h:.06666666666666667},{x:.6375,y:.48333333333333334,w:.075,h:.1},{x:.6625,y:.48333333333333334,w:.03125,h:.041666666666666664},{x:.6625,y:.48333333333333334,w:.05,h:.06666666666666667},{x:.6625,y:.48333333333333334,w:.075,h:.1},{x:.6875,y:.48333333333333334,w:.03125,h:.041666666666666664},{x:.6875,y:.48333333333333334,w:.05,h:.06666666666666667},{x:.6875,y:.48333333333333334,w:.075,h:.1},{x:.7125,y:.48333333333333334,w:.03125,h:.041666666666666664},{x:.7125,y:.48333333333333334,w:.05,h:.06666666666666667},{x:.7125,y:.48333333333333334,w:.075,h:.1},{x:.7375,y:.48333333333333334,w:.03125,h:.041666666666666664},{x:.7375,y:.48333333333333334,w:.05,h:.06666666666666667},{x:.7375,y:.48333333333333334,w:.075,h:.1},{x:.7625,y:.48333333333333334,w:.03125,h:.041666666666666664},{x:.7625,y:.48333333333333334,w:.05,h:.06666666666666667},{x:.7625,y:.48333333333333334,w:.075,h:.1},{x:.7875,y:.48333333333333334,w:.03125,h:.041666666666666664},{x:.7875,y:.48333333333333334,w:.05,h:.06666666666666667},{x:.7875,y:.48333333333333334,w:.075,h:.1},{x:.8125,y:.48333333333333334,w:.03125,h:.041666666666666664},{x:.8125,y:.48333333333333334,w:.05,h:.06666666666666667},{x:.8125,y:.48333333333333334,w:.075,h:.1},{x:.8375,y:.48333333333333334,w:.03125,h:.041666666666666664},{x:.8375,y:.48333333333333334,w:.05,h:.06666666666666667},{x:.8375,y:.48333333333333334,w:.075,h:.1},{x:.8625,y:.48333333333333334,w:.03125,h:.041666666666666664},{x:.8625,y:.48333333333333334,w:.05,h:.06666666666666667},{x:.8625,y:.48333333333333334,w:.075,h:.1},{x:.8875,y:.48333333333333334,w:.03125,h:.041666666666666664},{x:.8875,y:.48333333333333334,w:.05,h:.06666666666666667},{x:.8875,y:.48333333333333334,w:.075,h:.1},{x:.9125,y:.48333333333333334,w:.03125,h:.041666666666666664},{x:.9125,y:.48333333333333334,w:.05,h:.06666666666666667},{x:.9125,y:.48333333333333334,w:.075,h:.1},{x:.9375,y:.48333333333333334,w:.03125,h:.041666666666666664},{x:.9375,y:.48333333333333334,w:.05,h:.06666666666666667},{x:.9375,y:.48333333333333334,w:.075,h:.1},{x:.9625,y:.48333333333333334,w:.03125,h:.041666666666666664},{x:.9625,y:.48333333333333334,w:.05,h:.06666666666666667},{x:.9625,y:.48333333333333334,w:.075,h:.1},{x:.9875,y:.48333333333333334,w:.03125,h:.041666666666666664},{x:.9875,y:.48333333333333334,w:.05,h:.06666666666666667},{x:.9875,y:.48333333333333334,w:.075,h:.1},{x:.0125,y:.5166666666666667,w:.03125,h:.041666666666666664},{x:.0125,y:.5166666666666667,w:.05,h:.06666666666666667},{x:.0125,y:.5166666666666667,w:.075,h:.1},{x:.0375,y:.5166666666666667,w:.03125,h:.041666666666666664},{x:.0375,y:.5166666666666667,w:.05,h:.06666666666666667},{x:.0375,y:.5166666666666667,w:.075,h:.1},{x:.0625,y:.5166666666666667,w:.03125,h:.041666666666666664},{x:.0625,y:.5166666666666667,w:.05,h:.06666666666666667},{x:.0625,y:.5166666666666667,w:.075,h:.1},{x:.0875,y:.5166666666666667,w:.03125,h:.041666666666666664},{x:.0875,y:.5166666666666667,w:.05,h:.06666666666666667},{x:.0875,y:.5166666666666667,w:.075,h:.1},{x:.1125,y:.5166666666666667,w:.03125,h:.041666666666666664},{x:.1125,y:.5166666666666667,w:.05,h:.06666666666666667},{x:.1125,y:.5166666666666667,w:.075,h:.1},{x:.1375,y:.5166666666666667,w:.03125,h:.041666666666666664},{x:.1375,y:.5166666666666667,w:.05,h:.06666666666666667},{x:.1375,y:.5166666666666667,w:.075,h:.1},{x:.1625,y:.5166666666666667,w:.03125,h:.041666666666666664},{x:.1625,y:.5166666666666667,w:.05,h:.06666666666666667},{x:.1625,y:.5166666666666667,w:.075,h:.1},{x:.1875,y:.5166666666666667,w:.03125,h:.041666666666666664},{x:.1875,y:.5166666666666667,w:.05,h:.06666666666666667},{x:.1875,y:.5166666666666667,w:.075,h:.1},{x:.2125,y:.5166666666666667,w:.03125,h:.041666666666666664},{x:.2125,y:.5166666666666667,w:.05,h:.06666666666666667},{x:.2125,y:.5166666666666667,w:.075,h:.1},{x:.2375,y:.5166666666666667,w:.03125,h:.041666666666666664},{x:.2375,y:.5166666666666667,w:.05,h:.06666666666666667},{x:.2375,y:.5166666666666667,w:.075,h:.1},{x:.2625,y:.5166666666666667,w:.03125,h:.041666666666666664},{x:.2625,y:.5166666666666667,w:.05,h:.06666666666666667},{x:.2625,y:.5166666666666667,w:.075,h:.1},{x:.2875,y:.5166666666666667,w:.03125,h:.041666666666666664},{x:.2875,y:.5166666666666667,w:.05,h:.06666666666666667},{x:.2875,y:.5166666666666667,w:.075,h:.1},{x:.3125,y:.5166666666666667,w:.03125,h:.041666666666666664},{x:.3125,y:.5166666666666667,w:.05,h:.06666666666666667},{x:.3125,y:.5166666666666667,w:.075,h:.1},{x:.3375,y:.5166666666666667,w:.03125,h:.041666666666666664},{x:.3375,y:.5166666666666667,w:.05,h:.06666666666666667},{x:.3375,y:.5166666666666667,w:.075,h:.1},{x:.3625,y:.5166666666666667,w:.03125,h:.041666666666666664},{x:.3625,y:.5166666666666667,w:.05,h:.06666666666666667},{x:.3625,y:.5166666666666667,w:.075,h:.1},{x:.3875,y:.5166666666666667,w:.03125,h:.041666666666666664},{x:.3875,y:.5166666666666667,w:.05,h:.06666666666666667},{x:.3875,y:.5166666666666667,w:.075,h:.1},{x:.4125,y:.5166666666666667,w:.03125,h:.041666666666666664},{x:.4125,y:.5166666666666667,w:.05,h:.06666666666666667},{x:.4125,y:.5166666666666667,w:.075,h:.1},{x:.4375,y:.5166666666666667,w:.03125,h:.041666666666666664},{x:.4375,y:.5166666666666667,w:.05,h:.06666666666666667},{x:.4375,y:.5166666666666667,w:.075,h:.1},{x:.4625,y:.5166666666666667,w:.03125,h:.041666666666666664},{x:.4625,y:.5166666666666667,w:.05,h:.06666666666666667},{x:.4625,y:.5166666666666667,w:.075,h:.1},{x:.4875,y:.5166666666666667,w:.03125,h:.041666666666666664},{x:.4875,y:.5166666666666667,w:.05,h:.06666666666666667},{x:.4875,y:.5166666666666667,w:.075,h:.1},{x:.5125,y:.5166666666666667,w:.03125,h:.041666666666666664},{x:.5125,y:.5166666666666667,w:.05,h:.06666666666666667},{x:.5125,y:.5166666666666667,w:.075,h:.1},{x:.5375,y:.5166666666666667,w:.03125,h:.041666666666666664},{x:.5375,y:.5166666666666667,w:.05,h:.06666666666666667},{x:.5375,y:.5166666666666667,w:.075,h:.1},{x:.5625,y:.5166666666666667,w:.03125,h:.041666666666666664},{x:.5625,y:.5166666666666667,w:.05,h:.06666666666666667},{x:.5625,y:.5166666666666667,w:.075,h:.1},{x:.5875,y:.5166666666666667,w:.03125,h:.041666666666666664},{x:.5875,y:.5166666666666667,w:.05,h:.06666666666666667},{x:.5875,y:.5166666666666667,w:.075,h:.1},{x:.6125,y:.5166666666666667,w:.03125,h:.041666666666666664},{x:.6125,y:.5166666666666667,w:.05,h:.06666666666666667},{x:.6125,y:.5166666666666667,w:.075,h:.1},{x:.6375,y:.5166666666666667,w:.03125,h:.041666666666666664},{x:.6375,y:.5166666666666667,w:.05,h:.06666666666666667},{x:.6375,y:.5166666666666667,w:.075,h:.1},{x:.6625,y:.5166666666666667,w:.03125,h:.041666666666666664},{x:.6625,y:.5166666666666667,w:.05,h:.06666666666666667},{x:.6625,y:.5166666666666667,w:.075,h:.1},{x:.6875,y:.5166666666666667,w:.03125,h:.041666666666666664},{x:.6875,y:.5166666666666667,w:.05,h:.06666666666666667},{x:.6875,y:.5166666666666667,w:.075,h:.1},{x:.7125,y:.5166666666666667,w:.03125,h:.041666666666666664},{x:.7125,y:.5166666666666667,w:.05,h:.06666666666666667},{x:.7125,y:.5166666666666667,w:.075,h:.1},{x:.7375,y:.5166666666666667,w:.03125,h:.041666666666666664},{x:.7375,y:.5166666666666667,w:.05,h:.06666666666666667},{x:.7375,y:.5166666666666667,w:.075,h:.1},{x:.7625,y:.5166666666666667,w:.03125,h:.041666666666666664},{x:.7625,y:.5166666666666667,w:.05,h:.06666666666666667},{x:.7625,y:.5166666666666667,w:.075,h:.1},{x:.7875,y:.5166666666666667,w:.03125,h:.041666666666666664},{x:.7875,y:.5166666666666667,w:.05,h:.06666666666666667},{x:.7875,y:.5166666666666667,w:.075,h:.1},{x:.8125,y:.5166666666666667,w:.03125,h:.041666666666666664},{x:.8125,y:.5166666666666667,w:.05,h:.06666666666666667},{x:.8125,y:.5166666666666667,w:.075,h:.1},{x:.8375,y:.5166666666666667,w:.03125,h:.041666666666666664},{x:.8375,y:.5166666666666667,w:.05,h:.06666666666666667},{x:.8375,y:.5166666666666667,w:.075,h:.1},{x:.8625,y:.5166666666666667,w:.03125,h:.041666666666666664},{x:.8625,y:.5166666666666667,w:.05,h:.06666666666666667},{x:.8625,y:.5166666666666667,w:.075,h:.1},{x:.8875,y:.5166666666666667,w:.03125,h:.041666666666666664},{x:.8875,y:.5166666666666667,w:.05,h:.06666666666666667},{x:.8875,y:.5166666666666667,w:.075,h:.1},{x:.9125,y:.5166666666666667,w:.03125,h:.041666666666666664},{x:.9125,y:.5166666666666667,w:.05,h:.06666666666666667},{x:.9125,y:.5166666666666667,w:.075,h:.1},{x:.9375,y:.5166666666666667,w:.03125,h:.041666666666666664},{x:.9375,y:.5166666666666667,w:.05,h:.06666666666666667},{x:.9375,y:.5166666666666667,w:.075,h:.1},{x:.9625,y:.5166666666666667,w:.03125,h:.041666666666666664},{x:.9625,y:.5166666666666667,w:.05,h:.06666666666666667},{x:.9625,y:.5166666666666667,w:.075,h:.1},{x:.9875,y:.5166666666666667,w:.03125,h:.041666666666666664},{x:.9875,y:.5166666666666667,w:.05,h:.06666666666666667},{x:.9875,y:.5166666666666667,w:.075,h:.1},{x:.0125,y:.55,w:.03125,h:.041666666666666664},{x:.0125,y:.55,w:.05,h:.06666666666666667},{x:.0125,y:.55,w:.075,h:.1},{x:.0375,y:.55,w:.03125,h:.041666666666666664},{x:.0375,y:.55,w:.05,h:.06666666666666667},{x:.0375,y:.55,w:.075,h:.1},{x:.0625,y:.55,w:.03125,h:.041666666666666664},{x:.0625,y:.55,w:.05,h:.06666666666666667},{x:.0625,y:.55,w:.075,h:.1},{x:.0875,y:.55,w:.03125,h:.041666666666666664},{x:.0875,y:.55,w:.05,h:.06666666666666667},{x:.0875,y:.55,w:.075,h:.1},{x:.1125,y:.55,w:.03125,h:.041666666666666664},{x:.1125,y:.55,w:.05,h:.06666666666666667},{x:.1125,y:.55,w:.075,h:.1},{x:.1375,y:.55,w:.03125,h:.041666666666666664},{x:.1375,y:.55,w:.05,h:.06666666666666667},{x:.1375,y:.55,w:.075,h:.1},{x:.1625,y:.55,w:.03125,h:.041666666666666664},{x:.1625,y:.55,w:.05,h:.06666666666666667},{x:.1625,y:.55,w:.075,h:.1},{x:.1875,y:.55,w:.03125,h:.041666666666666664},{x:.1875,y:.55,w:.05,h:.06666666666666667},{x:.1875,y:.55,w:.075,h:.1},{x:.2125,y:.55,w:.03125,h:.041666666666666664},{x:.2125,y:.55,w:.05,h:.06666666666666667},{x:.2125,y:.55,w:.075,h:.1},{x:.2375,y:.55,w:.03125,h:.041666666666666664},{x:.2375,y:.55,w:.05,h:.06666666666666667},{x:.2375,y:.55,w:.075,h:.1},{x:.2625,y:.55,w:.03125,h:.041666666666666664},{x:.2625,y:.55,w:.05,h:.06666666666666667},{x:.2625,y:.55,w:.075,h:.1},{x:.2875,y:.55,w:.03125,h:.041666666666666664},{x:.2875,y:.55,w:.05,h:.06666666666666667},{x:.2875,y:.55,w:.075,h:.1},{x:.3125,y:.55,w:.03125,h:.041666666666666664},{x:.3125,y:.55,w:.05,h:.06666666666666667},{x:.3125,y:.55,w:.075,h:.1},{x:.3375,y:.55,w:.03125,h:.041666666666666664},{x:.3375,y:.55,w:.05,h:.06666666666666667},{x:.3375,y:.55,w:.075,h:.1},{x:.3625,y:.55,w:.03125,h:.041666666666666664},{x:.3625,y:.55,w:.05,h:.06666666666666667},{x:.3625,y:.55,w:.075,h:.1},{x:.3875,y:.55,w:.03125,h:.041666666666666664},{x:.3875,y:.55,w:.05,h:.06666666666666667},{x:.3875,y:.55,w:.075,h:.1},{x:.4125,y:.55,w:.03125,h:.041666666666666664},{x:.4125,y:.55,w:.05,h:.06666666666666667},{x:.4125,y:.55,w:.075,h:.1},{x:.4375,y:.55,w:.03125,h:.041666666666666664},{x:.4375,y:.55,w:.05,h:.06666666666666667},{x:.4375,y:.55,w:.075,h:.1},{x:.4625,y:.55,w:.03125,h:.041666666666666664},{x:.4625,y:.55,w:.05,h:.06666666666666667},{x:.4625,y:.55,w:.075,h:.1},{x:.4875,y:.55,w:.03125,h:.041666666666666664},{x:.4875,y:.55,w:.05,h:.06666666666666667},{x:.4875,y:.55,w:.075,h:.1},{x:.5125,y:.55,w:.03125,h:.041666666666666664},{x:.5125,y:.55,w:.05,h:.06666666666666667},{x:.5125,y:.55,w:.075,h:.1},{x:.5375,y:.55,w:.03125,h:.041666666666666664},{x:.5375,y:.55,w:.05,h:.06666666666666667},{x:.5375,y:.55,w:.075,h:.1},{x:.5625,y:.55,w:.03125,h:.041666666666666664},{x:.5625,y:.55,w:.05,h:.06666666666666667},{x:.5625,y:.55,w:.075,h:.1},{x:.5875,y:.55,w:.03125,h:.041666666666666664},{x:.5875,y:.55,w:.05,h:.06666666666666667},{x:.5875,y:.55,w:.075,h:.1},{x:.6125,y:.55,w:.03125,h:.041666666666666664},{x:.6125,y:.55,w:.05,h:.06666666666666667},{x:.6125,y:.55,w:.075,h:.1},{x:.6375,y:.55,w:.03125,h:.041666666666666664},{x:.6375,y:.55,w:.05,h:.06666666666666667},{x:.6375,y:.55,w:.075,h:.1},{x:.6625,y:.55,w:.03125,h:.041666666666666664},{x:.6625,y:.55,w:.05,h:.06666666666666667},{x:.6625,y:.55,w:.075,h:.1},{x:.6875,y:.55,w:.03125,h:.041666666666666664},{x:.6875,y:.55,w:.05,h:.06666666666666667},{x:.6875,y:.55,w:.075,h:.1},{x:.7125,y:.55,w:.03125,h:.041666666666666664},{x:.7125,y:.55,w:.05,h:.06666666666666667},{x:.7125,y:.55,w:.075,h:.1},{x:.7375,y:.55,w:.03125,h:.041666666666666664},{x:.7375,y:.55,w:.05,h:.06666666666666667},{x:.7375,y:.55,w:.075,h:.1},{x:.7625,y:.55,w:.03125,h:.041666666666666664},{x:.7625,y:.55,w:.05,h:.06666666666666667},{x:.7625,y:.55,w:.075,h:.1},{x:.7875,y:.55,w:.03125,h:.041666666666666664},{x:.7875,y:.55,w:.05,h:.06666666666666667},{x:.7875,y:.55,w:.075,h:.1},{x:.8125,y:.55,w:.03125,h:.041666666666666664},{x:.8125,y:.55,w:.05,h:.06666666666666667},{x:.8125,y:.55,w:.075,h:.1},{x:.8375,y:.55,w:.03125,h:.041666666666666664},{x:.8375,y:.55,w:.05,h:.06666666666666667},{x:.8375,y:.55,w:.075,h:.1},{x:.8625,y:.55,w:.03125,h:.041666666666666664},{x:.8625,y:.55,w:.05,h:.06666666666666667},{x:.8625,y:.55,w:.075,h:.1},{x:.8875,y:.55,w:.03125,h:.041666666666666664},{x:.8875,y:.55,w:.05,h:.06666666666666667},{x:.8875,y:.55,w:.075,h:.1},{x:.9125,y:.55,w:.03125,h:.041666666666666664},{x:.9125,y:.55,w:.05,h:.06666666666666667},{x:.9125,y:.55,w:.075,h:.1},{x:.9375,y:.55,w:.03125,h:.041666666666666664},{x:.9375,y:.55,w:.05,h:.06666666666666667},{x:.9375,y:.55,w:.075,h:.1},{x:.9625,y:.55,w:.03125,h:.041666666666666664},{x:.9625,y:.55,w:.05,h:.06666666666666667},{x:.9625,y:.55,w:.075,h:.1},{x:.9875,y:.55,w:.03125,h:.041666666666666664},{x:.9875,y:.55,w:.05,h:.06666666666666667},{x:.9875,y:.55,w:.075,h:.1},{x:.0125,y:.5833333333333334,w:.03125,h:.041666666666666664},{x:.0125,y:.5833333333333334,w:.05,h:.06666666666666667},{x:.0125,y:.5833333333333334,w:.075,h:.1},{x:.0375,y:.5833333333333334,w:.03125,h:.041666666666666664},{x:.0375,y:.5833333333333334,w:.05,h:.06666666666666667},{x:.0375,y:.5833333333333334,w:.075,h:.1},{x:.0625,y:.5833333333333334,w:.03125,h:.041666666666666664},{x:.0625,y:.5833333333333334,w:.05,h:.06666666666666667},{x:.0625,y:.5833333333333334,w:.075,h:.1},{x:.0875,y:.5833333333333334,w:.03125,h:.041666666666666664},{x:.0875,y:.5833333333333334,w:.05,h:.06666666666666667},{x:.0875,y:.5833333333333334,w:.075,h:.1},{x:.1125,y:.5833333333333334,w:.03125,h:.041666666666666664},{x:.1125,y:.5833333333333334,w:.05,h:.06666666666666667},{x:.1125,y:.5833333333333334,w:.075,h:.1},{x:.1375,y:.5833333333333334,w:.03125,h:.041666666666666664},{x:.1375,y:.5833333333333334,w:.05,h:.06666666666666667},{x:.1375,y:.5833333333333334,w:.075,h:.1},{x:.1625,y:.5833333333333334,w:.03125,h:.041666666666666664},{x:.1625,y:.5833333333333334,w:.05,h:.06666666666666667},{x:.1625,y:.5833333333333334,w:.075,h:.1},{x:.1875,y:.5833333333333334,w:.03125,h:.041666666666666664},{x:.1875,y:.5833333333333334,w:.05,h:.06666666666666667},{x:.1875,y:.5833333333333334,w:.075,h:.1},{x:.2125,y:.5833333333333334,w:.03125,h:.041666666666666664},{x:.2125,y:.5833333333333334,w:.05,h:.06666666666666667},{x:.2125,y:.5833333333333334,w:.075,h:.1},{x:.2375,y:.5833333333333334,w:.03125,h:.041666666666666664},{x:.2375,y:.5833333333333334,w:.05,h:.06666666666666667},{x:.2375,y:.5833333333333334,w:.075,h:.1},{x:.2625,y:.5833333333333334,w:.03125,h:.041666666666666664},{x:.2625,y:.5833333333333334,w:.05,h:.06666666666666667},{x:.2625,y:.5833333333333334,w:.075,h:.1},{x:.2875,y:.5833333333333334,w:.03125,h:.041666666666666664},{x:.2875,y:.5833333333333334,w:.05,h:.06666666666666667},{x:.2875,y:.5833333333333334,w:.075,h:.1},{x:.3125,y:.5833333333333334,w:.03125,h:.041666666666666664},{x:.3125,y:.5833333333333334,w:.05,h:.06666666666666667},{x:.3125,y:.5833333333333334,w:.075,h:.1},{x:.3375,y:.5833333333333334,w:.03125,h:.041666666666666664},{x:.3375,y:.5833333333333334,w:.05,h:.06666666666666667},{x:.3375,y:.5833333333333334,w:.075,h:.1},{x:.3625,y:.5833333333333334,w:.03125,h:.041666666666666664},{x:.3625,y:.5833333333333334,w:.05,h:.06666666666666667},{x:.3625,y:.5833333333333334,w:.075,h:.1},{x:.3875,y:.5833333333333334,w:.03125,h:.041666666666666664},{x:.3875,y:.5833333333333334,w:.05,h:.06666666666666667},{x:.3875,y:.5833333333333334,w:.075,h:.1},{x:.4125,y:.5833333333333334,w:.03125,h:.041666666666666664},{x:.4125,y:.5833333333333334,w:.05,h:.06666666666666667},{x:.4125,y:.5833333333333334,w:.075,h:.1},{x:.4375,y:.5833333333333334,w:.03125,h:.041666666666666664},{x:.4375,y:.5833333333333334,w:.05,h:.06666666666666667},{x:.4375,y:.5833333333333334,w:.075,h:.1},{x:.4625,y:.5833333333333334,w:.03125,h:.041666666666666664},{x:.4625,y:.5833333333333334,w:.05,h:.06666666666666667},{x:.4625,y:.5833333333333334,w:.075,h:.1},{x:.4875,y:.5833333333333334,w:.03125,h:.041666666666666664},{x:.4875,y:.5833333333333334,w:.05,h:.06666666666666667},{x:.4875,y:.5833333333333334,w:.075,h:.1},{x:.5125,y:.5833333333333334,w:.03125,h:.041666666666666664},{x:.5125,y:.5833333333333334,w:.05,h:.06666666666666667},{x:.5125,y:.5833333333333334,w:.075,h:.1},{x:.5375,y:.5833333333333334,w:.03125,h:.041666666666666664},{x:.5375,y:.5833333333333334,w:.05,h:.06666666666666667},{x:.5375,y:.5833333333333334,w:.075,h:.1},{x:.5625,y:.5833333333333334,w:.03125,h:.041666666666666664},{x:.5625,y:.5833333333333334,w:.05,h:.06666666666666667},{x:.5625,y:.5833333333333334,w:.075,h:.1},{x:.5875,y:.5833333333333334,w:.03125,h:.041666666666666664},{x:.5875,y:.5833333333333334,w:.05,h:.06666666666666667},{x:.5875,y:.5833333333333334,w:.075,h:.1},{x:.6125,y:.5833333333333334,w:.03125,h:.041666666666666664},{x:.6125,y:.5833333333333334,w:.05,h:.06666666666666667},{x:.6125,y:.5833333333333334,w:.075,h:.1},{x:.6375,y:.5833333333333334,w:.03125,h:.041666666666666664},{x:.6375,y:.5833333333333334,w:.05,h:.06666666666666667},{x:.6375,y:.5833333333333334,w:.075,h:.1},{x:.6625,y:.5833333333333334,w:.03125,h:.041666666666666664},{x:.6625,y:.5833333333333334,w:.05,h:.06666666666666667},{x:.6625,y:.5833333333333334,w:.075,h:.1},{x:.6875,y:.5833333333333334,w:.03125,h:.041666666666666664},{x:.6875,y:.5833333333333334,w:.05,h:.06666666666666667},{x:.6875,y:.5833333333333334,w:.075,h:.1},{x:.7125,y:.5833333333333334,w:.03125,h:.041666666666666664},{x:.7125,y:.5833333333333334,w:.05,h:.06666666666666667},{x:.7125,y:.5833333333333334,w:.075,h:.1},{x:.7375,y:.5833333333333334,w:.03125,h:.041666666666666664},{x:.7375,y:.5833333333333334,w:.05,h:.06666666666666667},{x:.7375,y:.5833333333333334,w:.075,h:.1},{x:.7625,y:.5833333333333334,w:.03125,h:.041666666666666664},{x:.7625,y:.5833333333333334,w:.05,h:.06666666666666667},{x:.7625,y:.5833333333333334,w:.075,h:.1},{x:.7875,y:.5833333333333334,w:.03125,h:.041666666666666664},{x:.7875,y:.5833333333333334,w:.05,h:.06666666666666667},{x:.7875,y:.5833333333333334,w:.075,h:.1},{x:.8125,y:.5833333333333334,w:.03125,h:.041666666666666664},{x:.8125,y:.5833333333333334,w:.05,h:.06666666666666667},{x:.8125,y:.5833333333333334,w:.075,h:.1},{x:.8375,y:.5833333333333334,w:.03125,h:.041666666666666664},{x:.8375,y:.5833333333333334,w:.05,h:.06666666666666667},{x:.8375,y:.5833333333333334,w:.075,h:.1},{x:.8625,y:.5833333333333334,w:.03125,h:.041666666666666664},{x:.8625,y:.5833333333333334,w:.05,h:.06666666666666667},{x:.8625,y:.5833333333333334,w:.075,h:.1},{x:.8875,y:.5833333333333334,w:.03125,h:.041666666666666664},{x:.8875,y:.5833333333333334,w:.05,h:.06666666666666667},{x:.8875,y:.5833333333333334,w:.075,h:.1},{x:.9125,y:.5833333333333334,w:.03125,h:.041666666666666664},{x:.9125,y:.5833333333333334,w:.05,h:.06666666666666667},{x:.9125,y:.5833333333333334,w:.075,h:.1},{x:.9375,y:.5833333333333334,w:.03125,h:.041666666666666664},{x:.9375,y:.5833333333333334,w:.05,h:.06666666666666667},{x:.9375,y:.5833333333333334,w:.075,h:.1},{x:.9625,y:.5833333333333334,w:.03125,h:.041666666666666664},{x:.9625,y:.5833333333333334,w:.05,h:.06666666666666667},{x:.9625,y:.5833333333333334,w:.075,h:.1},{x:.9875,y:.5833333333333334,w:.03125,h:.041666666666666664},{x:.9875,y:.5833333333333334,w:.05,h:.06666666666666667},{x:.9875,y:.5833333333333334,w:.075,h:.1},{x:.0125,y:.6166666666666667,w:.03125,h:.041666666666666664},{x:.0125,y:.6166666666666667,w:.05,h:.06666666666666667},{x:.0125,y:.6166666666666667,w:.075,h:.1},{x:.0375,y:.6166666666666667,w:.03125,h:.041666666666666664},{x:.0375,y:.6166666666666667,w:.05,h:.06666666666666667},{x:.0375,y:.6166666666666667,w:.075,h:.1},{x:.0625,y:.6166666666666667,w:.03125,h:.041666666666666664},{x:.0625,y:.6166666666666667,w:.05,h:.06666666666666667},{x:.0625,y:.6166666666666667,w:.075,h:.1},{x:.0875,y:.6166666666666667,w:.03125,h:.041666666666666664},{x:.0875,y:.6166666666666667,w:.05,h:.06666666666666667},{x:.0875,y:.6166666666666667,w:.075,h:.1},{x:.1125,y:.6166666666666667,w:.03125,h:.041666666666666664},{x:.1125,y:.6166666666666667,w:.05,h:.06666666666666667},{x:.1125,y:.6166666666666667,w:.075,h:.1},{x:.1375,y:.6166666666666667,w:.03125,h:.041666666666666664},{x:.1375,y:.6166666666666667,w:.05,h:.06666666666666667},{x:.1375,y:.6166666666666667,w:.075,h:.1},{x:.1625,y:.6166666666666667,w:.03125,h:.041666666666666664},{x:.1625,y:.6166666666666667,w:.05,h:.06666666666666667},{x:.1625,y:.6166666666666667,w:.075,h:.1},{x:.1875,y:.6166666666666667,w:.03125,h:.041666666666666664},{x:.1875,y:.6166666666666667,w:.05,h:.06666666666666667},{x:.1875,y:.6166666666666667,w:.075,h:.1},{x:.2125,y:.6166666666666667,w:.03125,h:.041666666666666664},{x:.2125,y:.6166666666666667,w:.05,h:.06666666666666667},{x:.2125,y:.6166666666666667,w:.075,h:.1},{x:.2375,y:.6166666666666667,w:.03125,h:.041666666666666664},{x:.2375,y:.6166666666666667,w:.05,h:.06666666666666667},{x:.2375,y:.6166666666666667,w:.075,h:.1},{x:.2625,y:.6166666666666667,w:.03125,h:.041666666666666664},{x:.2625,y:.6166666666666667,w:.05,h:.06666666666666667},{x:.2625,y:.6166666666666667,w:.075,h:.1},{x:.2875,y:.6166666666666667,w:.03125,h:.041666666666666664},{x:.2875,y:.6166666666666667,w:.05,h:.06666666666666667},{x:.2875,y:.6166666666666667,w:.075,h:.1},{x:.3125,y:.6166666666666667,w:.03125,h:.041666666666666664},{x:.3125,y:.6166666666666667,w:.05,h:.06666666666666667},{x:.3125,y:.6166666666666667,w:.075,h:.1},{x:.3375,y:.6166666666666667,w:.03125,h:.041666666666666664},{x:.3375,y:.6166666666666667,w:.05,h:.06666666666666667},{x:.3375,y:.6166666666666667,w:.075,h:.1},{x:.3625,y:.6166666666666667,w:.03125,h:.041666666666666664},{x:.3625,y:.6166666666666667,w:.05,h:.06666666666666667},{x:.3625,y:.6166666666666667,w:.075,h:.1},{x:.3875,y:.6166666666666667,w:.03125,h:.041666666666666664},{x:.3875,y:.6166666666666667,w:.05,h:.06666666666666667},{x:.3875,y:.6166666666666667,w:.075,h:.1},{x:.4125,y:.6166666666666667,w:.03125,h:.041666666666666664},{x:.4125,y:.6166666666666667,w:.05,h:.06666666666666667},{x:.4125,y:.6166666666666667,w:.075,h:.1},{x:.4375,y:.6166666666666667,w:.03125,h:.041666666666666664},{x:.4375,y:.6166666666666667,w:.05,h:.06666666666666667},{x:.4375,y:.6166666666666667,w:.075,h:.1},{x:.4625,y:.6166666666666667,w:.03125,h:.041666666666666664},{x:.4625,y:.6166666666666667,w:.05,h:.06666666666666667},{x:.4625,y:.6166666666666667,w:.075,h:.1},{x:.4875,y:.6166666666666667,w:.03125,h:.041666666666666664},{x:.4875,y:.6166666666666667,w:.05,h:.06666666666666667},{x:.4875,y:.6166666666666667,w:.075,h:.1},{x:.5125,y:.6166666666666667,w:.03125,h:.041666666666666664},{x:.5125,y:.6166666666666667,w:.05,h:.06666666666666667},{x:.5125,y:.6166666666666667,w:.075,h:.1},{x:.5375,y:.6166666666666667,w:.03125,h:.041666666666666664},{x:.5375,y:.6166666666666667,w:.05,h:.06666666666666667},{x:.5375,y:.6166666666666667,w:.075,h:.1},{x:.5625,y:.6166666666666667,w:.03125,h:.041666666666666664},{x:.5625,y:.6166666666666667,w:.05,h:.06666666666666667},{x:.5625,y:.6166666666666667,w:.075,h:.1},{x:.5875,y:.6166666666666667,w:.03125,h:.041666666666666664},{x:.5875,y:.6166666666666667,w:.05,h:.06666666666666667},{x:.5875,y:.6166666666666667,w:.075,h:.1},{x:.6125,y:.6166666666666667,w:.03125,h:.041666666666666664},{x:.6125,y:.6166666666666667,w:.05,h:.06666666666666667},{x:.6125,y:.6166666666666667,w:.075,h:.1},{x:.6375,y:.6166666666666667,w:.03125,h:.041666666666666664},{x:.6375,y:.6166666666666667,w:.05,h:.06666666666666667},{x:.6375,y:.6166666666666667,w:.075,h:.1},{x:.6625,y:.6166666666666667,w:.03125,h:.041666666666666664},{x:.6625,y:.6166666666666667,w:.05,h:.06666666666666667},{x:.6625,y:.6166666666666667,w:.075,h:.1},{x:.6875,y:.6166666666666667,w:.03125,h:.041666666666666664},{x:.6875,y:.6166666666666667,w:.05,h:.06666666666666667},{x:.6875,y:.6166666666666667,w:.075,h:.1},{x:.7125,y:.6166666666666667,w:.03125,h:.041666666666666664},{x:.7125,y:.6166666666666667,w:.05,h:.06666666666666667},{x:.7125,y:.6166666666666667,w:.075,h:.1},{x:.7375,y:.6166666666666667,w:.03125,h:.041666666666666664},{x:.7375,y:.6166666666666667,w:.05,h:.06666666666666667},{x:.7375,y:.6166666666666667,w:.075,h:.1},{x:.7625,y:.6166666666666667,w:.03125,h:.041666666666666664},{x:.7625,y:.6166666666666667,w:.05,h:.06666666666666667},{x:.7625,y:.6166666666666667,w:.075,h:.1},{x:.7875,y:.6166666666666667,w:.03125,h:.041666666666666664},{x:.7875,y:.6166666666666667,w:.05,h:.06666666666666667},{x:.7875,y:.6166666666666667,w:.075,h:.1},{x:.8125,y:.6166666666666667,w:.03125,h:.041666666666666664},{x:.8125,y:.6166666666666667,w:.05,h:.06666666666666667},{x:.8125,y:.6166666666666667,w:.075,h:.1},{x:.8375,y:.6166666666666667,w:.03125,h:.041666666666666664},{x:.8375,y:.6166666666666667,w:.05,h:.06666666666666667},{x:.8375,y:.6166666666666667,w:.075,h:.1},{x:.8625,y:.6166666666666667,w:.03125,h:.041666666666666664},{x:.8625,y:.6166666666666667,w:.05,h:.06666666666666667},{x:.8625,y:.6166666666666667,w:.075,h:.1},{x:.8875,y:.6166666666666667,w:.03125,h:.041666666666666664},{x:.8875,y:.6166666666666667,w:.05,h:.06666666666666667},{x:.8875,y:.6166666666666667,w:.075,h:.1},{x:.9125,y:.6166666666666667,w:.03125,h:.041666666666666664},{x:.9125,y:.6166666666666667,w:.05,h:.06666666666666667},{x:.9125,y:.6166666666666667,w:.075,h:.1},{x:.9375,y:.6166666666666667,w:.03125,h:.041666666666666664},{x:.9375,y:.6166666666666667,w:.05,h:.06666666666666667},{x:.9375,y:.6166666666666667,w:.075,h:.1},{x:.9625,y:.6166666666666667,w:.03125,h:.041666666666666664},{x:.9625,y:.6166666666666667,w:.05,h:.06666666666666667},{x:.9625,y:.6166666666666667,w:.075,h:.1},{x:.9875,y:.6166666666666667,w:.03125,h:.041666666666666664},{x:.9875,y:.6166666666666667,w:.05,h:.06666666666666667},{x:.9875,y:.6166666666666667,w:.075,h:.1},{x:.0125,y:.65,w:.03125,h:.041666666666666664},{x:.0125,y:.65,w:.05,h:.06666666666666667},{x:.0125,y:.65,w:.075,h:.1},{x:.0375,y:.65,w:.03125,h:.041666666666666664},{x:.0375,y:.65,w:.05,h:.06666666666666667},{x:.0375,y:.65,w:.075,h:.1},{x:.0625,y:.65,w:.03125,h:.041666666666666664},{x:.0625,y:.65,w:.05,h:.06666666666666667},{x:.0625,y:.65,w:.075,h:.1},{x:.0875,y:.65,w:.03125,h:.041666666666666664},{x:.0875,y:.65,w:.05,h:.06666666666666667},{x:.0875,y:.65,w:.075,h:.1},{x:.1125,y:.65,w:.03125,h:.041666666666666664},{x:.1125,y:.65,w:.05,h:.06666666666666667},{x:.1125,y:.65,w:.075,h:.1},{x:.1375,y:.65,w:.03125,h:.041666666666666664},{x:.1375,y:.65,w:.05,h:.06666666666666667},{x:.1375,y:.65,w:.075,h:.1},{x:.1625,y:.65,w:.03125,h:.041666666666666664},{x:.1625,y:.65,w:.05,h:.06666666666666667},{x:.1625,y:.65,w:.075,h:.1},{x:.1875,y:.65,w:.03125,h:.041666666666666664},{x:.1875,y:.65,w:.05,h:.06666666666666667},{x:.1875,y:.65,w:.075,h:.1},{x:.2125,y:.65,w:.03125,h:.041666666666666664},{x:.2125,y:.65,w:.05,h:.06666666666666667},{x:.2125,y:.65,w:.075,h:.1},{x:.2375,y:.65,w:.03125,h:.041666666666666664},{x:.2375,y:.65,w:.05,h:.06666666666666667},{x:.2375,y:.65,w:.075,h:.1},{x:.2625,y:.65,w:.03125,h:.041666666666666664},{x:.2625,y:.65,w:.05,h:.06666666666666667},{x:.2625,y:.65,w:.075,h:.1},{x:.2875,y:.65,w:.03125,h:.041666666666666664},{x:.2875,y:.65,w:.05,h:.06666666666666667},{x:.2875,y:.65,w:.075,h:.1},{x:.3125,y:.65,w:.03125,h:.041666666666666664},{x:.3125,y:.65,w:.05,h:.06666666666666667},{x:.3125,y:.65,w:.075,h:.1},{x:.3375,y:.65,w:.03125,h:.041666666666666664},{x:.3375,y:.65,w:.05,h:.06666666666666667},{x:.3375,y:.65,w:.075,h:.1},{x:.3625,y:.65,w:.03125,h:.041666666666666664},{x:.3625,y:.65,w:.05,h:.06666666666666667},{x:.3625,y:.65,w:.075,h:.1},{x:.3875,y:.65,w:.03125,h:.041666666666666664},{x:.3875,y:.65,w:.05,h:.06666666666666667},{x:.3875,y:.65,w:.075,h:.1},{x:.4125,y:.65,w:.03125,h:.041666666666666664},{x:.4125,y:.65,w:.05,h:.06666666666666667},{x:.4125,y:.65,w:.075,h:.1},{x:.4375,y:.65,w:.03125,h:.041666666666666664},{x:.4375,y:.65,w:.05,h:.06666666666666667},{x:.4375,y:.65,w:.075,h:.1},{x:.4625,y:.65,w:.03125,h:.041666666666666664},{x:.4625,y:.65,w:.05,h:.06666666666666667},{x:.4625,y:.65,w:.075,h:.1},{x:.4875,y:.65,w:.03125,h:.041666666666666664},{x:.4875,y:.65,w:.05,h:.06666666666666667},{x:.4875,y:.65,w:.075,h:.1},{x:.5125,y:.65,w:.03125,h:.041666666666666664},{x:.5125,y:.65,w:.05,h:.06666666666666667},{x:.5125,y:.65,w:.075,h:.1},{x:.5375,y:.65,w:.03125,h:.041666666666666664},{x:.5375,y:.65,w:.05,h:.06666666666666667},{x:.5375,y:.65,w:.075,h:.1},{x:.5625,y:.65,w:.03125,h:.041666666666666664},{x:.5625,y:.65,w:.05,h:.06666666666666667},{x:.5625,y:.65,w:.075,h:.1},{x:.5875,y:.65,w:.03125,h:.041666666666666664},{x:.5875,y:.65,w:.05,h:.06666666666666667},{x:.5875,y:.65,w:.075,h:.1},{x:.6125,y:.65,w:.03125,h:.041666666666666664},{x:.6125,y:.65,w:.05,h:.06666666666666667},{x:.6125,y:.65,w:.075,h:.1},{x:.6375,y:.65,w:.03125,h:.041666666666666664},{x:.6375,y:.65,w:.05,h:.06666666666666667},{x:.6375,y:.65,w:.075,h:.1},{x:.6625,y:.65,w:.03125,h:.041666666666666664},{x:.6625,y:.65,w:.05,h:.06666666666666667},{x:.6625,y:.65,w:.075,h:.1},{x:.6875,y:.65,w:.03125,h:.041666666666666664},{x:.6875,y:.65,w:.05,h:.06666666666666667},{x:.6875,y:.65,w:.075,h:.1},{x:.7125,y:.65,w:.03125,h:.041666666666666664},{x:.7125,y:.65,w:.05,h:.06666666666666667},{x:.7125,y:.65,w:.075,h:.1},{x:.7375,y:.65,w:.03125,h:.041666666666666664},{x:.7375,y:.65,w:.05,h:.06666666666666667},{x:.7375,y:.65,w:.075,h:.1},{x:.7625,y:.65,w:.03125,h:.041666666666666664},{x:.7625,y:.65,w:.05,h:.06666666666666667},{x:.7625,y:.65,w:.075,h:.1},{x:.7875,y:.65,w:.03125,h:.041666666666666664},{x:.7875,y:.65,w:.05,h:.06666666666666667},{x:.7875,y:.65,w:.075,h:.1},{x:.8125,y:.65,w:.03125,h:.041666666666666664},{x:.8125,y:.65,w:.05,h:.06666666666666667},{x:.8125,y:.65,w:.075,h:.1},{x:.8375,y:.65,w:.03125,h:.041666666666666664},{x:.8375,y:.65,w:.05,h:.06666666666666667},{x:.8375,y:.65,w:.075,h:.1},{x:.8625,y:.65,w:.03125,h:.041666666666666664},{x:.8625,y:.65,w:.05,h:.06666666666666667},{x:.8625,y:.65,w:.075,h:.1},{x:.8875,y:.65,w:.03125,h:.041666666666666664},{x:.8875,y:.65,w:.05,h:.06666666666666667},{x:.8875,y:.65,w:.075,h:.1},{x:.9125,y:.65,w:.03125,h:.041666666666666664},{x:.9125,y:.65,w:.05,h:.06666666666666667},{x:.9125,y:.65,w:.075,h:.1},{x:.9375,y:.65,w:.03125,h:.041666666666666664},{x:.9375,y:.65,w:.05,h:.06666666666666667},{x:.9375,y:.65,w:.075,h:.1},{x:.9625,y:.65,w:.03125,h:.041666666666666664},{x:.9625,y:.65,w:.05,h:.06666666666666667},{x:.9625,y:.65,w:.075,h:.1},{x:.9875,y:.65,w:.03125,h:.041666666666666664},{x:.9875,y:.65,w:.05,h:.06666666666666667},{x:.9875,y:.65,w:.075,h:.1},{x:.0125,y:.6833333333333333,w:.03125,h:.041666666666666664},{x:.0125,y:.6833333333333333,w:.05,h:.06666666666666667},{x:.0125,y:.6833333333333333,w:.075,h:.1},{x:.0375,y:.6833333333333333,w:.03125,h:.041666666666666664},{x:.0375,y:.6833333333333333,w:.05,h:.06666666666666667},{x:.0375,y:.6833333333333333,w:.075,h:.1},{x:.0625,y:.6833333333333333,w:.03125,h:.041666666666666664},{x:.0625,y:.6833333333333333,w:.05,h:.06666666666666667},{x:.0625,y:.6833333333333333,w:.075,h:.1},{x:.0875,y:.6833333333333333,w:.03125,h:.041666666666666664},{x:.0875,y:.6833333333333333,w:.05,h:.06666666666666667},{x:.0875,y:.6833333333333333,w:.075,h:.1},{x:.1125,y:.6833333333333333,w:.03125,h:.041666666666666664},{x:.1125,y:.6833333333333333,w:.05,h:.06666666666666667},{x:.1125,y:.6833333333333333,w:.075,h:.1},{x:.1375,y:.6833333333333333,w:.03125,h:.041666666666666664},{x:.1375,y:.6833333333333333,w:.05,h:.06666666666666667},{x:.1375,y:.6833333333333333,w:.075,h:.1},{x:.1625,y:.6833333333333333,w:.03125,h:.041666666666666664},{x:.1625,y:.6833333333333333,w:.05,h:.06666666666666667},{x:.1625,y:.6833333333333333,w:.075,h:.1},{x:.1875,y:.6833333333333333,w:.03125,h:.041666666666666664},{x:.1875,y:.6833333333333333,w:.05,h:.06666666666666667},{x:.1875,y:.6833333333333333,w:.075,h:.1},{x:.2125,y:.6833333333333333,w:.03125,h:.041666666666666664},{x:.2125,y:.6833333333333333,w:.05,h:.06666666666666667},{x:.2125,y:.6833333333333333,w:.075,h:.1},{x:.2375,y:.6833333333333333,w:.03125,h:.041666666666666664},{x:.2375,y:.6833333333333333,w:.05,h:.06666666666666667},{x:.2375,y:.6833333333333333,w:.075,h:.1},{x:.2625,y:.6833333333333333,w:.03125,h:.041666666666666664},{x:.2625,y:.6833333333333333,w:.05,h:.06666666666666667},{x:.2625,y:.6833333333333333,w:.075,h:.1},{x:.2875,y:.6833333333333333,w:.03125,h:.041666666666666664},{x:.2875,y:.6833333333333333,w:.05,h:.06666666666666667},{x:.2875,y:.6833333333333333,w:.075,h:.1},{x:.3125,y:.6833333333333333,w:.03125,h:.041666666666666664},{x:.3125,y:.6833333333333333,w:.05,h:.06666666666666667},{x:.3125,y:.6833333333333333,w:.075,h:.1},{x:.3375,y:.6833333333333333,w:.03125,h:.041666666666666664},{x:.3375,y:.6833333333333333,w:.05,h:.06666666666666667},{x:.3375,y:.6833333333333333,w:.075,h:.1},{x:.3625,y:.6833333333333333,w:.03125,h:.041666666666666664},{x:.3625,y:.6833333333333333,w:.05,h:.06666666666666667},{x:.3625,y:.6833333333333333,w:.075,h:.1},{x:.3875,y:.6833333333333333,w:.03125,h:.041666666666666664},{x:.3875,y:.6833333333333333,w:.05,h:.06666666666666667},{x:.3875,y:.6833333333333333,w:.075,h:.1},{x:.4125,y:.6833333333333333,w:.03125,h:.041666666666666664},{x:.4125,y:.6833333333333333,w:.05,h:.06666666666666667},{x:.4125,y:.6833333333333333,w:.075,h:.1},{x:.4375,y:.6833333333333333,w:.03125,h:.041666666666666664},{x:.4375,y:.6833333333333333,w:.05,h:.06666666666666667},{x:.4375,y:.6833333333333333,w:.075,h:.1},{x:.4625,y:.6833333333333333,w:.03125,h:.041666666666666664},{x:.4625,y:.6833333333333333,w:.05,h:.06666666666666667},{x:.4625,y:.6833333333333333,w:.075,h:.1},{x:.4875,y:.6833333333333333,w:.03125,h:.041666666666666664},{x:.4875,y:.6833333333333333,w:.05,h:.06666666666666667},{x:.4875,y:.6833333333333333,w:.075,h:.1},{x:.5125,y:.6833333333333333,w:.03125,h:.041666666666666664},{x:.5125,y:.6833333333333333,w:.05,h:.06666666666666667},{x:.5125,y:.6833333333333333,w:.075,h:.1},{x:.5375,y:.6833333333333333,w:.03125,h:.041666666666666664},{x:.5375,y:.6833333333333333,w:.05,h:.06666666666666667},{x:.5375,y:.6833333333333333,w:.075,h:.1},{x:.5625,y:.6833333333333333,w:.03125,h:.041666666666666664},{x:.5625,y:.6833333333333333,w:.05,h:.06666666666666667},{x:.5625,y:.6833333333333333,w:.075,h:.1},{x:.5875,y:.6833333333333333,w:.03125,h:.041666666666666664},{x:.5875,y:.6833333333333333,w:.05,h:.06666666666666667},{x:.5875,y:.6833333333333333,w:.075,h:.1},{x:.6125,y:.6833333333333333,w:.03125,h:.041666666666666664},{x:.6125,y:.6833333333333333,w:.05,h:.06666666666666667},{x:.6125,y:.6833333333333333,w:.075,h:.1},{x:.6375,y:.6833333333333333,w:.03125,h:.041666666666666664},{x:.6375,y:.6833333333333333,w:.05,h:.06666666666666667},{x:.6375,y:.6833333333333333,w:.075,h:.1},{x:.6625,y:.6833333333333333,w:.03125,h:.041666666666666664},{x:.6625,y:.6833333333333333,w:.05,h:.06666666666666667},{x:.6625,y:.6833333333333333,w:.075,h:.1},{x:.6875,y:.6833333333333333,w:.03125,h:.041666666666666664},{x:.6875,y:.6833333333333333,w:.05,h:.06666666666666667},{x:.6875,y:.6833333333333333,w:.075,h:.1},{x:.7125,y:.6833333333333333,w:.03125,h:.041666666666666664},{x:.7125,y:.6833333333333333,w:.05,h:.06666666666666667},{x:.7125,y:.6833333333333333,w:.075,h:.1},{x:.7375,y:.6833333333333333,w:.03125,h:.041666666666666664},{x:.7375,y:.6833333333333333,w:.05,h:.06666666666666667},{x:.7375,y:.6833333333333333,w:.075,h:.1},{x:.7625,y:.6833333333333333,w:.03125,h:.041666666666666664},{x:.7625,y:.6833333333333333,w:.05,h:.06666666666666667},{x:.7625,y:.6833333333333333,w:.075,h:.1},{x:.7875,y:.6833333333333333,w:.03125,h:.041666666666666664},{x:.7875,y:.6833333333333333,w:.05,h:.06666666666666667},{x:.7875,y:.6833333333333333,w:.075,h:.1},{x:.8125,y:.6833333333333333,w:.03125,h:.041666666666666664},{x:.8125,y:.6833333333333333,w:.05,h:.06666666666666667},{x:.8125,y:.6833333333333333,w:.075,h:.1},{x:.8375,y:.6833333333333333,w:.03125,h:.041666666666666664},{x:.8375,y:.6833333333333333,w:.05,h:.06666666666666667},{x:.8375,y:.6833333333333333,w:.075,h:.1},{x:.8625,y:.6833333333333333,w:.03125,h:.041666666666666664},{x:.8625,y:.6833333333333333,w:.05,h:.06666666666666667},{x:.8625,y:.6833333333333333,w:.075,h:.1},{x:.8875,y:.6833333333333333,w:.03125,h:.041666666666666664},{x:.8875,y:.6833333333333333,w:.05,h:.06666666666666667},{x:.8875,y:.6833333333333333,w:.075,h:.1},{x:.9125,y:.6833333333333333,w:.03125,h:.041666666666666664},{x:.9125,y:.6833333333333333,w:.05,h:.06666666666666667},{x:.9125,y:.6833333333333333,w:.075,h:.1},{x:.9375,y:.6833333333333333,w:.03125,h:.041666666666666664},{x:.9375,y:.6833333333333333,w:.05,h:.06666666666666667},{x:.9375,y:.6833333333333333,w:.075,h:.1},{x:.9625,y:.6833333333333333,w:.03125,h:.041666666666666664},{x:.9625,y:.6833333333333333,w:.05,h:.06666666666666667},{x:.9625,y:.6833333333333333,w:.075,h:.1},{x:.9875,y:.6833333333333333,w:.03125,h:.041666666666666664},{x:.9875,y:.6833333333333333,w:.05,h:.06666666666666667},{x:.9875,y:.6833333333333333,w:.075,h:.1},{x:.0125,y:.7166666666666667,w:.03125,h:.041666666666666664},{x:.0125,y:.7166666666666667,w:.05,h:.06666666666666667},{x:.0125,y:.7166666666666667,w:.075,h:.1},{x:.0375,y:.7166666666666667,w:.03125,h:.041666666666666664},{x:.0375,y:.7166666666666667,w:.05,h:.06666666666666667},{x:.0375,y:.7166666666666667,w:.075,h:.1},{x:.0625,y:.7166666666666667,w:.03125,h:.041666666666666664},{x:.0625,y:.7166666666666667,w:.05,h:.06666666666666667},{x:.0625,y:.7166666666666667,w:.075,h:.1},{x:.0875,y:.7166666666666667,w:.03125,h:.041666666666666664},{x:.0875,y:.7166666666666667,w:.05,h:.06666666666666667},{x:.0875,y:.7166666666666667,w:.075,h:.1},{x:.1125,y:.7166666666666667,w:.03125,h:.041666666666666664},{x:.1125,y:.7166666666666667,w:.05,h:.06666666666666667},{x:.1125,y:.7166666666666667,w:.075,h:.1},{x:.1375,y:.7166666666666667,w:.03125,h:.041666666666666664},{x:.1375,y:.7166666666666667,w:.05,h:.06666666666666667},{x:.1375,y:.7166666666666667,w:.075,h:.1},{x:.1625,y:.7166666666666667,w:.03125,h:.041666666666666664},{x:.1625,y:.7166666666666667,w:.05,h:.06666666666666667},{x:.1625,y:.7166666666666667,w:.075,h:.1},{x:.1875,y:.7166666666666667,w:.03125,h:.041666666666666664},{x:.1875,y:.7166666666666667,w:.05,h:.06666666666666667},{x:.1875,y:.7166666666666667,w:.075,h:.1},{x:.2125,y:.7166666666666667,w:.03125,h:.041666666666666664},{x:.2125,y:.7166666666666667,w:.05,h:.06666666666666667},{x:.2125,y:.7166666666666667,w:.075,h:.1},{x:.2375,y:.7166666666666667,w:.03125,h:.041666666666666664},{x:.2375,y:.7166666666666667,w:.05,h:.06666666666666667},{x:.2375,y:.7166666666666667,w:.075,h:.1},{x:.2625,y:.7166666666666667,w:.03125,h:.041666666666666664},{x:.2625,y:.7166666666666667,w:.05,h:.06666666666666667},{x:.2625,y:.7166666666666667,w:.075,h:.1},{x:.2875,y:.7166666666666667,w:.03125,h:.041666666666666664},{x:.2875,y:.7166666666666667,w:.05,h:.06666666666666667},{x:.2875,y:.7166666666666667,w:.075,h:.1},{x:.3125,y:.7166666666666667,w:.03125,h:.041666666666666664},{x:.3125,y:.7166666666666667,w:.05,h:.06666666666666667},{x:.3125,y:.7166666666666667,w:.075,h:.1},{x:.3375,y:.7166666666666667,w:.03125,h:.041666666666666664},{x:.3375,y:.7166666666666667,w:.05,h:.06666666666666667},{x:.3375,y:.7166666666666667,w:.075,h:.1},{x:.3625,y:.7166666666666667,w:.03125,h:.041666666666666664},{x:.3625,y:.7166666666666667,w:.05,h:.06666666666666667},{x:.3625,y:.7166666666666667,w:.075,h:.1},{x:.3875,y:.7166666666666667,w:.03125,h:.041666666666666664},{x:.3875,y:.7166666666666667,w:.05,h:.06666666666666667},{x:.3875,y:.7166666666666667,w:.075,h:.1},{x:.4125,y:.7166666666666667,w:.03125,h:.041666666666666664},{x:.4125,y:.7166666666666667,w:.05,h:.06666666666666667},{x:.4125,y:.7166666666666667,w:.075,h:.1},{x:.4375,y:.7166666666666667,w:.03125,h:.041666666666666664},{x:.4375,y:.7166666666666667,w:.05,h:.06666666666666667},{x:.4375,y:.7166666666666667,w:.075,h:.1},{x:.4625,y:.7166666666666667,w:.03125,h:.041666666666666664},{x:.4625,y:.7166666666666667,w:.05,h:.06666666666666667},{x:.4625,y:.7166666666666667,w:.075,h:.1},{x:.4875,y:.7166666666666667,w:.03125,h:.041666666666666664},{x:.4875,y:.7166666666666667,w:.05,h:.06666666666666667},{x:.4875,y:.7166666666666667,w:.075,h:.1},{x:.5125,y:.7166666666666667,w:.03125,h:.041666666666666664},{x:.5125,y:.7166666666666667,w:.05,h:.06666666666666667},{x:.5125,y:.7166666666666667,w:.075,h:.1},{x:.5375,y:.7166666666666667,w:.03125,h:.041666666666666664},{x:.5375,y:.7166666666666667,w:.05,h:.06666666666666667},{x:.5375,y:.7166666666666667,w:.075,h:.1},{x:.5625,y:.7166666666666667,w:.03125,h:.041666666666666664},{x:.5625,y:.7166666666666667,w:.05,h:.06666666666666667},{x:.5625,y:.7166666666666667,w:.075,h:.1},{x:.5875,y:.7166666666666667,w:.03125,h:.041666666666666664},{x:.5875,y:.7166666666666667,w:.05,h:.06666666666666667},{x:.5875,y:.7166666666666667,w:.075,h:.1},{x:.6125,y:.7166666666666667,w:.03125,h:.041666666666666664},{x:.6125,y:.7166666666666667,w:.05,h:.06666666666666667},{x:.6125,y:.7166666666666667,w:.075,h:.1},{x:.6375,y:.7166666666666667,w:.03125,h:.041666666666666664},{x:.6375,y:.7166666666666667,w:.05,h:.06666666666666667},{x:.6375,y:.7166666666666667,w:.075,h:.1},{x:.6625,y:.7166666666666667,w:.03125,h:.041666666666666664},{x:.6625,y:.7166666666666667,w:.05,h:.06666666666666667},{x:.6625,y:.7166666666666667,w:.075,h:.1},{x:.6875,y:.7166666666666667,w:.03125,h:.041666666666666664},{x:.6875,y:.7166666666666667,w:.05,h:.06666666666666667},{x:.6875,y:.7166666666666667,w:.075,h:.1},{x:.7125,y:.7166666666666667,w:.03125,h:.041666666666666664},{x:.7125,y:.7166666666666667,w:.05,h:.06666666666666667},{x:.7125,y:.7166666666666667,w:.075,h:.1},{x:.7375,y:.7166666666666667,w:.03125,h:.041666666666666664},{x:.7375,y:.7166666666666667,w:.05,h:.06666666666666667},{x:.7375,y:.7166666666666667,w:.075,h:.1},{x:.7625,y:.7166666666666667,w:.03125,h:.041666666666666664},{x:.7625,y:.7166666666666667,w:.05,h:.06666666666666667},{x:.7625,y:.7166666666666667,w:.075,h:.1},{x:.7875,y:.7166666666666667,w:.03125,h:.041666666666666664},{x:.7875,y:.7166666666666667,w:.05,h:.06666666666666667},{x:.7875,y:.7166666666666667,w:.075,h:.1},{x:.8125,y:.7166666666666667,w:.03125,h:.041666666666666664},{x:.8125,y:.7166666666666667,w:.05,h:.06666666666666667},{x:.8125,y:.7166666666666667,w:.075,h:.1},{x:.8375,y:.7166666666666667,w:.03125,h:.041666666666666664},{x:.8375,y:.7166666666666667,w:.05,h:.06666666666666667},{x:.8375,y:.7166666666666667,w:.075,h:.1},{x:.8625,y:.7166666666666667,w:.03125,h:.041666666666666664},{x:.8625,y:.7166666666666667,w:.05,h:.06666666666666667},{x:.8625,y:.7166666666666667,w:.075,h:.1},{x:.8875,y:.7166666666666667,w:.03125,h:.041666666666666664},{x:.8875,y:.7166666666666667,w:.05,h:.06666666666666667},{x:.8875,y:.7166666666666667,w:.075,h:.1},{x:.9125,y:.7166666666666667,w:.03125,h:.041666666666666664},{x:.9125,y:.7166666666666667,w:.05,h:.06666666666666667},{x:.9125,y:.7166666666666667,w:.075,h:.1},{x:.9375,y:.7166666666666667,w:.03125,h:.041666666666666664},{x:.9375,y:.7166666666666667,w:.05,h:.06666666666666667},{x:.9375,y:.7166666666666667,w:.075,h:.1},{x:.9625,y:.7166666666666667,w:.03125,h:.041666666666666664},{x:.9625,y:.7166666666666667,w:.05,h:.06666666666666667},{x:.9625,y:.7166666666666667,w:.075,h:.1},{x:.9875,y:.7166666666666667,w:.03125,h:.041666666666666664},{x:.9875,y:.7166666666666667,w:.05,h:.06666666666666667},{x:.9875,y:.7166666666666667,w:.075,h:.1},{x:.0125,y:.75,w:.03125,h:.041666666666666664},{x:.0125,y:.75,w:.05,h:.06666666666666667},{x:.0125,y:.75,w:.075,h:.1},{x:.0375,y:.75,w:.03125,h:.041666666666666664},{x:.0375,y:.75,w:.05,h:.06666666666666667},{x:.0375,y:.75,w:.075,h:.1},{x:.0625,y:.75,w:.03125,h:.041666666666666664},{x:.0625,y:.75,w:.05,h:.06666666666666667},{x:.0625,y:.75,w:.075,h:.1},{x:.0875,y:.75,w:.03125,h:.041666666666666664},{x:.0875,y:.75,w:.05,h:.06666666666666667},{x:.0875,y:.75,w:.075,h:.1},{x:.1125,y:.75,w:.03125,h:.041666666666666664},{x:.1125,y:.75,w:.05,h:.06666666666666667},{x:.1125,y:.75,w:.075,h:.1},{x:.1375,y:.75,w:.03125,h:.041666666666666664},{x:.1375,y:.75,w:.05,h:.06666666666666667},{x:.1375,y:.75,w:.075,h:.1},{x:.1625,y:.75,w:.03125,h:.041666666666666664},{x:.1625,y:.75,w:.05,h:.06666666666666667},{x:.1625,y:.75,w:.075,h:.1},{x:.1875,y:.75,w:.03125,h:.041666666666666664},{x:.1875,y:.75,w:.05,h:.06666666666666667},{x:.1875,y:.75,w:.075,h:.1},{x:.2125,y:.75,w:.03125,h:.041666666666666664},{x:.2125,y:.75,w:.05,h:.06666666666666667},{x:.2125,y:.75,w:.075,h:.1},{x:.2375,y:.75,w:.03125,h:.041666666666666664},{x:.2375,y:.75,w:.05,h:.06666666666666667},{x:.2375,y:.75,w:.075,h:.1},{x:.2625,y:.75,w:.03125,h:.041666666666666664},{x:.2625,y:.75,w:.05,h:.06666666666666667},{x:.2625,y:.75,w:.075,h:.1},{x:.2875,y:.75,w:.03125,h:.041666666666666664},{x:.2875,y:.75,w:.05,h:.06666666666666667},{x:.2875,y:.75,w:.075,h:.1},{x:.3125,y:.75,w:.03125,h:.041666666666666664},{x:.3125,y:.75,w:.05,h:.06666666666666667},{x:.3125,y:.75,w:.075,h:.1},{x:.3375,y:.75,w:.03125,h:.041666666666666664},{x:.3375,y:.75,w:.05,h:.06666666666666667},{x:.3375,y:.75,w:.075,h:.1},{x:.3625,y:.75,w:.03125,h:.041666666666666664},{x:.3625,y:.75,w:.05,h:.06666666666666667},{x:.3625,y:.75,w:.075,h:.1},{x:.3875,y:.75,w:.03125,h:.041666666666666664},{x:.3875,y:.75,w:.05,h:.06666666666666667},{x:.3875,y:.75,w:.075,h:.1},{x:.4125,y:.75,w:.03125,h:.041666666666666664},{x:.4125,y:.75,w:.05,h:.06666666666666667},{x:.4125,y:.75,w:.075,h:.1},{x:.4375,y:.75,w:.03125,h:.041666666666666664},{x:.4375,y:.75,w:.05,h:.06666666666666667},{x:.4375,y:.75,w:.075,h:.1},{x:.4625,y:.75,w:.03125,h:.041666666666666664},{x:.4625,y:.75,w:.05,h:.06666666666666667},{x:.4625,y:.75,w:.075,h:.1},{x:.4875,y:.75,w:.03125,h:.041666666666666664},{x:.4875,y:.75,w:.05,h:.06666666666666667},{x:.4875,y:.75,w:.075,h:.1},{x:.5125,y:.75,w:.03125,h:.041666666666666664},{x:.5125,y:.75,w:.05,h:.06666666666666667},{x:.5125,y:.75,w:.075,h:.1},{x:.5375,y:.75,w:.03125,h:.041666666666666664},{x:.5375,y:.75,w:.05,h:.06666666666666667},{x:.5375,y:.75,w:.075,h:.1},{x:.5625,y:.75,w:.03125,h:.041666666666666664},{x:.5625,y:.75,w:.05,h:.06666666666666667},{x:.5625,y:.75,w:.075,h:.1},{x:.5875,y:.75,w:.03125,h:.041666666666666664},{x:.5875,y:.75,w:.05,h:.06666666666666667},{x:.5875,y:.75,w:.075,h:.1},{x:.6125,y:.75,w:.03125,h:.041666666666666664},{x:.6125,y:.75,w:.05,h:.06666666666666667},{x:.6125,y:.75,w:.075,h:.1},{x:.6375,y:.75,w:.03125,h:.041666666666666664},{x:.6375,y:.75,w:.05,h:.06666666666666667},{x:.6375,y:.75,w:.075,h:.1},{x:.6625,y:.75,w:.03125,h:.041666666666666664},{x:.6625,y:.75,w:.05,h:.06666666666666667},{x:.6625,y:.75,w:.075,h:.1},{x:.6875,y:.75,w:.03125,h:.041666666666666664},{x:.6875,y:.75,w:.05,h:.06666666666666667},{x:.6875,y:.75,w:.075,h:.1},{x:.7125,y:.75,w:.03125,h:.041666666666666664},{x:.7125,y:.75,w:.05,h:.06666666666666667},{x:.7125,y:.75,w:.075,h:.1},{x:.7375,y:.75,w:.03125,h:.041666666666666664},{x:.7375,y:.75,w:.05,h:.06666666666666667},{x:.7375,y:.75,w:.075,h:.1},{x:.7625,y:.75,w:.03125,h:.041666666666666664},{x:.7625,y:.75,w:.05,h:.06666666666666667},{x:.7625,y:.75,w:.075,h:.1},{x:.7875,y:.75,w:.03125,h:.041666666666666664},{x:.7875,y:.75,w:.05,h:.06666666666666667},{x:.7875,y:.75,w:.075,h:.1},{x:.8125,y:.75,w:.03125,h:.041666666666666664},{x:.8125,y:.75,w:.05,h:.06666666666666667},{x:.8125,y:.75,w:.075,h:.1},{x:.8375,y:.75,w:.03125,h:.041666666666666664},{x:.8375,y:.75,w:.05,h:.06666666666666667},{x:.8375,y:.75,w:.075,h:.1},{x:.8625,y:.75,w:.03125,h:.041666666666666664},{x:.8625,y:.75,w:.05,h:.06666666666666667},{x:.8625,y:.75,w:.075,h:.1},{x:.8875,y:.75,w:.03125,h:.041666666666666664},{x:.8875,y:.75,w:.05,h:.06666666666666667},{x:.8875,y:.75,w:.075,h:.1},{x:.9125,y:.75,w:.03125,h:.041666666666666664},{x:.9125,y:.75,w:.05,h:.06666666666666667},{x:.9125,y:.75,w:.075,h:.1},{x:.9375,y:.75,w:.03125,h:.041666666666666664},{x:.9375,y:.75,w:.05,h:.06666666666666667},{x:.9375,y:.75,w:.075,h:.1},{x:.9625,y:.75,w:.03125,h:.041666666666666664},{x:.9625,y:.75,w:.05,h:.06666666666666667},{x:.9625,y:.75,w:.075,h:.1},{x:.9875,y:.75,w:.03125,h:.041666666666666664},{x:.9875,y:.75,w:.05,h:.06666666666666667},{x:.9875,y:.75,w:.075,h:.1},{x:.0125,y:.7833333333333333,w:.03125,h:.041666666666666664},{x:.0125,y:.7833333333333333,w:.05,h:.06666666666666667},{x:.0125,y:.7833333333333333,w:.075,h:.1},{x:.0375,y:.7833333333333333,w:.03125,h:.041666666666666664},{x:.0375,y:.7833333333333333,w:.05,h:.06666666666666667},{x:.0375,y:.7833333333333333,w:.075,h:.1},{x:.0625,y:.7833333333333333,w:.03125,h:.041666666666666664},{x:.0625,y:.7833333333333333,w:.05,h:.06666666666666667},{x:.0625,y:.7833333333333333,w:.075,h:.1},{x:.0875,y:.7833333333333333,w:.03125,h:.041666666666666664},{x:.0875,y:.7833333333333333,w:.05,h:.06666666666666667},{x:.0875,y:.7833333333333333,w:.075,h:.1},{x:.1125,y:.7833333333333333,w:.03125,h:.041666666666666664},{x:.1125,y:.7833333333333333,w:.05,h:.06666666666666667},{x:.1125,y:.7833333333333333,w:.075,h:.1},{x:.1375,y:.7833333333333333,w:.03125,h:.041666666666666664},{x:.1375,y:.7833333333333333,w:.05,h:.06666666666666667},{x:.1375,y:.7833333333333333,w:.075,h:.1},{x:.1625,y:.7833333333333333,w:.03125,h:.041666666666666664},{x:.1625,y:.7833333333333333,w:.05,h:.06666666666666667},{x:.1625,y:.7833333333333333,w:.075,h:.1},{x:.1875,y:.7833333333333333,w:.03125,h:.041666666666666664},{x:.1875,y:.7833333333333333,w:.05,h:.06666666666666667},{x:.1875,y:.7833333333333333,w:.075,h:.1},{x:.2125,y:.7833333333333333,w:.03125,h:.041666666666666664},{x:.2125,y:.7833333333333333,w:.05,h:.06666666666666667},{x:.2125,y:.7833333333333333,w:.075,h:.1},{x:.2375,y:.7833333333333333,w:.03125,h:.041666666666666664},{x:.2375,y:.7833333333333333,w:.05,h:.06666666666666667},{x:.2375,y:.7833333333333333,w:.075,h:.1},{x:.2625,y:.7833333333333333,w:.03125,h:.041666666666666664},{x:.2625,y:.7833333333333333,w:.05,h:.06666666666666667},{x:.2625,y:.7833333333333333,w:.075,h:.1},{x:.2875,y:.7833333333333333,w:.03125,h:.041666666666666664},{x:.2875,y:.7833333333333333,w:.05,h:.06666666666666667},{x:.2875,y:.7833333333333333,w:.075,h:.1},{x:.3125,y:.7833333333333333,w:.03125,h:.041666666666666664},{x:.3125,y:.7833333333333333,w:.05,h:.06666666666666667},{x:.3125,y:.7833333333333333,w:.075,h:.1},{x:.3375,y:.7833333333333333,w:.03125,h:.041666666666666664},{x:.3375,y:.7833333333333333,w:.05,h:.06666666666666667},{x:.3375,y:.7833333333333333,w:.075,h:.1},{x:.3625,y:.7833333333333333,w:.03125,h:.041666666666666664},{x:.3625,y:.7833333333333333,w:.05,h:.06666666666666667},{x:.3625,y:.7833333333333333,w:.075,h:.1},{x:.3875,y:.7833333333333333,w:.03125,h:.041666666666666664},{x:.3875,y:.7833333333333333,w:.05,h:.06666666666666667},{x:.3875,y:.7833333333333333,w:.075,h:.1},{x:.4125,y:.7833333333333333,w:.03125,h:.041666666666666664},{x:.4125,y:.7833333333333333,w:.05,h:.06666666666666667},{x:.4125,y:.7833333333333333,w:.075,h:.1},{x:.4375,y:.7833333333333333,w:.03125,h:.041666666666666664},{x:.4375,y:.7833333333333333,w:.05,h:.06666666666666667},{x:.4375,y:.7833333333333333,w:.075,h:.1},{x:.4625,y:.7833333333333333,w:.03125,h:.041666666666666664},{x:.4625,y:.7833333333333333,w:.05,h:.06666666666666667},{x:.4625,y:.7833333333333333,w:.075,h:.1},{x:.4875,y:.7833333333333333,w:.03125,h:.041666666666666664},{x:.4875,y:.7833333333333333,w:.05,h:.06666666666666667},{x:.4875,y:.7833333333333333,w:.075,h:.1},{x:.5125,y:.7833333333333333,w:.03125,h:.041666666666666664},{x:.5125,y:.7833333333333333,w:.05,h:.06666666666666667},{x:.5125,y:.7833333333333333,w:.075,h:.1},{x:.5375,y:.7833333333333333,w:.03125,h:.041666666666666664},{x:.5375,y:.7833333333333333,w:.05,h:.06666666666666667},{x:.5375,y:.7833333333333333,w:.075,h:.1},{x:.5625,y:.7833333333333333,w:.03125,h:.041666666666666664},{x:.5625,y:.7833333333333333,w:.05,h:.06666666666666667},{x:.5625,y:.7833333333333333,w:.075,h:.1},{x:.5875,y:.7833333333333333,w:.03125,h:.041666666666666664},{x:.5875,y:.7833333333333333,w:.05,h:.06666666666666667},{x:.5875,y:.7833333333333333,w:.075,h:.1},{x:.6125,y:.7833333333333333,w:.03125,h:.041666666666666664},{x:.6125,y:.7833333333333333,w:.05,h:.06666666666666667},{x:.6125,y:.7833333333333333,w:.075,h:.1},{x:.6375,y:.7833333333333333,w:.03125,h:.041666666666666664},{x:.6375,y:.7833333333333333,w:.05,h:.06666666666666667},{x:.6375,y:.7833333333333333,w:.075,h:.1},{x:.6625,y:.7833333333333333,w:.03125,h:.041666666666666664},{x:.6625,y:.7833333333333333,w:.05,h:.06666666666666667},{x:.6625,y:.7833333333333333,w:.075,h:.1},{x:.6875,y:.7833333333333333,w:.03125,h:.041666666666666664},{x:.6875,y:.7833333333333333,w:.05,h:.06666666666666667},{x:.6875,y:.7833333333333333,w:.075,h:.1},{x:.7125,y:.7833333333333333,w:.03125,h:.041666666666666664},{x:.7125,y:.7833333333333333,w:.05,h:.06666666666666667},{x:.7125,y:.7833333333333333,w:.075,h:.1},{x:.7375,y:.7833333333333333,w:.03125,h:.041666666666666664},{x:.7375,y:.7833333333333333,w:.05,h:.06666666666666667},{x:.7375,y:.7833333333333333,w:.075,h:.1},{x:.7625,y:.7833333333333333,w:.03125,h:.041666666666666664},{x:.7625,y:.7833333333333333,w:.05,h:.06666666666666667},{x:.7625,y:.7833333333333333,w:.075,h:.1},{x:.7875,y:.7833333333333333,w:.03125,h:.041666666666666664},{x:.7875,y:.7833333333333333,w:.05,h:.06666666666666667},{x:.7875,y:.7833333333333333,w:.075,h:.1},{x:.8125,y:.7833333333333333,w:.03125,h:.041666666666666664},{x:.8125,y:.7833333333333333,w:.05,h:.06666666666666667},{x:.8125,y:.7833333333333333,w:.075,h:.1},{x:.8375,y:.7833333333333333,w:.03125,h:.041666666666666664},{x:.8375,y:.7833333333333333,w:.05,h:.06666666666666667},{x:.8375,y:.7833333333333333,w:.075,h:.1},{x:.8625,y:.7833333333333333,w:.03125,h:.041666666666666664},{x:.8625,y:.7833333333333333,w:.05,h:.06666666666666667},{x:.8625,y:.7833333333333333,w:.075,h:.1},{x:.8875,y:.7833333333333333,w:.03125,h:.041666666666666664},{x:.8875,y:.7833333333333333,w:.05,h:.06666666666666667},{x:.8875,y:.7833333333333333,w:.075,h:.1},{x:.9125,y:.7833333333333333,w:.03125,h:.041666666666666664},{x:.9125,y:.7833333333333333,w:.05,h:.06666666666666667},{x:.9125,y:.7833333333333333,w:.075,h:.1},{x:.9375,y:.7833333333333333,w:.03125,h:.041666666666666664},{x:.9375,y:.7833333333333333,w:.05,h:.06666666666666667},{x:.9375,y:.7833333333333333,w:.075,h:.1},{x:.9625,y:.7833333333333333,w:.03125,h:.041666666666666664},{x:.9625,y:.7833333333333333,w:.05,h:.06666666666666667},{x:.9625,y:.7833333333333333,w:.075,h:.1},{x:.9875,y:.7833333333333333,w:.03125,h:.041666666666666664},{x:.9875,y:.7833333333333333,w:.05,h:.06666666666666667},{x:.9875,y:.7833333333333333,w:.075,h:.1},{x:.0125,y:.8166666666666667,w:.03125,h:.041666666666666664},{x:.0125,y:.8166666666666667,w:.05,h:.06666666666666667},{x:.0125,y:.8166666666666667,w:.075,h:.1},{x:.0375,y:.8166666666666667,w:.03125,h:.041666666666666664},{x:.0375,y:.8166666666666667,w:.05,h:.06666666666666667},{x:.0375,y:.8166666666666667,w:.075,h:.1},{x:.0625,y:.8166666666666667,w:.03125,h:.041666666666666664},{x:.0625,y:.8166666666666667,w:.05,h:.06666666666666667},{x:.0625,y:.8166666666666667,w:.075,h:.1},{x:.0875,y:.8166666666666667,w:.03125,h:.041666666666666664},{x:.0875,y:.8166666666666667,w:.05,h:.06666666666666667},{x:.0875,y:.8166666666666667,w:.075,h:.1},{x:.1125,y:.8166666666666667,w:.03125,h:.041666666666666664},{x:.1125,y:.8166666666666667,w:.05,h:.06666666666666667},{x:.1125,y:.8166666666666667,w:.075,h:.1},{x:.1375,y:.8166666666666667,w:.03125,h:.041666666666666664},{x:.1375,y:.8166666666666667,w:.05,h:.06666666666666667},{x:.1375,y:.8166666666666667,w:.075,h:.1},{x:.1625,y:.8166666666666667,w:.03125,h:.041666666666666664},{x:.1625,y:.8166666666666667,w:.05,h:.06666666666666667},{x:.1625,y:.8166666666666667,w:.075,h:.1},{x:.1875,y:.8166666666666667,w:.03125,h:.041666666666666664},{x:.1875,y:.8166666666666667,w:.05,h:.06666666666666667},{x:.1875,y:.8166666666666667,w:.075,h:.1},{x:.2125,y:.8166666666666667,w:.03125,h:.041666666666666664},{x:.2125,y:.8166666666666667,w:.05,h:.06666666666666667},{x:.2125,y:.8166666666666667,w:.075,h:.1},{x:.2375,y:.8166666666666667,w:.03125,h:.041666666666666664},{x:.2375,y:.8166666666666667,w:.05,h:.06666666666666667},{x:.2375,y:.8166666666666667,w:.075,h:.1},{x:.2625,y:.8166666666666667,w:.03125,h:.041666666666666664},{x:.2625,y:.8166666666666667,w:.05,h:.06666666666666667},{x:.2625,y:.8166666666666667,w:.075,h:.1},{x:.2875,y:.8166666666666667,w:.03125,h:.041666666666666664},{x:.2875,y:.8166666666666667,w:.05,h:.06666666666666667},{x:.2875,y:.8166666666666667,w:.075,h:.1},{x:.3125,y:.8166666666666667,w:.03125,h:.041666666666666664},{x:.3125,y:.8166666666666667,w:.05,h:.06666666666666667},{x:.3125,y:.8166666666666667,w:.075,h:.1},{x:.3375,y:.8166666666666667,w:.03125,h:.041666666666666664},{x:.3375,y:.8166666666666667,w:.05,h:.06666666666666667},{x:.3375,y:.8166666666666667,w:.075,h:.1},{x:.3625,y:.8166666666666667,w:.03125,h:.041666666666666664},{x:.3625,y:.8166666666666667,w:.05,h:.06666666666666667},{x:.3625,y:.8166666666666667,w:.075,h:.1},{x:.3875,y:.8166666666666667,w:.03125,h:.041666666666666664},{x:.3875,y:.8166666666666667,w:.05,h:.06666666666666667},{x:.3875,y:.8166666666666667,w:.075,h:.1},{x:.4125,y:.8166666666666667,w:.03125,h:.041666666666666664},{x:.4125,y:.8166666666666667,w:.05,h:.06666666666666667},{x:.4125,y:.8166666666666667,w:.075,h:.1},{x:.4375,y:.8166666666666667,w:.03125,h:.041666666666666664},{x:.4375,y:.8166666666666667,w:.05,h:.06666666666666667},{x:.4375,y:.8166666666666667,w:.075,h:.1},{x:.4625,y:.8166666666666667,w:.03125,h:.041666666666666664},{x:.4625,y:.8166666666666667,w:.05,h:.06666666666666667},{x:.4625,y:.8166666666666667,w:.075,h:.1},{x:.4875,y:.8166666666666667,w:.03125,h:.041666666666666664},{x:.4875,y:.8166666666666667,w:.05,h:.06666666666666667},{x:.4875,y:.8166666666666667,w:.075,h:.1},{x:.5125,y:.8166666666666667,w:.03125,h:.041666666666666664},{x:.5125,y:.8166666666666667,w:.05,h:.06666666666666667},{x:.5125,y:.8166666666666667,w:.075,h:.1},{x:.5375,y:.8166666666666667,w:.03125,h:.041666666666666664},{x:.5375,y:.8166666666666667,w:.05,h:.06666666666666667},{x:.5375,y:.8166666666666667,w:.075,h:.1},{x:.5625,y:.8166666666666667,w:.03125,h:.041666666666666664},{x:.5625,y:.8166666666666667,w:.05,h:.06666666666666667},{x:.5625,y:.8166666666666667,w:.075,h:.1},{x:.5875,y:.8166666666666667,w:.03125,h:.041666666666666664},{x:.5875,y:.8166666666666667,w:.05,h:.06666666666666667},{x:.5875,y:.8166666666666667,w:.075,h:.1},{x:.6125,y:.8166666666666667,w:.03125,h:.041666666666666664},{x:.6125,y:.8166666666666667,w:.05,h:.06666666666666667},{x:.6125,y:.8166666666666667,w:.075,h:.1},{x:.6375,y:.8166666666666667,w:.03125,h:.041666666666666664},{x:.6375,y:.8166666666666667,w:.05,h:.06666666666666667},{x:.6375,y:.8166666666666667,w:.075,h:.1},{x:.6625,y:.8166666666666667,w:.03125,h:.041666666666666664},{x:.6625,y:.8166666666666667,w:.05,h:.06666666666666667},{x:.6625,y:.8166666666666667,w:.075,h:.1},{x:.6875,y:.8166666666666667,w:.03125,h:.041666666666666664},{x:.6875,y:.8166666666666667,w:.05,h:.06666666666666667},{x:.6875,y:.8166666666666667,w:.075,h:.1},{x:.7125,y:.8166666666666667,w:.03125,h:.041666666666666664},{x:.7125,y:.8166666666666667,w:.05,h:.06666666666666667},{x:.7125,y:.8166666666666667,w:.075,h:.1},{x:.7375,y:.8166666666666667,w:.03125,h:.041666666666666664},{x:.7375,y:.8166666666666667,w:.05,h:.06666666666666667},{x:.7375,y:.8166666666666667,w:.075,h:.1},{x:.7625,y:.8166666666666667,w:.03125,h:.041666666666666664},{x:.7625,y:.8166666666666667,w:.05,h:.06666666666666667},{x:.7625,y:.8166666666666667,w:.075,h:.1},{x:.7875,y:.8166666666666667,w:.03125,h:.041666666666666664},{x:.7875,y:.8166666666666667,w:.05,h:.06666666666666667},{x:.7875,y:.8166666666666667,w:.075,h:.1},{x:.8125,y:.8166666666666667,w:.03125,h:.041666666666666664},{x:.8125,y:.8166666666666667,w:.05,h:.06666666666666667},{x:.8125,y:.8166666666666667,w:.075,h:.1},{x:.8375,y:.8166666666666667,w:.03125,h:.041666666666666664},{x:.8375,y:.8166666666666667,w:.05,h:.06666666666666667},{x:.8375,y:.8166666666666667,w:.075,h:.1},{x:.8625,y:.8166666666666667,w:.03125,h:.041666666666666664},{x:.8625,y:.8166666666666667,w:.05,h:.06666666666666667},{x:.8625,y:.8166666666666667,w:.075,h:.1},{x:.8875,y:.8166666666666667,w:.03125,h:.041666666666666664},{x:.8875,y:.8166666666666667,w:.05,h:.06666666666666667},{x:.8875,y:.8166666666666667,w:.075,h:.1},{x:.9125,y:.8166666666666667,w:.03125,h:.041666666666666664},{x:.9125,y:.8166666666666667,w:.05,h:.06666666666666667},{x:.9125,y:.8166666666666667,w:.075,h:.1},{x:.9375,y:.8166666666666667,w:.03125,h:.041666666666666664},{x:.9375,y:.8166666666666667,w:.05,h:.06666666666666667},{x:.9375,y:.8166666666666667,w:.075,h:.1},{x:.9625,y:.8166666666666667,w:.03125,h:.041666666666666664},{x:.9625,y:.8166666666666667,w:.05,h:.06666666666666667},{x:.9625,y:.8166666666666667,w:.075,h:.1},{x:.9875,y:.8166666666666667,w:.03125,h:.041666666666666664},{x:.9875,y:.8166666666666667,w:.05,h:.06666666666666667},{x:.9875,y:.8166666666666667,w:.075,h:.1},{x:.0125,y:.85,w:.03125,h:.041666666666666664},{x:.0125,y:.85,w:.05,h:.06666666666666667},{x:.0125,y:.85,w:.075,h:.1},{x:.0375,y:.85,w:.03125,h:.041666666666666664},{x:.0375,y:.85,w:.05,h:.06666666666666667},{x:.0375,y:.85,w:.075,h:.1},{x:.0625,y:.85,w:.03125,h:.041666666666666664},{x:.0625,y:.85,w:.05,h:.06666666666666667},{x:.0625,y:.85,w:.075,h:.1},{x:.0875,y:.85,w:.03125,h:.041666666666666664},{x:.0875,y:.85,w:.05,h:.06666666666666667},{x:.0875,y:.85,w:.075,h:.1},{x:.1125,y:.85,w:.03125,h:.041666666666666664},{x:.1125,y:.85,w:.05,h:.06666666666666667},{x:.1125,y:.85,w:.075,h:.1},{x:.1375,y:.85,w:.03125,h:.041666666666666664},{x:.1375,y:.85,w:.05,h:.06666666666666667},{x:.1375,y:.85,w:.075,h:.1},{x:.1625,y:.85,w:.03125,h:.041666666666666664},{x:.1625,y:.85,w:.05,h:.06666666666666667},{x:.1625,y:.85,w:.075,h:.1},{x:.1875,y:.85,w:.03125,h:.041666666666666664},{x:.1875,y:.85,w:.05,h:.06666666666666667},{x:.1875,y:.85,w:.075,h:.1},{x:.2125,y:.85,w:.03125,h:.041666666666666664},{x:.2125,y:.85,w:.05,h:.06666666666666667},{x:.2125,y:.85,w:.075,h:.1},{x:.2375,y:.85,w:.03125,h:.041666666666666664},{x:.2375,y:.85,w:.05,h:.06666666666666667},{x:.2375,y:.85,w:.075,h:.1},{x:.2625,y:.85,w:.03125,h:.041666666666666664},{x:.2625,y:.85,w:.05,h:.06666666666666667},{x:.2625,y:.85,w:.075,h:.1},{x:.2875,y:.85,w:.03125,h:.041666666666666664},{x:.2875,y:.85,w:.05,h:.06666666666666667},{x:.2875,y:.85,w:.075,h:.1},{x:.3125,y:.85,w:.03125,h:.041666666666666664},{x:.3125,y:.85,w:.05,h:.06666666666666667},{x:.3125,y:.85,w:.075,h:.1},{x:.3375,y:.85,w:.03125,h:.041666666666666664},{x:.3375,y:.85,w:.05,h:.06666666666666667},{x:.3375,y:.85,w:.075,h:.1},{x:.3625,y:.85,w:.03125,h:.041666666666666664},{x:.3625,y:.85,w:.05,h:.06666666666666667},{x:.3625,y:.85,w:.075,h:.1},{x:.3875,y:.85,w:.03125,h:.041666666666666664},{x:.3875,y:.85,w:.05,h:.06666666666666667},{x:.3875,y:.85,w:.075,h:.1},{x:.4125,y:.85,w:.03125,h:.041666666666666664},{x:.4125,y:.85,w:.05,h:.06666666666666667},{x:.4125,y:.85,w:.075,h:.1},{x:.4375,y:.85,w:.03125,h:.041666666666666664},{x:.4375,y:.85,w:.05,h:.06666666666666667},{x:.4375,y:.85,w:.075,h:.1},{x:.4625,y:.85,w:.03125,h:.041666666666666664},{x:.4625,y:.85,w:.05,h:.06666666666666667},{x:.4625,y:.85,w:.075,h:.1},{x:.4875,y:.85,w:.03125,h:.041666666666666664},{x:.4875,y:.85,w:.05,h:.06666666666666667},{x:.4875,y:.85,w:.075,h:.1},{x:.5125,y:.85,w:.03125,h:.041666666666666664},{x:.5125,y:.85,w:.05,h:.06666666666666667},{x:.5125,y:.85,w:.075,h:.1},{x:.5375,y:.85,w:.03125,h:.041666666666666664},{x:.5375,y:.85,w:.05,h:.06666666666666667},{x:.5375,y:.85,w:.075,h:.1},{x:.5625,y:.85,w:.03125,h:.041666666666666664},{x:.5625,y:.85,w:.05,h:.06666666666666667},{x:.5625,y:.85,w:.075,h:.1},{x:.5875,y:.85,w:.03125,h:.041666666666666664},{x:.5875,y:.85,w:.05,h:.06666666666666667},{x:.5875,y:.85,w:.075,h:.1},{x:.6125,y:.85,w:.03125,h:.041666666666666664},{x:.6125,y:.85,w:.05,h:.06666666666666667},{x:.6125,y:.85,w:.075,h:.1},{x:.6375,y:.85,w:.03125,h:.041666666666666664},{x:.6375,y:.85,w:.05,h:.06666666666666667},{x:.6375,y:.85,w:.075,h:.1},{x:.6625,y:.85,w:.03125,h:.041666666666666664},{x:.6625,y:.85,w:.05,h:.06666666666666667},{x:.6625,y:.85,w:.075,h:.1},{x:.6875,y:.85,w:.03125,h:.041666666666666664},{x:.6875,y:.85,w:.05,h:.06666666666666667},{x:.6875,y:.85,w:.075,h:.1},{x:.7125,y:.85,w:.03125,h:.041666666666666664},{x:.7125,y:.85,w:.05,h:.06666666666666667},{x:.7125,y:.85,w:.075,h:.1},{x:.7375,y:.85,w:.03125,h:.041666666666666664},{x:.7375,y:.85,w:.05,h:.06666666666666667},{x:.7375,y:.85,w:.075,h:.1},{x:.7625,y:.85,w:.03125,h:.041666666666666664},{x:.7625,y:.85,w:.05,h:.06666666666666667},{x:.7625,y:.85,w:.075,h:.1},{x:.7875,y:.85,w:.03125,h:.041666666666666664},{x:.7875,y:.85,w:.05,h:.06666666666666667},{x:.7875,y:.85,w:.075,h:.1},{x:.8125,y:.85,w:.03125,h:.041666666666666664},{x:.8125,y:.85,w:.05,h:.06666666666666667},{x:.8125,y:.85,w:.075,h:.1},{x:.8375,y:.85,w:.03125,h:.041666666666666664},{x:.8375,y:.85,w:.05,h:.06666666666666667},{x:.8375,y:.85,w:.075,h:.1},{x:.8625,y:.85,w:.03125,h:.041666666666666664},{x:.8625,y:.85,w:.05,h:.06666666666666667},{x:.8625,y:.85,w:.075,h:.1},{x:.8875,y:.85,w:.03125,h:.041666666666666664},{x:.8875,y:.85,w:.05,h:.06666666666666667},{x:.8875,y:.85,w:.075,h:.1},{x:.9125,y:.85,w:.03125,h:.041666666666666664},{x:.9125,y:.85,w:.05,h:.06666666666666667},{x:.9125,y:.85,w:.075,h:.1},{x:.9375,y:.85,w:.03125,h:.041666666666666664},{x:.9375,y:.85,w:.05,h:.06666666666666667},{x:.9375,y:.85,w:.075,h:.1},{x:.9625,y:.85,w:.03125,h:.041666666666666664},{x:.9625,y:.85,w:.05,h:.06666666666666667},{x:.9625,y:.85,w:.075,h:.1},{x:.9875,y:.85,w:.03125,h:.041666666666666664},{x:.9875,y:.85,w:.05,h:.06666666666666667},{x:.9875,y:.85,w:.075,h:.1},{x:.0125,y:.8833333333333333,w:.03125,h:.041666666666666664},{x:.0125,y:.8833333333333333,w:.05,h:.06666666666666667},{x:.0125,y:.8833333333333333,w:.075,h:.1},{x:.0375,y:.8833333333333333,w:.03125,h:.041666666666666664},{x:.0375,y:.8833333333333333,w:.05,h:.06666666666666667},{x:.0375,y:.8833333333333333,w:.075,h:.1},{x:.0625,y:.8833333333333333,w:.03125,h:.041666666666666664},{x:.0625,y:.8833333333333333,w:.05,h:.06666666666666667},{x:.0625,y:.8833333333333333,w:.075,h:.1},{x:.0875,y:.8833333333333333,w:.03125,h:.041666666666666664},{x:.0875,y:.8833333333333333,w:.05,h:.06666666666666667},{x:.0875,y:.8833333333333333,w:.075,h:.1},{x:.1125,y:.8833333333333333,w:.03125,h:.041666666666666664},{x:.1125,y:.8833333333333333,w:.05,h:.06666666666666667},{x:.1125,y:.8833333333333333,w:.075,h:.1},{x:.1375,y:.8833333333333333,w:.03125,h:.041666666666666664},{x:.1375,y:.8833333333333333,w:.05,h:.06666666666666667},{x:.1375,y:.8833333333333333,w:.075,h:.1},{x:.1625,y:.8833333333333333,w:.03125,h:.041666666666666664},{x:.1625,y:.8833333333333333,w:.05,h:.06666666666666667},{x:.1625,y:.8833333333333333,w:.075,h:.1},{x:.1875,y:.8833333333333333,w:.03125,h:.041666666666666664},{x:.1875,y:.8833333333333333,w:.05,h:.06666666666666667},{x:.1875,y:.8833333333333333,w:.075,h:.1},{x:.2125,y:.8833333333333333,w:.03125,h:.041666666666666664},{x:.2125,y:.8833333333333333,w:.05,h:.06666666666666667},{x:.2125,y:.8833333333333333,w:.075,h:.1},{x:.2375,y:.8833333333333333,w:.03125,h:.041666666666666664},{x:.2375,y:.8833333333333333,w:.05,h:.06666666666666667},{x:.2375,y:.8833333333333333,w:.075,h:.1},{x:.2625,y:.8833333333333333,w:.03125,h:.041666666666666664},{x:.2625,y:.8833333333333333,w:.05,h:.06666666666666667},{x:.2625,y:.8833333333333333,w:.075,h:.1},{x:.2875,y:.8833333333333333,w:.03125,h:.041666666666666664},{x:.2875,y:.8833333333333333,w:.05,h:.06666666666666667},{x:.2875,y:.8833333333333333,w:.075,h:.1},{x:.3125,y:.8833333333333333,w:.03125,h:.041666666666666664},{x:.3125,y:.8833333333333333,w:.05,h:.06666666666666667},{x:.3125,y:.8833333333333333,w:.075,h:.1},{x:.3375,y:.8833333333333333,w:.03125,h:.041666666666666664},{x:.3375,y:.8833333333333333,w:.05,h:.06666666666666667},{x:.3375,y:.8833333333333333,w:.075,h:.1},{x:.3625,y:.8833333333333333,w:.03125,h:.041666666666666664},{x:.3625,y:.8833333333333333,w:.05,h:.06666666666666667},{x:.3625,y:.8833333333333333,w:.075,h:.1},{x:.3875,y:.8833333333333333,w:.03125,h:.041666666666666664},{x:.3875,y:.8833333333333333,w:.05,h:.06666666666666667},{x:.3875,y:.8833333333333333,w:.075,h:.1},{x:.4125,y:.8833333333333333,w:.03125,h:.041666666666666664},{x:.4125,y:.8833333333333333,w:.05,h:.06666666666666667},{x:.4125,y:.8833333333333333,w:.075,h:.1},{x:.4375,y:.8833333333333333,w:.03125,h:.041666666666666664},{x:.4375,y:.8833333333333333,w:.05,h:.06666666666666667},{x:.4375,y:.8833333333333333,w:.075,h:.1},{x:.4625,y:.8833333333333333,w:.03125,h:.041666666666666664},{x:.4625,y:.8833333333333333,w:.05,h:.06666666666666667},{x:.4625,y:.8833333333333333,w:.075,h:.1},{x:.4875,y:.8833333333333333,w:.03125,h:.041666666666666664},{x:.4875,y:.8833333333333333,w:.05,h:.06666666666666667},{x:.4875,y:.8833333333333333,w:.075,h:.1},{x:.5125,y:.8833333333333333,w:.03125,h:.041666666666666664},{x:.5125,y:.8833333333333333,w:.05,h:.06666666666666667},{x:.5125,y:.8833333333333333,w:.075,h:.1},{x:.5375,y:.8833333333333333,w:.03125,h:.041666666666666664},{x:.5375,y:.8833333333333333,w:.05,h:.06666666666666667},{x:.5375,y:.8833333333333333,w:.075,h:.1},{x:.5625,y:.8833333333333333,w:.03125,h:.041666666666666664},{x:.5625,y:.8833333333333333,w:.05,h:.06666666666666667},{x:.5625,y:.8833333333333333,w:.075,h:.1},{x:.5875,y:.8833333333333333,w:.03125,h:.041666666666666664},{x:.5875,y:.8833333333333333,w:.05,h:.06666666666666667},{x:.5875,y:.8833333333333333,w:.075,h:.1},{x:.6125,y:.8833333333333333,w:.03125,h:.041666666666666664},{x:.6125,y:.8833333333333333,w:.05,h:.06666666666666667},{x:.6125,y:.8833333333333333,w:.075,h:.1},{x:.6375,y:.8833333333333333,w:.03125,h:.041666666666666664},{x:.6375,y:.8833333333333333,w:.05,h:.06666666666666667},{x:.6375,y:.8833333333333333,w:.075,h:.1},{x:.6625,y:.8833333333333333,w:.03125,h:.041666666666666664},{x:.6625,y:.8833333333333333,w:.05,h:.06666666666666667},{x:.6625,y:.8833333333333333,w:.075,h:.1},{x:.6875,y:.8833333333333333,w:.03125,h:.041666666666666664},{x:.6875,y:.8833333333333333,w:.05,h:.06666666666666667},{x:.6875,y:.8833333333333333,w:.075,h:.1},{x:.7125,y:.8833333333333333,w:.03125,h:.041666666666666664},{x:.7125,y:.8833333333333333,w:.05,h:.06666666666666667},{x:.7125,y:.8833333333333333,w:.075,h:.1},{x:.7375,y:.8833333333333333,w:.03125,h:.041666666666666664},{x:.7375,y:.8833333333333333,w:.05,h:.06666666666666667},{x:.7375,y:.8833333333333333,w:.075,h:.1},{x:.7625,y:.8833333333333333,w:.03125,h:.041666666666666664},{x:.7625,y:.8833333333333333,w:.05,h:.06666666666666667},{x:.7625,y:.8833333333333333,w:.075,h:.1},{x:.7875,y:.8833333333333333,w:.03125,h:.041666666666666664},{x:.7875,y:.8833333333333333,w:.05,h:.06666666666666667},{x:.7875,y:.8833333333333333,w:.075,h:.1},{x:.8125,y:.8833333333333333,w:.03125,h:.041666666666666664},{x:.8125,y:.8833333333333333,w:.05,h:.06666666666666667},{x:.8125,y:.8833333333333333,w:.075,h:.1},{x:.8375,y:.8833333333333333,w:.03125,h:.041666666666666664},{x:.8375,y:.8833333333333333,w:.05,h:.06666666666666667},{x:.8375,y:.8833333333333333,w:.075,h:.1},{x:.8625,y:.8833333333333333,w:.03125,h:.041666666666666664},{x:.8625,y:.8833333333333333,w:.05,h:.06666666666666667},{x:.8625,y:.8833333333333333,w:.075,h:.1},{x:.8875,y:.8833333333333333,w:.03125,h:.041666666666666664},{x:.8875,y:.8833333333333333,w:.05,h:.06666666666666667},{x:.8875,y:.8833333333333333,w:.075,h:.1},{x:.9125,y:.8833333333333333,w:.03125,h:.041666666666666664},{x:.9125,y:.8833333333333333,w:.05,h:.06666666666666667},{x:.9125,y:.8833333333333333,w:.075,h:.1},{x:.9375,y:.8833333333333333,w:.03125,h:.041666666666666664},{x:.9375,y:.8833333333333333,w:.05,h:.06666666666666667},{x:.9375,y:.8833333333333333,w:.075,h:.1},{x:.9625,y:.8833333333333333,w:.03125,h:.041666666666666664},{x:.9625,y:.8833333333333333,w:.05,h:.06666666666666667},{x:.9625,y:.8833333333333333,w:.075,h:.1},{x:.9875,y:.8833333333333333,w:.03125,h:.041666666666666664},{x:.9875,y:.8833333333333333,w:.05,h:.06666666666666667},{x:.9875,y:.8833333333333333,w:.075,h:.1},{x:.0125,y:.9166666666666666,w:.03125,h:.041666666666666664},{x:.0125,y:.9166666666666666,w:.05,h:.06666666666666667},{x:.0125,y:.9166666666666666,w:.075,h:.1},{x:.0375,y:.9166666666666666,w:.03125,h:.041666666666666664},{x:.0375,y:.9166666666666666,w:.05,h:.06666666666666667},{x:.0375,y:.9166666666666666,w:.075,h:.1},{x:.0625,y:.9166666666666666,w:.03125,h:.041666666666666664},{x:.0625,y:.9166666666666666,w:.05,h:.06666666666666667},{x:.0625,y:.9166666666666666,w:.075,h:.1},{x:.0875,y:.9166666666666666,w:.03125,h:.041666666666666664},{x:.0875,y:.9166666666666666,w:.05,h:.06666666666666667},{x:.0875,y:.9166666666666666,w:.075,h:.1},{x:.1125,y:.9166666666666666,w:.03125,h:.041666666666666664},{x:.1125,y:.9166666666666666,w:.05,h:.06666666666666667},{x:.1125,y:.9166666666666666,w:.075,h:.1},{x:.1375,y:.9166666666666666,w:.03125,h:.041666666666666664},{x:.1375,y:.9166666666666666,w:.05,h:.06666666666666667},{x:.1375,y:.9166666666666666,w:.075,h:.1},{x:.1625,y:.9166666666666666,w:.03125,h:.041666666666666664},{x:.1625,y:.9166666666666666,w:.05,h:.06666666666666667},{x:.1625,y:.9166666666666666,w:.075,h:.1},{x:.1875,y:.9166666666666666,w:.03125,h:.041666666666666664},{x:.1875,y:.9166666666666666,w:.05,h:.06666666666666667},{x:.1875,y:.9166666666666666,w:.075,h:.1},{x:.2125,y:.9166666666666666,w:.03125,h:.041666666666666664},{x:.2125,y:.9166666666666666,w:.05,h:.06666666666666667},{x:.2125,y:.9166666666666666,w:.075,h:.1},{x:.2375,y:.9166666666666666,w:.03125,h:.041666666666666664},{x:.2375,y:.9166666666666666,w:.05,h:.06666666666666667},{x:.2375,y:.9166666666666666,w:.075,h:.1},{x:.2625,y:.9166666666666666,w:.03125,h:.041666666666666664},{x:.2625,y:.9166666666666666,w:.05,h:.06666666666666667},{x:.2625,y:.9166666666666666,w:.075,h:.1},{x:.2875,y:.9166666666666666,w:.03125,h:.041666666666666664},{x:.2875,y:.9166666666666666,w:.05,h:.06666666666666667},{x:.2875,y:.9166666666666666,w:.075,h:.1},{x:.3125,y:.9166666666666666,w:.03125,h:.041666666666666664},{x:.3125,y:.9166666666666666,w:.05,h:.06666666666666667},{x:.3125,y:.9166666666666666,w:.075,h:.1},{x:.3375,y:.9166666666666666,w:.03125,h:.041666666666666664},{x:.3375,y:.9166666666666666,w:.05,h:.06666666666666667},{x:.3375,y:.9166666666666666,w:.075,h:.1},{x:.3625,y:.9166666666666666,w:.03125,h:.041666666666666664},{x:.3625,y:.9166666666666666,w:.05,h:.06666666666666667},{x:.3625,y:.9166666666666666,w:.075,h:.1},{x:.3875,y:.9166666666666666,w:.03125,h:.041666666666666664},{x:.3875,y:.9166666666666666,w:.05,h:.06666666666666667},{x:.3875,y:.9166666666666666,w:.075,h:.1},{x:.4125,y:.9166666666666666,w:.03125,h:.041666666666666664},{x:.4125,y:.9166666666666666,w:.05,h:.06666666666666667},{x:.4125,y:.9166666666666666,w:.075,h:.1},{x:.4375,y:.9166666666666666,w:.03125,h:.041666666666666664},{x:.4375,y:.9166666666666666,w:.05,h:.06666666666666667},{x:.4375,y:.9166666666666666,w:.075,h:.1},{x:.4625,y:.9166666666666666,w:.03125,h:.041666666666666664},{x:.4625,y:.9166666666666666,w:.05,h:.06666666666666667},{x:.4625,y:.9166666666666666,w:.075,h:.1},{x:.4875,y:.9166666666666666,w:.03125,h:.041666666666666664},{x:.4875,y:.9166666666666666,w:.05,h:.06666666666666667},{x:.4875,y:.9166666666666666,w:.075,h:.1},{x:.5125,y:.9166666666666666,w:.03125,h:.041666666666666664},{x:.5125,y:.9166666666666666,w:.05,h:.06666666666666667},{x:.5125,y:.9166666666666666,w:.075,h:.1},{x:.5375,y:.9166666666666666,w:.03125,h:.041666666666666664},{x:.5375,y:.9166666666666666,w:.05,h:.06666666666666667},{x:.5375,y:.9166666666666666,w:.075,h:.1},{x:.5625,y:.9166666666666666,w:.03125,h:.041666666666666664},{x:.5625,y:.9166666666666666,w:.05,h:.06666666666666667},{x:.5625,y:.9166666666666666,w:.075,h:.1},{x:.5875,y:.9166666666666666,w:.03125,h:.041666666666666664},{x:.5875,y:.9166666666666666,w:.05,h:.06666666666666667},{x:.5875,y:.9166666666666666,w:.075,h:.1},{x:.6125,y:.9166666666666666,w:.03125,h:.041666666666666664},{x:.6125,y:.9166666666666666,w:.05,h:.06666666666666667},{x:.6125,y:.9166666666666666,w:.075,h:.1},{x:.6375,y:.9166666666666666,w:.03125,h:.041666666666666664},{x:.6375,y:.9166666666666666,w:.05,h:.06666666666666667},{x:.6375,y:.9166666666666666,w:.075,h:.1},{x:.6625,y:.9166666666666666,w:.03125,h:.041666666666666664},{x:.6625,y:.9166666666666666,w:.05,h:.06666666666666667},{x:.6625,y:.9166666666666666,w:.075,h:.1},{x:.6875,y:.9166666666666666,w:.03125,h:.041666666666666664},{x:.6875,y:.9166666666666666,w:.05,h:.06666666666666667},{x:.6875,y:.9166666666666666,w:.075,h:.1},{x:.7125,y:.9166666666666666,w:.03125,h:.041666666666666664},{x:.7125,y:.9166666666666666,w:.05,h:.06666666666666667},{x:.7125,y:.9166666666666666,w:.075,h:.1},{x:.7375,y:.9166666666666666,w:.03125,h:.041666666666666664},{x:.7375,y:.9166666666666666,w:.05,h:.06666666666666667},{x:.7375,y:.9166666666666666,w:.075,h:.1},{x:.7625,y:.9166666666666666,w:.03125,h:.041666666666666664},{x:.7625,y:.9166666666666666,w:.05,h:.06666666666666667},{x:.7625,y:.9166666666666666,w:.075,h:.1},{x:.7875,y:.9166666666666666,w:.03125,h:.041666666666666664},{x:.7875,y:.9166666666666666,w:.05,h:.06666666666666667},{x:.7875,y:.9166666666666666,w:.075,h:.1},{x:.8125,y:.9166666666666666,w:.03125,h:.041666666666666664},{x:.8125,y:.9166666666666666,w:.05,h:.06666666666666667},{x:.8125,y:.9166666666666666,w:.075,h:.1},{x:.8375,y:.9166666666666666,w:.03125,h:.041666666666666664},{x:.8375,y:.9166666666666666,w:.05,h:.06666666666666667},{x:.8375,y:.9166666666666666,w:.075,h:.1},{x:.8625,y:.9166666666666666,w:.03125,h:.041666666666666664},{x:.8625,y:.9166666666666666,w:.05,h:.06666666666666667},{x:.8625,y:.9166666666666666,w:.075,h:.1},{x:.8875,y:.9166666666666666,w:.03125,h:.041666666666666664},{x:.8875,y:.9166666666666666,w:.05,h:.06666666666666667},{x:.8875,y:.9166666666666666,w:.075,h:.1},{x:.9125,y:.9166666666666666,w:.03125,h:.041666666666666664},{x:.9125,y:.9166666666666666,w:.05,h:.06666666666666667},{x:.9125,y:.9166666666666666,w:.075,h:.1},{x:.9375,y:.9166666666666666,w:.03125,h:.041666666666666664},{x:.9375,y:.9166666666666666,w:.05,h:.06666666666666667},{x:.9375,y:.9166666666666666,w:.075,h:.1},{x:.9625,y:.9166666666666666,w:.03125,h:.041666666666666664},{x:.9625,y:.9166666666666666,w:.05,h:.06666666666666667},{x:.9625,y:.9166666666666666,w:.075,h:.1},{x:.9875,y:.9166666666666666,w:.03125,h:.041666666666666664},{x:.9875,y:.9166666666666666,w:.05,h:.06666666666666667},{x:.9875,y:.9166666666666666,w:.075,h:.1},{x:.0125,y:.95,w:.03125,h:.041666666666666664},{x:.0125,y:.95,w:.05,h:.06666666666666667},{x:.0125,y:.95,w:.075,h:.1},{x:.0375,y:.95,w:.03125,h:.041666666666666664},{x:.0375,y:.95,w:.05,h:.06666666666666667},{x:.0375,y:.95,w:.075,h:.1},{x:.0625,y:.95,w:.03125,h:.041666666666666664},{x:.0625,y:.95,w:.05,h:.06666666666666667},{x:.0625,y:.95,w:.075,h:.1},{x:.0875,y:.95,w:.03125,h:.041666666666666664},{x:.0875,y:.95,w:.05,h:.06666666666666667},{x:.0875,y:.95,w:.075,h:.1},{x:.1125,y:.95,w:.03125,h:.041666666666666664},{x:.1125,y:.95,w:.05,h:.06666666666666667},{x:.1125,y:.95,w:.075,h:.1},{x:.1375,y:.95,w:.03125,h:.041666666666666664},{x:.1375,y:.95,w:.05,h:.06666666666666667},{x:.1375,y:.95,w:.075,h:.1},{x:.1625,y:.95,w:.03125,h:.041666666666666664},{x:.1625,y:.95,w:.05,h:.06666666666666667},{x:.1625,y:.95,w:.075,h:.1},{x:.1875,y:.95,w:.03125,h:.041666666666666664},{x:.1875,y:.95,w:.05,h:.06666666666666667},{x:.1875,y:.95,w:.075,h:.1},{x:.2125,y:.95,w:.03125,h:.041666666666666664},{x:.2125,y:.95,w:.05,h:.06666666666666667},{x:.2125,y:.95,w:.075,h:.1},{x:.2375,y:.95,w:.03125,h:.041666666666666664},{x:.2375,y:.95,w:.05,h:.06666666666666667},{x:.2375,y:.95,w:.075,h:.1},{x:.2625,y:.95,w:.03125,h:.041666666666666664},{x:.2625,y:.95,w:.05,h:.06666666666666667},{x:.2625,y:.95,w:.075,h:.1},{x:.2875,y:.95,w:.03125,h:.041666666666666664},{x:.2875,y:.95,w:.05,h:.06666666666666667},{x:.2875,y:.95,w:.075,h:.1},{x:.3125,y:.95,w:.03125,h:.041666666666666664},{x:.3125,y:.95,w:.05,h:.06666666666666667},{x:.3125,y:.95,w:.075,h:.1},{x:.3375,y:.95,w:.03125,h:.041666666666666664},{x:.3375,y:.95,w:.05,h:.06666666666666667},{x:.3375,y:.95,w:.075,h:.1},{x:.3625,y:.95,w:.03125,h:.041666666666666664},{x:.3625,y:.95,w:.05,h:.06666666666666667},{x:.3625,y:.95,w:.075,h:.1},{x:.3875,y:.95,w:.03125,h:.041666666666666664},{x:.3875,y:.95,w:.05,h:.06666666666666667},{x:.3875,y:.95,w:.075,h:.1},{x:.4125,y:.95,w:.03125,h:.041666666666666664},{x:.4125,y:.95,w:.05,h:.06666666666666667},{x:.4125,y:.95,w:.075,h:.1},{x:.4375,y:.95,w:.03125,h:.041666666666666664},{x:.4375,y:.95,w:.05,h:.06666666666666667},{x:.4375,y:.95,w:.075,h:.1},{x:.4625,y:.95,w:.03125,h:.041666666666666664},{x:.4625,y:.95,w:.05,h:.06666666666666667},{x:.4625,y:.95,w:.075,h:.1},{x:.4875,y:.95,w:.03125,h:.041666666666666664},{x:.4875,y:.95,w:.05,h:.06666666666666667},{x:.4875,y:.95,w:.075,h:.1},{x:.5125,y:.95,w:.03125,h:.041666666666666664},{x:.5125,y:.95,w:.05,h:.06666666666666667},{x:.5125,y:.95,w:.075,h:.1},{x:.5375,y:.95,w:.03125,h:.041666666666666664},{x:.5375,y:.95,w:.05,h:.06666666666666667},{x:.5375,y:.95,w:.075,h:.1},{x:.5625,y:.95,w:.03125,h:.041666666666666664},{x:.5625,y:.95,w:.05,h:.06666666666666667},{x:.5625,y:.95,w:.075,h:.1},{x:.5875,y:.95,w:.03125,h:.041666666666666664},{x:.5875,y:.95,w:.05,h:.06666666666666667},{x:.5875,y:.95,w:.075,h:.1},{x:.6125,y:.95,w:.03125,h:.041666666666666664},{x:.6125,y:.95,w:.05,h:.06666666666666667},{x:.6125,y:.95,w:.075,h:.1},{x:.6375,y:.95,w:.03125,h:.041666666666666664},{x:.6375,y:.95,w:.05,h:.06666666666666667},{x:.6375,y:.95,w:.075,h:.1},{x:.6625,y:.95,w:.03125,h:.041666666666666664},{x:.6625,y:.95,w:.05,h:.06666666666666667},{x:.6625,y:.95,w:.075,h:.1},{x:.6875,y:.95,w:.03125,h:.041666666666666664},{x:.6875,y:.95,w:.05,h:.06666666666666667},{x:.6875,y:.95,w:.075,h:.1},{x:.7125,y:.95,w:.03125,h:.041666666666666664},{x:.7125,y:.95,w:.05,h:.06666666666666667},{x:.7125,y:.95,w:.075,h:.1},{x:.7375,y:.95,w:.03125,h:.041666666666666664},{x:.7375,y:.95,w:.05,h:.06666666666666667},{x:.7375,y:.95,w:.075,h:.1},{x:.7625,y:.95,w:.03125,h:.041666666666666664},{x:.7625,y:.95,w:.05,h:.06666666666666667},{x:.7625,y:.95,w:.075,h:.1},{x:.7875,y:.95,w:.03125,h:.041666666666666664},{x:.7875,y:.95,w:.05,h:.06666666666666667},{x:.7875,y:.95,w:.075,h:.1},{x:.8125,y:.95,w:.03125,h:.041666666666666664},{x:.8125,y:.95,w:.05,h:.06666666666666667},{x:.8125,y:.95,w:.075,h:.1},{x:.8375,y:.95,w:.03125,h:.041666666666666664},{x:.8375,y:.95,w:.05,h:.06666666666666667},{x:.8375,y:.95,w:.075,h:.1},{x:.8625,y:.95,w:.03125,h:.041666666666666664},{x:.8625,y:.95,w:.05,h:.06666666666666667},{x:.8625,y:.95,w:.075,h:.1},{x:.8875,y:.95,w:.03125,h:.041666666666666664},{x:.8875,y:.95,w:.05,h:.06666666666666667},{x:.8875,y:.95,w:.075,h:.1},{x:.9125,y:.95,w:.03125,h:.041666666666666664},{x:.9125,y:.95,w:.05,h:.06666666666666667},{x:.9125,y:.95,w:.075,h:.1},{x:.9375,y:.95,w:.03125,h:.041666666666666664},{x:.9375,y:.95,w:.05,h:.06666666666666667},{x:.9375,y:.95,w:.075,h:.1},{x:.9625,y:.95,w:.03125,h:.041666666666666664},{x:.9625,y:.95,w:.05,h:.06666666666666667},{x:.9625,y:.95,w:.075,h:.1},{x:.9875,y:.95,w:.03125,h:.041666666666666664},{x:.9875,y:.95,w:.05,h:.06666666666666667},{x:.9875,y:.95,w:.075,h:.1},{x:.0125,y:.9833333333333333,w:.03125,h:.041666666666666664},{x:.0125,y:.9833333333333333,w:.05,h:.06666666666666667},{x:.0125,y:.9833333333333333,w:.075,h:.1},{x:.0375,y:.9833333333333333,w:.03125,h:.041666666666666664},{x:.0375,y:.9833333333333333,w:.05,h:.06666666666666667},{x:.0375,y:.9833333333333333,w:.075,h:.1},{x:.0625,y:.9833333333333333,w:.03125,h:.041666666666666664},{x:.0625,y:.9833333333333333,w:.05,h:.06666666666666667},{x:.0625,y:.9833333333333333,w:.075,h:.1},{x:.0875,y:.9833333333333333,w:.03125,h:.041666666666666664},{x:.0875,y:.9833333333333333,w:.05,h:.06666666666666667},{x:.0875,y:.9833333333333333,w:.075,h:.1},{x:.1125,y:.9833333333333333,w:.03125,h:.041666666666666664},{x:.1125,y:.9833333333333333,w:.05,h:.06666666666666667},{x:.1125,y:.9833333333333333,w:.075,h:.1},{x:.1375,y:.9833333333333333,w:.03125,h:.041666666666666664},{x:.1375,y:.9833333333333333,w:.05,h:.06666666666666667},{x:.1375,y:.9833333333333333,w:.075,h:.1},{x:.1625,y:.9833333333333333,w:.03125,h:.041666666666666664},{x:.1625,y:.9833333333333333,w:.05,h:.06666666666666667},{x:.1625,y:.9833333333333333,w:.075,h:.1},{x:.1875,y:.9833333333333333,w:.03125,h:.041666666666666664},{x:.1875,y:.9833333333333333,w:.05,h:.06666666666666667},{x:.1875,y:.9833333333333333,w:.075,h:.1},{x:.2125,y:.9833333333333333,w:.03125,h:.041666666666666664},{x:.2125,y:.9833333333333333,w:.05,h:.06666666666666667},{x:.2125,y:.9833333333333333,w:.075,h:.1},{x:.2375,y:.9833333333333333,w:.03125,h:.041666666666666664},{x:.2375,y:.9833333333333333,w:.05,h:.06666666666666667},{x:.2375,y:.9833333333333333,w:.075,h:.1},{x:.2625,y:.9833333333333333,w:.03125,h:.041666666666666664},{x:.2625,y:.9833333333333333,w:.05,h:.06666666666666667},{x:.2625,y:.9833333333333333,w:.075,h:.1},{x:.2875,y:.9833333333333333,w:.03125,h:.041666666666666664},{x:.2875,y:.9833333333333333,w:.05,h:.06666666666666667},{x:.2875,y:.9833333333333333,w:.075,h:.1},{x:.3125,y:.9833333333333333,w:.03125,h:.041666666666666664},{x:.3125,y:.9833333333333333,w:.05,h:.06666666666666667},{x:.3125,y:.9833333333333333,w:.075,h:.1},{x:.3375,y:.9833333333333333,w:.03125,h:.041666666666666664},{x:.3375,y:.9833333333333333,w:.05,h:.06666666666666667},{x:.3375,y:.9833333333333333,w:.075,h:.1},{x:.3625,y:.9833333333333333,w:.03125,h:.041666666666666664},{x:.3625,y:.9833333333333333,w:.05,h:.06666666666666667},{x:.3625,y:.9833333333333333,w:.075,h:.1},{x:.3875,y:.9833333333333333,w:.03125,h:.041666666666666664},{x:.3875,y:.9833333333333333,w:.05,h:.06666666666666667},{x:.3875,y:.9833333333333333,w:.075,h:.1},{x:.4125,y:.9833333333333333,w:.03125,h:.041666666666666664},{x:.4125,y:.9833333333333333,w:.05,h:.06666666666666667},{x:.4125,y:.9833333333333333,w:.075,h:.1},{x:.4375,y:.9833333333333333,w:.03125,h:.041666666666666664},{x:.4375,y:.9833333333333333,w:.05,h:.06666666666666667},{x:.4375,y:.9833333333333333,w:.075,h:.1},{x:.4625,y:.9833333333333333,w:.03125,h:.041666666666666664},{x:.4625,y:.9833333333333333,w:.05,h:.06666666666666667},{x:.4625,y:.9833333333333333,w:.075,h:.1},{x:.4875,y:.9833333333333333,w:.03125,h:.041666666666666664},{x:.4875,y:.9833333333333333,w:.05,h:.06666666666666667},{x:.4875,y:.9833333333333333,w:.075,h:.1},{x:.5125,y:.9833333333333333,w:.03125,h:.041666666666666664},{x:.5125,y:.9833333333333333,w:.05,h:.06666666666666667},{x:.5125,y:.9833333333333333,w:.075,h:.1},{x:.5375,y:.9833333333333333,w:.03125,h:.041666666666666664},{x:.5375,y:.9833333333333333,w:.05,h:.06666666666666667},{x:.5375,y:.9833333333333333,w:.075,h:.1},{x:.5625,y:.9833333333333333,w:.03125,h:.041666666666666664},{x:.5625,y:.9833333333333333,w:.05,h:.06666666666666667},{x:.5625,y:.9833333333333333,w:.075,h:.1},{x:.5875,y:.9833333333333333,w:.03125,h:.041666666666666664},{x:.5875,y:.9833333333333333,w:.05,h:.06666666666666667},{x:.5875,y:.9833333333333333,w:.075,h:.1},{x:.6125,y:.9833333333333333,w:.03125,h:.041666666666666664},{x:.6125,y:.9833333333333333,w:.05,h:.06666666666666667},{x:.6125,y:.9833333333333333,w:.075,h:.1},{x:.6375,y:.9833333333333333,w:.03125,h:.041666666666666664},{x:.6375,y:.9833333333333333,w:.05,h:.06666666666666667},{x:.6375,y:.9833333333333333,w:.075,h:.1},{x:.6625,y:.9833333333333333,w:.03125,h:.041666666666666664},{x:.6625,y:.9833333333333333,w:.05,h:.06666666666666667},{x:.6625,y:.9833333333333333,w:.075,h:.1},{x:.6875,y:.9833333333333333,w:.03125,h:.041666666666666664},{x:.6875,y:.9833333333333333,w:.05,h:.06666666666666667},{x:.6875,y:.9833333333333333,w:.075,h:.1},{x:.7125,y:.9833333333333333,w:.03125,h:.041666666666666664},{x:.7125,y:.9833333333333333,w:.05,h:.06666666666666667},{x:.7125,y:.9833333333333333,w:.075,h:.1},{x:.7375,y:.9833333333333333,w:.03125,h:.041666666666666664},{x:.7375,y:.9833333333333333,w:.05,h:.06666666666666667},{x:.7375,y:.9833333333333333,w:.075,h:.1},{x:.7625,y:.9833333333333333,w:.03125,h:.041666666666666664},{x:.7625,y:.9833333333333333,w:.05,h:.06666666666666667},{x:.7625,y:.9833333333333333,w:.075,h:.1},{x:.7875,y:.9833333333333333,w:.03125,h:.041666666666666664},{x:.7875,y:.9833333333333333,w:.05,h:.06666666666666667},{x:.7875,y:.9833333333333333,w:.075,h:.1},{x:.8125,y:.9833333333333333,w:.03125,h:.041666666666666664},{x:.8125,y:.9833333333333333,w:.05,h:.06666666666666667},{x:.8125,y:.9833333333333333,w:.075,h:.1},{x:.8375,y:.9833333333333333,w:.03125,h:.041666666666666664},{x:.8375,y:.9833333333333333,w:.05,h:.06666666666666667},{x:.8375,y:.9833333333333333,w:.075,h:.1},{x:.8625,y:.9833333333333333,w:.03125,h:.041666666666666664},{x:.8625,y:.9833333333333333,w:.05,h:.06666666666666667},{x:.8625,y:.9833333333333333,w:.075,h:.1},{x:.8875,y:.9833333333333333,w:.03125,h:.041666666666666664},{x:.8875,y:.9833333333333333,w:.05,h:.06666666666666667},{x:.8875,y:.9833333333333333,w:.075,h:.1},{x:.9125,y:.9833333333333333,w:.03125,h:.041666666666666664},{x:.9125,y:.9833333333333333,w:.05,h:.06666666666666667},{x:.9125,y:.9833333333333333,w:.075,h:.1},{x:.9375,y:.9833333333333333,w:.03125,h:.041666666666666664},{x:.9375,y:.9833333333333333,w:.05,h:.06666666666666667},{x:.9375,y:.9833333333333333,w:.075,h:.1},{x:.9625,y:.9833333333333333,w:.03125,h:.041666666666666664},{x:.9625,y:.9833333333333333,w:.05,h:.06666666666666667},{x:.9625,y:.9833333333333333,w:.075,h:.1},{x:.9875,y:.9833333333333333,w:.03125,h:.041666666666666664},{x:.9875,y:.9833333333333333,w:.05,h:.06666666666666667},{x:.9875,y:.9833333333333333,w:.075,h:.1},{x:.025,y:.03333333333333333,w:.1,h:.13333333333333333},{x:.025,y:.03333333333333333,w:.15,h:.2},{x:.075,y:.03333333333333333,w:.1,h:.13333333333333333},{x:.075,y:.03333333333333333,w:.15,h:.2},{x:.125,y:.03333333333333333,w:.1,h:.13333333333333333},{x:.125,y:.03333333333333333,w:.15,h:.2},{x:.175,y:.03333333333333333,w:.1,h:.13333333333333333},{x:.175,y:.03333333333333333,w:.15,h:.2},{x:.225,y:.03333333333333333,w:.1,h:.13333333333333333},{x:.225,y:.03333333333333333,w:.15,h:.2},{x:.275,y:.03333333333333333,w:.1,h:.13333333333333333},{x:.275,y:.03333333333333333,w:.15,h:.2},{x:.325,y:.03333333333333333,w:.1,h:.13333333333333333},{x:.325,y:.03333333333333333,w:.15,h:.2},{x:.375,y:.03333333333333333,w:.1,h:.13333333333333333},{x:.375,y:.03333333333333333,w:.15,h:.2},{x:.425,y:.03333333333333333,w:.1,h:.13333333333333333},{x:.425,y:.03333333333333333,w:.15,h:.2},{x:.475,y:.03333333333333333,w:.1,h:.13333333333333333},{x:.475,y:.03333333333333333,w:.15,h:.2},{x:.525,y:.03333333333333333,w:.1,h:.13333333333333333},{x:.525,y:.03333333333333333,w:.15,h:.2},{x:.575,y:.03333333333333333,w:.1,h:.13333333333333333},{x:.575,y:.03333333333333333,w:.15,h:.2},{x:.625,y:.03333333333333333,w:.1,h:.13333333333333333},{x:.625,y:.03333333333333333,w:.15,h:.2},{x:.675,y:.03333333333333333,w:.1,h:.13333333333333333},{x:.675,y:.03333333333333333,w:.15,h:.2},{x:.725,y:.03333333333333333,w:.1,h:.13333333333333333},{x:.725,y:.03333333333333333,w:.15,h:.2},{x:.775,y:.03333333333333333,w:.1,h:.13333333333333333},{x:.775,y:.03333333333333333,w:.15,h:.2},{x:.825,y:.03333333333333333,w:.1,h:.13333333333333333},{x:.825,y:.03333333333333333,w:.15,h:.2},{x:.875,y:.03333333333333333,w:.1,h:.13333333333333333},{x:.875,y:.03333333333333333,w:.15,h:.2},{x:.925,y:.03333333333333333,w:.1,h:.13333333333333333},{x:.925,y:.03333333333333333,w:.15,h:.2},{x:.975,y:.03333333333333333,w:.1,h:.13333333333333333},{x:.975,y:.03333333333333333,w:.15,h:.2},{x:.025,y:.1,w:.1,h:.13333333333333333},{x:.025,y:.1,w:.15,h:.2},{x:.075,y:.1,w:.1,h:.13333333333333333},{x:.075,y:.1,w:.15,h:.2},{x:.125,y:.1,w:.1,h:.13333333333333333},{x:.125,y:.1,w:.15,h:.2},{x:.175,y:.1,w:.1,h:.13333333333333333},{x:.175,y:.1,w:.15,h:.2},{x:.225,y:.1,w:.1,h:.13333333333333333},{x:.225,y:.1,w:.15,h:.2},{x:.275,y:.1,w:.1,h:.13333333333333333},{x:.275,y:.1,w:.15,h:.2},{x:.325,y:.1,w:.1,h:.13333333333333333},{x:.325,y:.1,w:.15,h:.2},{x:.375,y:.1,w:.1,h:.13333333333333333},{x:.375,y:.1,w:.15,h:.2},{x:.425,y:.1,w:.1,h:.13333333333333333},{x:.425,y:.1,w:.15,h:.2},{x:.475,y:.1,w:.1,h:.13333333333333333},{x:.475,y:.1,w:.15,h:.2},{x:.525,y:.1,w:.1,h:.13333333333333333},{x:.525,y:.1,w:.15,h:.2},{x:.575,y:.1,w:.1,h:.13333333333333333},{x:.575,y:.1,w:.15,h:.2},{x:.625,y:.1,w:.1,h:.13333333333333333},{x:.625,y:.1,w:.15,h:.2},{x:.675,y:.1,w:.1,h:.13333333333333333},{x:.675,y:.1,w:.15,h:.2},{x:.725,y:.1,w:.1,h:.13333333333333333},{x:.725,y:.1,w:.15,h:.2},{x:.775,y:.1,w:.1,h:.13333333333333333},{x:.775,y:.1,w:.15,h:.2},{x:.825,y:.1,w:.1,h:.13333333333333333},{x:.825,y:.1,w:.15,h:.2},{x:.875,y:.1,w:.1,h:.13333333333333333},{x:.875,y:.1,w:.15,h:.2},{x:.925,y:.1,w:.1,h:.13333333333333333},{x:.925,y:.1,w:.15,h:.2},{x:.975,y:.1,w:.1,h:.13333333333333333},{x:.975,y:.1,w:.15,h:.2},{x:.025,y:.16666666666666666,w:.1,h:.13333333333333333},{x:.025,y:.16666666666666666,w:.15,h:.2},{x:.075,y:.16666666666666666,w:.1,h:.13333333333333333},{x:.075,y:.16666666666666666,w:.15,h:.2},{x:.125,y:.16666666666666666,w:.1,h:.13333333333333333},{x:.125,y:.16666666666666666,w:.15,h:.2},{x:.175,y:.16666666666666666,w:.1,h:.13333333333333333},{x:.175,y:.16666666666666666,w:.15,h:.2},{x:.225,y:.16666666666666666,w:.1,h:.13333333333333333},{x:.225,y:.16666666666666666,w:.15,h:.2},{x:.275,y:.16666666666666666,w:.1,h:.13333333333333333},{x:.275,y:.16666666666666666,w:.15,h:.2},{x:.325,y:.16666666666666666,w:.1,h:.13333333333333333},{x:.325,y:.16666666666666666,w:.15,h:.2},{x:.375,y:.16666666666666666,w:.1,h:.13333333333333333},{x:.375,y:.16666666666666666,w:.15,h:.2},{x:.425,y:.16666666666666666,w:.1,h:.13333333333333333},{x:.425,y:.16666666666666666,w:.15,h:.2},{x:.475,y:.16666666666666666,w:.1,h:.13333333333333333},{x:.475,y:.16666666666666666,w:.15,h:.2},{x:.525,y:.16666666666666666,w:.1,h:.13333333333333333},{x:.525,y:.16666666666666666,w:.15,h:.2},{x:.575,y:.16666666666666666,w:.1,h:.13333333333333333},{x:.575,y:.16666666666666666,w:.15,h:.2},{x:.625,y:.16666666666666666,w:.1,h:.13333333333333333},{x:.625,y:.16666666666666666,w:.15,h:.2},{x:.675,y:.16666666666666666,w:.1,h:.13333333333333333},{x:.675,y:.16666666666666666,w:.15,h:.2},{x:.725,y:.16666666666666666,w:.1,h:.13333333333333333},{x:.725,y:.16666666666666666,w:.15,h:.2},{x:.775,y:.16666666666666666,w:.1,h:.13333333333333333},{x:.775,y:.16666666666666666,w:.15,h:.2},{x:.825,y:.16666666666666666,w:.1,h:.13333333333333333},{x:.825,y:.16666666666666666,w:.15,h:.2},{x:.875,y:.16666666666666666,w:.1,h:.13333333333333333},{x:.875,y:.16666666666666666,w:.15,h:.2},{x:.925,y:.16666666666666666,w:.1,h:.13333333333333333},{x:.925,y:.16666666666666666,w:.15,h:.2},{x:.975,y:.16666666666666666,w:.1,h:.13333333333333333},{x:.975,y:.16666666666666666,w:.15,h:.2},{x:.025,y:.23333333333333334,w:.1,h:.13333333333333333},{x:.025,y:.23333333333333334,w:.15,h:.2},{x:.075,y:.23333333333333334,w:.1,h:.13333333333333333},{x:.075,y:.23333333333333334,w:.15,h:.2},{x:.125,y:.23333333333333334,w:.1,h:.13333333333333333},{x:.125,y:.23333333333333334,w:.15,h:.2},{x:.175,y:.23333333333333334,w:.1,h:.13333333333333333},{x:.175,y:.23333333333333334,w:.15,h:.2},{x:.225,y:.23333333333333334,w:.1,h:.13333333333333333},{x:.225,y:.23333333333333334,w:.15,h:.2},{x:.275,y:.23333333333333334,w:.1,h:.13333333333333333},{x:.275,y:.23333333333333334,w:.15,h:.2},{x:.325,y:.23333333333333334,w:.1,h:.13333333333333333},{x:.325,y:.23333333333333334,w:.15,h:.2},{x:.375,y:.23333333333333334,w:.1,h:.13333333333333333},{x:.375,y:.23333333333333334,w:.15,h:.2},{x:.425,y:.23333333333333334,w:.1,h:.13333333333333333},{x:.425,y:.23333333333333334,w:.15,h:.2},{x:.475,y:.23333333333333334,w:.1,h:.13333333333333333},{x:.475,y:.23333333333333334,w:.15,h:.2},{x:.525,y:.23333333333333334,w:.1,h:.13333333333333333},{x:.525,y:.23333333333333334,w:.15,h:.2},{x:.575,y:.23333333333333334,w:.1,h:.13333333333333333},{x:.575,y:.23333333333333334,w:.15,h:.2},{x:.625,y:.23333333333333334,w:.1,h:.13333333333333333},{x:.625,y:.23333333333333334,w:.15,h:.2},{x:.675,y:.23333333333333334,w:.1,h:.13333333333333333},{x:.675,y:.23333333333333334,w:.15,h:.2},{x:.725,y:.23333333333333334,w:.1,h:.13333333333333333},{x:.725,y:.23333333333333334,w:.15,h:.2},{x:.775,y:.23333333333333334,w:.1,h:.13333333333333333},{x:.775,y:.23333333333333334,w:.15,h:.2},{x:.825,y:.23333333333333334,w:.1,h:.13333333333333333},{x:.825,y:.23333333333333334,w:.15,h:.2},{x:.875,y:.23333333333333334,w:.1,h:.13333333333333333},{x:.875,y:.23333333333333334,w:.15,h:.2},{x:.925,y:.23333333333333334,w:.1,h:.13333333333333333},{x:.925,y:.23333333333333334,w:.15,h:.2},{x:.975,y:.23333333333333334,w:.1,h:.13333333333333333},{x:.975,y:.23333333333333334,w:.15,h:.2},{x:.025,y:.3,w:.1,h:.13333333333333333},{x:.025,y:.3,w:.15,h:.2},{x:.075,y:.3,w:.1,h:.13333333333333333},{x:.075,y:.3,w:.15,h:.2},{x:.125,y:.3,w:.1,h:.13333333333333333},{x:.125,y:.3,w:.15,h:.2},{x:.175,y:.3,w:.1,h:.13333333333333333},{x:.175,y:.3,w:.15,h:.2},{x:.225,y:.3,w:.1,h:.13333333333333333},{x:.225,y:.3,w:.15,h:.2},{x:.275,y:.3,w:.1,h:.13333333333333333},{x:.275,y:.3,w:.15,h:.2},{x:.325,y:.3,w:.1,h:.13333333333333333},{x:.325,y:.3,w:.15,h:.2},{x:.375,y:.3,w:.1,h:.13333333333333333},{x:.375,y:.3,w:.15,h:.2},{x:.425,y:.3,w:.1,h:.13333333333333333},{x:.425,y:.3,w:.15,h:.2},{x:.475,y:.3,w:.1,h:.13333333333333333},{x:.475,y:.3,w:.15,h:.2},{x:.525,y:.3,w:.1,h:.13333333333333333},{x:.525,y:.3,w:.15,h:.2},{x:.575,y:.3,w:.1,h:.13333333333333333},{x:.575,y:.3,w:.15,h:.2},{x:.625,y:.3,w:.1,h:.13333333333333333},{x:.625,y:.3,w:.15,h:.2},{x:.675,y:.3,w:.1,h:.13333333333333333},{x:.675,y:.3,w:.15,h:.2},{x:.725,y:.3,w:.1,h:.13333333333333333},{x:.725,y:.3,w:.15,h:.2},{x:.775,y:.3,w:.1,h:.13333333333333333},{x:.775,y:.3,w:.15,h:.2},{x:.825,y:.3,w:.1,h:.13333333333333333},{x:.825,y:.3,w:.15,h:.2},{x:.875,y:.3,w:.1,h:.13333333333333333},{x:.875,y:.3,w:.15,h:.2},{x:.925,y:.3,w:.1,h:.13333333333333333},{x:.925,y:.3,w:.15,h:.2},{x:.975,y:.3,w:.1,h:.13333333333333333},{x:.975,y:.3,w:.15,h:.2},{x:.025,y:.36666666666666664,w:.1,h:.13333333333333333},{x:.025,y:.36666666666666664,w:.15,h:.2},{x:.075,y:.36666666666666664,w:.1,h:.13333333333333333},{x:.075,y:.36666666666666664,w:.15,h:.2},{x:.125,y:.36666666666666664,w:.1,h:.13333333333333333},{x:.125,y:.36666666666666664,w:.15,h:.2},{x:.175,y:.36666666666666664,w:.1,h:.13333333333333333},{x:.175,y:.36666666666666664,w:.15,h:.2},{x:.225,y:.36666666666666664,w:.1,h:.13333333333333333},{x:.225,y:.36666666666666664,w:.15,h:.2},{x:.275,y:.36666666666666664,w:.1,h:.13333333333333333},{x:.275,y:.36666666666666664,w:.15,h:.2},{x:.325,y:.36666666666666664,w:.1,h:.13333333333333333},{x:.325,y:.36666666666666664,w:.15,h:.2},{x:.375,y:.36666666666666664,w:.1,h:.13333333333333333},{x:.375,y:.36666666666666664,w:.15,h:.2},{x:.425,y:.36666666666666664,w:.1,h:.13333333333333333},{x:.425,y:.36666666666666664,w:.15,h:.2},{x:.475,y:.36666666666666664,w:.1,h:.13333333333333333},{x:.475,y:.36666666666666664,w:.15,h:.2},{x:.525,y:.36666666666666664,w:.1,h:.13333333333333333},{x:.525,y:.36666666666666664,w:.15,h:.2},{x:.575,y:.36666666666666664,w:.1,h:.13333333333333333},{x:.575,y:.36666666666666664,w:.15,h:.2},{x:.625,y:.36666666666666664,w:.1,h:.13333333333333333},{x:.625,y:.36666666666666664,w:.15,h:.2},{x:.675,y:.36666666666666664,w:.1,h:.13333333333333333},{x:.675,y:.36666666666666664,w:.15,h:.2},{x:.725,y:.36666666666666664,w:.1,h:.13333333333333333},{x:.725,y:.36666666666666664,w:.15,h:.2},{x:.775,y:.36666666666666664,w:.1,h:.13333333333333333},{x:.775,y:.36666666666666664,w:.15,h:.2},{x:.825,y:.36666666666666664,w:.1,h:.13333333333333333},{x:.825,y:.36666666666666664,w:.15,h:.2},{x:.875,y:.36666666666666664,w:.1,h:.13333333333333333},{x:.875,y:.36666666666666664,w:.15,h:.2},{x:.925,y:.36666666666666664,w:.1,h:.13333333333333333},{x:.925,y:.36666666666666664,w:.15,h:.2},{x:.975,y:.36666666666666664,w:.1,h:.13333333333333333},{x:.975,y:.36666666666666664,w:.15,h:.2},{x:.025,y:.43333333333333335,w:.1,h:.13333333333333333},{x:.025,y:.43333333333333335,w:.15,h:.2},{x:.075,y:.43333333333333335,w:.1,h:.13333333333333333},{x:.075,y:.43333333333333335,w:.15,h:.2},{x:.125,y:.43333333333333335,w:.1,h:.13333333333333333},{x:.125,y:.43333333333333335,w:.15,h:.2},{x:.175,y:.43333333333333335,w:.1,h:.13333333333333333},{x:.175,y:.43333333333333335,w:.15,h:.2},{x:.225,y:.43333333333333335,w:.1,h:.13333333333333333},{x:.225,y:.43333333333333335,w:.15,h:.2},{x:.275,y:.43333333333333335,w:.1,h:.13333333333333333},{x:.275,y:.43333333333333335,w:.15,h:.2},{x:.325,y:.43333333333333335,w:.1,h:.13333333333333333},{x:.325,y:.43333333333333335,w:.15,h:.2},{x:.375,y:.43333333333333335,w:.1,h:.13333333333333333},{x:.375,y:.43333333333333335,w:.15,h:.2},{x:.425,y:.43333333333333335,w:.1,h:.13333333333333333},{x:.425,y:.43333333333333335,w:.15,h:.2},{x:.475,y:.43333333333333335,w:.1,h:.13333333333333333},{x:.475,y:.43333333333333335,w:.15,h:.2},{x:.525,y:.43333333333333335,w:.1,h:.13333333333333333},{x:.525,y:.43333333333333335,w:.15,h:.2},{x:.575,y:.43333333333333335,w:.1,h:.13333333333333333},{x:.575,y:.43333333333333335,w:.15,h:.2},{x:.625,y:.43333333333333335,w:.1,h:.13333333333333333},{x:.625,y:.43333333333333335,w:.15,h:.2},{x:.675,y:.43333333333333335,w:.1,h:.13333333333333333},{x:.675,y:.43333333333333335,w:.15,h:.2},{x:.725,y:.43333333333333335,w:.1,h:.13333333333333333},{x:.725,y:.43333333333333335,w:.15,h:.2},{x:.775,y:.43333333333333335,w:.1,h:.13333333333333333},{x:.775,y:.43333333333333335,w:.15,h:.2},{x:.825,y:.43333333333333335,w:.1,h:.13333333333333333},{x:.825,y:.43333333333333335,w:.15,h:.2},{x:.875,y:.43333333333333335,w:.1,h:.13333333333333333},{x:.875,y:.43333333333333335,w:.15,h:.2},{x:.925,y:.43333333333333335,w:.1,h:.13333333333333333},{x:.925,y:.43333333333333335,w:.15,h:.2},{x:.975,y:.43333333333333335,w:.1,h:.13333333333333333},{x:.975,y:.43333333333333335,w:.15,h:.2},{x:.025,y:.5,w:.1,h:.13333333333333333},{x:.025,y:.5,w:.15,h:.2},{x:.075,y:.5,w:.1,h:.13333333333333333},{x:.075,y:.5,w:.15,h:.2},{x:.125,y:.5,w:.1,h:.13333333333333333},{x:.125,y:.5,w:.15,h:.2},{x:.175,y:.5,w:.1,h:.13333333333333333},{x:.175,y:.5,w:.15,h:.2},{x:.225,y:.5,w:.1,h:.13333333333333333},{x:.225,y:.5,w:.15,h:.2},{x:.275,y:.5,w:.1,h:.13333333333333333},{x:.275,y:.5,w:.15,h:.2},{x:.325,y:.5,w:.1,h:.13333333333333333},{x:.325,y:.5,w:.15,h:.2},{x:.375,y:.5,w:.1,h:.13333333333333333},{x:.375,y:.5,w:.15,h:.2},{x:.425,y:.5,w:.1,h:.13333333333333333},{x:.425,y:.5,w:.15,h:.2},{x:.475,y:.5,w:.1,h:.13333333333333333},{x:.475,y:.5,w:.15,h:.2},{x:.525,y:.5,w:.1,h:.13333333333333333},{x:.525,y:.5,w:.15,h:.2},{x:.575,y:.5,w:.1,h:.13333333333333333},{x:.575,y:.5,w:.15,h:.2},{x:.625,y:.5,w:.1,h:.13333333333333333},{x:.625,y:.5,w:.15,h:.2},{x:.675,y:.5,w:.1,h:.13333333333333333},{x:.675,y:.5,w:.15,h:.2},{x:.725,y:.5,w:.1,h:.13333333333333333},{x:.725,y:.5,w:.15,h:.2},{x:.775,y:.5,w:.1,h:.13333333333333333},{x:.775,y:.5,w:.15,h:.2},{x:.825,y:.5,w:.1,h:.13333333333333333},{x:.825,y:.5,w:.15,h:.2},{x:.875,y:.5,w:.1,h:.13333333333333333},{x:.875,y:.5,w:.15,h:.2},{x:.925,y:.5,w:.1,h:.13333333333333333},{x:.925,y:.5,w:.15,h:.2},{x:.975,y:.5,w:.1,h:.13333333333333333},{x:.975,y:.5,w:.15,h:.2},{x:.025,y:.5666666666666667,w:.1,h:.13333333333333333},{x:.025,y:.5666666666666667,w:.15,h:.2},{x:.075,y:.5666666666666667,w:.1,h:.13333333333333333},{x:.075,y:.5666666666666667,w:.15,h:.2},{x:.125,y:.5666666666666667,w:.1,h:.13333333333333333},{x:.125,y:.5666666666666667,w:.15,h:.2},{x:.175,y:.5666666666666667,w:.1,h:.13333333333333333},{x:.175,y:.5666666666666667,w:.15,h:.2},{x:.225,y:.5666666666666667,w:.1,h:.13333333333333333},{x:.225,y:.5666666666666667,w:.15,h:.2},{x:.275,y:.5666666666666667,w:.1,h:.13333333333333333},{x:.275,y:.5666666666666667,w:.15,h:.2},{x:.325,y:.5666666666666667,w:.1,h:.13333333333333333},{x:.325,y:.5666666666666667,w:.15,h:.2},{x:.375,y:.5666666666666667,w:.1,h:.13333333333333333},{x:.375,y:.5666666666666667,w:.15,h:.2},{x:.425,y:.5666666666666667,w:.1,h:.13333333333333333},{x:.425,y:.5666666666666667,w:.15,h:.2},{x:.475,y:.5666666666666667,w:.1,h:.13333333333333333},{x:.475,y:.5666666666666667,w:.15,h:.2},{x:.525,y:.5666666666666667,w:.1,h:.13333333333333333},{x:.525,y:.5666666666666667,w:.15,h:.2},{x:.575,y:.5666666666666667,w:.1,h:.13333333333333333},{x:.575,y:.5666666666666667,w:.15,h:.2},{x:.625,y:.5666666666666667,w:.1,h:.13333333333333333},{x:.625,y:.5666666666666667,w:.15,h:.2},{x:.675,y:.5666666666666667,w:.1,h:.13333333333333333},{x:.675,y:.5666666666666667,w:.15,h:.2},{x:.725,y:.5666666666666667,w:.1,h:.13333333333333333},{x:.725,y:.5666666666666667,w:.15,h:.2},{x:.775,y:.5666666666666667,w:.1,h:.13333333333333333},{x:.775,y:.5666666666666667,w:.15,h:.2},{x:.825,y:.5666666666666667,w:.1,h:.13333333333333333},{x:.825,y:.5666666666666667,w:.15,h:.2},{x:.875,y:.5666666666666667,w:.1,h:.13333333333333333},{x:.875,y:.5666666666666667,w:.15,h:.2},{x:.925,y:.5666666666666667,w:.1,h:.13333333333333333},{x:.925,y:.5666666666666667,w:.15,h:.2},{x:.975,y:.5666666666666667,w:.1,h:.13333333333333333},{x:.975,y:.5666666666666667,w:.15,h:.2},{x:.025,y:.6333333333333333,w:.1,h:.13333333333333333},{x:.025,y:.6333333333333333,w:.15,h:.2},{x:.075,y:.6333333333333333,w:.1,h:.13333333333333333},{x:.075,y:.6333333333333333,w:.15,h:.2},{x:.125,y:.6333333333333333,w:.1,h:.13333333333333333},{x:.125,y:.6333333333333333,w:.15,h:.2},{x:.175,y:.6333333333333333,w:.1,h:.13333333333333333},{x:.175,y:.6333333333333333,w:.15,h:.2},{x:.225,y:.6333333333333333,w:.1,h:.13333333333333333},{x:.225,y:.6333333333333333,w:.15,h:.2},{x:.275,y:.6333333333333333,w:.1,h:.13333333333333333},{x:.275,y:.6333333333333333,w:.15,h:.2},{x:.325,y:.6333333333333333,w:.1,h:.13333333333333333},{x:.325,y:.6333333333333333,w:.15,h:.2},{x:.375,y:.6333333333333333,w:.1,h:.13333333333333333},{x:.375,y:.6333333333333333,w:.15,h:.2},{x:.425,y:.6333333333333333,w:.1,h:.13333333333333333},{x:.425,y:.6333333333333333,w:.15,h:.2},{x:.475,y:.6333333333333333,w:.1,h:.13333333333333333},{x:.475,y:.6333333333333333,w:.15,h:.2},{x:.525,y:.6333333333333333,w:.1,h:.13333333333333333},{x:.525,y:.6333333333333333,w:.15,h:.2},{x:.575,y:.6333333333333333,w:.1,h:.13333333333333333},{x:.575,y:.6333333333333333,w:.15,h:.2},{x:.625,y:.6333333333333333,w:.1,h:.13333333333333333},{x:.625,y:.6333333333333333,w:.15,h:.2},{x:.675,y:.6333333333333333,w:.1,h:.13333333333333333},{x:.675,y:.6333333333333333,w:.15,h:.2},{x:.725,y:.6333333333333333,w:.1,h:.13333333333333333},{x:.725,y:.6333333333333333,w:.15,h:.2},{x:.775,y:.6333333333333333,w:.1,h:.13333333333333333},{x:.775,y:.6333333333333333,w:.15,h:.2},{x:.825,y:.6333333333333333,w:.1,h:.13333333333333333},{x:.825,y:.6333333333333333,w:.15,h:.2},{x:.875,y:.6333333333333333,w:.1,h:.13333333333333333},{x:.875,y:.6333333333333333,w:.15,h:.2},{x:.925,y:.6333333333333333,w:.1,h:.13333333333333333},{x:.925,y:.6333333333333333,w:.15,h:.2},{x:.975,y:.6333333333333333,w:.1,h:.13333333333333333},{x:.975,y:.6333333333333333,w:.15,h:.2},{x:.025,y:.7,w:.1,h:.13333333333333333},{x:.025,y:.7,w:.15,h:.2},{x:.075,y:.7,w:.1,h:.13333333333333333},{x:.075,y:.7,w:.15,h:.2},{x:.125,y:.7,w:.1,h:.13333333333333333},{x:.125,y:.7,w:.15,h:.2},{x:.175,y:.7,w:.1,h:.13333333333333333},{x:.175,y:.7,w:.15,h:.2},{x:.225,y:.7,w:.1,h:.13333333333333333},{x:.225,y:.7,w:.15,h:.2},{x:.275,y:.7,w:.1,h:.13333333333333333},{x:.275,y:.7,w:.15,h:.2},{x:.325,y:.7,w:.1,h:.13333333333333333},{x:.325,y:.7,w:.15,h:.2},{x:.375,y:.7,w:.1,h:.13333333333333333},{x:.375,y:.7,w:.15,h:.2},{x:.425,y:.7,w:.1,h:.13333333333333333},{x:.425,y:.7,w:.15,h:.2},{x:.475,y:.7,w:.1,h:.13333333333333333},{x:.475,y:.7,w:.15,h:.2},{x:.525,y:.7,w:.1,h:.13333333333333333},{x:.525,y:.7,w:.15,h:.2},{x:.575,y:.7,w:.1,h:.13333333333333333},{x:.575,y:.7,w:.15,h:.2},{x:.625,y:.7,w:.1,h:.13333333333333333},{x:.625,y:.7,w:.15,h:.2},{x:.675,y:.7,w:.1,h:.13333333333333333},{x:.675,y:.7,w:.15,h:.2},{x:.725,y:.7,w:.1,h:.13333333333333333},{x:.725,y:.7,w:.15,h:.2},{x:.775,y:.7,w:.1,h:.13333333333333333},{x:.775,y:.7,w:.15,h:.2},{x:.825,y:.7,w:.1,h:.13333333333333333},{x:.825,y:.7,w:.15,h:.2},{x:.875,y:.7,w:.1,h:.13333333333333333},{x:.875,y:.7,w:.15,h:.2},{x:.925,y:.7,w:.1,h:.13333333333333333},{x:.925,y:.7,w:.15,h:.2},{x:.975,y:.7,w:.1,h:.13333333333333333},{x:.975,y:.7,w:.15,h:.2},{x:.025,y:.7666666666666667,w:.1,h:.13333333333333333},{x:.025,y:.7666666666666667,w:.15,h:.2},{x:.075,y:.7666666666666667,w:.1,h:.13333333333333333},{x:.075,y:.7666666666666667,w:.15,h:.2},{x:.125,y:.7666666666666667,w:.1,h:.13333333333333333},{x:.125,y:.7666666666666667,w:.15,h:.2},{x:.175,y:.7666666666666667,w:.1,h:.13333333333333333},{x:.175,y:.7666666666666667,w:.15,h:.2},{x:.225,y:.7666666666666667,w:.1,h:.13333333333333333},{x:.225,y:.7666666666666667,w:.15,h:.2},{x:.275,y:.7666666666666667,w:.1,h:.13333333333333333},{x:.275,y:.7666666666666667,w:.15,h:.2},{x:.325,y:.7666666666666667,w:.1,h:.13333333333333333},{x:.325,y:.7666666666666667,w:.15,h:.2},{x:.375,y:.7666666666666667,w:.1,h:.13333333333333333},{x:.375,y:.7666666666666667,w:.15,h:.2},{x:.425,y:.7666666666666667,w:.1,h:.13333333333333333},{x:.425,y:.7666666666666667,w:.15,h:.2},{x:.475,y:.7666666666666667,w:.1,h:.13333333333333333},{x:.475,y:.7666666666666667,w:.15,h:.2},{x:.525,y:.7666666666666667,w:.1,h:.13333333333333333},{x:.525,y:.7666666666666667,w:.15,h:.2},{x:.575,y:.7666666666666667,w:.1,h:.13333333333333333},{x:.575,y:.7666666666666667,w:.15,h:.2},{x:.625,y:.7666666666666667,w:.1,h:.13333333333333333},{x:.625,y:.7666666666666667,w:.15,h:.2},{x:.675,y:.7666666666666667,w:.1,h:.13333333333333333},{x:.675,y:.7666666666666667,w:.15,h:.2},{x:.725,y:.7666666666666667,w:.1,h:.13333333333333333},{x:.725,y:.7666666666666667,w:.15,h:.2},{x:.775,y:.7666666666666667,w:.1,h:.13333333333333333},{x:.775,y:.7666666666666667,w:.15,h:.2},{x:.825,y:.7666666666666667,w:.1,h:.13333333333333333},{x:.825,y:.7666666666666667,w:.15,h:.2},{x:.875,y:.7666666666666667,w:.1,h:.13333333333333333},{x:.875,y:.7666666666666667,w:.15,h:.2},{x:.925,y:.7666666666666667,w:.1,h:.13333333333333333},{x:.925,y:.7666666666666667,w:.15,h:.2},{x:.975,y:.7666666666666667,w:.1,h:.13333333333333333},{x:.975,y:.7666666666666667,w:.15,h:.2},{x:.025,y:.8333333333333334,w:.1,h:.13333333333333333},{x:.025,y:.8333333333333334,w:.15,h:.2},{x:.075,y:.8333333333333334,w:.1,h:.13333333333333333},{x:.075,y:.8333333333333334,w:.15,h:.2},{x:.125,y:.8333333333333334,w:.1,h:.13333333333333333},{x:.125,y:.8333333333333334,w:.15,h:.2},{x:.175,y:.8333333333333334,w:.1,h:.13333333333333333},{x:.175,y:.8333333333333334,w:.15,h:.2},{x:.225,y:.8333333333333334,w:.1,h:.13333333333333333},{x:.225,y:.8333333333333334,w:.15,h:.2},{x:.275,y:.8333333333333334,w:.1,h:.13333333333333333},{x:.275,y:.8333333333333334,w:.15,h:.2},{x:.325,y:.8333333333333334,w:.1,h:.13333333333333333},{x:.325,y:.8333333333333334,w:.15,h:.2},{x:.375,y:.8333333333333334,w:.1,h:.13333333333333333},{x:.375,y:.8333333333333334,w:.15,h:.2},{x:.425,y:.8333333333333334,w:.1,h:.13333333333333333},{x:.425,y:.8333333333333334,w:.15,h:.2},{x:.475,y:.8333333333333334,w:.1,h:.13333333333333333},{x:.475,y:.8333333333333334,w:.15,h:.2},{x:.525,y:.8333333333333334,w:.1,h:.13333333333333333},{x:.525,y:.8333333333333334,w:.15,h:.2},{x:.575,y:.8333333333333334,w:.1,h:.13333333333333333},{x:.575,y:.8333333333333334,w:.15,h:.2},{x:.625,y:.8333333333333334,w:.1,h:.13333333333333333},{x:.625,y:.8333333333333334,w:.15,h:.2},{x:.675,y:.8333333333333334,w:.1,h:.13333333333333333},{x:.675,y:.8333333333333334,w:.15,h:.2},{x:.725,y:.8333333333333334,w:.1,h:.13333333333333333},{x:.725,y:.8333333333333334,w:.15,h:.2},{x:.775,y:.8333333333333334,w:.1,h:.13333333333333333},{x:.775,y:.8333333333333334,w:.15,h:.2},{x:.825,y:.8333333333333334,w:.1,h:.13333333333333333},{x:.825,y:.8333333333333334,w:.15,h:.2},{x:.875,y:.8333333333333334,w:.1,h:.13333333333333333},{x:.875,y:.8333333333333334,w:.15,h:.2},{x:.925,y:.8333333333333334,w:.1,h:.13333333333333333},{x:.925,y:.8333333333333334,w:.15,h:.2},{x:.975,y:.8333333333333334,w:.1,h:.13333333333333333},{x:.975,y:.8333333333333334,w:.15,h:.2},{x:.025,y:.9,w:.1,h:.13333333333333333},{x:.025,y:.9,w:.15,h:.2},{x:.075,y:.9,w:.1,h:.13333333333333333},{x:.075,y:.9,w:.15,h:.2},{x:.125,y:.9,w:.1,h:.13333333333333333},{x:.125,y:.9,w:.15,h:.2},{x:.175,y:.9,w:.1,h:.13333333333333333},{x:.175,y:.9,w:.15,h:.2},{x:.225,y:.9,w:.1,h:.13333333333333333},{x:.225,y:.9,w:.15,h:.2},{x:.275,y:.9,w:.1,h:.13333333333333333},{x:.275,y:.9,w:.15,h:.2},{x:.325,y:.9,w:.1,h:.13333333333333333},{x:.325,y:.9,w:.15,h:.2},{x:.375,y:.9,w:.1,h:.13333333333333333},{x:.375,y:.9,w:.15,h:.2},{x:.425,y:.9,w:.1,h:.13333333333333333},{x:.425,y:.9,w:.15,h:.2},{x:.475,y:.9,w:.1,h:.13333333333333333},{x:.475,y:.9,w:.15,h:.2},{x:.525,y:.9,w:.1,h:.13333333333333333},{x:.525,y:.9,w:.15,h:.2},{x:.575,y:.9,w:.1,h:.13333333333333333},{x:.575,y:.9,w:.15,h:.2},{x:.625,y:.9,w:.1,h:.13333333333333333},{x:.625,y:.9,w:.15,h:.2},{x:.675,y:.9,w:.1,h:.13333333333333333},{x:.675,y:.9,w:.15,h:.2},{x:.725,y:.9,w:.1,h:.13333333333333333},{x:.725,y:.9,w:.15,h:.2},{x:.775,y:.9,w:.1,h:.13333333333333333},{x:.775,y:.9,w:.15,h:.2},{x:.825,y:.9,w:.1,h:.13333333333333333},{x:.825,y:.9,w:.15,h:.2},{x:.875,y:.9,w:.1,h:.13333333333333333},{x:.875,y:.9,w:.15,h:.2},{x:.925,y:.9,w:.1,h:.13333333333333333},{x:.925,y:.9,w:.15,h:.2},{x:.975,y:.9,w:.1,h:.13333333333333333},{x:.975,y:.9,w:.15,h:.2},{x:.025,y:.9666666666666667,w:.1,h:.13333333333333333},{x:.025,y:.9666666666666667,w:.15,h:.2},{x:.075,y:.9666666666666667,w:.1,h:.13333333333333333},{x:.075,y:.9666666666666667,w:.15,h:.2},{x:.125,y:.9666666666666667,w:.1,h:.13333333333333333},{x:.125,y:.9666666666666667,w:.15,h:.2},{x:.175,y:.9666666666666667,w:.1,h:.13333333333333333},{x:.175,y:.9666666666666667,w:.15,h:.2},{x:.225,y:.9666666666666667,w:.1,h:.13333333333333333},{x:.225,y:.9666666666666667,w:.15,h:.2},{x:.275,y:.9666666666666667,w:.1,h:.13333333333333333},{x:.275,y:.9666666666666667,w:.15,h:.2},{x:.325,y:.9666666666666667,w:.1,h:.13333333333333333},{x:.325,y:.9666666666666667,w:.15,h:.2},{x:.375,y:.9666666666666667,w:.1,h:.13333333333333333},{x:.375,y:.9666666666666667,w:.15,h:.2},{x:.425,y:.9666666666666667,w:.1,h:.13333333333333333},{x:.425,y:.9666666666666667,w:.15,h:.2},{x:.475,y:.9666666666666667,w:.1,h:.13333333333333333},{x:.475,y:.9666666666666667,w:.15,h:.2},{x:.525,y:.9666666666666667,w:.1,h:.13333333333333333},{x:.525,y:.9666666666666667,w:.15,h:.2},{x:.575,y:.9666666666666667,w:.1,h:.13333333333333333},{x:.575,y:.9666666666666667,w:.15,h:.2},{x:.625,y:.9666666666666667,w:.1,h:.13333333333333333},{x:.625,y:.9666666666666667,w:.15,h:.2},{x:.675,y:.9666666666666667,w:.1,h:.13333333333333333},{x:.675,y:.9666666666666667,w:.15,h:.2},{x:.725,y:.9666666666666667,w:.1,h:.13333333333333333},{x:.725,y:.9666666666666667,w:.15,h:.2},{x:.775,y:.9666666666666667,w:.1,h:.13333333333333333},{x:.775,y:.9666666666666667,w:.15,h:.2},{x:.825,y:.9666666666666667,w:.1,h:.13333333333333333},{x:.825,y:.9666666666666667,w:.15,h:.2},{x:.875,y:.9666666666666667,w:.1,h:.13333333333333333},{x:.875,y:.9666666666666667,w:.15,h:.2},{x:.925,y:.9666666666666667,w:.1,h:.13333333333333333},{x:.925,y:.9666666666666667,w:.15,h:.2},{x:.975,y:.9666666666666667,w:.1,h:.13333333333333333},{x:.975,y:.9666666666666667,w:.15,h:.2},{x:.05,y:.06666666666666667,w:.2,h:.26666666666666666},{x:.05,y:.06666666666666667,w:.3,h:.4},{x:.15,y:.06666666666666667,w:.2,h:.26666666666666666},{x:.15,y:.06666666666666667,w:.3,h:.4},{x:.25,y:.06666666666666667,w:.2,h:.26666666666666666},{x:.25,y:.06666666666666667,w:.3,h:.4},{x:.35,y:.06666666666666667,w:.2,h:.26666666666666666},{x:.35,y:.06666666666666667,w:.3,h:.4},{x:.45,y:.06666666666666667,w:.2,h:.26666666666666666},{x:.45,y:.06666666666666667,w:.3,h:.4},{x:.55,y:.06666666666666667,w:.2,h:.26666666666666666},{x:.55,y:.06666666666666667,w:.3,h:.4},{x:.65,y:.06666666666666667,w:.2,h:.26666666666666666},{x:.65,y:.06666666666666667,w:.3,h:.4},{x:.75,y:.06666666666666667,w:.2,h:.26666666666666666},{x:.75,y:.06666666666666667,w:.3,h:.4},{x:.85,y:.06666666666666667,w:.2,h:.26666666666666666},{x:.85,y:.06666666666666667,w:.3,h:.4},{x:.95,y:.06666666666666667,w:.2,h:.26666666666666666},{x:.95,y:.06666666666666667,w:.3,h:.4},{x:.05,y:.2,w:.2,h:.26666666666666666},{x:.05,y:.2,w:.3,h:.4},{x:.15,y:.2,w:.2,h:.26666666666666666},{x:.15,y:.2,w:.3,h:.4},{x:.25,y:.2,w:.2,h:.26666666666666666},{x:.25,y:.2,w:.3,h:.4},{x:.35,y:.2,w:.2,h:.26666666666666666},{x:.35,y:.2,w:.3,h:.4},{x:.45,y:.2,w:.2,h:.26666666666666666},{x:.45,y:.2,w:.3,h:.4},{x:.55,y:.2,w:.2,h:.26666666666666666},{x:.55,y:.2,w:.3,h:.4},{x:.65,y:.2,w:.2,h:.26666666666666666},{x:.65,y:.2,w:.3,h:.4},{x:.75,y:.2,w:.2,h:.26666666666666666},{x:.75,y:.2,w:.3,h:.4},{x:.85,y:.2,w:.2,h:.26666666666666666},{x:.85,y:.2,w:.3,h:.4},{x:.95,y:.2,w:.2,h:.26666666666666666},{x:.95,y:.2,w:.3,h:.4},{x:.05,y:.3333333333333333,w:.2,h:.26666666666666666},{x:.05,y:.3333333333333333,w:.3,h:.4},{x:.15,y:.3333333333333333,w:.2,h:.26666666666666666},{x:.15,y:.3333333333333333,w:.3,h:.4},{x:.25,y:.3333333333333333,w:.2,h:.26666666666666666},{x:.25,y:.3333333333333333,w:.3,h:.4},{x:.35,y:.3333333333333333,w:.2,h:.26666666666666666},{x:.35,y:.3333333333333333,w:.3,h:.4},{x:.45,y:.3333333333333333,w:.2,h:.26666666666666666},{x:.45,y:.3333333333333333,w:.3,h:.4},{x:.55,y:.3333333333333333,w:.2,h:.26666666666666666},{x:.55,y:.3333333333333333,w:.3,h:.4},{x:.65,y:.3333333333333333,w:.2,h:.26666666666666666},{x:.65,y:.3333333333333333,w:.3,h:.4},{x:.75,y:.3333333333333333,w:.2,h:.26666666666666666},{x:.75,y:.3333333333333333,w:.3,h:.4},{x:.85,y:.3333333333333333,w:.2,h:.26666666666666666},{x:.85,y:.3333333333333333,w:.3,h:.4},{x:.95,y:.3333333333333333,w:.2,h:.26666666666666666},{x:.95,y:.3333333333333333,w:.3,h:.4},{x:.05,y:.4666666666666667,w:.2,h:.26666666666666666},{x:.05,y:.4666666666666667,w:.3,h:.4},{x:.15,y:.4666666666666667,w:.2,h:.26666666666666666},{x:.15,y:.4666666666666667,w:.3,h:.4},{x:.25,y:.4666666666666667,w:.2,h:.26666666666666666},{x:.25,y:.4666666666666667,w:.3,h:.4},{x:.35,y:.4666666666666667,w:.2,h:.26666666666666666},{x:.35,y:.4666666666666667,w:.3,h:.4},{x:.45,y:.4666666666666667,w:.2,h:.26666666666666666},{x:.45,y:.4666666666666667,w:.3,h:.4},{x:.55,y:.4666666666666667,w:.2,h:.26666666666666666},{x:.55,y:.4666666666666667,w:.3,h:.4},{x:.65,y:.4666666666666667,w:.2,h:.26666666666666666},{x:.65,y:.4666666666666667,w:.3,h:.4},{x:.75,y:.4666666666666667,w:.2,h:.26666666666666666},{x:.75,y:.4666666666666667,w:.3,h:.4},{x:.85,y:.4666666666666667,w:.2,h:.26666666666666666},{x:.85,y:.4666666666666667,w:.3,h:.4},{x:.95,y:.4666666666666667,w:.2,h:.26666666666666666},{x:.95,y:.4666666666666667,w:.3,h:.4},{x:.05,y:.6,w:.2,h:.26666666666666666},{x:.05,y:.6,w:.3,h:.4},{x:.15,y:.6,w:.2,h:.26666666666666666},{x:.15,y:.6,w:.3,h:.4},{x:.25,y:.6,w:.2,h:.26666666666666666},{x:.25,y:.6,w:.3,h:.4},{x:.35,y:.6,w:.2,h:.26666666666666666},{x:.35,y:.6,w:.3,h:.4},{x:.45,y:.6,w:.2,h:.26666666666666666},{x:.45,y:.6,w:.3,h:.4},{x:.55,y:.6,w:.2,h:.26666666666666666},{x:.55,y:.6,w:.3,h:.4},{x:.65,y:.6,w:.2,h:.26666666666666666},{x:.65,y:.6,w:.3,h:.4},{x:.75,y:.6,w:.2,h:.26666666666666666},{x:.75,y:.6,w:.3,h:.4},{x:.85,y:.6,w:.2,h:.26666666666666666},{x:.85,y:.6,w:.3,h:.4},{x:.95,y:.6,w:.2,h:.26666666666666666},{x:.95,y:.6,w:.3,h:.4},{x:.05,y:.7333333333333333,w:.2,h:.26666666666666666},{x:.05,y:.7333333333333333,w:.3,h:.4},{x:.15,y:.7333333333333333,w:.2,h:.26666666666666666},{x:.15,y:.7333333333333333,w:.3,h:.4},{x:.25,y:.7333333333333333,w:.2,h:.26666666666666666},{x:.25,y:.7333333333333333,w:.3,h:.4},{x:.35,y:.7333333333333333,w:.2,h:.26666666666666666},{x:.35,y:.7333333333333333,w:.3,h:.4},{x:.45,y:.7333333333333333,w:.2,h:.26666666666666666},{x:.45,y:.7333333333333333,w:.3,h:.4},{x:.55,y:.7333333333333333,w:.2,h:.26666666666666666},{x:.55,y:.7333333333333333,w:.3,h:.4},{x:.65,y:.7333333333333333,w:.2,h:.26666666666666666},{x:.65,y:.7333333333333333,w:.3,h:.4},{x:.75,y:.7333333333333333,w:.2,h:.26666666666666666},{x:.75,y:.7333333333333333,w:.3,h:.4},{x:.85,y:.7333333333333333,w:.2,h:.26666666666666666},{x:.85,y:.7333333333333333,w:.3,h:.4},{x:.95,y:.7333333333333333,w:.2,h:.26666666666666666},{x:.95,y:.7333333333333333,w:.3,h:.4},{x:.05,y:.8666666666666667,w:.2,h:.26666666666666666},{x:.05,y:.8666666666666667,w:.3,h:.4},{x:.15,y:.8666666666666667,w:.2,h:.26666666666666666},{x:.15,y:.8666666666666667,w:.3,h:.4},{x:.25,y:.8666666666666667,w:.2,h:.26666666666666666},{x:.25,y:.8666666666666667,w:.3,h:.4},{x:.35,y:.8666666666666667,w:.2,h:.26666666666666666},{x:.35,y:.8666666666666667,w:.3,h:.4},{x:.45,y:.8666666666666667,w:.2,h:.26666666666666666},{x:.45,y:.8666666666666667,w:.3,h:.4},{x:.55,y:.8666666666666667,w:.2,h:.26666666666666666},{x:.55,y:.8666666666666667,w:.3,h:.4},{x:.65,y:.8666666666666667,w:.2,h:.26666666666666666},{x:.65,y:.8666666666666667,w:.3,h:.4},{x:.75,y:.8666666666666667,w:.2,h:.26666666666666666},{x:.75,y:.8666666666666667,w:.3,h:.4},{x:.85,y:.8666666666666667,w:.2,h:.26666666666666666},{x:.85,y:.8666666666666667,w:.3,h:.4},{x:.95,y:.8666666666666667,w:.2,h:.26666666666666666},{x:.95,y:.8666666666666667,w:.3,h:.4},{x:.05,y:1,w:.2,h:.26666666666666666},{x:.05,y:1,w:.3,h:.4},{x:.15,y:1,w:.2,h:.26666666666666666},{x:.15,y:1,w:.3,h:.4},{x:.25,y:1,w:.2,h:.26666666666666666},{x:.25,y:1,w:.3,h:.4},{x:.35,y:1,w:.2,h:.26666666666666666},{x:.35,y:1,w:.3,h:.4},{x:.45,y:1,w:.2,h:.26666666666666666},{x:.45,y:1,w:.3,h:.4},{x:.55,y:1,w:.2,h:.26666666666666666},{x:.55,y:1,w:.3,h:.4},{x:.65,y:1,w:.2,h:.26666666666666666},{x:.65,y:1,w:.3,h:.4},{x:.75,y:1,w:.2,h:.26666666666666666},{x:.75,y:1,w:.3,h:.4},{x:.85,y:1,w:.2,h:.26666666666666666},{x:.85,y:1,w:.3,h:.4},{x:.95,y:1,w:.2,h:.26666666666666666},{x:.95,y:1,w:.3,h:.4},{x:.1,y:.13333333333333333,w:.4,h:.5333333333333333},{x:.1,y:.13333333333333333,w:.6,h:.8},{x:.1,y:.13333333333333333,w:.8,h:1},{x:.3,y:.13333333333333333,w:.4,h:.5333333333333333},{x:.3,y:.13333333333333333,w:.6,h:.8},{x:.3,y:.13333333333333333,w:.8,h:1},{x:.5,y:.13333333333333333,w:.4,h:.5333333333333333},{x:.5,y:.13333333333333333,w:.6,h:.8},{x:.5,y:.13333333333333333,w:.8,h:1},{x:.7,y:.13333333333333333,w:.4,h:.5333333333333333},{x:.7,y:.13333333333333333,w:.6,h:.8},{x:.7,y:.13333333333333333,w:.8,h:1},{x:.9,y:.13333333333333333,w:.4,h:.5333333333333333},{x:.9,y:.13333333333333333,w:.6,h:.8},{x:.9,y:.13333333333333333,w:.8,h:1},{x:.1,y:.4,w:.4,h:.5333333333333333},{x:.1,y:.4,w:.6,h:.8},{x:.1,y:.4,w:.8,h:1},{x:.3,y:.4,w:.4,h:.5333333333333333},{x:.3,y:.4,w:.6,h:.8},{x:.3,y:.4,w:.8,h:1},{x:.5,y:.4,w:.4,h:.5333333333333333},{x:.5,y:.4,w:.6,h:.8},{x:.5,y:.4,w:.8,h:1},{x:.7,y:.4,w:.4,h:.5333333333333333},{x:.7,y:.4,w:.6,h:.8},{x:.7,y:.4,w:.8,h:1},{x:.9,y:.4,w:.4,h:.5333333333333333},{x:.9,y:.4,w:.6,h:.8},{x:.9,y:.4,w:.8,h:1},{x:.1,y:.6666666666666666,w:.4,h:.5333333333333333},{x:.1,y:.6666666666666666,w:.6,h:.8},{x:.1,y:.6666666666666666,w:.8,h:1},{x:.3,y:.6666666666666666,w:.4,h:.5333333333333333},{x:.3,y:.6666666666666666,w:.6,h:.8},{x:.3,y:.6666666666666666,w:.8,h:1},{x:.5,y:.6666666666666666,w:.4,h:.5333333333333333},{x:.5,y:.6666666666666666,w:.6,h:.8},{x:.5,y:.6666666666666666,w:.8,h:1},{x:.7,y:.6666666666666666,w:.4,h:.5333333333333333},{x:.7,y:.6666666666666666,w:.6,h:.8},{x:.7,y:.6666666666666666,w:.8,h:1},{x:.9,y:.6666666666666666,w:.4,h:.5333333333333333},{x:.9,y:.6666666666666666,w:.6,h:.8},{x:.9,y:.6666666666666666,w:.8,h:1},{x:.1,y:.9333333333333333,w:.4,h:.5333333333333333},{x:.1,y:.9333333333333333,w:.6,h:.8},{x:.1,y:.9333333333333333,w:.8,h:1},{x:.3,y:.9333333333333333,w:.4,h:.5333333333333333},{x:.3,y:.9333333333333333,w:.6,h:.8},{x:.3,y:.9333333333333333,w:.8,h:1},{x:.5,y:.9333333333333333,w:.4,h:.5333333333333333},{x:.5,y:.9333333333333333,w:.6,h:.8},{x:.5,y:.9333333333333333,w:.8,h:1},{x:.7,y:.9333333333333333,w:.4,h:.5333333333333333},{x:.7,y:.9333333333333333,w:.6,h:.8},{x:.7,y:.9333333333333333,w:.8,h:1},{x:.9,y:.9333333333333333,w:.4,h:.5333333333333333},{x:.9,y:.9333333333333333,w:.6,h:.8},{x:.9,y:.9333333333333333,w:.8,h:1}];function Zr(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return Jr(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Jr(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw o}}}}function Jr(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function Qr(e,t,r,n){for(var i=r*t,o=2*r*t,a=0;a<n.length/3;a++)n[0+a]=e[4*a]/127.5-1,n[i+a]=e[4*a+1]/127.5-1,n[o+a]=e[4*a+2]/127.5-1}function en(e){for(var t=e.tensor,r=e.faceDetectorAccuracy,n=void 0===r?.85:r,i=e.outputHeight,o=void 0===i?240:i,a=e.outputWidth,s=void 0===a?320:a,u=[],l=t.boxes.data,h=t.scores.data,c=0;c<4420;c++){if(!(h[2*c+1]<=n)){var f=.1*l[4*c+0]*Kr[c].w+Kr[c].x,d=.1*l[4*c+1]*Kr[c].h+Kr[c].y,p=Math.exp(.2*l[4*c+2])*Kr[c].w,y=Math.exp(.2*l[4*c+3])*Kr[c].h,m={x1:(f-p/2)*s,y1:(d-y/2)*o,x2:(f+p/2)*s,y2:(d+y/2)*o};if(u.length){var g,w=!1,v=Zr(u);try{for(v.s();!(g=v.n()).done;){if(g.value.checkSame(m)){w=!0;break}}}catch(e){v.e(e)}finally{v.f()}w||u.push(new Xr(m))}else u.push(new Xr(m))}}return u}function tn(e){return tn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},tn(e)}function rn(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,nn(n.key),n)}}function nn(e){var t=function(e,t){if("object"!=tn(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=tn(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==tn(t)?t:t+""}var on=function(){return e=function e(t){var r,n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.isFinished=!0,this.startValue=t.startValue,this.currentValue=t.startValue,this.currentStep=0,this.endValue=null!==(r=t.endValue)&&void 0!==r?r:t.startValue,this.smoothPower=null!==(n=t.smoothPower)&&void 0!==n?n:1,this.smoothFunction=function(e){switch(t.smoothFunctionType){case"ease-out-sine":return Math.sin(e*Math.PI/2);case"ease-out-quint":return 1-Math.pow(1-e,5);case"ease-out-cubic":Math.pow(1-e,3);default:return e}}},t=[{key:"isEnded",value:function(e){var t,r=Math.max(0,Math.min(1,null!==(t=null==e?void 0:e.percentage)&&void 0!==t?t:1));return(null==e?void 0:e.isreverse)&&(r=1-r),(null==e?void 0:e.isreverse)?this.currentStep<=this.smoothPower*r:this.currentStep>=this.smoothPower*r}},{key:"getCurrentValue",value:function(){return this.currentValue}},{key:"getEndValue",value:function(){return this.endValue}},{key:"setCurrentStep",value:function(e){this.currentStep=e}},{key:"checkEndValueChange",value:function(e){e!==this.endValue&&(this.startValue=this.currentValue,this.endValue=e,this.currentStep=1)}},{key:"useAnimationPart",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];e=Math.min(1,Math.max(0,e));var r=Math.max(1,Math.round(this.smoothPower*e));t?this.currentStep<r&&(this.currentStep=r):this.currentStep>r&&(this.currentStep=r)}},{key:"useSmooth",value:function(e){var t;if(this.startValue===this.endValue)return this.currentValue;var r=(null==e?void 0:e.isReverse)?-1:1,n=this.currentStep/this.smoothPower,i=this.smoothFunction(n);return this.currentValue=this.startValue+(this.endValue-this.startValue)*i,this.smoothPower=null!==(t=null==e?void 0:e.newSmoothPower)&&void 0!==t?t:this.smoothPower,this.isFinished=this.currentStep===((null==e?void 0:e.isReverse)?0:this.smoothPower),this.currentStep=Math.max(0,Math.min(this.smoothPower,this.currentStep+r)),this.currentValue}}],t&&rn(e.prototype,t),r&&rn(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,r}();function an(e){return an="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},an(e)}function sn(){sn=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,i=Object.defineProperty||function(e,t,r){e[t]=r.value},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function l(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,r){return e[t]=r}}function h(e,t,r,n){var o=t&&t.prototype instanceof g?t:g,a=Object.create(o.prototype),s=new k(n||[]);return i(a,"_invoke",{value:O(e,r,s)}),a}function c(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=h;var f="suspendedStart",d="suspendedYield",p="executing",y="completed",m={};function g(){}function w(){}function v(){}var b={};l(b,a,(function(){return this}));var x=Object.getPrototypeOf,_=x&&x(x(C([])));_&&_!==r&&n.call(_,a)&&(b=_);var S=v.prototype=g.prototype=Object.create(b);function T(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function E(e,t){function r(i,o,a,s){var u=c(e[i],e,o);if("throw"!==u.type){var l=u.arg,h=l.value;return h&&"object"==an(h)&&n.call(h,"__await")?t.resolve(h.__await).then((function(e){r("next",e,a,s)}),(function(e){r("throw",e,a,s)})):t.resolve(h).then((function(e){l.value=e,a(l)}),(function(e){return r("throw",e,a,s)}))}s(u.arg)}var o;i(this,"_invoke",{value:function(e,n){function i(){return new t((function(t,i){r(e,n,t,i)}))}return o=o?o.then(i,i):i()}})}function O(t,r,n){var i=f;return function(o,a){if(i===p)throw Error("Generator is already running");if(i===y){if("throw"===o)throw a;return{value:e,done:!0}}for(n.method=o,n.arg=a;;){var s=n.delegate;if(s){var u=A(s,n);if(u){if(u===m)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===f)throw i=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i=p;var l=c(t,r,n);if("normal"===l.type){if(i=n.done?y:d,l.arg===m)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(i=y,n.method="throw",n.arg=l.arg)}}}function A(t,r){var n=r.method,i=t.iterator[n];if(i===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,A(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),m;var o=c(i,t.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,m;var a=o.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,m):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,m)}function I(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function P(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function k(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(I,this),this.reset(!0)}function C(t){if(t||""===t){var r=t[a];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,o=function r(){for(;++i<t.length;)if(n.call(t,i))return r.value=t[i],r.done=!1,r;return r.value=e,r.done=!0,r};return o.next=o}}throw new TypeError(an(t)+" is not iterable")}return w.prototype=v,i(S,"constructor",{value:v,configurable:!0}),i(v,"constructor",{value:w,configurable:!0}),w.displayName=l(v,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===w||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,v):(e.__proto__=v,l(e,u,"GeneratorFunction")),e.prototype=Object.create(S),e},t.awrap=function(e){return{__await:e}},T(E.prototype),l(E.prototype,s,(function(){return this})),t.AsyncIterator=E,t.async=function(e,r,n,i,o){void 0===o&&(o=Promise);var a=new E(h(e,r,n,i),o);return t.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},T(S),l(S,u,"Generator"),l(S,a,(function(){return this})),l(S,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=C,k.prototype={constructor:k,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(P),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function i(n,i){return s.type="throw",s.arg=t,r.next=n,i&&(r.method="next",r.arg=e),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),l=n.call(a,"finallyLoc");if(u&&l){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return i(a.catchLoc,!0)}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,m):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),P(r),m}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;P(r)}return i}}throw Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:C(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),m}},t}function un(e,t,r,n,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void r(e)}s.done?t(u):Promise.resolve(u).then(n,i)}function ln(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var o=e.apply(t,r);function a(e){un(o,n,i,a,s,"next",e)}function s(e){un(o,n,i,a,s,"throw",e)}a(void 0)}))}}function hn(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,cn(n.key),n)}}function cn(e){var t=function(e,t){if("object"!=an(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=an(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==an(t)?t:t+""}function fn(e,t,r){return t=mn(t),function(e,t){if(t&&("object"==an(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,dn()?Reflect.construct(t,r||[],mn(e).constructor):t.apply(e,r))}function dn(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(dn=function(){return!!e})()}function pn(e,t,r,n){var i=yn(mn(1&n?e.prototype:e),t,r);return 2&n&&"function"==typeof i?function(e){return i.apply(r,e)}:i}function yn(){return yn="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=function(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=mn(e)););return e}(e,t);if(n){var i=Object.getOwnPropertyDescriptor(n,t);return i.get?i.get.call(arguments.length<3?e:r):i.value}},yn.apply(null,arguments)}function mn(e){return mn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},mn(e)}function gn(e,t){return gn=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},gn(e,t)}var wn=["x1","x2","y1","y2"],vn=function(e){function t(e){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(r=fn(this,t,[e])).name=Vi.SMART_ZOOM,r.priority=3,r.requireNextFrame=!0,r.requireSyncDraw=!0,r.faceCoord={},r.inWork=!1,r.pixels=[],r.config=Object.assign({},Wr),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&gn(e,t)}(t,e),r=t,n=[{key:"init",value:(u=ln(sn().mark((function e(r){return sn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.modelConfig||(this.modelConfig={modelPath:O.y.getModelUrl(O.y.MODELS.facedetector),backend:"wasm",nchw:!1}),e.next=3,pn(t,"init",this,3)([r]);case 3:case"end":return e.stop()}}),e,this)}))),function(e){return u.apply(this,arguments)})},{key:"nextFrame",value:function(e){this.enabled&&(this.pixels.length>1||(this.modelTexture=this.resources.texturePool.get(this.config.modelWidth,this.config.modelHeight),e.sprite.width=this.config.modelWidth,e.sprite.height=this.config.modelHeight,this.resources.renderer.renderTo(e.sprite,this.modelTexture),e.sprite.width=this.sdkOptions.width,e.sprite.height=this.sdkOptions.height,this.pixels.push(this.resources.renderer.pixelsAsync(this.modelTexture,{pool:this.resources.bufferPool,texturePool:this.resources.texturePool}))))}},{key:"prepare",value:function(){var e=this,t=this.config.smoothPower;this.scaleValue=1,this.xOffset=0,this.yOffset=0;var r=this.defaultFaceCoord(),n={};wn.forEach((function(i){e.faceCoord[i]=new on({startValue:r[i],smoothPower:t}),n[i]=e.faceCoord[i].getCurrentValue()})),this.currentFace=new Xr(n)}},{key:"process",value:(s=ln(sn().mark((function e(t){var r,n=arguments;return sn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.enabled){e.next=2;break}return e.abrupt("return");case 2:this.fps=n[1]||1,this.updateWaiter(),this.findFaces(),this.setCurrentFace(),this.calcScale(),this.calcOffset(),r=this.resources.texturePool.get(this.sdkOptions.width,this.sdkOptions.height),t.sprite.setTransform(this.xOffset,this.yOffset,this.scaleValue,this.scaleValue),this.resources.renderer.renderTo(t.sprite,r),t.sprite.setTransform(0,0,1,1),this.resources.texturePool.put(t.update(r));case 13:case"end":return e.stop()}}),e,this)}))),function(e){return s.apply(this,arguments)})},{key:"getFaces",value:function(){return this.enabled?this.faces:[]}},{key:"setCurrentFace",value:function(){var e,t=this;(null===(e=this.faces)||void 0===e?void 0:e.length)?this.checkCurrentFace():this.noFaceWay();var r={};wn.forEach((function(e){t.faceCoord[e].useSmooth({newSmoothPower:t.config.smoothPower}),r[e]=t.faceCoord[e].getCurrentValue()})),this.currentFace=new Xr(r),this.config.isFaceSquareDrawingEnabled,this.config.isPreFaceSquareDrawingEnabled}},{key:"checkCurrentFace",value:function(){var e=this;this.updateWaiter(!0);var t=this.faces.reduce((function(e,t){return t.getSquare()>e.getSquare()&&(e=t),e}),this.faces[0]),r=this.config.sensitivityValue/this.scaleValue;if(!t.isEqual(this.currentFace,r,this.sdkOptions.height,this.sdkOptions.width)){var n=t.getCoord();wn.forEach((function(t){e.faceCoord[t].checkEndValueChange(n[t])}))}}},{key:"noFaceWay",value:function(){var e=this;if(this.waiter.value>0)return this.waiter.value--,void this.updateWaiter(!1);var t=this.defaultFaceCoord();wn.forEach((function(r){e.faceCoord[r].checkEndValueChange(t[r])})),this.updateWaiter(!0)}},{key:"calcScale",value:function(){var e=this.sdkOptions.height*this.sdkOptions.width,t=this.currentFace.getSquare()/e,r=this.config.faceAreaProportion/t;this.scaleValue=Math.sqrt(Math.max(r,1))}},{key:"calcOffset",value:function(){var e=this,t=this.currentFace.getCenter(),r={x:{faceCenter:t.x,newOffset:0,base:this.sdkOptions.width},y:{faceCenter:t.y,newOffset:0,base:this.sdkOptions.height}};Object.values(r).forEach((function(t){var r=(e.scaleValue-1)/2*t.base,n=(t.base/2-t.faceCenter)*e.scaleValue,i=(e.scaleValue-1)*t.base,o=Math.max(n-r,-i);t.newOffset=Math.min(0,o)})),this.xOffset=r.x.newOffset,this.yOffset=r.y.newOffset}},{key:"defaultFaceCoord",value:function(){var e=this.sdkOptions.width/2,t=this.sdkOptions.height/2,r=e*Math.sqrt(this.config.faceAreaProportion),n=t*Math.sqrt(this.config.faceAreaProportion);return{x1:e-r,x2:e+r,y1:t-n,y2:t+n}}},{key:"updateWaiter",value:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0]||!this.waiter?this.waiter={value:this.fps*this.config.waiterSeconds,fps:this.fps}:(this.waiter.value=this.waiter.value/this.waiter.fps*this.fps,this.waiter.fps=this.fps)}},{key:"findFaces",value:(a=ln(sn().mark((function e(){var t,r,n,o,a,s,u,l,h=this;return sn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.inWork){e.next=2;break}return e.abrupt("return");case 2:if(this.checkTimer()){e.next=4;break}return e.abrupt("return");case 4:if(this.pixels.length){e.next=6;break}return e.abrupt("return");case 6:return this.inWork=!0,t=this.config,r=t.faceDetectorAccuracy,n=t.modelHeight,o=t.modelWidth,e.next=10,this.pixels.shift();case 10:return a=e.sent,s=this.resources.bufferPool.getBuffer("f32",3*o*n),Qr(a,o,n,s),this.resources.bufferPool.returnBuffer(a),u={scores:{data:this.resources.bufferPool.getBuffer("f32",8840),dims:[1,4420,2]},boxes:{data:this.resources.bufferPool.getBuffer("f32",17680),dims:[1,4420,4]}},l=this.inference.sessionManager.getSession(this.modelConfig.modelPath),e.abrupt("return",this.inference.run(l,s,o,n,3,u).then((function(e){h.resources.bufferPool.returnBuffer(e.inputBack.data),h.faces=en({tensor:e,faceDetectorAccuracy:r,outputHeight:h.sdkOptions.height,outputWidth:h.sdkOptions.width}),h.resources.bufferPool.returnBuffer(e.boxes.data),h.resources.bufferPool.returnBuffer(e.scores.data)})).catch((function(e){var t;i.bv.notify({message:null!==(t=e.message)&&void 0!==t?t:e,type:i.By.ERROR,code:i.O4.INFERENCE_RUN_ISSUE,emitter:i.JK.EFFECT_SMART_ZOOM,cause:e})})).finally((function(){h.inWork=!1})));case 17:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"enable",value:function(){pn(t,"enable",this,3)([])}},{key:"disable",value:function(){this.enabled&&(pn(t,"disable",this,3)([]),this.scaleValue=1,this.xOffset=0,this.yOffset=0,this.faces=[],this.clearBuffers(),this.setCurrentFace())}},{key:"clearBuffers",value:function(){this.pixels=[]}},{key:"setConfig",value:function(e,t){this.config[e]=t}},{key:"checkTimer",value:function(){return this.faceDetectorTimer?(performance.now()-this.faceDetectorTimer<this.config.faceDetectorPediod_ms||(this.faceDetectorTimer=0),!1):(this.faceDetectorTimer=performance.now(),!0)}},{key:"destroy",value:function(){this.inference.sessionManager.releaseSession(this.modelConfig.modelPath)}}],n&&hn(r.prototype,n),o&&hn(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o,a,s,u}(d),bn=r(8699);function xn(e){return xn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},xn(e)}function _n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Sn(n.key),n)}}function Sn(e){var t=function(e,t){if("object"!=xn(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=xn(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==xn(t)?t:t+""}function Tn(e,t,r){return t=On(t),function(e,t){if(t&&("object"==xn(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,En()?Reflect.construct(t,r||[],On(e).constructor):t.apply(e,r))}function En(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(En=function(){return!!e})()}function On(e){return On=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},On(e)}function An(e,t){return An=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},An(e,t)}var In;function Pn(e,t){var r=t.sigma||.3*(t.radius-1)+.8;return e.replaceAll("0//%%kernelRad%%",t.radius.toString()).replaceAll("0//%%highpassEnabled%%",t.highpassEnabled?"1":"0").replaceAll("10.0//%%sigma%%","float("+r.toString()+")")}!function(e){e.prod="prod",e.boxBilateral="box_bilateral"}(In||(In={}));var kn=function(e){function t(e){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=Tn(this,t,[void 0,Pn(e.blurType===In.boxBilateral?"precision mediump float;\nvarying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform sampler2D uOrigin;\n\nuniform float uBeautyficationLevel;\nuniform float uStepSize;\n\n#define KERNEL_RAD 4\n#define HIGHPASS_ENABLED 0//%%highpassEnabled%%\n\nvec4 overlay(vec4 a, vec4 b) {\n  vec4 x = vec4(2.0) * a * b;\n  vec4 y = vec4(1.0) - vec4(2.0) * (vec4(1.0) - a) * (vec4(1.0) - b);\n  vec4 result;\n  result.r = mix(x.r, y.r, float(a.r > 0.5));\n  result.g = mix(x.g, y.g, float(a.g > 0.5));\n  result.b = mix(x.b, y.b, float(a.b > 0.5));\n  result.a = mix(x.a, y.a, float(a.a > 0.5));\n  return result;\n}\n\nvec3 rgb2xyz(vec3 c) {\n  vec3 tmp;\n  tmp.x = c.r > 0.04045 ? pow((c.r + 0.055) / 1.055, 2.4) : c.r / 12.92;\n  tmp.y = c.g > 0.04045 ? pow((c.g + 0.055) / 1.055, 2.4) : c.g / 12.92,\n  tmp.z = c.b > 0.04045 ? pow((c.b + 0.055) / 1.055, 2.4) : c.b / 12.92;\n  return 100.0 *\n  tmp *\n  mat3(0.4124, 0.3576, 0.1805, 0.2126, 0.7152, 0.0722, 0.0193, 0.1192, 0.9505);\n}\n\nvec3 xyz2lab(vec3 c) {\n  vec3 n = c / vec3(95.047, 100, 108.883);\n  vec3 v;\n  v.x = n.x > 0.008856 ? pow(n.x, 1.0 / 3.0) : 7.787 * n.x + 16.0 / 116.0;\n  v.y = n.y > 0.008856 ? pow(n.y, 1.0 / 3.0) : 7.787 * n.y + 16.0 / 116.0;\n  v.z = n.z > 0.008856 ? pow(n.z, 1.0 / 3.0) : 7.787 * n.z + 16.0 / 116.0;\n  return vec3(116.0 * v.y - 16.0, 500.0 * (v.x - v.y), 200.0 * (v.y - v.z));\n}\n\nvec3 rgb2lab(vec3 c) {\n  vec3 lab = xyz2lab(rgb2xyz(c));\n  return vec3(\n    lab.x / 100.0,\n    0.5 + 0.5 * (lab.y / 127.0),\n    0.5 + 0.5 * (lab.z / 127.0)\n  );\n}\n\nbool skin_mask(vec4 color) {\n  vec3 lab = rgb2lab(color.rgb);\n  return lab.g >= uBeautyficationLevel + 0.05 &&\n  lab.b >= uBeautyficationLevel + 0.04 &&\n  lab.r <= 0.98 &&\n  length(lab.gb) <= 0.9;\n}\n\nvec4 readOrig(vec2 uv) \n{\n  return texture2D(uOrigin, uv);\n}\n\nvec4 readTex(vec2 uv)\n{\n  return texture2D(uSampler, uv);\n}\n\nfloat getLength(vec4 vec)\n{\n    return sqrt(dot(vec, vec));\n}\n\nfloat getDistance(vec4 a, vec4 b)\n{\n    return getLength(a - b);\n}\n\nfloat getDistanceWeight(vec4 a, vec4 b)\n{\n    return 1.0 - min(getDistance(a, b) * 5.248639, 1.0);\n}\n\nint abs(int i) \n{\n  return (i<0)? -i : i;\n}\n\nvec4 blurPass(vec2 uv)\n{    \n  float bilateralWeights[KERNEL_RAD + 1];\n  bilateralWeights[0] = 0.18;\n  bilateralWeights[1] = 0.15;\n  bilateralWeights[2] = 0.12;\n  bilateralWeights[3] = 0.09; \n  bilateralWeights[4] = 0.05;\n\n  vec4 origPixel = readTex(uv);\n  vec4 sum = origPixel * bilateralWeights[0]; \n  float weightSum = bilateralWeights[0];\n\n  for (int i = 1; i <= KERNEL_RAD; i++) {\n    vec4 pixel = readTex(uv - vec2(0.0, (float(i) * uStepSize)));\n    float weight = bilateralWeights[i];\n    float sampleWeight = (weight * getDistanceWeight(origPixel, pixel));\n    weightSum = (weightSum + sampleWeight);\n    sum = (sum + (pixel * sampleWeight));\n  }\n  \n  for (int i = 1; i <= KERNEL_RAD; i++) {\n    vec4 pixel = readTex(uv + vec2(0.0, (float(i) * uStepSize)));\n    float weight = bilateralWeights[i];\n    float sampleWeight = (weight * getDistanceWeight(origPixel, pixel));\n    weightSum = (weightSum + sampleWeight);\n    sum = (sum + (pixel * sampleWeight));\n  }\n  \n  if ((weightSum < 0.4)) {\n      return origPixel;\n  } else {\n      if ((weightSum < 0.5)) {\n          return mix (origPixel, (sum / weightSum), ((weightSum - 0.4) / 0.1));\n      } else {\n          return (sum / weightSum);\n      };\n  };\n}\n\nvoid main() {\n  vec4 origin = readOrig(vTextureCoord);\n  float a = origin.a;\n\n  if (a < 0.9 || (uBeautyficationLevel < 0.95 && !skin_mask(origin))) {\n    gl_FragColor = origin;\n    return;\n  }\n\n  vec4 blurred = blurPass(vTextureCoord);\n\n#if HIGHPASS_ENABLED\n    vec4 highpass =\n      vec4(\n        origin.r - blurred.r,\n        origin.g - blurred.g,\n        origin.b - blurred.b,\n        1\n      ) +\n      vec4(0.5, 0.5, 0.5, 0);\n    vec4 highpass_inverted = vec4(\n      1.0 - highpass.r,\n      1.0 - highpass.g,\n      1.0 - highpass.b,\n      1\n    );\n    gl_FragColor = overlay(origin, highpass_inverted);\n#else \n    gl_FragColor = blurred;\n#endif\n}\n":"varying vec2 vTextureCoord;\nuniform sampler2D uSampler;\n\n#define SIGMA (10.0)\n#define BSIGMA (0.1)\n#define MSIZE (15)\n\nfloat kernel[MSIZE];\n\nuniform float uBeautyficationLevel;\nuniform int uWidth;\nuniform int uHeight;\n\nfloat normpdf(float x, float sigma) {\n  return 0.39894 * exp(-0.5 * x * x / (sigma * sigma)) / sigma;\n}\n\nfloat normpdf3(vec3 v, float sigma) {\n  return 0.39894 * exp(-0.5 * dot(v, v) / (sigma * sigma)) / sigma;\n}\n\nvec4 overlay(vec4 a, vec4 b) {\n  vec4 x = vec4(2.0) * a * b;\n  vec4 y = vec4(1.0) - vec4(2.0) * (vec4(1.0) - a) * (vec4(1.0) - b);\n  vec4 result;\n  result.r = mix(x.r, y.r, float(a.r > 0.5));\n  result.g = mix(x.g, y.g, float(a.g > 0.5));\n  result.b = mix(x.b, y.b, float(a.b > 0.5));\n  result.a = mix(x.a, y.a, float(a.a > 0.5));\n  return result;\n}\n\nvec3 rgb2xyz(vec3 c) {\n  vec3 tmp;\n  tmp.x = c.r > 0.04045 ? pow((c.r + 0.055) / 1.055, 2.4) : c.r / 12.92;\n  tmp.y = c.g > 0.04045 ? pow((c.g + 0.055) / 1.055, 2.4) : c.g / 12.92,\n    tmp.z = c.b > 0.04045 ? pow((c.b + 0.055) / 1.055, 2.4) : c.b / 12.92;\n  return 100.0 *\n  tmp *\n  mat3(0.4124, 0.3576, 0.1805, 0.2126, 0.7152, 0.0722, 0.0193, 0.1192, 0.9505);\n}\n\nvec3 xyz2lab(vec3 c) {\n  vec3 n = c / vec3(95.047, 100, 108.883);\n  vec3 v;\n  v.x = n.x > 0.008856 ? pow(n.x, 1.0 / 3.0) : 7.787 * n.x + 16.0 / 116.0;\n  v.y = n.y > 0.008856 ? pow(n.y, 1.0 / 3.0) : 7.787 * n.y + 16.0 / 116.0;\n  v.z = n.z > 0.008856 ? pow(n.z, 1.0 / 3.0) : 7.787 * n.z + 16.0 / 116.0;\n  return vec3(116.0 * v.y - 16.0, 500.0 * (v.x - v.y), 200.0 * (v.y - v.z));\n}\n\nvec3 rgb2lab(vec3 c) {\n  vec3 lab = xyz2lab(rgb2xyz(c));\n  return vec3(\n    lab.x / 100.0,\n    0.5 + 0.5 * (lab.y / 127.0),\n    0.5 + 0.5 * (lab.z / 127.0)\n  );\n}\n\nbool skin_mask(vec4 color) {\n  vec3 lab = rgb2lab(color.rgb);\n  return lab.g >= uBeautyficationLevel + 0.05 &&\n  lab.b >= uBeautyficationLevel + 0.04 &&\n  lab.r <= 0.98 &&\n  length(lab.gb) <= 0.9;\n}\n\nvoid main() {\n  vec2 iResolution = vec2(float(uWidth), float(uHeight));\n  vec3 c = texture2D(uSampler, vTextureCoord).rgb;\n  float a = texture2D(uSampler, vTextureCoord).a;\n\n  if (a > 0.9 && (uBeautyficationLevel > 0.95 || skin_mask(texture2D(uSampler, vTextureCoord)))) {\n    const int kSize = (MSIZE - 1) / 2;\n    vec3 final_colour = vec3(0.0);\n    float Z = 0.0;\n\n    kernel[0] = kernel[14] = 0.031225216;\n    kernel[1] = kernel[13] = 0.033322271;\n    kernel[2] = kernel[12] = 0.035206333;\n    kernel[3] = kernel[11] = 0.036826804;\n    kernel[4] = kernel[10] = 0.038138565;\n    kernel[5] = kernel[9] = 0.039104044;\n    kernel[6] = kernel[8] = 0.039695028;\n    kernel[7] = 0.039894;\n    float bZ = 0.2506642602897679;\n\n    //create the 1-D kernel\n\n    //   for (int j = 0; j <= kSize; ++j)\n    //   {\n    //     kernel[kSize+j] = kernel[kSize-j] = normpdf(float(j), SIGMA);\n    //   }\n\n    vec3 cc;\n    float factor;\n    //float bZ = 1.0/normpdf(0.0, BSIGMA);\n    //read out the texels\n    for (int i = -kSize; i <= kSize; ++i) {\n      for (int j = -kSize; j <= kSize; ++j) {\n        cc = texture2D(\n          uSampler,\n          vTextureCoord.xy + vec2(float(i), float(j)) / iResolution.xy\n        ).rgb;\n        factor =\n          normpdf3(cc - c, BSIGMA) * bZ * kernel[kSize + j] * kernel[kSize + i];\n        Z += factor;\n        final_colour += factor * cc;\n      }\n    }\n\n    //fragColor = vec4(final_colour / Z, 1.0);\n\n    vec4 origin = texture2D(uSampler, vTextureCoord);\n    vec4 blurred = vec4(final_colour / Z, 1.0);\n    vec4 highpass =\n      vec4(\n        origin.r - blurred.r,\n        origin.g - blurred.g,\n        origin.b - blurred.b,\n        1\n      ) +\n      vec4(0.5, 0.5, 0.5, 0);\n    vec4 highpass_inverted = vec4(\n      1.0 - highpass.r,\n      1.0 - highpass.g,\n      1.0 - highpass.b,\n      1\n    );\n    gl_FragColor = overlay(origin, highpass_inverted);\n\n  } else {\n    gl_FragColor = vec4(c, a);\n\n  }\n}\n",e),{uBeautificationLevel:e.uBeautificationLevel,uWidth:e.uWidth,uHeight:e.uHeight}]),e.blurType===In.boxBilateral&&(r.hPassFilter=new g.Filter(void 0,"precision mediump float;\nvarying vec2 vTextureCoord;\nuniform sampler2D uSampler;\n\nuniform float uStepSize;\n\n#define KERNEL_RAD 4\n\nvec4 readTex(vec2 uv)\n{\n  return texture2D(uSampler, uv);\n}\n\nfloat getLength(vec4 vec)\n{\n    return sqrt(dot(vec, vec));\n}\n\nfloat getDistance(vec4 a, vec4 b)\n{\n    return getLength(a - b);\n}\n\nfloat getDistanceWeight(vec4 a, vec4 b)\n{\n    return 1.0 - min(getDistance(a, b) * 5.248639, 1.0);\n}\n\nvec4 blurPass(vec2 uv)\n{    \n  float bilateralWeights[KERNEL_RAD + 1];\n  bilateralWeights[0] = 0.18;\n  bilateralWeights[1] = 0.15;\n  bilateralWeights[2] = 0.12;\n  bilateralWeights[3] = 0.09; \n  bilateralWeights[4] = 0.05;\n\n  vec4 origPixel = readTex(uv);\n  vec4 sum = origPixel * bilateralWeights[0]; \n  float weightSum = bilateralWeights[0];\n\n  for (int i = 1; i <= KERNEL_RAD; i++) {\n    vec4 pixel = readTex(uv - vec2((float(i) * uStepSize), 0.0));\n    float weight = bilateralWeights[i];\n    float sampleWeight = (weight * getDistanceWeight(origPixel, pixel));\n    weightSum = (weightSum + sampleWeight);\n    sum = (sum + (pixel * sampleWeight));\n  }\n  \n  for (int i = 1; i <= KERNEL_RAD; i++) {\n    vec4 pixel = readTex(uv + vec2((float(i) * uStepSize), 0.0));\n    float weight = bilateralWeights[i];\n    float sampleWeight = (weight * getDistanceWeight(origPixel, pixel));\n    weightSum = (weightSum + sampleWeight);\n    sum = (sum + (pixel * sampleWeight));\n  }\n  \n  if ((weightSum < 0.4)) {\n      return origPixel;\n  } else {\n      if ((weightSum < 0.5)) {\n          return mix (origPixel, (sum / weightSum), ((weightSum - 0.4) / 0.1));\n      } else {\n          return (sum / weightSum);\n      };\n  };\n}\n\nvoid main() {\n  gl_FragColor = blurPass(vTextureCoord);\n}\n")),r.blurType=e.blurType,r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&An(e,t)}(t,e),r=t,(n=[{key:"setBeautificationLevel",value:function(e){this.uniforms.uBeautyficationLevel=e}},{key:"apply",value:function(e,t,r,n){if(this.blurType!==In.prod){var i=e.getFilterTexture();this.hPassFilter.uniforms.uStepSize=1.5/t._frame.width,e.applyFilter(this.hPassFilter,t,i,g.CLEAR_MODES.NO),this.uniforms.uStepSize=1.5/t._frame.height,this.uniforms.uOrigin=t,e.applyFilter(this,i,r,n),e.returnFilterTexture(i)}else e.applyFilter(this,t,r,n)}}])&&_n(r.prototype,n),i&&_n(r,i),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,i}(g.Filter);function Cn(e){return Cn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Cn(e)}function $n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Rn(n.key),n)}}function Rn(e){var t=function(e,t){if("object"!=Cn(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=Cn(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Cn(t)?t:t+""}function Dn(e,t,r){return t=Ln(t),function(e,t){if(t&&("object"==Cn(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,Mn()?Reflect.construct(t,r||[],Ln(e).constructor):t.apply(e,r))}function Mn(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Mn=function(){return!!e})()}function Ln(e){return Ln=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Ln(e)}function Bn(e,t){return Bn=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Bn(e,t)}var Nn=function(e){function t(e,r,n){var i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(i=Dn(this,t,["attribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\nvarying vec2 vOriginCoord;\nvarying vec2 vOutputFrame;\nvarying vec2 vInputSize;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\nuniform mat3 uTransformMatrix;\n\nvec4 filterVertexPosition(void ) {\n  vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.0)) + outputFrame.xy;\n\n  return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord(void ) {\n  return aVertexPosition * (outputFrame.zw * inputSize.zw);\n}\n\nvoid main(void ) {\n  gl_Position = filterVertexPosition();\n  vTextureCoord = filterTextureCoord();\n\n  vOutputFrame = outputFrame.zw;\n  vInputSize = inputSize.xy;\n\n  vOriginCoord = (uTransformMatrix * vec3(vTextureCoord * inputSize.xy / outputFrame.zw, 1.0)).xy;\n}\n","uniform sampler2D uSampler;\nuniform sampler2D uOriginFrame;\n\nuniform bool useMask;\nuniform float distColor;\n\nvarying vec2 vTextureCoord;\nvarying vec2 vOriginCoord;\nvarying vec2 vOutputFrame;\nvarying vec2 vInputSize;\n\nvoid main() {\n  float personMask = texture2D(uSampler, vTextureCoord).r;\n\n  personMask = smoothstep(0.0, 1.0, personMask);\n  personMask = smoothstep(0.0, 1.0, personMask);\n  personMask = smoothstep(0.0, 1.0, personMask);\n\n  vec4 personFrame = texture2D(uOriginFrame, vOriginCoord);\n  \n  //rounded video preparation\n  //gl_FragColor = mix(vec4(0), personFrame, step(distance(vec2(vOriginCoord.x , vOriginCoord.y * vOutputFrame.y/vOutputFrame.x), vec2(0.5, 0.5 * vOutputFrame.y/vOutputFrame.x) ), 0.281) );\n  //step(distance(vTextureCoord.y, 0.5), 0.5)\n\n  if (useMask) {\n    gl_FragColor = mix(vec4(0), personFrame, personMask);  \n  } else {\n    gl_FragColor = mix(vec4(0), personFrame, distColor);\n  }\n}\n",Object.assign({},e)])).matrix=new g.Matrix,i.sdkOptions=r,i.maskSprite=n,i.setLayout(),i}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Bn(e,t)}(t,e),r=t,(n=[{key:"setLayout",value:function(){var e=this.maskSprite.position.x<0?1-Math.abs(this.maskSprite.position.x)/this.maskSprite.width:(this.sdkOptions.width-this.maskSprite.position.x)/this.maskSprite.width;e=Math.min(1,e);var t=this.maskSprite.position.x<0?-this.maskSprite.position.x/this.maskSprite.width:0,r=this.maskSprite.position.y<0?1-Math.abs(this.maskSprite.position.y)/this.maskSprite.height:(this.sdkOptions.height-this.maskSprite.position.y)/this.maskSprite.height;r=Math.min(1,r);var n=this.maskSprite.position.y<0?-this.maskSprite.position.y/this.maskSprite.height:0;this.matrix.a=e,this.matrix.d=r,this.matrix.tx=t,this.matrix.ty=n,this.uniforms.uTransformMatrix=this.matrix}},{key:"setOrigin",value:function(e){this.uniforms.uOriginFrame=e}},{key:"setLayoutMode",value:function(e){switch(e){case"segmentation":this.uniforms.useMask=!0,this.uniforms.distColor=0;break;case"circle":case"hide":this.uniforms.useMask=!1,this.uniforms.distColor=0;break;case"full":this.uniforms.useMask=!1,this.uniforms.distColor=1}}},{key:"setIsBoundaryStrong",value:function(e){this.uniforms.uIsBoundaryStrong=e}}])&&$n(r.prototype,n),i&&$n(r,i),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,i}(g.Filter);function Fn(e){return Fn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Fn(e)}function Un(e){return function(e){if(Array.isArray(e))return jn(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return jn(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?jn(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function jn(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function zn(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Gn(n.key),n)}}function Gn(e){var t=function(e,t){if("object"!=Fn(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=Fn(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Fn(t)?t:t+""}function Vn(e,t,r){return t=Hn(t),function(e,t){if(t&&("object"==Fn(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,Wn()?Reflect.construct(t,r||[],Hn(e).constructor):t.apply(e,r))}function Wn(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Wn=function(){return!!e})()}function Hn(e){return Hn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Hn(e)}function qn(e,t){return qn=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},qn(e,t)}var Yn=function(e){function t(e){var r,n,i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(r=Vn(this,t,[void 0,"varying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform vec2 uOffset;\n\nuniform int uHasMask;\nuniform sampler2D uMask;\n\nuniform int uClamped;\nuniform vec4 filterClamp;\n\nuniform mat3 uTransformMatrix;\n\nbool checkCoord(vec2 coord) {\n  vec4 color = texture2D(uMask, coord);\n  return color.r < 0.5;\n}\n\nvoid main(void ) {\n  vec4 color = vec4(0.0);\n  bool hasMask = uHasMask > 0;\n  bool isClamped = uClamped > 0;\n  bool isInside = hasMask && !checkCoord(vTextureCoord);\n\n  vec2 pickCoord[4];\n  pickCoord[0] = vTextureCoord + vec2(-1.0, +1.0) * uOffset;\n  pickCoord[1] = vTextureCoord + vec2(+1.0, +1.0) * uOffset;\n  pickCoord[2] = vTextureCoord + vec2(+1.0, -1.0) * uOffset;\n  pickCoord[3] = vTextureCoord + vec2(-1.0, -1.0) * uOffset;\n\n  for (int i = 0; i < 4; i += 1) {\n    vec2 coord = pickCoord[i];\n\n    //. Get original point if needed\n    if (hasMask && !isInside && !checkCoord(pickCoord[i])) {\n      coord = vTextureCoord;\n    }\n\n    //. Check clamped mode\n    color += isClamped\n      ? texture2D(uSampler, clamp(coord, filterClamp.xy, filterClamp.zw))\n      : texture2D(uSampler, coord);\n  }\n\n  gl_FragColor = color * 0.25;\n}\n"]))._kernels=[],r._blur=4,r._quality=3,r.isMaskEnabled=!0,r.uniforms.uOffset=new Float32Array(2),r.uniforms.uClamped=e.clamp?1:0,r.uniforms.uHasMask=0,r.uniforms.uMask=g.Texture.WHITE,r.uniforms.uTransformMatrix=new g.Matrix,r._pixelSize=new g.Point,r.pixelSize=1,r._clamp=!!e.clamp,Array.isArray(e.blur)?r.kernels=e.blur:(r._blur=null!==(n=e.blur)&&void 0!==n?n:4,r.quality=null!==(i=e.quality)&&void 0!==i?i:3),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&qn(e,t)}(t,e),r=t,(n=[{key:"apply",value:function(e,t,r,n){var i,o=this._pixelSize.x/t._frame.width,a=this._pixelSize.y/t._frame.height;if(1===this._quality||0===this._blur)i=this._kernels[0]+.5,this.uniforms.uOffset[0]=i*o,this.uniforms.uOffset[1]=i*a,e.applyFilter(this,t,r,n);else{for(var s,u=e.getFilterTexture(),l=t,h=u,c=this._quality-1,f=0;f<c;f++)i=this._kernels[f]+.5,this.uniforms.uOffset[0]=i*o,this.uniforms.uOffset[1]=i*a,e.applyFilter(this,l,h,1),s=l,l=h,h=s;i=this._kernels[c]+.5,this.uniforms.uOffset[0]=i*o,this.uniforms.uOffset[1]=i*a,e.applyFilter(this,l,r,n),e.returnFilterTexture(u)}}},{key:"_updatePadding",value:function(){this.padding=Math.ceil(this._kernels.reduce((function(e,t){return e+t+.5}),0))}},{key:"_generateKernels",value:function(){var e=this._blur,t=this._quality,r=[e];if(e>0)for(var n=e,i=e/t,o=1;o<t;o++)n-=i,r.push(n);this._kernels=r,this._updatePadding()}},{key:"kernels",get:function(){return this._kernels},set:function(e){Array.isArray(e)&&e.length>0?(this._kernels=e,this._quality=e.length,this._blur=Math.max.apply(Math,Un(e))):(this._kernels=[0],this._quality=1)}},{key:"clamp",get:function(){return this._clamp}},{key:"pixelSize",get:function(){return this._pixelSize},set:function(e){"number"==typeof e?(this._pixelSize.x=e,this._pixelSize.y=e):Array.isArray(e)?(this._pixelSize.x=e[0],this._pixelSize.y=e[1]):e instanceof g.Point?(this._pixelSize.x=e.x,this._pixelSize.y=e.y):(this._pixelSize.x=1,this._pixelSize.y=1)}},{key:"quality",get:function(){return this._quality},set:function(e){this._quality=Math.max(1,Math.round(e)),this._generateKernels()}},{key:"blur",get:function(){return this._blur},set:function(e){this._blur=e,this._generateKernels()}},{key:"enableMask",value:function(){this.isMaskEnabled=!0}},{key:"disableMask",value:function(){this.isMaskEnabled=!1}},{key:"setMask",value:function(e){this.uniforms.uMask=e,this.uniforms.uHasMask=this.isMaskEnabled?1:0}}])&&zn(r.prototype,n),i&&zn(r,i),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,i}(g.Filter),Xn=r(4486);function Kn(e){return Kn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Kn(e)}function Zn(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Jn(n.key),n)}}function Jn(e){var t=function(e,t){if("object"!=Kn(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=Kn(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Kn(t)?t:t+""}function Qn(e,t,r){return t=ti(t),function(e,t){if(t&&("object"==Kn(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,ei()?Reflect.construct(t,r||[],ti(e).constructor):t.apply(e,r))}function ei(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(ei=function(){return!!e})()}function ti(e){return ti=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},ti(e)}function ri(e,t){return ri=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},ri(e,t)}var ni,ii=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Qn(this,t)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ri(e,t)}(t,e),r=t,(n=[{key:"set",value:function(e,t,r){this.preset=e,this.width=t,this.height=r,this.size=4*this.width*this.height,this.emit("update",this)}}])&&Zn(r.prototype,n),i&&Zn(r,i),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,i}(Xn.b),oi=r(6903);function ai(e,t,r){return t=ui(t),function(e,t){if(t&&("object"==ci(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,si()?Reflect.construct(t,r||[],ui(e).constructor):t.apply(e,r))}function si(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(si=function(){return!!e})()}function ui(e){return ui=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},ui(e)}function li(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&hi(e,t)}function hi(e,t){return hi=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},hi(e,t)}function ci(e){return ci="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ci(e)}function fi(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function di(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,yi(n.key),n)}}function pi(e,t,r){return t&&di(e.prototype,t),r&&di(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function yi(e){var t=function(e,t){if("object"!=ci(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=ci(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==ci(t)?t:t+""}!function(e){e.SPEED="speed",e.BALANCED="balanced",e.QUALITY="quality",e.LIGHTNING="lightning"}(ni||(ni={}));var mi=function(){return pi((function e(t){fi(this,e),this.sdkOptions=t,this.landscapeSize={height:144,width:256},this.portraitSize={height:192,width:192}}),[{key:"getModelSize",value:function(){return this.sdkOptions.width/this.sdkOptions.height>1?this.landscapeSize:this.portraitSize}},{key:"getURL",value:function(){var e=this.sdkOptions.width/this.sdkOptions.height>1?"PRESETS":"PRESETS_PORTRAIT",t=O.y[e][this.preset];return t?O.y.getPresetUrl(t):O.y.MODEL_URL}}])}(),gi=function(e){function t(e){var r;return fi(this,t),(r=ai(this,t,[e])).preset=ni.QUALITY,r}return li(t,e),pi(t)}(mi),wi=function(e){function t(e){var r;return fi(this,t),(r=ai(this,t,[e])).preset=ni.BALANCED,r.landscapeSize={height:128,width:256},r}return li(t,e),pi(t)}(mi),vi=function(e){function t(e){var r;return fi(this,t),(r=ai(this,t,[e])).preset=ni.SPEED,r.landscapeSize={height:160,width:256},r}return li(t,e),pi(t)}(mi),bi=function(e){function t(e){var r;return fi(this,t),(r=ai(this,t,[e])).preset=ni.LIGHTNING,r}return li(t,e),pi(t)}(mi),xi=function(){return pi((function e(t){fi(this,e),this.modelMap=new Map,this.modelMap.set(ni.BALANCED,new wi(t)),this.modelMap.set(ni.QUALITY,new gi(t)),this.modelMap.set(ni.SPEED,new vi(t)),this.modelMap.set(ni.LIGHTNING,new bi(t))}),[{key:"getModelSize",value:function(e){var t,r;return null!==(r=null===(t=this.getModel(e))||void 0===t?void 0:t.getModelSize())&&void 0!==r?r:{height:144,width:256}}},{key:"getModelURL",value:function(e){var t,r;return null!==(r=null===(t=this.getModel(e))||void 0===t?void 0:t.getURL())&&void 0!==r?r:""}},{key:"getModel",value:function(e){return this.modelMap.has(e)?this.modelMap.get(e):(i.bv.notify({emitter:i.JK.PRESET_INIT,type:i.By.ERROR,code:i.O4.PRESET_ISSUE,message:"Can't find preset ".concat(e)}),null)}}])}(),_i=r(5862);function Si(e){return Si="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Si(e)}function Ti(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Ei(n.key),n)}}function Ei(e){var t=function(e,t){if("object"!=Si(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=Si(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Si(t)?t:t+""}function Oi(e,t,r){return t=Ii(t),function(e,t){if(t&&("object"==Si(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,Ai()?Reflect.construct(t,r||[],Ii(e).constructor):t.apply(e,r))}function Ai(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Ai=function(){return!!e})()}function Ii(e){return Ii=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Ii(e)}function Pi(e,t){return Pi=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Pi(e,t)}var ki,Ci=function(e){function t(e,r,n){var i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(i=Oi(this,t)).filters={blur:{}},i.sdkOptions=e,i.type="origin",i.options=Object.assign({},t.defaultOptions,n),i.frame=r,i.filters.blur=new Yn({blur:5,quality:5}),i.backgroundTrack=new _i.D,i.backgroundTrack.on("ended",i.clearBackground,i),i.backgroundTrack.on("update",(function(){return i.calculateBackgroundSize}),i),i.sdkOptions.on("update",i.onOptionsUpdate,i),i}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Pi(e,t)}(t,e),r=t,n=[{key:"destroy",value:function(){this.backgroundTrack.off("ended",this.clearBackground,this),this.backgroundTrack.off("update",this.calculateBackgroundSize,this),this.sdkOptions.off("update",this.onOptionsUpdate,this)}},{key:"onOptionsUpdate",value:function(e){this.frame.resize(e.width,e.height),this.calculateBackgroundSize()}},{key:"render",value:function(){this.backgroundTrack.update(),document.hidden&&this.frame.sprite.texture.baseTexture.resource&&this.frame.sprite.texture.baseTexture.resource.source instanceof HTMLVideoElement&&this.frame.sprite.texture.baseTexture.update()}},{key:"set",value:function(e){this.backgroundTrack.stop(),this.applyBackground(e)}},{key:"applyBlur",value:function(e){this.frame.sprite.filters=[],this.filters.blur.disableMask(),e&&(this.filters.blur.blur=+e,this.frame.sprite.filters.push(this.filters.blur),"origin"==this.frame.active&&this.filters.blur.enableMask())}},{key:"setMask",value:function(e){this.filters.blur.blur&&this.filters.blur.setMask(e)}},{key:"applyBackground",value:function(e){var t,r=this;if(this.frame.sprite.tint="color"==e?this.options.color:16777215,this.options.source!=e){if(this.options.source=e,null==e)return this.type="origin",this.frame.active!==this.type&&(this.frame.activateTexture(this.type),this.calculateBackgroundSize(),(null===(t=this.frame.sprite.filters)||void 0===t?void 0:t.length)&&"origin"==this.frame.active?this.filters.blur.enableMask():this.filters.blur.disableMask()),void this.emit("success",this);var n,i,o;switch(e.constructor){case String:"color"==e?(this.type="color",n=g.Texture.WHITE):(n=e,this.type="url");break;case MediaStream:this.backgroundTrack.set(e),(i=document.createElement("video")).srcObject=e,n=i,this.type="media_stream";break;case CanvasCaptureMediaStreamTrack:case BrowserCaptureMediaStreamTrack:case MediaStreamTrack:o=new MediaStream([e]),this.backgroundTrack.set(o),(i=document.createElement("video")).srcObject=o,n=i,this.type="media_stream_track";break;case HTMLVideoElement:n=e,this.type="video"}if(n&&n instanceof g.Texture)this.texture=n;else{if(e.constructor==String)return void g.Texture.fromURL(n).then((function(e){r.texture=e,r.onBackgroundLoaded()}));this.texture=g.Texture.from(n)}this.texture.baseTexture.valid?this.onBackgroundLoaded():this.texture.baseTexture.once("loaded",(function(){return r.onBackgroundLoaded()}))}else this.emit("success",this)}},{key:"onBackgroundLoaded",value:function(){this.texture.baseTexture&&(this.emit("success",this),this.frame.addTexture("swap",this.texture),this.switchBackground(),this.calculateBackgroundSize(),this.loopAndRestart())}},{key:"loopAndRestart",value:function(){this.frame.sprite.texture.baseTexture.resource.source instanceof HTMLVideoElement&&(this.frame.sprite.texture.baseTexture.resource.source.loop=!0,this.frame.sprite.texture.baseTexture.resource.source.currentTime=0,this.frame.sprite.texture.baseTexture.resource.source.muted=!0)}},{key:"setColor",value:function(e){this.options.color=e,this.frame.sprite.tint=this.options.color}},{key:"switchBackground",value:function(){var e;this.frame.activateTexture("swap"),"color"==this.type&&(this.frame.sprite.tint=this.options.color),(null===(e=this.frame.sprite.filters)||void 0===e?void 0:e.length)&&"origin"==this.frame.active?this.filters.blur.enableMask():this.filters.blur.disableMask(),this.emit("update",this)}},{key:"clearBackground",value:function(){this.backgroundTrack.stop(),this.applyBackground(null),this.emit("clear",this)}},{key:"updateBackgroundSize",value:function(e,t,r,n){this.frame.sprite.width=r,this.frame.sprite.height=n,this.frame.sprite.x=e,this.frame.sprite.y=t}},{key:"setFitMode",value:function(e){this.options.fit_mode=e,this.calculateBackgroundSize()}},{key:"calculateBackgroundSize",value:function(){var e=this.sdkOptions.width,t=this.sdkOptions.height;if("color"!=this.type&&"origin"!=this.type){if(!(this.frame.sprite.texture.baseTexture.width<20)){var r=this.frame.sprite.texture.baseTexture.width/this.frame.sprite.texture.baseTexture.height;"fill"==this.options.fit_mode?e/r>=t?this.updateBackgroundSize(0,-Math.abs(t-e/r)/2,e,e/r):this.updateBackgroundSize(-Math.abs(e-t*r)/2,0,t*r,t):e/r<=t?this.updateBackgroundSize(0,Math.abs(t-e/r)/2,e,e/r):this.updateBackgroundSize(Math.abs(e-t*r)/2,0,t*r,t)}}else this.updateBackgroundSize(0,0,e,t)}}],n&&Ti(r.prototype,n),i&&Ti(r,i),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,i}(Xn.b);function $i(e){return $i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},$i(e)}function Ri(){Ri=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,i=Object.defineProperty||function(e,t,r){e[t]=r.value},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function l(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,r){return e[t]=r}}function h(e,t,r,n){var o=t&&t.prototype instanceof g?t:g,a=Object.create(o.prototype),s=new k(n||[]);return i(a,"_invoke",{value:O(e,r,s)}),a}function c(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=h;var f="suspendedStart",d="suspendedYield",p="executing",y="completed",m={};function g(){}function w(){}function v(){}var b={};l(b,a,(function(){return this}));var x=Object.getPrototypeOf,_=x&&x(x(C([])));_&&_!==r&&n.call(_,a)&&(b=_);var S=v.prototype=g.prototype=Object.create(b);function T(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function E(e,t){function r(i,o,a,s){var u=c(e[i],e,o);if("throw"!==u.type){var l=u.arg,h=l.value;return h&&"object"==$i(h)&&n.call(h,"__await")?t.resolve(h.__await).then((function(e){r("next",e,a,s)}),(function(e){r("throw",e,a,s)})):t.resolve(h).then((function(e){l.value=e,a(l)}),(function(e){return r("throw",e,a,s)}))}s(u.arg)}var o;i(this,"_invoke",{value:function(e,n){function i(){return new t((function(t,i){r(e,n,t,i)}))}return o=o?o.then(i,i):i()}})}function O(t,r,n){var i=f;return function(o,a){if(i===p)throw Error("Generator is already running");if(i===y){if("throw"===o)throw a;return{value:e,done:!0}}for(n.method=o,n.arg=a;;){var s=n.delegate;if(s){var u=A(s,n);if(u){if(u===m)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===f)throw i=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i=p;var l=c(t,r,n);if("normal"===l.type){if(i=n.done?y:d,l.arg===m)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(i=y,n.method="throw",n.arg=l.arg)}}}function A(t,r){var n=r.method,i=t.iterator[n];if(i===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,A(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),m;var o=c(i,t.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,m;var a=o.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,m):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,m)}function I(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function P(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function k(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(I,this),this.reset(!0)}function C(t){if(t||""===t){var r=t[a];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,o=function r(){for(;++i<t.length;)if(n.call(t,i))return r.value=t[i],r.done=!1,r;return r.value=e,r.done=!0,r};return o.next=o}}throw new TypeError($i(t)+" is not iterable")}return w.prototype=v,i(S,"constructor",{value:v,configurable:!0}),i(v,"constructor",{value:w,configurable:!0}),w.displayName=l(v,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===w||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,v):(e.__proto__=v,l(e,u,"GeneratorFunction")),e.prototype=Object.create(S),e},t.awrap=function(e){return{__await:e}},T(E.prototype),l(E.prototype,s,(function(){return this})),t.AsyncIterator=E,t.async=function(e,r,n,i,o){void 0===o&&(o=Promise);var a=new E(h(e,r,n,i),o);return t.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},T(S),l(S,u,"Generator"),l(S,a,(function(){return this})),l(S,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=C,k.prototype={constructor:k,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(P),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function i(n,i){return s.type="throw",s.arg=t,r.next=n,i&&(r.method="next",r.arg=e),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),l=n.call(a,"finallyLoc");if(u&&l){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return i(a.catchLoc,!0)}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,m):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),P(r),m}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;P(r)}return i}}throw Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:C(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),m}},t}function Di(e,t,r,n,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void r(e)}s.done?t(u):Promise.resolve(u).then(n,i)}function Mi(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var o=e.apply(t,r);function a(e){Di(o,n,i,a,s,"next",e)}function s(e){Di(o,n,i,a,s,"throw",e)}a(void 0)}))}}function Li(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Bi(n.key),n)}}function Bi(e){var t=function(e,t){if("object"!=$i(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=$i(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==$i(t)?t:t+""}function Ni(e,t,r){return t=zi(t),function(e,t){if(t&&("object"==$i(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,Fi()?Reflect.construct(t,r||[],zi(e).constructor):t.apply(e,r))}function Fi(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Fi=function(){return!!e})()}function Ui(e,t,r,n){var i=ji(zi(1&n?e.prototype:e),t,r);return 2&n&&"function"==typeof i?function(e){return i.apply(r,e)}:i}function ji(){return ji="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=function(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=zi(e)););return e}(e,t);if(n){var i=Object.getOwnPropertyDescriptor(n,t);return i.get?i.get.call(arguments.length<3?e:r):i.value}},ji.apply(null,arguments)}function zi(e){return zi=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},zi(e)}function Gi(e,t){return Gi=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Gi(e,t)}Ci.defaultOptions={source:null,fit_mode:"fill",color:16777215},function(e){e.SEGMENTATION="segmentation",e.FULL="full",e.HIDE="hide",e.TRANSPARENT="transparent",e.CIRCLE="circle"}(ki||(ki={}));var Vi,Wi=function(e){function t(e){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(r=Ni(this,t,[e])).name=Vi.VIRTUAL_BACKGROUND,r.priority=20,r.requireNextFrame=!0,r.pixels=[],r.filters={blurMask:{},show:{},beautification:{},nchw:{},mirror:{}},r.skip_frames_counter=0,r.customLayoutOptions={width:1280,height:720,xOffset:0,yOffset:0},r.customLayoutOptions.width=e.width,r.customLayoutOptions.height=e.height,r.presetManager=new xi(r.sdkOptions),r.inferenceTimer=new bn.S,r.drawTimer=new bn.S,r.settings={boundary_level:0,boundary_mode:"strong",beautification:!1,beautification_level:.48,beautification_highpass:!0,beautification_radius:7,beautification_blur_type:In.boxBilateral,blur:0,layout:"center",preset:O.y.PRESET,skip_frames:!1,layout_mode:ki.SEGMENTATION},r.model=new ii,r.model.on("update",r.updateModelSize,r),r.is_running=!1,r.isNewPreset=!1,r.enable(),r.gpuErrorHandler=r.gpuErrorHandler.bind(r),i.bv.subscribe(r.gpuErrorHandler),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Gi(e,t)}(t,e),r=t,n=[{key:"gpuErrorHandler",value:(c=Mi(Ri().mark((function e(t){return Ri().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.code||![i.O4.GPU_DEVICE_LOST,i.O4.GPU_UNCAPTUREDERROR].includes(t.code)){e.next=11;break}if(i.bv.notify({message:"Encountered a WebGPU error, falling back to CPU WASM",type:i.By.INFO,code:i.O4.CPU_FALLBACK,emitter:i.JK.EFFECT_VIRTUAL_BACKGROUND}),!this.onProcessPromise||!this.onProcessPromise.isPending()){e.next=5;break}return e.next=5,this.onProcessPromise.promise;case 5:return this.onProcessPromise=new oi.c,this.inference.sessionManager.releaseSession(this.modelConfig.modelPath),this.modelConfig.backend="wasm",e.next=10,this.inference.sessionManager.init(this.modelConfig);case 10:this.onProcessPromise.resolve();case 11:case"end":return e.stop()}}),e,this)}))),function(e){return c.apply(this,arguments)})},{key:"onOptionsUpdate",value:function(){this.mask.resize(this.sdkOptions.width,this.sdkOptions.height),this.backgroundTexture.resize(this.sdkOptions.width,this.sdkOptions.height),this.background.frame.resize(this.sdkOptions.width,this.sdkOptions.height),this.container.height=this.sdkOptions.height,this.container.width=this.sdkOptions.width,this.applyLayout(),this.setPreset(this.settings.preset),this.background.calculateBackgroundSize()}},{key:"onSuccess",value:function(e){var t="function"==typeof e;this.onSuccessFunction=t?e:void 0}},{key:"emitSuccess",value:function(){"function"==typeof this.onSuccessFunction&&this.onSuccessFunction()}},{key:"clearBuffers",value:function(){this.pixels=[]}},{key:"nextFrame",value:function(e){if(this.isActive()&&!(this.pixels.length>1)){this.modelTexture=this.resources.texturePool.get(this.model.width,this.model.height),e.sprite.width=this.model.width,e.sprite.height=this.model.height,e.sprite.filters=[this.filters.nchw],this.resources.renderer.renderTo(e.sprite,this.modelTexture),e.sprite.width=this.sdkOptions.width,e.sprite.height=this.sdkOptions.height,e.sprite.filters=[];var t=this.resources.renderer.pixelsAsync(this.modelTexture,{pool:this.resources.bufferPool,texturePool:this.resources.texturePool});this.pixels.push(t)}}},{key:"init",value:(h=Mi(Ri().mark((function e(r){var n,i,o;return Ri().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.modelConfig||(this.modelConfig={modelPath:this.presetManager.getModelURL(this.settings.preset),backend:"webgpu",nchw:!0,data:{preset:this.settings.preset}}),n=this.presetManager.getModelSize(this.settings.preset),i=n.width,o=n.height,this.model.set(this.settings.preset,i,o),"custom"==r.getType()&&r.updateBuffer(i*o),e.next=6,Ui(t,"init",this,3)([r]);case 6:case"end":return e.stop()}}),e,this)}))),function(e){return h.apply(this,arguments)})},{key:"setPreset",value:(l=Mi(Ri().mark((function e(t){var r,n,i;return Ri().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.modelConfig.modelPath!=this.presetManager.getModelURL(t)){e.next=2;break}return e.abrupt("return");case 2:if(!this.onProcessPromise||!this.onProcessPromise.isPending()){e.next=5;break}return e.next=5,this.onProcessPromise.promise;case 5:if(this.onProcessPromise=new oi.c,this.inference.sessionManager.releaseSession(this.modelConfig.modelPath),this.isNewPreset=!0,this.settings.preset=t,this.modelConfig.data.preset=this.settings.preset,this.modelConfig.modelPath=this.presetManager.getModelURL(this.settings.preset),r=this.presetManager.getModelSize(t),n=r.width,i=r.height,"custom"!=this.inference.getType()){e.next=18;break}return e.next=15,this.inference.sessionManager.setPreset(this.settings.preset);case 15:this.inference.updateBuffer(n*i),e.next=20;break;case 18:return e.next=20,this.inference.sessionManager.init(this.modelConfig);case 20:this.model.set(t,n,i),this.onProcessPromise.resolve();case 22:case"end":return e.stop()}}),e,this)}))),function(e){return l.apply(this,arguments)})},{key:"isPresetSupported",value:function(e){var t=this.inference.sessionManager.getSession(this.modelConfig.modelPath);return!(null==t?void 0:t.isGPU)||![ni.SPEED,ni.LIGHTNING].includes(e)}},{key:"updateModelSize",value:(u=Mi(Ri().mark((function e(){var t,r;return Ri().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.pixelBuffer=new Uint8Array(this.model.width*this.model.height*4).fill(255),this.model.previous=new Float32Array(this.model.size/4),this.clearBuffers(),null===(t=this.maskTexture)||void 0===t||t.resize(this.model.width,this.model.height),null===(r=this.mask)||void 0===r||r.resize(this.model.width,this.model.height),this.filters.nchw=new Le(this.model.width,this.model.height),this.filters.nchw.setSize(this.model.width,this.model.height),this.mask&&this.applyLayout();case 8:case"end":return e.stop()}}),e,this)}))),function(){return u.apply(this,arguments)})},{key:"successBackgroundLoad",value:function(){this.emitSuccess()}},{key:"prepare",value:function(){var e=this.model.width,t=this.model.height;this.container=new g.Container,this.container.height=this.sdkOptions.height,this.container.width=this.sdkOptions.width,this.backgroundTexture||(this.backgroundTexture=this.resources.texturePool.get(this.sdkOptions.width,this.sdkOptions.height)),this.background=new Ci(this.sdkOptions,new Vt.w(this.backgroundTexture,{width:this.sdkOptions.width,height:this.sdkOptions.height})),this.background.on("success",this.successBackgroundLoad,this),this.maskTexture=this.resources.texturePool.get(e,t),this.mask=new Vt.w(this.maskTexture,{width:e,height:t}),this.pixelBuffer=new Uint8Array(this.model.width*this.model.height*4).fill(255),this.prepareFilters(),this.applyBlur(),this.updateModelSize(),this.sdkOptions.on("update",this.onOptionsUpdate,this)}},{key:"prepareFilters",value:function(){var e={uIsBoundaryStrong:"strong"===this.settings.boundary_mode,uOriginFrame:this.backgroundTexture,useMask:!0,distColor:1};this.filters.blurMask=new Yn({blur:.1,quality:4,clamp:!0}),this.filters.show=new Nn(e,this.sdkOptions,this.mask.sprite),this.filters.nchw=new Le(this.model.width,this.model.height),this.updateBeautyFilter(),this.mask.sprite.filters=[this.filters.show]}},{key:"updateBeautyFilter",value:function(){this.filters.beautification=new kn({uBeautificationLevel:this.settings.beautification_level,uWidth:this.mask.sprite.width,uHeight:this.mask.sprite.height,radius:this.settings.beautification_radius,highpassEnabled:this.settings.beautification_highpass,sigma:this.settings.beautification_sigma,blurType:this.settings.beautification_blur_type})}},{key:"updateMaskFilters",value:function(){this.mask.sprite.filters=[this.filters.show],this.settings.beautification&&this.mask.sprite.filters.push(this.filters.beautification)}},{key:"clearBackground",value:function(){this.background.clearBackground()}},{key:"process",value:(s=Mi(Ri().mark((function e(t){var r,n,o,a=this;return Ri().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.enabled){e.next=2;break}return e.abrupt("return");case 2:if(this.isActive()){e.next=4;break}return e.abrupt("return");case 4:if(!this.onProcessPromise||!this.onProcessPromise.isPending()){e.next=7;break}return e.next=7,this.onProcessPromise.promise;case 7:if(this.onProcessPromise=new oi.c,this.drawTimer.start(),this.inference&&this.inference.isReady(this.modelConfig.modelPath)){e.next=12;break}return this.onProcessPromise.resolve(),e.abrupt("return");case 12:if(e.prev=12,!this.shouldSegmentationRun()){e.next=18;break}return e.next=16,this.prepareSegmentationMask();case 16:e.next=25;break;case 18:e.prev=18,null===(r=this.pixels.shift())||void 0===r||r.then((function(e){a.resources.bufferPool.returnBuffer(e)})),e.next=25;break;case 22:return e.prev=22,e.t0=e.catch(18),e.abrupt("return");case 25:e.next=31;break;case 27:e.prev=27,e.t1=e.catch(12),this.disable(),e.t1&&i.bv.notify({message:"Prepare segmentation mask. "+(null!==(n=e.t1.message)&&void 0!==n?n:e.t1),type:i.By.ERROR,emitter:i.JK.EFFECT_VIRTUAL_BACKGROUND,cause:e.t1});case 31:this.skip_frames_counter=this.skip_frames_counter?0:1,this.resources.renderer.renderTo(t.sprite,this.backgroundTexture),this.settings.layout_mode!=ki.TRANSPARENT&&(this.container.addChild(this.background.frame.sprite),this.background.render()),this.container.addChild(this.mask.sprite),o=this.resources.texturePool.get(this.sdkOptions.width,this.sdkOptions.height),this.resources.renderer.renderTo(this.container,o),this.resources.texturePool.put(t.update(o)),this.container.removeChildren(),this.drawTimer.finish(),this.resources.renderer.updateStatistics("frame_time",this.drawTimer.getFrameTime()),this.resources.renderer.updateStatistics("inference_time",this.inferenceTimer.getFrameTime()),this.onProcessPromise.resolve();case 43:case"end":return e.stop()}}),e,this,[[12,27],[18,22]])}))),function(e){return s.apply(this,arguments)})},{key:"isActive",value:function(){return null!==this.background.options.source||"center"!==this.settings.layout||!!this.settings.blur||!!this.settings.beautification}},{key:"shouldSegmentationRun",value:function(){return(!this.settings.skip_frames||!this.skip_frames_counter)&&(this.settings.layout_mode===ki.SEGMENTATION||this.settings.layout_mode===ki.TRANSPARENT)&&this.isActive()}},{key:"setBoundaryMode",value:function(e){this.settings.boundary_mode=e,this.filters.show.setIsBoundaryStrong("strong"===e)}},{key:"setBoundaryLevel",value:function(e){i.bv.notify({message:"Boundary level was deprecated and will not show any effect.",type:i.By.INFO,emitter:i.JK.EFFECT_VIRTUAL_BACKGROUND})}},{key:"setBeautificationLevel",value:function(e){e=.34+.34*(e=1-Math.min(Math.max(Number(e),0),1)),this.filters.beautification.setBeautificationLevel(e)}},{key:"enableFrameSkipping",value:function(){this.settings.skip_frames=!0}},{key:"disableFrameSkipping",value:function(){this.settings.skip_frames=!1}},{key:"enableBeautification",value:function(){this.settings.beautification||(this.mask.sprite.filters.push(this.filters.beautification),this.settings.beautification=!0)}},{key:"disableBeautification",value:function(){this.settings.beautification&&(this.mask.sprite.filters.pop(),this.settings.beautification=!1)}},{key:"getPreset",value:function(){return this.settings.preset}},{key:"setLayout",value:function(e){this.settings.layout=e,this.applyLayout()}},{key:"setLayoutMode",value:function(e){this.settings.layout_mode=e,this.filters.show.setLayoutMode(e)}},{key:"setCustomLayout",value:function(e){var t=this;Object.keys(e).forEach((function(r){t.customLayoutOptions[r]=e[r]})),this.updateMaskPosition(this.customLayoutOptions.width,this.customLayoutOptions.height,this.customLayoutOptions.xOffset,this.customLayoutOptions.yOffset)}},{key:"applyLayout",value:function(){switch(this.settings.layout){case"left":this.updateMaskPosition(this.sdkOptions.width,this.sdkOptions.height,-this.sdkOptions.width/4,0);break;case"right":this.updateMaskPosition(this.sdkOptions.width,this.sdkOptions.height,this.sdkOptions.width/4,0);break;case"left-bottom":this.updateMaskPosition(this.sdkOptions.width/2,this.sdkOptions.height/2,0,this.sdkOptions.height/2);break;case"right-bottom":this.updateMaskPosition(this.sdkOptions.width/2,this.sdkOptions.height/2,this.sdkOptions.width/2,this.sdkOptions.height/2);break;case"center":this.updateMaskPosition(this.sdkOptions.width,this.sdkOptions.height,0,0)}}},{key:"updateMaskPosition",value:function(e,t,r,n){this.mask.sprite.width=e,this.mask.sprite.height=t,this.mask.sprite.position.x=r,this.mask.sprite.position.y=n,this.filters.show.setLayout()}},{key:"setBackground",value:function(e){this.background.set(e)}},{key:"setBackgroundFitMode",value:function(e){this.background.setFitMode(e)}},{key:"setBackgroundColor",value:function(e){this.background.setColor(e)}},{key:"setBlur",value:function(e){this.settings.blur=e,this.applyBlur()}},{key:"clearBlur",value:function(){this.settings.blur=0,this.applyBlur()}},{key:"applyBlur",value:function(){this.background.applyBlur(this.settings.blur),this.emitSuccess()}},{key:"prepareSegmentationMask",value:(a=Mi(Ri().mark((function e(){var t,r,n,o,a,s,u,l=this;return Ri().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.enabled){e.next=2;break}return e.abrupt("return");case 2:if(t=this.model.width,r=this.model.height,this.pixels.length){e.next=6;break}return e.abrupt("return");case 6:return e.prev=6,e.next=9,this.pixels.shift();case 9:n=e.sent,e.next=15;break;case 12:return e.prev=12,e.t0=e.catch(6),e.abrupt("return");case 15:if((null==n?void 0:n.length)==4*t*r){e.next=17;break}return e.abrupt("return");case 17:if(o=3*t*r,(a=this.resources.bufferPool.getBuffer("f32",4*t*r)).set(n.subarray(0,o)),a.set(this.model.previous,o),this.resources.bufferPool.returnBuffer(n),this.inferenceTimer.start(),s={seg:{data:this.resources.bufferPool.getBuffer("f32",t*r),dims:[1,1,r,t]}},u=this.inference.sessionManager.getSession(this.modelConfig.modelPath)){e.next=27;break}return e.abrupt("return");case 27:return e.abrupt("return",this.inference.run(u,a,t,r,4,s).then((function(e){var n,i,o,a;if(l.inferenceTimer.finish(),l.isNewPreset)l.isNewPreset=!1;else{l.resources.bufferPool.returnBuffer(null!==(n=e.inputBack.data)&&void 0!==n?n:e.inputBack);var s=null!==(a=null!==(o=null===(i=e.seg)||void 0===i?void 0:i.data)&&void 0!==o?o:e.seg)&&void 0!==a?a:e;l.model.previous&&l.resources.bufferPool.returnBuffer(l.model.previous),l.model.previous=s;for(var u=0;u<l.model.previous.length;u++)l.pixelBuffer[4*u+3]=255*s[u];var h=l.resources.renderer.createTextureFromBuffer(l.pixelBuffer,t,r),c=new Vt.w(h,{width:t,height:r});c.sprite.filters=[l.filters.blurMask],l.resources.renderer.renderTo(c.sprite,l.maskTexture),h.destroy(!0),l.background.setMask(l.maskTexture)}})).catch((function(e){var t;i.bv.notify({message:null!==(t=e.message)&&void 0!==t?t:e,type:i.By.ERROR,code:i.O4.INFERENCE_RUN_ISSUE,emitter:i.JK.EFFECT_VIRTUAL_BACKGROUND,cause:e})})));case 28:case"end":return e.stop()}}),e,this,[[6,12]])}))),function(){return a.apply(this,arguments)})},{key:"setBeauty",value:function(e){this.settings.beautification_radius=e.rad||this.settings.beautification_radius,null!==e.highpass&&void 0!==e.highpass&&(this.settings.beautification_highpass=e.highpass),this.settings.beautification_sigma=e.sigma||this.settings.beautification_sigma,e.blur&&(this.settings.beautification_blur_type=e.blur),this.updateBeautyFilter(),this.settings.beautification&&this.updateMaskFilters()}},{key:"destroy",value:function(){this.disable(),this.clearBuffers(),this.sdkOptions.off("update",this.onOptionsUpdate,this),this.model.off("update",this.updateModelSize,this),this.background.off("update",this.successBackgroundLoad,this),this.inference.sessionManager.releaseSession(this.modelConfig.modelPath),this.background.destroy()}}],n&&Li(r.prototype,n),o&&Li(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o,a,s,u,l,h,c}(d);function Hi(e){return Hi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Hi(e)}function qi(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Yi(n.key),n)}}function Yi(e){var t=function(e,t){if("object"!=Hi(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=Hi(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Hi(t)?t:t+""}!function(e){e.COLOR_CORRECION="color_correction",e.COLOR_FILTERS="color_filters",e.CUSTOM_RESOLUTION="custom_resolution",e.EYE_CONTACT="eye_contact",e.FILTER_DRAW="filter_draw",e.FINAL_DRAW="final_draw",e.LOW_LIGHT="low_light",e.MIRRORING="mirroring",e.SHARPNESS="sharpness",e.SMART_ZOOM="smart_zoom",e.VIRTUAL_BACKGROUND="virtual_background"}(Vi||(Vi={}));var Xi={};Xi[Vi.COLOR_CORRECION]=F,Xi[Vi.COLOR_FILTERS]=we,Xi[Vi.CUSTOM_RESOLUTION]=Ie,Xi[Vi.EYE_CONTACT]=Ye,Xi[Vi.FILTER_DRAW]=it,Xi[Vi.FINAL_DRAW]=pt,Xi[Vi.LOW_LIGHT]=sr,Xi[Vi.MIRRORING]=Er,Xi[Vi.SHARPNESS]=Vr,Xi[Vi.SMART_ZOOM]=vn,Xi[Vi.VIRTUAL_BACKGROUND]=Wi;var Ki=function(){return e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)},r=[{key:"getEffect",value:function(e,t){return new Xi[e](t)}}],(t=null)&&qi(e.prototype,t),r&&qi(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,r}()},9380:(e,t,r)=>{r.d(t,{w:()=>d});var n=r(4486),i=r(5034),o=r(2546);function a(e){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a(e)}function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,u(n.key),n)}}function u(e){var t=function(e,t){if("object"!=a(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=a(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==a(t)?t:t+""}function l(e,t,r){return t=c(t),function(e,t){if(t&&("object"==a(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,h()?Reflect.construct(t,r||[],c(e).constructor):t.apply(e,r))}function h(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(h=function(){return!!e})()}function c(e){return c=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},c(e)}function f(e,t){return f=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},f(e,t)}var d=function(e){function t(e,r){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=l(this,t)).active="origin",n.textures=new Map,n.buffers=new Map,e instanceof o.g?(n.sprite=new i.Sprite(e.get()),n.textures.set("origin",e.get()),e.on("replace",n.onReplace,n)):(n.sprite=new i.Sprite(e),n.textures.set("origin",e)),n.sprite.width=r.width,n.sprite.height=r.height,n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&f(e,t)}(t,e),r=t,n=[{key:"onReplace",value:function(e){e instanceof o.g&&(e=e.get()),this.textures.set("origin",e),"origin"==this.active&&(this.sprite.texture=e)}},{key:"update",value:function(e){var t=this.sprite.texture;return e instanceof i.Texture?this.sprite.texture=e:this.sprite.texture=e.texture,t instanceof i.RenderTexture?t:(t.destroy(!0),null)}},{key:"addTexture",value:function(e,t){var r,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return this.textures.has(e)&&(n&&(null===(r=this.textures.get(e))||void 0===r||r.destroy(!0)),this.textures.delete(e)),this.textures.set(e,t),!0}},{key:"getTexture",value:function(e){if(this.textures.has(e))return this.textures.get(e);throw new Error("There is no such texture")}},{key:"addBuffer",value:function(e){var t,r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return this.buffers.has(e)&&(r&&(null===(t=this.buffers.get(e))||void 0===t||t.destroy(!0)),this.buffers.delete(e)),this.buffers.set(e,i.RenderTexture.create({width:this.sprite.width,height:this.sprite.height})),!0}},{key:"getBuffer",value:function(e){if(this.buffers.has(e))return this.buffers.get(e);throw new Error("There is no such buffer")}},{key:"resize",value:function(e,t){this.sprite.width=e,this.sprite.height=t,this.buffers.forEach((function(r,n){r.resize(e,t)}))}},{key:"activateBuffer",value:function(e){this.buffers.has(e)&&(this.sprite.texture=this.buffers.get(e),this.active=e)}},{key:"activateTexture",value:function(e){this.textures.has(e)&&(this.sprite.texture=this.textures.get(e),this.active=e)}}],n&&s(r.prototype,n),a&&s(r,a),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,a}(n.b);d.defaultOptions={width:100,height:100}},8592:(e,t,r)=>{r.d(t,{O:()=>s});var n=r(5034);function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,a(n.key),n)}}function a(e){var t=function(e,t){if("object"!=i(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=i(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==i(t)?t:t+""}var s=function(){return e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.textures=new Map},(t=[{key:"get",value:function(e,t){var r=e.toString()+"x"+t.toString();if(this.textures.has(r)){var i=this.textures.get(r);if(null==i?void 0:i.length)return i.shift()}return n.RenderTexture.create({width:e,height:t})}},{key:"put",value:function(e){var t;if(e){var r=e.width.toString()+"x"+e.height.toString();this.textures.has(r)?null===(t=this.textures.get(r))||void 0===t||t.push(e):this.textures.set(r,[e])}}},{key:"destroy",value:function(){this.textures.forEach((function(e){e.forEach((function(e){e.destroy(!0)}))})),this.textures=new Map}}])&&o(e.prototype,t),r&&o(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,r}()},2546:(e,t,r)=>{r.d(t,{g:()=>f});var n=r(4486),i=r(5034);function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,s(n.key),n)}}function s(e){var t=function(e,t){if("object"!=o(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=o(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==o(t)?t:t+""}function u(e,t){if(t&&("object"==o(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function l(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(l=function(){return!!e})()}function h(e){return h=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},h(e)}function c(e,t){return c=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},c(e,t)}var f=function(e){function t(e){var r,n,o,a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,o=h(o=t),(r=u(n,l()?Reflect.construct(o,a||[],h(n).constructor):o.apply(n,a))).shouldBeDestroed=!0,e?(e instanceof i.Texture?r.texture=e:r.texture=i.Texture.from(e),r):(r.texture=new i.Texture(new i.BaseTexture),u(r))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&c(e,t)}(t,e),r=t,n=[{key:"get",value:function(){return this.texture}},{key:"update",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(!e)return this.texture.update(),void this.emit("update",this);this.texture&&this.shouldBeDestroed&&this.texture.destroy(!0),e instanceof i.Texture?this.texture=e:this.texture=i.Texture.from(e),this.shouldBeDestroed=t,this.emit("replace",this)}},{key:"destroy",value:function(){this.texture&&this.texture.destroy(!0),this.removeAllListeners()}}],n&&a(r.prototype,n),o&&a(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o}(n.b)},8380:(e,t,r)=>{r.d(t,{y:()=>f});var n=r(2111);const i="3.5.3";function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,u(n.key),n)}}function s(e,t,r){return t&&a(e.prototype,t),r&&a(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function u(e){var t=function(e,t){if("object"!=o(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=o(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==o(t)?t:t+""}function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var h={overlay:!1,overlay_attrs:{url:"https://effectssdk.ai/assets/videos/overlay/esdk.mp4"},lowerthird:!1,lowerthird_type:"lowerthird_3",lowerthird_text:{text:{title:"Max Troshin",subtitle:"CEO at Effects SDK / effectssdk.com"}},lowerthird_color:{color:{primary:161271}},lowerthird_offset:{offset:{x:15/1280,y:75/720}},emoji_duration:{duration:3500},emoji_size:{size:.3},emoji_position:{position:{placement:"top-left"}},giphy_duration:{duration:3500},giphy_size:{size:.3},giphy_position:{position:{placement:"top-left"}},seg_mode:"balanced",background:"none",layout:"center",layout_custom:void 0,blur:!0,blur_power:.6,beautification:!0,beauty_power:.68,boundary:0,frameskipping:!1,sz_switch:!0,sz_facearea:.1,sz_drawface:!1,sz_drawprefaces:!1,sz_accuracy:.75,sz_smoothing:.2,sz_period:100,cc_switch:!1,cc_power:1,cc_part:1,cc_period:1e3,cf_switch:!1,cf_lut:{lut:"none"},cf_part:{part:1},cf_power:{power:1},cf_capacity:{capacity:5},sh_switch:!1,sh_power:.5},c=s((function e(){l(this,e)}));c.APP_ENV="web",c.API_URL="https://effectssdk.ai/sdk/session/",c.STATS_URL="https://effectssdk.ai/sdk/stats/",c.BASE_URL="https://effectssdk.ai/",c.SDK_URL=c.BASE_URL+"sdk/",c.VB_MODEL=c.SDK_URL+"models/model-1.2.1.0.tsvb",c.PRESET="balanced",c.DEMO_IMAGE=c.SDK_URL+"100.jpg",c.DEMO_VIDEO=c.SDK_URL+"video-background.mp4";var f=function(){function e(){l(this,e)}return s(e,null,[{key:"getModelUrl",value:function(t){return e.SDK_URL+t}},{key:"getPresetUrl",value:function(t){return e.SDK_URL+t}},{key:"setVersion",value:function(){e.VERSION=i}}])}();f.EFFECTS=[n.U.SMART_ZOOM,n.U.VIRTUAL_BACKGROUND,n.U.LOW_LIGHT,n.U.COLOR_CORRECION],f.VERSION="0.0.0",f.CUSTOMER_ID="",f.APP_ENV=c.APP_ENV,f.API_URL=c.API_URL,f.STATS_URL=c.STATS_URL,f.MODEL_URL=c.SDK_URL+"models/model-1.2.1.tsvb",f.PRESET=c.PRESET,f.SDK_URL=c.SDK_URL,f.MODELS={colorcorrector:"models/model-cc-1.0.0.tsvb",facedetector:"models/model-fd-1.1.0.tsvb",lowlighter:"models/model-ll-1.2.0.tsvb"},f.PROXY=!0,f.STATS=!1,f.CACHE_MODELS=!0,f.PROVIDER="webgpu",f.WASM_PATHS={},f.PRESETS={quality:"models/model-1.0.1.tsvb",balanced:"models/model-5.5.0.tsvb",speed:"models/model-3.1.1.tsvb",lightning:"models/model-4.0.1.tsvb"},f.PRESETS_PORTRAIT={quality:"models/m-model-1.0.1.tsvb",balanced:"models/m-model-5.5.0.tsvb",speed:"models/m-model-3.1.1.tsvb",lightning:"models/m-model-4.0.1.tsvb"},f.STATES_PRESET=h},7940:(e,t,r)=>{r.d(t,{o:()=>mm});var n=r(9672),i=r(5862),o=r(8699),a=r(6903);function s(e){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s(e)}function u(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,l(n.key),n)}}function l(e){var t=function(e,t){if("object"!=s(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=s(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==s(t)?t:t+""}var h=function(){return e=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.video=null,this.stream=null,this.videoTrack=null,this.audioTrack=null,this.transformFrame=null,this.updateVideoTrack=null,this.toCanvas=null,this.lastFrameTime=0,this.fpsLimit=30,this.timestamp=0,this.isRunning=!1,this.isPaused=!1,this.sdkOptions=t,this.frameTimer=new o.S,this.frameTime=0,this.fps=0,this.enableFps=!1,this.frame_count=0,this.videoTrackWrapper=new i.D,this.videoTrackWrapper.setSdkOptions(this.sdkOptions),this.videoTrackWrapper.on("update",this.onTrackUpdate,this)},t=[{key:"onTrackUpdate",value:function(){this.sdkOptions.setSize(this.videoTrackWrapper.width,this.videoTrackWrapper.height),"function"==typeof this.changeInputResolutionFuncition&&this.changeInputResolutionFuncition()}},{key:"clearBuffers",value:function(){}},{key:"getSnapshot",value:function(){return this.snapshot&&this.snapshot.isPending()||(this.snapshot=new a.c),this.snapshot.promise}},{key:"onChangeInputResolution",value:function(e){var t="function"==typeof e;this.changeInputResolutionFuncition=t?e:void 0}},{key:"onFrameDraw",value:function(e){var t="function"==typeof e;this.frameDrawFunction=t?e:void 0}},{key:"setCustomResolution",value:function(e,t){this.sdkOptions.setCustomSize(e,t)}},{key:"clearCustomResolution",value:function(){this.sdkOptions.clearCustomSize()}},{key:"clearOutputResolution",value:function(){this.sdkOptions.customSize=!1,this.sdkOptions.setSize(this.videoTrackWrapper.width,this.videoTrackWrapper.height)}},{key:"useEffectProcessor",value:function(e){this.effectProcessor=e}},{key:"pause",value:function(){this.isPaused=!0}},{key:"unpause",value:function(){this.isPaused=!1}},{key:"setRenderer",value:function(e){this.renderer=e}},{key:"destroy",value:function(){this.videoTrackWrapper.off("update",this.onTrackUpdate,this)}},{key:"setFpsLimit",value:function(e){var t;this.fpsLimit=e,null===(t=this.getInputVideoTrack())||void 0===t||t.applyConstraints({frameRate:this.fpsLimit})}},{key:"useStream",value:function(e){this.stream=e,this.useVideoTrack(this.stream.getVideoTracks()[0])}},{key:"useVideoTrack",value:function(e){this.videoTrack=e,this.videoTrackWrapper.set(this.videoTrack)}},{key:"getInputStream",value:function(){return this.stream?this.stream:null}},{key:"getInputVideoTrack",value:function(){return this.videoTrack?this.videoTrack:null}},{key:"showFps",value:function(){this.enableFps=!0}},{key:"hideFps",value:function(){this.enableFps=!1,this.renderer.hideStatistics()}},{key:"drawFps",value:function(){this.enableFps&&this.frame_count%30==0&&(this.renderer.updateStatistics("output_fps",this.frameTimer.getFrameFps()),this.renderer.drawStatistics())}},{key:"process",value:function(){this.transformFrame&&this.transformFrame()}},{key:"clearTransformCallback",value:function(){this.transformFrame=null}},{key:"transformCallback",value:function(e){this.transformFrame=e}},{key:"renderToCanvas",value:function(e){this.toCanvas=e}},{key:"getStream",value:function(){return this.stream}}],t&&u(e.prototype,t),r&&u(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,r}(),c=r(5034),f=r(8389);function d(e){return d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},d(e)}var p=function(e,t){var r=null;return function(){if(null!==r)return r;var n=new Blob([t],{type:"application/javascript; charset=utf-8"}),i=URL.createObjectURL(n);return r=e(i),setTimeout((function(){return URL.revokeObjectURL(i)})),r}}((function(e){var t=new Map([[0,function(){}]]),r=new Map([[0,function(){}]]),i=new Map,o=new Worker(e);o.addEventListener("message",(function(e){var o=e.data;if(function(e){return void 0!==e.method&&"call"===e.method}(o)){var a=o.params,s=a.timerId,u=a.timerType;if("interval"===u){var l=t.get(s);if(void 0===d(l)&&n.bv.notify({message:"The timer is in an undefined state.",emitter:n.JK.WORKER_TIMERS}),"number"==typeof l){var h=i.get(l);void 0!==h&&h.timerId===s&&h.timerType===u||n.bv.notify({message:"The timer is in an undefined state.",emitter:n.JK.WORKER_TIMERS})}else"function"==typeof l&&l()}else if("timeout"===u){var c=r.get(s);if(void 0===d(c)&&n.bv.notify({message:"The timer is in an undefined state.",emitter:n.JK.WORKER_TIMERS}),"number"==typeof c){var f=i.get(c);void 0!==f&&f.timerId===s&&f.timerType===u||n.bv.notify({message:"The timer is in an undefined state.",emitter:n.JK.WORKER_TIMERS})}else"function"==typeof c&&(c(),r.delete(s))}}else if(function(e){return"number"==typeof e.id&&"boolean"==typeof e.result}(o)){var p=o.id,y=i.get(p);void 0===y&&n.bv.notify({message:"The timer is in an undefined state.",emitter:n.JK.WORKER_TIMERS});var m=y.timerId,g=y.timerType;i.delete(p),"interval"===g?t.delete(m):r.delete(m)}else{var w=o.error.message;n.bv.notify({message:w,emitter:n.JK.WORKER_TIMERS})}}));return{clearInterval:function(e){if("function"==typeof t.get(e)){var r=(0,f.generateUniqueNumber)(i);i.set(r,{timerId:e,timerType:"interval"}),t.set(e,r),o.postMessage({id:r,method:"clear",params:{timerId:e,timerType:"interval"}})}},clearTimeout:function(e){if("function"==typeof r.get(e)){var t=(0,f.generateUniqueNumber)(i);i.set(t,{timerId:e,timerType:"timeout"}),r.set(e,t),o.postMessage({id:t,method:"clear",params:{timerId:e,timerType:"timeout"}})}},setInterval:function(e){for(var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length,i=new Array(n>2?n-2:0),a=2;a<n;a++)i[a-2]=arguments[a];var s=(0,f.generateUniqueNumber)(t);return t.set(s,(function(){e.apply(void 0,i),"function"==typeof t.get(s)&&o.postMessage({id:null,method:"set",params:{delay:r,now:performance.timeOrigin+performance.now(),timerId:s,timerType:"interval"}})})),o.postMessage({id:null,method:"set",params:{delay:r,now:performance.timeOrigin+performance.now(),timerId:s,timerType:"interval"}}),s},setTimeout:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length,i=new Array(n>2?n-2:0),a=2;a<n;a++)i[a-2]=arguments[a];var s=(0,f.generateUniqueNumber)(r);return r.set(s,(function(){return e.apply(void 0,i)})),o.postMessage({id:null,method:"set",params:{delay:t,now:performance.timeOrigin+performance.now(),timerId:s,timerType:"timeout"}}),s}}}),'(()=>{"use strict";const e=new Map,t=new Map,r=t=>{const r=e.get(t);return void 0!==r&&(clearTimeout(r),e.delete(t),!0)},s=e=>{const r=t.get(e);return void 0!==r&&(clearTimeout(r),t.delete(e),!0)},o=(e,t)=>{const r=performance.now(),s=e+t-r-performance.timeOrigin;return{expected:r+s,remainingDelay:s}},i=(e,t,r,s)=>{const o=r-performance.now();o>0?e.set(t,setTimeout(i,o,e,t,r,s)):(e.delete(t),postMessage({id:null,method:"call",params:{timerId:t,timerType:s}}))};addEventListener("message",(({data:n})=>{try{if("clear"===n.method){const{id:e,params:{timerId:t,timerType:o}}=n;if("interval"===o)postMessage({id:e,result:r(t)});else{if("timeout"!==o)throw new Error(\'The given type "\'.concat(o,\'" is not supported\'));postMessage({id:e,result:s(t)})}}else{if("set"!==n.method)throw new Error(\'The given method "\'.concat(n.method,\'" is not supported\'));{const{params:{delay:r,now:s,timerId:a,timerType:m}}=n;if("interval"===m)((t,r,s)=>{const{expected:n,remainingDelay:a}=o(t,s);e.set(r,setTimeout(i,a,e,r,n,"interval"))})(r,a,s);else{if("timeout"!==m)throw new Error(\'The given type "\'.concat(m,\'" is not supported\'));((e,r,s)=>{const{expected:n,remainingDelay:a}=o(e,s);t.set(r,setTimeout(i,a,t,r,n,"timeout"))})(r,a,s)}}}}catch(e){postMessage({error:{message:e.message},id:n.id,result:null})}}))})();'),y=function(e){return p().clearInterval(e)},m=function(e){return p().clearTimeout(e)},g=function(){var e;return(e=p()).setInterval.apply(e,arguments)},w=function(){var e;return(e=p()).setTimeout.apply(e,arguments)},v=r(2546),b=r(9380);function x(e){return x="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},x(e)}function _(){_=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,i=Object.defineProperty||function(e,t,r){e[t]=r.value},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function l(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,r){return e[t]=r}}function h(e,t,r,n){var o=t&&t.prototype instanceof g?t:g,a=Object.create(o.prototype),s=new $(n||[]);return i(a,"_invoke",{value:I(e,r,s)}),a}function c(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=h;var f="suspendedStart",d="suspendedYield",p="executing",y="completed",m={};function g(){}function w(){}function v(){}var b={};l(b,a,(function(){return this}));var S=Object.getPrototypeOf,T=S&&S(S(R([])));T&&T!==r&&n.call(T,a)&&(b=T);var E=v.prototype=g.prototype=Object.create(b);function O(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function A(e,t){function r(i,o,a,s){var u=c(e[i],e,o);if("throw"!==u.type){var l=u.arg,h=l.value;return h&&"object"==x(h)&&n.call(h,"__await")?t.resolve(h.__await).then((function(e){r("next",e,a,s)}),(function(e){r("throw",e,a,s)})):t.resolve(h).then((function(e){l.value=e,a(l)}),(function(e){return r("throw",e,a,s)}))}s(u.arg)}var o;i(this,"_invoke",{value:function(e,n){function i(){return new t((function(t,i){r(e,n,t,i)}))}return o=o?o.then(i,i):i()}})}function I(t,r,n){var i=f;return function(o,a){if(i===p)throw Error("Generator is already running");if(i===y){if("throw"===o)throw a;return{value:e,done:!0}}for(n.method=o,n.arg=a;;){var s=n.delegate;if(s){var u=P(s,n);if(u){if(u===m)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===f)throw i=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i=p;var l=c(t,r,n);if("normal"===l.type){if(i=n.done?y:d,l.arg===m)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(i=y,n.method="throw",n.arg=l.arg)}}}function P(t,r){var n=r.method,i=t.iterator[n];if(i===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,P(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),m;var o=c(i,t.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,m;var a=o.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,m):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,m)}function k(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function C(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function $(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(k,this),this.reset(!0)}function R(t){if(t||""===t){var r=t[a];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,o=function r(){for(;++i<t.length;)if(n.call(t,i))return r.value=t[i],r.done=!1,r;return r.value=e,r.done=!0,r};return o.next=o}}throw new TypeError(x(t)+" is not iterable")}return w.prototype=v,i(E,"constructor",{value:v,configurable:!0}),i(v,"constructor",{value:w,configurable:!0}),w.displayName=l(v,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===w||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,v):(e.__proto__=v,l(e,u,"GeneratorFunction")),e.prototype=Object.create(E),e},t.awrap=function(e){return{__await:e}},O(A.prototype),l(A.prototype,s,(function(){return this})),t.AsyncIterator=A,t.async=function(e,r,n,i,o){void 0===o&&(o=Promise);var a=new A(h(e,r,n,i),o);return t.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},O(E),l(E,u,"Generator"),l(E,a,(function(){return this})),l(E,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=R,$.prototype={constructor:$,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(C),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function i(n,i){return s.type="throw",s.arg=t,r.next=n,i&&(r.method="next",r.arg=e),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),l=n.call(a,"finallyLoc");if(u&&l){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return i(a.catchLoc,!0)}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,m):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),C(r),m}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;C(r)}return i}}throw Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:R(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),m}},t}function S(e,t,r,n,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void r(e)}s.done?t(u):Promise.resolve(u).then(n,i)}function T(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var o=e.apply(t,r);function a(e){S(o,n,i,a,s,"next",e)}function s(e){S(o,n,i,a,s,"throw",e)}a(void 0)}))}}function E(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,O(n.key),n)}}function O(e){var t=function(e,t){if("object"!=x(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=x(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==x(t)?t:t+""}function A(e,t,r){return t=k(t),function(e,t){if(t&&("object"==x(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,I()?Reflect.construct(t,r||[],k(e).constructor):t.apply(e,r))}function I(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(I=function(){return!!e})()}function P(){return P="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=function(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=k(e)););return e}(e,t);if(n){var i=Object.getOwnPropertyDescriptor(n,t);return i.get?i.get.call(arguments.length<3?e:r):i.value}},P.apply(null,arguments)}function k(e){return k=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},k(e)}function C(e,t){return C=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},C(e,t)}var $=function(e){function t(e){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(r=A(this,t,[e])).inprocess=!1,r.duration=30,r.textures=[],r.inputVideo=document.createElement("video"),r.duration=1e3/r.fpsLimit,r.sdkOptions.on("update",r.onOptionsUpdate,r),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&C(e,t)}(t,e),r=t,i=[{key:"onOptionsUpdate",value:function(e){this.videoFrame&&this.videoFrame.resize(this.sdkOptions.width,this.sdkOptions.height)}},{key:"onTrackUpdate",value:function(){var e,r,n,i,o;(e=t,r="onTrackUpdate",n=this,o=P(k(1&(i=3)?e.prototype:e),r,n),2&i&&"function"==typeof o?function(e){return o.apply(n,e)}:o)([]),this.videoFrame&&this.videoFrame.resize(this.sdkOptions.width,this.sdkOptions.height)}},{key:"setFpsLimit",value:function(e){var t=this;this.fpsLimit=e,this.duration=1e3/this.fpsLimit;try{this.gatherFramesInterval&&(y(this.gatherFramesInterval),this.gatherFramesInterval=0,this.gatherFramesInterval=g((function(){t.gatherByTimers()}),this.duration))}catch(e){}}},{key:"setRenderer",value:function(e){this.renderer=e}},{key:"destroy",value:function(){this.stopTimers()}},{key:"clearBuffers",value:function(){this.effectProcessor.clearBuffers()}},{key:"stopTimers",value:function(){try{this.gatherFramesTimeout&&(m(this.gatherFramesTimeout),this.gatherFramesTimeout=0),this.handleFramesTimeout&&(m(this.handleFramesTimeout),this.handleFramesTimeout=0),this.gatherFramesInterval&&(y(this.gatherFramesInterval),this.gatherFramesInterval=0)}catch(e){}}},{key:"startTimers",value:function(){var e=this;try{this.gatherFramesInterval=g((function(){e.gatherByTimers()}),this.duration)}catch(e){}this.gatherByCallback(),this.handleFrames()}},{key:"gatherByCallback",value:(f=T(_().mark((function e(){return _().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),function(){return f.apply(this,arguments)})},{key:"gatherByTimers",value:(h=T(_().mark((function e(){return _().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:document.hidden&&this.gatherFrames();case 1:case"end":return e.stop()}}),e,this)}))),function(){return h.apply(this,arguments)})},{key:"gatherFrames",value:(l=T(_().mark((function e(){var t,r;return _().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.textures.length>1&&(t=this.textures.shift(),this.effectProcessor?t&&this.effectProcessor.resources.texturePool.put(t):null==t||t.destroy(!0)),this.videoTexture&&(this.videoTexture.update(),r=this.effectProcessor?this.effectProcessor.resources.texturePool.get(this.sdkOptions.width,this.sdkOptions.height):c.RenderTexture.create({width:this.sdkOptions.width,height:this.sdkOptions.height}),this.renderer.renderTo(this.videoFrame.sprite,r),this.textures.push(r));case 2:case"end":return e.stop()}}),e,this)}))),function(){return l.apply(this,arguments)})},{key:"nextTick",value:(u=T(_().mark((function e(){var t;return _().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.frame_count++,this.lastFrameTime=performance.now(),this.frameTimer.finish(),this.frameTimer.start(),e.next=6,this.effectProcessor.process();case 6:this.snapshot&&this.snapshot.isPending()&&this.snapshot.resolve(createImageBitmap(this.renderer.renderer.view)),this.drawFps(),this.toCanvas&&(null===(t=this.toCanvas.getContext("2d"))||void 0===t||t.drawImage(this.renderer.renderer.view,0,0,this.toCanvas.width,this.toCanvas.height));case 9:case"end":return e.stop()}}),e,this)}))),function(){return u.apply(this,arguments)})},{key:"handleFrames",value:(s=T(_().mark((function e(){var t,r,n,i,o=this;return _().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.textures.length){e.next=2;break}return e.abrupt("return",this.handleFramesTimeout=w((function(){o.handleFrames()}),10));case 2:if(this.inputVideo.paused&&this.inputVideo.play(),n=performance.now(),null===(t=this.frameDrawFunction)||void 0===t||t.call(this),this.videoTrackWrapper.update(this.inputVideo.videoWidth,this.inputVideo.videoHeight),this.isRunning&&!this.isPaused&&this.effectProcessor){e.next=15;break}return this.textures.forEach((function(e){o.effectProcessor?e&&o.effectProcessor.resources.texturePool.put(e):null==e||e.destroy(!0)})),this.textures=[],this.renderer.addToEffects(this.videoFrame.sprite),this.renderer.render(),this.renderer.removeFromEffects(this.videoFrame.sprite),this.snapshot&&this.snapshot.isPending()&&this.snapshot.resolve(createImageBitmap(this.renderer.renderer.view)),this.toCanvas&&(null===(r=this.toCanvas.getContext("2d"))||void 0===r||r.drawImage(this.renderer.renderer.view,0,0,this.toCanvas.width,this.toCanvas.height)),e.abrupt("return",this.handleFramesTimeout=w((function(){o.handleFrames()}),Math.max(0,this.duration-(performance.now()-n))));case 15:if(i=this.textures.shift(),this.effectProcessor.nextFrame(new v.g(i)),!this.onProcessPromise||!this.onProcessPromise.isPending()){e.next=20;break}return e.next=20,this.onProcessPromise.promise;case 20:return this.onProcessPromise=new a.c,this.nextTick().then((function(){o.onProcessPromise.resolve()})),e.abrupt("return",this.handleFramesTimeout=w((function(){o.handleFrames()}),0));case 23:case"end":return e.stop()}}),e,this)}))),function(){return s.apply(this,arguments)})},{key:"process",value:function(){var e=this;if(this.stopTimers(),this.getInputVideoTrack()){var t=this.getInputVideoStream();t&&(this.inputVideo.srcObject=t,this.inputVideo.muted=!0,this.inputVideo.setAttribute("playsinline",!0),this.inputVideo.playsInline=!0,this.inputVideo.play().then((function(){e.videoTexture=new v.g(e.inputVideo),e.videoFrame=new b.w(e.videoTexture,{width:e.sdkOptions.width,height:e.sdkOptions.height})}))),this.startTimers()}else n.bv.notify({message:"there is no videoTrack to process",type:n.By.ERROR,code:n.O4.NO_VIDEO_TRACK,emitter:n.JK.SRTEAM_PROCESSOR})}},{key:"getInputVideoStream",value:function(){return this.stream?this.stream:null}},{key:"getStream",value:function(){var e=this;return this.outputStream||(this.outputStream=this.renderer.renderer.view.captureStream(30),this.outputStream.getVideoTracks()[0].getSettings=function(){return e.videoTrackWrapper.getSettings()},this.outputStream.getVideoTracks()[0].getConstraints=function(){return e.videoTrackWrapper.getConstraints()},this.outputStream.getVideoTracks()[0].getCapabilities=function(){return e.videoTrackWrapper.getCapabilities()},this.outputStream.getVideoTracks()[0].applyConstraints=function(t){return e.videoTrackWrapper.applyConstraints(t)},this.stream&&this.stream.getAudioTracks().forEach((function(t,r){e.outputStream.addTrack(t)}))),this.outputStream}}],i&&E(r.prototype,i),o&&E(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,i,o,s,u,l,h,f}(h);function R(e){return R="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},R(e)}function D(){D=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,i=Object.defineProperty||function(e,t,r){e[t]=r.value},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function l(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,r){return e[t]=r}}function h(e,t,r,n){var o=t&&t.prototype instanceof g?t:g,a=Object.create(o.prototype),s=new k(n||[]);return i(a,"_invoke",{value:O(e,r,s)}),a}function c(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=h;var f="suspendedStart",d="suspendedYield",p="executing",y="completed",m={};function g(){}function w(){}function v(){}var b={};l(b,a,(function(){return this}));var x=Object.getPrototypeOf,_=x&&x(x(C([])));_&&_!==r&&n.call(_,a)&&(b=_);var S=v.prototype=g.prototype=Object.create(b);function T(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function E(e,t){function r(i,o,a,s){var u=c(e[i],e,o);if("throw"!==u.type){var l=u.arg,h=l.value;return h&&"object"==R(h)&&n.call(h,"__await")?t.resolve(h.__await).then((function(e){r("next",e,a,s)}),(function(e){r("throw",e,a,s)})):t.resolve(h).then((function(e){l.value=e,a(l)}),(function(e){return r("throw",e,a,s)}))}s(u.arg)}var o;i(this,"_invoke",{value:function(e,n){function i(){return new t((function(t,i){r(e,n,t,i)}))}return o=o?o.then(i,i):i()}})}function O(t,r,n){var i=f;return function(o,a){if(i===p)throw Error("Generator is already running");if(i===y){if("throw"===o)throw a;return{value:e,done:!0}}for(n.method=o,n.arg=a;;){var s=n.delegate;if(s){var u=A(s,n);if(u){if(u===m)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===f)throw i=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i=p;var l=c(t,r,n);if("normal"===l.type){if(i=n.done?y:d,l.arg===m)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(i=y,n.method="throw",n.arg=l.arg)}}}function A(t,r){var n=r.method,i=t.iterator[n];if(i===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,A(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),m;var o=c(i,t.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,m;var a=o.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,m):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,m)}function I(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function P(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function k(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(I,this),this.reset(!0)}function C(t){if(t||""===t){var r=t[a];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,o=function r(){for(;++i<t.length;)if(n.call(t,i))return r.value=t[i],r.done=!1,r;return r.value=e,r.done=!0,r};return o.next=o}}throw new TypeError(R(t)+" is not iterable")}return w.prototype=v,i(S,"constructor",{value:v,configurable:!0}),i(v,"constructor",{value:w,configurable:!0}),w.displayName=l(v,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===w||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,v):(e.__proto__=v,l(e,u,"GeneratorFunction")),e.prototype=Object.create(S),e},t.awrap=function(e){return{__await:e}},T(E.prototype),l(E.prototype,s,(function(){return this})),t.AsyncIterator=E,t.async=function(e,r,n,i,o){void 0===o&&(o=Promise);var a=new E(h(e,r,n,i),o);return t.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},T(S),l(S,u,"Generator"),l(S,a,(function(){return this})),l(S,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=C,k.prototype={constructor:k,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(P),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function i(n,i){return s.type="throw",s.arg=t,r.next=n,i&&(r.method="next",r.arg=e),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),l=n.call(a,"finallyLoc");if(u&&l){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return i(a.catchLoc,!0)}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,m):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),P(r),m}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;P(r)}return i}}throw Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:C(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),m}},t}function M(e,t,r,n,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void r(e)}s.done?t(u):Promise.resolve(u).then(n,i)}function L(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,B(n.key),n)}}function B(e){var t=function(e,t){if("object"!=R(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=R(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==R(t)?t:t+""}function N(e,t,r){return t=j(t),function(e,t){if(t&&("object"==R(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,F()?Reflect.construct(t,r||[],j(e).constructor):t.apply(e,r))}function F(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(F=function(){return!!e})()}function U(){return U="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=function(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=j(e)););return e}(e,t);if(n){var i=Object.getOwnPropertyDescriptor(n,t);return i.get?i.get.call(arguments.length<3?e:r):i.value}},U.apply(null,arguments)}function j(e){return j=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},j(e)}function z(e,t){return z=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},z(e,t)}var G=function(e){function t(e){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(r=N(this,t,[e])).timing=performance.now(),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&z(e,t)}(t,e),r=t,n=[{key:"gatherByCallback",value:(o=D().mark((function e(){var t=this;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!document.hidden){e.next=3;break}return this.requestAnimationFrameID=window.requestAnimationFrame((function(){return t.gatherByCallback()})),e.abrupt("return");case 3:performance.now()-this.timing>.85*this.duration&&(this.gatherFrames(),this.timing=performance.now()),this.requestAnimationFrameID=window.requestAnimationFrame((function(){return t.gatherByCallback()}));case 6:case"end":return e.stop()}}),e,this)})),a=function(){var e=this,t=arguments;return new Promise((function(r,n){var i=o.apply(e,t);function a(e){M(i,r,n,a,s,"next",e)}function s(e){M(i,r,n,a,s,"throw",e)}a(void 0)}))},function(){return a.apply(this,arguments)})},{key:"stopTimers",value:function(){var e,r,n,i,o;if((e=t,r="stopTimers",n=this,o=U(j(1&(i=3)?e.prototype:e),r,n),2&i&&"function"==typeof o?function(e){return o.apply(n,e)}:o)([]),this.requestAnimationFrameID)try{cancelAnimationFrame(this.requestAnimationFrameID),this.requestAnimationFrameID=0}catch(n){}}}],n&&L(r.prototype,n),i&&L(r,i),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,i,o,a}($);function V(e){return V="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},V(e)}function W(){W=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,i=Object.defineProperty||function(e,t,r){e[t]=r.value},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function l(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,r){return e[t]=r}}function h(e,t,r,n){var o=t&&t.prototype instanceof g?t:g,a=Object.create(o.prototype),s=new k(n||[]);return i(a,"_invoke",{value:O(e,r,s)}),a}function c(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=h;var f="suspendedStart",d="suspendedYield",p="executing",y="completed",m={};function g(){}function w(){}function v(){}var b={};l(b,a,(function(){return this}));var x=Object.getPrototypeOf,_=x&&x(x(C([])));_&&_!==r&&n.call(_,a)&&(b=_);var S=v.prototype=g.prototype=Object.create(b);function T(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function E(e,t){function r(i,o,a,s){var u=c(e[i],e,o);if("throw"!==u.type){var l=u.arg,h=l.value;return h&&"object"==V(h)&&n.call(h,"__await")?t.resolve(h.__await).then((function(e){r("next",e,a,s)}),(function(e){r("throw",e,a,s)})):t.resolve(h).then((function(e){l.value=e,a(l)}),(function(e){return r("throw",e,a,s)}))}s(u.arg)}var o;i(this,"_invoke",{value:function(e,n){function i(){return new t((function(t,i){r(e,n,t,i)}))}return o=o?o.then(i,i):i()}})}function O(t,r,n){var i=f;return function(o,a){if(i===p)throw Error("Generator is already running");if(i===y){if("throw"===o)throw a;return{value:e,done:!0}}for(n.method=o,n.arg=a;;){var s=n.delegate;if(s){var u=A(s,n);if(u){if(u===m)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===f)throw i=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i=p;var l=c(t,r,n);if("normal"===l.type){if(i=n.done?y:d,l.arg===m)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(i=y,n.method="throw",n.arg=l.arg)}}}function A(t,r){var n=r.method,i=t.iterator[n];if(i===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,A(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),m;var o=c(i,t.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,m;var a=o.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,m):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,m)}function I(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function P(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function k(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(I,this),this.reset(!0)}function C(t){if(t||""===t){var r=t[a];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,o=function r(){for(;++i<t.length;)if(n.call(t,i))return r.value=t[i],r.done=!1,r;return r.value=e,r.done=!0,r};return o.next=o}}throw new TypeError(V(t)+" is not iterable")}return w.prototype=v,i(S,"constructor",{value:v,configurable:!0}),i(v,"constructor",{value:w,configurable:!0}),w.displayName=l(v,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===w||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,v):(e.__proto__=v,l(e,u,"GeneratorFunction")),e.prototype=Object.create(S),e},t.awrap=function(e){return{__await:e}},T(E.prototype),l(E.prototype,s,(function(){return this})),t.AsyncIterator=E,t.async=function(e,r,n,i,o){void 0===o&&(o=Promise);var a=new E(h(e,r,n,i),o);return t.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},T(S),l(S,u,"Generator"),l(S,a,(function(){return this})),l(S,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=C,k.prototype={constructor:k,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(P),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function i(n,i){return s.type="throw",s.arg=t,r.next=n,i&&(r.method="next",r.arg=e),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),l=n.call(a,"finallyLoc");if(u&&l){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return i(a.catchLoc,!0)}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,m):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),P(r),m}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;P(r)}return i}}throw Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:C(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),m}},t}function H(e,t,r,n,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void r(e)}s.done?t(u):Promise.resolve(u).then(n,i)}function q(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var o=e.apply(t,r);function a(e){H(o,n,i,a,s,"next",e)}function s(e){H(o,n,i,a,s,"throw",e)}a(void 0)}))}}function Y(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,X(n.key),n)}}function X(e){var t=function(e,t){if("object"!=V(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=V(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==V(t)?t:t+""}function K(e,t,r){return t=J(t),function(e,t){if(t&&("object"==V(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,Z()?Reflect.construct(t,r||[],J(e).constructor):t.apply(e,r))}function Z(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Z=function(){return!!e})()}function J(e){return J=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},J(e)}function Q(e,t){return Q=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Q(e,t)}var ee=function(e){function t(e){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(r=K(this,t,[e])).frameTimes=[],r.aborter=new AbortController,r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Q(e,t)}(t,e),r=t,i=[{key:"clearBuffers",value:function(){this.effectProcessor.clearBuffers()}},{key:"destroy",value:function(){this.outputStream&&this.outputStream.getTracks().forEach((function(e){e.stop()})),this.aborter.abort("stream_processor is destroyed")}},{key:"nextTick",value:(u=q(W().mark((function e(t,r){var i,o,a,s,u,l;return W().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.frame_count++,this.lastFrameTime=performance.now(),this.frameTimer.finish(),this.frameTimer.start(),e.next=6,this.effectProcessor.process();case 6:this.drawFps();try{u=this.renderer.getVideoFrameSettings(),l=this.renderer.getVideoFrameData(),s=new VideoFrame(l,Object.assign({duration:this.frameTimer.getFrameDuration(),timestamp:t.timestamp},u)),t.close();try{this.snapshot&&this.snapshot.isPending()&&this.snapshot.resolve(createImageBitmap(s)),r.enqueue(s)}catch(e){s.close()}this.toCanvas&&(null===(i=this.toCanvas.getContext("2d"))||void 0===i||i.clearRect(0,0,this.toCanvas.width,this.toCanvas.height),null===(o=this.toCanvas.getContext("2d"))||void 0===o||o.drawImage(this.renderer.renderer.view,0,0,this.toCanvas.width,this.toCanvas.height))}catch(e){n.bv.notify({message:null!==(a=e.message)&&void 0!==a?a:e,type:n.By.ERROR,code:n.O4.ENQUEUE_FRAME_ISSUE,emitter:n.JK.SRTEAM_PROCESSOR,cause:e}),t.close()}case 8:case"end":return e.stop()}}),e,this)}))),function(e,t){return u.apply(this,arguments)})},{key:"handleFrames",value:(s=q(W().mark((function e(t,r){var n,i,o=this;return W().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===(n=this.frameDrawFunction)||void 0===n||n.call(this),this.videoTrackWrapper.update(t.displayWidth,t.displayHeight),this.isRunning&&!this.isPaused&&this.effectProcessor){e.next=5;break}try{this.snapshot&&this.snapshot.isPending()&&this.snapshot.resolve(createImageBitmap(t)),r.enqueue(t),this.toCanvas&&(null===(i=this.toCanvas.getContext("2d"))||void 0===i||i.drawImage(t,0,0,this.toCanvas.width,this.toCanvas.height))}catch(e){t.close()}return e.abrupt("return");case 5:if(this.effectProcessor.nextFrame(new v.g(t)),!this.onProcessPromise||!this.onProcessPromise.isPending()){e.next=9;break}return e.next=9,this.onProcessPromise.promise;case 9:this.onProcessPromise=new a.c,this.nextTick(t,r).then((function(){o.onProcessPromise.resolve()}));case 11:case"end":return e.stop()}}),e,this)}))),function(e,t){return s.apply(this,arguments)})},{key:"process",value:function(){var e=this,t=this.getInputVideoTrack();if(t){this.outputVideoTrack=new MediaStreamTrackGenerator({kind:"video"}),this.outputVideoTrack.getSettings=function(){return e.videoTrackWrapper.getSettings()},this.outputVideoTrack.getConstraints=function(){return e.videoTrackWrapper.getConstraints()},this.outputVideoTrack.getCapabilities=function(){return e.videoTrackWrapper.getCapabilities()},this.outputVideoTrack.applyConstraints=function(t){return e.videoTrackWrapper.applyConstraints(t)},this.outputStream&&this.outputStream.getTracks().forEach((function(e){e.stop()})),this.outputStream=new MediaStream([this.outputVideoTrack]),this.stream&&this.stream.getAudioTracks().forEach((function(t,r){e.outputStream.addTrack(t)})),this.trackProcessor=new MediaStreamTrackProcessor({track:t}),this.timestamp=performance.now();var r=this,i=new TransformStream({transform:function(e,t){return q(W().mark((function n(){return W().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,r.handleFrames(e,t);case 2:case"end":return n.stop()}}),n)})))()}});this.trackProcessor.readable.pipeThrough(i,{signal:this.aborter.signal}).pipeTo(this.outputVideoTrack.writable).catch((function(e){}))}else n.bv.notify({message:"there is no videoTrack to process",type:n.By.ERROR,code:n.O4.NO_VIDEO_TRACK,emitter:n.JK.SRTEAM_PROCESSOR})}},{key:"getStream",value:function(){return this.outputStream}}],i&&Y(r.prototype,i),o&&Y(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,i,o,s,u}(h);function te(e){return te="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},te(e)}function re(){re=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,i=Object.defineProperty||function(e,t,r){e[t]=r.value},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function l(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,r){return e[t]=r}}function h(e,t,r,n){var o=t&&t.prototype instanceof g?t:g,a=Object.create(o.prototype),s=new k(n||[]);return i(a,"_invoke",{value:O(e,r,s)}),a}function c(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=h;var f="suspendedStart",d="suspendedYield",p="executing",y="completed",m={};function g(){}function w(){}function v(){}var b={};l(b,a,(function(){return this}));var x=Object.getPrototypeOf,_=x&&x(x(C([])));_&&_!==r&&n.call(_,a)&&(b=_);var S=v.prototype=g.prototype=Object.create(b);function T(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function E(e,t){function r(i,o,a,s){var u=c(e[i],e,o);if("throw"!==u.type){var l=u.arg,h=l.value;return h&&"object"==te(h)&&n.call(h,"__await")?t.resolve(h.__await).then((function(e){r("next",e,a,s)}),(function(e){r("throw",e,a,s)})):t.resolve(h).then((function(e){l.value=e,a(l)}),(function(e){return r("throw",e,a,s)}))}s(u.arg)}var o;i(this,"_invoke",{value:function(e,n){function i(){return new t((function(t,i){r(e,n,t,i)}))}return o=o?o.then(i,i):i()}})}function O(t,r,n){var i=f;return function(o,a){if(i===p)throw Error("Generator is already running");if(i===y){if("throw"===o)throw a;return{value:e,done:!0}}for(n.method=o,n.arg=a;;){var s=n.delegate;if(s){var u=A(s,n);if(u){if(u===m)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===f)throw i=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i=p;var l=c(t,r,n);if("normal"===l.type){if(i=n.done?y:d,l.arg===m)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(i=y,n.method="throw",n.arg=l.arg)}}}function A(t,r){var n=r.method,i=t.iterator[n];if(i===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,A(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),m;var o=c(i,t.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,m;var a=o.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,m):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,m)}function I(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function P(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function k(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(I,this),this.reset(!0)}function C(t){if(t||""===t){var r=t[a];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,o=function r(){for(;++i<t.length;)if(n.call(t,i))return r.value=t[i],r.done=!1,r;return r.value=e,r.done=!0,r};return o.next=o}}throw new TypeError(te(t)+" is not iterable")}return w.prototype=v,i(S,"constructor",{value:v,configurable:!0}),i(v,"constructor",{value:w,configurable:!0}),w.displayName=l(v,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===w||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,v):(e.__proto__=v,l(e,u,"GeneratorFunction")),e.prototype=Object.create(S),e},t.awrap=function(e){return{__await:e}},T(E.prototype),l(E.prototype,s,(function(){return this})),t.AsyncIterator=E,t.async=function(e,r,n,i,o){void 0===o&&(o=Promise);var a=new E(h(e,r,n,i),o);return t.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},T(S),l(S,u,"Generator"),l(S,a,(function(){return this})),l(S,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=C,k.prototype={constructor:k,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(P),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function i(n,i){return s.type="throw",s.arg=t,r.next=n,i&&(r.method="next",r.arg=e),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),l=n.call(a,"finallyLoc");if(u&&l){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return i(a.catchLoc,!0)}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,m):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),P(r),m}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;P(r)}return i}}throw Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:C(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),m}},t}function ne(e,t,r,n,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void r(e)}s.done?t(u):Promise.resolve(u).then(n,i)}function ie(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,oe(n.key),n)}}function oe(e){var t=function(e,t){if("object"!=te(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=te(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==te(t)?t:t+""}function ae(e,t,r){return t=le(t),function(e,t){if(t&&("object"==te(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,se()?Reflect.construct(t,r||[],le(e).constructor):t.apply(e,r))}function se(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(se=function(){return!!e})()}function ue(){return ue="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=function(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=le(e)););return e}(e,t);if(n){var i=Object.getOwnPropertyDescriptor(n,t);return i.get?i.get.call(arguments.length<3?e:r):i.value}},ue.apply(null,arguments)}function le(e){return le=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},le(e)}function he(e,t){return he=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},he(e,t)}function ce(e){return ce="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ce(e)}function fe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,de(n.key),n)}}function de(e){var t=function(e,t){if("object"!=ce(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=ce(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==ce(t)?t:t+""}var pe={transform:ee,videocallback:function(e){function t(e){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(r=ae(this,t,[e])).timing=performance.now(),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&he(e,t)}(t,e),r=t,n=[{key:"gatherByCallback",value:(o=re().mark((function e(){var t=this;return re().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!document.hidden){e.next=3;break}return this.gatherFramesTimeout=setTimeout((function(){t.inputVideo.requestVideoFrameCallback((function(){return t.gatherByCallback()}))}),0),e.abrupt("return");case 3:performance.now()-this.timing>.85*this.duration&&(this.gatherFrames(),this.timing=performance.now()),this.gatherFramesTimeout=setTimeout((function(){t.inputVideo.requestVideoFrameCallback((function(){return t.gatherByCallback()}))}),0);case 6:case"end":return e.stop()}}),e,this)})),a=function(){var e=this,t=arguments;return new Promise((function(r,n){var i=o.apply(e,t);function a(e){ne(i,r,n,a,s,"next",e)}function s(e){ne(i,r,n,a,s,"throw",e)}a(void 0)}))},function(){return a.apply(this,arguments)})},{key:"stopTimers",value:function(){var e,r,n,i,o;if((e=t,r="stopTimers",n=this,o=ue(le(1&(i=3)?e.prototype:e),r,n),2&i&&"function"==typeof o?function(e){return o.apply(n,e)}:o)([]),this.requestVideoFrameID)try{this.inputVideo.cancelVideoFrameCallback(this.requestVideoFrameID),this.requestVideoFrameID=0}catch(n){}}}],n&&ie(r.prototype,n),i&&ie(r,i),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,i,o,a}($),animationcallback:G},ye=function(){return e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)},r=[{key:"getStreamProcessor",value:function(e,t){return new pe[e](t)}}],(t=null)&&fe(e.prototype,t),r&&fe(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,r}();function me(e){return me="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},me(e)}function ge(){ge=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,i=Object.defineProperty||function(e,t,r){e[t]=r.value},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function l(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,r){return e[t]=r}}function h(e,t,r,n){var o=t&&t.prototype instanceof g?t:g,a=Object.create(o.prototype),s=new k(n||[]);return i(a,"_invoke",{value:O(e,r,s)}),a}function c(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=h;var f="suspendedStart",d="suspendedYield",p="executing",y="completed",m={};function g(){}function w(){}function v(){}var b={};l(b,a,(function(){return this}));var x=Object.getPrototypeOf,_=x&&x(x(C([])));_&&_!==r&&n.call(_,a)&&(b=_);var S=v.prototype=g.prototype=Object.create(b);function T(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function E(e,t){function r(i,o,a,s){var u=c(e[i],e,o);if("throw"!==u.type){var l=u.arg,h=l.value;return h&&"object"==me(h)&&n.call(h,"__await")?t.resolve(h.__await).then((function(e){r("next",e,a,s)}),(function(e){r("throw",e,a,s)})):t.resolve(h).then((function(e){l.value=e,a(l)}),(function(e){return r("throw",e,a,s)}))}s(u.arg)}var o;i(this,"_invoke",{value:function(e,n){function i(){return new t((function(t,i){r(e,n,t,i)}))}return o=o?o.then(i,i):i()}})}function O(t,r,n){var i=f;return function(o,a){if(i===p)throw Error("Generator is already running");if(i===y){if("throw"===o)throw a;return{value:e,done:!0}}for(n.method=o,n.arg=a;;){var s=n.delegate;if(s){var u=A(s,n);if(u){if(u===m)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===f)throw i=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i=p;var l=c(t,r,n);if("normal"===l.type){if(i=n.done?y:d,l.arg===m)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(i=y,n.method="throw",n.arg=l.arg)}}}function A(t,r){var n=r.method,i=t.iterator[n];if(i===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,A(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),m;var o=c(i,t.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,m;var a=o.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,m):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,m)}function I(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function P(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function k(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(I,this),this.reset(!0)}function C(t){if(t||""===t){var r=t[a];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,o=function r(){for(;++i<t.length;)if(n.call(t,i))return r.value=t[i],r.done=!1,r;return r.value=e,r.done=!0,r};return o.next=o}}throw new TypeError(me(t)+" is not iterable")}return w.prototype=v,i(S,"constructor",{value:v,configurable:!0}),i(v,"constructor",{value:w,configurable:!0}),w.displayName=l(v,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===w||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,v):(e.__proto__=v,l(e,u,"GeneratorFunction")),e.prototype=Object.create(S),e},t.awrap=function(e){return{__await:e}},T(E.prototype),l(E.prototype,s,(function(){return this})),t.AsyncIterator=E,t.async=function(e,r,n,i,o){void 0===o&&(o=Promise);var a=new E(h(e,r,n,i),o);return t.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},T(S),l(S,u,"Generator"),l(S,a,(function(){return this})),l(S,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=C,k.prototype={constructor:k,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(P),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function i(n,i){return s.type="throw",s.arg=t,r.next=n,i&&(r.method="next",r.arg=e),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),l=n.call(a,"finallyLoc");if(u&&l){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return i(a.catchLoc,!0)}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,m):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),P(r),m}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;P(r)}return i}}throw Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:C(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),m}},t}function we(e,t,r,n,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void r(e)}s.done?t(u):Promise.resolve(u).then(n,i)}function ve(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var o=e.apply(t,r);function a(e){we(o,n,i,a,s,"next",e)}function s(e){we(o,n,i,a,s,"throw",e)}a(void 0)}))}}function be(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,xe(n.key),n)}}function xe(e){var t=function(e,t){if("object"!=me(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=me(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==me(t)?t:t+""}var _e,Se,Te,Ee,Oe,Ae,Ie,Pe,ke,Ce,$e,Re,De,Me,Le,Be,Ne,Fe,Ue,je,ze,Ge,Ve,We,He,qe,Ye,Xe,Ke,Ze,Je,Qe=function(){return e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.queue=[],this.isExecuting=!1},t=[{key:"enqueue",value:function(e){var t=this;return new Promise((function(r,n){var i=function(){var t=ve(ge().mark((function t(){var i;return ge().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e();case 3:i=t.sent,r(i),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),n(t.t0);case 10:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(){return t.apply(this,arguments)}}();t.queue.push(i),t.processQueue()}))}},{key:"processQueue",value:(n=ve(ge().mark((function e(){var t;return ge().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.isExecuting){e.next=2;break}return e.abrupt("return");case 2:this.isExecuting=!0;case 3:if(!(this.queue.length>0)){e.next=10;break}if(!(t=this.queue.shift())){e.next=8;break}return e.next=8,t();case 8:e.next=3;break;case 10:this.isExecuting=!1;case 11:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})}],t&&be(e.prototype,t),r&&be(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,r,n}(),et=r(7734),tt=r(5606),rt=r(8287).hp,nt=Object.defineProperty,it=Object.getOwnPropertyDescriptor,ot=Object.getOwnPropertyNames,at=Object.prototype.hasOwnProperty,st=(e,t)=>()=>(e&&(t=e(e=0)),t),ut=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),lt=(e,t)=>{for(var r in t)nt(e,r,{get:t[r],enumerable:!0})},ht=e=>((e,t,r,n)=>{if(t&&"object"==typeof t||"function"==typeof t)for(let i of ot(t))!at.call(e,i)&&i!==r&&nt(e,i,{get:()=>t[i],enumerable:!(n=it(t,i))||n.enumerable});return e})(nt({},"__esModule",{value:!0}),e),ct=st((()=>{_e=new Map,Se=[],Te=(e,t,r)=>{if(!t||"function"!=typeof t.init||"function"!=typeof t.createInferenceSessionHandler)throw new TypeError("not a valid backend");{let n=_e.get(e);if(void 0===n)_e.set(e,{backend:t,priority:r});else{if(n.priority>r)return;if(n.priority===r&&n.backend!==t)throw new Error(`cannot register backend "${e}" using priority ${r}`)}if(r>=0){let t=Se.indexOf(e);-1!==t&&Se.splice(t,1);for(let t=0;t<Se.length;t++)if(_e.get(Se[t]).priority<=r)return void Se.splice(t,0,e);Se.push(e)}}},Ee=async e=>{let t=0===e.length?Se:e,r=[];for(let e of t){let t=_e.get(e);if(t){if(t.initialized)return t.backend;if(t.aborted)continue;let n=!!t.initPromise;try{return n||(t.initPromise=t.backend.init(e)),await t.initPromise,t.initialized=!0,t.backend}catch(i){n||r.push({name:e,err:i}),t.aborted=!0}finally{delete t.initPromise}}}throw new Error(`no available backend found. ERR: ${r.map((e=>`[${e.name}] ${e.err}`)).join(", ")}`)}})),ft=st((()=>{ct()})),dt=st((()=>{Oe="1.17.0"})),pt=st((()=>{dt(),Ae="warning",Ie={wasm:{},webgl:{},webgpu:{},versions:{common:Oe},set logLevel(e){if(void 0!==e){if("string"!=typeof e||-1===["verbose","info","warning","error","fatal"].indexOf(e))throw new Error(`Unsupported logging level: ${e}`);Ae=e}},get logLevel(){return Ae}},Object.defineProperty(Ie,"logLevel",{enumerable:!0})})),yt=st((()=>{pt(),Pe=Ie})),mt=st((()=>{ke=(e,t)=>{let r=typeof document<"u"?document.createElement("canvas"):new OffscreenCanvas(1,1);r.width=e.dims[3],r.height=e.dims[2];let n=r.getContext("2d");if(null!=n){let i,o;void 0!==t?.tensorLayout&&"NHWC"===t.tensorLayout?(i=e.dims[2],o=e.dims[3]):(i=e.dims[3],o=e.dims[2]);let a,s,u=void 0!==t?.format?t.format:"RGB",l=t?.norm;void 0===l||void 0===l.mean?a=[255,255,255,255]:"number"==typeof l.mean?a=[l.mean,l.mean,l.mean,l.mean]:(a=[l.mean[0],l.mean[1],l.mean[2],0],void 0!==l.mean[3]&&(a[3]=l.mean[3])),void 0===l||void 0===l.bias?s=[0,0,0,0]:"number"==typeof l.bias?s=[l.bias,l.bias,l.bias,l.bias]:(s=[l.bias[0],l.bias[1],l.bias[2],0],void 0!==l.bias[3]&&(s[3]=l.bias[3]));let h=o*i,c=0,f=h,d=2*h,p=-1;"RGBA"===u?(c=0,f=h,d=2*h,p=3*h):"RGB"===u?(c=0,f=h,d=2*h):"RBG"===u&&(c=0,d=h,f=2*h);for(let t=0;t<o;t++)for(let r=0;r<i;r++){let i=(e.data[c++]-s[0])*a[0],o=(e.data[f++]-s[1])*a[1],u=(e.data[d++]-s[2])*a[2],l=-1===p?255:(e.data[p++]-s[3])*a[3];n.fillStyle="rgba("+i+","+o+","+u+","+l+")",n.fillRect(r,t,1,1)}if("toDataURL"in r)return r.toDataURL();throw new Error("toDataURL is not supported")}throw new Error("Can not access image data")},Ce=(e,t)=>{let r,n=typeof document<"u"?document.createElement("canvas").getContext("2d"):new OffscreenCanvas(1,1).getContext("2d");if(null==n)throw new Error("Can not access image data");{let i,o,a;void 0!==t?.tensorLayout&&"NHWC"===t.tensorLayout?(i=e.dims[2],o=e.dims[1],a=e.dims[3]):(i=e.dims[3],o=e.dims[2],a=e.dims[1]);let s,u,l=void 0!==t&&void 0!==t.format?t.format:"RGB",h=t?.norm;void 0===h||void 0===h.mean?s=[255,255,255,255]:"number"==typeof h.mean?s=[h.mean,h.mean,h.mean,h.mean]:(s=[h.mean[0],h.mean[1],h.mean[2],255],void 0!==h.mean[3]&&(s[3]=h.mean[3])),void 0===h||void 0===h.bias?u=[0,0,0,0]:"number"==typeof h.bias?u=[h.bias,h.bias,h.bias,h.bias]:(u=[h.bias[0],h.bias[1],h.bias[2],0],void 0!==h.bias[3]&&(u[3]=h.bias[3]));let c=o*i;if(void 0!==t&&(void 0!==t.format&&4===a&&"RGBA"!==t.format||3===a&&"RGB"!==t.format&&"BGR"!==t.format))throw new Error("Tensor format doesn't match input tensor dims");let f=4,d=0,p=1,y=2,m=3,g=0,w=c,v=2*c,b=-1;"RGBA"===l?(g=0,w=c,v=2*c,b=3*c):"RGB"===l?(g=0,w=c,v=2*c):"RBG"===l&&(g=0,v=c,w=2*c),r=n.createImageData(i,o);for(let t=0;t<o*i;d+=f,p+=f,y+=f,m+=f,t++)r.data[d]=(e.data[g++]-u[0])*s[0],r.data[p]=(e.data[w++]-u[1])*s[1],r.data[y]=(e.data[v++]-u[2])*s[2],r.data[m]=-1===b?255:(e.data[b++]-u[3])*s[3]}return r}})),gt=st((()=>{bt(),$e=(e,t)=>{if(void 0===e)throw new Error("Image buffer must be defined");if(void 0===t.height||void 0===t.width)throw new Error("Image height and width must be defined");if("NHWC"===t.tensorLayout)throw new Error("NHWC Tensor layout is not supported yet");let r,n,{height:i,width:o}=t,a=t.norm??{mean:255,bias:0};r="number"==typeof a.mean?[a.mean,a.mean,a.mean,a.mean]:[a.mean[0],a.mean[1],a.mean[2],a.mean[3]??255],n="number"==typeof a.bias?[a.bias,a.bias,a.bias,a.bias]:[a.bias[0],a.bias[1],a.bias[2],a.bias[3]??0];let s=void 0!==t.format?t.format:"RGBA",u=void 0!==t.tensorFormat&&void 0!==t.tensorFormat?t.tensorFormat:"RGB",l=i*o,h="RGBA"===u?new Float32Array(4*l):new Float32Array(3*l),c=4,f=0,d=1,p=2,y=3,m=0,g=l,w=2*l,v=-1;"RGB"===s&&(c=3,f=0,d=1,p=2,y=-1),"RGBA"===u?v=3*l:"RBG"===u?(m=0,w=l,g=2*l):"BGR"===u&&(w=0,g=l,m=2*l);for(let t=0;t<l;t++,f+=c,p+=c,d+=c,y+=c)h[m++]=(e[f]+n[0])/r[0],h[g++]=(e[d]+n[1])/r[1],h[w++]=(e[p]+n[2])/r[2],-1!==v&&-1!==y&&(h[v++]=(e[y]+n[3])/r[3]);return new Ge("float32",h,"RGBA"===u?[1,4,i,o]:[1,3,i,o])},Re=async(e,t)=>{let r,n=typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement,i=typeof ImageData<"u"&&e instanceof ImageData,o=typeof ImageBitmap<"u"&&e instanceof ImageBitmap,a="string"==typeof e,s=t??{},u=()=>{if(typeof document<"u")return document.createElement("canvas");if(typeof OffscreenCanvas<"u")return new OffscreenCanvas(1,1);throw new Error("Canvas is not supported")},l=e=>e instanceof HTMLCanvasElement||e instanceof OffscreenCanvas?e.getContext("2d"):null;if(n){let n=u();n.width=e.width,n.height=e.height;let i=l(n);if(null==i)throw new Error("Can not access image data");{let n=e.height,o=e.width;if(void 0!==t&&void 0!==t.resizedHeight&&void 0!==t.resizedWidth&&(n=t.resizedHeight,o=t.resizedWidth),void 0!==t){if(s=t,void 0!==t.tensorFormat)throw new Error("Image input config format must be RGBA for HTMLImageElement");s.tensorFormat="RGBA",s.height=n,s.width=o}else s.tensorFormat="RGBA",s.height=n,s.width=o;i.drawImage(e,0,0),r=i.getImageData(0,0,o,n).data}}else{if(!i){if(o){if(void 0===t)throw new Error("Please provide image config with format for Imagebitmap");let n=u();n.width=e.width,n.height=e.height;let i=l(n);if(null!=i){let t=e.height,n=e.width;return i.drawImage(e,0,0,n,t),r=i.getImageData(0,0,n,t).data,s.height=t,s.width=n,$e(r,s)}throw new Error("Can not access image data")}if(a)return new Promise(((t,r)=>{let n=u(),i=l(n);if(!e||!i)return r();let o=new Image;o.crossOrigin="Anonymous",o.src=e,o.onload=()=>{n.width=o.width,n.height=o.height,i.drawImage(o,0,0,n.width,n.height);let e=i.getImageData(0,0,n.width,n.height);s.height=n.height,s.width=n.width,t($e(e.data,s))}}));throw new Error("Input data provided is not supported - aborted tensor creation")}{let n,i;if(void 0!==t&&void 0!==t.resizedWidth&&void 0!==t.resizedHeight?(n=t.resizedHeight,i=t.resizedWidth):(n=e.height,i=e.width),void 0!==t&&(s=t),s.format="RGBA",s.height=n,s.width=i,void 0!==t){let t=u();t.width=i,t.height=n;let o=l(t);if(null==o)throw new Error("Can not access image data");o.putImageData(e,0,0),r=o.getImageData(0,0,i,n).data}else r=e.data}}if(void 0!==r)return $e(r,s);throw new Error("Input data provided is not supported - aborted tensor creation")},De=(e,t)=>{let{width:r,height:n,download:i,dispose:o}=t;return new Ge({location:"texture",type:"float32",texture:e,dims:[1,n,r,4],download:i,dispose:o})},Me=(e,t)=>{let{dataType:r,dims:n,download:i,dispose:o}=t;return new Ge({location:"gpu-buffer",type:r??"float32",gpuBuffer:e,dims:n,download:i,dispose:o})},Le=(e,t,r)=>new Ge({location:"cpu-pinned",type:e,data:t,dims:r??[t.length]})})),wt=st((()=>{Be=new Map([["float32",Float32Array],["uint8",Uint8Array],["int8",Int8Array],["uint16",Uint16Array],["float16",Uint16Array],["int16",Int16Array],["int32",Int32Array],["bool",Uint8Array],["float64",Float64Array],["uint32",Uint32Array]]),Ne=new Map([[Float32Array,"float32"],[Uint8Array,"uint8"],[Int8Array,"int8"],[Uint16Array,"uint16"],[Int16Array,"int16"],[Int32Array,"int32"],[Float64Array,"float64"],[Uint32Array,"uint32"]]),Fe=!1,Ue=()=>{if(!Fe){Fe=!0;let e=typeof BigInt64Array<"u"&&"function"==typeof BigInt64Array.from,t=typeof BigUint64Array<"u"&&"function"==typeof BigUint64Array.from;e&&(Be.set("int64",BigInt64Array),Ne.set(BigInt64Array,"int64")),t&&(Be.set("uint64",BigUint64Array),Ne.set(BigUint64Array,"uint64"))}}})),vt=st((()=>{bt(),je=e=>{let t=1;for(let r=0;r<e.length;r++){let n=e[r];if("number"!=typeof n||!Number.isSafeInteger(n))throw new TypeError(`dims[${r}] must be an integer, got: ${n}`);if(n<0)throw new RangeError(`dims[${r}] must be a non-negative integer, got: ${n}`);t*=n}return t},ze=(e,t)=>{switch(e.location){case"cpu":return new Ge(e.type,e.data,t);case"cpu-pinned":return new Ge({location:"cpu-pinned",data:e.data,type:e.type,dims:t});case"texture":return new Ge({location:"texture",texture:e.texture,type:e.type,dims:t});case"gpu-buffer":return new Ge({location:"gpu-buffer",gpuBuffer:e.gpuBuffer,type:e.type,dims:t});default:throw new Error(`tensorReshape: tensor location ${e.location} is not supported`)}}})),bt=st((()=>{mt(),gt(),wt(),vt(),Ge=class{constructor(e,t,r){let n,i;if(Ue(),"object"==typeof e&&"location"in e)switch(this.dataLocation=e.location,n=e.type,i=e.dims,e.location){case"cpu-pinned":{let t=Be.get(n);if(!t)throw new TypeError(`unsupported type "${n}" to create tensor from pinned buffer`);if(!(e.data instanceof t))throw new TypeError(`buffer should be of type ${t.name}`);this.cpuData=e.data;break}case"texture":if("float32"!==n)throw new TypeError(`unsupported type "${n}" to create tensor from texture`);this.gpuTextureData=e.texture,this.downloader=e.download,this.disposer=e.dispose;break;case"gpu-buffer":if("float32"!==n&&"float16"!==n&&"int32"!==n&&"int64"!==n&&"uint32"!==n&&"bool"!==n)throw new TypeError(`unsupported type "${n}" to create tensor from gpu buffer`);this.gpuBufferData=e.gpuBuffer,this.downloader=e.download,this.disposer=e.dispose;break;default:throw new Error(`Tensor constructor: unsupported location '${this.dataLocation}'`)}else{let o,a;if("string"==typeof e)if(n=e,a=r,"string"===e){if(!Array.isArray(t))throw new TypeError("A string tensor's data must be a string array.");o=t}else{let r=Be.get(e);if(void 0===r)throw new TypeError(`Unsupported tensor type: ${e}.`);if(Array.isArray(t)){if("float16"===e)throw new TypeError("Creating a float16 tensor from number array is not supported. Please use Uint16Array as data.");o="uint64"===e||"int64"===e?r.from(t,BigInt):r.from(t)}else{if(!(t instanceof r))throw new TypeError(`A ${n} tensor's data must be type of ${r}`);o=t}}else if(a=t,Array.isArray(e)){if(0===e.length)throw new TypeError("Tensor type cannot be inferred from an empty array.");let t=typeof e[0];if("string"===t)n="string",o=e;else{if("boolean"!==t)throw new TypeError(`Invalid element type of data array: ${t}.`);n="bool",o=Uint8Array.from(e)}}else{let t=Ne.get(e.constructor);if(void 0===t)throw new TypeError(`Unsupported type for tensor data: ${e.constructor}.`);n=t,o=e}if(void 0===a)a=[o.length];else if(!Array.isArray(a))throw new TypeError("A tensor's dims must be a number array");i=a,this.cpuData=o,this.dataLocation="cpu"}let o=je(i);if(this.cpuData&&o!==this.cpuData.length)throw new Error(`Tensor's size(${o}) does not match data length(${this.cpuData.length}).`);this.type=n,this.dims=i,this.size=o}static async fromImage(e,t){return Re(e,t)}static fromTexture(e,t){return De(e,t)}static fromGpuBuffer(e,t){return Me(e,t)}static fromPinnedBuffer(e,t,r){return Le(e,t,r)}toDataURL(e){return ke(this,e)}toImageData(e){return Ce(this,e)}get data(){if(this.ensureValid(),!this.cpuData)throw new Error("The data is not on CPU. Use `getData()` to download GPU data to CPU, or use `texture` or `gpuBuffer` property to access the GPU data directly.");return this.cpuData}get location(){return this.dataLocation}get texture(){if(this.ensureValid(),!this.gpuTextureData)throw new Error("The data is not stored as a WebGL texture.");return this.gpuTextureData}get gpuBuffer(){if(this.ensureValid(),!this.gpuBufferData)throw new Error("The data is not stored as a WebGPU buffer.");return this.gpuBufferData}async getData(e){switch(this.ensureValid(),this.dataLocation){case"cpu":case"cpu-pinned":return this.data;case"texture":case"gpu-buffer":if(!this.downloader)throw new Error("The current tensor is not created with a specified data downloader.");if(this.isDownloading)throw new Error("The current tensor is being downloaded.");try{this.isDownloading=!0;let t=await this.downloader();return this.downloader=void 0,this.dataLocation="cpu",this.cpuData=t,e&&this.disposer&&(this.disposer(),this.disposer=void 0),t}finally{this.isDownloading=!1}default:throw new Error(`cannot get data from location: ${this.dataLocation}`)}}dispose(){if(this.isDownloading)throw new Error("The current tensor is being downloaded.");this.disposer&&(this.disposer(),this.disposer=void 0),this.cpuData=void 0,this.gpuTextureData=void 0,this.gpuBufferData=void 0,this.downloader=void 0,this.isDownloading=void 0,this.dataLocation="none"}ensureValid(){if("none"===this.dataLocation)throw new Error("The tensor is disposed.")}reshape(e){if(this.ensureValid(),this.downloader||this.disposer)throw new Error("Cannot reshape a tensor that owns GPU resource.");return ze(this,e)}}})),xt=st((()=>{bt(),Ve=Ge})),_t=st((()=>{pt(),We=(e,t)=>{Ie.wasm.trace&&console.timeStamp(`${e}::ORT::${t}`)},He=(e,t)=>{let r=(new Error).stack?.split(/\r\n|\r|\n/g)||[],n=!1;for(let i=0;i<r.length;i++){if(n&&!r[i].includes("TRACE_FUNC")){let n=`FUNC_${e}::${r[i].trim().split(" ")[1]}`;return t&&(n+=`::${t}`),void We("CPU",n)}r[i].includes("TRACE_FUNC")&&(n=!0)}},qe=e=>{Ie.wasm.trace&&He("BEGIN",e)},Ye=e=>{Ie.wasm.trace&&He("END",e)}})),St=st((()=>{ct(),xt(),_t(),Xe=class e{constructor(e){this.handler=e}async run(e,t,r){qe();let n={},i={};if("object"!=typeof e||null===e||e instanceof Ve||Array.isArray(e))throw new TypeError("'feeds' must be an object that use input names as keys and OnnxValue as corresponding values.");let o=!0;if("object"==typeof t){if(null===t)throw new TypeError("Unexpected argument[1]: cannot be null.");if(t instanceof Ve)throw new TypeError("'fetches' cannot be a Tensor");if(Array.isArray(t)){if(0===t.length)throw new TypeError("'fetches' cannot be an empty array.");o=!1;for(let e of t){if("string"!=typeof e)throw new TypeError("'fetches' must be a string array or an object.");if(-1===this.outputNames.indexOf(e))throw new RangeError(`'fetches' contains invalid output name: ${e}.`);n[e]=null}if("object"==typeof r&&null!==r)i=r;else if(typeof r<"u")throw new TypeError("'options' must be an object.")}else{let e=!1,a=Object.getOwnPropertyNames(t);for(let r of this.outputNames)if(-1!==a.indexOf(r)){let i=t[r];(null===i||i instanceof Ve)&&(e=!0,o=!1,n[r]=i)}if(e){if("object"==typeof r&&null!==r)i=r;else if(typeof r<"u")throw new TypeError("'options' must be an object.")}else i=t}}else if(typeof t<"u")throw new TypeError("Unexpected argument[1]: must be 'fetches' or 'options'.");for(let t of this.inputNames)if(typeof e[t]>"u")throw new Error(`input '${t}' is missing in 'feeds'.`);if(o)for(let e of this.outputNames)n[e]=null;let a=await this.handler.run(e,n,i),s={};for(let e in a)if(Object.hasOwnProperty.call(a,e)){let t=a[e];s[e]=t instanceof Ve?t:new Ve(t.type,t.data,t.dims)}return Ye(),s}async release(){return this.handler.dispose()}async configure(e){return await this.handler.configure(e)}async auth(e){return await this.handler.auth(e)}static async create(t,r,n,i){qe();let o,a={};if("string"==typeof t){if(o=t,"object"==typeof r&&null!==r)a=r;else if(typeof r<"u")throw new TypeError("'options' must be an object.")}else if(t instanceof Uint8Array){if(o=t,"object"==typeof r&&null!==r)a=r;else if(typeof r<"u")throw new TypeError("'options' must be an object.")}else{if(!(t instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&t instanceof SharedArrayBuffer))throw new TypeError("Unexpected argument[0]: must be 'path' or 'buffer'.");{let e=t,s=0,u=t.byteLength;if("object"==typeof r&&null!==r)a=r;else if("number"==typeof r){if(s=r,!Number.isSafeInteger(s))throw new RangeError("'byteOffset' must be an integer.");if(s<0||s>=e.byteLength)throw new RangeError(`'byteOffset' is out of range [0, ${e.byteLength}).`);if(u=t.byteLength-s,"number"==typeof n){if(u=n,!Number.isSafeInteger(u))throw new RangeError("'byteLength' must be an integer.");if(u<=0||s+u>e.byteLength)throw new RangeError(`'byteLength' is out of range (0, ${e.byteLength-s}].`);if("object"==typeof i&&null!==i)a=i;else if(typeof i<"u")throw new TypeError("'options' must be an object.")}else if(typeof n<"u")throw new TypeError("'byteLength' must be a number.")}else if(typeof r<"u")throw new TypeError("'options' must be an object.");o=new Uint8Array(e,s,u)}}let s=(a.executionProviders||[]).map((e=>"string"==typeof e?e:e.name)),u=await(await Ee(s)).createInferenceSessionHandler(o,a);return Ye(),new e(u)}startProfiling(){this.handler.startProfiling()}endProfiling(){this.handler.endProfiling()}get inputNames(){return this.handler.inputNames}get outputNames(){return this.handler.outputNames}}})),Tt=st((()=>{St(),Ke=Xe})),Et=st((()=>{})),Ot=st((()=>{ct(),xt(),Ze=class e{constructor(e,t,r){this.handler=e,this.hasOptimizerModel=t,this.hasEvalModel=r}get trainingInputNames(){return this.handler.inputNames}get trainingOutputNames(){return this.handler.outputNames}get evalInputNames(){if(this.hasEvalModel)return this.handler.evalInputNames;throw new Error("This training session has no evalModel loaded.")}get evalOutputNames(){if(this.hasEvalModel)return this.handler.evalOutputNames;throw new Error("This training session has no evalModel loaded.")}static async create(t,r){let n=t.evalModel||"",i=t.optimizerModel||"",o=r||{},a=(o.executionProviders||[]).map((e=>"string"==typeof e?e:e.name)),s=await Ee(a);if(s.createTrainingSessionHandler){let r=await s.createTrainingSessionHandler(t.checkpointState,t.trainModel,n,i,o);return new e(r,!!t.optimizerModel,!!t.evalModel)}throw new Error("Training backend could not be resolved. Make sure you're using the correct configuration & WebAssembly files.")}typeNarrowingForRunStep(e,t,r,n,i){let o={},a={};if("object"!=typeof r||null===r||r instanceof Ve||Array.isArray(r))throw new TypeError("'feeds' must be an object that use input names as keys and OnnxValue as corresponding values.");let s=!0;if("object"==typeof n){if(null===n)throw new TypeError("Unexpected argument[1]: cannot be null.");if(n instanceof Ve)throw new TypeError("'fetches' cannot be a Tensor");if(Array.isArray(n)){if(0===n.length)throw new TypeError("'fetches' cannot be an empty array.");s=!1;for(let e of n){if("string"!=typeof e)throw new TypeError("'fetches' must be a string array or an object.");if(-1===t.indexOf(e))throw new RangeError(`'fetches' contains invalid output name: ${e}.`);o[e]=null}if("object"==typeof i&&null!==i)a=i;else if(typeof i<"u")throw new TypeError("'options' must be an object.")}else{let e=!1,r=Object.getOwnPropertyNames(n);for(let i of t)if(-1!==r.indexOf(i)){let t=n[i];(null===t||t instanceof Ve)&&(e=!0,s=!1,o[i]=t)}if(e){if("object"==typeof i&&null!==i)a=i;else if(typeof i<"u")throw new TypeError("'options' must be an object.")}else a=n}}else if(typeof n<"u")throw new TypeError("Unexpected argument[1]: must be 'fetches' or 'options'.");for(let t of e)if(typeof r[t]>"u")throw new Error(`input '${t}' is missing in 'feeds'.`);if(s)for(let e of t)o[e]=null;return[o,a]}convertHandlerReturnTypeToMapOfTensors(e){let t={};for(let r in e)if(Object.hasOwnProperty.call(e,r)){let n=e[r];t[r]=n instanceof Ve?n:new Ve(n.type,n.data,n.dims)}return t}async lazyResetGrad(){await this.handler.lazyResetGrad()}async runTrainStep(e,t,r){let[n,i]=this.typeNarrowingForRunStep(this.trainingInputNames,this.trainingOutputNames,e,t,r),o=await this.handler.runTrainStep(e,n,i);return this.convertHandlerReturnTypeToMapOfTensors(o)}async runOptimizerStep(e){if(!this.hasOptimizerModel)throw new Error("This TrainingSession has no OptimizerModel loaded.");await this.handler.runOptimizerStep(e||{})}async runEvalStep(e,t,r){if(this.hasEvalModel){let[n,i]=this.typeNarrowingForRunStep(this.evalInputNames,this.evalOutputNames,e,t,r),o=await this.handler.runEvalStep(e,n,i);return this.convertHandlerReturnTypeToMapOfTensors(o)}throw new Error("This TrainingSession has no EvalModel loaded.")}async getParametersSize(e=!0){return this.handler.getParametersSize(e)}async loadParametersBuffer(e,t=!0){let r=await this.getParametersSize(t);if(e.length!==4*r)throw new Error("Size of the buffer passed into loadParametersBuffer must match the number of parameters in the model. Please use getParametersSize method to check.");return this.handler.loadParametersBuffer(e,t)}async getContiguousParameters(e=!0){return this.handler.getContiguousParameters(e)}async release(){return this.handler.dispose()}}})),At=st((()=>{Ot(),Je=Ze})),It={};lt(It,{InferenceSession:()=>Ke,TRACE:()=>We,TRACE_FUNC_BEGIN:()=>qe,TRACE_FUNC_END:()=>Ye,Tensor:()=>Ve,TrainingSession:()=>Je,env:()=>Pe,registerBackend:()=>Te});var Pt=st((()=>{ft(),yt(),Tt(),xt(),_t(),Et(),At()})),kt={};lt(kt,{createReadStream:()=>Rt,readFile:()=>Ct,readFileSync:()=>$t});var Ct,$t,Rt,Dt=st((()=>{Ct=void 0,$t=void 0,Rt=void 0})),Mt={};lt(Mt,{join:()=>Lt});var Lt,Bt=st((()=>{Lt=void 0})),Nt={};lt(Nt,{crypto:()=>Ft});var Ft,Ut=st((()=>{Ft=void 0})),jt=ut(((e,t)=>{var r,n=(r=typeof document<"u"&&document.currentScript?document.currentScript.src:void 0,typeof __filename<"u"&&(r=r||__filename),function(e={}){var t,n,i=e;i.ready=new Promise(((e,r)=>{t=e,n=r})),i.mountExternalData=(e,t)=>{(i.Ka||(i.Ka=new Map)).set(e,t)},i.unmountExternalData=()=>{delete i.Ka},i.jsepInit=(e,t,r,n,o,a,s,u,l,h,c)=>{i.jb=e,i.Wa=t,i.$a=r,i.Qa=n,i.Za=o,i.Ba=a,i.ab=s,i.cb=u,i.Xa=l,i.Ya=h,i.bb=c,t=(e,t,r)=>(...n)=>{let i=de,o=t?.();n=e(...n);let a=t?.();return o!==a&&(e=a,r(o),t=r=null),de!=i?new Promise(((e,t)=>{ve={resolve:e,reject:t}})):n},r=t=>async(...r)=>{try{if(i.Ja)throw Error("Session already started");let n=i.Ja={eb:r[0],errors:[]},o=await t(...r);if(i.Ja!==n)throw Error("Session mismatch");e.flush();let a=n.errors;if(0<a.length){let e=await Promise.all(a);if(e=e.filter((e=>e)),0<e.length)throw Error(e.join("\n"))}return o}finally{i.Ja=null}},i._OrtRun=r(t(i._OrtRun,(()=>i._OrtRun),(e=>i._OrtRun=e))),i._OrtRunWithBinding=r(t(i._OrtRunWithBinding,(()=>i._OrtRunWithBinding),(e=>i._OrtRunWithBinding=e))),i._OrtBindInput=t(i._OrtBindInput,(()=>i._OrtBindInput),(e=>i._OrtBindInput=e)),i.jsepRegisterBuffer=(t,r,n,i)=>e.registerBuffer(t,r,n,i),i.jsepGetBuffer=t=>e.getBuffer(t),i.jsepCreateDownloader=(t,r,n)=>e.createDownloader(t,r,n),i.jsepOnReleaseSession=t=>{e.onReleaseSession(t)},i.jsepOnRunStart=t=>e.onRunStart(t)};var o,a,s,u=Object.assign({},i),l="./this.program",h=(e,t)=>{throw t},c="object"==typeof window,f="function"==typeof importScripts,d="object"==typeof tt&&"object"==typeof tt.versions&&"string"==typeof tt.versions.node,p="";if(d){var y=(Dt(),ht(kt)),m=(Bt(),ht(Mt));p=f?m.dirname(p)+"/":__dirname+"/",o=(e,t)=>(e=N(e)?new URL(e):m.normalize(e),y.readFileSync(e,t?void 0:"utf8")),s=e=>((e=o(e,!0)).buffer||(e=new Uint8Array(e)),e),a=(e,t,r,n=!0)=>{e=N(e)?new URL(e):m.normalize(e),y.readFile(e,n?void 0:"utf8",((e,i)=>{e?r(e):t(n?i.buffer:i)}))},!i.thisProgram&&1<tt.argv.length&&(l=tt.argv[1].replace(/\\/g,"/")),tt.argv.slice(2),h=(e,t)=>{throw tt.exitCode=e,t},i.inspect=()=>"[Emscripten Module object]"}else(c||f)&&(f?p=self.location.href:typeof document<"u"&&document.currentScript&&(p=document.currentScript.src),r&&(p=r),p=0!==p.indexOf("blob:")?p.substr(0,p.replace(/[?#].*/,"").lastIndexOf("/")+1):"",o=e=>{var t=new XMLHttpRequest;return t.open("GET",e,!1),t.send(null),t.responseText},f&&(s=e=>{var t=new XMLHttpRequest;return t.open("GET",e,!1),t.responseType="arraybuffer",t.send(null),new Uint8Array(t.response)}),a=(e,t,r)=>{var n=new XMLHttpRequest;n.open("GET",e,!0),n.responseType="arraybuffer",n.onload=()=>{200==n.status||0==n.status&&n.response?t(n.response):r()},n.onerror=r,n.send(null)});var g=console.log.bind(console),w=console.error.bind(console);Object.assign(i,u),u=null,"object"!=typeof WebAssembly&&M("no native wasm support detected");var v,b,x,_,S,T,E,O,A=!1;function I(){var e=v.buffer;i.HEAP8=x=new Int8Array(e),i.HEAP16=new Int16Array(e),i.HEAPU8=_=new Uint8Array(e),i.HEAPU16=new Uint16Array(e),i.HEAP32=S=new Int32Array(e),i.HEAPU32=T=new Uint32Array(e),i.HEAPF32=E=new Float32Array(e),i.HEAPF64=O=new Float64Array(e)}var P=[],k=[],C=[],$=0,R=null,D=null;function M(e){throw w(e="Aborted("+e+")"),A=!0,b=1,e=new WebAssembly.RuntimeError(e+". Build with -sASSERTIONS for more info."),n(e),e}var L,B=e=>e.startsWith("data:application/octet-stream;base64,"),N=e=>e.startsWith("file://");if(!B(L="ort-wasm-simd.wasm")){var F=L;L=i.locateFile?i.locateFile(F,p):p+F}function U(e){if(s)return s(e);throw"both async and sync fetching of the wasm failed"}function j(e,t,r){return function(e){if(c||f){if("function"==typeof fetch&&!N(e))return fetch(e,{credentials:"same-origin"}).then((t=>{if(!t.ok)throw"failed to load wasm binary file at '"+e+"'";return t.arrayBuffer()})).catch((()=>U(e)));if(a)return new Promise(((t,r)=>{a(e,(e=>t(new Uint8Array(e))),r)}))}return Promise.resolve().then((()=>U(e)))}(e).then((e=>WebAssembly.instantiate(e,t))).then((e=>e)).then(r,(e=>{w(`failed to asynchronously prepare wasm: ${e}`),M(e)}))}var z,G={898320:(e,t,r,n)=>{if(typeof i>"u"||!i.Ka)return 1;if((e=X(e>>>0)).startsWith("./")&&(e=e.substring(2)),!(e=i.Ka.get(e)))return 2;if((t>>>=0)+(r>>>=0)>e.byteLength)return 3;try{return _.set(e.subarray(t,t+r),n>>>0>>>0),0}catch{return 4}},898821:()=>{i.Xa()},898852:()=>{i.Ya()},898881:()=>{i.bb()},898906:e=>i.Wa(e),898939:e=>i.$a(e),898971:(e,t,r)=>{i.Qa(e,t,r,!0)},899010:(e,t,r)=>{i.Qa(e,t,r)},899043:e=>{i.Ba("Abs",e,void 0)},899094:e=>{i.Ba("Neg",e,void 0)},899145:e=>{i.Ba("Floor",e,void 0)},899198:e=>{i.Ba("Ceil",e,void 0)},899250:e=>{i.Ba("Reciprocal",e,void 0)},899308:e=>{i.Ba("Sqrt",e,void 0)},899360:e=>{i.Ba("Exp",e,void 0)},899411:e=>{i.Ba("Erf",e,void 0)},899462:e=>{i.Ba("Sigmoid",e,void 0)},899517:e=>{i.Ba("Log",e,void 0)},899568:e=>{i.Ba("Sin",e,void 0)},899619:e=>{i.Ba("Cos",e,void 0)},899670:e=>{i.Ba("Tan",e,void 0)},899721:e=>{i.Ba("Asin",e,void 0)},899773:e=>{i.Ba("Acos",e,void 0)},899825:e=>{i.Ba("Atan",e,void 0)},899877:e=>{i.Ba("Sinh",e,void 0)},899929:e=>{i.Ba("Cosh",e,void 0)},899981:e=>{i.Ba("Asinh",e,void 0)},900034:e=>{i.Ba("Acosh",e,void 0)},900087:e=>{i.Ba("Atanh",e,void 0)},900140:e=>{i.Ba("Tanh",e,void 0)},900192:e=>{i.Ba("Not",e,void 0)},900243:(e,t,r)=>{i.Ba("Clip",e,{min:t,max:r})},900312:e=>{i.Ba("Clip",e,void 0)},900364:(e,t)=>{i.Ba("Elu",e,{alpha:t})},900422:e=>{i.Ba("Relu",e,void 0)},900474:(e,t)=>{i.Ba("LeakyRelu",e,{alpha:t})},900538:(e,t)=>{i.Ba("ThresholdedRelu",e,{alpha:t})},900608:(e,t)=>{i.Ba("Cast",e,{to:t})},900666:e=>{i.Ba("Add",e,void 0)},900717:e=>{i.Ba("Sub",e,void 0)},900768:e=>{i.Ba("Mul",e,void 0)},900819:e=>{i.Ba("Div",e,void 0)},900870:e=>{i.Ba("Pow",e,void 0)},900921:e=>{i.Ba("Equal",e,void 0)},900974:e=>{i.Ba("Greater",e,void 0)},901029:e=>{i.Ba("GreaterOrEqual",e,void 0)},901091:e=>{i.Ba("Less",e,void 0)},901143:e=>{i.Ba("LessOrEqual",e,void 0)},901202:(e,t,r,n,o)=>{i.Ba("ReduceMean",e,{keepDims:!!t,noopWithEmptyAxes:!!r,axes:n?Array.from(S.subarray(n>>>0,o>>>0)):[]})},901361:(e,t,r,n,o)=>{i.Ba("ReduceMax",e,{keepDims:!!t,noopWithEmptyAxes:!!r,axes:n?Array.from(S.subarray(n>>>0,o>>>0)):[]})},901519:(e,t,r,n,o)=>{i.Ba("ReduceMin",e,{keepDims:!!t,noopWithEmptyAxes:!!r,axes:n?Array.from(S.subarray(n>>>0,o>>>0)):[]})},901677:(e,t,r,n,o)=>{i.Ba("ReduceProd",e,{keepDims:!!t,noopWithEmptyAxes:!!r,axes:n?Array.from(S.subarray(n>>>0,o>>>0)):[]})},901836:(e,t,r,n,o)=>{i.Ba("ReduceSum",e,{keepDims:!!t,noopWithEmptyAxes:!!r,axes:n?Array.from(S.subarray(n>>>0,o>>>0)):[]})},901994:(e,t,r,n,o)=>{i.Ba("ReduceL1",e,{keepDims:!!t,noopWithEmptyAxes:!!r,axes:n?Array.from(S.subarray(n>>>0,o>>>0)):[]})},902151:(e,t,r,n,o)=>{i.Ba("ReduceL2",e,{keepDims:!!t,noopWithEmptyAxes:!!r,axes:n?Array.from(S.subarray(n>>>0,o>>>0)):[]})},902308:(e,t,r,n,o)=>{i.Ba("ReduceLogSum",e,{keepDims:!!t,noopWithEmptyAxes:!!r,axes:n?Array.from(S.subarray(n>>>0,o>>>0)):[]})},902469:(e,t,r,n,o)=>{i.Ba("ReduceSumSquare",e,{keepDims:!!t,noopWithEmptyAxes:!!r,axes:n?Array.from(S.subarray(n>>>0,o>>>0)):[]})},902633:(e,t,r,n,o)=>{i.Ba("ReduceLogSumExp",e,{keepDims:!!t,noopWithEmptyAxes:!!r,axes:n?Array.from(S.subarray(n>>>0,o>>>0)):[]})},902797:e=>{i.Ba("Where",e,void 0)},902850:(e,t,r)=>{i.Ba("Transpose",e,{perm:t?Array.from(S.subarray(t>>>0,r>>>0)):[]})},902958:(e,t,r,n,o,a,s,u,l,h,c,f,d,p,y)=>{i.Ba("ConvTranspose",e,{format:l?"NHWC":"NCHW",autoPad:t,dilations:[r],group:n,kernel_shape:[o],pads:[a,s],strides:[u],wIsConst:()=>!!x[h>>>0],outputPadding:c?Array.from(S.subarray(c>>>0,f>>>0)):[],outputShape:d?Array.from(S.subarray(d>>>0,p>>>0)):[],activation:X(y)})},903360:(e,t,r,n,o,a,s,u,l,h,c,f,d,p)=>{i.Ba("ConvTranspose",e,{format:u?"NHWC":"NCHW",autoPad:t,dilations:Array.from(S.subarray(r>>>0,2+(r>>>0)>>>0)),group:n,kernelShape:Array.from(S.subarray(o>>>0,2+(o>>>0)>>>0)),pads:Array.from(S.subarray(a>>>0,4+(a>>>0)>>>0)),strides:Array.from(S.subarray(s>>>0,2+(s>>>0)>>>0)),wIsConst:()=>!!x[l>>>0],outputPadding:h?Array.from(S.subarray(h>>>0,c>>>0)):[],outputShape:f?Array.from(S.subarray(f>>>0,d>>>0)):[],activation:X(p)})},903925:(e,t,r,n,o,a,s,u,l,h,c,f,d,p,y)=>{i.Ba("ConvTranspose",e,{format:l?"NHWC":"NCHW",autoPad:t,dilations:[r],group:n,kernel_shape:[o],pads:[a,s],strides:[u],wIsConst:()=>!!x[h>>>0],outputPadding:c?Array.from(S.subarray(c>>>0,f>>>0)):[],outputShape:d?Array.from(S.subarray(d>>>0,p>>>0)):[],activation:X(y)})},904327:(e,t,r,n,o,a,s,u,l,h,c,f,d,p)=>{i.Ba("ConvTranspose",e,{format:u?"NHWC":"NCHW",autoPad:t,dilations:Array.from(S.subarray(r>>>0,2+(r>>>0)>>>0)),group:n,kernelShape:Array.from(S.subarray(o>>>0,2+(o>>>0)>>>0)),pads:Array.from(S.subarray(a>>>0,4+(a>>>0)>>>0)),strides:Array.from(S.subarray(s>>>0,2+(s>>>0)>>>0)),wIsConst:()=>!!x[l>>>0],outputPadding:h?Array.from(S.subarray(h>>>0,c>>>0)):[],outputShape:f?Array.from(S.subarray(f>>>0,d>>>0)):[],activation:X(p)})},904892:(e,t)=>{i.Ba("GlobalAveragePool",e,{format:t?"NHWC":"NCHW"})},904983:(e,t,r,n,o,a,s,u,l,h,c,f,d,p,y,m)=>{i.Ba("AveragePool",e,{format:m?"NHWC":"NCHW",auto_pad:t,ceil_mode:r,count_include_pad:n,storage_order:o,dilations:[a,s],kernel_shape:[u,l],pads:[h,c,f,d],strides:[p,y]})},905267:(e,t)=>{i.Ba("GlobalAveragePool",e,{format:t?"NHWC":"NCHW"})},905358:(e,t,r,n,o,a,s,u,l,h,c,f,d,p,y,m)=>{i.Ba("AveragePool",e,{format:m?"NHWC":"NCHW",auto_pad:t,ceil_mode:r,count_include_pad:n,storage_order:o,dilations:[a,s],kernel_shape:[u,l],pads:[h,c,f,d],strides:[p,y]})},905642:(e,t)=>{i.Ba("GlobalMaxPool",e,{format:t?"NHWC":"NCHW"})},905729:(e,t,r,n,o,a,s,u,l,h,c,f,d,p,y,m)=>{i.Ba("MaxPool",e,{format:m?"NHWC":"NCHW",auto_pad:t,ceil_mode:r,count_include_pad:n,storage_order:o,dilations:[a,s],kernel_shape:[u,l],pads:[h,c,f,d],strides:[p,y]})},906009:(e,t)=>{i.Ba("GlobalMaxPool",e,{format:t?"NHWC":"NCHW"})},906096:(e,t,r,n,o,a,s,u,l,h,c,f,d,p,y,m)=>{i.Ba("MaxPool",e,{format:m?"NHWC":"NCHW",auto_pad:t,ceil_mode:r,count_include_pad:n,storage_order:o,dilations:[a,s],kernel_shape:[u,l],pads:[h,c,f,d],strides:[p,y]})},906376:(e,t,r,n,o)=>{i.Ba("Gemm",e,{alpha:t,beta:r,transA:n,transB:o})},906480:e=>{i.Ba("MatMul",e,void 0)},906534:(e,t,r,n)=>{i.Ba("ArgMax",e,{keepDims:!!t,selectLastIndex:!!r,axis:n})},906642:(e,t,r,n)=>{i.Ba("ArgMin",e,{keepDims:!!t,selectLastIndex:!!r,axis:n})},906750:(e,t)=>{i.Ba("Softmax",e,{axis:t})},906813:(e,t)=>{i.Ba("Concat",e,{axis:t})},906873:(e,t,r,n,o)=>{i.Ba("Split",e,{axis:t,numOutputs:r,splitSizes:n?Array.from(S.subarray(n>>>0,o>>>0)):[]})},907013:e=>{i.Ba("Expand",e,void 0)},907067:(e,t)=>{i.Ba("Gather",e,{axis:Number(t)})},907138:(e,t)=>{i.Ba("GatherElements",e,{axis:Number(t)})},907217:(e,t,r,n,o,a,s,u,l,h,c)=>{i.Ba("Resize",e,{antialias:t,axes:r?Array.from(S.subarray(r>>>0,n>>>0)):[],coordinateTransformMode:X(o),cubicCoeffA:a,excludeOutside:s,extrapolationValue:u,keepAspectRatioPolicy:X(l),mode:X(h),nearestMode:X(c)})},907563:(e,t,r,n,o,a,s)=>{i.Ba("Slice",e,{starts:t?Array.from(S.subarray(t>>>0,r>>>0)):[],ends:n?Array.from(S.subarray(n>>>0,o>>>0)):[],axes:a?Array.from(S.subarray(a>>>0,s>>>0)):[]})},907779:e=>{i.Ba("Tile",e,void 0)},907831:(e,t,r)=>{i.Ba("LayerNormalization",e,{axis:Number(t),epsilon:Number(r)})},907938:(e,t,r)=>{i.Ba("InstanceNormalization",e,{epsilon:t,format:r?"NHWC":"NCHW"})},908052:(e,t,r)=>{i.Ba("InstanceNormalization",e,{epsilon:t,format:r?"NHWC":"NCHW"})},908166:e=>{i.Ba("Range",e,void 0)},908219:(e,t)=>{i.Ba("Einsum",e,{equation:X(t)})},908300:(e,t,r,n,o)=>{i.Ba("Pad",e,{mode:t,value:r,pads:n?Array.from(S.subarray(n>>>0,o>>>0)):[]})},908427:(e,t,r,n,o,a)=>{i.Ba("BatchNormalization",e,{epsilon:t,momentum:r,spatial:!!o,trainingMode:!!n,format:a?"NHWC":"NCHW"})},908596:(e,t,r,n,o,a)=>{i.Ba("BatchNormalization",e,{epsilon:t,momentum:r,spatial:!!o,trainingMode:!!n,format:a?"NHWC":"NCHW"})},908765:(e,t,r)=>{i.Ba("CumSum",e,{exclusive:Number(t),reverse:Number(r)})},908862:(e,t,r,n,o,a,s,u,l)=>{i.Ba("Attention",e,{numHeads:t,isUnidirectional:r,maskFilterValue:n,scale:o,doRotary:a,qkvHiddenSizes:s?Array.from(S.subarray(Number(u)>>>0,Number(u)+s>>>0)):[],pastPresentShareBuffer:!!l})},909134:e=>{i.Ba("Gelu",e,void 0)},909186:(e,t,r,n,o,a)=>{i.Ba("MultiHeadAttention",e,{numHeads:t,isUnidirectional:r,maskFilterValue:n,scale:o,doRotary:a})},909345:e=>{i.Ba("BiasAdd",e,void 0)},909400:e=>{i.Ba("BiasSplitGelu",e,void 0)},909461:(e,t)=>{i.Ba("SkipLayerNormalization",e,{epsilon:t})},909542:(e,t,r,n,o,a,s,u,l,h,c,f,d)=>{i.Ba("Conv",e,{format:l?"NHWC":"NCHW",auto_pad:t,dilations:[r],group:n,kernel_shape:[o],pads:a?Array.from(S.subarray(a>>>0,s>>>0)):[],strides:[u],w_is_const:()=>!!x[h>>>0],activation:X(c),activation_params:f?Array.from(E.subarray(f>>>0,d>>>0)):[]})},909912:(e,t,r,n,o,a,s,u,l,h,c,f,d,p,y,m)=>{i.Ba("Conv",e,{format:f?"NHWC":"NCHW",auto_pad:t,dilations:[r,n],group:o,kernel_shape:[a,s],pads:u?Array.from(S.subarray(u>>>0,l>>>0)):[],strides:[h,c],w_is_const:()=>!!x[d>>>0],activation:X(p),activation_params:y?Array.from(E.subarray(y>>>0,m>>>0)):[]})},910303:e=>{i.ab(e)},910337:(e,t)=>i.cb(e,t,i.Ja.eb,i.Ja.errors)};function V(e){this.name="ExitStatus",this.message=`Program terminated with exit(${e})`,this.status=e}function W(e){this.Na=e-24,this.Ua=function(e){T[this.Na+4>>>2>>>0]=e},this.Ta=function(e){T[this.Na+8>>>2>>>0]=e},this.Ra=function(e,t){this.Sa(),this.Ua(e),this.Ta(t)},this.Sa=function(){T[this.Na+16>>>2>>>0]=0}}var H,q=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0,Y=(e,t,r)=>{var n=(t>>>=0)+r;for(r=t;e[r]&&!(r>=n);)++r;if(16<r-t&&e.buffer&&q)return q.decode(e.subarray(t,r));for(n="";t<r;){var i=e[t++];if(128&i){var o=63&e[t++];if(192==(224&i))n+=String.fromCharCode((31&i)<<6|o);else{var a=63&e[t++];65536>(i=224==(240&i)?(15&i)<<12|o<<6|a:(7&i)<<18|o<<12|a<<6|63&e[t++])?n+=String.fromCharCode(i):(i-=65536,n+=String.fromCharCode(55296|i>>10,56320|1023&i))}}else n+=String.fromCharCode(i)}return n},X=(e,t)=>(e>>>=0)?Y(_,e,t):"",K=e=>{for(var t=0,r=0;r<e.length;++r){var n=e.charCodeAt(r);127>=n?t++:2047>=n?t+=2:55296<=n&&57343>=n?(t+=4,++r):t+=3}return t},Z=(e,t,r,n)=>{if(!(0<n))return 0;var i=r>>>=0;n=r+n-1;for(var o=0;o<e.length;++o){var a=e.charCodeAt(o);if(55296<=a&&57343>=a&&(a=65536+((1023&a)<<10)|1023&e.charCodeAt(++o)),127>=a){if(r>=n)break;t[r++>>>0]=a}else{if(2047>=a){if(r+1>=n)break;t[r++>>>0]=192|a>>6}else{if(65535>=a){if(r+2>=n)break;t[r++>>>0]=224|a>>12}else{if(r+3>=n)break;t[r++>>>0]=240|a>>18,t[r++>>>0]=128|a>>12&63}t[r++>>>0]=128|a>>6&63}t[r++>>>0]=128|63&a}}return t[r>>>0]=0,r-i},J=e=>e%4==0&&(e%100!=0||e%400==0),Q=[0,31,60,91,121,152,182,213,244,274,305,335],ee=[0,31,59,90,120,151,181,212,243,273,304,334],te=e=>{var t=K(e)+1,r=Ce(t);return r&&Z(e,_,r,t),r},re=[],ne=(e,t)=>{re.length=0;for(var r;r=_[e++>>>0];){var n=105!=r;t+=(n&=112!=r)&&t%8?4:0,re.push(112==r?T[t>>>2>>>0]:105==r?S[t>>>2>>>0]:O[t>>>3>>>0]),t+=n?8:4}return re},ie={},oe=()=>{if(!H){var e,t={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:("object"==typeof navigator&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",_:l||"./this.program"};for(e in ie)void 0===ie[e]?delete t[e]:t[e]=ie[e];var r=[];for(e in t)r.push(`${e}=${t[e]}`);H=r}return H},ae=[null,[],[]],se=e=>(se=(()=>{if("object"==typeof crypto&&"function"==typeof crypto.getRandomValues)return e=>crypto.getRandomValues(e);if(d)try{var e=(Ut(),ht(Nt));if(e.randomFillSync)return t=>e.randomFillSync(t);var t=e.randomBytes;return e=>(e.set(t(e.byteLength)),e)}catch{}M("initRandomDevice")})())(e),ue=[31,29,31,30,31,30,31,31,30,31,30,31],le=[31,28,31,30,31,30,31,31,30,31,30,31];function he(e,t,r,n){function i(e,t,r){for(e="number"==typeof e?e.toString():e||"";e.length<t;)e=r[0]+e;return e}function o(e,t){return i(e,t,"0")}function a(e,t){function r(e){return 0>e?-1:0<e?1:0}var n;return 0===(n=r(e.getFullYear()-t.getFullYear()))&&0===(n=r(e.getMonth()-t.getMonth()))&&(n=r(e.getDate()-t.getDate())),n}function s(e){switch(e.getDay()){case 0:return new Date(e.getFullYear()-1,11,29);case 1:return e;case 2:return new Date(e.getFullYear(),0,3);case 3:return new Date(e.getFullYear(),0,2);case 4:return new Date(e.getFullYear(),0,1);case 5:return new Date(e.getFullYear()-1,11,31);case 6:return new Date(e.getFullYear()-1,11,30)}}function u(e){var t=e.Ha;for(e=new Date(new Date(e.Ia+1900,0,1).getTime());0<t;){var r=e.getMonth(),n=(J(e.getFullYear())?ue:le)[r];if(!(t>n-e.getDate())){e.setDate(e.getDate()+t);break}t-=n-e.getDate()+1,e.setDate(1),11>r?e.setMonth(r+1):(e.setMonth(0),e.setFullYear(e.getFullYear()+1))}return r=new Date(e.getFullYear()+1,0,4),t=s(new Date(e.getFullYear(),0,4)),r=s(r),0>=a(t,e)?0>=a(r,e)?e.getFullYear()+1:e.getFullYear():e.getFullYear()-1}e>>>=0,t>>>=0,r>>>=0;var l=T[40+(n>>>=0)>>>2>>>0];for(var h in n={hb:S[n>>>2>>>0],gb:S[n+4>>>2>>>0],La:S[n+8>>>2>>>0],Pa:S[n+12>>>2>>>0],Ma:S[n+16>>>2>>>0],Ia:S[n+20>>>2>>>0],Ga:S[n+24>>>2>>>0],Ha:S[n+28>>>2>>>0],kb:S[n+32>>>2>>>0],fb:S[n+36>>>2>>>0],ib:l?X(l):""},r=X(r),l={"%c":"%a %b %d %H:%M:%S %Y","%D":"%m/%d/%y","%F":"%Y-%m-%d","%h":"%b","%r":"%I:%M:%S %p","%R":"%H:%M","%T":"%H:%M:%S","%x":"%m/%d/%y","%X":"%H:%M:%S","%Ec":"%c","%EC":"%C","%Ex":"%m/%d/%y","%EX":"%H:%M:%S","%Ey":"%y","%EY":"%Y","%Od":"%d","%Oe":"%e","%OH":"%H","%OI":"%I","%Om":"%m","%OM":"%M","%OS":"%S","%Ou":"%u","%OU":"%U","%OV":"%V","%Ow":"%w","%OW":"%W","%Oy":"%y"})r=r.replace(new RegExp(h,"g"),l[h]);var c="Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),f="January February March April May June July August September October November December".split(" ");for(h in l={"%a":e=>c[e.Ga].substring(0,3),"%A":e=>c[e.Ga],"%b":e=>f[e.Ma].substring(0,3),"%B":e=>f[e.Ma],"%C":e=>o((e.Ia+1900)/100|0,2),"%d":e=>o(e.Pa,2),"%e":e=>i(e.Pa,2," "),"%g":e=>u(e).toString().substring(2),"%G":e=>u(e),"%H":e=>o(e.La,2),"%I":e=>(0==(e=e.La)?e=12:12<e&&(e-=12),o(e,2)),"%j":e=>{for(var t=0,r=0;r<=e.Ma-1;t+=(J(e.Ia+1900)?ue:le)[r++]);return o(e.Pa+t,3)},"%m":e=>o(e.Ma+1,2),"%M":e=>o(e.gb,2),"%n":()=>"\n","%p":e=>0<=e.La&&12>e.La?"AM":"PM","%S":e=>o(e.hb,2),"%t":()=>"\t","%u":e=>e.Ga||7,"%U":e=>o(Math.floor((e.Ha+7-e.Ga)/7),2),"%V":e=>{var t=Math.floor((e.Ha+7-(e.Ga+6)%7)/7);if(2>=(e.Ga+371-e.Ha-2)%7&&t++,t)53==t&&(4==(r=(e.Ga+371-e.Ha)%7)||3==r&&J(e.Ia)||(t=1));else{t=52;var r=(e.Ga+7-e.Ha-1)%7;(4==r||5==r&&J(e.Ia%400-1))&&t++}return o(t,2)},"%w":e=>e.Ga,"%W":e=>o(Math.floor((e.Ha+7-(e.Ga+6)%7)/7),2),"%y":e=>(e.Ia+1900).toString().substring(2),"%Y":e=>e.Ia+1900,"%z":e=>(0<=(e=e.fb)?"+":"-")+("0000"+((e=Math.abs(e)/60)/60*100+e%60)).slice(-4),"%Z":e=>e.ib,"%%":()=>"%"},r=r.replace(/%%/g,"\0\0"),l)r.includes(h)&&(r=r.replace(new RegExp(h,"g"),l[h](n)));return h=function(e){var t=Array(K(e)+1);return Z(e,t,0,t.length),t}(r=r.replace(/\0\0/g,"%")),h.length>t?0:(x.set(h,e>>>0),h.length-1)}var ce=e=>{try{e()}catch(e){M(e)}},fe=0,de=null,pe=0,ye=[],me={},ge={},we=0,ve=null,be=[];function xe(e){if(!A){if(0===fe){var t=!1,r=!1;e(((e=0)=>{if(!A&&(pe=e,t=!0,r)){fe=2,ce((()=>Fe(de))),typeof Browser<"u"&&Browser.Oa.Va&&Browser.Oa.resume(),e=!1;try{var n=(0,Ie[ge[S[de+8>>>2>>>0]]])()}catch(t){n=t,e=!0}var i=!1;if(!de){var o=ve;o&&(ve=null,(e?o.reject:o.resolve)(n),i=!0)}if(e&&!i)throw n}})),r=!0,t||(fe=1,de=function(){var e=Ce(65548),t=e+12;T[e>>>2>>>0]=t,T[e+4>>>2>>>0]=t+65536,t=ye[0];var r=me[t];return void 0===r&&(r=we++,me[t]=r,ge[r]=t),S[e+8>>>2>>>0]=r,e}(),typeof Browser<"u"&&Browser.Oa.Va&&Browser.Oa.pause(),ce((()=>Be(de))))}else 2===fe?(fe=0,ce(Ue),$e(de),de=null,be.forEach((e=>{if(!A)try{e();try{b=b=e=b,i.onExit?.(e),A=!0,h(e,new V(e))}catch(e){e instanceof V||"unwind"==e||h(1,e)}}catch(e){e instanceof V||"unwind"==e||h(1,e)}}))):M(`invalid state: ${fe}`);return pe}}var _e,Se,Te=[],Ee=[],Oe=(e,t)=>{if(!Se){Se=new WeakMap;var r=_e.length;if(Se)for(var n=0;n<0+r;n++){var i=n,o=Te[i];o||(i>=Te.length&&(Te.length=i+1),Te[i]=o=_e.get(i)),(i=o)&&Se.set(i,n)}}if(r=Se.get(e)||0)return r;if(Ee.length)r=Ee.pop();else{try{_e.grow(1)}catch(e){throw e instanceof RangeError?"Unable to grow wasm table. Set ALLOW_TABLE_GROWTH.":e}r=_e.length-1}try{n=r,_e.set(n,e),Te[n]=_e.get(n)}catch(s){if(!(s instanceof TypeError))throw s;if("function"==typeof WebAssembly.Function){n=WebAssembly.Function,i={i:"i32",j:"i64",f:"f32",d:"f64",e:"externref",p:"i32"},o={parameters:[],results:"v"==t[0]?[]:[i[t[0]]]};for(var a=1;a<t.length;++a)o.parameters.push(i[t[a]]);t=new n(o,e)}else{for(n=[1],i=t.slice(0,1),t=t.slice(1),o={i:127,p:127,j:126,f:125,d:124,e:111},n.push(96),128>(a=t.length)?n.push(a):n.push(a%128|128,a>>7),a=0;a<t.length;++a)n.push(o[t[a]]);"v"==i?n.push(0):n.push(1,o[i]),t=[0,97,115,109,1,0,0,0,1],128>(i=n.length)?t.push(i):t.push(i%128|128,i>>7),t.push.apply(t,n),t.push(2,7,1,1,101,1,102,0,0,7,5,1,1,102,0,0),t=new WebAssembly.Module(new Uint8Array(t)),t=new WebAssembly.Instance(t,{e:{f:e}}).exports.f}n=r,_e.set(n,t),Te[n]=_e.get(n)}return Se.set(e,r),r},Ae={n:function(e,t,r){return function(e){return xe((t=>{e().then(t)}))}((async()=>{await i.Za(e,t,r)}))},a:function(e,t,r){throw new W(e>>>=0).Ra(t>>>0,r>>>0),e},g:function(){return 0},M:function(){},C:function(){},E:function(){},v:function(){return 0},K:function(){},F:function(){},J:function(){},m:function(){},D:function(){},A:function(){},L:function(){},B:function(){},N:()=>1,q:function(e,t,r){e=t+2097152>>>0<4194305-!!e?(e>>>0)+4294967296*t:NaN,r>>>=0,e=new Date(1e3*e),S[r>>>2>>>0]=e.getUTCSeconds(),S[r+4>>>2>>>0]=e.getUTCMinutes(),S[r+8>>>2>>>0]=e.getUTCHours(),S[r+12>>>2>>>0]=e.getUTCDate(),S[r+16>>>2>>>0]=e.getUTCMonth(),S[r+20>>>2>>>0]=e.getUTCFullYear()-1900,S[r+24>>>2>>>0]=e.getUTCDay(),S[r+28>>>2>>>0]=(e.getTime()-Date.UTC(e.getUTCFullYear(),0,1,0,0,0,0))/864e5|0},r:function(e,t,r){e=t+2097152>>>0<4194305-!!e?(e>>>0)+4294967296*t:NaN,r>>>=0,e=new Date(1e3*e),S[r>>>2>>>0]=e.getSeconds(),S[r+4>>>2>>>0]=e.getMinutes(),S[r+8>>>2>>>0]=e.getHours(),S[r+12>>>2>>>0]=e.getDate(),S[r+16>>>2>>>0]=e.getMonth(),S[r+20>>>2>>>0]=e.getFullYear()-1900,S[r+24>>>2>>>0]=e.getDay(),S[r+28>>>2>>>0]=(J(e.getFullYear())?Q:ee)[e.getMonth()]+e.getDate()-1|0,S[r+36>>>2>>>0]=-60*e.getTimezoneOffset(),t=new Date(e.getFullYear(),6,1).getTimezoneOffset();var n=new Date(e.getFullYear(),0,1).getTimezoneOffset();S[r+32>>>2>>>0]=0|(t!=n&&e.getTimezoneOffset()==Math.min(n,t))},s:function(e){e>>>=0;var t=new Date(S[e+20>>>2>>>0]+1900,S[e+16>>>2>>>0],S[e+12>>>2>>>0],S[e+8>>>2>>>0],S[e+4>>>2>>>0],S[e>>>2>>>0],0),r=S[e+32>>>2>>>0],n=t.getTimezoneOffset(),i=new Date(t.getFullYear(),6,1).getTimezoneOffset(),o=new Date(t.getFullYear(),0,1).getTimezoneOffset(),a=Math.min(o,i);return 0>r?S[e+32>>>2>>>0]=+(i!=o&&a==n):0<r!=(a==n)&&(i=Math.max(o,i),t.setTime(t.getTime()+6e4*((0<r?a:i)-n))),S[e+24>>>2>>>0]=t.getDay(),S[e+28>>>2>>>0]=(J(t.getFullYear())?Q:ee)[t.getMonth()]+t.getDate()-1|0,S[e>>>2>>>0]=t.getSeconds(),S[e+4>>>2>>>0]=t.getMinutes(),S[e+8>>>2>>>0]=t.getHours(),S[e+12>>>2>>>0]=t.getDate(),S[e+16>>>2>>>0]=t.getMonth(),S[e+20>>>2>>>0]=t.getYear(),e=t.getTime(),isNaN(e)?(S[ke()>>>2>>>0]=61,e=-1):e/=1e3,Re((z=e,1<=+Math.abs(z)?0<z?+Math.floor(z/4294967296)>>>0:~~+Math.ceil((z-+(~~z>>>0))/4294967296)>>>0:0)),e>>>0},o:function(){return-52},p:function(){},y:function(e,t,r){function n(e){return(e=e.toTimeString().match(/\(([A-Za-z ]+)\)$/))?e[1]:"GMT"}r>>>=0;var i=(new Date).getFullYear(),o=new Date(i,0,1),a=new Date(i,6,1);i=o.getTimezoneOffset();var s=a.getTimezoneOffset();T[e>>>0>>>2>>>0]=60*Math.max(i,s),S[t>>>0>>>2>>>0]=+(i!=s),e=n(o),t=n(a),e=te(e),t=te(t),s<i?(T[r>>>2>>>0]=e,T[r+4>>>2>>>0]=t):(T[r>>>2>>>0]=t,T[r+4>>>2>>>0]=e)},e:()=>{M("")},b:function(e,t,r){return e>>>=0,t=ne(t>>>0,r>>>0),G[e].apply(null,t)},j:function(e,t,r){return e>>>=0,t=ne(t>>>0,r>>>0),G[e].apply(null,t)},h:()=>Date.now(),z:function(){return 4294901760},c:()=>performance.now(),I:function(e,t,r){return t>>>=0,_.copyWithin(e>>>0>>>0,t>>>0,t+(r>>>0)>>>0)},w:function(e){e>>>=0;var t=_.length;if(4294901760<e)return!1;for(var r=1;4>=r;r*=2){var n=t*(1+.2/r);n=Math.min(n,e+100663296);var i=Math;n=Math.max(e,n);e:{i=(i.min.call(i,4294901760,n+(65536-n%65536)%65536)-v.buffer.byteLength+65535)/65536;try{v.grow(i),I();var o=1;break e}catch{}o=void 0}if(o)return!0}return!1},G:function(e,t){e>>>=0,t>>>=0;var r=0;return oe().forEach(((n,i)=>{var o=t+r;for(i=T[e+4*i>>>2>>>0]=o,o=0;o<n.length;++o)x[i++>>>0>>>0]=n.charCodeAt(o);x[i>>>0>>>0]=0,r+=n.length+1})),0},H:function(e,t){e>>>=0,t>>>=0;var r=oe();T[e>>>2>>>0]=r.length;var n=0;return r.forEach((e=>n+=e.length+1)),T[t>>>2>>>0]=n,0},f:()=>52,l:function(){return 52},t:function(){return 70},k:function(e,t,r,n){t>>>=0,r>>>=0,n>>>=0;for(var i=0,o=0;o<r;o++){var a=T[t>>>2>>>0],s=T[t+4>>>2>>>0];t+=8;for(var u=0;u<s;u++){var l=_[a+u>>>0],h=ae[e];0===l||10===l?((1===e?g:w)(Y(h,0)),h.length=0):h.push(l)}i+=s}return T[n>>>2>>>0]=i,0},u:function(e,t){return e>>>=0,se(_.subarray(e>>>0,e+(t>>>0)>>>0)),0},x:he,d:function(e,t,r,n){return he(e>>>0,t>>>0,r>>>0,n>>>0)},i:function(e,t,r,n){let i=_e.length;e=new Uint8Array(_.slice(e+t,e+r));try{var o,a=new WebAssembly.Module(e),s=new WebAssembly.Instance(a,{env:{memory:v}});for(o in s.exports)Oe(s.exports[o]);return i<_e.length?i:n}catch(e){return console.log(e),n}}},Ie=function(){function e(e){return Ie=e.exports,Ie=function(){var e=Ie,t={};for(let[r,n]of Object.entries(e))t[r]="function"==typeof n?function(){ye.push(r);try{return n.apply(null,arguments)}finally{A||(ye.pop(),de&&1===fe&&0===ye.length&&(fe=0,ce(Ne),typeof Fibers<"u"&&Fibers.lb()))}}:n;return t}(),Ie=function(){var e=Ie;e=Object.assign({},e);var t=e=>()=>e()>>>0,r=e=>t=>e(t)>>>0;return e.ta=t(e.ta),e.ua=r(e.ua),e.ya=t(e.ya),e.Aa=r(e.Aa),e}(),v=Ie.O,I(),_e=Ie.wa,k.unshift(Ie.P),0==--$&&(null!==R&&(clearInterval(R),R=null),D&&(e=D,D=null,e())),Ie}var t={a:Ae};if($++,i.instantiateWasm)try{return i.instantiateWasm(t,e)}catch(e){w(`Module.instantiateWasm callback failed with error: ${e}`),n(e)}return function(e,t){var r=L;return"function"!=typeof WebAssembly.instantiateStreaming||B(r)||N(r)||d||"function"!=typeof fetch?j(r,e,t):fetch(r,{credentials:"same-origin"}).then((n=>WebAssembly.instantiateStreaming(n,e).then(t,(function(n){return w(`wasm streaming compile failed: ${n}`),w("falling back to ArrayBuffer instantiation"),j(r,e,t)}))))}(t,(function(t){e(t.instance)})).catch(n),{}}();i._OrtInit=(e,t)=>(i._OrtInit=Ie.Q)(e,t),i._OrtGetLastError=(e,t)=>(i._OrtGetLastError=Ie.R)(e,t),i._OrtCreateSessionOptions=(e,t,r,n,o,a,s,u,l,h)=>(i._OrtCreateSessionOptions=Ie.S)(e,t,r,n,o,a,s,u,l,h),i._OrtAppendExecutionProvider=(e,t)=>(i._OrtAppendExecutionProvider=Ie.T)(e,t),i._OrtAddFreeDimensionOverride=(e,t,r)=>(i._OrtAddFreeDimensionOverride=Ie.U)(e,t,r),i._OrtAddSessionConfigEntry=(e,t,r)=>(i._OrtAddSessionConfigEntry=Ie.V)(e,t,r),i._OrtReleaseSessionOptions=e=>(i._OrtReleaseSessionOptions=Ie.W)(e),i._OrtCreateSession=(e,t,r)=>(i._OrtCreateSession=Ie.X)(e,t,r),i._OrtReleaseSession=e=>(i._OrtReleaseSession=Ie.Y)(e),i._OrtGetInputOutputCount=(e,t,r)=>(i._OrtGetInputOutputCount=Ie.Z)(e,t,r),i._OrtGetInputName=(e,t)=>(i._OrtGetInputName=Ie._)(e,t),i._OrtGetOutputName=(e,t)=>(i._OrtGetOutputName=Ie.$)(e,t),i._OrtFree=e=>(i._OrtFree=Ie.aa)(e),i._OrtCreateTensor=(e,t,r,n,o,a)=>(i._OrtCreateTensor=Ie.ba)(e,t,r,n,o,a),i._OrtGetTensorData=(e,t,r,n,o)=>(i._OrtGetTensorData=Ie.ca)(e,t,r,n,o),i._OrtReleaseTensor=e=>(i._OrtReleaseTensor=Ie.da)(e),i._OrtCreateRunOptions=(e,t,r,n)=>(i._OrtCreateRunOptions=Ie.ea)(e,t,r,n),i._OrtAddRunConfigEntry=(e,t,r)=>(i._OrtAddRunConfigEntry=Ie.fa)(e,t,r),i._OrtReleaseRunOptions=e=>(i._OrtReleaseRunOptions=Ie.ga)(e),i._OrtCreateBinding=e=>(i._OrtCreateBinding=Ie.ha)(e),i._OrtBindInput=(e,t,r)=>(i._OrtBindInput=Ie.ia)(e,t,r),i._OrtBindOutput=(e,t,r,n)=>(i._OrtBindOutput=Ie.ja)(e,t,r,n),i._OrtClearBoundOutputs=e=>(i._OrtClearBoundOutputs=Ie.ka)(e),i._OrtReleaseBinding=e=>(i._OrtReleaseBinding=Ie.la)(e),i._OrtRunWithBinding=(e,t,r,n,o)=>(i._OrtRunWithBinding=Ie.ma)(e,t,r,n,o),i._OrtRun=(e,t,r,n,o,a,s,u)=>(i._OrtRun=Ie.na)(e,t,r,n,o,a,s,u),i._OrtEndProfiling=e=>(i._OrtEndProfiling=Ie.oa)(e),i._OrtConfigure=(e,t)=>(i._OrtConfigure=Ie.pa)(e,t),i._OrtAuth=(e,t)=>(i._OrtAuth=Ie.qa)(e,t),i._JsepOutput=(e,t,r)=>(i._JsepOutput=Ie.ra)(e,t,r),i._JsepGetNodeName=e=>(i._JsepGetNodeName=Ie.sa)(e);var Pe,ke=()=>(ke=Ie.ta)(),Ce=i._malloc=e=>(Ce=i._malloc=Ie.ua)(e),$e=i._free=e=>($e=i._free=Ie.va)(e),Re=e=>(Re=Ie.xa)(e),De=()=>(De=Ie.ya)(),Me=e=>(Me=Ie.za)(e),Le=e=>(Le=Ie.Aa)(e),Be=e=>(Be=Ie.Ca)(e),Ne=()=>(Ne=Ie.Da)(),Fe=e=>(Fe=Ie.Ea)(e),Ue=()=>(Ue=Ie.Fa)();function je(){if(!(0<$)){if(i.preRun)for("function"==typeof i.preRun&&(i.preRun=[i.preRun]);i.preRun.length;){var e=i.preRun.shift();P.unshift(e)}for(;0<P.length;)P.shift()(i);if(!(0<$||Pe||(Pe=!0,i.calledRun=!0,A))){for(;0<k.length;)k.shift()(i);for(t(i);0<C.length;)C.shift()(i)}}}return i.___start_em_js=910449,i.___stop_em_js=911222,i.stackAlloc=Le,i.stackSave=De,i.stackRestore=Me,i.addFunction=Oe,i.UTF8ToString=X,i.stringToUTF8=(e,t,r)=>Z(e,_,t,r),i.lengthBytesUTF8=K,D=function e(){Pe||je(),Pe||(D=e)},je(),e.ready});"object"==typeof e&&"object"==typeof t?t.exports=n:"function"==typeof define&&define.amd&&define([],(()=>n))})),zt=ut((()=>{})),Gt=ut((()=>{})),Vt={};lt(Vt,{cpus:()=>Wt});var Wt,Ht,qt,Yt,Xt,Kt,Zt,Jt,Qt,er,tr,rr,nr,ir,or,ar,sr,ur,lr,hr,cr,fr,dr,pr,yr,mr,gr,wr,vr,br,xr,_r,Sr,Tr,Er,Or,Ar,Ir,Pr,kr,Cr,$r,Rr,Dr,Mr,Lr,Br,Nr,Fr,Ur,jr,zr,Gr,Vr,Wr,Hr,qr,Yr,Xr,Kr,Zr,Jr,Qr,en,tn,rn,nn,on,an,sn,un,ln,hn,cn,fn,dn,pn,yn,mn,gn,wn,vn,bn,xn,_n,Sn,Tn,En,On,An,In,Pn,kn,Cn,$n,Rn,Dn,Mn,Ln,Bn,Nn,Fn,Un,jn,zn,Gn,Vn,Wn,Hn,qn,Yn,Xn,Kn,Zn,Jn,Qn,ei,ti,ri,ni,ii,oi,ai,si,ui,li,hi,ci,fi,di,pi,yi,mi,gi,wi,vi,bi,xi,_i,Si,Ti,Ei,Oi,Ai,Ii,Pi,ki,Ci,$i,Ri,Di,Mi,Li,Bi,Ni,Fi,Ui,ji,zi,Gi,Vi,Wi,Hi,qi,Yi,Xi,Ki,Zi,Ji,Qi,eo,to,ro,no,io,oo,ao,so,uo,lo,ho,co,fo,po,yo,mo,go,wo,vo,bo,xo,_o,So,To,Eo,Oo,Ao,Io,Po,ko,Co,$o,Ro,Do,Mo,Lo,Bo,No,Fo,Uo,jo,zo,Go,Vo,Wo,Ho,qo,Yo,Xo,Ko,Zo,Jo,Qo,ea,ta,ra,na,ia,oa,aa,sa,ua,la,ha,ca,fa,da,pa,ya,ma,ga,wa,va,ba,xa,_a,Sa,Ta,Ea,Oa,Aa,Ia,Pa,ka,Ca,$a,Ra,Da,Ma,La,Ba,Na,Fa,Ua,ja,za,Ga,Va,Wa,Ha,qa,Ya,Xa,Ka,Za,Ja,Qa,es,ts,rs,ns,is,os,as,ss,us,ls,hs,cs,fs,ds,ps,ys,ms,gs,ws,vs,bs,xs,_s,Ss,Ts,Es,Os,As,Is,Ps,ks,Cs,$s,Rs,Ds,Ms,Ls,Bs,Ns,Fs,Us,js,zs,Gs,Vs,Ws,Hs,qs,Ys,Xs,Ks,Zs,Js,Qs,eu,tu,ru,nu,iu,ou,au,su,uu,lu,hu,cu,fu,du,pu,yu,mu,gu,wu,vu,bu,xu,_u,Su,Tu,Eu,Ou,Au,Iu,Pu,ku,Cu,$u,Ru,Du,Mu,Lu,Bu,Nu,Fu,Uu=st((()=>{Wt=void 0})),ju=ut(((e,t)=>{var r,n=(r=typeof document<"u"&&document.currentScript?document.currentScript.src:void 0,typeof __filename<"u"&&(r=r||__filename),function(e={}){function t(){return P.buffer!=$.buffer&&F(),$}function n(){return P.buffer!=$.buffer&&F(),R}function i(){return P.buffer!=$.buffer&&F(),D}function o(){return P.buffer!=$.buffer&&F(),M}function a(){return P.buffer!=$.buffer&&F(),L}function s(){return P.buffer!=$.buffer&&F(),B}var u,l,h=e;h.ready=new Promise(((e,t)=>{u=e,l=t})),h.mountExternalData=(e,t)=>{(h.ib||(h.ib=new Map)).set(e,t)},h.unmountExternalData=()=>{delete h.ib},h.jsepInit=(e,t,r,n,i,o,a,s,u,l,c)=>{h.Ub=e,h.Bb=t,h.Fb=r,h.pb=n,h.Eb=i,h.Ua=o,h.Gb=a,h.Ib=s,h.Cb=u,h.Db=l,h.Hb=c,t=(e,t,r)=>(...n)=>{let i=dt,o=t?.();n=e(...n);let a=t?.();return o!==a&&(e=a,r(o),t=r=null),dt!=i?new Promise(((e,t)=>{vt={resolve:e,reject:t}})):n},r=t=>async(...r)=>{try{if(h.hb)throw Error("Session already started");let n=h.hb={Kb:r[0],errors:[]},i=await t(...r);if(h.hb!==n)throw Error("Session mismatch");e.flush();let o=n.errors;if(0<o.length){let e=await Promise.all(o);if(e=e.filter((e=>e)),0<e.length)throw Error(e.join("\n"))}return i}finally{h.hb=null}},h._OrtRun=r(t(h._OrtRun,(()=>h._OrtRun),(e=>h._OrtRun=e))),h._OrtRunWithBinding=r(t(h._OrtRunWithBinding,(()=>h._OrtRunWithBinding),(e=>h._OrtRunWithBinding=e))),h._OrtBindInput=t(h._OrtBindInput,(()=>h._OrtBindInput),(e=>h._OrtBindInput=e)),h.jsepRegisterBuffer=(t,r,n,i)=>e.registerBuffer(t,r,n,i),h.jsepGetBuffer=t=>e.getBuffer(t),h.jsepCreateDownloader=(t,r,n)=>e.createDownloader(t,r,n),h.jsepOnReleaseSession=t=>{e.onReleaseSession(t)},h.jsepOnRunStart=t=>e.onRunStart(t)};var c,f,d,p=Object.assign({},h),y="./this.program",m=(e,t)=>{throw t},g="object"==typeof window,w="function"==typeof importScripts,v="object"==typeof tt&&"object"==typeof tt.versions&&"string"==typeof tt.versions.node,b=h.ENVIRONMENT_IS_PTHREAD||!1,x="";function _(e){return h.locateFile?h.locateFile(e,x):x+e}if(v){var S=(Dt(),ht(kt)),T=(Bt(),ht(Mt));let e;x=w?T.dirname(x)+"/":__dirname+"/",c=(e,t)=>(e=Z(e)?new URL(e):T.normalize(e),S.readFileSync(e,t?void 0:"utf8")),d=e=>((e=c(e,!0)).buffer||(e=new Uint8Array(e)),e),f=(e,t,r,n=!0)=>{e=Z(e)?new URL(e):T.normalize(e),S.readFile(e,n?void 0:"utf8",((e,i)=>{e?r(e):t(n?i.buffer:i)}))},!h.thisProgram&&1<tt.argv.length&&(y=tt.argv[1].replace(/\\/g,"/")),tt.argv.slice(2),m=(e,t)=>{throw tt.exitCode=e,t},h.inspect=()=>"[Emscripten Module object]";try{e=zt()}catch(e){throw console.error('The "worker_threads" module is not supported in this node.js build - perhaps a newer version is needed?'),e}global.Worker=e.Worker}else(g||w)&&(w?x=self.location.href:typeof document<"u"&&document.currentScript&&(x=document.currentScript.src),typeof r<"u"&&r&&(x=r),x=0!==x.indexOf("blob:")?x.substr(0,x.replace(/[?#].*/,"").lastIndexOf("/")+1):"",v||(c=e=>{var t=new XMLHttpRequest;return t.open("GET",e,!1),t.send(null),t.responseText},w&&(d=e=>{var t=new XMLHttpRequest;return t.open("GET",e,!1),t.responseType="arraybuffer",t.send(null),new Uint8Array(t.response)}),f=(e,t,r)=>{var n=new XMLHttpRequest;n.open("GET",e,!0),n.responseType="arraybuffer",n.onload=()=>{200==n.status||0==n.status&&n.response?t(n.response):r()},n.onerror=r,n.send(null)}));v&&typeof performance>"u"&&(global.performance=Gt().performance);var E=console.log.bind(console),O=console.error.bind(console);v&&(E=(...e)=>S.writeSync(1,e.join(" ")+"\n"),O=(...e)=>S.writeSync(2,e.join(" ")+"\n"));var A=E,I=O;Object.assign(h,p),p=null,"object"!=typeof WebAssembly&&Y("no native wasm support detected");var P,k,C,$,R,D,M,L,B,N=!1;function F(){var e=P.buffer;h.HEAP8=$=new Int8Array(e),h.HEAP16=new Int16Array(e),h.HEAPU8=R=new Uint8Array(e),h.HEAPU16=new Uint16Array(e),h.HEAP32=D=new Int32Array(e),h.HEAPU32=M=new Uint32Array(e),h.HEAPF32=L=new Float32Array(e),h.HEAPF64=B=new Float64Array(e)}var U=16777216;if(b)P=h.wasmMemory;else if(h.wasmMemory)P=h.wasmMemory;else if(!((P=new WebAssembly.Memory({initial:U/65536,maximum:65536,shared:!0})).buffer instanceof SharedArrayBuffer))throw I("requested a shared WebAssembly.Memory but the returned buffer is not a SharedArrayBuffer, indicating that while the browser has SharedArrayBuffer it does not have WebAssembly threads support - you may need to set a flag"),v&&I("(on node you may need: --experimental-wasm-threads --experimental-wasm-bulk-memory and/or recent version)"),Error("bad memory");F(),U=P.buffer.byteLength;var j=[],z=[],G=[],V=0,W=null,H=null;function q(){if(0==--V&&(null!==W&&(clearInterval(W),W=null),H)){var e=H;H=null,e()}}function Y(e){throw I(e="Aborted("+e+")"),N=!0,C=1,e=new WebAssembly.RuntimeError(e+". Build with -sASSERTIONS for more info."),l(e),e}var X,K=e=>e.startsWith("data:application/octet-stream;base64,"),Z=e=>e.startsWith("file://");function J(e){if(d)return d(e);throw"both async and sync fetching of the wasm failed"}function Q(e,t,r){return function(e){if(g||w){if("function"==typeof fetch&&!Z(e))return fetch(e,{credentials:"same-origin"}).then((t=>{if(!t.ok)throw"failed to load wasm binary file at '"+e+"'";return t.arrayBuffer()})).catch((()=>J(e)));if(f)return new Promise(((t,r)=>{f(e,(e=>t(new Uint8Array(e))),r)}))}return Promise.resolve().then((()=>J(e)))}(e).then((e=>WebAssembly.instantiate(e,t))).then((e=>e)).then(r,(e=>{I(`failed to asynchronously prepare wasm: ${e}`),Y(e)}))}K(X="ort-wasm-simd-threaded.wasm")||(X=_(X));var ee,te={902852:(e,t,r,i)=>{if(typeof h>"u"||!h.ib)return 1;if((e=ue(e>>>0)).startsWith("./")&&(e=e.substring(2)),!(e=h.ib.get(e)))return 2;if(i>>>=0,(t>>>=0)+(r>>>=0)>e.byteLength)return 3;try{return n().set(e.subarray(t,t+r),i>>>0),0}catch{return 4}},903353:()=>{h.Cb()},903384:()=>{h.Db()},903413:()=>{h.Hb()},903438:e=>h.Bb(e),903471:e=>h.Fb(e),903503:(e,t,r)=>{h.pb(e,t,r,!0)},903542:(e,t,r)=>{h.pb(e,t,r)},903575:e=>{h.Ua("Abs",e,void 0)},903626:e=>{h.Ua("Neg",e,void 0)},903677:e=>{h.Ua("Floor",e,void 0)},903730:e=>{h.Ua("Ceil",e,void 0)},903782:e=>{h.Ua("Reciprocal",e,void 0)},903840:e=>{h.Ua("Sqrt",e,void 0)},903892:e=>{h.Ua("Exp",e,void 0)},903943:e=>{h.Ua("Erf",e,void 0)},903994:e=>{h.Ua("Sigmoid",e,void 0)},904049:e=>{h.Ua("Log",e,void 0)},904100:e=>{h.Ua("Sin",e,void 0)},904151:e=>{h.Ua("Cos",e,void 0)},904202:e=>{h.Ua("Tan",e,void 0)},904253:e=>{h.Ua("Asin",e,void 0)},904305:e=>{h.Ua("Acos",e,void 0)},904357:e=>{h.Ua("Atan",e,void 0)},904409:e=>{h.Ua("Sinh",e,void 0)},904461:e=>{h.Ua("Cosh",e,void 0)},904513:e=>{h.Ua("Asinh",e,void 0)},904566:e=>{h.Ua("Acosh",e,void 0)},904619:e=>{h.Ua("Atanh",e,void 0)},904672:e=>{h.Ua("Tanh",e,void 0)},904724:e=>{h.Ua("Not",e,void 0)},904775:(e,t,r)=>{h.Ua("Clip",e,{min:t,max:r})},904844:e=>{h.Ua("Clip",e,void 0)},904896:(e,t)=>{h.Ua("Elu",e,{alpha:t})},904954:e=>{h.Ua("Relu",e,void 0)},905006:(e,t)=>{h.Ua("LeakyRelu",e,{alpha:t})},905070:(e,t)=>{h.Ua("ThresholdedRelu",e,{alpha:t})},905140:(e,t)=>{h.Ua("Cast",e,{to:t})},905198:e=>{h.Ua("Add",e,void 0)},905249:e=>{h.Ua("Sub",e,void 0)},905300:e=>{h.Ua("Mul",e,void 0)},905351:e=>{h.Ua("Div",e,void 0)},905402:e=>{h.Ua("Pow",e,void 0)},905453:e=>{h.Ua("Equal",e,void 0)},905506:e=>{h.Ua("Greater",e,void 0)},905561:e=>{h.Ua("GreaterOrEqual",e,void 0)},905623:e=>{h.Ua("Less",e,void 0)},905675:e=>{h.Ua("LessOrEqual",e,void 0)},905734:(e,t,r,n,o)=>{h.Ua("ReduceMean",e,{keepDims:!!t,noopWithEmptyAxes:!!r,axes:n?Array.from(i().subarray(n>>>0,o>>>0)):[]})},905893:(e,t,r,n,o)=>{h.Ua("ReduceMax",e,{keepDims:!!t,noopWithEmptyAxes:!!r,axes:n?Array.from(i().subarray(n>>>0,o>>>0)):[]})},906051:(e,t,r,n,o)=>{h.Ua("ReduceMin",e,{keepDims:!!t,noopWithEmptyAxes:!!r,axes:n?Array.from(i().subarray(n>>>0,o>>>0)):[]})},906209:(e,t,r,n,o)=>{h.Ua("ReduceProd",e,{keepDims:!!t,noopWithEmptyAxes:!!r,axes:n?Array.from(i().subarray(n>>>0,o>>>0)):[]})},906368:(e,t,r,n,o)=>{h.Ua("ReduceSum",e,{keepDims:!!t,noopWithEmptyAxes:!!r,axes:n?Array.from(i().subarray(n>>>0,o>>>0)):[]})},906526:(e,t,r,n,o)=>{h.Ua("ReduceL1",e,{keepDims:!!t,noopWithEmptyAxes:!!r,axes:n?Array.from(i().subarray(n>>>0,o>>>0)):[]})},906683:(e,t,r,n,o)=>{h.Ua("ReduceL2",e,{keepDims:!!t,noopWithEmptyAxes:!!r,axes:n?Array.from(i().subarray(n>>>0,o>>>0)):[]})},906840:(e,t,r,n,o)=>{h.Ua("ReduceLogSum",e,{keepDims:!!t,noopWithEmptyAxes:!!r,axes:n?Array.from(i().subarray(n>>>0,o>>>0)):[]})},907001:(e,t,r,n,o)=>{h.Ua("ReduceSumSquare",e,{keepDims:!!t,noopWithEmptyAxes:!!r,axes:n?Array.from(i().subarray(n>>>0,o>>>0)):[]})},907165:(e,t,r,n,o)=>{h.Ua("ReduceLogSumExp",e,{keepDims:!!t,noopWithEmptyAxes:!!r,axes:n?Array.from(i().subarray(n>>>0,o>>>0)):[]})},907329:e=>{h.Ua("Where",e,void 0)},907382:(e,t,r)=>{h.Ua("Transpose",e,{perm:t?Array.from(i().subarray(t>>>0,r>>>0)):[]})},907490:(e,r,n,o,a,s,u,l,c,f,d,p,y,m,g)=>{h.Ua("ConvTranspose",e,{format:c?"NHWC":"NCHW",autoPad:r,dilations:[n],group:o,kernel_shape:[a],pads:[s,u],strides:[l],wIsConst:()=>!!t()[f>>>0],outputPadding:d?Array.from(i().subarray(d>>>0,p>>>0)):[],outputShape:y?Array.from(i().subarray(y>>>0,m>>>0)):[],activation:ue(g)})},907892:(e,r,n,o,a,s,u,l,c,f,d,p,y,m)=>{h.Ua("ConvTranspose",e,{format:l?"NHWC":"NCHW",autoPad:r,dilations:Array.from(i().subarray(n>>>0,2+(n>>>0)>>>0)),group:o,kernelShape:Array.from(i().subarray(a>>>0,2+(a>>>0)>>>0)),pads:Array.from(i().subarray(s>>>0,4+(s>>>0)>>>0)),strides:Array.from(i().subarray(u>>>0,2+(u>>>0)>>>0)),wIsConst:()=>!!t()[c>>>0],outputPadding:f?Array.from(i().subarray(f>>>0,d>>>0)):[],outputShape:p?Array.from(i().subarray(p>>>0,y>>>0)):[],activation:ue(m)})},908457:(e,r,n,o,a,s,u,l,c,f,d,p,y,m,g)=>{h.Ua("ConvTranspose",e,{format:c?"NHWC":"NCHW",autoPad:r,dilations:[n],group:o,kernel_shape:[a],pads:[s,u],strides:[l],wIsConst:()=>!!t()[f>>>0],outputPadding:d?Array.from(i().subarray(d>>>0,p>>>0)):[],outputShape:y?Array.from(i().subarray(y>>>0,m>>>0)):[],activation:ue(g)})},908859:(e,r,n,o,a,s,u,l,c,f,d,p,y,m)=>{h.Ua("ConvTranspose",e,{format:l?"NHWC":"NCHW",autoPad:r,dilations:Array.from(i().subarray(n>>>0,2+(n>>>0)>>>0)),group:o,kernelShape:Array.from(i().subarray(a>>>0,2+(a>>>0)>>>0)),pads:Array.from(i().subarray(s>>>0,4+(s>>>0)>>>0)),strides:Array.from(i().subarray(u>>>0,2+(u>>>0)>>>0)),wIsConst:()=>!!t()[c>>>0],outputPadding:f?Array.from(i().subarray(f>>>0,d>>>0)):[],outputShape:p?Array.from(i().subarray(p>>>0,y>>>0)):[],activation:ue(m)})},909424:(e,t)=>{h.Ua("GlobalAveragePool",e,{format:t?"NHWC":"NCHW"})},909515:(e,t,r,n,i,o,a,s,u,l,c,f,d,p,y,m)=>{h.Ua("AveragePool",e,{format:m?"NHWC":"NCHW",auto_pad:t,ceil_mode:r,count_include_pad:n,storage_order:i,dilations:[o,a],kernel_shape:[s,u],pads:[l,c,f,d],strides:[p,y]})},909799:(e,t)=>{h.Ua("GlobalAveragePool",e,{format:t?"NHWC":"NCHW"})},909890:(e,t,r,n,i,o,a,s,u,l,c,f,d,p,y,m)=>{h.Ua("AveragePool",e,{format:m?"NHWC":"NCHW",auto_pad:t,ceil_mode:r,count_include_pad:n,storage_order:i,dilations:[o,a],kernel_shape:[s,u],pads:[l,c,f,d],strides:[p,y]})},910174:(e,t)=>{h.Ua("GlobalMaxPool",e,{format:t?"NHWC":"NCHW"})},910261:(e,t,r,n,i,o,a,s,u,l,c,f,d,p,y,m)=>{h.Ua("MaxPool",e,{format:m?"NHWC":"NCHW",auto_pad:t,ceil_mode:r,count_include_pad:n,storage_order:i,dilations:[o,a],kernel_shape:[s,u],pads:[l,c,f,d],strides:[p,y]})},910541:(e,t)=>{h.Ua("GlobalMaxPool",e,{format:t?"NHWC":"NCHW"})},910628:(e,t,r,n,i,o,a,s,u,l,c,f,d,p,y,m)=>{h.Ua("MaxPool",e,{format:m?"NHWC":"NCHW",auto_pad:t,ceil_mode:r,count_include_pad:n,storage_order:i,dilations:[o,a],kernel_shape:[s,u],pads:[l,c,f,d],strides:[p,y]})},910908:(e,t,r,n,i)=>{h.Ua("Gemm",e,{alpha:t,beta:r,transA:n,transB:i})},911012:e=>{h.Ua("MatMul",e,void 0)},911066:(e,t,r,n)=>{h.Ua("ArgMax",e,{keepDims:!!t,selectLastIndex:!!r,axis:n})},911174:(e,t,r,n)=>{h.Ua("ArgMin",e,{keepDims:!!t,selectLastIndex:!!r,axis:n})},911282:(e,t)=>{h.Ua("Softmax",e,{axis:t})},911345:(e,t)=>{h.Ua("Concat",e,{axis:t})},911405:(e,t,r,n,o)=>{h.Ua("Split",e,{axis:t,numOutputs:r,splitSizes:n?Array.from(i().subarray(n>>>0,o>>>0)):[]})},911545:e=>{h.Ua("Expand",e,void 0)},911599:(e,t)=>{h.Ua("Gather",e,{axis:Number(t)})},911670:(e,t)=>{h.Ua("GatherElements",e,{axis:Number(t)})},911749:(e,t,r,n,o,a,s,u,l,c,f)=>{h.Ua("Resize",e,{antialias:t,axes:r?Array.from(i().subarray(r>>>0,n>>>0)):[],coordinateTransformMode:ue(o),cubicCoeffA:a,excludeOutside:s,extrapolationValue:u,keepAspectRatioPolicy:ue(l),mode:ue(c),nearestMode:ue(f)})},912095:(e,t,r,n,o,a,s)=>{h.Ua("Slice",e,{starts:t?Array.from(i().subarray(t>>>0,r>>>0)):[],ends:n?Array.from(i().subarray(n>>>0,o>>>0)):[],axes:a?Array.from(i().subarray(a>>>0,s>>>0)):[]})},912311:e=>{h.Ua("Tile",e,void 0)},912363:(e,t,r)=>{h.Ua("LayerNormalization",e,{axis:Number(t),epsilon:Number(r)})},912470:(e,t,r)=>{h.Ua("InstanceNormalization",e,{epsilon:t,format:r?"NHWC":"NCHW"})},912584:(e,t,r)=>{h.Ua("InstanceNormalization",e,{epsilon:t,format:r?"NHWC":"NCHW"})},912698:e=>{h.Ua("Range",e,void 0)},912751:(e,t)=>{h.Ua("Einsum",e,{equation:ue(t)})},912832:(e,t,r,n,o)=>{h.Ua("Pad",e,{mode:t,value:r,pads:n?Array.from(i().subarray(n>>>0,o>>>0)):[]})},912959:(e,t,r,n,i,o)=>{h.Ua("BatchNormalization",e,{epsilon:t,momentum:r,spatial:!!i,trainingMode:!!n,format:o?"NHWC":"NCHW"})},913128:(e,t,r,n,i,o)=>{h.Ua("BatchNormalization",e,{epsilon:t,momentum:r,spatial:!!i,trainingMode:!!n,format:o?"NHWC":"NCHW"})},913297:(e,t,r)=>{h.Ua("CumSum",e,{exclusive:Number(t),reverse:Number(r)})},913394:(e,t,r,n,o,a,s,u,l)=>{h.Ua("Attention",e,{numHeads:t,isUnidirectional:r,maskFilterValue:n,scale:o,doRotary:a,qkvHiddenSizes:s?Array.from(i().subarray(Number(u)>>>0,Number(u)+s>>>0)):[],pastPresentShareBuffer:!!l})},913666:e=>{h.Ua("Gelu",e,void 0)},913718:(e,t,r,n,i,o)=>{h.Ua("MultiHeadAttention",e,{numHeads:t,isUnidirectional:r,maskFilterValue:n,scale:i,doRotary:o})},913877:e=>{h.Ua("BiasAdd",e,void 0)},913932:e=>{h.Ua("BiasSplitGelu",e,void 0)},913993:(e,t)=>{h.Ua("SkipLayerNormalization",e,{epsilon:t})},914074:(e,r,n,o,s,u,l,c,f,d,p,y,m)=>{h.Ua("Conv",e,{format:f?"NHWC":"NCHW",auto_pad:r,dilations:[n],group:o,kernel_shape:[s],pads:u?Array.from(i().subarray(u>>>0,l>>>0)):[],strides:[c],w_is_const:()=>!!t()[d>>>0],activation:ue(p),activation_params:y?Array.from(a().subarray(y>>>0,m>>>0)):[]})},914444:(e,r,n,o,s,u,l,c,f,d,p,y,m,g,w,v)=>{h.Ua("Conv",e,{format:y?"NHWC":"NCHW",auto_pad:r,dilations:[n,o],group:s,kernel_shape:[u,l],pads:c?Array.from(i().subarray(c>>>0,f>>>0)):[],strides:[d,p],w_is_const:()=>!!t()[m>>>0],activation:ue(g),activation_params:w?Array.from(a().subarray(w>>>0,v>>>0)):[]})},914835:e=>{h.Gb(e)},914869:(e,t)=>h.Ib(e,t,h.hb.Kb,h.hb.errors)};function re(e){this.name="ExitStatus",this.message=`Program terminated with exit(${e})`,this.status=e}var ne=e=>{e.terminate(),e.onmessage=()=>{}},ie=e=>{0==ye.cb.length&&(pe(),ye.qb(ye.cb[0]));var t=ye.cb.pop();if(!t)return 6;ye.eb.push(t),ye.$a[e.bb]=t,t.bb=e.bb;var r={cmd:"run",start_routine:e.Lb,arg:e.xb,pthread_ptr:e.bb};return v&&t.unref(),t.postMessage(r,e.Rb),0},oe=0,ae=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0,se=(e,t,r)=>{var n=(t>>>=0)+r;for(r=t;e[r]&&!(r>=n);)++r;if(16<r-t&&e.buffer&&ae)return ae.decode(e.buffer instanceof SharedArrayBuffer?e.slice(t,r):e.subarray(t,r));for(n="";t<r;){var i=e[t++];if(128&i){var o=63&e[t++];if(192==(224&i))n+=String.fromCharCode((31&i)<<6|o);else{var a=63&e[t++];65536>(i=224==(240&i)?(15&i)<<12|o<<6|a:(7&i)<<18|o<<12|a<<6|63&e[t++])?n+=String.fromCharCode(i):(i-=65536,n+=String.fromCharCode(55296|i>>10,56320|1023&i))}}else n+=String.fromCharCode(i)}return n},ue=(e,t)=>(e>>>=0)?se(n(),e,t):"";function le(e,t){var r=arguments.length-2,n=arguments;return(e=>{var t=Zt();return e=e(),Jt(t),e})((()=>{for(var i=Qt(8*r),o=i>>>3,a=0;a<r;a++){var u=n[2+a];s()[o+a>>>0]=u}return Wt(e,r,i,t)}))}function he(e){if(b)return le(0,1,e);C=e,0<oe||(ye.Mb(),h.onExit?.(e),N=!0),m(e,new re(e))}var ce=e=>{if(C=e,b)throw ge(e),"unwind";he(e)},fe=e=>{e instanceof re||"unwind"==e||m(1,e)};function de(){for(var e=h.numThreads;e--;)pe();j.unshift((()=>{V++,function(e){b?e():Promise.all(ye.cb.map(ye.qb)).then(e)}((()=>q()))}))}function pe(){var e=_("ort-wasm-simd-threaded.worker.js");e=new Worker(e),ye.cb.push(e)}var ye={cb:[],eb:[],ub:[],$a:{},mb(){b?(ye.receiveObjectTransfer=ye.Jb,ye.threadInitTLS=ye.tb,ye.setExitStatus=ye.sb):de()},sb:e=>C=e,Vb:["$terminateWorker"],Mb:()=>{for(var e of ye.eb)ne(e);for(e of ye.cb)ne(e);ye.cb=[],ye.eb=[],ye.$a=[]},rb:e=>{var t=e.bb;delete ye.$a[t],ye.cb.push(e),ye.eb.splice(ye.eb.indexOf(e),1),e.bb=0,Ht(t)},Jb(){},tb(){ye.ub.forEach((e=>e()))},qb:e=>new Promise((t=>{e.onmessage=r=>{var n=(r=r.data).cmd;if(r.targetThread&&r.targetThread!=$t()){var i=ye.$a[r.targetThread];i?i.postMessage(r,r.transferList):I(`Internal error! Worker sent a message "${n}" to target pthread ${r.targetThread}, but that thread no longer exists!`)}else"checkMailbox"===n?Fe():"spawnThread"===n?ie(r):"cleanupThread"===n?ye.rb(ye.$a[r.thread]):"killThread"===n?(r=r.thread,n=ye.$a[r],delete ye.$a[r],ne(n),Ht(r),ye.eb.splice(ye.eb.indexOf(n),1),n.bb=0):"cancelThread"===n?ye.$a[r.thread].postMessage({cmd:"cancel"}):"loaded"===n?(e.loaded=!0,v&&!e.bb&&e.unref(),t(e)):"alert"===n?alert(`Thread ${r.threadId}: ${r.text}`):"setimmediate"===r.target?e.postMessage(r):"callHandler"===n?h[r.handler](...r.args):n&&I(`worker sent an unknown command ${n}`)},e.onerror=e=>{throw I(`worker sent an error! ${e.filename}:${e.lineno}: ${e.message}`),e},v&&(e.on("message",(t=>e.onmessage({data:t}))),e.on("error",(t=>e.onerror(t))));var n,i=[];for(n of["onExit"])h.hasOwnProperty(n)&&i.push(n);e.postMessage({cmd:"load",handlers:i,urlOrBlob:h.mainScriptUrlOrBlob||r,wasmMemory:P,wasmModule:k})}))};h.PThread=ye;var me=e=>{for(;0<e.length;)e.shift()(h)};function ge(e){if(b)return le(1,0,e);ce(e)}function we(e){this.lb=e-24,this.yb=function(e){o()[this.lb+4>>>2>>>0]=e},this.wb=function(e){o()[this.lb+8>>>2>>>0]=e},this.mb=function(e,t){this.vb(),this.yb(e),this.wb(t)},this.vb=function(){o()[this.lb+16>>>2>>>0]=0}}function ve(e,t,r,n){return b?le(2,1,e,t,r,n):be(e,t,r,n)}function be(e,t,r,n){if(e>>>=0,t>>>=0,r>>>=0,n>>>=0,typeof SharedArrayBuffer>"u")return I("Current environment does not support SharedArrayBuffer, pthreads are not available!"),6;var i=[];return b&&0===i.length?ve(e,t,r,n):(e={Lb:r,bb:e,xb:n,Rb:i},b?(e.Tb="spawnThread",postMessage(e,i),0):ie(e))}function xe(e,t,r){return b?le(3,1,e,t,r):0}function _e(e,t){if(b)return le(4,1,e,t)}h.establishStackSpace=()=>{var e=$t(),t=o()[e+52>>>2>>>0];e=o()[e+56>>>2>>>0],Kt(t,t-e),Jt(t)},h.invokeEntryPoint=(e,t)=>{e=er.apply(null,[e,t]),0<oe?ye.sb(e):qt(e)};var Se=e=>{for(var t=0,r=0;r<e.length;++r){var n=e.charCodeAt(r);127>=n?t++:2047>=n?t+=2:55296<=n&&57343>=n?(t+=4,++r):t+=3}return t},Te=(e,t,r,n)=>{if(!(0<n))return 0;var i=r>>>=0;n=r+n-1;for(var o=0;o<e.length;++o){var a=e.charCodeAt(o);if(55296<=a&&57343>=a&&(a=65536+((1023&a)<<10)|1023&e.charCodeAt(++o)),127>=a){if(r>=n)break;t[r++>>>0]=a}else{if(2047>=a){if(r+1>=n)break;t[r++>>>0]=192|a>>6}else{if(65535>=a){if(r+2>=n)break;t[r++>>>0]=224|a>>12}else{if(r+3>=n)break;t[r++>>>0]=240|a>>18,t[r++>>>0]=128|a>>12&63}t[r++>>>0]=128|a>>6&63}t[r++>>>0]=128|63&a}}return t[r>>>0]=0,r-i},Ee=(e,t,r)=>Te(e,n(),t,r);function Oe(e,t){if(b)return le(5,1,e,t)}function Ae(e,t,r){if(b)return le(6,1,e,t,r)}function Ie(e,t,r){return b?le(7,1,e,t,r):0}function Pe(e,t){if(b)return le(8,1,e,t)}function ke(e,t,r){if(b)return le(9,1,e,t,r)}function Ce(e,t,r,n){if(b)return le(10,1,e,t,r,n)}function $e(e,t,r,n){if(b)return le(11,1,e,t,r,n)}function Re(e,t,r,n){if(b)return le(12,1,e,t,r,n)}function De(e){if(b)return le(13,1,e)}function Me(e,t){if(b)return le(14,1,e,t)}function Le(e,t,r){if(b)return le(15,1,e,t,r)}var Be=()=>{if(!(0<oe))try{b?qt(C):ce(C)}catch(e){fe(e)}};function Ne(e){e>>>=0,"function"==typeof Atomics.Sb&&(Atomics.Sb(i(),e>>>2,e).value.then(Fe),e+=128,Atomics.store(i(),e>>>2,1))}h.__emscripten_thread_mailbox_await=Ne;var Fe=()=>{var e=$t();if(e&&(Ne(e),!N))try{Yt(),Be()}catch(e){fe(e)}};h.checkMailbox=Fe;var Ue=[],je=e=>e%4==0&&(e%100!=0||e%400==0),ze=[0,31,60,91,121,152,182,213,244,274,305,335],Ge=[0,31,59,90,120,151,181,212,243,273,304,334];function Ve(e,t,r,n,i,o,a,s){return b?le(16,1,e,t,r,n,i,o,a,s):-52}function We(e,t,r,n,i,o,a){if(b)return le(17,1,e,t,r,n,i,o,a)}var He,qe=e=>{var t=Se(e)+1,r=Rt(t);return r&&Ee(e,r,t),r},Ye=[],Xe=(e,t)=>{Ye.length=0;for(var r;r=n()[e++>>>0];){var a=105!=r;t+=(a&=112!=r)&&t%8?4:0,Ye.push(112==r?o()[t>>>2>>>0]:105==r?i()[t>>>2>>>0]:s()[t>>>3>>>0]),t+=a?8:4}return Ye},Ke={},Ze=()=>{if(!He){var e,t={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:("object"==typeof navigator&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",_:y||"./this.program"};for(e in Ke)void 0===Ke[e]?delete t[e]:t[e]=Ke[e];var r=[];for(e in t)r.push(`${e}=${t[e]}`);He=r}return He};function Je(e,r){if(b)return le(18,1,e,r);e>>>=0,r>>>=0;var n=0;return Ze().forEach(((i,a)=>{var s=r+n;for(a=o()[e+4*a>>>2>>>0]=s,s=0;s<i.length;++s)t()[a++>>>0>>>0]=i.charCodeAt(s);t()[a>>>0>>>0]=0,n+=i.length+1})),0}function Qe(e,t){if(b)return le(19,1,e,t);e>>>=0,t>>>=0;var r=Ze();o()[e>>>2>>>0]=r.length;var n=0;return r.forEach((e=>n+=e.length+1)),o()[t>>>2>>>0]=n,0}function et(e){return b?le(20,1,e):52}function rt(e,t,r,n){return b?le(21,1,e,t,r,n):52}function nt(e,t,r,n,i){return b?le(22,1,e,t,r,n,i):70}var it=[null,[],[]];function ot(e,t,r,i){if(b)return le(23,1,e,t,r,i);t>>>=0,r>>>=0,i>>>=0;for(var a=0,s=0;s<r;s++){var u=o()[t>>>2>>>0],l=o()[t+4>>>2>>>0];t+=8;for(var h=0;h<l;h++){var c=n()[u+h>>>0],f=it[e];0===c||10===c?((1===e?A:I)(se(f,0)),f.length=0):f.push(c)}a+=l}return o()[i>>>2>>>0]=a,0}var at=e=>(at=(()=>{if("object"==typeof crypto&&"function"==typeof crypto.getRandomValues)return e=>(e.set(crypto.getRandomValues(new Uint8Array(e.byteLength))),e);if(v)try{var e=(Ut(),ht(Nt));if(e.randomFillSync)return t=>e.randomFillSync(t);var t=e.randomBytes;return e=>(e.set(t(e.byteLength)),e)}catch{}Y("initRandomDevice")})())(e),st=[31,29,31,30,31,30,31,31,30,31,30,31],ut=[31,28,31,30,31,30,31,31,30,31,30,31];function lt(e,r,n,a){function s(e,t,r){for(e="number"==typeof e?e.toString():e||"";e.length<t;)e=r[0]+e;return e}function u(e,t){return s(e,t,"0")}function l(e,t){function r(e){return 0>e?-1:0<e?1:0}var n;return 0===(n=r(e.getFullYear()-t.getFullYear()))&&0===(n=r(e.getMonth()-t.getMonth()))&&(n=r(e.getDate()-t.getDate())),n}function h(e){switch(e.getDay()){case 0:return new Date(e.getFullYear()-1,11,29);case 1:return e;case 2:return new Date(e.getFullYear(),0,3);case 3:return new Date(e.getFullYear(),0,2);case 4:return new Date(e.getFullYear(),0,1);case 5:return new Date(e.getFullYear()-1,11,31);case 6:return new Date(e.getFullYear()-1,11,30)}}function c(e){var t=e.fb;for(e=new Date(new Date(e.gb+1900,0,1).getTime());0<t;){var r=e.getMonth(),n=(je(e.getFullYear())?st:ut)[r];if(!(t>n-e.getDate())){e.setDate(e.getDate()+t);break}t-=n-e.getDate()+1,e.setDate(1),11>r?e.setMonth(r+1):(e.setMonth(0),e.setFullYear(e.getFullYear()+1))}return r=new Date(e.getFullYear()+1,0,4),t=h(new Date(e.getFullYear(),0,4)),r=h(r),0>=l(t,e)?0>=l(r,e)?e.getFullYear()+1:e.getFullYear():e.getFullYear()-1}e>>>=0,r>>>=0,n>>>=0,a>>>=0;var f=o()[a+40>>>2>>>0];for(var d in a={Pb:i()[a>>>2>>>0],Ob:i()[a+4>>>2>>>0],jb:i()[a+8>>>2>>>0],ob:i()[a+12>>>2>>>0],kb:i()[a+16>>>2>>>0],gb:i()[a+20>>>2>>>0],ab:i()[a+24>>>2>>>0],fb:i()[a+28>>>2>>>0],Wb:i()[a+32>>>2>>>0],Nb:i()[a+36>>>2>>>0],Qb:f?ue(f):""},n=ue(n),f={"%c":"%a %b %d %H:%M:%S %Y","%D":"%m/%d/%y","%F":"%Y-%m-%d","%h":"%b","%r":"%I:%M:%S %p","%R":"%H:%M","%T":"%H:%M:%S","%x":"%m/%d/%y","%X":"%H:%M:%S","%Ec":"%c","%EC":"%C","%Ex":"%m/%d/%y","%EX":"%H:%M:%S","%Ey":"%y","%EY":"%Y","%Od":"%d","%Oe":"%e","%OH":"%H","%OI":"%I","%Om":"%m","%OM":"%M","%OS":"%S","%Ou":"%u","%OU":"%U","%OV":"%V","%Ow":"%w","%OW":"%W","%Oy":"%y"})n=n.replace(new RegExp(d,"g"),f[d]);var p="Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),y="January February March April May June July August September October November December".split(" ");for(d in f={"%a":e=>p[e.ab].substring(0,3),"%A":e=>p[e.ab],"%b":e=>y[e.kb].substring(0,3),"%B":e=>y[e.kb],"%C":e=>u((e.gb+1900)/100|0,2),"%d":e=>u(e.ob,2),"%e":e=>s(e.ob,2," "),"%g":e=>c(e).toString().substring(2),"%G":e=>c(e),"%H":e=>u(e.jb,2),"%I":e=>(0==(e=e.jb)?e=12:12<e&&(e-=12),u(e,2)),"%j":e=>{for(var t=0,r=0;r<=e.kb-1;t+=(je(e.gb+1900)?st:ut)[r++]);return u(e.ob+t,3)},"%m":e=>u(e.kb+1,2),"%M":e=>u(e.Ob,2),"%n":()=>"\n","%p":e=>0<=e.jb&&12>e.jb?"AM":"PM","%S":e=>u(e.Pb,2),"%t":()=>"\t","%u":e=>e.ab||7,"%U":e=>u(Math.floor((e.fb+7-e.ab)/7),2),"%V":e=>{var t=Math.floor((e.fb+7-(e.ab+6)%7)/7);if(2>=(e.ab+371-e.fb-2)%7&&t++,t)53==t&&(4==(r=(e.ab+371-e.fb)%7)||3==r&&je(e.gb)||(t=1));else{t=52;var r=(e.ab+7-e.fb-1)%7;(4==r||5==r&&je(e.gb%400-1))&&t++}return u(t,2)},"%w":e=>e.ab,"%W":e=>u(Math.floor((e.fb+7-(e.ab+6)%7)/7),2),"%y":e=>(e.gb+1900).toString().substring(2),"%Y":e=>e.gb+1900,"%z":e=>(0<=(e=e.Nb)?"+":"-")+("0000"+((e=Math.abs(e)/60)/60*100+e%60)).slice(-4),"%Z":e=>e.Qb,"%%":()=>"%"},n=n.replace(/%%/g,"\0\0"),f)n.includes(d)&&(n=n.replace(new RegExp(d,"g"),f[d](a)));return d=function(e){var t=Array(Se(e)+1);return Te(e,t,0,t.length),t}(n=n.replace(/\0\0/g,"%")),d.length>r?0:(((e,r)=>{t().set(e,r>>>0)})(d,e),d.length-1)}var ct=e=>{try{e()}catch(e){Y(e)}},ft=0,dt=null,pt=0,yt=[],mt={},gt={},wt=0,vt=null,bt=[];function xt(e){if(!N){if(0===ft){var t=!1,r=!1;e(((e=0)=>{if(!N&&(pt=e,t=!0,r)){ft=2,ct((()=>nr(dt))),typeof Browser<"u"&&Browser.nb.Ab&&Browser.nb.resume(),e=!1;try{var n=function(){var e=i()[dt+8>>>2>>>0];return e=Pt[gt[e]],--oe,e()}()}catch(t){n=t,e=!0}var o=!1;if(!dt){var a=vt;a&&(vt=null,(e?a.reject:a.resolve)(n),o=!0)}if(e&&!o)throw n}})),r=!0,t||(ft=1,dt=function(){var e=Rt(65548),t=e+12;o()[e>>>2>>>0]=t,o()[e+4>>>2>>>0]=t+65536,t=yt[0];var r=mt[t];return void 0===r&&(r=wt++,mt[t]=r,gt[r]=t),t=r,i()[e+8>>>2>>>0]=t,e}(),typeof Browser<"u"&&Browser.nb.Ab&&Browser.nb.pause(),ct((()=>tr(dt))))}else 2===ft?(ft=0,ct(ir),Lt(dt),dt=null,bt.forEach((e=>{if(!N)try{e(),Be()}catch(e){fe(e)}}))):Y(`invalid state: ${ft}`);return pt}}var _t,St,Tt=[],Et=[],Ot=(e,t)=>{if(!St){St=new WeakMap;var r=_t.length;if(St)for(var n=0;n<0+r;n++){var i=n,o=Tt[i];o||(i>=Tt.length&&(Tt.length=i+1),Tt[i]=o=_t.get(i)),(i=o)&&St.set(i,n)}}if(r=St.get(e)||0)return r;if(Et.length)r=Et.pop();else{try{_t.grow(1)}catch(e){throw e instanceof RangeError?"Unable to grow wasm table. Set ALLOW_TABLE_GROWTH.":e}r=_t.length-1}try{n=r,_t.set(n,e),Tt[n]=_t.get(n)}catch(s){if(!(s instanceof TypeError))throw s;if("function"==typeof WebAssembly.Function){n=WebAssembly.Function,i={i:"i32",j:"i64",f:"f32",d:"f64",e:"externref",p:"i32"},o={parameters:[],results:"v"==t[0]?[]:[i[t[0]]]};for(var a=1;a<t.length;++a)o.parameters.push(i[t[a]]);t=new n(o,e)}else{for(n=[1],i=t.slice(0,1),t=t.slice(1),o={i:127,p:127,j:126,f:125,d:124,e:111},n.push(96),128>(a=t.length)?n.push(a):n.push(a%128|128,a>>7),a=0;a<t.length;++a)n.push(o[t[a]]);"v"==i?n.push(0):n.push(1,o[i]),t=[0,97,115,109,1,0,0,0,1],128>(i=n.length)?t.push(i):t.push(i%128|128,i>>7),t.push.apply(t,n),t.push(2,7,1,1,101,1,102,0,0,7,5,1,1,102,0,0),t=new WebAssembly.Module(new Uint8Array(t)),t=new WebAssembly.Instance(t,{e:{f:e}}).exports.f}n=r,_t.set(n,t),Tt[n]=_t.get(n)}return St.set(e,r),r};ye.mb();var At=[he,ge,ve,xe,_e,Oe,Ae,Ie,Pe,ke,Ce,$e,Re,De,Me,Le,Ve,We,Je,Qe,et,rt,nt,ot],It={r:function(e,t,r){return function(e){return xt((t=>{e().then(t)}))}((async()=>{await h.Eb(e,t,r)}))},b:function(e,t,r){throw new we(e>>>=0).mb(t>>>0,r>>>0),e},P:function(e){Ft(e>>>0,!w,1,!g,131072,!1),ye.tb()},n:function(e){e>>>=0,b?postMessage({cmd:"cleanupThread",thread:e}):ye.rb(ye.$a[e])},L:be,i:xe,V:_e,H:Oe,J:Ae,z:Ie,T:Pe,N:ke,S:Ce,p:$e,I:Re,F:De,U:Me,G:Le,Y:()=>1,D:function(e,t){(e>>>=0)==t>>>0?setTimeout((()=>Fe())):b?postMessage({targetThread:e,cmd:"checkMailbox"}):(e=ye.$a[e])&&e.postMessage({cmd:"checkMailbox"})},M:function(e,t,r,n){t>>>=0,Ue.length=r,n=n>>>0>>>3;for(var i=0;i<r;i++)Ue[i]=s()[n+i>>>0];return e=0>e?te[-e-1]:At[e],ye.zb=t,t=e.apply(null,Ue),ye.zb=0,t},O:Ne,X:function(e){v&&ye.$a[e>>>0].ref()},u:function(e,t,r){e=t+2097152>>>0<4194305-!!e?(e>>>0)+4294967296*t:NaN,r>>>=0,e=new Date(1e3*e),i()[r>>>2>>>0]=e.getUTCSeconds(),i()[r+4>>>2>>>0]=e.getUTCMinutes(),i()[r+8>>>2>>>0]=e.getUTCHours(),i()[r+12>>>2>>>0]=e.getUTCDate(),i()[r+16>>>2>>>0]=e.getUTCMonth(),i()[r+20>>>2>>>0]=e.getUTCFullYear()-1900,i()[r+24>>>2>>>0]=e.getUTCDay(),e=(e.getTime()-Date.UTC(e.getUTCFullYear(),0,1,0,0,0,0))/864e5|0,i()[r+28>>>2>>>0]=e},v:function(e,t,r){e=t+2097152>>>0<4194305-!!e?(e>>>0)+4294967296*t:NaN,r>>>=0,e=new Date(1e3*e),i()[r>>>2>>>0]=e.getSeconds(),i()[r+4>>>2>>>0]=e.getMinutes(),i()[r+8>>>2>>>0]=e.getHours(),i()[r+12>>>2>>>0]=e.getDate(),i()[r+16>>>2>>>0]=e.getMonth(),i()[r+20>>>2>>>0]=e.getFullYear()-1900,i()[r+24>>>2>>>0]=e.getDay(),t=(je(e.getFullYear())?ze:Ge)[e.getMonth()]+e.getDate()-1|0,i()[r+28>>>2>>>0]=t,i()[r+36>>>2>>>0]=-60*e.getTimezoneOffset(),t=new Date(e.getFullYear(),6,1).getTimezoneOffset();var n=new Date(e.getFullYear(),0,1).getTimezoneOffset();e=0|(t!=n&&e.getTimezoneOffset()==Math.min(n,t)),i()[r+32>>>2>>>0]=e},w:function(e){e>>>=0;var t=new Date(i()[e+20>>>2>>>0]+1900,i()[e+16>>>2>>>0],i()[e+12>>>2>>>0],i()[e+8>>>2>>>0],i()[e+4>>>2>>>0],i()[e>>>2>>>0],0),r=i()[e+32>>>2>>>0],n=t.getTimezoneOffset(),o=new Date(t.getFullYear(),6,1).getTimezoneOffset(),a=new Date(t.getFullYear(),0,1).getTimezoneOffset(),s=Math.min(a,o);return 0>r?i()[e+32>>>2>>>0]=+(o!=a&&s==n):0<r!=(s==n)&&(o=Math.max(a,o),t.setTime(t.getTime()+6e4*((0<r?s:o)-n))),i()[e+24>>>2>>>0]=t.getDay(),r=(je(t.getFullYear())?ze:Ge)[t.getMonth()]+t.getDate()-1|0,i()[e+28>>>2>>>0]=r,i()[e>>>2>>>0]=t.getSeconds(),i()[e+4>>>2>>>0]=t.getMinutes(),i()[e+8>>>2>>>0]=t.getHours(),i()[e+12>>>2>>>0]=t.getDate(),i()[e+16>>>2>>>0]=t.getMonth(),i()[e+20>>>2>>>0]=t.getYear(),e=t.getTime(),isNaN(e)?(i()[Ct()>>>2>>>0]=61,e=-1):e/=1e3,Xt((ee=e,1<=+Math.abs(ee)?0<ee?+Math.floor(ee/4294967296)>>>0:~~+Math.ceil((ee-+(~~ee>>>0))/4294967296)>>>0:0)),e>>>0},s:Ve,t:We,C:function(e,t,r){function n(e){return(e=e.toTimeString().match(/\(([A-Za-z ]+)\)$/))?e[1]:"GMT"}e>>>=0,t>>>=0,r>>>=0;var a=(new Date).getFullYear(),s=new Date(a,0,1),u=new Date(a,6,1);a=s.getTimezoneOffset();var l=u.getTimezoneOffset(),h=Math.max(a,l);o()[e>>>2>>>0]=60*h,i()[t>>>2>>>0]=+(a!=l),e=n(s),t=n(u),e=qe(e),t=qe(t),l<a?(o()[r>>>2>>>0]=e,o()[r+4>>>2>>>0]=t):(o()[r>>>2>>>0]=t,o()[r+4>>>2>>>0]=e)},d:()=>{Y("")},c:function(e,t,r){return e>>>=0,t=Xe(t>>>0,r>>>0),te[e].apply(null,t)},k:function(e,t,r){return e>>>=0,t=Xe(t>>>0,r>>>0),te[e].apply(null,t)},o:()=>{},q:()=>Date.now(),W:()=>{throw oe+=1,"unwind"},E:function(){return 4294901760},f:()=>performance.timeOrigin+performance.now(),g:()=>v?(Uu(),ht(Vt)).cpus().length:navigator.hardwareConcurrency,A:function(e){e>>>=0;var t=n().length;if(e<=t||4294901760<e)return!1;for(var r=1;4>=r;r*=2){var i=t*(1+.2/r);i=Math.min(i,e+100663296);var o=Math;i=Math.max(e,i);e:{o=(o.min.call(o,4294901760,i+(65536-i%65536)%65536)-P.buffer.byteLength+65535)/65536;try{P.grow(o),F();var a=1;break e}catch{}a=void 0}if(a)return!0}return!1},Q:Je,R:Qe,K:ce,h:et,m:rt,x:nt,l:ot,y:function(e,t){return e>>>=0,t>>>=0,at(n().subarray(e>>>0,e+t>>>0)),0},a:P||h.wasmMemory,B:lt,e:function(e,t,r,n){return lt(e>>>0,t>>>0,r>>>0,n>>>0)},j:function(e,t,r,i){let o=_t.length;e=new Uint8Array(n().slice(e+t,e+r));try{var a,s=new WebAssembly.Module(e),u=new WebAssembly.Instance(s,{env:{memory:P}});for(a in u.exports)Ot(u.exports[a]);return o<_t.length?o:i}catch(e){return console.log(e),i}}},Pt=function(){function e(e,t){return Pt=e.exports,Pt=function(){var e=Pt,t={};for(let[r,n]of Object.entries(e))t[r]="function"==typeof n?function(){yt.push(r);try{return n.apply(null,arguments)}finally{N||(yt.pop(),dt&&1===ft&&0===yt.length&&(ft=0,oe+=1,ct(rr),typeof Fibers<"u"&&Fibers.Xb()))}}:n;return t}(),Pt=function(){var e=Pt;e=Object.assign({},e);var t=e=>()=>e()>>>0,r=e=>t=>e(t)>>>0;return e.Da=t(e.Da),e.Ea=t(e.Ea),e.Fa=r(e.Fa),e.emscripten_main_runtime_thread_id=t(e.emscripten_main_runtime_thread_id),e.Ra=t(e.Ra),e.Ta=r(e.Ta),e}(),ye.ub.push(Pt.Ha),_t=Pt.Ia,z.unshift(Pt.Z),k=t,q(),Pt}var t={a:It};if(V++,h.instantiateWasm)try{return h.instantiateWasm(t,e)}catch(e){I(`Module.instantiateWasm callback failed with error: ${e}`),l(e)}return function(e,t){var r=X;return"function"!=typeof WebAssembly.instantiateStreaming||K(r)||Z(r)||v||"function"!=typeof fetch?Q(r,e,t):fetch(r,{credentials:"same-origin"}).then((n=>WebAssembly.instantiateStreaming(n,e).then(t,(function(n){return I(`wasm streaming compile failed: ${n}`),I("falling back to ArrayBuffer instantiation"),Q(r,e,t)}))))}(t,(function(t){e(t.instance,t.module)})).catch(l),{}}();h._OrtInit=(e,t)=>(h._OrtInit=Pt._)(e,t),h._OrtGetLastError=(e,t)=>(h._OrtGetLastError=Pt.$)(e,t),h._OrtCreateSessionOptions=(e,t,r,n,i,o,a,s,u,l)=>(h._OrtCreateSessionOptions=Pt.aa)(e,t,r,n,i,o,a,s,u,l),h._OrtAppendExecutionProvider=(e,t)=>(h._OrtAppendExecutionProvider=Pt.ba)(e,t),h._OrtAddFreeDimensionOverride=(e,t,r)=>(h._OrtAddFreeDimensionOverride=Pt.ca)(e,t,r),h._OrtAddSessionConfigEntry=(e,t,r)=>(h._OrtAddSessionConfigEntry=Pt.da)(e,t,r),h._OrtReleaseSessionOptions=e=>(h._OrtReleaseSessionOptions=Pt.ea)(e),h._OrtCreateSession=(e,t,r)=>(h._OrtCreateSession=Pt.fa)(e,t,r),h._OrtReleaseSession=e=>(h._OrtReleaseSession=Pt.ga)(e),h._OrtGetInputOutputCount=(e,t,r)=>(h._OrtGetInputOutputCount=Pt.ha)(e,t,r),h._OrtGetInputName=(e,t)=>(h._OrtGetInputName=Pt.ia)(e,t),h._OrtGetOutputName=(e,t)=>(h._OrtGetOutputName=Pt.ja)(e,t),h._OrtFree=e=>(h._OrtFree=Pt.ka)(e),h._OrtCreateTensor=(e,t,r,n,i,o)=>(h._OrtCreateTensor=Pt.la)(e,t,r,n,i,o),h._OrtGetTensorData=(e,t,r,n,i)=>(h._OrtGetTensorData=Pt.ma)(e,t,r,n,i),h._OrtReleaseTensor=e=>(h._OrtReleaseTensor=Pt.na)(e),h._OrtCreateRunOptions=(e,t,r,n)=>(h._OrtCreateRunOptions=Pt.oa)(e,t,r,n),h._OrtAddRunConfigEntry=(e,t,r)=>(h._OrtAddRunConfigEntry=Pt.pa)(e,t,r),h._OrtReleaseRunOptions=e=>(h._OrtReleaseRunOptions=Pt.qa)(e),h._OrtCreateBinding=e=>(h._OrtCreateBinding=Pt.ra)(e),h._OrtBindInput=(e,t,r)=>(h._OrtBindInput=Pt.sa)(e,t,r),h._OrtBindOutput=(e,t,r,n)=>(h._OrtBindOutput=Pt.ta)(e,t,r,n),h._OrtClearBoundOutputs=e=>(h._OrtClearBoundOutputs=Pt.ua)(e),h._OrtReleaseBinding=e=>(h._OrtReleaseBinding=Pt.va)(e),h._OrtRunWithBinding=(e,t,r,n,i)=>(h._OrtRunWithBinding=Pt.wa)(e,t,r,n,i),h._OrtRun=(e,t,r,n,i,o,a,s)=>(h._OrtRun=Pt.xa)(e,t,r,n,i,o,a,s),h._OrtEndProfiling=e=>(h._OrtEndProfiling=Pt.ya)(e),h._OrtConfigure=(e,t)=>(h._OrtConfigure=Pt.za)(e,t),h._OrtAuth=(e,t)=>(h._OrtAuth=Pt.Aa)(e,t),h._JsepOutput=(e,t,r)=>(h._JsepOutput=Pt.Ba)(e,t,r),h._JsepGetNodeName=e=>(h._JsepGetNodeName=Pt.Ca)(e);var Ct=()=>(Ct=Pt.Da)(),$t=h._pthread_self=()=>($t=h._pthread_self=Pt.Ea)(),Rt=h._malloc=e=>(Rt=h._malloc=Pt.Fa)(e),Lt=h._free=e=>(Lt=h._free=Pt.Ga)(e);h.__emscripten_tls_init=()=>(h.__emscripten_tls_init=Pt.Ha)();var Ft=h.__emscripten_thread_init=(e,t,r,n,i,o)=>(Ft=h.__emscripten_thread_init=Pt.Ja)(e,t,r,n,i,o);h.__emscripten_thread_crashed=()=>(h.__emscripten_thread_crashed=Pt.Ka)();var jt,Wt=(e,t,r,n)=>(Wt=Pt.La)(e,t,r,n),Ht=e=>(Ht=Pt.Ma)(e),qt=h.__emscripten_thread_exit=e=>(qt=h.__emscripten_thread_exit=Pt.Na)(e),Yt=()=>(Yt=Pt.Oa)(),Xt=e=>(Xt=Pt.Pa)(e),Kt=(e,t)=>(Kt=Pt.Qa)(e,t),Zt=()=>(Zt=Pt.Ra)(),Jt=e=>(Jt=Pt.Sa)(e),Qt=e=>(Qt=Pt.Ta)(e),er=h.dynCall_ii=(e,t)=>(er=h.dynCall_ii=Pt.Va)(e,t),tr=e=>(tr=Pt.Wa)(e),rr=()=>(rr=Pt.Xa)(),nr=e=>(nr=Pt.Ya)(e),ir=()=>(ir=Pt.Za)();function or(){if(!(0<V))if(b)u(h),b||me(z),startWorker(h);else{if(h.preRun)for("function"==typeof h.preRun&&(h.preRun=[h.preRun]);h.preRun.length;)j.unshift(h.preRun.shift());me(j),0<V||jt||(jt=!0,h.calledRun=!0,N||(b||me(z),u(h),b||me(G)))}}return h.___start_em_js=914981,h.___stop_em_js=915754,h.wasmMemory=P,h.stackAlloc=Qt,h.stackSave=Zt,h.stackRestore=Jt,h.keepRuntimeAlive=()=>0<oe,h.addFunction=Ot,h.UTF8ToString=ue,h.stringToUTF8=Ee,h.lengthBytesUTF8=Se,h.ExitStatus=re,h.PThread=ye,H=function e(){jt||or(),jt||(H=e)},or(),e.ready});"object"==typeof e&&"object"==typeof t?t.exports=n:"function"==typeof define&&define.amd&&define([],(()=>n))})),zu=ut(((e,t)=>{t.exports='"use strict";var Module={},ENVIRONMENT_IS_NODE=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string";if(ENVIRONMENT_IS_NODE){var nodeWorkerThreads=require("worker_threads"),parentPort=nodeWorkerThreads.parentPort;parentPort.on("message",e=>onmessage({data:e}));var fs=require("fs"),vm=require("vm");Object.assign(global,{self:global,require,Module,location:{href:__filename},Worker:nodeWorkerThreads.Worker,importScripts:e=>vm.runInThisContext(fs.readFileSync(e,"utf8"),{filename:e}),postMessage:e=>parentPort.postMessage(e),performance:global.performance||{now:Date.now}})}var initializedJS=!1;function threadPrintErr(){var e=Array.prototype.slice.call(arguments).join(" ");if(ENVIRONMENT_IS_NODE){fs.writeSync(2,e+`\n`);return}console.error(e)}function threadAlert(){var e=Array.prototype.slice.call(arguments).join(" ");postMessage({cmd:"alert",text:e,threadId:Module._pthread_self()})}var err=threadPrintErr;self.alert=threadAlert,Module.instantiateWasm=(e,t)=>{var a=Module.wasmModule;Module.wasmModule=null;var r=new WebAssembly.Instance(a,e);return t(r)},self.onunhandledrejection=e=>{throw e.reason||e};function handleMessage(e){try{if(e.data.cmd==="load"){let a=[];self.onmessage=r=>a.push(r),self.startWorker=r=>{Module=r,postMessage({cmd:"loaded"});for(let s of a)handleMessage(s);self.onmessage=handleMessage},Module.wasmModule=e.data.wasmModule;for(const r of e.data.handlers)Module[r]=(...s)=>{postMessage({cmd:"callHandler",handler:r,args:s})};if(Module.wasmMemory=e.data.wasmMemory,Module.buffer=Module.wasmMemory.buffer,Module.ENVIRONMENT_IS_PTHREAD=!0,typeof e.data.urlOrBlob=="string")importScripts(e.data.urlOrBlob);else{var t=URL.createObjectURL(e.data.urlOrBlob);importScripts(t),URL.revokeObjectURL(t)}ortWasmThreaded(Module)}else if(e.data.cmd==="run"){Module.__emscripten_thread_init(e.data.pthread_ptr,0,0,1),Module.__emscripten_thread_mailbox_await(e.data.pthread_ptr),Module.establishStackSpace(),Module.PThread.receiveObjectTransfer(e.data),Module.PThread.threadInitTLS(),initializedJS||(initializedJS=!0);try{Module.invokeEntryPoint(e.data.start_routine,e.data.arg)}catch(a){if(a!="unwind")throw a}}else e.data.cmd==="cancel"?Module._pthread_self()&&Module.__emscripten_thread_exit(-1):e.data.target==="setimmediate"||(e.data.cmd==="checkMailbox"?initializedJS&&Module.checkMailbox():e.data.cmd&&(err(`worker.js received unknown command ${e.data.cmd}`),err(e.data)))}catch(a){throw Module.__emscripten_thread_crashed?.(),a}}self.onmessage=handleMessage;\n'})),Gu=st((()=>{Ht=jt(),qt=ju(),Xt=!1,Kt=!1,Zt=!1,Jt=e=>{if(1===e)return!1;if(typeof SharedArrayBuffer>"u")return typeof self<"u"&&!self.crossOriginIsolated&&console.warn("env.wasm.numThreads is set to "+e+", but this will not work unless you enable crossOriginIsolated mode. See https://web.dev/cross-origin-isolation-guide/ for more info."),!1;typeof tt<"u"&&tt.versions&&tt.versions.node&&console.warn("env.wasm.numThreads is set to "+e+", however, currently onnxruntime-web does not support multi-threads in Node.js. Please consider using onnxruntime-node for performance critical scenarios.");try{return typeof MessageChannel<"u"&&(new MessageChannel).port1.postMessage(new SharedArrayBuffer(1)),WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,5,4,1,3,1,1,10,11,1,9,0,65,0,254,16,2,0,26,11]))}catch{return!1}},Qt=()=>{try{return WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,10,30,1,28,0,65,0,253,15,253,12,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,253,186,1,26,11]))}catch{return!1}},er=(e,t)=>e?t?"ort-wasm-simd-threaded.wasm":"ort-wasm-simd.wasm":t?"ort-wasm-threaded.wasm":"ort-wasm.wasm",tr=async e=>{if(Xt)return Promise.resolve();if(Kt)throw new Error("multiple calls to 'initializeWebAssembly()' detected.");if(Zt)throw new Error("previous call to 'initializeWebAssembly()' failed.");Kt=!0;let t=e.initTimeout,r=e.numThreads,n=e.simd,i=Jt(r),o=n&&Qt(),a=e.wasmPaths,s="string"==typeof a?a:void 0,u=er(o,i),l="object"==typeof a?a[u]:void 0,h=!1,c=[];if(t>0&&c.push(new Promise((e=>{setTimeout((()=>{h=!0,e()}),t)}))),c.push(new Promise(((e,t)=>{let n=i?qt:Ht,o={locateFile:(e,t)=>{if(i&&e.endsWith(".worker.js")&&typeof Blob<"u")return URL.createObjectURL(new Blob([zu()],{type:"text/javascript"}));if(e.endsWith(".wasm")){if(l)return l;let e=s??t;return"ort-wasm-simd.wasm"===u?e+"ort-wasm-simd.jsep.wasm":"ort-wasm-simd-threaded.wasm"===u?e+"ort-wasm-simd-threaded.jsep.wasm":e+u}return t+e}};if(i)if(o.numThreads=r,typeof Blob>"u")o.mainScriptUrlOrBlob=(void 0)(__dirname,"ort-wasm-threaded.js");else{let e=`var ortWasmThreaded=${n.toString()};`;o.mainScriptUrlOrBlob=new Blob([e],{type:"text/javascript"})}n(o).then((t=>{Kt=!1,Xt=!0,Yt=t,e()}),(e=>{Kt=!1,Zt=!0,t(e)}))}))),await Promise.race(c),h)throw new Error(`WebAssembly backend initializing failed due to timeout: ${t}ms`)},rr=()=>{if(Xt&&Yt)return Yt;throw new Error("WebAssembly is not initialized yet.")}})),Vu=st((()=>{Gu(),nr=(e,t)=>{let r=rr(),n=r.lengthBytesUTF8(e)+1,i=r._malloc(n);return r.stringToUTF8(e,i,n),t.push(i),i},ir=(e,t,r,n)=>{if("object"==typeof e&&null!==e){if(r.has(e))throw new Error("Circular reference in options");r.add(e)}Object.entries(e).forEach((([e,i])=>{let o=t?t+e:e;if("object"==typeof i)ir(i,o+".",r,n);else if("string"==typeof i||"number"==typeof i)n(o,i.toString());else{if("boolean"!=typeof i)throw new Error("Can't handle extra config type: "+typeof i);n(o,i?"1":"0")}}))},or=e=>{let t=rr(),r=t.stackSave();try{let r=t.stackAlloc(8);t._OrtGetLastError(r,r+4);let n=t.HEAP32[r/4],i=t.HEAPU32[r/4+1],o=i?t.UTF8ToString(i):"";throw new Error(`${e} ERROR_CODE: ${n}, ERROR_MESSAGE: ${o}`)}finally{t.stackRestore(r)}}})),Wu=st((()=>{Gu(),Vu(),ar=e=>{let t=rr(),r=0,n=[],i=e||{};try{if(void 0===e?.logSeverityLevel)i.logSeverityLevel=2;else if("number"!=typeof e.logSeverityLevel||!Number.isInteger(e.logSeverityLevel)||e.logSeverityLevel<0||e.logSeverityLevel>4)throw new Error(`log serverity level is not valid: ${e.logSeverityLevel}`);if(void 0===e?.logVerbosityLevel)i.logVerbosityLevel=0;else if("number"!=typeof e.logVerbosityLevel||!Number.isInteger(e.logVerbosityLevel))throw new Error(`log verbosity level is not valid: ${e.logVerbosityLevel}`);void 0===e?.terminate&&(i.terminate=!1);let o=0;return void 0!==e?.tag&&(o=nr(e.tag,n)),r=t._OrtCreateRunOptions(i.logSeverityLevel,i.logVerbosityLevel,!!i.terminate,o),0===r&&or("Can't create run options."),void 0!==e?.extra&&ir(e.extra,"",new WeakSet,((e,i)=>{let o=nr(e,n),a=nr(i,n);0!==t._OrtAddRunConfigEntry(r,o,a)&&or(`Can't set a run config entry: ${e} - ${i}.`)})),[r,n]}catch(e){throw 0!==r&&t._OrtReleaseRunOptions(r),n.forEach((e=>t._free(e))),e}}})),Hu=st((()=>{Gu(),Vu(),sr=e=>{switch(e){case"disabled":return 0;case"basic":return 1;case"extended":return 2;case"all":return 99;default:throw new Error(`unsupported graph optimization level: ${e}`)}},ur=e=>{switch(e){case"sequential":return 0;case"parallel":return 1;default:throw new Error(`unsupported execution mode: ${e}`)}},lr=e=>{e.extra||(e.extra={}),e.extra.session||(e.extra.session={});let t=e.extra.session;t.use_ort_model_bytes_directly||(t.use_ort_model_bytes_directly="1"),e.executionProviders&&e.executionProviders.some((e=>"webgpu"===("string"==typeof e?e:e.name)))&&(e.enableMemPattern=!1)},hr=(e,t,r)=>{for(let n of t){let t="string"==typeof n?n:n.name;switch(t){case"webnn":if(t="WEBNN","string"!=typeof n){let t=n;if(t?.deviceType){let n=nr("deviceType",r),i=nr(t.deviceType,r);0!==rr()._OrtAddSessionConfigEntry(e,n,i)&&or(`Can't set a session config entry: 'deviceType' - ${t.deviceType}.`)}if(t?.numThreads){let n=t.numThreads;("number"!=typeof n||!Number.isInteger(n)||n<0)&&(n=0);let i=nr("numThreads",r),o=nr(n.toString(),r);0!==rr()._OrtAddSessionConfigEntry(e,i,o)&&or(`Can't set a session config entry: 'numThreads' - ${t.numThreads}.`)}if(t?.powerPreference){let n=nr("powerPreference",r),i=nr(t.powerPreference,r);0!==rr()._OrtAddSessionConfigEntry(e,n,i)&&or(`Can't set a session config entry: 'powerPreference' - ${t.powerPreference}.`)}}break;case"webgpu":if(t="JS","string"!=typeof n){let t=n;if(t?.preferredLayout){if("NCHW"!==t.preferredLayout&&"NHWC"!==t.preferredLayout)throw new Error(`preferredLayout must be either 'NCHW' or 'NHWC': ${t.preferredLayout}`);let n=nr("preferredLayout",r),i=nr(t.preferredLayout,r);0!==rr()._OrtAddSessionConfigEntry(e,n,i)&&or(`Can't set a session config entry: 'preferredLayout' - ${t.preferredLayout}.`)}}break;case"wasm":case"cpu":continue;default:throw new Error(`not supported execution provider: ${t}`)}let i=nr(t,r);0!==rr()._OrtAppendExecutionProvider(e,i)&&or(`Can't append execution provider: ${t}.`)}},cr=e=>{let t=rr(),r=0,n=[],i=e||{};lr(i);try{let e=sr(i.graphOptimizationLevel??"all"),o=ur(i.executionMode??"sequential"),a="string"==typeof i.logId?nr(i.logId,n):0,s=i.logSeverityLevel??2;if(!Number.isInteger(s)||s<0||s>4)throw new Error(`log serverity level is not valid: ${s}`);let u=i.logVerbosityLevel??0;if(!Number.isInteger(u)||u<0||u>4)throw new Error(`log verbosity level is not valid: ${u}`);let l="string"==typeof i.optimizedModelFilePath?nr(i.optimizedModelFilePath,n):0;if(r=t._OrtCreateSessionOptions(e,!!i.enableCpuMemArena,!!i.enableMemPattern,o,!!i.enableProfiling,0,a,s,u,l),0===r&&or("Can't create session options."),i.executionProviders&&hr(r,i.executionProviders,n),void 0!==i.enableGraphCapture){if("boolean"!=typeof i.enableGraphCapture)throw new Error(`enableGraphCapture must be a boolean value: ${i.enableGraphCapture}`);let e=nr("enableGraphCapture",n),o=nr(i.enableGraphCapture.toString(),n);0!==t._OrtAddSessionConfigEntry(r,e,o)&&or(`Can't set a session config entry: 'enableGraphCapture' - ${i.enableGraphCapture}.`)}if(i.freeDimensionOverrides)for(let[e,o]of Object.entries(i.freeDimensionOverrides)){if("string"!=typeof e)throw new Error(`free dimension override name must be a string: ${e}`);if("number"!=typeof o||!Number.isInteger(o)||o<0)throw new Error(`free dimension override value must be a non-negative integer: ${o}`);let i=nr(e,n);0!==t._OrtAddFreeDimensionOverride(r,i,o)&&or(`Can't set a free dimension override: ${e} - ${o}.`)}return void 0!==i.extra&&ir(i.extra,"",new WeakSet,((e,i)=>{let o=nr(e,n),a=nr(i,n);0!==t._OrtAddSessionConfigEntry(r,o,a)&&or(`Can't set a session config entry: ${e} - ${i}.`)})),[r,n]}catch(e){throw 0!==r&&t._OrtReleaseSessionOptions(r),n.forEach((e=>t._free(e))),e}}})),qu=st((()=>{fr=e=>{switch(e){case"int8":return 3;case"uint8":return 2;case"bool":return 9;case"int16":return 5;case"uint16":return 4;case"int32":return 6;case"uint32":return 12;case"float16":return 10;case"float32":return 1;case"float64":return 11;case"string":return 8;case"int64":return 7;case"uint64":return 13;default:throw new Error(`unsupported data type: ${e}`)}},dr=e=>{switch(e){case 3:return"int8";case 2:return"uint8";case 9:return"bool";case 5:return"int16";case 4:return"uint16";case 6:return"int32";case 12:return"uint32";case 10:return"float16";case 1:return"float32";case 11:return"float64";case 8:return"string";case 7:return"int64";case 13:return"uint64";default:throw new Error(`unsupported data type: ${e}`)}},pr=e=>[void 0,4,1,1,2,2,4,8,void 0,1,2,8,4,8,void 0,void 0,void 0][e],yr=e=>{switch(e){case"float16":case"uint16":return Uint16Array;case"float32":return Float32Array;case"uint8":case"bool":return Uint8Array;case"int8":return Int8Array;case"int16":return Int16Array;case"int32":return Int32Array;case"float64":return Float64Array;case"uint32":return Uint32Array;case"int64":return BigInt64Array;case"uint64":return BigUint64Array;default:throw new Error(`unsupported type: ${e}`)}},mr=e=>{switch(e){case"verbose":return 0;case"info":return 1;case"warning":return 2;case"error":return 3;case"fatal":return 4;default:throw new Error(`unsupported logging level: ${e}`)}},gr=e=>"float32"===e||"int32"===e||"int64"===e||"bool"===e||"float16"===e||"uint32"===e,wr=e=>{switch(e){case"none":return 0;case"cpu":return 1;case"cpu-pinned":return 2;case"texture":return 3;case"gpu-buffer":return 4;default:throw new Error(`unsupported data location: ${e}`)}}})),Yu=st((()=>{vr=async e=>{if("string"!=typeof e)return e instanceof Blob?new Uint8Array(await e.arrayBuffer()):e instanceof Uint8Array?e:new Uint8Array(e);if(!(typeof tt<"u"&&tt.versions&&tt.versions.node)){let t=await fetch(e);if(!t.ok)throw new Error(`failed to load external data file: ${e}`);let r=t.headers.get("Content-Length"),n=r?parseInt(r,10):0;if(n<1073741824)return new Uint8Array(await t.arrayBuffer());{if(!t.body)throw new Error(`failed to load external data file: ${e}, no response body.`);let r,i=t.body.getReader();try{r=new ArrayBuffer(n)}catch(e){if(!(e instanceof RangeError))throw e;{let e=Math.ceil(n/65536);r=new WebAssembly.Memory({initial:e,maximum:e}).buffer}}let o=0;for(;;){let{done:e,value:t}=await i.read();if(e)break;let n=t.byteLength;new Uint8Array(r,o,n).set(t),o+=n}return new Uint8Array(r,0,n)}}try{return new Uint8Array(await(void 0)(e))}catch(t){if("ERR_FS_FILE_TOO_LARGE"===t.code){let t=(void 0)(e),r=[];for await(let e of t)r.push(e);return new Uint8Array(rt.concat(r))}throw t}}})),Xu=st((()=>{qu(),br=["V","I","W","E","F"],xr=(e,t)=>{console.log(`[${br[e]},${(new Date).toISOString()}]${t}`)},Tr=(e,t)=>{_r=e,Sr=t},Er=(e,t)=>{let r=mr(e);r>=mr(_r)&&xr(r,"function"==typeof t?t():t)},Or=(...e)=>{Sr&&Er(...e)}})),Ku=st((()=>{qu(),Ar=(e,t)=>new(yr(t))(e)})),Zu=st((()=>{})),Ju=st((()=>{Xu(),Zu(),Ir=e=>16*Math.ceil(e/16),Pr=1,kr=()=>Pr++,Cr=1,$r=()=>Cr++,Rr=async(e,t,r,n)=>{let i=Ir(r),o=e.device.createBuffer({size:i,usage:GPUBufferUsage.COPY_DST|GPUBufferUsage.MAP_READ});try{let a=e.getCommandEncoder();e.endComputePass(),a.copyBufferToBuffer(t,0,o,0,i),e.flush(),await o.mapAsync(GPUMapMode.READ);let s=o.getMappedRange();if(n){let e=n();return e.set(new Uint8Array(s,0,r)),e}return new Uint8Array(s.slice(0,r))}finally{o.destroy()}},Dr=class{constructor(e){this.backend=e,this.storageCache=new Map,this.freeBuffers=new Map,this.freeUniformBuffers=new Map,this.buffersForUploadingPending=[],this.buffersPending=[],this.externalBuffers=new Map,this.capturedPendingBuffers=new Map}upload(e,t){let r=t.buffer,n=t.byteOffset,i=t.byteLength,o=Ir(i),a=this.storageCache.get(e);if(!a)throw new Error("gpu data for uploading does not exist");if(a.originalSize!==i)throw new Error(`inconsistent data size. gpu data size=${a.originalSize}, data size=${i}`);let s=this.backend.device.createBuffer({mappedAtCreation:!0,size:o,usage:GPUBufferUsage.MAP_WRITE|GPUBufferUsage.COPY_SRC}),u=s.getMappedRange();new Uint8Array(u).set(new Uint8Array(r,n,i)),s.unmap();let l=this.backend.getCommandEncoder();this.backend.endComputePass(),l.copyBufferToBuffer(s,0,a.gpuData.buffer,0,o),Or("verbose",(()=>`[WebGPU] GpuDataManager.upload(id=${e})`)),this.buffersForUploadingPending.push(s)}memcpy(e,t){let r=this.storageCache.get(e);if(!r)throw new Error("source gpu data for memcpy does not exist");let n=this.storageCache.get(t);if(!n)throw new Error("destination gpu data for memcpy does not exist");if(r.originalSize!==n.originalSize)throw new Error("inconsistent source and destination gpu data size");let i=Ir(r.originalSize),o=this.backend.getCommandEncoder();this.backend.endComputePass(),o.copyBufferToBuffer(r.gpuData.buffer,0,n.gpuData.buffer,0,i)}registerExternalBuffer(e,t,r){let n;if(r){if(n=this.externalBuffers.get(r),void 0===n)throw new Error("previous buffer is not registered");if(e===r)return Or("verbose",(()=>`[WebGPU] GpuDataManager.registerExternalBuffer(size=${t}) => id=${n}, buffer is the same, skip.`)),n;if(this.backend.capturedCommandList.has(this.backend.currentSessionId))throw new Error("Registering a different external buffer under graph capture mode is not supported yet.\n             Please use the previous external buffer!");this.externalBuffers.delete(r)}else n=kr();return this.storageCache.set(n,{gpuData:{id:n,type:0,buffer:e,permamentID:$r()},originalSize:t}),this.externalBuffers.set(e,n),Or("verbose",(()=>`[WebGPU] GpuDataManager.registerExternalBuffer(size=${t}) => id=${n}, registered.`)),n}unregisterExternalBuffer(e){let t=this.externalBuffers.get(e);void 0!==t&&(this.storageCache.delete(t),this.externalBuffers.delete(e),Or("verbose",(()=>`[WebGPU] GpuDataManager.unregisterExternalBuffer() => id=${t}`)))}create(e,t=GPUBufferUsage.STORAGE|GPUBufferUsage.COPY_SRC|GPUBufferUsage.COPY_DST){let r,n=Ir(e),i=(t&GPUBufferUsage.STORAGE)===GPUBufferUsage.STORAGE,o=(t&GPUBufferUsage.UNIFORM)===GPUBufferUsage.UNIFORM;if(i||o){let e=i?this.freeBuffers:this.freeUniformBuffers,o=e.get(n);o||(o=[],e.set(n,o)),r=o.length>0?o.pop():{buffer:this.backend.device.createBuffer({size:n,usage:t}),permamentID:$r()}}else r={buffer:this.backend.device.createBuffer({size:n,usage:t}),permamentID:$r()};let a={id:kr(),type:0,buffer:r.buffer,permamentID:r.permamentID};return this.storageCache.set(a.id,{gpuData:a,originalSize:e}),Or("verbose",(()=>`[WebGPU] GpuDataManager.create(size=${e}) => id=${a.id}`)),a}get(e){return this.storageCache.get(e)?.gpuData}release(e){let t=this.storageCache.get(e);if(!t)throw new Error("releasing data does not exist");return Or("verbose",(()=>`[WebGPU] GpuDataManager.release(id=${e}), gpuDataId=${t.gpuData.id}`)),this.storageCache.delete(e),this.buffersPending.push({buffer:t.gpuData.buffer,permamentID:t.gpuData.permamentID}),t.originalSize}async download(e,t){let r=this.storageCache.get(e);if(!r)throw new Error("data does not exist");await Rr(this.backend,r.gpuData.buffer,r.originalSize,t)}refreshPendingBuffers(){for(let e of this.buffersForUploadingPending)e.destroy();if(this.buffersForUploadingPending=[],0!==this.buffersPending.length)if("default"===this.backend.sessionStatus){for(let e of this.buffersPending)(e.buffer.usage&GPUBufferUsage.STORAGE)===GPUBufferUsage.STORAGE?this.freeBuffers.get(e.buffer.size).push(e):(e.buffer.usage&GPUBufferUsage.UNIFORM)===GPUBufferUsage.UNIFORM?this.freeUniformBuffers.get(e.buffer.size).push(e):e.buffer.destroy();this.buffersPending=[]}else{let e=this.capturedPendingBuffers.get(this.backend.currentSessionId);e||(e=[],this.capturedPendingBuffers.set(this.backend.currentSessionId,e));for(let t of this.buffersPending)e.push(t);this.buffersPending=[]}}dispose(){this.freeBuffers.forEach((e=>{e.forEach((e=>{e.buffer.destroy()}))})),this.freeUniformBuffers.forEach((e=>{e.forEach((e=>{e.buffer.destroy()}))})),this.storageCache.forEach((e=>{e.gpuData.buffer.destroy()})),this.capturedPendingBuffers.forEach((e=>{e.forEach((e=>{e.buffer.destroy()}))})),this.storageCache=new Map,this.freeBuffers=new Map,this.freeUniformBuffers=new Map,this.capturedPendingBuffers=new Map}onReleaseSession(e){let t=this.capturedPendingBuffers.get(e);t&&(t.forEach((e=>{e.buffer.destroy()})),this.capturedPendingBuffers.delete(e))}},Mr=(...e)=>new Dr(...e)})),Qu=st((()=>{Lr=class{constructor(e){Object.assign(this,e)}get cacheKey(){return this.key||(this.key=Object.getOwnPropertyNames(this).sort().map((e=>`${this[e]}`)).join(";")),this.key}},Br=e=>new Lr(e)})),el=st((()=>{Nr=class{static calcMatMulShape(e,t){return e[1]!==t[0]?void 0:[e[0],t[1]]}},Fr=class{static calcShape(e,t,r=!1){let n=e.length,i=t.length;if(0===n)return t;if(0===i)return e;let o=Math.max(e.length,t.length),a=new Array(o);if(r){if(n<2||i<2)return;let r=Nr.calcMatMulShape([e[n-2],e[n-1]],[t[i-2],t[i-1]]);if(void 0===r)return;[a[o-2],a[o-1]]=r}for(let s=r?3:1;s<=o;s++){let r=n-s<0?1:e[n-s],u=i-s<0?1:t[i-s];if(r!==u&&r>1&&u>1)return;a[o-s]=Math.max(r,u)}return a}static isValidBroadcast(e,t){let r=e.length,n=t.length;if(r>n)return!1;for(let i=1;i<=r;i++)if(1!==e[r-i]&&e[r-i]!==t[n-i])return!1;return!0}},Ur=class e{static size(t){return e.getSizeFromDimensionRange(t,0,t.length)}static sizeFromDimension(t,r){if(r<0||r>t.length)throw new Error(`invalid dimension of ${r} for sizeFromDimension as Tensor has ${t.length} dimensions.`);return e.getSizeFromDimensionRange(t,r,t.length)}static sizeToDimension(t,r){if(r<0||r>t.length)throw new Error(`invalid dimension of ${r} for sizeToDimension as Tensor has ${t.length} dimensions.`);return e.getSizeFromDimensionRange(t,0,r)}static getSizeFromDimensionRange(e,t,r){let n=1;for(let i=t;i<r;i++){if(e[i]<0)throw new Error("cannot get valid size from specified dimension range. Most likely the range contains negative values in them.");n*=e[i]}return n}static computeStrides(e){let t=e.length;if(0===t)return[];if(1===t)return[1];let r=new Array(t);r[t-1]=1,r[t-2]=e[t-1];for(let n=t-3;n>=0;--n)r[n]=r[n+1]*e[n+1];return r}static normalizeAxis(e,t){if(e<-t&&e>=t)throw new Error("unsupported axis for this operation.");return e<0?e+t:e}static normalizeAxes(e,t){return e.map((r=>this.normalizeAxis(r,t??e.length)))}static sortBasedOnPerm(e,t){return t?t.map((t=>e[t])):e.slice().reverse()}static padShape(e,t){let r=e.length;return e.map(((e,n)=>e+t[n]+t[n+r]))}static areEqual(e,t){return e.length===t.length&&e.every(((e,r)=>e===t[r]))}},jr=class e{static adjustPoolAttributes(e,t,r,n,i,o){if(!e&&r.length!==t.length-2)throw new Error("length of specified kernel shapes should be 2 less than length of input dimensions");if(e)for(let e=0;e<t.length-2;e++)e>=r.length?r.push(t[e+2]):r[e]=t[e+2];for(let e=0;e<r.length;e++)if(e<n.length){if(n[e]<0)throw new Error("strides should be greater than or equal to 1")}else n.push(1);for(let e=0;e<r.length;e++)if(e<i.length){if(i[e]<0)throw new Error("dilations should be greater than or equal to 1")}else i.push(1);for(let e=0;e<2*r.length;e++)if(e<o.length){if(o[e]<0)throw new Error("pad should be greater than or equal to 1")}else o.push(0);for(let e=0;e<r.length;e++){if(r[e]<=0)throw new Error("kernel shapes need to be greater than 0");if(o[e]>=r[e]||o[e+r.length]>=r[e])throw new Error("pads should be smaller than kernel")}}static adjustPadsBasedOnAutoPad(t,r,n,i,o,a,s){if(s){if(o.length!==2*(t.length-2))throw new Error("length of pads should be twice the length of data dimensions");if(r.length!==t.length-2)throw new Error("length of strides should be the length of data dimensions");if(i.length!==t.length-2)throw new Error("length of kernel shapes should be the length of data dimensions");for(let u=0;u<t.length-2;u++)e.adjustPadAndReturnShape(t[u+(a?1:2)],r[u],n[u],i[u],o,u,u+t.length-2,s)}}static computePoolOutputShape(t,r,n,i,o,a,s){if(r.length<=0)throw new Error("input shape must be of size greater than 0");let u=[r[0],r[1]];return e.computeShapeHelper(t,r,u,n,i,o,a,s),u}static computeConvOutputShape(t,r,n,i,o,a,s){if(t.length<=0||r.length<=0)throw new Error("invalid input tensor dims or invalid filter tensor dims");let u=[t[0],r[0]];return e.computeShapeHelper(!1,t,u,n,i,o,a,s),u}static computeShapeHelper(t,r,n,i,o,a,s,u){if(t)for(let e=0;e<r.length-2;e++)n.push(1);else for(let t=0;t<r.length-2;t++)n.push(e.adjustPadAndReturnShape(r[t+2],i[t],o[t],a[t],s,t,t+r.length-2,u))}static adjustPadAndReturnShape(e,t,r,n,i,o,a,s){let u=r*(n-1)+1;if(!s||"NOTSET"===s)return Math.floor((e+i[o]+i[a]-u)/t+1);switch(s){case"VALID":return i[o]=0,i[a]=0,Math.floor((e-u)/t+1);case"SAME_LOWER":case"SAME_UPPER":if(1!==r)throw new Error("Dilation not supported for SAME_UPPER or SAME_LOWER");{let r=((e+t-1)/t-1)*t+n-e;return i[o]=Math.floor("SAME_LOWER"===s?(r+1)/2:r/2),i[a]=r-i[o],Math.floor((e+r-n)/t+1)}default:throw new Error("Unsupported AutoPad type")}}},zr=class{static getShapeOfGemmResult(e,t,r,n,i){if(2!==e.length||2!==r.length)throw new Error("shape need to be of size 2");let o,a,s;t?(o=e[1],a=e[0]):(o=e[0],a=e[1]);let u=-1;if(n?(s=r[0],u=1):(s=r[1],u=0),r[u]!==a)throw new Error("dimension mismatch");if(o<=0||s<=0||a<=0)throw new Error("invalid shape specified");if(i&&!Fr.isValidBroadcast(i,[o,s]))throw new Error("gemm: invalid bias shape for broadcast");return[o,s,a]}},Gr=-34028234663852886e22,Vr=34028234663852886e22})),tl=st((()=>{qu(),el(),Wr=(e,t)=>{if(3===t)throw new Error("vec3 has same alignment as vec4, use vec4 instead");switch(e){case 10:return t>1?`vec${t}<f16>`:"f16";case 1:return t>1?`vec${t}<f32>`:"f32";case 6:return t>1?`vec${t}<i32>`:"i32";case 12:return t>1?`vec${t}<u32>`:"u32";case 7:if(t>1)throw new Error("currently not supported vecX of uint64 yet");return["vec2<u32>","i32"];case 13:if(t>1)throw new Error("currently not supported vecX of uint64 yet");return["vec2<u32>","u32"];case 9:if(4!==t)throw new Error("bool must be vec4");return["u32","vec4<bool>"];default:throw new Error(`Unknown data type: ${e}`)}},Hr=(e,t=1)=>{let r=Wr(e,t);return"string"==typeof r?r:r[0]},qr=(e,t=1)=>{let r=Wr(e,t);return"string"==typeof r?r:r[1]},Yr=e=>0===e.length?[]:[{type:"uint32",data:e},{type:"uint32",data:Ur.computeStrides(e)}],Xr=e=>e%4==0?4:e%2==0?2:1,Kr=(e="f32",t,r="0")=>t&&1!==t?`vec${t}<${e}>(${r})`:`${e}(${r})`,Zr=(e,t,r)=>"f32"===e?r:1===t?`f32(${r})`:`vec${t}f(${r})`,Jr=(e,t)=>4===t?`(${e}.x + ${e}.y + ${e}.z + ${e}.w)`:2===t?`(${e}.x + ${e}.y)`:3===t?`(${e}.x + ${e}.y + ${e}.z)`:e,Qr=(e,t,r)=>e.startsWith("uniforms.")&&r>4?"string"==typeof t?`${e}[(${t}) / 4][(${t}) % 4]`:`${e}[${Math.floor(t/4)}][${t%4}]`:r>1?`${e}[${t}]`:e,en=(e,t,r,n,i)=>{let o="number"==typeof r,a=o?r:r.length,s=[...new Array(a).keys()],u=a<2?"u32":a<=4?`vec${a}<u32>`:`array<u32, ${a}>`,l=Wr(t,i),h="string"==typeof l?l:l[1],c="string"==typeof l?l:l[0],f={indices:u,value:h,storage:c,tensor:t},d=e=>"string"==typeof e?e:`${e}u`,p={offsetToIndices:!1,indicesToOffset:!1,broadcastedIndicesToOffset:!1,set:!1,setByIndices:!1,get:!1,getByIndices:!1},y=o?"uniforms.":"",m=`${y}${e}_shape`,g=`${y}${e}_strides`,w="";for(let e=0;e<a-1;e++)w+=`\n    let dim${e} = current / ${Qr(g,e,a)};\n    let rest${e} = current % ${Qr(g,e,a)};\n    indices[${e}] = dim${e};\n    current = rest${e};\n    `;w+=`indices[${a-1}] = current;`;let v=a<2?"":`\n  fn o2i_${e}(offset: u32) -> ${f.indices} {\n    var indices: ${f.indices};\n    var current = offset;\n    ${w}\n    return indices;\n  }`,b=[];if(a>=2)for(let e=a-1;e>=0;e--)b.push(`${Qr(g,e,a)} * (indices[${e}])`);let x=a<2?"":`\n  fn i2o_${e}(indices: ${f.indices}) -> u32 {\n    return ${b.join("+")};\n  }`,_=(...e)=>0===a?"0u":`${f.indices}(${e.map(d).join(",")})`,S=(e,t)=>a<2?`${e}`:`${Qr(e,t,a)}`,T={},E=(t,r)=>(()=>{if(f.storage===f.value)return`${e}[${t}]=${r};`;if("vec2<u32>"===f.storage&&"i32"===f.value)return`${e}[${t}]=vec2<u32>(u32(${r}), select(0u, 0xFFFFFFFFu, ${r} < 0));`;if("vec2<u32>"===f.storage&&"u32"===f.value)return`${e}[${t}]=vec2<u32>(u32(${r}), 0u);`;if("u32"===f.storage&&"vec4<bool>"===f.value)return`${e}[${t}]=dot(vec4<u32>(0x1, 0x100, 0x10000, 0x1000000), vec4<u32>(${r}));`;throw new Error(`not supported combination of storage type ${f.storage} and value type ${f.value} yet`)})(),O=t=>(()=>{if(f.storage===f.value)return`${e}[${t}]`;if("vec2<u32>"===f.storage&&"i32"===f.value)return`i32(${e}[${t}].x)`;if("vec2<u32>"===f.storage&&"u32"===f.value)return`u32(${e}[${t}].x)`;if("u32"===f.storage&&"vec4<bool>"===f.value)return`vec4<bool>(bool(${e}[${t}] & 0xFFu), bool(${e}[${t}] & 0xFF00u), bool(${e}[${t}] & 0xFF0000u), bool(${e}[${t}] & 0xFF000000u))`;throw new Error(`not supported combination of storage type ${f.storage} and value type ${f.value} yet`)})(),A=a<2?"":`\n  fn get_${e}ByIndices(indices: ${f.indices}) -> ${h} {\n    return ${O(`i2o_${e}(indices)`)};\n  }`,I=a<2?"":(()=>{let t=s.map((e=>`d${e}: u32`)).join(", "),r=s.map((e=>`d${e}`)).join(", ");return`\n  fn get_${e}(${t}) -> ${h} {\n    return get_${e}ByIndices(${_(r)});\n  }`})(),P=a<2?"":`\n  fn set_${e}ByIndices(indices: ${f.indices}, value: ${h}) {\n    ${E(`i2o_${e}(indices)`,"value")}\n  }`,k=a<2?"":(()=>{let t=s.map((e=>`d${e}: u32`)).join(", "),r=s.map((e=>`d${e}`)).join(", ");return`\n  fn set_${e}(${t}, value: ${h}) {\n    set_${e}ByIndices(${_(r)}, value);\n  }`})();return{impl:()=>{let e=[],t=!1;return p.offsetToIndices&&(e.push(v),t=!0),p.indicesToOffset&&(e.push(x),t=!0),p.broadcastedIndicesToOffset&&(Object.values(T).forEach((t=>e.push(t))),t=!0),p.set&&(e.push(k),t=!0),p.setByIndices&&(e.push(P),t=!0),p.get&&(e.push(I),t=!0),p.getByIndices&&(e.push(A),t=!0),!o&&t&&e.unshift(`const ${m} = ${f.indices}(${r.join(",")});`,`const ${g} = ${f.indices}(${Ur.computeStrides(r).join(",")});`),e.join("\n")},type:f,offsetToIndices:t=>(p.offsetToIndices=!0,a<2?t:`o2i_${e}(${t})`),indicesToOffset:t=>(p.indicesToOffset=!0,a<2?t:`i2o_${e}(${t})`),broadcastedIndicesToOffset:(t,r)=>{p.broadcastedIndicesToOffset=!0;let n=`${r.name}broadcastedIndicesTo${e}Offset`;if(n in T)return`${n}(${t})`;let i=[];for(let e=a-1;e>=0;e--){let t=r.indicesGet("outputIndices",e+r.rank-a);i.push(`${S(g,e)} * (${t} % ${S(m,e)})`)}return T[n]=`fn ${n}(outputIndices: ${r.type.indices}) -> u32 {\n             return ${i.length>0?i.join("+"):"0u"};\n           }`,`${n}(${t})`},indices:_,indicesGet:S,indicesSet:(e,t,r)=>a<2?`${e}=${r};`:`${Qr(e,t,a)}=${r};`,set:(...t)=>{if(t.length!==a+1)throw new Error(`indices length must be ${a}`);let r=t[a];if("string"!=typeof r)throw new Error("value must be string");let n=t.slice(0,a).map(d).join(",");return 0===a?E("0u",r):1===a?E(n[0],r):(p.set=!0,p.setByIndices=!0,p.indicesToOffset=!0,`set_${e}(${n}, ${r})`)},setByOffset:E,setByIndices:(t,r)=>a<2?E(t,r):(p.setByIndices=!0,p.indicesToOffset=!0,`set_${e}ByIndices(${t}, ${r});`),get:(...t)=>{if(t.length!==a)throw new Error(`indices length must be ${a}`);let r=t.map(d).join(",");return 0===a?O("0u"):1===a?O(r[0]):(p.get=!0,p.getByIndices=!0,p.indicesToOffset=!0,`get_${e}(${r})`)},getByOffset:O,getByIndices:t=>a<2?O(t):(p.getByIndices=!0,p.indicesToOffset=!0,`get_${e}ByIndices(${t})`),usage:n,name:e,strides:g,shape:m,rank:a}},tn=(e,t,r,n=1)=>en(e,t,r,"input",n),rn=(e,t,r,n=1)=>en(e,t,r,"output",n),nn=(e,t,r,n=1)=>en(e,t,r,"internal",n),on=class{constructor(e){this.normalizedDispatchGroup=e,this.internalVariables=[],this.variables=[],this.uniforms=[],this.variableIndex=0}guardAgainstOutOfBoundsWorkgroupSizes(e){return`if (global_idx >= ${"number"==typeof e?`${e}u`:e}) { return; }`}mainStart(e=64){let t="number"==typeof e?e:e[0],r="number"==typeof e?1:e[1],n="number"==typeof e?1:e[2],i=1===this.normalizedDispatchGroup[1]&&1===this.normalizedDispatchGroup[2];return`@compute @workgroup_size(${t}, ${r}, ${n})\n  fn main(${i?"@builtin(global_invocation_id) global_id : vec3<u32>,\n    @builtin(workgroup_id) workgroup_id : vec3<u32>,\n    @builtin(local_invocation_id) local_id : vec3<u32>":"@builtin(local_invocation_id) local_id : vec3<u32>,\n    @builtin(local_invocation_index) local_idx : u32,\n    @builtin(workgroup_id) workgroup_id : vec3<u32>,\n    @builtin(num_workgroups) num_workgroups : vec3<u32>"}) {\n    ${i?"let global_idx = global_id.x; let local_idx = local_id.x;":`let global_idx = (workgroup_id.z * num_workgroups[0] * num_workgroups[1] +\n          workgroup_id.y * num_workgroups[0] + workgroup_id.x) * ${t*r*n}u + local_idx;`}\n  `}appendVariableUniforms(e){0!==e.rank&&(e.shape.startsWith("uniforms.")&&this.uniforms.push({name:e.shape.replace("uniforms.",""),type:"u32",length:e.rank}),e.strides.startsWith("uniforms.")&&this.uniforms.push({name:e.strides.replace("uniforms.",""),type:"u32",length:e.rank}))}declareVariable(e,t){if("internal"===e.usage)throw new Error("cannot use internal variable with declareVariable(). use registerInternalVariables() instead.");this.variables.push(e),this.appendVariableUniforms(e);let r="input"===e.usage?"read":"read_write",n=e.type.storage;return`@group(0) @binding(${t}) var<storage, ${r}> ${e.name}: array<${n}>;`}declareVariables(...e){return e.map((e=>this.declareVariable(e,this.variableIndex++))).join("\n")}registerInternalVariable(e){if("internal"!==e.usage)throw new Error("cannot use input or output variable with registerInternalVariable(). use declareVariables() instead.");this.internalVariables.push(e),this.appendVariableUniforms(e)}registerInternalVariables(...e){return e.forEach((e=>this.registerInternalVariable(e))),this}registerUniform(e,t,r=1){return this.uniforms.push({name:e,type:t,length:r}),this}registerUniforms(e){return this.uniforms=this.uniforms.concat(e),this}uniformDeclaration(){if(0===this.uniforms.length)return"";let e=[];for(let{name:t,type:r,length:n}of this.uniforms)if(n&&n>4)e.push(`${t}:array<vec4<${r}>, ${Math.ceil(n/4)}>`);else{let i=null==n||1===n?r:`vec${n}<${r}>`;e.push(`${t}:${i}`)}return`\n      struct Uniforms { ${e.join(", ")} };\n      @group(0) @binding(${this.variableIndex}) var<uniform> uniforms: Uniforms;`}get additionalImplementations(){return this.uniformDeclaration()+this.variables.map((e=>e.impl())).join("\n")+this.internalVariables.map((e=>e.impl())).join("\n")}},an=e=>new on(e),sn=(e,t)=>{let r=e.length,n=[];for(let i=0;i<r;i++){let o=r-1-i,a=e[o]||1;(t[t.length-1-i]||1)>1&&1===a&&n.unshift(o)}return n},un=e=>!0})),rl=st((()=>{el(),Qu(),tl(),ln=e=>{if(!e||1!==e.length)throw new Error("Transpose requires 1 input.")},hn=(e,t)=>t&&t.length!==e?[...new Array(e).keys()].reverse():t,cn=(e,t)=>Ur.sortBasedOnPerm(e,hn(e.length,t)),fn=(e,t,r,n)=>{let i=[];i.push(`fn perm(i: ${n.type.indices}) -> ${r.type.indices} {\n    var a: ${r.type.indices};`);for(let n=0;n<t;++n)i.push(r.indicesSet("a",e[n],`i[${n}]`));return i.push("return a;}"),i.join("\n")},dn=(e,t)=>{let r=e.dataType,n=e.dims.length,i=hn(n,t),o=un(n),a=cn(e.dims,i),s=o?a.length:a,u=o?n:e.dims,l=rn("output",r,s),h=tn("a",r,u);return{name:"Transpose",shaderCache:{hint:`${t}`,inputDependencies:o?["rank"]:["dims"]},getRunData:e=>{let t=Ur.size(a);return{outputs:[{dims:a,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(t/64)},programUniforms:o?[{type:"uint32",data:t},...Yr(e[0].dims),...Yr(a)]:[{type:"uint32",data:t}]}},getShaderSource:e=>`\n  ${e.registerUniform("output_size","u32").declareVariables(h,l)}\n\n  ${fn(i,n,h,l)}\n\n  ${e.mainStart()}\n    ${e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}\n\n    let indices = ${l.offsetToIndices("global_idx")};\n    let aIndices = perm(indices);\n\n    ${l.setByOffset("global_idx",h.getByIndices("aIndices"))}\n  }`}},pn=(e,t)=>{ln(e.inputs),e.compute(dn(e.inputs[0],t.perm))},yn=e=>Br({perm:e.perm})})),nl=st((()=>{el(),tl(),il(),rl(),mn={max:"select(bestValue, candidate, candidate > bestValue)",min:"select(bestValue, candidate, candidate < bestValue)",mean:"bestValue + candidate",sum:"bestValue + candidate",prod:"bestValue * candidate",sumSquare:"bestValue + candidate * candidate",logSumExp:"bestValue + exp(candidate)",l1:"bestValue + abs(candidate)",l2:"bestValue + candidate * candidate",logSum:"bestValue + candidate"},gn={max:"select(bestValue, candidate, candidate > bestValue)",min:"select(bestValue, candidate, candidate < bestValue)",mean:"bestValue + candidate",sum:"bestValue + candidate",prod:"bestValue * candidate",sumSquare:"bestValue + candidate",logSumExp:"bestValue + candidate",l1:"bestValue + candidate",l2:"bestValue + candidate",logSum:"bestValue + candidate"},wn={max:"_A[offset]",min:"_A[offset]",mean:"0",sum:"0",prod:"1",sumSquare:"0",logSumExp:"0",l1:"0",l2:"0",logSum:"0"},vn={max:"bestValue",min:"bestValue",sum:"bestValue",prod:"bestValue",sumSquare:"bestValue",logSumExp:"log(bestValue)",l1:"bestValue",l2:"sqrt(bestValue)",logSum:"log(bestValue)"},bn=(e,t)=>{let r=[];for(let n=t-e;n<t;++n)r.push(n);return r},xn=(e,t)=>{let r=[],n=e.length;for(let i=0;i<n;i++)-1===t.indexOf(i)&&r.push(e[i]);return[r,t.map((t=>e[t]))]},_n=(e,t)=>{let r=e.length+t.length,n=[],i=0;for(let o=0;o<r;o++)-1===t.indexOf(o)?n.push(e[i++]):n.push(1);return n},Sn=(e,t)=>{for(let r=0;r<e.length;++r)if(e[e.length-r-1]!==t-1-r)return!1;return!0},Tn=(e,t)=>{let r=[];if(!Sn(e,t)){for(let n=0;n<t;++n)-1===e.indexOf(n)&&r.push(n);e.forEach((e=>r.push(e)))}return r},En=(e,t,r,n,i,o,a)=>{let s=r[0].dims,u=Ur.size(o),l=Ur.size(a),h=tn("_A",r[0].dataType,s),c=rn("output",i,o),f=`\n          var<workgroup> aBestValues : array<${c.type.storage}, 32>;\n       `;return{name:e,shaderCache:t,getShaderSource:e=>`\n        ${e.registerUniform("reduceSize","u32").declareVariables(h,c)}\n        ${f}\n        fn DIV_CEIL(a : u32, b : u32) -> u32 {\n          return ((a - 1u) / b + 1u);\n         }\n         ${e.mainStart(32)}\n\n          let outputIndex = global_idx / 32;\n          let offset = outputIndex * uniforms.reduceSize;\n\n          var bestValue = ${c.type.storage}(${wn[n]});\n          let Length = uniforms.reduceSize;\n          for (var k = local_idx; k < Length; k = k + 32) {\n           let candidate = ${c.type.storage}(${h.getByOffset("offset + k")});\n           bestValue = ${mn[n]};\n          }\n          aBestValues[local_idx] = bestValue;\n          workgroupBarrier();\n\n         var reduceSize = min(Length, 32u);\n         for (var currentSize = reduceSize / 2u; reduceSize > 1u;\n             currentSize = reduceSize / 2u) {\n           let interval = DIV_CEIL(reduceSize, 2u);\n           if (local_idx < currentSize) {\n            let candidate = aBestValues[local_idx + interval];\n            bestValue = ${gn[n]};\n            aBestValues[local_idx] = bestValue;\n           }\n           reduceSize = interval;\n           workgroupBarrier();\n         }\n\n         if (local_idx == 0u) {\n          ${c.setByOffset("outputIndex",""+("mean"===n?`bestValue / ${c.type.storage}(uniforms.reduceSize)`:`${vn[n]}`))};\n         }\n        }`,getRunData:()=>({outputs:[{dims:o,dataType:i}],dispatchGroup:{x:u},programUniforms:[{type:"uint32",data:l}]})}},On=(e,t,r,n)=>{let i=1===e.inputs.length?r:Un(e.inputs,r),o=i.axes;0===o.length&&!i.noopWithEmptyAxes&&(o=e.inputs[0].dims.map(((e,t)=>t)));let a=Ur.normalizeAxes(o,e.inputs[0].dims.length),s=a,u=e.inputs[0],l=Tn(s,e.inputs[0].dims.length);l.length>0&&(u=e.compute(dn(e.inputs[0],l),{inputs:[0],outputs:[-1]})[0],s=bn(s.length,u.dims.length));let[h,c]=xn(u.dims,s),f=h;i.keepDims&&(f=_n(h,a)),e.compute(En(t,{hint:i.cacheKey,inputDependencies:["type"]},[u],n,e.inputs[0].dataType,f,c),{inputs:[u]})},An=(e,t)=>{On(e,"ReduceMeanShared",t,"mean")},In=(e,t)=>{On(e,"ReduceL1Shared",t,"l1")},Pn=(e,t)=>{On(e,"ReduceL2Shared",t,"l2")},kn=(e,t)=>{On(e,"ReduceLogSumExpShared",t,"logSumExp")},Cn=(e,t)=>{On(e,"ReduceMaxShared",t,"max")},$n=(e,t)=>{On(e,"ReduceMinShared",t,"min")},Rn=(e,t)=>{On(e,"ReduceProdShared",t,"prod")},Dn=(e,t)=>{On(e,"ReduceSumShared",t,"sum")},Mn=(e,t)=>{On(e,"ReduceSumSquareShared",t,"sumSquare")},Ln=(e,t)=>{On(e,"ReduceLogSumShared",t,"logSum")}})),il=st((()=>{el(),Qu(),tl(),nl(),Bn=e=>{if(!e||0===e.length||e.length>2)throw new Error("Reduce op requires 1 or 2 inputs.");if(2===e.length&&1!==e[1].dims.length)throw new Error("Invalid axes input dims.")},Nn=e=>["","",`var value = ${e.getByIndices("input_indices")};`,""],Fn=(e,t,r,n,i,o,a=!1,s=!1)=>{let u=[],l=r[0].dims,h=l.length,c=Ur.normalizeAxes(i,h),f=!s&&0===c.length;l.forEach(((e,t)=>{f||c.indexOf(t)>=0?a&&u.push(1):u.push(e)}));let d=u.length,p=Ur.size(u);return{name:e,shaderCache:t,getShaderSource:e=>{let t=[],i=tn("_A",r[0].dataType,h),s=rn("output",o,d),u=n(i,s,c),p=u[2];for(let e=0,r=0;e<h;e++)f||c.indexOf(e)>=0?(a&&r++,p=`for(var j${e}: u32 = 0; j${e} < ${l[e]}; j${e}++) {\n                  ${u[2].includes("last_index")?`let last_index = j${e};`:""}\n                  ${i.indicesSet("input_indices",e,`j${e}`)}\n                  ${p}\n                }`):(t.push(`${i.indicesSet("input_indices",e,s.indicesGet("output_indices",r))};`),r++);return`\n\n        ${e.registerUniform("output_size","u32").declareVariables(i,s)}\n\n        ${e.mainStart()}\n          ${e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}\n          var input_indices: ${i.type.indices};\n          let output_indices = ${s.offsetToIndices("global_idx")};\n\n          ${t.join("\n")}\n          ${u[0]}       // init ops for reduce max/min\n          ${u[1]}\n          ${p}\n          ${u[3]}\n          ${4===u.length?s.setByOffset("global_idx","value"):u.slice(4).join("\n")}\n        }`},getRunData:()=>({outputs:[{dims:u,dataType:o}],dispatchGroup:{x:Math.ceil(p/64)},programUniforms:[{type:"uint32",data:p},...Yr(l),...Yr(u)]})}},Un=(e,t)=>{let r=[];return e[1].dims[0]>0&&e[1].getBigInt64Array().forEach((e=>r.push(Number(e)))),Br({axes:r,keepDims:t.keepDims,noopWithEmptyAxes:t.noopWithEmptyAxes})},jn=(e,t,r,n)=>{let i=e.inputs,o=1===i.length?r:Un(i,r);e.compute(Fn(t,{hint:o.cacheKey,inputDependencies:["rank"]},[i[0]],o.noopWithEmptyAxes&&0===o.axes.length?Nn:n,o.axes,i[0].dataType,o.keepDims,o.noopWithEmptyAxes),{inputs:[0]})},zn=(e,t)=>{Bn(e.inputs),jn(e,"ReduceLogSum",t,((e,t)=>[`var value = ${t.type.storage}(0);`,"",`value += ${e.getByIndices("input_indices")};`,"value = log(value);"]))},Gn=(e,t)=>{Bn(e.inputs),jn(e,"ReduceL1",t,((e,t)=>[`var value = ${t.type.storage}(0);`,"",`value += abs(${e.getByIndices("input_indices")});`,""]))},Vn=(e,t)=>{Bn(e.inputs),jn(e,"ReduceL2",t,((e,t)=>[`var t = ${t.type.value}(0); var value = ${t.type.value}(0);`,"",`t = ${e.getByIndices("input_indices")}; value += (t * t);`,"value = sqrt(value);"]))},Wn=(e,t)=>{Bn(e.inputs),jn(e,"ReduceLogSumExp",t,((e,t)=>[`var value = ${t.type.storage}(0);`,"",`value += exp(${e.getByIndices("input_indices")});`,"value = log(value);"]))},Hn=(e,t)=>{Bn(e.inputs),jn(e,"ReduceMax",t,((e,t,r)=>{let n=[];for(let t=0;t<e.rank;t++)(r.indexOf(t)>=0||0===r.length)&&n.push(e.indicesSet("input_indices",t,0));return[`${n.join("\n")}`,`var value = ${e.getByIndices("input_indices")};`,`value = max(value, ${e.getByIndices("input_indices")});`,""]}))},qn=(e,t)=>{Bn(e.inputs),jn(e,"ReduceMean",t,((t,r,n)=>{let i=1;for(let r=0;r<t.rank;r++)(n.indexOf(r)>=0||0===n.length)&&(i*=e.inputs[0].dims[r]);return["var sum = f32(0);","",`sum += f32(${t.getByIndices("input_indices")});`,`let value = ${r.type.value}(sum / ${i});`]}))},Yn=(e,t)=>{Bn(e.inputs),jn(e,"ReduceMin",t,((e,t,r)=>{let n=[];for(let t=0;t<e.rank;t++)(r.indexOf(t)>=0||0===r.length)&&n.push(`input_indices[${t}] = 0;`);return[`${n.join("\n")}`,`var value = ${e.getByIndices("input_indices")};`,`value = min(value, ${e.getByIndices("input_indices")});`,""]}))},Xn=(e,t)=>{Bn(e.inputs),jn(e,"ReduceProd",t,((e,t)=>[`var value = ${t.type.storage}(1);`,"",`value *= ${e.getByIndices("input_indices")};`,""]))},Kn=(e,t)=>{Bn(e.inputs),jn(e,"ReduceSum",t,((e,t)=>[`var value = ${t.type.storage}(0);`,"",`value += ${e.getByIndices("input_indices")};`,""]))},Zn=(e,t)=>{Bn(e.inputs),jn(e,"ReduceSumSquare",t,((e,t)=>[`var t = ${t.type.value}(0); var value = ${t.type.value}(0);`,"",`t = ${e.getByIndices("input_indices")}; value += t * t;`,""]))},Jn=(e,t,r)=>{if(0===t.length)return r;let n=1,i=1;for(let r=0;r<t.length;r++)-1===t.indexOf(r)?n*=e[r]:i*=e[r];return i<32&&n>1024},Qn=(e,t)=>{Jn(e.inputs[0].dims,t.axes,t.noopWithEmptyAxes)?qn(e,t):An(e,t)},ei=(e,t)=>{Jn(e.inputs[0].dims,t.axes,t.noopWithEmptyAxes)?Gn(e,t):In(e,t)},ti=(e,t)=>{Jn(e.inputs[0].dims,t.axes,t.noopWithEmptyAxes)?Vn(e,t):Pn(e,t)},ri=(e,t)=>{Jn(e.inputs[0].dims,t.axes,t.noopWithEmptyAxes)?Wn(e,t):kn(e,t)},ni=(e,t)=>{Jn(e.inputs[0].dims,t.axes,t.noopWithEmptyAxes)?Hn(e,t):Cn(e,t)},ii=(e,t)=>{Jn(e.inputs[0].dims,t.axes,t.noopWithEmptyAxes)?Yn(e,t):$n(e,t)},oi=(e,t)=>{Jn(e.inputs[0].dims,t.axes,t.noopWithEmptyAxes)?Xn(e,t):Rn(e,t)},ai=(e,t)=>{Jn(e.inputs[0].dims,t.axes,t.noopWithEmptyAxes)?Kn(e,t):Dn(e,t)},si=(e,t)=>{Jn(e.inputs[0].dims,t.axes,t.noopWithEmptyAxes)?Zn(e,t):Mn(e,t)},ui=(e,t)=>{Jn(e.inputs[0].dims,t.axes,t.noopWithEmptyAxes)?zn(e,t):Ln(e,t)}})),ol=st((()=>{qu(),Qu(),il(),li=e=>{if(!e||0===e.length||e.length>2)throw new Error("ArgMinMaxOp op requires 1 or 2 inputs.");if(1!==e[0].dataType)throw new Error("Invalid input type.")},hi=(e,t)=>{li(e.inputs);e.compute(Fn("ArgMin",{hint:t.cacheKey,inputDependencies:["rank"]},[e.inputs[0]],((e,r,n)=>{let i=[];for(let t=0;t<e.rank;t++)(n.indexOf(t)>=0||0===n.length)&&i.push(`input_indices[${t}] = 0;`);return[`${i.join("\n")}`,`var value = ${e.getByIndices("input_indices")};\nvar best_index : i32 = 0;`,`if (${e.getByIndices("input_indices")} ${t.selectLastIndex>0?"<=":"<"} value) {\n         value = ${e.getByIndices("input_indices")};\n         best_index = i32(last_index);\n       }`,"",r.setByOffset("global_idx","best_index")]}),[t.axis],7,t.keepDims),{inputs:[0]})},ci=(e,t)=>{li(e.inputs);e.compute(Fn("argMax",{hint:t.cacheKey,inputDependencies:["rank"]},[e.inputs[0]],((e,r,n)=>{let i=[];for(let t=0;t<e.rank;t++)(n.indexOf(t)>=0||0===n.length)&&i.push(`input_indices[${t}] = 0;`);return[`${i.join("\n")}`,`var value = ${e.getByIndices("input_indices")};\nvar best_index : i32 = 0;`,`if (${e.getByIndices("input_indices")} ${t.selectLastIndex>0?">=":">"} value) {\n         value = ${e.getByIndices("input_indices")};\n         best_index = i32(last_index);\n       }`,"",r.setByOffset("global_idx","best_index")]}),[t.axis],7,t.keepDims),{inputs:[0]})},fi=e=>Br(e)})),al=st((()=>{qu(),Zu(),tl(),di=(e,t)=>{let r=e[0],n=e[1],i=e[2],o=e[3],a=e[4],s=e[5];if(a&&s)throw new Error("Attention cannot have both past and relative_position_bias");if(3!==r.dims.length)throw new Error('Input "input" must have 3 dimensions');let u=r.dims[0],l=r.dims[1],h=r.dims[2];if(1!==i.dims.length)throw new Error('Input "bias" is expected to have 1 dimensions');if(2!==n.dims.length)throw new Error('Input "weights" is expected to have 2 dimensions');if(n.dims[0]!==h)throw new Error("Input 1 dimension 0 should have same length as dimension 2 of input 0");if(i.dims[0]!==n.dims[1])throw new Error('Input "bias" dimension 0 should have same length as dimension 1 of input "weights"');let c=i.dims[0]/3,f=c,d=f;if(t.qkvHiddenSizes.length>0){if(3!==t.qkvHiddenSizes.length)throw new Error("qkv_hidden_sizes attribute should have 3 elements");for(let e of t.qkvHiddenSizes)if(e%t.numHeads!=0)throw new Error("qkv_hidden_sizes should be divisible by num_heads");c=t.qkvHiddenSizes[0],f=t.qkvHiddenSizes[1],d=t.qkvHiddenSizes[2]}let p=l;if(c!==f)throw new Error("qkv_hidden_sizes first element should be same as the second");if(i.dims[0]!==c+f+d)throw new Error('Input "bias" dimension 0 should have same length as sum of Q/K/V hidden sizes');let y=0;if(a){if(f!==d)throw new Error('Input "past" expect k_hidden_size == v_hidden_size');if(5!==a.dims.length)throw new Error('Input "past" must have 5 dimensions');if(2!==a.dims[0])throw new Error('Input "past" first dimension must be 2');if(a.dims[1]!==u)throw new Error('Input "past" second dimension must be batch_size');if(a.dims[2]!==t.numHeads)throw new Error('Input "past" third dimension must be num_heads');if(a.dims[4]!==f/t.numHeads)throw new Error('Input "past" fifth dimension must be k_hidden_size / num_heads');t.pastPresentShareBuffer||(y=a.dims[3])}let m=p+y;if(o)throw new Error("Mask not supported");if(a)throw new Error("past is not supported");if(s)throw new Error("relativePositionBias is not supported");return{batchSize:u,sequenceLength:l,pastSequenceLength:y,kvSequenceLength:p,totalSequenceLength:m,maxSequenceLength:-1,inputHiddenSize:h,hiddenSize:c,vHiddenSize:d,headSize:Math.floor(c/t.numHeads),vHeadSize:Math.floor(d/t.numHeads),numHeads:t.numHeads,isUnidirectional:!1,pastPresentShareBuffer:!1,maskFilterValue:t.maskFilterValue,maskType:0,scale:t.scale,broadcastResPosBias:!1,passPastInKv:!1,qkvFormat:1}},pi=(e,t,r,n)=>{let i=Xr(n),o=64,a=n/i;a<o?o=1:a/8<64&&(o=Math.ceil(a/8));let s=Math.ceil(n/i/o),u=[{type:dr(t.dataType),data:1/n},{type:"uint32",data:a},{type:"uint32",data:s}],l=Hr(t.dataType,i);e.compute({name:"AttentionProbsSoftmax",shaderCache:{hint:`${o};${l};${i}`},getShaderSource:e=>{let r=rn("x",t.dataType,t.dims,i),n="thread_max_vector";2===i?n="max(thread_max_vector.x, thread_max_vector.y)":4===i&&(n="max(max(thread_max_vector.x, thread_max_vector.y), max(thread_max_vector.z, thread_max_vector.w))");let a=qr(t.dataType),s=[{name:"d_inv",type:a},{name:"d_comp",type:"u32"},{name:"elements_per_wg",type:"u32"}];return`\n  var<workgroup> wgMax: array<f32, ${o}>;\n  var<workgroup> wgSum: array<f32, ${o}>;\n  ${e.registerUniforms(s).declareVariables(r)}\n  ${e.mainStart([o,1,1])}\n    let localOffset = local_idx * uniforms.elements_per_wg;\n    let offset: u32 = workgroup_id.x * uniforms.d_comp + localOffset;\n\n    var thread_max_vector = ${Kr("f32",i,"-3.402823e+38f")};\n    for (var i: u32 = 0; i < uniforms.elements_per_wg && i + localOffset < uniforms.d_comp; i++) {\n      thread_max_vector = max(${Zr(a,i,"x[offset + i]")}, thread_max_vector);\n    }\n    wgMax[local_idx] = ${n};\n    workgroupBarrier();\n\n    var maxValue = -3.402823e+38f;\n    for (var i = 0u; i < ${o}; i++) {\n      maxValue = max(wgMax[i], maxValue);\n    }\n\n    var sumVector = ${Kr("f32",i,"0")};\n    for (var i: u32 = 0; i < uniforms.elements_per_wg && i + localOffset < uniforms.d_comp; i++) {\n      sumVector += exp(${Zr(a,i,"x[offset + i]")} - maxValue);\n    }\n    wgSum[local_idx] = ${Jr("sumVector",i)};\n    workgroupBarrier();\n\n    var sum: f32 = 0;\n    for (var i = 0u; i < ${o}; i++) {\n      sum += wgSum[i];\n    }\n\n    if (sum == 0) {\n      for (var i: u32 = 0; i < uniforms.elements_per_wg && i + localOffset < uniforms.d_comp; i++) {\n        x[offset + i] = ${Kr("f32",i,"uniforms.d_inv")};\n      }\n    } else {\n      for (var i: u32 = 0; i < uniforms.elements_per_wg && i + localOffset < uniforms.d_comp; i++) {\n        let f32input = ${Zr(a,i,"x[offset + i]")};\n        x[offset + i] = ${r.type.value}(exp(f32input - maxValue) / sum);\n      }\n    }\n  }`},getRunData:()=>({outputs:[],dispatchGroup:{x:r},programUniforms:u})},{inputs:[t],outputs:[]})},yi=(e,t,r,n,i,o)=>{let a=[i.batchSize,i.numHeads,i.sequenceLength,i.kvSequenceLength+i.pastSequenceLength],s=0===o.scale?1/Math.sqrt(i.headSize):o.scale,u=Xr(i.headSize),l=i.headSize/u,h=12,c={x:Math.ceil(i.totalSequenceLength/h),y:Math.ceil(i.sequenceLength/h),z:i.batchSize*i.numHeads},f=dr(t.dataType),d=[{type:"uint32",data:i.sequenceLength},{type:"uint32",data:l},{type:"uint32",data:i.totalSequenceLength},{type:"uint32",data:i.kvSequenceLength},{type:f,data:s}],p=[t,r],y=e.compute({name:"AttentionProbs",shaderCache:{hint:`${u}`,inputDependencies:["type","type"]},getRunData:()=>({outputs:[{dims:a,dataType:t.dataType,gpuDataType:0}],dispatchGroup:c,programUniforms:d}),getShaderSource:e=>{let n=tn("q",t.dataType,t.dims,u),i=tn("key",r.dataType,r.dims,u),o=rn("output",t.dataType,a),s=Hr(t.dataType),l=[{name:"M",type:"u32"},{name:"K",type:"u32"},{name:"N",type:"u32"},{name:"kv_sequence_length",type:"u32"},{name:"alpha",type:s}];return`\n  const beta: ${s} = 1.0;\n  const TILE_SIZE = 12u;\n\n  var<workgroup> tileQ: array<${n.type.storage}, 144>;\n  var<workgroup> tileK: array<${n.type.storage}, 144>;\n  ${e.registerUniforms(l).declareVariables(n,i,o)}\n  ${e.mainStart([h,h,1])}\n    // x holds the N and y holds the M\n    let headIdx = workgroup_id.z;\n    let m = workgroup_id.y * TILE_SIZE;\n    let n = workgroup_id.x * TILE_SIZE;\n    let lm = m + local_id.y;\n    let ln = n + local_id.x;\n\n    let qOffset = uniforms.M * uniforms.K * headIdx + m * uniforms.K;\n    let kOffset = uniforms.kv_sequence_length * uniforms.K * headIdx + n * uniforms.K;\n\n    var value = ${Kr(s,u)};\n    for (var w: u32 = 0u; w < uniforms.K; w += TILE_SIZE) {\n      if (m + local_id.y < uniforms.M && w + local_id.x < uniforms.K) {\n        tileQ[TILE_SIZE * local_id.y + local_id.x] = q[qOffset + local_id.y * uniforms.K + w + local_id.x];\n      }\n      if (n + local_id.y < uniforms.N && w + local_id.x < uniforms.K) {\n        tileK[TILE_SIZE * local_id.y + local_id.x] = key[kOffset + local_id.y * uniforms.K + w + local_id.x];\n      }\n      workgroupBarrier();\n\n      for (var k: u32 = 0u; k<TILE_SIZE && w+k < uniforms.K; k++) {\n        value += tileQ[TILE_SIZE * local_id.y + k] * tileK[TILE_SIZE * local_id.x + k];\n      }\n\n      workgroupBarrier();\n    }\n\n    let headOffset = headIdx * uniforms.M * uniforms.N;\n    if (lm < uniforms.M && ln < uniforms.N) {\n      let outputIdx = headOffset + lm * uniforms.N + ln;\n      output[outputIdx] = ${Jr("value",u)} * uniforms.alpha;\n    }\n  }`}},{inputs:p,outputs:[-1]})[0];return pi(e,y,i.batchSize*i.numHeads*i.sequenceLength,i.totalSequenceLength),y},mi=(e,t,r,n)=>{let i=[n.batchSize,n.sequenceLength,n.vHiddenSize],o=12,a={x:Math.ceil(n.vHeadSize/o),y:Math.ceil(n.sequenceLength/o),z:n.batchSize*n.numHeads},s=[{type:"uint32",data:n.sequenceLength},{type:"uint32",data:n.totalSequenceLength},{type:"uint32",data:n.vHeadSize},{type:"uint32",data:n.numHeads},{type:"uint32",data:n.vHiddenSize}];return e.compute({name:"AttentionScore",shaderCache:{inputDependencies:["type","type"]},getRunData:()=>({outputs:[{dims:i,dataType:t.dataType,gpuDataType:0}],dispatchGroup:a,programUniforms:s}),getShaderSource:e=>{let n=tn("probs",t.dataType,t.dims),a=tn("v",r.dataType,r.dims),s=rn("output",t.dataType,i);return`\n  const TILE_SIZE = 12u;\n  var<workgroup> tileQ: array<${n.type.value}, 144>;\n  var<workgroup> tileK: array<${n.type.value}, 144>;\n  ${e.registerUniforms([{name:"M",type:"u32"},{name:"K",type:"u32"},{name:"N",type:"u32"},{name:"num_heads",type:"u32"},{name:"v_hidden_size",type:"u32"}]).declareVariables(n,a,s)}\n  ${e.mainStart([o,o,1])}\n   let headIdx = workgroup_id.z;\n   let m = workgroup_id.y * TILE_SIZE + local_id.y;\n   let n = workgroup_id.x * TILE_SIZE + local_id.x;\n\n   let offsetA = headIdx * (uniforms.M * uniforms.K) + m * uniforms.K;\n   let offsetB = headIdx * (uniforms.N * uniforms.K) + n;\n\n   var value = ${n.type.storage}(0);\n   for (var w: u32 = 0u; w < uniforms.K; w += TILE_SIZE) {\n     if (m < uniforms.M && w + local_id.x < uniforms.K) {\n       tileQ[TILE_SIZE * local_id.y + local_id.x] = probs[offsetA + w + local_id.x];\n     }\n     if (n < uniforms.N && w + local_id.y < uniforms.K) {\n       tileK[TILE_SIZE * local_id.y + local_id.x] = v[offsetB + (w + local_id.y) * uniforms.N];\n     }\n     workgroupBarrier();\n     for (var k: u32 = 0u; k<TILE_SIZE && w+k < uniforms.K; k++) {\n       value += tileQ[TILE_SIZE * local_id.y + k] * tileK[TILE_SIZE * k + local_id.x];\n     }\n     workgroupBarrier();\n   }\n\n   // we need to transpose output from BNSH_v to BSND_v\n   let batchIdx = workgroup_id.z / uniforms.num_heads;\n   let currentBatchHeadNumber = workgroup_id.z % uniforms.num_heads;\n   let headOffset = (batchIdx * uniforms.M * uniforms.num_heads + currentBatchHeadNumber) * uniforms.N;\n   if (m < uniforms.M && n < uniforms.N) {\n     let outputIdx = batchIdx * uniforms.M *uniforms.v_hidden_size + m * uniforms.v_hidden_size\n       + currentBatchHeadNumber * uniforms.N + n;\n     output[outputIdx] = value;\n   }\n  }`}},{inputs:[t,r],outputs:[0]})[0]},gi=(e,t,r,n,i,o,a,s,u,l,h)=>{let c=yi(e,t,r,0,l,h);mi(e,c,n,l)},wi=(e,t)=>{let r=[t.batchSize,t.numHeads,t.sequenceLength,t.headSize],n=t.sequenceLength,i=t.inputHiddenSize,o=t.headSize,a=12,s={x:Math.ceil(t.headSize/a),y:Math.ceil(t.sequenceLength/a),z:t.batchSize*t.numHeads},u=[e.inputs[0],e.inputs[1],e.inputs[2]],l=[{type:"uint32",data:n},{type:"uint32",data:i},{type:"uint32",data:o},{type:"uint32",data:t.numHeads},{type:"uint32",data:t.headSize},{type:"uint32",data:t.hiddenSize},{type:"uint32",data:t.hiddenSize+t.hiddenSize+t.vHiddenSize}];return e.compute({name:"AttentionPrepare",shaderCache:{inputDependencies:["type","type","type"]},getRunData:()=>({outputs:[{dims:r,dataType:e.inputs[0].dataType,gpuDataType:0},{dims:r,dataType:e.inputs[0].dataType,gpuDataType:0},{dims:r,dataType:e.inputs[0].dataType,gpuDataType:0}],dispatchGroup:s,programUniforms:l}),getShaderSource:e=>{let t=rn("output_q",u[0].dataType,r),n=rn("output_k",u[0].dataType,r),i=rn("output_v",u[0].dataType,r),o=tn("input",u[0].dataType,u[0].dims),s=tn("weight",u[1].dataType,u[1].dims),l=tn("bias",u[2].dataType,u[2].dims),h=o.type.storage;return`\n  const TILE_SIZE = 12u;\n  var<workgroup> tileInput: array<${h}, 144>;\n  var<workgroup> tileWeightQ: array<${h}, 144>;\n  var<workgroup> tileWeightK: array<${h}, 144>;\n  var<workgroup> tileWeightV: array<${h}, 144>;\n  ${e.registerUniforms([{name:"M",type:"u32"},{name:"K",type:"u32"},{name:"N",type:"u32"},{name:"num_heads",type:"u32"},{name:"head_size",type:"u32"},{name:"hidden_size",type:"u32"},{name:"ldb",type:"u32"}]).declareVariables(o,s,l,t,n,i)}\n  ${e.mainStart([a,a,1])}\n    let batchIndex = workgroup_id.z / uniforms.num_heads;\n    let headNumber = workgroup_id.z % uniforms.num_heads;\n    let m = workgroup_id.y * TILE_SIZE + local_id.y;\n    let n = workgroup_id.x * TILE_SIZE + local_id.x;\n\n    let inputOffset = batchIndex * (uniforms.M * uniforms.K) + m * uniforms.K;\n    let biasOffsetQ = headNumber * uniforms.head_size;\n    let biasOffsetK = uniforms.hidden_size + biasOffsetQ;\n    let biasOffsetV = uniforms.hidden_size + biasOffsetK;\n\n    var valueQ = ${h}(0);\n    var valueK = ${h}(0);\n    var valueV = ${h}(0);\n    for (var w: u32 = 0u; w < uniforms.K; w += TILE_SIZE) {\n      if (m < uniforms.M && w + local_id.x < uniforms.K) {\n        tileInput[TILE_SIZE * local_id.y + local_id.x] = input[inputOffset + w + local_id.x];\n      }\n      if (n < uniforms.N && w + local_id.y < uniforms.K) {\n        let offset = n + (w + local_id.y) * uniforms.ldb;\n        tileWeightQ[TILE_SIZE * local_id.y + local_id.x] = weight[biasOffsetQ + offset];\n        tileWeightK[TILE_SIZE * local_id.y + local_id.x] = weight[biasOffsetK + offset];\n        tileWeightV[TILE_SIZE * local_id.y + local_id.x] = weight[biasOffsetV + offset];\n      }\n      workgroupBarrier();\n      for (var k: u32 = 0u; k<TILE_SIZE && w+k < uniforms.K; k++) {\n        let inputTileOffset = TILE_SIZE * local_id.y + k;\n        let weightTileOffset = TILE_SIZE * k + local_id.x;\n        valueQ += tileInput[inputTileOffset] * tileWeightQ[weightTileOffset];\n        valueK += tileInput[inputTileOffset] * tileWeightK[weightTileOffset];\n        valueV += tileInput[inputTileOffset] * tileWeightV[weightTileOffset];\n      }\n\n      workgroupBarrier();\n    }\n\n    let headOffset = (m * uniforms.N + n) % uniforms.head_size;\n    valueQ += bias[headOffset + biasOffsetQ];\n    valueK += bias[headOffset + biasOffsetK];\n    valueV += bias[headOffset + biasOffsetV];\n\n    let offset = workgroup_id.z * uniforms.M * uniforms.N;\n    if (m < uniforms.M && n < uniforms.N) {\n      let outputIdx = offset + m * uniforms.N + n;\n      output_q[outputIdx] = valueQ;\n      output_k[outputIdx] = valueK;\n      output_v[outputIdx] = valueV;\n    }\n  }`}},{inputs:u,outputs:[-1,-1,-1]})},vi=(e,t)=>{let r=di(e.inputs,t),[n,i,o]=wi(e,r);return gi(e,n,i,o,e.inputs[4],void 0,void 0,void 0,e.inputs[5],r,t)}})),sl=st((()=>{Pt(),el(),Qu(),tl(),bi=(e,t)=>{if(!e||5!==e.length)throw new Error("BatchNormalization requires 5 inputs");let r=(e,t,r)=>{let n=t.length;if(n!==e.length)throw new Error(`${r}: num dimensions != ${n}`);t.forEach(((t,n)=>{if(t!==e[n])throw new Error(`${r}: dim[${n}] do not match`)}))};if(e[0].dims.length>1){let n="NHWC"===t.format?t.spatial?e[0].dims.slice(-1):e[0].dims.slice(-1).concat(e[0].dims.slice(1,e[0].dims.length-1)):e[0].dims.slice(1,t.spatial?2:void 0);r(e[1].dims,n,"Invalid input scale"),r(e[2].dims,n,"Invalid input B"),r(e[3].dims,n,"Invalid input mean"),r(e[4].dims,n,"Invalid input var")}else r(e[1].dims,[1],"Invalid input scale"),r(e[2].dims,[1],"Invalid input B"),r(e[3].dims,[1],"Invalid input mean"),r(e[4].dims,[1],"Invalid input var")},xi=(e,t)=>{let{epsilon:r,spatial:n,format:i}=t,o=e[0].dims,a=n?Xr(o[o.length-1]):1,s="NHWC"===i&&o.length>1?a:1,u=Ur.size(o)/a,l=un(o.length)&&n,h=l?o.length:o,c=tn("x",e[0].dataType,e[0].dims,a),f=tn("scale",e[1].dataType,e[1].dims,s),d=tn("bias",e[2].dataType,e[2].dims,s),p=tn("inputMean",e[3].dataType,e[3].dims,s),y=tn("inputVar",e[4].dataType,e[4].dims,s),m=rn("y",e[0].dataType,h,a);return{name:"BatchNormalization",shaderCache:{hint:`${t.epsilon}_${t.format}_${n}_${a}`,inputDependencies:l?["rank","type","type","type","type"]:void 0},getShaderSource:e=>`\n  const epsilon = ${r};\n  ${e.registerUniform("outputSize","u32").declareVariables(c,f,d,p,y,m)}\n  ${e.mainStart()}\n  ${e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}\n    var outputIndices = ${m.offsetToIndices(`global_idx * ${a}`)};\n    ${(()=>{let e="";if(n)e=`let cOffset = ${1===o.length?"0u":"NHWC"===i?`outputIndices[${o.length-1}] / ${a}`:"outputIndices[1]"};`;else if("NCHW"===i)e=`\n            ${m.indicesSet("outputIndices","0","0")}\n            let cOffset = ${m.indicesToOffset("outputIndices")};`;else{e=`var cIndices = ${f.type.indices}(0);\n                       cIndices[0] = outputIndices[${o.length-1}];`;for(let t=1;t<f.rank;t++)e+=`cIndices[${t}] = outputIndices[${t}];`;e+=`let cOffset = ${f.indicesToOffset("cIndices")};`}return e})()}\n    let scale = ${f.getByOffset("cOffset")};\n    let bias = ${d.getByOffset("cOffset")};\n    let inputMean = ${p.getByOffset("cOffset")};\n    let inputVar = ${y.getByOffset("cOffset")};\n    let x = ${c.getByOffset("global_idx")};\n    let value = (x - inputMean) * inverseSqrt(inputVar + epsilon) * scale + bias;\n    ${m.setByOffset("global_idx","value")}\n  }`,getRunData:()=>({outputs:[{dims:e[0].dims,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(u/64)},programUniforms:l?[{type:"uint32",data:u},...Yr(o)]:[{type:"uint32",data:u}]})}},_i=e=>Br(e),Si=(e,t)=>{let{inputs:r,outputCount:n}=e,i=_i({...t,outputCount:n});if(Pe.webgpu.validateInputContent&&bi(r,i),t.trainingMode)throw new Error("BatchNormalization trainingMode is not supported yet.");e.compute(xi(r,i))}})),ul=st((()=>{el(),tl(),Ti=e=>{if(3!==e[0].dims.length)throw new Error("input should have 3 dimensions");if(![320,640,1280].includes(e[0].dims[2]))throw new Error("number of channels should be 320, 640 or 1280");if(1!==e[1].dims.length)throw new Error("bias is expected to have 1 dimensions");if(e[0].dims[2]!==e[1].dims[0])throw new Error("last dimension of input and bias are not the same")},Ei=e=>{let t=e[0].dims,r=e[0].dims[2],n=Ur.size(t)/4,i=e[0].dataType,o=tn("input",i,t,4),a=tn("bias",i,[r],4),s=tn("residual",i,t,4),u=rn("output",i,t,4);return{name:"BiasAdd",getRunData:()=>({outputs:[{dims:t,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(n/64)}}),getShaderSource:e=>`\n  const channels = ${r}u / 4;\n  ${e.declareVariables(o,a,s,u)}\n\n  ${e.mainStart()}\n    ${e.guardAgainstOutOfBoundsWorkgroupSizes(n)}\n    let value = ${o.getByOffset("global_idx")}\n      + ${a.getByOffset("global_idx % channels")} + ${s.getByOffset("global_idx")};\n    ${u.setByOffset("global_idx","value")}\n  }`}},Oi=e=>{Ti(e.inputs),e.compute(Ei(e.inputs))}})),ll=st((()=>{qu(),el(),Qu(),tl(),Ai=(e,t,r,n,i,o)=>{let a=Math.ceil(t/4),s="";s="string"==typeof i?`${i}(a)`:i("a");let u=tn("inputData",r,[a],4),l=rn("outputData",n,[a],4);return`\n      ${e.registerUniform("vec_size","u32").declareVariables(u,l)}\n\n  ${o??""}\n\n  ${e.mainStart()}\n    ${e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.vec_size")}\n\n    let a = ${u.getByOffset("global_idx")};\n    ${l.setByOffset("global_idx",s)}\n  }`},Ii=(e,t,r,n,i,o=e.dataType)=>({name:t,shaderCache:{hint:i,inputDependencies:["type"]},getShaderSource:t=>Ai(t,Ur.size(e.dims),e.dataType,o,r,n),getRunData:t=>({outputs:[{dims:e.dims,dataType:o}],dispatchGroup:{x:Math.ceil(Ur.size(t[0].dims)/64/4)},programUniforms:[{type:"uint32",data:Math.ceil(Ur.size(e.dims)/4)}]})}),Pi=e=>{e.compute(Ii(e.inputs[0],"Abs","abs"))},ki=e=>{e.compute(Ii(e.inputs[0],"Acos","acos"))},Ci=e=>{e.compute(Ii(e.inputs[0],"Acosh","acosh"))},$i=e=>{e.compute(Ii(e.inputs[0],"Asin","asin"))},Ri=e=>{e.compute(Ii(e.inputs[0],"Asinh","asinh"))},Di=e=>{e.compute(Ii(e.inputs[0],"Atan","atan"))},Mi=e=>{e.compute(Ii(e.inputs[0],"Atanh","atanh"))},Li=e=>Br(e),Bi=(e,t)=>{let r;switch(t.to){case 10:r="vec4<f16>";break;case 1:r="vec4<f32>";break;case 12:r="vec4<u32>";break;case 6:r="vec4<i32>";break;case 9:r="vec4<bool>";break;default:throw new RangeError(`not supported type (specified in attribute 'to' from 'Cast' operator): ${t.to}`)}e.compute(Ii(e.inputs[0],"Cast",r,void 0,t.cacheKey,t.to))},Ni=e=>{let t=e.length>=2&&0!==e[1].data?e[1].getFloat32Array()[0]:Gr,r=e.length>=3&&0!==e[2].data?e[2].getFloat32Array()[0]:Vr;return Br({min:t,max:r})},Fi=(e,t)=>{let r=1===e.inputs.length?t:Ni(e.inputs),n=qr(e.inputs[0].dataType);e.compute(Ii(e.inputs[0],"Clip",(e=>`clamp(${e}, clip_min_, clip_max_)`),`\n    const clip_min_: vec4<${n}> = vec4(${n}(${r.min}));\n    const clip_max_: vec4<${n}> = vec4(${n}(${r.max}));\n`,r.cacheKey),{inputs:[0]})},Ui=e=>{e.compute(Ii(e.inputs[0],"Ceil","ceil"))},ji=e=>{e.compute(Ii(e.inputs[0],"Cos","cos"))},zi=e=>{e.compute(Ii(e.inputs[0],"Cosh","cosh"))},Gi=e=>Br(e),Vi=(e,t)=>{let r=qr(e.inputs[0].dataType);e.compute(Ii(e.inputs[0],"Elu",(e=>`elu_vf32(${e})`),`\n  const elu_alpha_ = ${r}(${t.alpha});\n\n  fn elu_f32(a: ${r}) -> ${r} {\n  return select((exp(a) - 1.0) * elu_alpha_, a, a >= 0.0);\n  }\n\n  fn elu_vf32(v: vec4<${r}>) -> vec4<${r}> {\n  return vec4(elu_f32(v.x), elu_f32(v.y), elu_f32(v.z), elu_f32(v.w));\n  }`,t.cacheKey))},Wi=(e,t="f32")=>`\nconst r0: ${t} = 0.3275911;\nconst r1: ${t} = 0.254829592;\nconst r2: ${t} = -0.284496736;\nconst r3: ${t} = 1.421413741;\nconst r4: ${t} = -1.453152027;\nconst r5: ${t} = 1.061405429;\n\nfn erf_vf32(v: ${e}) -> ${e} {\n  let absv = abs(v);\n  let x = 1.0 / (1.0 + r0 * absv);\n  return sign(v) * (1.0 - ((((r5 * x + r4) * x + r3) * x + r2) * x + r1) * x * exp(-absv * absv));\n}`,Hi=e=>{let t=qr(e.inputs[0].dataType);e.compute(Ii(e.inputs[0],"Erf",(e=>`erf_vf32(${e})`),Wi(`vec4<${t}>`,t)))},qi=e=>{e.compute(Ii(e.inputs[0],"Exp","exp"))},Yi=e=>{e.compute(Ii(e.inputs[0],"Floor","floor"))},Xi=e=>{let t=qr(e.inputs[0].dataType);e.compute(Ii(e.inputs[0],"Gelu",(e=>`0.5 * ${e} * (1.0 + erf_vf32(${e} * 0.7071067811865475))`),Wi(`vec4<${t}>`,t)))},Ki=(e,t)=>{let r=qr(e.inputs[0].dataType);e.compute(Ii(e.inputs[0],"LeakyRelu",(e=>`select(leaky_relu_alpha_ * ${e}, ${e}, ${e} >= vec4<${r}>(0.0))`),`const leaky_relu_alpha_ = ${r}(${t.alpha});`,t.cacheKey))},Zi=e=>{e.compute(Ii(e.inputs[0],"Not",(e=>`!${e}`)))},Ji=e=>{e.compute(Ii(e.inputs[0],"Neg",(e=>`-${e}`)))},Qi=e=>{e.compute(Ii(e.inputs[0],"Reciprocal",(e=>`1.0/${e}`)))},eo=e=>{let t=qr(e.inputs[0].dataType);e.compute(Ii(e.inputs[0],"Relu",(e=>`select(vec4<${t}>(0.0), ${e}, ${e} > vec4<${t}>(0.0))`)))},to=e=>{e.compute(Ii(e.inputs[0],"Sigmoid",(e=>`(1.0 / (1.0 + exp(-${e})))`)))},ro=e=>{e.compute(Ii(e.inputs[0],"Sin","sin"))},no=e=>{e.compute(Ii(e.inputs[0],"Sinh","sinh"))},io=e=>{e.compute(Ii(e.inputs[0],"Sqrt","sqrt"))},oo=e=>{e.compute(Ii(e.inputs[0],"Tan","tan"))},ao=e=>{e.compute(Ii(e.inputs[0],"Tanh","tanh"))},so=(e,t)=>{let r=qr(e.inputs[0].dataType);return e.compute(Ii(e.inputs[0],"ThresholdedRelu",(e=>`select(vec4<${r}>(0.0), ${e}, ${e} > thresholded_relu_alpha_)`),`const thresholded_relu_alpha_ = vec4<${r}>(${t.alpha});`,t.cacheKey)),0},uo=e=>{e.compute(Ii(e.inputs[0],"Log","log"))}})),hl=st((()=>{el(),tl(),ll(),lo=e=>{if(3!==e[0].dims.length)throw new Error("input should have 3 dimensions");if(![2560,5120,10240].includes(e[0].dims[2]))throw new Error("hidden state should be 2560, 5120 or 10240");if(1!==e[1].dims.length)throw new Error("bias is expected to have 1 dimensions");if(e[0].dims[2]!==e[1].dims[0])throw new Error("last dimension of input and bias are not the same")},ho=e=>{let t=e[0].dims.slice();t[2]=t[2]/2;let r=tn("input",e[0].dataType,e[0].dims,4),n=tn("bias",e[0].dataType,[e[0].dims[2]],4),i=rn("output",e[0].dataType,t,4),o=Ur.size(t)/4,a=Hr(e[0].dataType);return{name:"BiasSplitGelu",getRunData:()=>({outputs:[{dims:t,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(o/64)}}),getShaderSource:t=>`\n  const M_SQRT2 = sqrt(2.0);\n  const halfChannels = ${e[0].dims[2]/4/2}u;\n\n  ${t.declareVariables(r,n,i)}\n\n  ${Wi(`vec4<${a}>`,a)}\n\n  ${t.mainStart()}\n    ${t.guardAgainstOutOfBoundsWorkgroupSizes(o)}\n    let biasIdx = global_idx % halfChannels;\n    let batchIndex = global_idx / halfChannels;\n    let inputOffset = biasIdx + batchIndex * halfChannels * 2;\n    let valueLeft = input[inputOffset] + bias[biasIdx];\n    let valueRight = input[inputOffset + halfChannels] + bias[biasIdx + halfChannels];\n    let geluRight = valueRight * 0.5 * (erf_vf32(valueRight / M_SQRT2) + 1);\n\n    ${i.setByOffset("global_idx","valueLeft * geluRight")}\n  }`}},co=e=>{lo(e.inputs),e.compute(ho(e.inputs))}})),cl=st((()=>{qu(),el(),tl(),fo=(e,t,r,n,i,o,a,s,u,l,h,c,f)=>{let d,p;"string"==typeof s?d=p=(e,t)=>`${s}((${e}),(${t}))`:"function"==typeof s?d=p=s:(d=s.scalar,p=s.vector);let y,m=c?t.length:t,g=c?r.length:r,w=c?n.length:n,v=rn("outputData",h,w,4),b=tn("aData",u,m,4),x=tn("bData",l,g,4);if(i)if(o){let e=1===Ur.size(t),n=1===Ur.size(r),i=t.length>0&&t[t.length-1]%4==0,o=r.length>0&&r[r.length-1]%4==0;y=e||n?v.setByOffset("global_idx",p(e?`${b.type.value}(${b.getByOffset("0")}.x)`:b.getByOffset("global_idx"),n?`${x.type.value}(${x.getByOffset("0")}.x)`:x.getByOffset("global_idx"))):`\n            let outputIndices = ${v.offsetToIndices("global_idx * 4u")};\n            let offsetA = ${b.broadcastedIndicesToOffset("outputIndices",v)};\n            let offsetB = ${x.broadcastedIndicesToOffset("outputIndices",v)};\n            ${v.setByOffset("global_idx",p(a||i?b.getByOffset("offsetA / 4u"):`${b.type.value}(${b.getByOffset("offsetA / 4u")}[offsetA % 4u])`,a||o?x.getByOffset("offsetB / 4u"):`${x.type.value}(${x.getByOffset("offsetB / 4u")}[offsetB % 4u])`))}\n          `}else y=v.setByOffset("global_idx",p(b.getByOffset("global_idx"),x.getByOffset("global_idx")));else{if(!o)throw new Error("no necessary to use scalar implementation for element-wise binary op implementation.");let e=(e,t,r="")=>{let n=`aData[indexA${t}][componentA${t}]`,i=`bData[indexB${t}][componentB${t}]`;return`\n            let outputIndices${t} = ${v.offsetToIndices(`global_idx * 4u + ${t}u`)};\n            let offsetA${t} = ${b.broadcastedIndicesToOffset(`outputIndices${t}`,v)};\n            let offsetB${t} = ${x.broadcastedIndicesToOffset(`outputIndices${t}`,v)};\n            let indexA${t} = offsetA${t} / 4u;\n            let indexB${t} = offsetB${t} / 4u;\n            let componentA${t} = offsetA${t} % 4u;\n            let componentB${t} = offsetB${t} % 4u;\n            ${e}[${t}] = ${r}(${d(n,i)});\n          `};y=9===h?`\n            var data = vec4<u32>(0);\n            ${e("data",0,"u32")}\n            ${e("data",1,"u32")}\n            ${e("data",2,"u32")}\n            ${e("data",3,"u32")}\n            outputData[global_idx] = dot(vec4<u32>(0x1, 0x100, 0x10000, 0x1000000), vec4<u32>(data));`:`\n            ${e("outputData[global_idx]",0)}\n            ${e("outputData[global_idx]",1)}\n            ${e("outputData[global_idx]",2)}\n            ${e("outputData[global_idx]",3)}\n          `}return`\n        ${e.registerUniform("vec_size","u32").declareVariables(b,x,v)}\n\n        ${f??""}\n\n        ${e.mainStart()}\n        ${e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.vec_size")}\n        ${y}\n      }`},po=(e,t,r,n,i,o,a=r.dataType)=>{let s=!Ur.areEqual(r.dims,n.dims),u=r.dims,l=Ur.size(r.dims),h=!1,c=!1,f=[s];if(s){let e=Fr.calcShape(r.dims,n.dims,!1);if(!e)throw new Error("Can't perform binary op on the given tensors");u=e,l=Ur.size(u);let t=1===Ur.size(r.dims),i=1===Ur.size(n.dims),o=r.dims.length>0&&r.dims[r.dims.length-1]%4==0,a=n.dims.length>0&&n.dims[n.dims.length-1]%4==0;f.push(t),f.push(i),f.push(o),f.push(a);let s=1;for(let e=1;e<u.length;e++){let t=r.dims[r.dims.length-e]??1;if(t!==(n.dims[n.dims.length-e]??1))break;s*=t}s%4==0?(c=!0,h=!0):(t||i||o||a)&&(h=!0)}else h=!0;f.push(h);let d=un(r.dims.length)&&un(n.dims.length)&&un(u.length);return{name:e,shaderCache:{hint:t+f.map((e=>e.toString())).join("_"),inputDependencies:d?["rank","rank"]:["dims","dims"]},getShaderSource:e=>fo(e,r.dims,n.dims,u,h,s,c,i,r.dataType,n.dataType,a,d,o),getRunData:()=>({outputs:[{dims:u,dataType:a}],dispatchGroup:{x:Math.ceil(l/64/4)},programUniforms:d?[{type:"uint32",data:Math.ceil(Ur.size(u)/4)},...Yr(r.dims),...Yr(n.dims),...Yr(u)]:[{type:"uint32",data:Math.ceil(Ur.size(u)/4)}]})}},yo=(e,t,r,n,i,o)=>{e.compute(po(t,i??"",e.inputs[0],e.inputs[1],r,n,o))},mo=e=>{yo(e,"Add",((e,t)=>`${e}+${t}`))},go=e=>{yo(e,"Div",((e,t)=>`${e}/${t}`))},wo=e=>{yo(e,"Equal",{scalar:(e,t)=>`u32(${e}==${t})`,vector:(e,t)=>`vec4<u32>(${e}==${t})`},void 0,void 0,9)},vo=e=>{yo(e,"Mul",((e,t)=>`${e}*${t}`))},bo=e=>{let t=tn("input",e.inputs[0].dataType,e.inputs[0].dims).type.value;yo(e,"Pow",{scalar:(e,t)=>`pow_custom(${e},${t})`,vector:(e,t)=>`pow_vector_custom(${e},${t})`},`\n    fn pow_custom(a : ${t}, b : ${t}) -> ${t} {\n      if (b == ${t}(0.0)) {\n        return ${t}(1.0);\n      } else if (a < ${t}(0.0) && f32(b) != floor(f32(b))) {\n        return ${t}(pow(f32(a), f32(b))); // NaN\n      }\n      return select(sign(a), ${t}(1.0), round(f32(abs(b) % ${t}(2.0))) != 1.0) * ${t}(${"i32"===t?"round":""}(pow(f32(abs(a)), f32(b))));\n    }\n    fn pow_vector_custom(a : vec4<${t}>, b : vec4<${t}>) -> vec4<${t}> {\n      // TODO: implement vectorized pow\n      return vec4<${t}>(pow_custom(a.x, b.x), pow_custom(a.y, b.y), pow_custom(a.z, b.z), pow_custom(a.w, b.w));\n    }\n      `)},xo=e=>{yo(e,"Sub",((e,t)=>`${e}-${t}`))},_o=e=>{yo(e,"Greater",{scalar:(e,t)=>`u32(${e}>${t})`,vector:(e,t)=>`vec4<u32>(${e}>${t})`},void 0,void 0,9)},So=e=>{yo(e,"Less",{scalar:(e,t)=>`u32(${e}<${t})`,vector:(e,t)=>`vec4<u32>(${e}<${t})`},void 0,void 0,9)},To=e=>{yo(e,"GreaterOrEqual",{scalar:(e,t)=>`u32(${e}>=${t})`,vector:(e,t)=>`vec4<u32>(${e}>=${t})`},void 0,void 0,9)},Eo=e=>{yo(e,"LessOrEqual",{scalar:(e,t)=>`u32(${e}<=${t})`,vector:(e,t)=>`vec4<u32>(${e}<=${t})`},void 0,void 0,9)}})),fl=st((()=>{el(),Qu(),tl(),Oo=e=>{if(!e||e.length<1)throw new Error("too few inputs");let t=e[0].dataType,r=e[0].dims.length;for(let n of e){if(n.dataType!==t)throw new Error("input tensors should be one type");if(n.dims.length!==r)throw new Error("input tensors should have the same shape")}},Ao=(e,t)=>`\n  fn calculateInputIndex(index: u32) -> u32 {\n    let sizeInConcatAxis = array<u32, ${e}u>(${t});\n    for (var i: u32 = 0u; i < ${e}; i += 1u ) {\n      if (index < sizeInConcatAxis[i]) {\n        return i;\n      }\n    }\n    return ${e}u;\n  }`,Io=(e,t)=>{let r=e.length,n=[];for(let i=0;i<r;++i){let o=t.setByOffset("global_idx",e[i].getByIndices("indices"));1===r?n.push(o):0===i?n.push(`if (inputIndex == ${i}u) { ${o} }`):i===r-1?n.push(`else { ${o} }`):n.push(`else if (inputIndex == ${i}) { ${o} }`)}return n.join("\n")},Po=(e,t)=>{let r=e[0].dims.slice();if(t>=r.length||t<-1*r.length)throw new Error("axis specified for concat doesn't match input dimensionality");let n=t<0?r.length+t:t,i=r.slice(0);for(let t=1;t<e.length;t++){let o=e[t].dims.slice();for(let e=0;e<r.length;e++)if(e===n)i[n]+=o[e];else if(r[e]!==o[e])throw new Error("non concat dimensions must match")}let o=Ur.size(i),a=new Array(e.length),s=new Array(e.length),u=e[0].dataType,l=0,h=[],c=[],f=[],d=[{type:"uint32",data:o}];for(let t=0;t<e.length;++t)l+=e[t].dims[n],a[t]=l,f.push(un(e[t].dims.length)),c.push(f[t]?e[t].dims.length:e[t].dims),s[t]=tn(`input${t}`,u,c[t]),h.push(f[t]?"rank":"dims"),d.push({type:"uint32",data:a[t]});for(let t=0;t<e.length;++t)f[t]&&d.push(...Yr(e[t].dims));let p=un(i.length);p&&d.push(...Yr(i));let y=p?i.length:i,m=rn("output",u,y),g=m.indicesGet("indices",n),w=Array.from(Array(a.length).keys()).map((e=>`uniforms.sizeInConcatAxis${e}`)).join(",");return{name:"Concat",shaderCache:{hint:`${t}`,inputDependencies:h},getRunData:()=>({outputs:[{dims:i,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(o/64)},programUniforms:d}),getShaderSource:t=>`\n\n  ${(()=>{t.registerUniform("outputSize","u32");for(let r=0;r<e.length;r++)t.registerUniform(`sizeInConcatAxis${r}`,"u32");return t.declareVariables(...s,m)})()}\n\n  ${Ao(a.length,w)}\n\n  ${t.mainStart()}\n    ${t.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}\n\n    var indices = ${m.offsetToIndices("global_idx")};\n\n    let inputIndex = calculateInputIndex(${g});\n    if (inputIndex != 0u) {\n      let sizeInConcatAxis = array<u32, ${a.length}u>(${w});\n      ${g} -= sizeInConcatAxis[inputIndex - 1u];\n    }\n\n    ${Io(s,m)}\n  }`}},ko=(e,t)=>{Oo(e.inputs),e.compute(Po(e.inputs,t.axis))},Co=e=>Br({axis:e.axis})})),dl=st((()=>{el(),$o=(e,t)=>{switch(e.activation){case"Relu":return{activationFunction:"",applyActivation:`value = max(value, ${t}(0.0));`};case"Sigmoid":return{activationFunction:"",applyActivation:`value = (${t}(1.0) / (${t}(1.0) + exp(-value)));`};case"Clip":return{activationFunction:`const clip_min_=${t}(${e.clipMin});const clip_max_=${t}(${e.clipMax});`,applyActivation:"value = clamp(value, clip_min_, clip_max_);"};default:return{activationFunction:"",applyActivation:""}}},Ro=e=>{let t=e?.activation||"";if("Clip"===t){let[r,n]=e?.activation_params||[Gr,Vr];return{activation:t,clipMax:n,clipMin:r,activationCacheKey:`${t}:${r},${n}`}}return{activation:t,activationCacheKey:t}}})),pl=st((()=>{Do=(e,t)=>{switch(e){case 1:return t;case 2:return`vec2<${t}>`;case 3:return`vec3<${t}>`;case 4:return`vec4<${t}>`;default:throw new Error(`${e}-component is not supported.`)}},Mo=e=>`\n      ${e?"value = value + getBiasByOutputCoords(coords);":""}\n      `})),yl=st((()=>{Lo=e=>`\nfn getIndexFromCoords4D(coords : vec4<i32>, shape : vec4<i32>) -> i32 {\n  return dot(coords, vec4<i32>(\n      shape.y * shape.z * shape.w, shape.z * shape.w, shape.w, 1));\n}\nfn getOutputIndexFromCoords(coords : vec4<i32>) -> i32 {\n  return dot(coords, vec4<i32>(\n    i32(${e}.x), i32(${e}.y), i32(${e}.z), 1));\n}\n`})),ml=st((()=>{el(),tl(),dl(),pl(),Bo=(e,t)=>e?`\n        mm_Asub[inputRow][inputCol] = mm_readA(batch,\n          kStart + inputRow,\n          globalRowStart / innerElementSize + inputCol${t?", batchIndices":""});\n        `:`\n        mm_Asub[inputRow][inputCol] = mm_readA(batch,\n          globalRow + innerRow,\n          kStart / innerElementSize + inputCol${t?", batchIndices":""});\n        `,No=(e,t)=>e?`\n        let ACached0 = mm_Asub[k * innerElementSize][localRow];\n        let ACached1 = mm_Asub[k * innerElementSize + 1][localRow];\n        let ACached2 = mm_Asub[k * innerElementSize + 2][localRow];\n        ${3===t?"":"let ACached3 = mm_Asub[k * innerElementSize + 3][localRow];"}\n        for (var i = 0; i < rowPerThread; i = i + 1) {\n          acc[i] = BCached0 * ACached0[i] + acc[i];\n          acc[i] = BCached1 * ACached1[i] + acc[i];\n          acc[i] = BCached2 * ACached2[i] + acc[i];\n          ${3===t?"":"acc[i] = BCached3 * ACached3[i] + acc[i];"}\n        }`:`\n        for (var i = 0; i < rowPerThread; i = i + 1) {\n          let ACached = mm_Asub[tileRow + i][k];\n          acc[i] = BCached0 * ACached.x + acc[i];\n          acc[i] = BCached1 * ACached.y + acc[i];\n          acc[i] = BCached2 * ACached.z + acc[i];\n          ${3===t?"":"acc[i] = BCached3 * ACached.w + acc[i];"}\n        }`,Fo=(e,t,r="f32",n,i=!1,o=32,a=!1,s=32)=>{let u=t[1]*e[1],l=t[0]*e[0],h=i?u:o,c=i?o:u,f=h/t[0],d=o/t[1];if((!i||4!==f||4!==e[1])&&(i||3!==f&&4!==f)||h%t[0]!=0||o%t[1]!=0||4!==e[0])throw new Error(`If transposeA ${i} is true, innerElementSize ${f} and workPerThread[1] ${e[1]} must be 4.\n      Otherwise, innerElementSize ${f} must be 3 or 4.\n  tileAWidth ${h} must be divisible by workgroupSize[0]${t[0]}. tileInner ${o} must be divisible by workgroupSize[1] ${t[1]}. colPerThread ${e[0]} must be 4.`);return`\nvar<workgroup> mm_Asub: array<array<vec${f}<${r}>, ${h/f}>, ${c}>;\nvar<workgroup> mm_Bsub: array<array<vec4<${r}>, ${l/e[0]}>, ${o}>;\n\nconst rowPerThread = ${e[1]};\nconst colPerThread = ${e[0]};\nconst innerElementSize = ${f};\nconst tileInner = ${o};\n\n@compute @workgroup_size(${t[0]}, ${t[1]}, ${t[2]})\nfn main(@builtin(local_invocation_id) localId : vec3<u32>,\n        @builtin(global_invocation_id) globalId : vec3<u32>,\n        @builtin(workgroup_id) workgroupId : vec3<u32>) {\n  let localRow = i32(localId.y);\n  let tileRow = localRow * rowPerThread;\n  let tileCol = i32(localId.x);\n\n  let globalRow =i32(globalId.y) * rowPerThread;\n  let globalCol = i32(globalId.x);\n  let batch = ${a?"0":"i32(globalId.z)"};\n  ${n?`let batchIndices = ${n.offsetToIndices("u32(batch)")};`:""}\n  let globalRowStart = i32(workgroupId.y) * ${u};\n\n  let numTiles = ${a?`${Math.ceil(s/o)}`:"(uniforms.dimInner - 1) / tileInner + 1"};\n  var kStart = ${a?`i32(globalId.z) * ${s}`:"0"};\n\n  var acc: array<vec4<${r}>, rowPerThread>;\n\n  // Loop over shared dimension.\n  let tileRowB = localRow * ${d};\n  for (var t = 0; t < numTiles; t = t + 1) {\n      // Load one tile of A into local memory.\n      for (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {\n          let inputRow = tileRow + innerRow;\n          let inputCol = tileCol;\n          ${Bo(i,n)}\n      }\n\n      // Load one tile of B into local memory.\n      for (var innerRow = 0; innerRow < ${d}; innerRow = innerRow + 1) {\n          let inputRow = tileRowB + innerRow;\n          let inputCol = tileCol;\n          mm_Bsub[inputRow][inputCol] = mm_readB(batch, kStart + inputRow, globalCol${n?", batchIndices":""});\n      }\n      kStart = kStart + tileInner;\n      workgroupBarrier();\n\n      // Compute acc values for a single thread.\n      for (var k = 0; k < tileInner / innerElementSize; k = k + 1) {\n          let BCached0 = mm_Bsub[k * innerElementSize][tileCol];\n          let BCached1 = mm_Bsub[k * innerElementSize + 1][tileCol];\n          let BCached2 = mm_Bsub[k * innerElementSize + 2][tileCol];\n          ${3===f?"":"let BCached3 = mm_Bsub[k * innerElementSize + 3][tileCol];"}\n\n          ${No(i,f)}\n      }\n\n      workgroupBarrier();\n  }\n\n  for (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {\n      mm_write(batch, globalRow + innerRow, globalCol, acc[innerRow]);\n  }\n}`},Uo=(e,t)=>e?`\n            mm_Asub[inputRow][inputCol] = mm_readA(batch,\n              kStart + inputRow,\n              globalRowStart + inputCol${t?", batchIndices":""});\n            `:`\n            mm_Asub[inputRow][inputCol] = mm_readA(batch,\n              globalRowStart + inputRow,\n              kStart + inputCol${t?", batchIndices":""});\n            `,jo=e=>e?"let ACached = mm_Asub[k][tileRow + innerRow];":"let ACached = mm_Asub[tileRow + innerRow][k];",zo=(e,t,r="f32",n,i=!1,o=32,a=!1,s=32,u=!1)=>{let l=e[1]*t[1],h=e[0]*t[0],c=i?l:o,f=i?o:l;if(f%t[1]!=0||c%t[0]!=0||o%t[1]!=0)throw new Error(`tileAHight ${f} must be divisible by workgroupSize[1]${t[1]}, tileAWidth ${c} must be divisible by workgroupSize[0]${t[0]}, tileInner ${o} must be divisible by workgroupSize[1]${t[1]}`);let d=f/t[1],p=c/t[0],y=o/t[1],m=u?`\n    let localRow = i32(localId.y);\n    let localCol = i32(localId.x);\n    let globalRowStart = i32(workgroupId.y) * ${l};\n    let globalColStart = i32(workgroupId.x) * ${h};\n\n    // Loop over shared dimension.\n    for (var t = 0; t < numTiles; t = t + 1) {\n      // Load one tile of A into local memory.\n      for (var inputRow = localRow; inputRow < ${f}; inputRow = inputRow + ${t[1]}) {\n        for (var inputCol = localCol; inputCol < ${c}; inputCol = inputCol + ${t[0]}) {\n          ${Uo(i,n)}\n        }\n      }\n      // Load one tile of B into local memory.\n      for (var inputRow = localRow; inputRow < ${o}; inputRow = inputRow + ${t[1]}) {\n            for (var inputCol = localCol; inputCol < ${h}; inputCol = inputCol + ${t[0]}) {\n          mm_Bsub[inputRow][inputCol] = mm_readB(batch,\n            kStart + inputRow,\n            globalColStart + inputCol${n?", batchIndices":""});\n        }\n      }\n      kStart = kStart + tileInner;\n      workgroupBarrier();\n\n      // Compute acc values for a single thread.\n      var BCached : array<${r}, colPerThread>;\n      for (var k = 0; k < tileInner; k = k + 1) {\n        for (var inner = 0; inner < colPerThread; inner = inner + 1) {\n          BCached[inner] = mm_Bsub[k][localCol + inner * ${t[0]}];\n        }\n        for (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {\n          let ACached = ${i?`mm_Asub[k][localRow + innerRow * ${t[1]}];`:`mm_Asub[localRow + innerRow * ${t[1]}][k];`}\n          for (var innerCol = 0; innerCol < colPerThread; innerCol = innerCol + 1) {\n            acc[innerRow][innerCol] = acc[innerRow][innerCol] +\n                ACached * BCached[innerCol];\n          }\n        }\n      }\n      workgroupBarrier();\n    }\n    for (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {\n      let gRow = globalRowStart + localRow + innerRow * ${t[1]};\n      for (var innerCol = 0; innerCol < colPerThread; innerCol = innerCol + 1) {\n        let gCol = globalColStart + localCol + innerCol * ${t[0]};\n        mm_write(batch, gRow, gCol, acc[innerRow][innerCol]);\n      }\n    }\n    `:`\nlet tileRow = i32(localId.y) * rowPerThread;\nlet tileCol = i32(localId.x) * colPerThread;\n\nlet globalRow = i32(globalId.y) * rowPerThread;\nlet globalCol = i32(globalId.x) * colPerThread;\nlet globalRowStart = i32(workgroupId.y) * ${l};\n\nlet tileRowA = i32(localId.y) * ${d};\nlet tileColA = i32(localId.x) * ${p};\nlet tileRowB = i32(localId.y) * ${y};\n// Loop over shared dimension.\nfor (var t = 0; t < numTiles; t = t + 1) {\n  // Load one tile of A into local memory.\n  for (var innerRow = 0; innerRow < ${d}; innerRow = innerRow + 1) {\n    for (var innerCol = 0; innerCol < ${p}; innerCol = innerCol + 1) {\n      let inputRow = tileRowA + innerRow;\n      let inputCol = tileColA + innerCol;\n      ${Uo(i,n)}\n    }\n  }\n\n  // Load one tile of B into local memory.\n  for (var innerRow = 0; innerRow < ${y}; innerRow = innerRow + 1) {\n    for (var innerCol = 0; innerCol < colPerThread; innerCol = innerCol + 1) {\n      let inputRow = tileRowB + innerRow;\n      let inputCol = tileCol + innerCol;\n      mm_Bsub[inputRow][inputCol] = mm_readB(batch,\n        kStart + inputRow,\n        globalCol + innerCol${n?", batchIndices":""});\n    }\n  }\n  kStart = kStart + tileInner;\n  workgroupBarrier();\n\n  // Compute acc values for a single thread.\n  var BCached : array<${r}, colPerThread>;\n  for (var k = 0; k < tileInner; k = k + 1) {\n    for (var inner = 0; inner < colPerThread; inner = inner + 1) {\n      BCached[inner] = mm_Bsub[k][tileCol + inner];\n    }\n\n    for (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {\n      ${jo(i)}\n      for (var innerCol = 0; innerCol < colPerThread; innerCol = innerCol + 1) {\n        acc[innerRow][innerCol] = acc[innerRow][innerCol] + ACached * BCached[innerCol];\n      }\n    }\n  }\n\n  workgroupBarrier();\n}\n\nfor (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {\n  for (var innerCol = 0; innerCol < colPerThread; innerCol = innerCol + 1) {\n    mm_write(batch, globalRow + innerRow, globalCol + innerCol,\n        acc[innerRow][innerCol]);\n  }\n}\n`;return`\n  var<workgroup> mm_Asub : array<array<${r}, ${c}>, ${f}>;\n  var<workgroup> mm_Bsub : array<array<${r}, ${h}>, ${o}>;\n  const rowPerThread = ${e[1]};\n  const colPerThread = ${e[0]};\n  const tileInner = ${o};\n\n@compute @workgroup_size(${t[0]}, ${t[1]}, ${t[2]})\nfn main(@builtin(local_invocation_id) localId : vec3<u32>,\n        @builtin(global_invocation_id) globalId : vec3<u32>,\n        @builtin(workgroup_id) workgroupId : vec3<u32>) {\n    let batch = ${a?"0":"i32(globalId.z)"};\n    ${n?`let batchIndices = ${n.offsetToIndices("u32(batch)")};`:""}\n    let numTiles = ${a?`${Math.ceil(s/o)}`:"(uniforms.dimInner - 1) / tileInner + 1"};\n    var kStart = ${a?`i32(globalId.z) * ${s}`:"0"};\n\n    var acc : array<array<${r}, colPerThread>, rowPerThread>;\n\n    // Without this initialization strange values show up in acc.\n    for (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {\n      for (var innerCol = 0; innerCol < colPerThread; innerCol = innerCol + 1) {\n        acc[innerRow][innerCol] = 0.0;\n      }\n    }\n    ${m}\n  }\n`},Go=(e,t,r,n,i,o=!1)=>{let[a,s,u]=i,[l,h,c,f]=n,d=sn(a,u),p=sn(s,u),y=Hr(n[0].type.tensor);return`\n    fn mm_readA(batch: i32, row: i32, colIn: i32, batchIndices: ${l.type.indices}) -> ${Do(e,y)} {\n      var value = ${Do(e,y)}(0.0);\n      let col = colIn * ${e};\n      if(row < uniforms.dimAOuter && col < uniforms.dimInner)\n      {\n        ${(()=>{let e=h.rank,t=l.rank,r=`var aIndices: ${h.type.indices};`;for(let n=e-2-1,i=t-1;n>=0;n--,i--)r+=`\naIndices[${n}] = ${t>1?`batchIndices[${i}]`:"batchIndices"};`;return d.forEach((e=>{r+=`\naIndices[${e}] = 0;`})),r+=`\naIndices[${e-2}] = u32(row);\n                   aIndices[${e-1}] = u32(colIn);`,r})()}\n        value = ${h.getByIndices("aIndices")};\n      }\n      return value;\n    }\n\n    fn mm_readB(batch: i32, row: i32, colIn: i32, batchIndices: ${l.type.indices}) -> ${Do(e,y)} {\n      var value = ${Do(e,y)}(0.0);\n      let col = colIn * ${e};\n      if(row < uniforms.dimInner && col < uniforms.dimBOuter)\n      {\n        ${(()=>{let e=c.rank,t=l.rank,r=`var bIndices: ${c.type.indices};`;for(let n=e-2-1,i=t-1;n>=0;n--,i--)r+=`\nbIndices[${n}] = ${t>1?`batchIndices[${i}]`:"batchIndices"};`;return p.forEach((e=>{r+=`\nbIndices[${e}] = 0;`})),r+=`\nbIndices[${e-2}] = u32(row);\n                   bIndices[${e-1}] = u32(colIn);`,r})()}\n        value = ${c.getByIndices("bIndices")};\n      }\n      return value;\n    }\n\n    fn mm_write(batch: i32, row: i32, colIn: i32, valueIn: ${Do(e,y)}) {\n      let col = colIn * ${e};\n      if (row < uniforms.dimAOuter && col < uniforms.dimBOuter) {\n        var value = valueIn;\n        let coords = vec3<i32>(batch, row, colIn);\n        ${t?`value = value + ${o?"bias[colIn]":`${Do(e,y)}(bias[row])`};`:""}\n        ${r}\n        ${f.setByIndices("vec3<u32>(coords)","value")}\n      }\n    }\n    `},Vo=(e,t,r,n,i=!1)=>{let o=e[0].dims,a=e[1].dims,s=o.slice(0,-2),u=a.slice(0,-2),l=n?n.slice(0,-2):r.slice(0,-2),h=un(l.length),c=h?l.length:l,f=nn("batchDims",e[0].dataType,c,1),d=Ur.size(l),p=o[o.length-2],y=o[o.length-1],m=a[a.length-1],g=y%4==0&&m%4==0,w=p<=8?[4,1,1]:[4,4,1],v=[8,8,1],b=[Math.ceil(m/v[0]/w[0]),Math.ceil(p/v[1]/w[1]),Math.ceil(d/v[2]/w[2])],x=Hr(e[0].dataType),_=g?4:1,S=[...s,p,y/_],T=un(S.length),E=T?S.length:S,O=[...u,y,m/_],A=un(O.length),I=A?O.length:O,P=[d,p,m/_],k=tn("a",e[0].dataType,E,_),C=tn("b",e[1].dataType,I,_),$=rn("result",e[0].dataType,P.length,_),R=[k,C],D=[{type:"int32",data:p},{type:"int32",data:m},{type:"int32",data:y}];h&&D.push(...Yr(l)),T&&D.push(...Yr(S)),A&&D.push(...Yr(O));let M=[];M.push(T?"rank":"dims"),M.push(A?"rank":"dims");let L=e.length>2,{activationFunction:B,applyActivation:N}=$o(t,$.type.value),F=Go(_,L,N,[f,k,C,$],[s,u,l],i);if(L){let t=i?_:1;R.push(tn("bias",e[2].dataType,e[2].dims.length,t)),D.push(...Yr(e[2].dims)),M.push("rank")}D.push(...Yr(P));return{name:"MatMul",shaderCache:{hint:t.activationCacheKey+`${w}${g}${i}`,inputDependencies:M},getRunData:()=>({outputs:[{dims:r,dataType:e[0].dataType}],dispatchGroup:{x:b[0],y:b[1],z:b[2]},programUniforms:D}),getShaderSource:e=>`\n  ${e.registerUniform("dimAOuter","i32").registerUniform("dimBOuter","i32").registerUniform("dimInner","i32").registerInternalVariables(f).declareVariables(...R,$)}\n  ${B}\n  ${F}\n  ${g?Fo(w,v,x,f):zo(w,v,x,f)}\n                   `}}})),gl=st((()=>{Xu(),tl(),dl(),pl(),yl(),ml(),Wo=(e,t,r,n,i=!1,o,a=4,s=4,u=4,l="f32")=>{let h=e?"\n    let coord = vec4<i32>(batch, xRow, xCol, xCh);\n    ":"\n    let coord = vec4<i32>(batch, xCh, xRow, xCol);\n    ",c=e?"\n    let coords = vec4<i32>(\n      batch,\n      row / outWidth,\n      row % outWidth,\n      col);\n    ":"\n    let coords = vec4<i32>(\n      batch,\n      row,\n      col / outWidth,\n      col % outWidth);\n    ",f=e?"i32(uniforms.x_shape[1])":"i32(uniforms.x_shape[2])",d=e?"i32(uniforms.x_shape[2])":"i32(uniforms.x_shape[3])",p=e?"row":"col",y=e?"col":"row",m=`\n    let inChannels = i32(uniforms.w_shape[2]);\n    let outWidth = ${e?"i32(uniforms.result_shape[2])":"i32(uniforms.result_shape[3])"};\n    let outRow = ${p} / outWidth;\n    let outCol = ${p} % outWidth;\n\n    let WRow = ${y} / (filterDims[1] * inChannels);\n    let WCol = ${y} / inChannels % filterDims[1];\n    let xRow = outRow * stride[0] + dilation[0] * WRow - pad[0];\n    let xCol = outCol * stride[1] + dilation[1] * WCol - pad[1];\n    let xCh = ${y} % inChannels;\n    var resData = ${Do(a,l)}(0.0);\n    // The bounds checking is always needed since we use it to pad zero for\n    // the 'same' padding type.\n    if (xRow >= 0 && xRow < ${f} && xCol >= 0 && xCol < ${d}) {\n      ${h}\n      let xIndex = getIndexFromCoords4D(coord, vec4<i32>(uniforms.x_shape));\n      ${(e=>{switch(e){case 1:return"resData = x[xIndex];";case 3:return`resData = vec3<${l}>(x[xIndex], x[xIndex + 1], x[xIndex + 2]);`;case 4:return"resData = x[xIndex / 4];";default:throw new Error(`innerElementSize ${e} is not supported.`)}})(a)}\n    }\n    return resData;`,g=e?t&&n?`\n    let col = colIn * ${a};\n    ${m}`:`\n    let col = colIn * ${a};\n    if (row < uniforms.dimAOuter && col < uniforms.dimInner) {\n      ${m}\n    }\n    return ${Do(a,l)}(0.0);`:n&&r?`\n    let col = colIn * ${a};\n    ${m}`:`\n    let col = colIn * ${a};\n    if (row < uniforms.dimInner && col < uniforms.dimBOuter) {\n      ${m}\n    }\n    return ${Do(a,l)}(0.0);`,w=`${(e=>{switch(e){case 1:return"return w[row * i32(uniforms.w_shape[3]) + colIn];";case 4:return"return w[row * i32(uniforms.w_shape[3]) / 4 + colIn];";default:throw new Error(`innerElementSize ${e} is not supported.`)}})(s)}`,v=Do(u,l),b=Do(e?a:s,l),x=Do(e?s:a,l),{activationFunction:_,applyActivation:S}=$o(o,v);return`\n    ${_}\n    fn mm_readA(batch: i32, row : i32, colIn : i32) -> ${b} {\n      ${e?g:w}\n    }\n\n    fn mm_readB(batch: i32, row : i32, colIn : i32) -> ${x} {\n      ${e?w:g}\n    }\n\n    fn mm_write(batch: i32, row : i32, colIn : i32, valueIn : ${v}) {\n      let col = colIn * ${u};\n      if (row < uniforms.dimAOuter && col < uniforms.dimBOuter)\n      {\n      var value = valueIn;\n      let outWidth = ${e?"i32(uniforms.result_shape[2])":"i32(uniforms.result_shape[3])"};\n      ${c}\n      ${Mo(i)}\n      ${S}\n      setOutputAtCoords(coords[0], coords[1], coords[2], coords[3], value);\n      }\n    }`},Ho=(e,t,r,n,i,o,a,s)=>{let u="NHWC"===t.format,l=u?e[0].dims[3]:e[0].dims[1],h=r[0],c=u?r[2]:r[3],f=u?r[1]:r[2],d=u?r[3]:r[1],p=u&&(l%4==0||l%3==0)&&d%4==0,y=u?d:c*f,m=u?c*f:d,g=[8,8,1],w=n<=8?[4,1,1]:[4,4,1],v=[Math.ceil(y/g[0]/w[0]),Math.ceil(m/g[1]/w[1]),Math.ceil(h/g[2]/w[2])];Or("verbose",(()=>`[conv2d_mm_webgpu] dispatch = ${v}`));let b=p?u&&l%4!=0?3:4:1,x=g[1]*w[1],_=g[0]*w[0],S=Math.max(g[0]*b,g[1]),T=n%x==0,E=i%_==0,O=o%S==0,A=p?[b,4,4]:[1,1,1],I=Hr(e[0].dataType),P=p?4:1,k=[{type:"int32",data:n},{type:"int32",data:i},{type:"int32",data:o}],C=[tn("x",e[0].dataType,e[0].dims.length,3===b?1:b),tn("w",e[1].dataType,e[1].dims.length,P)];k.push(...Yr(e[0].dims)),k.push(...Yr(e[1].dims));let $=`\n      fn setOutputAtIndex(flatIndex : i32, value : ${p?`vec4<${I}>`:I}) {\n        result[flatIndex] = ${p?`vec4<${I}>`:I}(value);\n      }\n      fn setOutputAtCoords(d0 : i32, d1 : i32, d2 : i32, d3 : i32, value : ${p?`vec4<${I}>`:I}) {\n        let flatIndex = getOutputIndexFromCoords(vec4<i32>(d0, d1, d2, d3));\n        setOutputAtIndex(flatIndex ${p?"/ 4":""}, value);\n      }`;if(a){let t=tn("bias",e[2].dataType,e[2].dims.length,P);C.push(t),k.push(...Yr(e[2].dims)),$+=`\n        fn getBiasByOutputCoords(coords : vec4<i32>) -> ${p?`vec4<${I}>`:I} {\n          return bias[coords.${u?"w":"y"}${p?"/ 4":""}];\n        }`}let R=rn("result",e[0].dataType,r.length,P);return k.push(...Yr(r)),{name:"Conv2DMatMul",shaderCache:{hint:t.cacheKey},getRunData:()=>({outputs:[{dims:r,dataType:e[0].dataType}],dispatchGroup:{x:v[0],y:v[1],z:v[2]},programUniforms:k}),getShaderSource:e=>`\n        ${Lo("uniforms.result_strides")}\n        //struct Uniforms { xShape : vec4<i32>, wShape : vec4<i32>, outShape : vec4<i32>,\n        //  outShapeStrides: vec3<i32>, filterDims : vec2<i32>, pad : vec2<i32>, stride : vec2<i32>,\n        //  dilation : vec2<i32>, dimAOuter : i32, dimBOuter : i32, dimInner : i32 };\n        ${e.registerUniform("dimAOuter","i32").registerUniform("dimBOuter","i32").registerUniform("dimInner","i32").declareVariables(...C,R)}\n        const filterDims : vec2<i32> = vec2<i32>(${t.kernelShape[0]}, ${t.kernelShape[1]});\n        const pad : vec2<i32> = vec2<i32>(${t.pads[0]}, ${t.pads[1]});\n        const stride : vec2<i32> = vec2<i32>(${t.strides[0]}, ${t.strides[1]});\n        const dilation : vec2<i32> = vec2<i32>(${t.dilations[0]}, ${t.dilations[1]});\n        ${$}\n        ${Wo(u,T,E,O,a,t,A[0],A[1],A[2],I)}\n            ${p?Fo(w,g,I,void 0,!u,S):zo(w,g,I,void 0,!u,S,!1,void 0,s)}`}}})),wl=st((()=>{el(),tl(),bl(),dl(),qo=(e,t,r)=>{let n=e.length>2,i=n?"value += b[output_channel];":"",o=e[0].dims,a=e[1].dims,s=a[0]/t.group,u="NHWC"===t.format,l=Zo(o,a,t.dilations,t.pads,t.strides,u),h=Ur.size(l),c=rn("output",e[0].dataType,l),{activationFunction:f,applyActivation:d}=$o(t,c.type.value),p=tn("x",e[0].dataType,o),y=tn("w",e[1].dataType,a),m=[p,y];n&&m.push(tn("b",e[2].dataType,e[2].dims));return{name:"GroupedConv",shaderCache:{hint:t.cacheKey},getRunData:()=>({outputs:[{dims:r?r(l):l,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(h/64)}}),getShaderSource:e=>`\n  const strides: vec2<u32> = vec2(${t.strides[0]}u, ${t.strides[1]}u);\n  const pads: vec2<u32> = vec2(${t.pads[0]}u, ${t.pads[1]}u);\n\n  ${e.declareVariables(...m,c)}\n\n  ${f}\n\n  ${e.mainStart()}\n    ${e.guardAgainstOutOfBoundsWorkgroupSizes(h)}\n\n    let outputIndices = ${c.offsetToIndices("global_idx")};\n    let batch: u32 = outputIndices[0];\n    let output_channel: u32 = outputIndices[${u?3:1}];\n    let xRCCorner: vec2<u32> = vec2<u32>(outputIndices[${u?1:2}], outputIndices[${u?2:3}]) * strides - pads;\n    let group_id: u32 = output_channel / ${s}u;\n\n    var value: ${c.type.value} = ${c.type.value}(0);\n    for (var wInChannel: u32 = 0u; wInChannel < ${a[1]}u; wInChannel++) {\n      let input_channel = group_id * ${a[1]}u + wInChannel;\n      for (var wHeight: u32 = 0u; wHeight < ${a[2]}u; wHeight++) {\n        let xHeight = xRCCorner.x + wHeight * ${t.dilations[0]}u;\n\n        if (xHeight < 0u || xHeight >= ${o[u?1:2]}u) {\n          continue;\n        }\n\n        for (var wWidth: u32 = 0u; wWidth < ${a[3]}u; wWidth++) {\n          let xWidth = xRCCorner.y + wWidth * ${t.dilations[1]}u;\n          if (xWidth < 0u || xWidth >= ${o[u?2:3]}u) {\n            continue;\n          }\n\n          let xVal = ${u?p.get("batch","xHeight","xWidth","input_channel"):p.get("batch","input_channel","xHeight","xWidth")};\n          let wVal = ${y.get("output_channel","wInChannel","wHeight","wWidth")};\n          value += xVal*wVal;\n        }\n      }\n    }\n    ${i}\n    ${d}\n    ${c.setByOffset("global_idx","value")}\n  }`}}})),vl=st((()=>{el(),ml(),tl(),dl(),Yo=(e,t,r,n,i=!1)=>{let o=e[0].dims,a=e[1].dims,s=o[o.length-2],u=a[a.length-1],l=o[o.length-1],h=Xr(u),c=Xr(l),f=Xr(s),d=Ur.size(r)/h/f,p=e.length>2,y=n?n.slice(0,-2):r.slice(0,-2),m=[Ur.size(y),s,u],g=[{type:"uint32",data:d},{type:"uint32",data:s},{type:"uint32",data:u},{type:"uint32",data:l},...Yr(y),...Yr(o),...Yr(a)];p&&g.push(...Yr(e[2].dims)),g.push(...Yr(m));return{name:"MatMulNaive",shaderCache:{hint:`${t.activationCacheKey}_${h}_${c}_${f}_${i}`,inputDependencies:p?["rank","rank","rank"]:["rank","rank"]},getRunData:()=>({outputs:[{dims:r,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(d/64)},programUniforms:g}),getShaderSource:n=>{let s=nn("batch_dims",e[0].dataType,y.length),u=tn("a",e[0].dataType,o.length,c),l=tn("b",e[1].dataType,a.length,h),d=rn("output",e[0].dataType,m.length,h),{activationFunction:g,applyActivation:w}=$o(t,d.type.value),v=[u,l],b="";if(p){let t=i?h:1;v.push(tn("bias",e[2].dataType,e[2].dims.length,t)),b=""+(i?`value += bias[col / ${t}];`:`value += ${d.type.value}(bias[row + i]);`)}let x=o.slice(0,-2),_=a.slice(0,-2),S=sn(x,y),T=sn(_,y),E=(e,t)=>{let r=e.rank,n=e.name;if(2===r)return`var ${n}_indices = ${e.type.indices}(0u, 0u);`;let i=s.rank,o=`var ${n}_indices: ${e.type.indices};`;for(let e=r-2-1,t=i-1;e>=0;e--,t--)o+=`\n${n}_indices[${e}] = ${i>1?`batch_indices[${t}]`:"batch_indices"};`;return t.forEach((e=>{o+=`\n${n}_indices[${e}] = 0;`})),o+=`${n}_indices[${r-2}] = 0u;\n                     ${n}_indices[${r-1}] = 0u;`,o};return`\n  ${n.registerUniform("outputSize","u32").registerUniform("M","u32").registerUniform("N","u32").registerUniform("K","u32").registerInternalVariables(s).declareVariables(...v,d)}\n  ${g}\n  ${n.mainStart()}\n    ${n.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}\n    let col = (global_idx % (uniforms.N / ${h})) * ${h};\n    var index1 = global_idx / (uniforms.N / ${h});\n    let stride1 = uniforms.M / ${f};\n    let row = (index1 % stride1) * ${f};\n    let batch = index1 / stride1;\n\n    ${2===r.length?"":`let batch_indices = ${s.offsetToIndices("batch")};`}\n    ${E(u,S)}\n    let a_offset = ${u.indicesToOffset("a_indices")};\n    ${E(l,T)}\n    let b_offset = ${l.indicesToOffset("b_indices")};\n    var values: array<${d.type.value}, ${f}>;\n    for (var k: u32 = 0u; k < uniforms.K; k = k + ${c}) {\n      ${(()=>{let e=`var a_data: ${u.type.value};`;for(let t=0;t<c;t++)e+=`\n              let b_data${t} = b[(b_offset + (k + ${t}) * uniforms.N + col) / ${h}];`;for(let t=0;t<f;t++){e+=`a_data = a[(a_offset + (row + ${t}) * uniforms.K + k) / ${c}];`;for(let r=0;r<c;r++)e+=`\n            values[${t}] = fma(${l.type.value}(a_data${1===c?"":`[${r}]`}), b_data${r}, values[${t}]);\n`}return e})()}\n    }\n    for (var i = 0u; i < ${f}u; i++) {\n      var value = values[i];\n      ${b}\n      ${w}\n      let cur_indices = ${d.type.indices}(batch, row + i, col);\n      let offset = ${d.indicesToOffset("cur_indices")};\n      ${d.setByOffset(`offset / ${h}`,"value")};\n    }\n  }\n  `}}},Xo=e=>{if(!e||2!==e.length)throw new Error("MatMul requires 2 inputs.");if(e[0].dims[e[0].dims.length-1]!==e[1].dims[e[1].dims.length-2])throw new Error("shared dimension does not match.")},Ko=e=>{Xo(e.inputs);let t=Fr.calcShape(e.inputs[0].dims,e.inputs[1].dims,!0);if(!t)throw new Error("Can't use matmul on the given tensors");let r=t[t.length-1],n=e.inputs[0].dims[e.inputs[0].dims.length-1];r<8&&n<8?e.compute(Yo(e.inputs,{activation:"",activationCacheKey:""},t)):e.compute(Vo(e.inputs,{activation:"",activationCacheKey:""},t))}})),bl=st((()=>{el(),Qu(),gl(),ml(),wl(),dl(),vl(),rl(),Zo=(e,t,r,n,i,o)=>{let a=e[0],s=e.slice(o?1:2,o?3:4),u=s.length,l=t[0],h=t.slice(2).map(((e,t)=>e+(e-1)*(r[t]-1))),c=s.map(((e,t)=>e+n[t]+n[t+u])).map(((e,t)=>Math.floor((e-h[t]+i[t])/i[t])));return c.splice(0,0,a),c.splice(o?3:1,0,l),c},Jo=[2,3,1,0],Qo=(e,t)=>{if(!e||2!==e.length&&3!==e.length)throw new Error("Conv requires 2 or 3 inputs");if(4!==e[0].dims.length&&3!==e[0].dims.length)throw new Error("currently only support conv 1D and 2D");if(e[0].dims.length!==e[1].dims.length)throw new Error("filter does not have same dimension as input");if(e[0].dims["NHWC"===t.format?e[0].dims.length-1:1]!==e[1].dims[1]*t.group)throw new Error("FILTER_IN_CHANNEL should be equal to DATA_CHANNEL");if(3===e.length&&(1!==e[2].dims.length||e[1].dims[0]!==e[2].dims[0]))throw new Error("invalid bias");let r=e[0].dims.length-2;if(t.dilations.length!==r)throw new Error(`dilations should be ${r}D`);if(t.strides.length!==r)throw new Error(`strides should be ${r}D`);if(t.pads.length!==2*r)throw new Error(`pads should be ${2*r}D`);if(0!==t.kernelShape.length&&t.kernelShape.length!==e[1].dims.length-2)throw new Error("invalid kernel shape")},ea=(e,t)=>{let r=e.kernelShape.slice();for(let e=2;e<t[1].dims.length;++e)0===r[e-2]&&(r[e-2]=t[1].dims[e]);let n=e.pads.slice();jr.adjustPadsBasedOnAutoPad(t[0].dims,e.strides,e.dilations,r,n,"NHWC"===e.format,e.autoPad);let i=Object.assign({},e);return Object.assign(i,{kernelShape:r,pads:n,cacheKey:e.cacheKey}),i},ta=e=>{let t=Ro(e),r=e.format,n=["NOTSET","VALID","SAME_UPPER","SAME_LOWER"][e.auto_pad],i=e.dilations,o=e.group,a=e.kernel_shape,s=e.pads,u=e.strides,l=e.w_is_const();return Br({autoPad:n,format:r,dilations:i,group:o,kernelShape:a,pads:s,strides:u,wIsConst:l,...t})},ra=(e,t,r)=>{let n=ea(r,t),i="NHWC"===r.format;if(1!==r.group)return void e.compute(qo(t,n));let o=3===t.length,a=t[0].dims[i?1:2],s=t[0].dims[i?2:3],u=t[0].dims[i?3:1],l=t[1].dims[2],h=t[1].dims[3],c=Zo(t[0].dims,t[1].dims,r.dilations,n.pads,r.strides,i),f=c[i?1:2],d=c[i?2:3],p=c[i?3:1],y=i&&l===a&&h===s&&0===r.pads[0]&&0===r.pads[1];if(y||1===l&&1===h&&1===r.dilations[0]&&1===r.dilations[1]&&1===r.strides[0]&&1===r.strides[1]&&0===r.pads[0]&&0===r.pads[1]){let l,h,m,g=c[0],w=[];if(i){let n=e.kernelCustomData.wT??e.compute(dn(t[1],Jo),{inputs:[1],outputs:[r.wIsConst?-2:-1]})[0];if(r.wIsConst&&!e.kernelCustomData.wT&&(e.kernelCustomData.wT=n),y){let e=a*s*u;l=t[0].reshape([1,g,e]),h=n.reshape([1,e,p]),m=[1,g,p]}else l=t[0].reshape([g,a*s,u]),h=n.reshape([1,u,p]),m=[g,f*d,p];w.push(l),w.push(h)}else l=t[0].reshape([g,u,a*s]),h=t[1].reshape([1,p,u]),m=[g,p,f*d],w.push(h),w.push(l);o&&w.push(t[2]);let v=m[2],b=w[0].dims[w[0].dims.length-1];return void(v<8&&b<8?e.compute(Yo(w,n,c,m,i),{inputs:w}):e.compute(Vo(w,n,c,m,i),{inputs:w}))}let m=e.kernelCustomData.wT??e.compute(dn(t[1],Jo),{inputs:[1],outputs:[r.wIsConst?-2:-1]})[0];r.wIsConst&&!e.kernelCustomData.wT&&(e.kernelCustomData.wT=m);let g=[t[0],m];o&&g.push(t[2]);let w=i?f*d:p,v=i?p:f*d,b=l*h*u;e.compute(Ho(g,n,c,w,v,b,o,!0),{inputs:g})},na=(e,t)=>{let r="NHWC"===t.format,n=[e.inputs[0].reshape(r?[e.inputs[0].dims[0],1,e.inputs[0].dims[1],e.inputs[0].dims[2]]:[e.inputs[0].dims[0],e.inputs[0].dims[1],1,e.inputs[0].dims[2]]),e.inputs[1].reshape([e.inputs[1].dims[0],e.inputs[1].dims[1],1,e.inputs[1].dims[2]])];3===e.inputs.length&&n.push(e.inputs[2]);let i=[0,t.pads[0],0,t.pads[1]],o=[1].concat(t.strides),a=[1].concat(t.dilations),s=[1].concat(t.kernelShape),u=ea({...t,pads:i,strides:o,dilations:a,kernelShape:s},n);e.compute(qo(n,u,(e=>r?[e[0],e[2],e[3]]:[])))},ia=(e,t)=>{Qo(e.inputs,t),3===e.inputs[0].dims.length?na(e,t):ra(e,e.inputs,t)}})),xl=st((()=>{Xu(),tl(),dl(),pl(),yl(),ml(),oa=(e,t=!1,r,n=4)=>{let i=Do(n,"f32"),o=e?"\n    let coords = vec4<i32>(\n      batch,\n      row / outWidth,\n      row % outWidth,\n      col);\n    ":"\n    let coords = vec4<i32>(\n      batch,\n      row,\n      col / outWidth,\n      col % outWidth);\n    ",a=e?"row":"col",s=e?"col":"row",u=`\n      let inChannels = ${e?"outBackprop[3]":"outBackprop[1]"};\n      let outWidth = ${e?"i32(uniforms.result_shape[2])":"i32(uniforms.result_shape[3])"};\n      let outRow = ${a} / outWidth;\n      let outCol = ${a} % outWidth;\n\n      let WRow = ${s} / (filterDims[1] * inChannels);\n      let WCol = ${s} / inChannels % filterDims[1];\n      let xR = f32(outRow - pads[0] + dilation[0] * WRow) / f32(strides[0]);\n      let xC = f32(outCol - pads[1] + dilation[1] * WCol) / f32(strides[1]);\n      if (xR < 0.0 || xR >= f32(${e?"outBackprop[1]":"outBackprop[2]"}) || fract(xR) > 0.0) {\n        return ${i}(0.0);\n      }\n      if (xC < 0.0 || xC >= f32(${e?"outBackprop[2]":"outBackprop[3]"}) || fract(xC) > 0.0) {\n        return ${i}(0.0);\n      }\n      let iXR = i32(xR);\n      let iXC = i32(xC);\n      let xCh = ${s} % inChannels;\n      ${e?"\n      let coord = vec4<i32>(batch, iXR, iXC, xCh);\n      ":"\n      let coord = vec4<i32>(batch, xCh, iXR, iXC);\n      "}\n      return x[getIndexFromCoords4D(coord, vec4<i32>(uniforms.x_shape))/${n}];`,l=e?`\n      let col = colIn * ${n};\n      if (row < uniforms.dimAOuter && col < uniforms.dimInner) {\n        ${u}\n      }\n      return ${i}(0.0);`:`\n      let col = colIn * ${n};\n      if (row < uniforms.dimInner && col < uniforms.dimBOuter) {\n        ${u}\n      }\n      return ${i}(0.0);`,h=`\n      let col = colIn * ${n};\n      let inChannels = ${e?"outBackprop[3]":"outBackprop[1]"};\n      let coordX = filterDims.x - 1 - row / (filterDims[1] * inChannels);\n      let coordY = filterDims.y - 1 - (row / inChannels) % filterDims[1];\n      if (${e?"row < uniforms.dimInner && col < uniforms.dimBOuter":"row < uniforms.dimInner && col < uniforms.dimAOuter"}  && coordX >= 0 && coordY >= 0) {\n        let rowInner = row % inChannels;\n        let coord = vec4<i32>(coordX, coordY, col, rowInner);\n        ${(e=>{switch(e){case 1:return"return w[getIndexFromCoords4D(coord, vec4<i32>(uniforms.w_shape))];";case 4:return"\n            let coord1 = vec4<i32>(coordX, coordY, col + 1, rowInner);\n            let coord2 = vec4<i32>(coordX, coordY, col + 2, rowInner);\n            let coord3 = vec4<i32>(coordX, coordY, col + 3, rowInner);\n            let v0 = w[getIndexFromCoords4D(coord, vec4<i32>(uniforms.w_shape))];\n            let v1 = w[getIndexFromCoords4D(coord1, vec4<i32>(uniforms.w_shape))];\n            let v2 = w[getIndexFromCoords4D(coord2, vec4<i32>(uniforms.w_shape))];\n            let v3 = w[getIndexFromCoords4D(coord3, vec4<i32>(uniforms.w_shape))];\n            return vec4<f32>(v0, v1, v2, v3);\n            ";default:throw new Error(`innerElementSize ${e} is not supported.`)}})(n)}\n      }\n      return ${i}(0.0);\n      `,{activationFunction:c,applyActivation:f}=$o(r,i);return`\n      ${c}\n  fn mm_readA(batch: i32, row : i32, colIn : i32) -> ${i} {\n    ${e?l:h}\n  }\n\n  fn mm_readB(batch: i32, row : i32, colIn : i32) -> ${i} {\n    ${e?h:l}\n  }\n\n  fn mm_write(batch: i32, row : i32, colIn : i32, valueInput : ${i}) {\n    let col = colIn * ${n};\n    if (row < uniforms.dimAOuter && col < uniforms.dimBOuter) {\n      var value = valueInput;\n      let outWidth = ${e?"i32(uniforms.result_shape[2])":"i32(uniforms.result_shape[3])"};\n      ${o}\n      ${Mo(t)}\n      ${f}\n      result[getIndexFromCoords4D(coords, vec4<i32>(uniforms.result_shape))/${n}] = value;\n    }\n  }`},aa=(e,t,r,n,i,o,a,s)=>{let u="NHWC"===t.format,l=u?e[0].dims[3]:e[0].dims[1],h=r[0],c=u?r[2]:r[3],f=u?r[1]:r[2],d=u?r[3]:r[1],p=u?l%4==0&&d%4==0:c%4==0&&d%4==0,y=u?d:c*f,m=u?c*f:d,g=p?[8,8,1]:[y<=4||m<=4?4:16,y>4&&m<=4?4:16,1],w=p?[4,4,1]:[y<=4?1:4,y>4&&m<=4?1:4,1],v=[Math.ceil(y/g[0]/w[0]),Math.ceil(m/g[1]/w[1]),Math.ceil(h/g[2]/w[2])];Or("verbose",(()=>`[conv_backprop_mm_webgpu] dispatch = ${v}`));let b=p?4:1,x=Math.max(g[0]*b,g[1]),_=p?4:1,S=[{type:"int32",data:n},{type:"int32",data:i},{type:"int32",data:o}],T=tn("x",e[0].dataType,e[0].dims.length,_),E=tn("w",e[1].dataType,e[1].dims.length,1),O=rn("result",e[0].dataType,r.length,_),A=[T,E];S.push(...Yr(e[0].dims)),S.push(...Yr(e[1].dims));let I="";if(a){let t=tn("bias",e[2].dataType,e[2].dims.length,_);A.push(t),S.push(...Yr(e[2].dims)),I+=`\n        fn getBiasByOutputCoords(coords : vec4<i32>) -> ${p?"vec4<f32>":"f32"} {\n          return bias[coords.${u?"w":"y"}${p?"/ 4":""}];\n        }`}return S.push(...Yr(r)),{name:"Conv2DTransposeMatMul",shaderCache:{hint:t.cacheKey},getRunData:()=>({outputs:[{dims:r,dataType:e[0].dataType}],dispatchGroup:{x:v[0],y:v[1],z:v[2]},programUniforms:S}),getShaderSource:r=>`\n        ${Lo("uniforms.result_strides")}\n        ${r.registerUniform("dimAOuter","i32").registerUniform("dimBOuter","i32").registerUniform("dimInner","i32").declareVariables(...A,O)};\n        const outBackprop : vec4<i32> = vec4<i32>(${e[0].dims.join(",")});\n        const filterDims : vec2<i32> = vec2<i32>(${t.kernelShape[u?1:2]}, ${t.kernelShape[u?2:3]});\n        const effectiveFilterDims : vec2<i32> = filterDims + vec2<i32>(\n              ${t.dilations[0]<=1?0:(t.kernelShape[u?1:2]-1)*(t.dilations[0]-1)},\n              ${t.dilations[1]<=1?0:(t.kernelShape[u?2:3]-1)*(t.dilations[1]-1)});\n        const pads : vec2<i32> = vec2<i32>(i32(effectiveFilterDims[0]) - 1 - (${t.pads[0]+t.pads[2]})/2,\n                                         i32(effectiveFilterDims[1]) - 1 - (${t.pads[1]+t.pads[3]})/2);\n        const strides : vec2<i32> = vec2<i32>(${t.strides[0]}, ${t.strides[1]});\n        const dilation : vec2<i32> = vec2<i32>(${t.dilations[0]}, ${t.dilations[1]});\n        const dimAOuter : i32 = ${n};\n        const dimBOuter : i32 = ${i};\n        const dimInner : i32 = ${o};\n        ${I}\n        ${oa(u,a,t,b)}\n        ${p?Fo(w,g,"f32",void 0,!u,x):zo(w,g,"f32",void 0,!u,x,!1,void 0,s)}`}}})),_l=st((()=>{Xu(),el(),tl(),sa=(e,t,r,n,i,o,a=!1,s)=>{let u="NHWC"===r.format,l=u?1:2,h=u?2:3,c=u?3:1,f=Ur.size(n),d=a?2:1,p=r.group,y=t[1].dims,m=y[0]/p,g=y[1],w=`\n  fn setOutputAtIndex(flatIndex : u32, value : ${a?`vec4<${s}>`:s}) {\n    result[flatIndex] = ${a?`vec4<${s}>`:s}(value);\n  }`;i&&(w+=`\n    fn getBiasByOutputCoords(coords : vec4<u32>) -> ${a?`vec4<${s}>`:s} {\n      return bias[coords.${u?"w":"y"}${a?"/ 4":""}];\n    }`);let v=a?4:1,b=tn("W",t[1].dataType,t[1].dims,v),x=tn("Dy",t[0].dataType,t[0].dims,v),_=[x,b];i&&_.push(tn("bias",t[2].dataType,[n[c]],v));let S=rn("result",t[0].dataType,n,v),T=`{\n        let batch: u32 = ${o?"global_id.z":"workgroup_id.z"} / outShape[1];\n        let r = ${o?"global_id.z":"workgroup_id.z"} % outShape[1];\n        let c = ${o?"global_id.y":"workgroup_id.y"} * ${d};\n        let d1: u32 = ${o?"global_id.x":"workgroup_id.x"} * 4;\n\n        let dyCorner = vec2<i32>(i32(r), i32(c)) - vec2<i32>(pads);\n\n        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).\n        // ? = to be determined. : = across all values in that axis.\n        var dotProd: array<vec4<${s}>, ${d}>;\n        for (var i = 0; i < ${d}; i++) {\n          dotProd[i] = vec4<${s}>(0.0);\n        }\n        for (var wR: u32 = 0; wR < filterDims[0]; wR = wR + 1) {\n          var dyR = (${s}(dyCorner.x) + ${s}(wR)) / ${s}(strides.x);\n          let wRPerm = filterDims[0] - 1 - wR;\n          if (dyR < 0.0 || dyR >= ${s}(outBackprop[1]) ||\n              fract(dyR) > 0.0 || wRPerm < 0) {\n            continue;\n          }\n          let idyR: u32 = u32(dyR);\n\n          for (var wC: u32 = 0; wC < filterDims[1]; wC = wC + 1) {\n            let dyC = (${s}(dyCorner.y) + ${s}(wC)) / ${s}(strides.y);\n            let dyC2 = (${s}(dyCorner.y) + 1.0 + ${s}(wC)) / ${s}(strides.y);\n            let wCPerm = filterDims[1] - 1 - wC;\n            if (wCPerm < 0) {\n              continue;\n            }\n            var bDyCVal = true;\n            var bDyCVal2 = true;\n            if (dyC < 0.0 || dyC >= ${s}(outBackprop[2]) ||\n                fract(dyC) > 0.0) {\n              bDyCVal = false;\n            }\n            if (dyC2 < 0.0 || dyC2 >= ${s}(outBackprop[2]) ||\n                fract(dyC2) > 0.0) {\n              bDyCVal2 = false;\n            }\n\n            let idyC: u32 = u32(dyC);\n            let idyC2: u32 = u32(dyC2);\n            if (bDyCVal && bDyCVal2) {\n              let d2Length = outBackprop[3];\n              for (var d2 :u32 = 0; d2 < d2Length; d2 = d2 + 4) {\n                let wValue0 = ${b.get("u32(wRPerm)","u32(wCPerm)","d1","d2")};\n                let wValue1 = ${b.get("u32(wRPerm)","u32(wCPerm)","d1 + 1","d2")};\n                let wValue2 = ${b.get("u32(wRPerm)","u32(wCPerm)","d1 + 2","d2")};\n                let wValue3 = ${b.get("u32(wRPerm)","u32(wCPerm)","d1 + 3","d2")};\n\n                var xValue = ${x.get("batch","idyR","idyC","d2")};\n                let tmpval = vec4<${s}>(dot(xValue, wValue0),\n                                      dot(xValue, wValue1),\n                                      dot(xValue, wValue2),\n                                      dot(xValue, wValue3));\n                dotProd[0] = dotProd[0] + tmpval;\n\n                xValue =  ${x.get("batch","idyR","idyC2","d2")};\n\n                dotProd[1] = dotProd[1] + vec4<${s}>(dot(xValue, wValue0),\n                                                    dot(xValue, wValue1),\n                                                    dot(xValue, wValue2),\n                                                    dot(xValue, wValue3));\n              }\n            } else if (bDyCVal) {\n              let d2Length = outBackprop[${c}];\n              for (var d2: u32 = 0; d2 < d2Length; d2 = d2 + 4) {\n                let wValue0 = ${b.get("u32(wRPerm)","u32(wCPerm)","d1","d2")};\n                let wValue1 = ${b.get("u32(wRPerm)","u32(wCPerm)","d1 + 1","d2")};\n                let wValue2 = ${b.get("u32(wRPerm)","u32(wCPerm)","d1 + 2","d2")};\n                let wValue3 = ${b.get("u32(wRPerm)","u32(wCPerm)","d1 + 3","d2")};\n\n                var xValue = ${x.get("batch","idyR","idyC","d2")};\n                let tmpval = vec4<${s}>(dot(xValue, wValue0),\n                                      dot(xValue, wValue1),\n                                      dot(xValue, wValue2),\n                                      dot(xValue, wValue3));\n                dotProd[0] = dotProd[0] + tmpval;\n              }\n            } else if (bDyCVal2) {\n              let d2Length = outBackprop[3];\n              for (var d2: u32 = 0; d2 < d2Length; d2 = d2 + 4) {\n                let wValue0 = ${b.get("u32(wRPerm)","u32(wCPerm)","d1","d2")};\n                let wValue1 = ${b.get("u32(wRPerm)","u32(wCPerm)","d1 + 1","d2")};\n                let wValue2 = ${b.get("u32(wRPerm)","u32(wCPerm)","d1 + 2","d2")};\n                let wValue3 = ${b.get("u32(wRPerm)","u32(wCPerm)","d1 + 3","d2")};\n\n                var xValue = ${x.get("batch","idyR","idyC2","d2")};\n                let tmpval = vec4<${s}>(dot(xValue, wValue0),\n                                      dot(xValue, wValue1),\n                                      dot(xValue, wValue2),\n                                      dot(xValue, wValue3));\n                dotProd[1] = dotProd[1] + tmpval;\n              }\n            }\n          }\n        }\n\n        for (var i: u32 = 0; i < ${d}; i = i + 1) {\n          let value = dotProd[i] + ${i?"bias[c+i]":`vec4<${s}>(0.0)`};\n          ${S.set("batch","r","c + i","d1","value")};\n        }\n      }`,E=`\n          let outputIndices = ${S.offsetToIndices("global_idx")};\n          let batch = ${S.indicesGet("outputIndices",0)};\n          let d1 = ${S.indicesGet("outputIndices",c)};\n          let r = ${S.indicesGet("outputIndices",l)};\n          let c = ${S.indicesGet("outputIndices",h)};\n          let dyCorner = vec2<i32>(i32(r), i32(c)) - pads;\n          let dyRCorner = dyCorner.x;\n          let dyCCorner = dyCorner.y;\n          let groupId = d1 / ${g};\n          let wOutChannel = d1 - groupId * ${g};\n          // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).\n          // ? = to be determined. : = across all values in that axis.\n          var dotProd = ${s}(0.0);\n          for (var wR: u32 = 0; wR < effectiveFilterDims.x; wR = wR + 1) {\n            if (wR % dilations.x != 0) {\n              continue;\n            }\n            let dyR = (${s}(dyRCorner) + ${s}(wR)) / ${s}(strides[0]);\n            let wRPerm = filterDims.x - 1 - wR / dilations.x;\n            if (dyR < 0.0 || dyR >= ${s}(outBackprop[${l}]) || fract(dyR) > 0.0 ||\n                wRPerm < 0) {\n              continue;\n            }\n            let idyR: u32 = u32(dyR);\n\n            for (var wC: u32 = 0; wC < effectiveFilterDims.y; wC = wC + 1) {\n              if (wC % dilations.y != 0) {\n                continue;\n              }\n              let dyC = (${s}(dyCCorner) + ${s}(wC)) / ${s}(strides.y);\n              let wCPerm = filterDims.y - 1 - wC / dilations.y;\n              if (dyC < 0.0 || dyC >= ${s}(outBackprop[${h}]) ||\n                  fract(dyC) > 0.0 || wCPerm < 0) {\n                continue;\n              }\n              let idyC: u32 = u32(dyC);\n              var inputChannel = groupId * ${m};\n              for (var d2: u32 = 0; d2 < ${m}; d2 = d2 + 1) {\n                let xValue = ${u?x.get("batch","idyR","idyC","inputChannel"):x.get("batch","inputChannel","idyR","idyC")};\n                let wValue = ${b.get("inputChannel","wOutChannel","u32(wRPerm)","u32(wCPerm)")};\n                dotProd = dotProd + xValue * wValue;\n                inputChannel = inputChannel + 1;\n              }\n            }\n          }\n          let value = dotProd + ${i?"bias[d1]":`${s}(0.0)`};\n          ${S.setByOffset("global_idx","value")};\n        `;return`\n  ${e.declareVariables(..._,S)}\n  ${w}\n  const outShape : vec4<u32> = vec4<u32>(${n.join(",")});\n  const outBackprop : vec4<u32> = vec4<u32>(${t[0].dims.join(",")});\n  const strides : vec2<u32> = vec2<u32>(${r.strides[0]}, ${r.strides[1]});\n  const filterDims : vec2<u32> = vec2<u32>(${r.kernelShape[u?1:2]}, ${r.kernelShape[u?2:3]});\n  const dilations : vec2<u32> = vec2<u32>(${r.dilations[0]}, ${r.dilations[1]});\n  const effectiveFilterDims : vec2<u32> = filterDims + vec2<u32>(\n          ${r.dilations[0]<=1?0:(r.kernelShape[u?1:2]-1)*(r.dilations[0]-1)},\n          ${r.dilations[1]<=1?0:(r.kernelShape[u?2:3]-1)*(r.dilations[1]-1)});\n  const pads : vec2<i32> = vec2<i32>(i32(effectiveFilterDims[0]) - 1 - (${r.pads[0]+r.pads[2]})/2,\n                                     i32(effectiveFilterDims[1]) - 1 - (${r.pads[1]+r.pads[3]})/2);\n    ${e.mainStart()}\n    ${e.guardAgainstOutOfBoundsWorkgroupSizes(f)};\n  ${a?T:E}}`},ua=(e,t,r)=>{let n=e.length>2,i=t.outputShape,o=Ur.size(i),a=[Math.ceil(o/64),1,1];Or("verbose",(()=>`[conv2d_backprop_webgpu] dispatch = ${a}`));let s=Hr(e[0].dataType);return{name:"ConvTranspose2D",shaderCache:{hint:t.cacheKey},getRunData:()=>({dispatchGroup:{x:a[0],y:a[1],z:a[2]},outputs:[{dims:r?r(i):i,dataType:e[0].dataType}]}),getShaderSource:r=>sa(r,e,t,i,n,1===a[1]&&1===a[2],!1,s)}}})),Sl=st((()=>{Qu(),xl(),_l(),dl(),rl(),la=(e,t,r,n,i,o)=>(e-1)*t+r+(n-1)*i+1-o,ha=(e,t,r,n,i)=>{let o=Math.floor(e/2);"SAME_UPPER"===t?(r[n]=o,r[i]=e-o):"SAME_LOWER"===t&&(r[n]=e-o,r[i]=o)},ca=(e,t,r,n,i,o,a,s,u,l)=>{let h=e.length-2,c=0===l.length;if(0===u.length)for(let e=0;e<h;++e)u.push(0);let f=e[0],d=t[s?3:1]*i;for(let i=0,f=e.length-h-(s?1:0);i<h;++i,++f){let s=e[f],d=c?s*a[i]:l[i],p=la(s,a[i],o[i],t[f],r[i],d);ha(p,n,o,i,i+h),c&&l.push(a[i]*(s-1)+u[i]+(t[f]-1)*r[i]+1-o[i]-o[i+h])}l.splice(0,0,f),l.splice(s?3:1,0,d)},fa=(e,t)=>{let r=e.kernelShape.slice();if(0===e.kernelShape.length||0===e.kernelShape.reduce(((e,t)=>e*t),1)){r.length=0;for(let e=2;e<t[1].dims.length;++e)r.push(t[1].dims[e])}let n="NHWC"===e.format;r.splice(0,0,t[1].dims[0]),r.splice(n?3:1,0,t[1].dims[1]);let i=e.pads.slice(),o=e.outputShape.slice(),a=e.outputPadding.slice(),s=t[0].dims,u=e.dilations.slice();if(0===u.reduce(((e,t)=>e+t),0)){let e=t[0].dims.length-2;u=new Array(e).fill(1)}let l=e.strides.slice();if(0===l.reduce(((e,t)=>e+t),0)){let e=t[0].dims.length-2;l=new Array(e).fill(1)}ca(s,r,u,e.autoPad,e.group,i,l,n,a,o);let h=Object.assign({},e),c=e.cacheKey+[r.join("n,"),i.join(","),l.join(","),a.join(","),o.join(","),u.join(",")].join("_");return Object.assign(h,{kernelShape:r,pads:i,outputPadding:a,outputShape:o,dilations:u,strides:l,cacheKey:c}),h},da=e=>{let t=Ro(e),r=e.format,n=["NOTSET","VALID","SAME_UPPER","SAME_LOWER"][typeof e.autoPad>"u"?0:e.autoPad],i=e.dilations,o=e.group,a=e.kernelShape,s=e.pads,u=e.strides,l=e.wIsConst(),h=e.outputPadding,c=e.outputShape;return Br({autoPad:n,format:r,dilations:i,group:o,kernelShape:a,outputPadding:h,outputShape:c,pads:s,strides:u,wIsConst:l,...t})},pa=(e,t)=>{if(!e||2!==e.length&&3!==e.length)throw new Error("Conv requires 2 or 3 inputs");if(4!==e[0].dims.length&&3!==e[0].dims.length)throw new Error("currently only support 2-dimensional conv");if(e[0].dims.length!==e[1].dims.length)throw new Error("filter does not have same dimension as input");if(e[0].dims["NHWC"===t.format?e[0].dims.length-1:1]!==e[1].dims[0])throw new Error("FILTER_IN_CHANNEL should be equal to DATA_CHANNEL");let r=e[1].dims[1]*t.group;if(3===e.length&&(1!==e[2].dims.length||e[2].dims[0]!==r))throw new Error("invalid bias");let n=e[0].dims.length-2;if(t.dilations.reduce(((e,t)=>e+t),0)>0&&t.dilations.length!==n)throw new Error(`dilations should be ${n}D`);if(t.strides.reduce(((e,t)=>e+t),0)>0&&t.strides.length!==n)throw new Error(`strides should be ${n}D`);if(t.pads.reduce(((e,t)=>e+t),0)>0&&t.pads.length!==2*n)throw new Error(`pads should be ${2*n}D`);if(t.outputPadding.length!==n&&0!==t.outputPadding.length)throw new Error(`output_padding should be ${n}D`);if(t.kernelShape.reduce(((e,t)=>e+t),0)>0&&0!==t.kernelShape.length&&t.kernelShape.length!==e[1].dims.length-2)throw new Error("invalid kernel shape");if(0!==t.outputShape.length&&t.outputShape.length!==e[0].dims.length-2)throw new Error("invalid output shape")},ya=[2,3,1,0],ma=(e,t,r)=>{let n=fa(r,t),i="NHWC"===r.format,o=n.outputShape,a=o[i?3:1],s=t[0].dims[i?3:1];if(1!==n.group||1===a&&1===s)return void e.compute(ua(t,n));let u=o[i?1:2],l=o[i?2:3],h=i?u*l:a,c=i?a:u*l,f=t[1].dims[2]*t[1].dims[3]*s,d=e.kernelCustomData.wT??e.compute(dn(t[1],ya),{inputs:[1],outputs:[r.wIsConst?-2:-1]})[0];r.wIsConst&&!e.kernelCustomData.wT&&(e.kernelCustomData.wT=d);let p=[t[0],d],y=3===t.length;y&&(i||1!==t[2].dims.length?p.push(t[2]):p.push(t[2].reshape([t[2].dims[0],1,1]))),e.compute(aa(p,n,o,h,c,f,y,!0),{inputs:p})},ga=(e,t)=>{let r="NHWC"===t.format,n=[e.inputs[0].reshape(r?[e.inputs[0].dims[0],1,e.inputs[0].dims[1],e.inputs[0].dims[2]]:[e.inputs[0].dims[0],e.inputs[0].dims[1],1,e.inputs[0].dims[2]]),e.inputs[1].reshape([e.inputs[1].dims[0],e.inputs[1].dims[1],1,e.inputs[1].dims[2]])];3===n.length&&n.push(e.inputs[2]);let i=t.kernelShape;(0===i.length||0===i[0])&&(i=[e.inputs[1].dims[2]]);let o=t.dilations;(0===o.length||0===o[0])&&(o=[1]);let a=t.strides;(0===a.length||0===a[0])&&(a=[1]);let s=t.pads;0===s.length&&(s=[0,0]),s=[0,s[0],0,s[1]],a=[1].concat(a),o=[1].concat(o),i=[1].concat(i);let u=fa({...t,pads:s,strides:a,dilations:o,kernelShape:i},n);e.compute(ua(n,u,(e=>r?[e[0],e[2],e[3]]:[e[0],e[1],e[3]])))},wa=(e,t)=>{pa(e.inputs,t),3===e.inputs[0].dims.length?ga(e,t):ma(e,e.inputs,t)}})),Tl=st((()=>{qu(),el(),Qu(),tl(),va=(e,t,r,n)=>{let i=Ur.size(t),o=t.length,a=tn("input",e,o),s=rn("output",e,o),u=6===r.dataType?r.getInt32Array()[0]:Number(r.getBigInt64Array()[0]),l=Ur.normalizeAxis(u,o);return{name:"CumSum",shaderCache:{hint:n.cacheKey,inputDependencies:["rank"]},getRunData:()=>({outputs:[{dims:t,dataType:e}],dispatchGroup:{x:Math.ceil(i/64)},programUniforms:[{type:"uint32",data:i},{type:"int32",data:l},...Yr(t),...Yr(t)]}),getShaderSource:e=>{let t=` i32(${a.indicesGet("inputIndices","uniforms.axis")}) `,r=Qr("uniforms.input_shape","uniforms.axis",o),i=n.reverse?t+(n.exclusive?" + 1":""):"0",u=n.reverse?r:t+(n.exclusive?"":" + 1");return`\n                ${e.registerUniform("outputSize","u32").registerUniform("axis","u32").declareVariables(a,s)}\n                ${e.mainStart()}\n                  ${e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}\n                  var inputIndices = ${s.offsetToIndices("global_idx")};\n                  var sum = ${s.type.value}(0);\n                  let first : i32 = ${i};\n                  let last : i32 = ${u};\n                  for (var i : i32 = first; i < last; i++) {\n                    ${a.indicesSet("inputIndices","uniforms.axis","u32(i)")};\n                    sum = sum + ${a.getByIndices("inputIndices")};\n                  }\n                  ${s.setByOffset("global_idx","sum")};\n                }`}}},ba=(e,t)=>{let r=e.inputs[0].dims,n=e.inputs[0].dataType,i=e.inputs[1];e.compute(va(n,r,i,t),{inputs:[0]})},xa=e=>{let t=1===e.exclusive,r=1===e.reverse;return Br({exclusive:t,reverse:r})}})),El=st((()=>{el(),Qu(),tl(),Ta="^"+(Sa="("+(_a="[a-zA-Z]|\\.\\.\\.")+")+")+"$",Ea="^"+("("+Sa+",)*"+Sa)+"$",Oa=class{constructor(e=-1){this.symbolToIndices=new Map,this.inputIndex=e}addSymbol(e,t){let r=this.symbolToIndices.get(e);void 0===r?r=[t]:r.push(t),this.symbolToIndices.set(e,r)}},Aa=class{constructor(e,t){this.equation=t,this.hasEllipsis=!1,this.symbolToInfo=new Map,this.lhs=new Array,this.outputDims=[];let[r,n]=t.includes("->")?t.split("->",2):[t,""];if(!r.match(RegExp(Ea)))throw new Error("Invalid LHS term");if(r.split(",").forEach(((t,r)=>{let n=e[r].dims.slice();if(!t.match(RegExp(Ta)))throw new Error("Invalid LHS term");let i=this.processTerm(t,!0,n,r);this.lhs.push(i)})),""===n)n+=[...this.symbolToInfo.entries()].filter((([e,t])=>1===t.count||"..."===e)).map((([e])=>e)).join("");else if(!n.match(RegExp(Sa)))throw new Error("Invalid RHS");n.match(RegExp(_a,"g"))?.forEach((e=>{if("..."===e)this.outputDims=this.outputDims.concat(this.ellipsisDims);else{let t=this.symbolToInfo.get(e);if(void 0===t)throw new Error("Invalid RHS symbol");this.outputDims.push(t.dimValue)}})),this.rhs=this.processTerm(n,!1,this.outputDims)}addSymbol(e,t,r){let n=this.symbolToInfo.get(e);if(void 0!==n){if(n.dimValue!==t&&1!==n.count)throw new Error("Dimension mismatch");n.count++,n.inputIndices.push(r)}else n={count:1,dimValue:t,inputIndices:[r]};this.symbolToInfo.set(e,n)}processTerm(e,t,r,n=-1){let i=r.length,o=!1,a=[],s=0;if(!e.match(RegExp(Ta))&&!t&&""!==e)throw new Error("Invalid LHS term");let u=e.match(RegExp(_a,"g")),l=new Oa(n);return u?.forEach(((e,h)=>{if("..."===e){if(o)throw new Error("Only one ellipsis is allowed per input term");o=!0;let e=i-u.length+1;if(e<0)throw new Error("Ellipsis out of bounds");if(a=r.slice(s,s+e),this.hasEllipsis){if(this.ellipsisDims.length!==a.length||this.ellipsisDims.toString()!==a.toString())throw new Error("Ellipsis dimensions mismatch")}else{if(!t)throw new Error("Ellipsis must be specified in the LHS");this.hasEllipsis=!0,this.ellipsisDims=a}for(let e=0;e<a.length;e++){let t=String.fromCharCode("0".charCodeAt(0)+e);l.addSymbol(t,h+e),this.addSymbol(t,r[s++],n)}}else l.addSymbol(e,h+(this.hasEllipsis?this.ellipsisDims.length-1:0)),this.addSymbol(e,r[s++],n)})),l}},Ia=e=>e+"_max",Pa=(e,t,r,n,i)=>{let o=t.map(((t,r)=>e[r]?t.length:t)).map(((e,t)=>tn(`input${t}`,r,e))),a=Ur.size(i),s=un(i.length),u=s?i.length:i,l=rn("output",r,u),h=[...n.symbolToInfo.keys()].filter((e=>!n.rhs.symbolToIndices.has(e)));return{name:"Einsum",shaderCache:{hint:n.equation,inputDependencies:e.map((e=>e?"rank":"dims"))},getRunData:()=>{let o=h.filter((e=>n.symbolToInfo.has(e))).map((e=>({type:"uint32",data:n.symbolToInfo.get(e)?.dimValue||0})));o.push({type:"uint32",data:a});let u=t.filter(((t,r)=>e[r])).map(((e,t)=>[...Yr(e)])).reduce(((e,t)=>e.concat(t)),o);return s&&u.push(...Yr(i)),{outputs:[{dims:i,dataType:r}],dispatchGroup:{x:Math.ceil(a/64)},programUniforms:u}},getShaderSource:e=>{let t=[],r=[],i=[],a=[],s=[],u=n.symbolToInfo.size===n.rhs.symbolToIndices.size;n.symbolToInfo.forEach(((e,u)=>{if(n.rhs.symbolToIndices.has(u)){let r=n.rhs.symbolToIndices.get(u)?.[0];void 0!==r&&n.lhs.forEach(((n,i)=>{if(e.inputIndices.includes(i)){let e=n.symbolToIndices.get(u);if(void 0===e)throw new Error("Invalid symbol error");e.forEach((e=>{t.push(`${o[i].indicesSet(`input${i}Indices`,e,l.indicesGet("outputIndices",r))}`)}))}}))}else n.lhs.forEach(((t,n)=>{if(e.inputIndices.includes(n)){let e=t.symbolToIndices.get(u);if(void 0===e)throw new Error("Invalid symbol error");e.forEach((e=>{r.push(`${o[n].indicesSet(`input${n}Indices`,e,`${u}`)}`)})),s.push(`prod *= ${o[n].getByIndices(`input${n}Indices`)};`)}})),i.push(`for(var ${u}: u32 = 0; ${u} < uniforms.${Ia(u)}; ${u}++) {`),a.push("}")}));let c=u?[...t,`let sum = ${o.map(((e,t)=>e.getByIndices(`input${t}Indices`))).join(" * ")};`]:[...t,"var sum = 0.0;",...i,...r,"var prod = 1.0;",...s,"sum += prod;",...a];return`\n            ${e.registerUniforms(h.map((e=>({name:`${Ia(e)}`,type:"u32"})))).registerUniform("outputSize","u32").declareVariables(...o,l)}\n\n            ${e.mainStart()}\n            ${e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}\n            var outputIndices = ${l.offsetToIndices("global_idx")};\n            ${o.map(((e,t)=>`var input${t}Indices: ${o[t].type.indices};`)).join("\n")}\n            ${c.join("\n")};\n            ${l.setByOffset("global_idx","sum")};\n          }`}}},ka=(e,t)=>{let r=new Aa(e.inputs,t.equation),n=e.inputs.map(((e,t)=>un(e.dims.length))),i=r.outputDims,o=e.inputs.map(((e,t)=>e.dims));e.compute(Pa(n,o,e.inputs[0].dataType,r,i))},Ca=e=>{let t=e.equation.replace(/\s+/g,"");return Br({equation:t})}})),Ol=st((()=>{qu(),el(),tl(),$a=e=>{if(!e||2!==e.length)throw new Error("Expand requires 2 input.");let t=e[0].dims,r=Array.from(e[1].getBigInt64Array(),Number),n=r.length<t.length?0:r.length-t.length,i=t.length<r.length?0:t.length-r.length;for(;n<r.length&&i<t.length;++n,++i)if(r[n]!==t[i]&&1!==r[n]&&1!==t[i])throw new Error("Expand requires shape to be broadcastable to input")},Ra=(e,t)=>{let r=e.length-t.length,n=[];for(let t=0;t<r;++t)n.push(e[t]);for(let i=0;i<t.length;++i)n.push(1===t[i]?e[i+r]:t[i]);return n},Da=(e,t)=>e.length>t.length?Ra(e,t):Ra(t,e),Ma=e=>{let t=e[0].dims,r=Array.from(e[1].getBigInt64Array(),Number),n=Da(t,r),i=e[0].dataType,o=9===i?4:1,a=Math.ceil(Ur.size(n)/o),s=un(t.length),u=un(n.length),l=[{type:"uint32",data:a}];return s&&l.push(...Yr(t)),u&&l.push(...Yr(n)),{name:"Expand",shaderCache:{hint:`${n.length}`,inputDependencies:[s?"rank":"dims"]},getShaderSource:e=>{let r,a=s?t.length:t,l=u?n.length:n,h=tn("input",i,a,o),c=rn("output",i,l,o);if(9===i){let e=(e,t,r="")=>`\n          let outputIndices${t} = ${c.offsetToIndices(`outputOffset + ${t}u`)};\n          let offset${t} = ${h.broadcastedIndicesToOffset(`outputIndices${t}`,c)};\n          let index${t} = offset${t} / 4u;\n          let component${t} = offset${t} % 4u;\n          ${e}[${t}] = ${r}(${h.getByOffset(`index${t}`)}[component${t}]);\n        `;r=`\n        let outputOffset = global_idx * ${o};\n        var data = vec4<u32>(0);\n        ${e("data",0,"u32")}\n        ${e("data",1,"u32")}\n        ${e("data",2,"u32")}\n        ${e("data",3,"u32")}\n        ${c.setByOffset("global_idx","data")}\n      }`}else r=`\n        let outputIndices = ${c.offsetToIndices("global_idx")};\n        let inputOffset = ${h.broadcastedIndicesToOffset("outputIndices",c)};\n        ${c.setByOffset("global_idx",h.getByOffset("inputOffset"))}\n      }`;return`\n    ${e.registerUniform("vec_size","u32").declareVariables(h,c)}\n    ${e.mainStart()}\n    ${e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.vec_size")}\n    ${r}`},getRunData:()=>({outputs:[{dims:n,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(a/64)},programUniforms:l})}},La=e=>{$a(e.inputs),e.compute(Ma(e.inputs),{inputs:[0]})}})),Al=st((()=>{qu(),el(),Qu(),tl(),Ba=e=>{if(!e||2!==e.length)throw new Error("Gather requires 2 inputs.")},Na=(e,t)=>{let r=e[0].dims,n=e[1].dims,i=r.length,o=Ur.normalizeAxis(t.axis,i),a=r.slice(0);a.splice(o,1,...n);let s=r[o],u=9===e[0].dataType?4:1,l=Math.ceil(Ur.size(a)/u),h=un(e[0].dims.length),c=h?e[0].dims.length:e[0].dims,f=un(e[1].dims.length),d=f?e[1].dims.length:e[1].dims,p=un(a.length),y=p?a.length:a,m=[{type:"uint32",data:l},{type:"int32",data:s},{type:"uint32",data:o}];h&&m.push(...Yr(e[0].dims)),f&&m.push(...Yr(e[1].dims)),p&&m.push(...Yr(a));let g=[];g.push(h?"rank":"dims"),g.push(f?"rank":"dims");return{name:"Gather",shaderCache:{hint:t.cacheKey,inputDependencies:g},getRunData:()=>({outputs:[{dims:a,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(l/64)},programUniforms:m}),getShaderSource:t=>{let r,s=tn("data",e[0].dataType,c,u),l=tn("inputIndices",e[1].dataType,d),h=rn("output",e[0].dataType,y,u),f=e=>{let t=n.length,r=`var indicesIndices${e}  = ${l.type.indices}(0);`;for(let n=0;n<t;n++)r+=`${t>1?`indicesIndices${e}[${n}]`:`indicesIndices${e}`} = ${a.length>1?`outputIndices${e}[uniforms.axis + ${n}]`:`outputIndices${e}`};`;r+=`\n          var idx${e} = ${l.getByIndices(`indicesIndices${e}`)};\n          if (idx${e} < 0) {\n            idx${e} = idx${e} + uniforms.axisDimLimit;\n          }\n          var dataIndices${e} = ${s.type.indices}(0);\n        `;for(let n=0,s=0;n<i;n++)n===o?(r+=`${i>1?`dataIndices${e}[${n}]`:`dataIndices${e}`} = u32(idx${e});`,s+=t):(r+=`${i>1?`dataIndices${e}[${n}]`:`dataIndices${e}`} = ${a.length>1?`outputIndices${e}[${s}]`:`outputIndices${e}`};`,s++);return r};if(9===e[0].dataType){let e=(e,t,r="")=>`\n          let outputIndices${t} = ${h.offsetToIndices(`outputOffset + ${t}u`)};\n          ${f(t)};\n          let offset${t} = ${s.indicesToOffset(`dataIndices${t}`)};\n          let index${t} = offset${t} / 4u;\n          let component${t} = offset${t} % 4u;\n          ${e}[${t}] = ${r}(${s.getByOffset(`index${t}`)}[component${t}]);\n        `;r=`\n        let outputOffset = global_idx * ${u};\n        var value = vec4<u32>(0);\n        ${e("value",0,"u32")}\n        ${e("value",1,"u32")}\n        ${e("value",2,"u32")}\n        ${e("value",3,"u32")}\n        ${h.setByOffset("global_idx","value")}\n      `}else r=`\n      let outputIndices = ${h.offsetToIndices("global_idx")};\n      ${f("")};\n      let value = ${s.getByIndices("dataIndices")};\n      ${h.setByOffset("global_idx","value")};\n      `;return`\n      ${t.registerUniform("outputSize","u32").registerUniform("axisDimLimit","i32").registerUniform("axis","u32").declareVariables(s,l,h)}\n      ${t.mainStart()}\n        ${t.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}\n        ${r}\n      }`}}},Fa=e=>Br({axis:e.axis}),Ua=(e,t)=>{let r=e.inputs;Ba(r),e.compute(Na(e.inputs,t))}})),Il=st((()=>{el(),Qu(),tl(),ja=e=>{if(!e||2!==e.length)throw new Error("GatherElements requires 2 inputs.");if(e[0].dims.length<1)throw new Error("GatherElements requires that the data input be rank >= 1.");if(e[0].dims.length!==e[1].dims.length)throw new Error("GatherElements requires that the data input and\n                     indices input tensors be of same rank.")},za=(e,t)=>{let r=e[0].dims,n=e[0].dataType,i=r.length,o=e[1].dims,a=e[1].dataType,s=Ur.normalizeAxis(t.axis,i),u=r[s],l=o.slice(0),h=Ur.size(l),c=tn("input",n,i),f=tn("indicesInput",a,o.length),d=rn("output",n,l.length),p=[{type:"uint32",data:h},{type:"int32",data:u},{type:"uint32",data:s}];return p.push(...Yr(r)),p.push(...Yr(o)),p.push(...Yr(l)),{name:"GatherElements",shaderCache:{inputDependencies:["rank","rank"]},getRunData:()=>({outputs:[{dims:l,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(h/64)},programUniforms:p}),getShaderSource:e=>`\n      ${e.registerUniform("outputSize","u32").registerUniform("axisDimLimit","i32").registerUniform("axis","u32").declareVariables(c,f,d)}\n      ${e.mainStart()}\n      ${e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}\n\n      let outputIndices = ${d.offsetToIndices("global_idx")};\n\n      var idx = ${f.getByOffset("global_idx")};\n      if (idx < 0) {\n        idx = idx + uniforms.axisDimLimit;\n      }\n      var inputIndices = ${c.type.indices}(outputIndices);\n      ${c.indicesSet("inputIndices","uniforms.axis","u32(idx)")};\n      let value = ${c.getByIndices("inputIndices")};\n\n      ${d.setByOffset("global_idx","value")};\n  }`}},Ga=e=>Br({axis:e.axis}),Va=(e,t)=>{let r=e.inputs;ja(r),e.compute(za(e.inputs,t))}})),Pl=st((()=>{el(),tl(),Wa=e=>{if(!e)throw new Error("Input is missing");if(e.length<2||e.length>3)throw new Error("Invaid input number.");if(3===e.length&&e[2].dims.length>2)throw new Error("Invalid input shape of C");if(e[0].dataType!==e[1].dataType||3===e.length&&e[0].dataType!==e[2].dataType)throw new Error("Input types are mismatched")},Ha=(e,t)=>{let r=e[0].dims.slice(),n=e[1].dims.slice(),[i,o,a]=zr.getShapeOfGemmResult(r,t.transA,n,t.transB,3===e.length?e[2].dims:void 0),s=[i,o];if(!s)throw new Error("Can't use gemm on the given tensors");let u=Ur.size(s),l=[{type:"uint32",data:u},{type:"uint32",data:i},{type:"uint32",data:o},{type:"uint32",data:a},{type:"float32",data:t.alpha},{type:"float32",data:t.beta}],h=["type","type"];3===e.length&&(l.push(...Yr(e[2].dims)),h.push("rank")),l.push(...Yr(s));return{name:"Gemm",shaderCache:{hint:`${t.cacheKey}`,inputDependencies:h},getRunData:()=>({outputs:[{dims:s,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(u/64)},programUniforms:l}),getShaderSource:r=>{let n="";t.transA&&t.transB?n="value += a[k * uniforms.M + m] * b[n * uniforms.K + k];":t.transA&&!t.transB?n="value += a[k * uniforms.M + m] * b[k * uniforms.N + n];":!t.transA&&t.transB?n="value += a[m * uniforms.K + k] * b[n * uniforms.K + k];":!t.transA&&!t.transB&&(n="value += a[m * uniforms.K + k] * b[k * uniforms.N + n];");let i=1===t.alpha?"":"value *= uniforms.alpha;",o=tn("a",e[0].dataType,e[0].dims),a=tn("b",e[1].dataType,e[1].dims),u=o.type.value,l=null,h=[o,a];3===e.length&&(l=tn("c",e[2].dataType,e[2].dims.length),h.push(l));let c=rn("output",e[0].dataType,s.length);h.push(c);return`\n  ${r.registerUniforms([{name:"output_size",type:"u32"},{name:"M",type:"u32"},{name:"N",type:"u32"},{name:"K",type:"u32"},{name:"alpha",type:"f32"},{name:"beta",type:"f32"}]).declareVariables(...h)}\n\n  ${r.mainStart()}\n    ${r.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}\n\n    let m = global_idx / uniforms.N;\n    let n = global_idx % uniforms.N;\n\n    var value = ${u}(0);\n    for (var k: u32 = 0u; k < uniforms.K; k++) {\n      ${n}\n    }\n\n    ${i}\n    ${null!=l?`let cOffset = ${l.broadcastedIndicesToOffset("vec2(m, n)",c)}; value += ${u}(uniforms.beta) * ${l.getByOffset("cOffset")};`:""}\n    output[global_idx] = value;\n  }`}}},qa=e=>({transA:e.transA,transB:e.transB,alpha:e.alpha,beta:e.beta,cacheKey:`${e.transA};${e.transB};${1===e.alpha}`}),Ya=(e,t)=>{Wa(e.inputs),e.compute(Ha(e.inputs,t))}})),kl=st((()=>{qu(),el(),tl(),Xa=(e,t)=>{let r=e[0].dims,n=r,i=Ur.sizeToDimension(r,2),o=Ur.sizeFromDimension(r,2),a=Xr(o),s=o/a,u=[r[0],r[1],s],l=[{type:"uint32",data:o},{type:"uint32",data:s}];l.push(...Yr(u),...Yr(u));return{name:"InstanceNormalization",shaderCache:{hint:`${t.epsilon};${a}`,inputDependencies:["rank","type","type"]},getRunData:()=>({outputs:[{dims:n,dataType:e[0].dataType}],dispatchGroup:{x:i},programUniforms:l}),getShaderSource:r=>{let n=tn("x",e[0].dataType,u.length,a),i=tn("scale",e[1].dataType,e[1].dims),o=tn("bias",e[2].dataType,e[2].dims),s=rn("output",e[0].dataType,u.length,a),l=[n,i,o,s],h=n.type.value,c=1===a?"f32":`vec${a}<f32>`;return`\n  var<workgroup> meanShared : f32;\n  var<workgroup> squaredNormShared : f32;\n  var<workgroup> workgroupShared : array<${c}, 64>;\n  const workgroupSize = 64u;\n  ${r.registerUniforms([{name:"normSize",type:"u32"},{name:"normPackedSize",type:"u32"}]).declareVariables(...l)}\n  ${r.mainStart(64)}\n    let norm = global_idx / workgroupSize;\n    let batch = norm / uniforms.x_shape[1];\n    let channel = norm % uniforms.x_shape[1];\n    let localIndex = local_id.x;\n\n    // initialize workgroup memory\n    var initial = ${c}(0);\n    for (var h = localIndex; h < uniforms.normPackedSize; h += workgroupSize) {\n      initial = initial + ${c}(${n.get("batch","channel","h")});\n    }\n    workgroupShared[localIndex] = initial;\n    workgroupBarrier();\n\n    // Calculate the mean of current channel data.\n    for (var currSize = workgroupSize >> 1;  currSize > 0; currSize = currSize >> 1) {\n      if (localIndex < currSize) {\n        workgroupShared[localIndex] = workgroupShared[localIndex] + workgroupShared[localIndex + currSize];\n      }\n      workgroupBarrier();\n    }\n    if (localIndex == 0) {\n      meanShared = ${Jr("workgroupShared[0]",a)} / f32(uniforms.normSize);\n    }\n    workgroupBarrier();\n\n    // reinitialize workgroup memory.\n    initial = ${c}(0);\n    for (var h = localIndex; h < uniforms.normPackedSize; h += workgroupSize) {\n      let deviation =  ${c}(${n.get("batch","channel","h")}) - ${c}(meanShared);\n      initial = initial + deviation * deviation;\n    }\n    workgroupShared[localIndex] = initial;\n    workgroupBarrier();\n\n    // Calculate the sum of square of deviation of current channel data.\n    for (var currSize = workgroupSize >> 1;  currSize > 0; currSize = currSize >> 1) {\n      if (localIndex < currSize) {\n        workgroupShared[localIndex] = workgroupShared[localIndex] + workgroupShared[localIndex + currSize];\n      }\n      workgroupBarrier();\n    }\n    if (localIndex == 0) {\n      squaredNormShared = ${Jr("workgroupShared[0]",a)};\n    }\n    workgroupBarrier();\n\n    let invStdDev = inverseSqrt(squaredNormShared / f32(uniforms.normSize) + f32(${t.epsilon}));\n    let channelScale = invStdDev * f32(${i.getByOffset("channel")});\n    let channelShift = f32(${o.getByOffset("channel")}) - meanShared * channelScale;\n    for (var h = localIndex; h < uniforms.normPackedSize; h += workgroupSize) {\n      let value = ${n.get("batch","channel","h")} * ${h}(${c}(channelScale)) + ${h}(${c}(channelShift));\n      ${s.set("batch","channel","h","value")};\n    }\n  }`}}},Ka=(e,t,r,n,i,o,a,s)=>{let u=Xr(a),l=64,h=1===u?"vec2f":`mat2x${u}f`,c=1===u?"f32":`vec${u}f`,f=(e,t)=>`${h}(${e}, ${t})`,d=i*a/u,p=[{type:"uint32",data:Math.ceil(o/l)},{type:"uint32",data:o},{type:"uint32",data:Math.floor(a/u)},{type:"uint32",data:Math.floor(o*a/u)}],y=e.compute({name:"InstanceNormComputeMean",shaderCache:{hint:`${u}`,inputDependencies:["type"]},getRunData:()=>({outputs:[{dims:[i,a,l,2],dataType:1}],dispatchGroup:{x:i*a/u},programUniforms:p}),getShaderSource:e=>{let r=tn("input",t.dataType,t.dims,u);return`\n  ${e.declareVariables(r)}\n  @group(0) @binding(1) var<storage, read_write> output : array<${h}>;\n  struct Uniforms {wg_size:u32, H:u32, C:u32, image_size:u32};\n  @group(0) @binding(2) var<uniform> uniforms: Uniforms;\n\n  ${e.mainStart(l)}\n    let currentImageNumber = global_idx / 64 / uniforms.C;\n    let currentChannelNumber = (global_idx / 64) % uniforms.C;\n    let wgId = global_idx % 64;\n    let wgOffset = wgId * uniforms.wg_size;\n    if (wgOffset >= uniforms.H) {\n        return;\n    }\n    let wgMax = min(wgOffset + uniforms.wg_size, uniforms.H);\n\n    let offset = currentImageNumber * uniforms.image_size + currentChannelNumber;\n    var sum = ${Kr("f32",u)};\n    var squaredSum = ${Kr("f32",u)};\n    for (var i: u32 = wgOffset; i < wgMax; i++) {\n        let value = ${c}(input[offset + i * uniforms.C]);\n        sum += value;\n        squaredSum += value * value;\n    }\n    output[global_idx] = ${f("sum","squaredSum")};\n  }`}},{inputs:[t],outputs:[-1]})[0],m=[{type:"uint32",data:d},{type:"uint32",data:o},{type:"uint32",data:Math.floor(a/u)},{type:"uint32",data:Math.floor(l*a/u)}];return e.compute({name:"InstanceNormComputeChannelScaleShift",shaderCache:{hint:`${u};${s}`,inputDependencies:["type","type","type"]},getRunData:()=>({outputs:[{dims:[i,a,2],dataType:1}],dispatchGroup:{x:Math.ceil(d/64)},programUniforms:m}),getShaderSource:e=>{let t=tn("scale",r.dataType,r.dims,u),i=tn("bias",n.dataType,n.dims,u);return`\n  @group(0) @binding(0) var<storage, read> input : array<${h}>;\n  @group(0) @binding(1) var<storage, read> scale : array<${t.type.storage}>;\n  @group(0) @binding(2) var<storage, read> bias : array<${i.type.storage}>;\n  @group(0) @binding(3) var<storage, read_write> output : array<${h}>;\n  struct Uniforms {units_of_work : u32, H: u32, C : u32, image_size : u32};\n  @group(0) @binding(4) var<uniform> uniforms: Uniforms;\n\n  ${e.mainStart()}\n    ${e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.units_of_work")}\n    let currentImageNumber = global_idx / uniforms.C;\n    let currentChannelNumber = global_idx % uniforms.C;\n\n    let offset = currentImageNumber * uniforms.image_size;\n    var sum = ${Kr("f32",u)};\n    var squaredSum = ${Kr("f32",u)};\n    for (var i: u32 = 0; i < 64; i++) {\n        let value = input[offset + i + currentChannelNumber * 64];\n        sum += value[0];\n        squaredSum += value[1];\n    }\n    sum = sum / f32(uniforms.H);\n    squaredSum = squaredSum / f32(uniforms.H);\n    let invStdDev = inverseSqrt(squaredSum - sum * sum + f32(${s}));\n    let channelScale = invStdDev * ${c}(scale[currentChannelNumber]);\n    let channelShift = ${c}(bias[currentChannelNumber]) - sum * channelScale;\n\n    output[global_idx] = ${f("channelScale","channelShift")};\n  }`}},{inputs:[y,r,n],outputs:[-1]})[0]},Za=(e,t,r)=>{let n=t[0].dims,i=n,o=n[0],a=n[n.length-1],s=Ur.sizeFromDimension(n,1)/a,u=Xr(a),l=Ur.size(i)/u,h=[{type:"uint32",data:s},{type:"uint32",data:Math.floor(a/u)}],c=Ka(e,t[0],t[1],t[2],o,s,a,r.epsilon);e.compute({name:"InstanceNormalizationNHWC",shaderCache:{hint:`${u}`,inputDependencies:["type","type"]},getRunData:()=>({outputs:[{dims:i,dataType:t[0].dataType}],dispatchGroup:{x:Math.ceil(l/64)},programUniforms:h}),getShaderSource:e=>{let r=Hr(t[0].dataType),n=1===u?"vec2f":`mat2x${u}f`,o=1===u?r:`vec${u}<${r}>`,a=tn("input",t[0].dataType,t[0].dims,u),s=rn("output",t[0].dataType,i,u);return`\n  @group(0) @binding(0) var<storage, read> input : array<${a.type.storage}>;\n  @group(0) @binding(1) var<storage, read> scaleInput : array<${n}>;\n  @group(0) @binding(2) var<storage, read_write> output : array<${s.type.storage}>;\n  struct Uniforms {H: u32, C : u32};\n  @group(0) @binding(3) var<uniform> uniforms: Uniforms;\n\n  ${e.mainStart()}\n    let currentImageNumber = global_idx / (uniforms.C * uniforms.H);\n    let currentChannelNumber = global_idx % uniforms.C;\n\n    let scaleOffset = currentImageNumber * uniforms.C + currentChannelNumber;\n    let scale = scaleInput[scaleOffset];\n    output[global_idx] = fma(input[global_idx], ${o}(scale[0]), ${o}(scale[1]));\n  }`}},{inputs:[t[0],c]})},Ja=(e,t)=>{"NHWC"===t.format?Za(e,e.inputs,t):e.compute(Xa(e.inputs,t))}})),Cl=st((()=>{qu(),el(),tl(),Qa=e=>{if(!e||e.length<2)throw new Error("layerNorm requires at least 2 inputs.")},es=(e,t,r)=>{let n=e[0].dims,i=e[1],o=e[2],a=n,s=Ur.normalizeAxis(t.axis,n.length),u=Ur.sizeToDimension(n,s),l=Ur.sizeFromDimension(n,s),h=Ur.size(i.dims),c=o?Ur.size(o.dims):0;if(h!==l||o&&c!==l)throw new Error(`Size of X.shape()[axis:] == ${l}.\n       Size of scale and bias (if provided) must match this.\n       Got scale size of ${h} and bias size of ${c}`);let f=[];for(let e=0;e<n.length;++e)e<s?f.push(n[e]):f.push(1);let d=Xr(l),p=["type","type"],y=[{type:"uint32",data:u},{type:"float32",data:l},{type:"uint32",data:Math.floor(l/d)},{type:"float32",data:t.epsilon}];o&&p.push("type");let m=r>1,g=r>2,w=[{dims:a,dataType:e[0].dataType}];return m&&w.push({dims:f,dataType:1}),g&&w.push({dims:f,dataType:1}),{name:"LayerNormalization",shaderCache:{hint:`${d};${r}`,inputDependencies:p},getRunData:()=>({outputs:w,dispatchGroup:{x:Math.ceil(u/64)},programUniforms:y}),getShaderSource:t=>{let r=Hr(e[0].dataType),n=[tn("x",e[0].dataType,e[0].dims,d),tn("scale",i.dataType,i.dims,d)];o&&n.push(tn("bias",o.dataType,o.dims,d)),n.push(rn("output",e[0].dataType,a,d)),m&&n.push(rn("mean_data_output",1,f)),g&&n.push(rn("inv_std_output",1,f));return`\n  ${t.registerUniforms([{name:"norm_count",type:"u32"},{name:"norm_size",type:"f32"},{name:"norm_size_vectorized",type:"u32"},{name:"epsilon",type:"f32"}]).declareVariables(...n)}\n  ${t.mainStart()}\n    ${t.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.norm_count")}\n    let offset = global_idx * uniforms.norm_size_vectorized;\n    var meanVector = ${Kr("f32",d)};\n    var meanSquareVector = ${Kr("f32",d)};\n\n    for (var h: u32 = 0u; h < uniforms.norm_size_vectorized; h++) {\n      let value = ${Zr(r,d,"x[h + offset]")};\n      meanVector += value;\n      meanSquareVector += value * value;\n    }\n    let mean = ${Jr("meanVector",d)} / uniforms.norm_size;\n    let invStdDev =\n        inverseSqrt(${Jr("meanSquareVector",d)} / uniforms.norm_size - mean * mean + uniforms.epsilon);\n\n    for (var j: u32 = 0; j < uniforms.norm_size_vectorized; j++) {\n      let f32input = ${Zr(r,d,"x[j + offset]")};\n      let f32scale = ${Zr(r,d,"scale[j]")};\n      output[j + offset] = ${n[0].type.value}((f32input - mean) * invStdDev * f32scale\n        ${o?`+ ${Zr(r,d,"bias[j]")}`:""}\n      );\n    }\n\n    ${m?"mean_data_output[global_idx] = mean":""};\n    ${g?"inv_std_output[global_idx] = invStdDev":""};\n  }`}}},ts=(e,t)=>{Qa(e.inputs),e.compute(es(e.inputs,t,e.outputCount))}})),$l=st((()=>{el(),Qu(),Zu(),al(),tl(),rl(),rs=(e,t)=>{let r=e[0],n=e[1],i=e[2],o=e[3],a=e[4],s=e[5],u=e[6],l=e[7];if(3!==r.dims.length&&5!==r.dims.length)throw new Error("Input query is expected to have 3 or 5 dimensions");let h,c=r.dims[0],f=r.dims[1],d=3===r.dims.length?r.dims[2]:t.numHeads*r.dims[4],p=f,y=0,m=0,g=Math.floor(d/t.numHeads);if(u&&l){if(4!==u.dims.length)throw new Error('Input "past_key" is expected to have 4 dimensions');if(4!==l.dims.length)throw new Error('Input "past_value" is expected to have 4 dimensions');y=u.dims[2],m=u.dims[2]}else if(u||l)throw new Error('Input "past_key" and "past_value" shall be both present or both absent');if(n){if(3!==r.dims.length)throw new Error('Input "query" is expected to have 3 dimensions when key is given');if(n.dims.length<3||n.dims.length>5)throw new Error('Input "key" is expected to have 3, 4, or 5 dimensions');if(r.dims[0]!==n.dims[0])throw new Error('Input "query" and "key" shall have same dim 0 (batch size)');if(3===n.dims.length){if(n.dims[2]!==r.dims[2])throw new Error('Input "query" and "key" shall have same dim 2 (hidden_size)');h=2,p=n.dims[1]}else if(5===n.dims.length){if(n.dims[2]!==t.numHeads||2!==n.dims[3]||n.dims[4]!==g)throw new Error('Expect "key" shape (batch_size, kv_sequence_length, num_heads, 2, head_size) for packed kv');if(i)throw new Error('Expect "value" be none when "key" has packed kv format.');h=5,p=n.dims[1]}else{if(n.dims[1]!==t.numHeads||n.dims[3]!==g)throw new Error('Expect "key" shape (batch_size, num_heads, kv_sequence_length, head_size) for past_key');h=0,p=n.dims[2]}}else{if(3!==r.dims.length&&5!==r.dims.length)throw new Error('Input "query" is expected to have 3 or 5 dimensions when key is empty');if(5===r.dims.length&&(r.dims[2]!==t.numHeads||3!==r.dims[3]))throw new Error('Expect "query" shape (batch_size, kv_sequence_length, num_heads, 3, head_size) for packed kv');h=3}if(o){if(1!==o.dims.length)throw new Error('Input "bias" is expected to have 1 dimension');if(i&&5===r.dims.length&&2===r.dims[3])throw new Error("bias is not allowed for packed kv.")}let w=0;if(a){w=8;let e=a.dims;throw 1===e.length?e[0]===c?w=1:e[0]===3*c+2&&(w=3):2===e.length&&e[0]===c&&e[1]===p&&(w=5),8===w?new Error('Input "key_padding_mask" shape shall be (batch_size) or (batch_size, kv_sequence_length)'):new Error("Mask not supported")}let v=!1,b=d;if(i){if(3!==i.dims.length&&4!==i.dims.length)throw new Error('Input "value" is expected to have 3 or 4 dimensions');if(r.dims[0]!==i.dims[0])throw new Error('Input "query" and "value" shall have same dim 0 (batch_size)');if(3===i.dims.length){if(p!==i.dims[1])throw new Error('Input "key" and "value" shall have the same dim 1 (kv_sequence_length)');b=i.dims[2]}else{if(p!==i.dims[2])throw new Error('Input "past_key" and "past_value" shall have the same dim 2 (kv_sequence_length)');b=i.dims[1]*i.dims[3],v=!0}}let x=y+p;if(a)throw new Error("Key padding mask is not supported");if(s)throw new Error("extraAddQk is not supported");if(u)throw new Error("pastKey is not supported");if(l)throw new Error("pastValue is not supported");return{batchSize:c,sequenceLength:f,pastSequenceLength:y,kvSequenceLength:p,totalSequenceLength:x,maxSequenceLength:m,inputHiddenSize:0,hiddenSize:d,vHiddenSize:b,headSize:g,vHeadSize:Math.floor(b/t.numHeads),numHeads:t.numHeads,isUnidirectional:!1,pastPresentShareBuffer:!1,maskFilterValue:t.maskFilterValue,maskType:w,scale:t.scale,broadcastResPosBias:!1,passPastInKv:v,qkvFormat:h}},ns=e=>Br({...e}),is=Br({perm:[0,2,1,3]}),os=(e,t,r,n,i,o,a)=>{let s=[n,i,o],u=Ur.size(s),l=[{type:"uint32",data:u},{type:"uint32",data:a},{type:"uint32",data:o}];return e.compute({name:"MultiHeadAttentionAddBias",shaderCache:{inputDependencies:["type","type"]},getRunData:()=>({outputs:[{dims:s,dataType:t.dataType,gpuDataType:0}],dispatchGroup:{x:Math.ceil(u/64)},programUniforms:l}),getShaderSource:e=>{let n=rn("qkv_with_bias",t.dataType,s),i=tn("qkv",t.dataType,s),o=tn("bias",r.dataType,s);return`\n  ${e.registerUniforms([{name:"output_size",type:"u32"},{name:"bias_offset",type:"u32"},{name:"hidden_size",type:"u32"}]).declareVariables(i,o,n)}\n  ${e.mainStart()}\n    ${e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}\n    let bias_offset_idx = (global_idx % uniforms.hidden_size) + uniforms.bias_offset;\n\n    qkv_with_bias[global_idx] = qkv[global_idx] + bias[bias_offset_idx];\n  }`}},{inputs:[t,r],outputs:[-1]})[0]},as=(e,t,r,n,i,o,a,s)=>{let u=o;if(a){if(1===n)throw new Error("AddBiasReshape is not implemented. Please export your model with packed QKV or KV");return u=os(e,o,a,t,n,r*i,s),u=u.reshape([t,n,r,i]),e.compute(dn(u,is.perm),{inputs:[u],outputs:[-1]})[0]}return 3===o.dims.length&&(u=o.reshape([t,n,r,i])),e.compute(dn(u,is.perm),{inputs:[u],outputs:[-1]})[0]},ss=(e,t)=>{let r=rs(e.inputs,t);if(5===e.inputs[0].dims.length)throw new Error("Packed QKV is not implemented");if(5===e.inputs[1]?.dims.length)throw new Error("Packed KV is not implemented");let n=e.inputs[1]&&e.inputs[2]&&4===e.inputs[1].dims.length&&4===e.inputs[2].dims.length,i=as(e,r.batchSize,r.numHeads,r.sequenceLength,r.headSize,e.inputs[0],e.inputs[3],0);if(n)return gi(e,i,e.inputs[1],e.inputs[2],e.inputs[4],void 0,void 0,void 0,e.inputs[5],r,t);let o=as(e,r.batchSize,r.numHeads,r.kvSequenceLength,r.headSize,e.inputs[1],e.inputs[3],r.hiddenSize),a=as(e,r.batchSize,r.numHeads,r.kvSequenceLength,r.vHeadSize,e.inputs[2],e.inputs[3],2*r.hiddenSize);gi(e,i,o,a,e.inputs[4],void 0,e.inputs[6],e.inputs[7],e.inputs[5],r,t)}})),Rl=st((()=>{qu(),el(),tl(),us=e=>{if(!e||e.length<1)throw new Error("Too few inputs");if(1!==e[0].dataType)throw new Error("Input type must be float.");if(e.length>=2){let t=2*e[0].dims.length===e[1].dims[0];if(4===e.length&&(t=2*e[3].dims[0]===e[1].dims[0]),!t)throw new Error("The pads should be a 1D tensor of shape [2 * input_rank] or [2 * num_axes].")}},ls=(e,t,r)=>{let n="";for(let i=t-1;i>=0;--i)n+=`\n            k = i32(${e.indicesGet("indices",i)}) - ${Qr("uniforms.pads",i,r)};\n            if (k < 0) {\n              break;\n            }\n            if (k >= i32(${Qr("uniforms.x_shape",i,t)})) {\n              break;\n            }\n            offset += k * i32(${Qr("uniforms.x_strides",i,t)});\n        `;return`\n          value = ${e.type.value}(uniforms.constant_value);\n          for (var i = 0; i < 1; i++) {\n            var offset = 0;\n            var k = 0;\n            ${n}\n            value = x[offset];\n          }\n      `},hs=(e,t,r)=>{let n="";for(let i=t-1;i>=0;--i)n+=`\n                k = i32(${e.indicesGet("indices",i)}) - ${Qr("uniforms.pads",i,r)};\n                if (k < 0) {\n                  k = -k;\n                }\n                {\n                  let _2n_1 = 2 * (i32(${Qr("uniforms.x_shape",i,t)}) - 1);\n                  k = k % _2n_1;\n                  if(k >= i32(${Qr("uniforms.x_shape",i,t)})) {\n                    k = _2n_1 - k;\n                  }\n                }\n                offset += k * i32(${Qr("uniforms.x_strides",i,t)});\n            `;return`\n              var offset = 0;\n              var k = 0;\n              ${n}\n              value = x[offset];\n          `},cs=(e,t,r)=>{let n="";for(let i=t-1;i>=0;--i)n+=`\n                k = i32(${e.indicesGet("indices",i)}) - ${Qr("uniforms.pads",i,r)};\n                if (k < 0) {\n                  k = 0;\n                }\n                if (k >= i32(${Qr("uniforms.x_shape",i,t)})) {\n                  k = i32(${Qr("uniforms.x_shape",i,t)}) - 1;\n                }\n                offset += k * i32(${Qr("uniforms.x_strides",i,t)});\n            `;return`\n              var offset = 0;\n              var k = 0;\n              ${n}\n              value = x[offset];\n          `},fs=(e,t,r)=>{let n="";for(let i=t-1;i>=0;--i)n+=`\n                k = i32(${e.indicesGet("indices",i)}) - ${Qr("uniforms.pads",i,r)};\n                if (k < 0)  {\n                  k += i32(${Qr("uniforms.x_shape",i,t)}]);\n                }\n                if (k >= i32(${Qr("uniforms.x_shape",i,t)})) {\n                  k -= i32(${Qr("uniforms.x_shape",i,t)});\n                }\n                offset += k * i32(${Qr("uniforms.x_strides",i,t)});\n            `;return`\n              var offset = 0;\n              var k = 0;\n              ${n}\n              value = x[offset];\n          `},ds=(e,t,r)=>{switch(r.mode){case 0:return ls(e,t,r.pads.length);case 1:return hs(e,t,r.pads.length);case 2:return cs(e,t,r.pads.length);case 3:return fs(e,t,r.pads.length);default:throw new Error("Invalid mode")}},ps=(e,t)=>{let r=Ur.padShape(e[0].dims.slice(),t.pads),n=e[0].dims,i=[{type:"uint32",data:Ur.size(r)},{type:"uint32",data:t.pads}];if(0===t.mode){let r=dr(e[0].dataType);i.push({type:r,data:t.value})}i.push(...Yr(e[0].dims),...Yr(r));return{name:"Pad",shaderCache:{hint:`${t.mode}`,inputDependencies:["rank"]},getRunData:()=>({outputs:[{dims:r,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(Ur.size(r)/64)},programUniforms:i}),getShaderSource:i=>{let o=rn("output",e[0].dataType,r.length),a=tn("x",e[0].dataType,n.length),s=a.type.value,u=ds(o,n.length,t),l=[{name:"output_size",type:"u32"},{name:"pads",type:"i32",length:t.pads.length}];return 0===t.mode&&l.push({name:"constant_value",type:s}),`\n            ${i.registerUniforms(l).declareVariables(a,o)}\n            ${i.mainStart()}\n            ${i.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}\n\n            let indices = ${o.offsetToIndices("global_idx")};\n\n            var value = ${s}(0);\n            ${u}\n            output[global_idx] = value;\n        }`}}},ys=(e,t)=>{if(e.length>1){let r=e[1].getBigInt64Array(),n=e.length>=3&&e[2].data?e[2].getFloat32Array()[0]:0,i=e[0].dims.length,o=new Int32Array(2*i).fill(0);if(e.length>=4){let t=e[3].getBigInt64Array();for(let e=0;e<t.length;e++)o[Number(t[e])]=Number(r[e]),o[Number(t[e])+i]=Number(r[e+t.length])}else r.forEach(((e,t)=>o[Number(t)]=Number(e)));let a=[];return o.forEach((e=>a.push(e))),{mode:t.mode,value:n,pads:a}}return t},ms=(e,t)=>{us(e.inputs);let r=ys(e.inputs,t);e.compute(ps(e.inputs,r),{inputs:[0]})}})),Dl=st((()=>{Pt(),el(),tl(),gs=e=>{if(Pe.webgpu.validateInputContent&&(!e||1!==e.length))throw new Error("Pool ops requires 1 input.")},ws=(e,t,r)=>{let n="NHWC"===t.format,i=e.dims.slice();n&&i.splice(1,0,i.pop());let o=Object.hasOwnProperty.call(t,"dilations"),a=t.kernelShape.slice(),s=t.strides.slice(),u=o?t.dilations.slice():[],l=t.pads.slice();jr.adjustPoolAttributes(r,i,a,s,u,l);let h=jr.computePoolOutputShape(r,i,s,u,a,l,t.autoPad),c=Object.assign({},t);o?Object.assign(c,{kernelShape:a,strides:s,pads:l,dilations:u,cacheKey:t.cacheKey}):Object.assign(c,{kernelShape:a,strides:s,pads:l,cacheKey:t.cacheKey});let f=h.slice();return f.push(f.splice(1,1)[0]),[c,n?f:h]},vs=(e,t)=>{let r="NHWC"===t.format,n=[{type:"uint32",data:Ur.size(e)},{type:"uint32",data:Ur.size(t.kernelShape)}],i=[{name:"outputSize",type:"u32"},{name:"kernelSize",type:"u32"}];if(t.kernelShape.length<=2){let e=t.kernelShape[t.kernelShape.length-1],r=t.strides[t.strides.length-1],o=t.pads[t.pads.length/2-1],a=t.pads[t.pads.length-1],s=!!(o+a);n.push({type:"uint32",data:e},{type:"uint32",data:r},{type:"uint32",data:o},{type:"uint32",data:a}),i.push({name:"kw",type:"u32"},{name:"sw",type:"u32"},{name:"pwStart",type:"u32"},{name:"pwEnd",type:"u32"});let u=!1;if(2===t.kernelShape.length){let e=t.kernelShape[t.kernelShape.length-2],r=t.strides[t.strides.length-2],o=t.pads[t.pads.length/2-2],a=t.pads[t.pads.length-2];u=!!(o+a),n.push({type:"uint32",data:e},{type:"uint32",data:r},{type:"uint32",data:o},{type:"uint32",data:a}),i.push({name:"kh",type:"u32"},{name:"sh",type:"u32"},{name:"phStart",type:"u32"},{name:"phEnd",type:"u32"})}return[n,i,!0,s,u]}{if(r)throw new Error("Pooling with kernelShape.length > 2 is not supported for NHWC format.");let e=Ur.computeStrides(t.kernelShape);return n.push({type:"uint32",data:e},{type:"uint32",data:t.pads},{type:"uint32",data:t.strides}),i.push({name:"kernelStrides",type:"u32",length:e.length},{name:"pads",type:"u32",length:t.pads.length},{name:"strides",type:"u32",length:t.strides.length}),[n,i,!!t.pads.reduce(((e,t)=>e+t)),!1,!1]}},bs=(e,t,r,n,i,o,a,s,u,l,h,c)=>{let f="NHWC"===i.format,d=t.type.value,p=rn("output",t.type.tensor,n);if(i.kernelShape.length<=2){let n="",l="",y="",m=r-(f?2:1);if(n=h?`\n                for (var i: u32 = 0u; i < uniforms.kw; i++) {\n                  xIndices[${m}] = indices[${m}] * uniforms.sw - uniforms.pwStart + i;\n                  if (xIndices[${m}] < 0 || xIndices[${m}]\n                      >= uniforms.x_shape[${m}]) {\n                    pad++;\n                    continue;\n                  }\n                  let x_val = x[${t.indicesToOffset("xIndices")}];\n                  ${o}\n                }`:`\n                for (var i: u32 = 0u; i < uniforms.kw; i++) {\n                  xIndices[${m}] = indices[${m}] * uniforms.sw - uniforms.pwStart + i;\n                  let x_val = x[${t.indicesToOffset("xIndices")}];\n                  ${o}\n                }`,2===i.kernelShape.length){let e=r-(f?3:2);l=c?`\n                for (var j: u32 = 0u; j < uniforms.kh; j++) {\n                  xIndices[${e}] = indices[${e}] * uniforms.sh - uniforms.phStart + j;\n                  if (xIndices[${e}] < 0 || xIndices[${e}] >= uniforms.x_shape[${e}]) {\n                    pad += i32(uniforms.kw);\n                    continue;\n                  }\n              `:`\n                for (var j: u32 = 0u; j < uniforms.kh; j++) {\n                  xIndices[${e}] = indices[${e}] * uniforms.sh - uniforms.phStart + j;\n                `,y="\n              }\n            "}return`\n            ${e.registerUniforms(u).declareVariables(t,p)}\n\n            ${e.mainStart()}\n              ${e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}\n\n              let indices = ${p.offsetToIndices("global_idx")};\n              var xIndices = ${p.offsetToIndices("global_idx")};\n\n              var value = ${d}(${s});\n              var pad = 0;\n              ${l}\n              ${n}\n              ${y}\n              ${a}\n\n              output[global_idx] = value;\n            }`}{if(f)throw new Error("Pooling with kernelShape.length > 2 is not supported for NHWC format.");let n=i.kernelShape.length,h=i.pads.length,c="";return c=l?`\n                if (xIndices[j] >= uniforms.x_shape[j]) {\n                  pad++;\n                  isPad = true;\n                  break;\n                }\n              }\n              if (!isPad) {\n                let x_val = x[${t.indicesToOffset("xIndices")}];\n                ${o}\n              }`:`\n              }\n              let x_val = x[${t.indicesToOffset("xIndices")}];\n              ${o}\n            `,`\n            ${e.registerUniforms(u).declareVariables(t,p)}\n\n            ${e.mainStart()}\n              ${e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}\n              let indices = ${p.offsetToIndices("global_idx")};\n              var xIndices = ${p.offsetToIndices("global_idx")};\n\n              var offsets: array<u32, ${n}>;\n\n              var value = ${d}(${s});\n              var pad = 0;\n              var isPad = false;\n\n              for (var i: u32 = 0u; i < uniforms.kernelSize; i++) {\n                var offset = i;\n                for (var j = 0u; j < ${n-1}u; j++) {\n                  offsets[j] = offset / ${Qr("uniforms.kernelStrides","j",n)};\n                  offset -= offsets[j] * ${Qr("uniforms.kernelStrides","j",n)};\n                }\n                offsets[${n-1}] = offset;\n\n                isPad = false;\n                for (var j = ${r-n}u; j < ${r}u; j++) {\n                  xIndices[j] = indices[j] * ${Qr("uniforms.strides",`j - ${r-n}u`,n)}\n                    + offsets[j - ${r-n}u] - ${Qr("uniforms.pads","j - 2u",h)};\n                  ${c}\n              }\n              ${a}\n\n              output[global_idx] = value;\n            }`}},xs=e=>`${e.format};${e.ceilMode};${e.autoPad};${e.kernelShape.length}`,_s=e=>`${xs(e)};${e.countIncludePad}`,Ss=e=>`${xs(e)};${e.storageOrder};${e.dilations}`,Ts=e=>({format:e.format,autoPad:["NOTSET","VALID","SAME_UPPER","SAME_LOWER"][e.auto_pad],ceilMode:e.ceil_mode,kernelShape:e.kernel_shape,strides:e.strides,pads:e.pads}),Es=(e,t,r,n)=>{let[i,o]=ws(t,n,r),a=tn("x",t.dataType,t.dims.length),s=a.type.value,u="";i.countIncludePad?u+=`value /= ${s}(uniforms.kernelSize);`:u+=`value /= ${s}(i32(uniforms.kernelSize) - pad);`;let[l,h,c,f,d]=vs(o,i);l.push(...Yr(t.dims),...Yr(o));return{name:e,shaderCache:{hint:`${n.cacheKey};${c};${f};${d}`,inputDependencies:["rank"]},getRunData:()=>({outputs:[{dims:o,dataType:t.dataType}],dispatchGroup:{x:Math.ceil(Ur.size(o)/64)},programUniforms:l}),getShaderSource:e=>bs(e,a,t.dims.length,o.length,i,"value += x_val;",u,0,h,c,f,d)}},Os=e=>{let t=0!==e.count_include_pad,r=Ts(e);if(0!==r.ceilMode)throw new Error("using ceil() in shape computation is not yet supported for AveragePool");let n={countIncludePad:t,...r,cacheKey:""};return{...n,cacheKey:_s(n)}},As=(e,t)=>{gs(e.inputs),e.compute(Es("AveragePool",e.inputs[0],!1,t))},Is={autoPad:"",ceilMode:0,countIncludePad:!1,kernelShape:[],strides:[],pads:[],storageOrder:0,dilations:[]},Ps=e=>{let t=e.format;return{format:t,...Is,cacheKey:t}},ks=(e,t)=>{gs(e.inputs),e.compute(Es("GlobalAveragePool",e.inputs[0],!0,t))},Cs=(e,t,r,n)=>{let[i,o]=ws(t,n,r),a=tn("x",t.dataType,t.dims.length),[s,u,l,h,c]=vs(o,i);return s.push(...Yr(t.dims),...Yr(o)),{name:e,shaderCache:{hint:`${n.cacheKey};${l};${h};${c}`,inputDependencies:["rank"]},getRunData:()=>({outputs:[{dims:o,dataType:t.dataType}],dispatchGroup:{x:Math.ceil(Ur.size(o)/64)},programUniforms:s}),getShaderSource:e=>bs(e,a,t.dims.length,o.length,i,"\n      value = max(x_val, value);\n    ","",-1e5,u,l,h,c)}},$s=(e,t)=>{gs(e.inputs),e.compute(Cs("MaxPool",e.inputs[0],!1,t))},Rs=e=>{let t=e.storage_order,r=e.dilations,n=Ts(e);if(0!==t)throw new Error("column major storage order is not yet supported for MaxPool");if(0!==n.ceilMode)throw new Error("using ceil() in shape computation is not yet supported for MaxPool");let i={storageOrder:t,dilations:r,...n,cacheKey:""};return{...i,cacheKey:Ss(i)}},Ds=e=>{let t=e.format;return{format:t,...Is,cacheKey:t}},Ms=(e,t)=>{gs(e.inputs),e.compute(Cs("GlobalMaxPool",e.inputs[0],!0,t))}})),Ml=st((()=>{Pt(),qu(),tl(),Ls=(e,t,r)=>{if(e===t||e<t&&r<0||e>t&&r>0)throw new Error("Range these inputs' contents are invalid.")},Bs=(e,t,r,n)=>{let i=Math.abs(Math.ceil((t-e)/r)),o=[i],a=i,s=dr(n),u=[{type:"uint32",data:a},{type:s,data:e},{type:s,data:r},...Yr(o)];return{name:"Range",shaderCache:{hint:`${n}`},getShaderSource:e=>{let t=rn("output",n,o.length),r=t.type.value,i=[{name:"outputSize",type:"u32"},{name:"start",type:r},{name:"delta",type:r}];return`\n        ${e.registerUniforms(i).declareVariables(t)}\n        ${e.mainStart()}\n        ${e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}\n        output[global_idx] = uniforms.start + ${r}(global_idx) * uniforms.delta;\n      }`},getRunData:()=>({outputs:[{dims:o,dataType:n}],dispatchGroup:{x:Math.ceil(a/64)},programUniforms:u})}},Ns=e=>{let t=0,r=0,n=0;6===e.inputs[0].dataType?(t=e.inputs[0].getInt32Array()[0],r=e.inputs[1].getInt32Array()[0],n=e.inputs[2].getInt32Array()[0]):1===e.inputs[0].dataType&&(t=e.inputs[0].getFloat32Array()[0],r=e.inputs[1].getFloat32Array()[0],n=e.inputs[2].getFloat32Array()[0]),Pe.webgpu.validateInputContent&&Ls(t,r,n),e.compute(Bs(t,r,n,e.inputs[0].dataType),{inputs:[]})}})),Ll=st((()=>{el(),Qu(),tl(),Fs=(e,t)=>{if(e.every((e=>e>0||(()=>{throw new Error("Resize requires scales input values to be positive")}))),e.length>0)if("linear"===t.mode){if(!(2===e.length||3===e.length||4===e.length&&1===e[0]&&1===e[1]||4===e.length&&1===e[0]&&1===e[3]||5===e.length&&1===e[0]&&1===e[1]))throw new Error("For linear mode, Resize requires scales to be 2D, 3D, 4D with either two outermost or one innermost and\n            one outermost scale values equal to 1, or 5D with two outermost scale values equal to 1")}else if("cubic"===t.mode&&!(2===e.length||4===e.length&&1===e[0]&&1===e[1]||4===e.length&&1===e[0]&&1===e[3]))throw new Error("Resize requires scales input size to be 2 or 4 for cubic mode")},Us=(e,t,r)=>{t.every((e=>e>=0&&e<r||(()=>{throw new Error("Resize requires axes input values to be positive and less than rank")})));let n=new Array(r).fill(1);return t.forEach(((t,r)=>n[t]=e[r])),n},js=(e,t,r,n,i,o)=>{let[a,s,u]=r>10?[1,2,3]:[-1,e.length>1?1:-1,-1],l=e[0].dims.length;if(a>0&&e.length>a&&e[a].dims.length>0)e[a].getFloat32Array().forEach((e=>o.push(e)));else if("tf_crop_and_resize"===t.coordinateTransformMode)throw new Error("Resize requires RoI input to be specified when coordinateTransformMode is tfCropAndResize");if(s>0&&e.length>s&&e[s].dims.length>0){if(e[s].getFloat32Array().forEach((e=>n.push(e))),0!==n.length&&n.length!==l&&r>=18&&n.length!==t.axes.length)throw new Error("Resize requires scales input size to be same as input rank or axes size for opset 18 and up");Fs(n,t),t.axes.length>0&&Us(n,t.axes,l).forEach(((e,t)=>n[t]=e))}if(u>0&&e.length>u&&(e[u].getBigInt64Array().forEach((e=>i.push(Number(e)))),i.length!==l||r>=18&&i.length===t.axes.length))throw new Error("Resize requires sizes input size to be same as input rank or axes size for opset 18 and up");if(t.axes.length>0){if(n.length!==t.axes.length)throw new Error('Resize requires "scales" input size to be of axes rank when axes attributes is specified');if(i.length!==t.axes.length)throw new Error('Resize requires "sizes" input size to be of rank axes rank when axes attributes is specified')}if(typeof n<"u"&&typeof i<"u"&&n.length>0&&i.length>l)throw new Error("Resize requires only of scales or sizes to be specified")},zs=(e,t)=>`fn getOriginalCoordinateFromResizedCoordinate(xResized: u32, xScale: f32, lengthResized: u32,\n     lengthOriginal: u32, roiStart: f32, roiEnd: f32) -> ${t} { `+(()=>{switch(e){case"asymmetric":return`return ${t}(xResized) / ${t}(xScale);`;case"pytorch_half_pixel":return`if (lengthResized > 1) {\n                    return (${t}(xResized) + 0.5) / ${t}(xScale) - 0.5;\n                  } else {\n                    return 0.0;\n                  }`;case"tf_half_pixel_for_nn":return`return (${t}(xResized) + 0.5) / ${t}(xScale);`;case"align_corners":return`if (lengthResized == 1) {\n                    return 0.0;\n                  } else {\n                    // The whole part and the fractional part are calculated separately due to inaccuracy of floating\n                    // point division. As an example, f32(21) / f32(7) may evaluate to 2.99... instead of 3, causing an\n                    // offset-by-one error later in floor().\n                    let whole = ${t}(xResized * (lengthOriginal - 1) / (lengthResized - 1));\n                    let fract =\n                        ${t}(xResized * (lengthOriginal - 1) % (lengthResized - 1)) / ${t}(lengthResized - 1);\n                    return whole + fract;\n                  }`;case"tf_crop_and_resize":return`if (lengthResized > 1) {\n                    return ${t}(roiStart) * ${t}(lengthOriginal - 1) +\n                        (${t}(xResized) * ${t}(roiEnd - roiStart) * ${t}(lengthOriginal - 1)) /\n                        ${t}(lengthResized - 1);\n                  } else {\n                    return 0.5 * ${t}(roiStart + roiEnd) * ${t}(lengthOriginal - 1);\n                  }`;case"half_pixel_symmetric":return`const outputWidth = ${t}xScale * ${t}(lengthResized);\n                  const adjustment = ${t}(lengthResized) / outputWidth;\n                  const center = ${t}(lengthOriginal) / 2;\n                  const offset = center * (1 - adjustment);\n                  return offset + ((${t}(xResized) + 0.5) / ${t}(xScale)) - 0.5;`;case"half_pixel":return`return ((${t}(xResized) + 0.5) / ${t}(xScale)) - 0.5;`;default:throw new Error(`Coordinate transform mode ${e} is not supported`)}})()+"}",Gs=(e,t,r)=>`fn getNearestPixelFromOriginal(xOriginal: ${r}, isDownSample: bool) -> ${r} {`+(()=>{switch(e){case"round_prefer_ceil":return"if (fract(xOriginal) == 0.5) {             return ceil(xOriginal);           } else {             return round(xOriginal);           }";case"floor":return"return floor(xOriginal);";case"ceil":return"return ceil(xOriginal);";case"round_prefer_floor":return"if (fract(xOriginal) == 0.5) {                     return floor(xOriginal);                   } else {                     return round(xOriginal);                   }";default:if(t<11)return"if (isDownSample)                     {                       return ceil(xOriginal);                     } else {                       return xOriginal;                     }";throw new Error(`Nearest mode ${e} is not supported`)}})()+"}",Vs=(e,t,r)=>{let n=new Array(r).fill(0).concat(new Array(r).fill(1)),i=0===e.length?n:e.slice();return t.length>0?(t.forEach(((e,o)=>{n[e]=i[o],n[o+r]=i[t.length+o]})),n):i},Ws=(e,t,r,n)=>{let i=[];if(r.length>0)if(n.length>0){if(e.forEach((e=>i.push(e))),Math.max(...n)>e.length)throw new Error("axes is out of bound");n.forEach(((e,t)=>i[e]=r[t]))}else r.forEach((e=>i.push(e)));else{if(0===t.length)throw new Error("Resize requires either scales or sizes.");i=e.map(((e,r)=>Math.round(e*t[r])))}return i},Hs=(e,t,r)=>{let n=(()=>{switch(r.keepAspectRatioPolicy){case"not_larger":return r.axes.length>0?Math.min(...r.axes.map((e=>t[e])),Number.MAX_VALUE):Math.min(...t,Number.MAX_VALUE);case"not_smaller":return r.axes.length>0?Math.max(...r.axes.map((e=>t[e])),Number.MIN_VALUE):Math.max(...t,Number.MIN_VALUE);default:throw new Error(`Keep aspect ratio policy ${r.keepAspectRatioPolicy} is not supported`)}})();t.fill(1,0,t.length);let i=e.slice();return r.axes.length>0?(r.axes.forEach((e=>t[e]=n)),r.axes.forEach((r=>i[r]=Math.round(e[r]*t[r])))):(t.fill(n,0,t.length),i.forEach(((e,r)=>i[r]=Math.round(e*t[r])))),i},qs=(e,t,r,n,i)=>`\n    fn calculateOriginalIndicesFromOutputIndices(output_indices: ${e.type.indices}) -> array<${e.type.value}, ${r.length}> {\n      var original_indices: array<${e.type.value}, ${r.length}>;\n      for (var i:u32 = 0; i < ${r.length}; i++) {\n        var output_index = ${e.indicesGet("output_indices","i")};\n        var scale = ${Qr("uniforms.scales","i",n)};\n        var roi_low = ${Qr("uniforms.roi","i",i)};\n        var roi_hi = ${Qr("uniforms.roi",`i + ${t.length}`,i)};\n        if (scale == 1.0) {\n          original_indices[i] = ${e.type.value}(output_index);\n        } else {\n          var input_shape_i = ${Qr("uniforms.input_shape","i",t.length)};\n          var output_shape_i = ${Qr("uniforms.output_shape","i",r.length)};\n          original_indices[i] = getOriginalCoordinateFromResizedCoordinate(output_index, scale, output_shape_i,\n                                                                           input_shape_i, roi_low, roi_hi);\n        }\n      }\n      return original_indices;\n    }`,Ys=(e,t,r,n,i,o,a)=>`\n    fn calculateInputIndicesFromOutputIndices(output_indices: ${t.type.indices}) -> ${e.type.indices} {\n      var input_indices: ${e.type.indices};\n      for (var i:u32 = 0; i < ${n.length}; i++) {\n        var output_index = ${t.indicesGet("output_indices","i")};\n        var input_index: u32;\n        var scale = ${Qr("uniforms.scales","i",i)};\n        if (scale == 1.0) {\n          input_index = output_index;\n        } else {\n          var roi_low = ${Qr("uniforms.roi","i",o)};\n          var roi_hi = ${Qr("uniforms.roi",`i + ${r.length}`,o)};\n          var input_shape_i = ${Qr("uniforms.input_shape","i",r.length)};\n          var output_shape_i = ${Qr("uniforms.output_shape","i",n.length)};\n          var original_idx = getOriginalCoordinateFromResizedCoordinate(output_index, scale, output_shape_i,\n                                                                        input_shape_i, roi_low, roi_hi);\n          if (!${a} || (original_idx >= 0 && original_idx < ${t.type.value}(input_shape_i))) {\n            if (original_idx < 0) {\n              input_index = 0;\n            } else if (original_idx > ${t.type.value}(input_shape_i - 1)) {\n              input_index = input_shape_i - 1;\n            } else {\n              input_index = u32(getNearestPixelFromOriginal(original_idx, scale < 1));\n            }\n          } else {\n            input_index = u32(original_idx);\n          }\n        }\n        ${e.indicesSet("input_indices","i"," input_index")}\n      }\n      return input_indices;\n    }`,Xs=(e,t)=>`\n    fn checkInputIndices(input_indices: ${e.type.indices}) -> bool {\n      for (var i:u32 = 0; i < ${t.length}; i++) {\n        var input_index = ${e.indicesGet("input_indices","i")};\n        if (input_index < 0 || input_index >= ${Qr("uniforms.input_shape","i",t.length)}) {\n          return false;\n        }\n      }\n      return true;\n    }`,Ks=(e,t,r,n)=>e.rank>n?`\n    ${e.indicesSet("input_indices",t,"channel")};\n    ${e.indicesSet("input_indices",r,"batch")};\n`:"",Zs=(e,t,r,n,i)=>{let[o,a,s,u]=2===r.length?[-1,0,1,-1]:[0,2,3,1],l=e.type.value;return`\n    fn getInputValue(batch: u32, channel: u32, row: u32, col: u32) -> ${l} {\n      var input_indices: ${e.type.indices};\n      ${e.indicesSet("input_indices",a,`max(0, min(row, ${r[a]} - 1))`)};\n      ${e.indicesSet("input_indices",s,`max(0, min(col, ${r[s]} - 1))`)};\n      ${Ks(e,u,o,2)}\n      return ${e.getByIndices("input_indices")};\n    }\n\n    fn bilinearInterpolation(output_indices: ${t.type.indices}) -> ${l} {\n      var originalIndices = calculateOriginalIndicesFromOutputIndices(output_indices);\n      var row:${l} = originalIndices[${a}];\n      var col:${l} = originalIndices[${s}];\n      ${n?`if (row < 0 || row > (${r[a]} - 1) || col < 0 || col > (${r[s]} - 1)) {\n        return ${i};\n      }`:""};\n      row = max(0, min(row, ${r[a]} - 1));\n      col = max(0, min(col, ${r[s]} - 1));\n      var row1: u32 = u32(row);\n      var col1: u32 = u32(col);\n      var row2: u32 = u32(row + 1);\n      var col2: u32 = u32(col + 1);\n      var channel: u32 = ${r.length>2?`u32(originalIndices[${u}])`:"0"};\n      var batch: u32 =  ${r.length>2?`u32(originalIndices[${o}])`:"0"};\n      var x11: ${l} = getInputValue(batch, channel, row1, col1);\n      var x12: ${l} = getInputValue(batch, channel, row1, col2);\n      var x21: ${l} = getInputValue(batch, channel, row2, col1);\n      var x22: ${l} = getInputValue(batch, channel, row2, col2);\n      var dx1: ${l} = abs(row - ${l}(row1));\n      var dx2: ${l} = abs(${l}(row2) - row);\n      var dy1: ${l} = abs(col - ${l}(col1));\n      var dy2: ${l} = abs(${l}(col2) - col);\n      if (row1 == row2) {\n        dx1 = 0.5;\n        dx2 = 0.5;\n      }\n      if (col1 == col2) {\n        dy1 = 0.5;\n        dy2 = 0.5;\n      }\n      return (x11 * dx2 * dy2 + x12 * dx2 * dy1 + x21 * dx1 * dy2 + x22 * dx1 * dy1);\n    }`},Js=(e,t,r,n,i,o,a,s,u,l)=>{let h=2===r.length,[c,f]=h?[0,1]:[2,3],d=e.type.value,p=a=>{let h=a===c?"row":"col";return`\n      fn ${h}CubicInterpolation(input_indices: ${e.type.indices}, output_indices: ${t.type.indices}) -> ${d} {\n        var output_index = ${t.indicesGet("output_indices",a)};\n        var originalIdx: ${d} = getOriginalCoordinateFromResizedCoordinate(output_index, ${i[a]},\n        ${n[a]}, ${r[a]}, ${o[a]}, ${o[a]} + ${r.length});\n        var fractOriginalIdx: ${d} = originalIdx - floor(originalIdx);\n        var coefs = getCubicInterpolationCoefs(fractOriginalIdx);\n\n        if (${s} && (originalIdx < 0 || originalIdx > (${r[a]} - 1))) {\n          return ${u};\n        }\n        var data: array<${d}, 4> = array<${d}, 4>(0.0, 0.0, 0.0, 0.0);\n        for (var i: i32 = -1; i < 3; i++) {\n          var ${h}: ${d} = originalIdx + ${d}(i);\n          if (${h} < 0 || ${h} >= ${r[a]}) {\n            ${l?"coefs[i + 1] = 0.0;\n                        continue;":s?`return ${u};`:`${h} = max(0, min(${h}, ${r[a]} - 1));`};\n          }\n        var input_indices_copy: ${e.type.indices} = input_indices;\n          ${e.indicesSet("input_indices_copy",a,`u32(${h})`)};\n          data[i + 1] = ${a===c?e.getByIndices("input_indices_copy"):"rowCubicInterpolation(input_indices_copy, output_indices)"};\n        }\n        return cubicInterpolation1D(data, coefs);\n      }`};return`\n    ${p(c)};\n    ${p(f)};\n  fn getCubicInterpolationCoefs(s: ${d}) -> array<${d}, 4> {\n    var absS = abs(s);\n    var coeffs: array<${d}, 4> = array<${d}, 4>(0.0, 0.0, 0.0, 0.0);\n    var oneMinusAbsS: ${d} = 1.0 - absS;\n    var twoMinusAbsS: ${d} = 2.0 - absS;\n    var onePlusAbsS: ${d} = 1.0 + absS;\n    coeffs[0] = ((${a} * onePlusAbsS - 5 * ${a}) * onePlusAbsS + 8 * ${a}) * onePlusAbsS - 4 * ${a};\n    coeffs[1] = ((${a} + 2) * absS - (${a} + 3)) * absS * absS + 1;\n    coeffs[2] = ((${a} + 2) * oneMinusAbsS - (${a} + 3)) * oneMinusAbsS * oneMinusAbsS + 1;\n    coeffs[3] = ((${a} * twoMinusAbsS - 5 * ${a}) * twoMinusAbsS + 8 * ${a}) * twoMinusAbsS - 4 * ${a};\n    return coeffs;\n  }\n\n  fn cubicInterpolation1D(x: array<${d}, 4>, coefs: array<${d}, 4>) -> ${d} {\n    var coefsSum: ${d} = coefs[0] + coefs[1] + coefs[2] + coefs[3];\n    return (x[0] * coefs[0] + x[1] * coefs[1]+ x[2] * coefs[2]+ x[3] * coefs[3]) / coefsSum;\n  }\n\n  fn bicubicInterpolation(output_indices: ${t.type.indices}) -> ${d} {\n    var input_indices: ${e.type.indices} = output_indices;\n    return colCubicInterpolation(input_indices, output_indices);\n  }\n    `},Qs=(e,t,r,n,i)=>{let[o,a,s,u,l]=3===r.length?[-1,0,1,2,-1]:[0,2,3,4,1],h=e.type.value;return`\n    fn getInputValue(batch: u32, channel: u32, depth:u32, height: u32, width: u32) -> ${h} {\n      var input_indices: ${e.type.indices};\n      ${e.indicesSet("input_indices",a,`max(0, min(depth, ${r[a]} - 1))`)};\n      ${e.indicesSet("input_indices",s,`max(0, min(height, ${r[s]} - 1))`)};\n      ${e.indicesSet("input_indices",u,`max(0, min(width, ${r[u]} - 1))`)};\n      ${Ks(e,l,o,3)}\n      return ${e.getByIndices("input_indices")};\n    }\n\n    fn trilinearInterpolation(output_indices: ${t.type.indices}) -> ${h} {\n      var originalIndices = calculateOriginalIndicesFromOutputIndices(output_indices);\n      var depth:${h} = originalIndices[${a}];\n      var height:${h} = originalIndices[${s}];\n      var width:${h} = originalIndices[${u}];\n      ${n?`if (depth < 0 || depth > (${r[a]} - 1) || height < 0 || height > (${r[s]} - 1) || width < 0 || (width > ${r[u]} - 1)) {\n      return ${i};\n        }`:""};\n\n    depth = max(0, min(depth, ${r[a]} - 1));\n      height = max(0, min(height, ${r[s]} - 1));\n      width = max(0, min(width, ${r[u]} - 1));\n      var depth1: u32 = u32(depth);\n      var height1: u32 = u32(height);\n      var width1: u32 = u32(width);\n      var depth2: u32 = u32(depth + 1);\n      var height2: u32 = u32(height + 1);\n      var width2: u32 = u32(width + 1);\n      var channel: u32 = ${r.length>3?`u32(originalIndices[${l}])`:"0"};\n      var batch: u32 =  ${r.length>3?`u32(originalIndices[${o}])`:"0"};\n\n      var x111: ${h} = getInputValue(batch, channel, depth1, height1, width1);\n      var x112: ${h} = getInputValue(batch, channel, depth1, height1, width2);\n      var x121: ${h} = getInputValue(batch, channel, depth1, height2, width1);\n      var x122: ${h} = getInputValue(batch, channel, depth1, height2, width2);\n      var x211: ${h} = getInputValue(batch, channel, depth2, height1, width1);\n      var x212: ${h} = getInputValue(batch, channel, depth2, height1, width2);\n      var x221: ${h} = getInputValue(batch, channel, depth2, height2, width1);\n      var x222: ${h} = getInputValue(batch, channel, depth2, height2, width2);\n      var dx1: ${h} = abs(depth - ${h}(depth1));\n      var dx2: ${h} = abs(${h}(depth2) - depth);\n      var dy1: ${h} = abs(height - ${h}(height1));\n      var dy2: ${h} = abs(${h}(height2) - height);\n      var dz1: ${h} = abs(width - ${h}(width1));\n      var dz2: ${h} = abs(${h}(width2) - width);\n      if (depth1 == depth2) {\n        dx1 = 0.5;\n        dx2 = 0.5;\n      }\n      if (height1 == height2) {\n        dy1 = 0.5;\n        dy2 = 0.5;\n      }\n      if (width1 == width2) {\n        dz1 = 0.5;\n        dz2 = 0.5;\n      }\n      return (x111 * dx2 * dy2 * dz2 + x112 * dx2 * dy2 * dz1 + x121 * dx2 * dy1 *dz2 + x122 * dx2 * dy1 * dz1 +\n              x211 * dx1 * dy2 * dz2 + x212 * dx1 * dy2 * dz1 + x221 * dx1 * dy1 *dz2 + x222 * dx1 * dy1 * dz1);\n    }`},eu=(e,t,r,n,i,o)=>{let a=e.dims,s=Vs(o,t.axes,a.length),u=Ws(a,n,i,t.axes),l=n.slice();0===n.length&&(l=a.map(((e,t)=>0===e?1:u[t]/e)),"stretch"!==t.keepAspectRatioPolicy&&(u=Hs(a,l,t)));let h=rn("output",e.dataType,u.length),c=tn("input",e.dataType,a.length),f=Ur.size(u),d=a.length===u.length&&a.every(((e,t)=>e===u[t])),p="tf_crop_and_resize"===t.coordinateTransformMode,y=t.extrapolationValue,m=c.type.value;return{name:"Resize",shaderCache:{hint:`${t.cacheKey}|${r}|${l.length>0?l:""}|${i.length>0?i:""}|${s.length>0?s:""}|${d}|${a}`,inputDependencies:["rank"]},getShaderSource:e=>`\n      ${d?"":`\n      ${zs(t.coordinateTransformMode,m)};\n      ${(()=>{switch(t.mode){case"nearest":return`\n              ${Xs(c,a)};\n              ${Gs(t.nearestMode,r,m)};\n              ${Ys(c,h,a,u,l.length,s.length,p)};\n              `;case"linear":return`\n              ${qs(h,a,u,l.length,s.length)};\n              ${(()=>{if(2===a.length||4===a.length)return`${Zs(c,h,a,p,y)}`;if(3===a.length||5===a.length)return`${Qs(c,h,a,p,y)}`;throw Error("Linear mode only supports input dims 2, 3, 4 and 5 are supported in linear mode.")})()};\n            `;case"cubic":return`\n            ${(()=>{if(2===a.length||4===a.length)return`${Js(c,h,a,u,l,s,t.cubicCoeffA,p,t.extrapolationValue,t.excludeOutside)}`;throw Error("Cubic mode only supports input dims 2 and 4 are supported in linear mode.")})()};\n            `;default:throw Error("Invalid resize mode")}})()};\n      `}\n      ${e.registerUniform("output_size","u32").registerUniform("scales","f32",l.length).registerUniform("roi","f32",s.length).declareVariables(c,h)}\n      ${e.mainStart()}\n        ${e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}\n        ${d?"output[global_idx] = input[global_idx];":`\n        let output_indices = ${h.offsetToIndices("global_idx")};\n        var input_indices: ${c.type.indices};\n        ${(()=>{switch(t.mode){case"nearest":return`input_indices = calculateInputIndicesFromOutputIndices(output_indices);\n                if (checkInputIndices(input_indices)) {\n                  output[global_idx] = ${c.getByIndices("input_indices")};\n                } else {\n                  output[global_idx] = ${t.extrapolationValue};\n                }`;case"linear":return`output[global_idx] = ${2===a.length||4===a.length?"bilinearInterpolation":"trilinearInterpolation"}(output_indices);`;case"cubic":return"output[global_idx] = bicubicInterpolation(output_indices);";default:throw Error(`Unsupported resize mode: ${t.mode}`)}})()};\n`}\n      }`,getRunData:()=>({outputs:[{dims:u,dataType:e.dataType}],dispatchGroup:{x:Math.ceil(f/64)},programUniforms:[{type:"uint32",data:f},{type:"float32",data:l},{type:"float32",data:s},...Yr(a),...Yr(u)]})}},tu=e=>{let t=e.customDataBuffer;return new Uint32Array(t,t.byteOffset,1)[0]},ru=(e,t)=>{let r=[],n=[],i=[],o=tu(e);if(0!==t.antialias)throw Error("Only default value (0) for Antialias attribute is supported");js(e.inputs,t,o,r,n,i),e.compute(eu(e.inputs[0],t,o,r,n,i),{inputs:[0]})},nu=e=>{let t=e.antialias,r=e.axes,n=e.coordinateTransformMode,i=e.cubicCoeffA,o=0!==e.excludeOutside,a=e.extrapolationValue,s=e.keepAspectRatioPolicy,u=e.mode,l=""===e.nearestMode?"simple":e.nearestMode;return Br({antialias:t,axes:r,coordinateTransformMode:n,cubicCoeffA:i,excludeOutside:o,extrapolationValue:a,keepAspectRatioPolicy:s,mode:u,nearestMode:l})}})),Bl=st((()=>{qu(),el(),Qu(),tl(),iu=e=>{if(!e||e.length<3)throw new Error("layerNorm requires at least 3 inputs.");let t=e[0],r=e[1],n=e[2];if(t.dataType!==r.dataType||t.dataType!==n.dataType)throw new Error("All inputs must have the same data type");if(3!==t.dims.length&&2!==t.dims.length)throw new Error("Input must be 2D or 3D");if(3!==r.dims.length&&2!==r.dims.length)throw new Error("Skip must be 2D or 3D");let i=t.dims[t.dims.length-1],o=t.dims[t.dims.length-2];if(r.dims[r.dims.length-1]!==i)throw new Error("Skip must have the same hidden size as input");if(r.dims[r.dims.length-2]!==o)throw new Error("Skip must have the same sequence length as input");if(1!==n.dims.length)throw new Error("Gamma must be 1D");if(n.dims[n.dims.length-1]!==i)throw new Error("Gamma must have the same hidden size as input");if(e.length>3){let t=e[3];if(1!==t.dims.length)throw new Error("Beta must be 1D");if(t.dims[t.dims.length-1]!==i)throw new Error("Beta must have the same hidden size as input")}if(e.length>4){let t=e[4];if(1!==t.dims.length)throw new Error("Bias must be 1D");if(t.dims[t.dims.length-1]!==i)throw new Error("Bias must have the same hidden size as input")}},ou=(e,t,r,n)=>{let i=e[0].dims,o=i,a=Ur.size(i),s=i.slice(-1)[0],u=n?i.slice(0,-1).concat(1):[],l=e.length>3,h=e.length>4,c=n&&r>1,f=n&&r>2,d=r>3,p=Xr(s),y=[tn("x",e[0].dataType,e[0].dims,p),tn("skip",e[1].dataType,e[1].dims,p),tn("gamma",e[2].dataType,e[2].dims,p)];l&&y.push(tn("beta",e[3].dataType,e[3].dims,p)),h&&y.push(tn("bias",e[4].dataType,e[4].dims,p)),y.push(rn("output",e[0].dataType,o,p)),c&&y.push(rn("meanOutput",1,u)),f&&y.push(rn("invStdOutput",1,u)),d&&y.push(rn("inputSkipBiasSum",e[0].dataType,o,p));let m=Hr(e[0].dataType),g=[{dims:o,dataType:e[0].dataType}];return r>1&&g.push({dims:u,dataType:1}),r>2&&g.push({dims:u,dataType:1}),r>3&&g.push({dims:i,dataType:e[0].dataType}),{name:"SkipLayerNormalization",shaderCache:{hint:t.cacheKey},getShaderSource:e=>`\n      const hiddenSize: f32 = ${s};\n      const hiddenSizeVectorized: u32 = ${s/p};\n      const epsilon: f32 = ${t.epsilon};\n\n      ${e.declareVariables(...y)}\n\n      ${e.mainStart()}\n        ${e.guardAgainstOutOfBoundsWorkgroupSizes(a/s)}\n        let offset = global_idx * hiddenSizeVectorized;\n        var sum = ${Kr("f32",p)};\n        var squareSum = ${Kr("f32",p)};\n        for (var i: u32 = 0; i < hiddenSizeVectorized; i++) {\n          let skipValue = skip[offset + i];\n          let biasValue = ${h?"bias[i]":"0.0"};\n          let inputValue = x[offset + i];\n          let value = inputValue + skipValue + biasValue;\n          ${d?"inputSkipBiasSum[offset + i] = value;":""}\n          output[offset + i] = value;\n          let f32Value = ${Zr(m,p,"value")};\n          sum += f32Value;\n          squareSum += f32Value * f32Value;\n        }\n        let mean = ${Jr("sum",p)} / hiddenSize;\n        let invStdDev = inverseSqrt(${Jr("squareSum",p)} / hiddenSize - mean * mean + epsilon);\n        ${c?"meanOutput[global_idx] = mean;":""}\n        ${f?"invStdOutput[global_idx] = invStdDev;":""}\n        for (var i: u32 = 0; i < hiddenSizeVectorized; i++) {\n          output[offset + i] = (output[offset + i] - ${m}(mean)) * ${m}(invStdDev) * gamma[i]\n           + ${l?"beta[i]":"0.0"};\n        }\n      }`,getRunData:()=>({outputs:g,dispatchGroup:{x:Math.ceil(a/s/64)}})}},au=(e,t)=>{iu(e.inputs);let r=[0];e.outputCount>1&&r.push(-3),e.outputCount>2&&r.push(-3),e.outputCount>3&&r.push(3),e.compute(ou(e.inputs,t,e.outputCount,!1),{outputs:r})},su=e=>{let t=e.epsilon;return Br({epsilon:t})}})),Nl=st((()=>{qu(),el(),Qu(),tl(),uu=(e,t)=>{if(!e||e.length<1)throw new Error("too few inputs");if(0!==t.axes.length){if(t.axes.length!==t.starts.length||t.axes.length!==t.ends.length)throw new Error("axes, starts and ends must have the same length")}else if(t.starts.length!==t.ends.length)throw new Error("starts and ends must have the same length");e.slice(1).forEach(((t,r)=>{if(6!==e[r+1].dataType&&7!==e[r+1].dataType)throw new Error(`Input ${r} must be an array of int32 or int64`)}))},lu=(e,t)=>{let r=[];if(e.length>t)if(7===e[t].dataType)e[t].getBigInt64Array().forEach((e=>r.push(Number(e))));else{if(6!==e[t].dataType)throw new Error(`Input ${t} must be an array of int32 or int64`);e[t].getInt32Array().forEach((e=>r.push(Number(e))))}return r},hu=(e,t)=>{if(e.length>1){let t=lu(e,1),r=lu(e,2),n=lu(e,3);return 0===n.length&&(n=[...Array(e[0].dims.length).keys()]),Br({starts:t,ends:r,axes:n})}return t},cu=(e,t,r,n,i)=>{let o=e;return e<0&&(o+=r[n[t]]),i[t]<0?Math.max(0,Math.min(o,r[n[t]]-1)):Math.max(0,Math.min(o,r[n[t]]))},fu=(e,t,r)=>`fn calculateInputIndices(output_indices: ${t.type.indices}) -> ${e.type.indices} {\n          var input_indices: ${e.type.indices};\n          var carry = 0u;\n          for (var i = ${r.length}; i >= 0; i--) {\n            let input_shape_i = ${Qr("uniforms.input_shape","i",r.length)};\n            let steps_i = ${Qr("uniforms.steps","i",r.length)};\n            let signs_i = ${Qr("uniforms.signs","i",r.length)};\n            let starts_i = ${Qr("uniforms.starts","i",r.length)};\n            var output_index = ${t.indicesGet("output_indices","i")};\n            var input_index = output_index * steps_i + starts_i + carry;\n            carry = input_index / input_shape_i;\n            input_index = input_index % input_shape_i;\n            if (signs_i < 0) {\n              input_index = input_shape_i - input_index - 1u + starts_i;\n            }\n            ${e.indicesSet("input_indices","i","input_index")};\n          }\n          return input_indices;\n      }`,du=(e,t)=>{let r=e[0].dims,n=Ur.size(r),i=t.axes.length>0?Ur.normalizeAxes(t.axes,r.length):[...Array(r.length).keys()],o=lu(e,4);o.forEach((e=>0!==e||(()=>{throw new Error("step cannot be 0")}))),0===o.length&&(o=Array(i.length).fill(1));let a=t.starts.map(((e,t)=>cu(e,t,r,i,o))),s=t.ends.map(((e,t)=>cu(e,t,r,i,o)));if(i.length!==a.length||i.length!==s.length)throw new Error("start, ends and axes should have the same number of elements");if(i.length!==r.length)for(let e=0;e<r.length;++e)i.includes(e)||(a.splice(e,0,0),s.splice(e,0,r[e]),o.splice(e,0,1));let u=o.map((e=>Math.sign(e)));o.forEach(((e,t,r)=>{if(e<0){let n=(s[t]-a[t])/e,i=a[t],u=i+n*o[t];a[t]=u,s[t]=i,r[t]=-e}}));let l=r.slice(0);i.forEach(((e,t)=>{l[e]=Math.ceil((s[e]-a[e])/o[e])}));let h={dims:l,dataType:e[0].dataType},c=rn("output",e[0].dataType,l.length),f=tn("input",e[0].dataType,e[0].dims.length),d=Ur.size(l),p=[{name:"outputSize",type:"u32"},{name:"starts",type:"u32",length:a.length},{name:"signs",type:"i32",length:u.length},{name:"steps",type:"u32",length:o.length}],y=[{type:"uint32",data:d},{type:"uint32",data:a},{type:"int32",data:u},{type:"uint32",data:o},...Yr(e[0].dims),...Yr(l)];return{name:"Slice",shaderCache:{hint:`${u.length}_${a.length}_${o.length}`,inputDependencies:["rank"]},getShaderSource:e=>`\n      ${e.registerUniforms(p).declareVariables(f,c)}\n        ${fu(f,c,r)}\n        ${e.mainStart()}\n          ${e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}\n          let output_indices = ${c.offsetToIndices("global_idx")};\n          let input_indices = calculateInputIndices(output_indices);\n          ${c.setByOffset("global_idx",f.getByIndices("input_indices"))}\n      }`,getRunData:()=>({outputs:[h],dispatchGroup:{x:Math.ceil(n/64)},programUniforms:y})}},pu=(e,t)=>{uu(e.inputs,t);let r=hu(e.inputs,t);e.compute(du(e.inputs,r),{inputs:[0]})},yu=e=>{let t=e.starts,r=e.ends,n=e.axes;return Br({starts:t,ends:r,axes:n})}})),Fl=st((()=>{el(),Qu(),tl(),mu=e=>{if(!e||1!==e.length)throw new Error("Softmax op requires 1 input.")},gu=(e,t)=>{let r=e.dims,n=Ur.size(r),i=t.axis;if(i<0&&(i=r.length+i),i<r.length-1)throw new Error("softmax only supports last axis for now.");let o=r[i],a=n/o,s=Xr(o),u=o/s,l=tn("x",e.dataType,e.dims,s),h=rn("result",e.dataType,e.dims,s),c=l.type.value,f="f32"===Hr(e.dataType)?`var threadMax = ${c}(-3.402823e+38f);`:`var threadMax = ${c}(-65504.0h);`;return{name:"Softmax",shaderCache:{hint:`${s}`,inputDependencies:["type"]},getRunData:()=>({outputs:[{dims:r,dataType:e.dataType}],dispatchGroup:{x:a},programUniforms:[{type:"uint32",data:u}]}),getShaderSource:e=>`\n      var<workgroup> rowMaxShared : ${c};\n      var<workgroup> rowSumShared : ${c};\n      var<workgroup> threadShared : array<${c}, 64>;\n\n      fn getValue(row: i32, col: i32, row_stride: i32) -> ${c} {\n        let index = row * row_stride + col;\n        return x[index];\n      }\n\n      fn setValue(row: i32, col: i32, row_stride: i32, value: ${c}) {\n        let index = row * row_stride + col;\n        result[index] = value;\n      }\n      ${e.registerUniform("packedCols","i32").declareVariables(l,h)}\n      ${e.mainStart()}\n        let gindex = i32(global_idx);\n        let lindex = i32(local_idx);\n        const wg = 64;\n        let row = gindex / wg;\n        let cols = uniforms.packedCols;\n        let row_stride : i32 = uniforms.packedCols;\n\n        // find the rows max\n        ${f}\n        for (var col = lindex; col < cols; col += wg) {\n          let value = getValue(row, col, row_stride);\n          threadMax = max(threadMax, value);\n        }\n        if (lindex < cols) {\n          threadShared[lindex] = threadMax;\n        }\n        workgroupBarrier();\n\n        var reduceSize = min(cols, wg);\n        for (var currSize = reduceSize >> 1;  currSize > 0; currSize = reduceSize >> 1) {\n          reduceSize = currSize + (reduceSize & 1);\n          if (lindex < currSize) {\n            threadShared[lindex] = max(threadShared[lindex], threadShared[lindex + reduceSize]);\n          }\n          workgroupBarrier();\n        }\n        if (lindex == 0) {\n          rowMaxShared = ${c}(${((e,t)=>4===t?`max(max(${e}.x, ${e}.y), max(${e}.z, ${e}.w))`:2===t?`max(${e}.x, ${e}.y)`:3===t?`max(max(${e}.x, ${e}.y), ${e}.z)`:e)("threadShared[0]",s)});\n        }\n        workgroupBarrier();\n\n        // find the rows sum\n        var threadSum = ${c}(0.0);\n        for (var col = lindex; col < cols; col += wg) {\n          let subExp = exp(getValue(row, col, row_stride) - rowMaxShared);\n          threadSum += subExp;\n        }\n        threadShared[lindex] = threadSum;\n        workgroupBarrier();\n\n        for (var currSize = wg >> 1;  currSize > 0; currSize = currSize >> 1) {\n          if (lindex < currSize) {\n            threadShared[lindex] = threadShared[lindex] + threadShared[lindex + currSize];\n          }\n          workgroupBarrier();\n        }\n        if (lindex == 0) {\n          rowSumShared = ${c}(${Jr("threadShared[0]",s)});\n        }\n        workgroupBarrier();\n\n        // calculate final value for each element in the row\n        for (var col = lindex; col < cols; col += wg) {\n          let value = exp(getValue(row, col, row_stride) - rowMaxShared) / rowSumShared;\n          setValue(row, col, row_stride, value);\n        }\n      }`}},wu=(e,t)=>{mu(e.inputs),e.compute(gu(e.inputs[0],t))},vu=e=>Br({axis:e.axis})})),Ul=st((()=>{el(),Qu(),tl(),bu=e=>{if(!e||e.length<1)throw new Error("too few inputs")},xu=(e,t)=>{let r=[],n=t.numOutputs;return e[1].dims[0]>0&&(e[1].getBigInt64Array().forEach((e=>r.push(Number(e)))),n=r.length),Br({numOutputs:n,axis:t.axis,splitSizes:r})},_u=e=>`\nfn calculateOutputIndex(index: u32) -> u32 {\n    for (var i: u32 = 0u; i < ${e}u; i += 1u ) {\n    if (index < ${Qr("uniforms.size_in_split_axis","i",e)}) {\n        return i;\n    }\n    }\n    return ${e}u;\n}`,Su=e=>{let t=e.length,r=[];for(let n=0;n<t;++n){let i=e[n].setByIndices("indices","input[global_idx]");1===t?r.push(i):0===n?r.push(`if (output_number == ${n}u) { ${i} }`):n===t-1?r.push(`else { ${i} }`):r.push(`else if (output_number == ${n}) { ${i} }`)}return`\n      fn writeBufferData(output_number: u32, indices: ${e[0].type.indices}, global_idx: u32) {\n        ${r.join("\n")}\n      }`},Tu=(e,t)=>{let r=e[0].dims,n=Ur.size(r),i=e[0].dataType,o=Ur.normalizeAxis(t.axis,r.length),a=new Array(t.numOutputs),s=tn("input",i,r),u=new Array(t.numOutputs),l=[],h=[],c=0,f=[{type:"uint32",data:n}];for(let n=0;n<t.numOutputs;n++){c+=t.splitSizes[n],u[n]=c;let o=r.slice();o[t.axis]=t.splitSizes[n],h.push(o),a[n]=rn(`output${n}`,i,o),l.push({dims:h[n],dataType:e[0].dataType})}f.push({type:"uint32",data:u}),f.push(...Yr(r)),h.forEach((e=>f.push(...Yr(e))));return{name:"Split",shaderCache:{hint:t.cacheKey,inputDependencies:["rank"]},getShaderSource:e=>`\n  ${e.registerUniform("input_size","u32").registerUniform("size_in_split_axis","u32",u.length).declareVariables(s,...a)}\n  ${_u(u.length)}\n  ${Su(a)}\n\n  ${e.mainStart()}\n    ${e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.input_size")}\n\n    var indices = ${s.offsetToIndices("global_idx")};\n    var index = ${s.indicesGet("indices",o)};\n    let output_number = calculateOutputIndex(index);\n    if (output_number != 0) {\n      index -= ${Qr("uniforms.size_in_split_axis","output_number - 1u",u.length)};\n      ${s.indicesSet("indices",o,"index")};\n    }\n    writeBufferData(output_number, indices, global_idx);\n  }`,getRunData:()=>({outputs:l,dispatchGroup:{x:Math.ceil(n/64)},programUniforms:f})}},Eu=(e,t)=>{bu(e.inputs);let r=1===e.inputs.length?t:xu(e.inputs,t);e.compute(Tu(e.inputs,r),{inputs:[0]})},Ou=e=>{let t=e.axis,r=e.splitSizes,n=e.numOutputs<0?r.length:e.numOutputs;if(n!==r.length)throw new Error("numOutputs and splitSizes lengh must be equal");return Br({axis:t,numOutputs:n,splitSizes:r})}})),jl=st((()=>{qu(),el(),tl(),Au=e=>Array.from(e.getBigInt64Array(),Number),Iu=e=>{if(!e||2!==e.length)throw new Error("Tile requires 2 inputs.");if(1!==e[0].dataType&&6!==e[0].dataType&&12!==e[0].dataType)throw new Error("Tile only support float, int32, and uint32 data types");if(7!==e[1].dataType)throw new Error("Tile `repeats` input should be of int64 data type");if(1!==e[1].dims.length)throw new Error("Tile `repeats` input should be 1-D");if(Au(e[1]).length!==e[0].dims.length)throw new Error("Tile `repeats` input should have same number of elements as rank of input data tensor")},Pu=(e,t)=>{let r=[];for(let n=0;n<e.length;++n)r.push(e[n]*t[n]);return r},ku=e=>{let t=e[0].dims,r=Au(e[1]),n=Pu(t,r),i=Ur.size(n),o=e[0].dataType,a=tn("input",o,t.length),s=rn("output",o,n.length);return{name:"Tile",shaderCache:{hint:`${r}`,inputDependencies:["rank"]},getRunData:()=>({outputs:[{dims:n,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(i/64)},programUniforms:[{type:"uint32",data:i},...Yr(e[0].dims),...Yr(n)]}),getShaderSource:e=>`\n      const inputShape = ${a.indices(...t)};\n      ${e.registerUniform("output_size","u32").declareVariables(a,s)}\n      ${e.mainStart()}\n      ${e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}\n      let output_indices = ${s.offsetToIndices("global_idx")};\n      var input_indices: ${a.type.indices};\n      for (var i = 0; i < ${t.length}; i++) {\n        let input_dim_i = ${a.indicesGet("uniforms.input_shape","i")};\n        let input_dim_value = ${s.indicesGet("output_indices","i")}  % input_dim_i;\n\n        ${a.indicesSet("input_indices","i","input_dim_value")}\n      }\n      ${s.setByOffset("global_idx",a.getByIndices("input_indices"))}\n    }`}},Cu=e=>{Iu(e.inputs),e.compute(ku(e.inputs),{inputs:[0]})}})),zl=st((()=>{qu(),el(),tl(),$u=(e,t,r,n,i)=>{let o,a=rn("output_data",i,r.length,4),s=tn("a_data",t[1].dataType,t[1].dims.length,4),u=tn("b_data",t[2].dataType,t[2].dims.length,4),l=tn("c_data",t[0].dataType,t[0].dims.length,4),h=(e,t,r)=>`select(${t}, ${e}, ${r})`;if(n){let e=(e,t,r="")=>{let n=`a_data[index_a${t}][component_a${t}]`,i=`b_data[index_b${t}][component_b${t}]`,o=`bool(c_data[index_c${t}] & ${4278190080>>>8*(3-t)}u)`;return`\n            let output_indices${t} = ${a.offsetToIndices(`global_idx * 4u + ${t}u`)};\n            let offset_a${t} = ${s.broadcastedIndicesToOffset(`output_indices${t}`,a)};\n            let offset_b${t} = ${u.broadcastedIndicesToOffset(`output_indices${t}`,a)};\n            let offset_c${t} = ${l.broadcastedIndicesToOffset(`output_indices${t}`,a)};\n            let index_a${t} = offset_a${t} / 4u;\n            let index_b${t} = offset_b${t} / 4u;\n            let index_c${t} = offset_c${t} / 4u;\n            let component_a${t} = offset_a${t} % 4u;\n            let component_b${t} = offset_b${t} % 4u;\n            ${e}[${t}] = ${r}(${h(n,i,o)});\n          `};o=9===i?`\n            var data = vec4<u32>(0);\n            ${e("data",0,"u32")}\n            ${e("data",1,"u32")}\n            ${e("data",2,"u32")}\n            ${e("data",3,"u32")}\n            output_data[global_idx] = dot(vec4<u32>(0x1, 0x100, 0x10000, 0x1000000), vec4<u32>(data));`:`\n            ${e("output_data[global_idx]",0)}\n            ${e("output_data[global_idx]",1)}\n            ${e("output_data[global_idx]",2)}\n            ${e("output_data[global_idx]",3)}\n          `}else o=a.setByOffset("global_idx",h(s.getByOffset("global_idx"),u.getByOffset("global_idx"),l.getByOffset("global_idx")));return`\n        ${e.registerUniform("vec_size","u32").declareVariables(l,s,u,a)}\n        ${e.mainStart()}\n        ${e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.vec_size")}\n        ${o}\n      }`},Ru=e=>{let t=e[1].dims,r=e[2].dims,n=e[0].dims,i=e[1].dataType,o=!(Ur.areEqual(t,r)&&Ur.areEqual(r,n)),a=t,s=Ur.size(t);if(o){let e=Fr.calcShape(Fr.calcShape(t,r,!1),n,!1);if(!e)throw new Error("Can't perform where op on the given tensors");a=e,s=Ur.size(a)}let u=Math.ceil(s/4);return{name:"Where",shaderCache:{inputDependencies:["rank","rank","rank"]},getShaderSource:t=>$u(t,e,a,o,i),getRunData:()=>({outputs:[{dims:a,dataType:i}],dispatchGroup:{x:Math.ceil(s/64/4)},programUniforms:[{type:"uint32",data:u},...Yr(n),...Yr(t),...Yr(r),...Yr(a)]})}},Du=e=>{e.compute(Ru(e.inputs))}})),Gl=st((()=>{ol(),al(),sl(),ul(),hl(),cl(),fl(),bl(),Sl(),Tl(),El(),Ol(),Al(),Il(),Pl(),kl(),Cl(),vl(),$l(),Rl(),Dl(),Ml(),il(),Ll(),Bl(),Nl(),Fl(),Ul(),jl(),rl(),ll(),zl(),Mu=new Map([["Abs",[Pi]],["Acos",[ki]],["Acosh",[Ci]],["Add",[mo]],["ArgMax",[ci,fi]],["ArgMin",[hi,fi]],["Asin",[$i]],["Asinh",[Ri]],["Atan",[Di]],["Atanh",[Mi]],["Attention",[vi]],["AveragePool",[As,Os]],["BatchNormalization",[Si]],["BiasAdd",[Oi]],["BiasSplitGelu",[co]],["Cast",[Bi,Li]],["Ceil",[Ui]],["Clip",[Fi]],["Concat",[ko,Co]],["Conv",[ia,ta]],["ConvTranspose",[wa,da]],["Cos",[ji]],["Cosh",[zi]],["CumSum",[ba,xa]],["Div",[go]],["Einsum",[ka,Ca]],["Elu",[Vi,Gi]],["Equal",[wo]],["Erf",[Hi]],["Exp",[qi]],["Expand",[La]],["Floor",[Yi]],["FusedConv",[ia,ta]],["Gather",[Ua,Fa]],["GatherElements",[Va,Ga]],["Gelu",[Xi]],["Gemm",[Ya,qa]],["GlobalAveragePool",[ks,Ps]],["GlobalMaxPool",[Ms,Ds]],["Greater",[_o]],["GreaterOrEqual",[To]],["InstanceNormalization",[Ja]],["LayerNormalization",[ts]],["LeakyRelu",[Ki,Gi]],["Less",[So]],["LessOrEqual",[Eo]],["Log",[uo]],["MatMul",[Ko]],["MaxPool",[$s,Rs]],["Mul",[vo]],["MultiHeadAttention",[ss,ns]],["Neg",[Ji]],["Not",[Zi]],["Pad",[ms]],["Pow",[bo]],["Range",[Ns]],["Reciprocal",[Qi]],["ReduceMin",[ii]],["ReduceMean",[Qn]],["ReduceMax",[ni]],["ReduceSum",[ai]],["ReduceProd",[oi]],["ReduceL1",[ei]],["ReduceL2",[ti]],["ReduceLogSum",[ui]],["ReduceLogSumExp",[ri]],["ReduceSumSquare",[si]],["Relu",[eo]],["Resize",[ru,nu]],["Sigmoid",[to]],["Sin",[ro]],["Sinh",[no]],["Slice",[pu,yu]],["SkipLayerNormalization",[au,su]],["Split",[Eu,Ou]],["Sqrt",[io]],["Softmax",[wu,vu]],["Sub",[xo]],["Tan",[oo]],["Tanh",[ao]],["ThresholdedRelu",[so,Gi]],["Tile",[Cu]],["Transpose",[pn,yn]],["Where",[Du]]])})),Vl=st((()=>{Pt(),Xu(),tl(),Lu=class{constructor(e){this.backend=e,this.repo=new Map,this.attributesBound=!1}getArtifact(e){return this.repo.get(e)}setArtifact(e,t){this.repo.set(e,t)}run(e,t,r){qe(e.programInfo.name);let n=this.backend.getComputePassEncoder();if(this.backend.writeTimestamp(2*this.backend.pendingDispatchNumber),"capturing"===this.backend.sessionStatus){let n={kernelId:this.backend.currentKernelId,computePipeline:e.computePipeline,bindGroup:t,dispatchGroup:r};this.backend.capturedCommandList.get(this.backend.currentSessionId).push(n)}n.setPipeline(e.computePipeline),n.setBindGroup(0,t),n.dispatchWorkgroups(...r),this.backend.writeTimestamp(2*this.backend.pendingDispatchNumber+1),this.backend.pendingDispatchNumber++,(this.backend.pendingDispatchNumber>=this.backend.maxDispatchNumber||"at-passes"===this.backend.queryType)&&this.backend.endComputePass(),this.backend.pendingDispatchNumber>=this.backend.maxDispatchNumber&&this.backend.flush(),Ye(e.programInfo.name)}dispose(){}build(e,t){qe(e.name);let r=this.backend.device,n=[];r.features.has("shader-f16")&&n.push("enable f16;");let i=an(t),o=e.getShaderSource(i),a=`${n.join("\n")}\n${i.additionalImplementations}\n${o}`,s=r.createShaderModule({code:a,label:e.name});Or("verbose",(()=>`[WebGPU] ${e.name} shader code: ${a}`));let u=r.createComputePipeline({compute:{module:s,entryPoint:"main"},layout:"auto",label:e.name});return Ye(e.name),{programInfo:e,computePipeline:u}}normalizeDispatchGroupSize(e){let t="number"==typeof e?e:e.x,r="number"==typeof e?1:e.y||1,n="number"==typeof e?1:e.z||1,i=this.backend.device.limits.maxComputeWorkgroupsPerDimension;if(t<=i&&r<=i&&n<=i)return[t,r,n];let o=t*r*n,a=Math.ceil(Math.sqrt(o));if(a>i){if(a=Math.ceil(Math.cbrt(o)),a>i)throw new Error("Total dispatch size exceeds WebGPU maximum.");return[a,a,a]}return[a,a,1]}}})),Wl=st((()=>{Pt(),qu(),Xu(),Ku(),Ju(),Gl(),Vl(),Bu=(e,t)=>{if(t.length!==e.length)throw new Error(`inputDependencies length ${t.length} is not equal to inputTensors length ${e.length}.`);let r=[];for(let n=0;n<e.length;++n){let i=e[n].dataType;switch(t[n]){case"none":r.push("");break;case"type":r.push(`${i}`);break;case"rank":{let t=e[n].dims.length;r.push(`${i};${t}`);break}case"dims":{let t=e[n].dims.join(",");r.push(`${i};${t}`);break}default:throw new Error(`unsupported input dependency: ${t[n]}`)}}return r.join("|")},Nu=(e,t,r)=>{let n=e.name;return e.shaderCache?.hint&&(n+="["+e.shaderCache.hint+"]"),n+=":"+r+`:${Bu(t,e.shaderCache?.inputDependencies??new Array(t.length).fill("dims"))}`,n},Fu=class{constructor(){this.currentSessionId=null,this.currentKernelId=null,this.commandEncoder=null,this.computePassEncoder=null,this.maxDispatchNumber=16,this.pendingDispatchNumber=0,this.pendingKernels=[],this.pendingQueries=new Map,this.sessionStatus="default",this.capturedCommandList=new Map,this.capturedPendingKernels=new Map,this.sessionExternalDataMapping=new Map}get currentKernelCustomData(){if(null===this.currentKernelId)throw new Error("currentKernelCustomData(): currentKernelId is null. (should not happen)");let e=this.kernelCustomData.get(this.currentKernelId);return e||(e={},this.kernelCustomData.set(this.currentKernelId,e)),e}async initialize(e,t){this.env=e;let r=[],n={requiredLimits:{maxComputeWorkgroupStorageSize:t.limits.maxComputeWorkgroupStorageSize,maxComputeWorkgroupsPerDimension:t.limits.maxComputeWorkgroupsPerDimension,maxStorageBufferBindingSize:t.limits.maxStorageBufferBindingSize,maxBufferSize:t.limits.maxBufferSize,maxComputeInvocationsPerWorkgroup:t.limits.maxComputeInvocationsPerWorkgroup,maxComputeWorkgroupSizeX:t.limits.maxComputeWorkgroupSizeX,maxComputeWorkgroupSizeY:t.limits.maxComputeWorkgroupSizeY,maxComputeWorkgroupSizeZ:t.limits.maxComputeWorkgroupSizeZ},requiredFeatures:r};t.features.has("chromium-experimental-timestamp-query-inside-passes")?r.push("chromium-experimental-timestamp-query-inside-passes"):t.features.has("timestamp-query")&&r.push("timestamp-query"),t.features.has("shader-f16")&&r.push("shader-f16"),this.device=await t.requestDevice(n),this.gpuDataManager=Mr(this),this.programManager=new Lu(this),this.kernels=new Map,this.kernelPersistentData=new Map,this.kernelCustomData=new Map,this.kernelUniformCache=new Map,this.kernelGpuBindGroupCache=new Map,Tr(e.logLevel,!!e.debug),this.device.onuncapturederror=e=>{e.error instanceof GPUValidationError&&console.error(`An uncaught WebGPU validation error was raised: ${e.error.message}`)},Object.defineProperty(this.env.webgpu,"device",{value:this.device}),this.setQueryType()}dispose(){typeof this.querySet<"u"&&this.querySet.destroy(),this.gpuDataManager.dispose()}getCommandEncoder(){return this.commandEncoder||(this.commandEncoder=this.device.createCommandEncoder(),this.setQueryType(),"none"!==this.queryType&&typeof this.querySet>"u"&&(this.querySet=this.device.createQuerySet({type:"timestamp",count:2*this.maxDispatchNumber}),this.queryResolveBuffer=this.device.createBuffer({size:2*this.maxDispatchNumber*8,usage:GPUBufferUsage.COPY_SRC|GPUBufferUsage.QUERY_RESOLVE}))),this.commandEncoder}getComputePassEncoder(){if(!this.computePassEncoder){let e=this.getCommandEncoder(),t={};"at-passes"===this.queryType&&(t.timestampWrites={querySet:this.querySet,beginningOfPassWriteIndex:2*this.pendingDispatchNumber,endOfPassWriteIndex:2*this.pendingDispatchNumber+1}),this.computePassEncoder=e.beginComputePass(t)}return this.computePassEncoder}endComputePass(){this.computePassEncoder&&(this.computePassEncoder.end(),this.computePassEncoder=null)}flush(){if(!this.commandEncoder)return;let e;qe(),this.endComputePass(),"none"!==this.queryType&&(this.commandEncoder.resolveQuerySet(this.querySet,0,2*this.pendingDispatchNumber,this.queryResolveBuffer,0),e=this.device.createBuffer({size:2*this.pendingDispatchNumber*8,usage:GPUBufferUsage.MAP_READ|GPUBufferUsage.COPY_DST}),this.pendingQueries.set(e,this.pendingKernels),this.pendingKernels=[],this.commandEncoder.copyBufferToBuffer(this.queryResolveBuffer,0,e,0,2*this.pendingDispatchNumber*8)),this.device.queue.submit([this.commandEncoder.finish()]),this.gpuDataManager.refreshPendingBuffers(),this.commandEncoder=null,this.pendingDispatchNumber=0,"none"!==this.queryType&&e.mapAsync(GPUMapMode.READ).then((()=>{let t=new BigUint64Array(e.getMappedRange()),r=this.pendingQueries.get(e);for(let e=0;e<t.length/2;e++){let n=r[e],i=n.kernelId,o=this.kernels.get(i),a=o.kernelType,s=o.kernelName,u=n.programName,l=n.inputTensorViews,h=n.outputTensorViews,c=t[2*e],f=t[2*e+1];typeof this.queryTimeBase>"u"&&(this.queryTimeBase=c);let d=Number(c-this.queryTimeBase),p=Number(f-this.queryTimeBase);if(!Number.isSafeInteger(d)||!Number.isSafeInteger(p))throw new RangeError("incorrect timestamp range");if(this.env.webgpu.profiling?.ondata)this.env.webgpu.profiling.ondata({version:1,inputsMetadata:l.map((e=>({dims:e.dims,dataType:dr(e.dataType)}))),outputsMetadata:h.map((e=>({dims:e.dims,dataType:dr(e.dataType)}))),kernelId:i,kernelType:a,kernelName:s,programName:u,startTime:d,endTime:p});else{let e="";l.forEach(((t,r)=>{e+=`input[${r}]: [${t.dims}] | ${dr(t.dataType)}, `}));let t="";h.forEach(((e,r)=>{t+=`output[${r}]: [${e.dims}] | ${dr(e.dataType)}, `})),console.log(`[profiling] kernel "${i}|${a}|${s}|${u}" ${e}${t}execution time: ${p-d} ns`)}We("GPU",`${u}::${c}::${f}`)}e.unmap(),this.pendingQueries.delete(e)})),Ye()}run(e,t,r,n,i){qe(e.name);let o=[];for(let e=0;e<t.length;++e){let r=this.gpuDataManager.get(t[e].data);if(!r)throw new Error(`no GPU data for input: ${t[e].data}`);o[e]=r}let{outputs:a,dispatchGroup:s,programUniforms:u}=e.getRunData(t),l=0===r.length?a.map(((e,t)=>t)):r;if(l.length!==a.length)throw new Error(`Output size ${l.length} must be equal to ${a.length}.`);let h,c=[],f=[];for(let e=0;e<a.length;++e){if(!Number.isInteger(l[e])||l[e]<-3||l[e]>=a.length)throw new Error(`Invalid output index: ${l[e]}`);if(-3===l[e])continue;let t=-1===l[e],r=-2===l[e],o=t||r?i(a[e].dataType,a[e].dims):n(l[e],a[e].dataType,a[e].dims),s=this.gpuDataManager.get(o.data);if(!s)throw new Error(`no GPU data for output: ${o.data}`);if(t&&this.temporaryData.push(s),r){let e=this.kernelPersistentData.get(this.currentKernelId);e||(e=[],this.kernelPersistentData.set(this.currentKernelId,e)),e.push(s)}c.push(o),f.push(s)}if(u){let e=this.kernelUniformCache.get(this.currentKernelId);e&&(this.compareProgramUniforms(e.programUniforms,u)||(this.gpuDataManager.release(e.gpuData.id),e=void 0)),e||(e=this.createCachedUniform(u),this.kernelUniformCache.set(this.currentKernelId,e)),h=e.binding}let d=this.programManager.normalizeDispatchGroupSize(s),p=1===d[1]&&1===d[2],y=Nu(e,t,p),m=this.programManager.getArtifact(y);if(m||(m=this.programManager.build(e,d),this.programManager.setArtifact(y,m),Or("info",(()=>`[artifact] key: ${y}, programName: ${e.name}`))),Or("info",(()=>`[ProgramManager] run "${e.name}" (key=${y}) with ${d[0]}x${d[1]}x${d[2]}`)),"none"!==this.queryType||"capturing"===this.sessionStatus){let e={kernelId:this.currentKernelId,programName:m.programInfo.name,inputTensorViews:t,outputTensorViews:c};this.pendingKernels.push(e),this.capturedPendingKernels.get(this.currentSessionId).push(e)}let g,w=this.kernelGpuBindGroupCache.get(this.currentKernelId);w||(w=[],this.kernelGpuBindGroupCache.set(this.currentKernelId,w));for(let e of w)if(this.checkCachedBindGroup(e,m,o,f,h)){g=e;break}if(!g)for(g=this.createCachedBindGroup(m,o,f,h),w.push(g);w.length>20;)w.shift();return this.programManager.run(m,g.binding,d),Ye(e.name),c}compareProgramUniforms(e,t){return e.length===t.length&&e.every(((e,r)=>e.type===t[r].type))}createCachedUniform(e){let t=0,r=[];e.forEach((e=>{let n="number"==typeof e.data?[e.data]:e.data;if(0===n.length)return;let i=n.length<=2?4*n.length:16;t=Math.ceil(t/i)*i,r.push(t),t+=n.length>4?16*Math.ceil(n.length/4):4*n.length}));t=16*Math.ceil(t/16);let n=new ArrayBuffer(t);e.forEach(((e,t)=>{let i=r[t],o="number"==typeof e.data?[e.data]:e.data;"int32"===e.type?new Int32Array(n,i,o.length).set(o):"uint32"===e.type?new Uint32Array(n,i,o.length).set(o):new Float32Array(n,i,o.length).set(o)}));let i=this.gpuDataManager.create(t,GPUBufferUsage.COPY_DST|GPUBufferUsage.UNIFORM);return this.device.queue.writeBuffer(i.buffer,0,n,0,t),{programUniforms:e,binding:{offset:0,size:t,buffer:i.buffer},gpuData:i}}checkCachedBindGroup(e,t,r,n,i){if(t!==e.artifact)return!1;let o=r.every(((t,r)=>t.permamentID===e.inputPermamentIDs[r])),a=n.every(((t,r)=>t.permamentID===e.outputPermamentIDs[r])),s=i===e.uniformBinding;return o&&a&&s}createCachedBindGroup(e,t,r,n){let i=[];for(let e of t)i.push({binding:i.length,resource:{buffer:e.buffer}});for(let e of r)i.push({binding:i.length,resource:{buffer:e.buffer}});return n&&i.push({binding:i.length,resource:n}),{binding:this.device.createBindGroup({layout:e.computePipeline.getBindGroupLayout(0),entries:i,label:e.programInfo.name}),artifact:e,inputPermamentIDs:t.map((e=>e.permamentID)),outputPermamentIDs:r.map((e=>e.permamentID)),uniformBinding:n}}upload(e,t){this.gpuDataManager.upload(e,t)}memcpy(e,t){this.gpuDataManager.memcpy(e,t)}async download(e,t){await this.gpuDataManager.download(e,t)}alloc(e){return this.gpuDataManager.create(e).id}free(e){return this.gpuDataManager.release(e)}createKernel(e,t,r,n){let i=Mu.get(e);if(!i)throw new Error(`kernel not implemented: ${e}`);let o={kernelType:e,kernelName:n,kernelEntry:i[0],attributes:[i[1],r]};this.kernels.set(t,o)}releaseKernel(e){let t=this.kernelPersistentData.get(e);if(t){for(let e of t)this.gpuDataManager.release(e.id);this.kernelPersistentData.delete(e)}this.kernelCustomData.delete(e),this.kernelGpuBindGroupCache.delete(e);let r=this.kernelUniformCache.get(e);r&&(this.gpuDataManager.release(r.gpuData.id),this.kernelUniformCache.delete(e)),this.kernels.delete(e)}computeKernel(e,t,r){let n=this.kernels.get(e);if(!n)throw new Error(`kernel not created: ${e}`);let i=n.kernelType,o=n.kernelName,a=n.kernelEntry,s=n.attributes;if(null!==this.currentKernelId)throw new Error(`kernel "[${i}] ${o}" is not allowed to be called recursively`);this.currentKernelId=e,s[0]&&(s[1]=s[0](s[1]),s[0]=void 0),Or("info",(()=>`[WebGPU] Start to run kernel "[${i}] ${o}"...`));let u=this.env.debug;this.temporaryData=[];try{return u&&this.device.pushErrorScope("validation"),a(t,s[1]),0}catch(e){return r.push(Promise.resolve(`[WebGPU] Kernel "[${i}] ${o}" failed. ${e}`)),1}finally{u&&r.push(this.device.popErrorScope().then((e=>e?`GPU validation error for kernel "[${i}] ${o}": ${e.message}`:null)));for(let e of this.temporaryData)this.gpuDataManager.release(e.id);this.temporaryData=[],this.currentKernelId=null}}registerBuffer(e,t,r,n){let i=this.sessionExternalDataMapping.get(e);i||(i=new Map,this.sessionExternalDataMapping.set(e,i));let o=i.get(t),a=this.gpuDataManager.registerExternalBuffer(r,n,o?.[1]);return i.set(t,[a,r]),a}unregisterBuffers(e){let t=this.sessionExternalDataMapping.get(e);t&&(t.forEach((e=>this.gpuDataManager.unregisterExternalBuffer(e[1]))),this.sessionExternalDataMapping.delete(e))}getBuffer(e){let t=this.gpuDataManager.get(e);if(!t)throw new Error(`no GPU data for buffer: ${e}`);return t.buffer}createDownloader(e,t,r){return async()=>{let n=await Rr(this,e,t);return Ar(n.buffer,r)}}writeTimestamp(e){"inside-passes"===this.queryType&&this.computePassEncoder.writeTimestamp(this.querySet,e)}setQueryType(){this.queryType="none",("default"===this.env.webgpu.profiling?.mode||this.env.wasm.trace)&&(this.device.features.has("chromium-experimental-timestamp-query-inside-passes")?this.queryType="inside-passes":this.device.features.has("timestamp-query")&&(this.queryType="at-passes"))}captureBegin(){Or("info","captureBegin");let e=this.capturedCommandList.get(this.currentSessionId),t=this.capturedPendingKernels.get(this.currentSessionId);e||(e=[],this.capturedCommandList.set(this.currentSessionId,e),t=[],this.capturedPendingKernels.set(this.currentSessionId,t)),this.flush(),this.sessionStatus="capturing"}captureEnd(){Or("info","captureEnd"),this.flush(),this.sessionStatus="default"}replay(){Or("info","replay"),this.sessionStatus="replaying";let e=this.capturedCommandList.get(this.currentSessionId),t=this.capturedPendingKernels.get(this.currentSessionId),r=e.length;this.pendingKernels=[];for(let n=0;n<r;n++){let r=this.getComputePassEncoder(),i=e[n];this.writeTimestamp(2*this.pendingDispatchNumber),r.setPipeline(i.computePipeline),r.setBindGroup(0,i.bindGroup),r.dispatchWorkgroups(...i.dispatchGroup),this.writeTimestamp(2*this.pendingDispatchNumber+1),this.pendingDispatchNumber++,"none"!==this.queryType&&this.pendingKernels.push(t[n]),(this.pendingDispatchNumber>=this.maxDispatchNumber||"at-passes"===this.queryType)&&this.endComputePass(),this.pendingDispatchNumber>=this.maxDispatchNumber&&this.flush()}this.flush(),this.sessionStatus="default"}onReleaseSession(e){this.unregisterBuffers(e),this.capturedCommandList.has(e)&&this.capturedCommandList.delete(e),this.capturedPendingKernels.has(e)&&this.capturedPendingKernels.delete(e),this.gpuDataManager.onReleaseSession(e)}onRunStart(e){this.currentSessionId=e,this.setQueryType()}}})),Hl={};lt(Hl,{init:()=>Xl});var ql,Yl,Xl,Kl,Zl,Jl,Ql,eh,th,rh,nh,ih,oh,ah,sh,uh,lh,hh,ch,fh,dh,ph,yh,mh,gh,wh,vh,bh,xh,_h,Sh,Th,Eh,Oh,Ah,Ih,Ph,kh,Ch,$h,Rh,Dh,Mh,Lh,Bh=st((()=>{qu(),Wl(),Xu(),el(),ql=class e{constructor(e,t,r,n){this.module=e,this.dataType=t,this.data=r,this.dims=n}getFloat32Array(){if(1!==this.dataType)throw new Error("Invalid data type");let e=Ur.size(this.dims);return 0===e?new Float32Array:new Float32Array(this.module.HEAP8.buffer,this.data,e)}getBigInt64Array(){if(7!==this.dataType)throw new Error("Invalid data type");let e=Ur.size(this.dims);return 0===e?new BigInt64Array:new BigInt64Array(this.module.HEAP8.buffer,this.data,e)}getInt32Array(){if(6!==this.dataType)throw new Error("Invalid data type");let e=Ur.size(this.dims);return 0===e?new Int32Array:new Int32Array(this.module.HEAP8.buffer,this.data,e)}reshape(t){if(Ur.size(t)!==Ur.size(this.dims))throw new Error("Invalid new shape");return new e(this.module,this.dataType,this.data,t)}},Yl=class{constructor(e,t,r){this.module=e,this.backend=t,this.customDataOffset=0,this.customDataSize=0;let n=e.HEAPU32,i=r>>>2;this.opKernelContext=n[i++];let o=n[i++];this.outputCount=n[i++],this.customDataOffset=n[i++],this.customDataSize=n[i++];let a=[];for(let t=0;t<o;t++){let t=n[i++],r=n[i++],o=n[i++],s=[];for(let e=0;e<o;e++)s.push(n[i++]);a.push(new ql(e,t,r,s))}this.inputs=a}get kernelCustomData(){return this.backend.currentKernelCustomData}get customDataBuffer(){return this.module.HEAPU8.subarray(this.customDataOffset,this.customDataOffset+this.customDataSize)}compute(e,t){let r=t?.inputs?.map((e=>"number"==typeof e?this.inputs[e]:e))??this.inputs,n=t?.outputs??[];return this.backend.run(e,r,n,((e,t,r)=>new ql(this.module,t,this.output(e,r),r)),((e,t)=>{let r=pr(e);if(!r)throw new Error(`Unsupported data type: ${e}`);let n=r*Ur.size(t);return new ql(this.module,e,this.backend.gpuDataManager.create(n).id,t)}))}output(e,t){let r=this.module.stackSave();try{let r=this.module.stackAlloc(4*(1+t.length)),n=r>>2;this.module.HEAPU32[n++]=t.length;for(let e=0;e<t.length;e++)this.module.HEAPU32[n++]=t[e];return this.module._JsepOutput(this.opKernelContext,e,r)}catch(r){throw new Error(`Failed to generate kernel's output[${e}] with dims [${t}]. If you are running with pre-allocated output, please make sure the output type/dims are correct. Error: ${r}`)}finally{this.module.stackRestore(r)}}},Xl=async(e,t,r)=>{let n=e.jsepInit;if(!n)throw new Error("Failed to initialize JSEP. The WebAssembly module is not built with JSEP support.");let i=new Fu;await i.initialize(t,r),n(i,(e=>i.alloc(e)),(e=>i.free(e)),((t,r,n,o=!1)=>{if(o)Or("verbose",(()=>`[WebGPU] jsepCopyGpuToGpu: src=${t}, dst=${r}, size=${n}`)),i.memcpy(t,r);else{Or("verbose",(()=>`[WebGPU] jsepCopyCpuToGpu: dataOffset=${t}, gpuDataId=${r}, size=${n}`));let o=e.HEAPU8.subarray(t>>>0,(t>>>0)+n);i.upload(r,o)}}),(async(t,r,n)=>{Or("verbose",(()=>`[WebGPU] jsepCopyGpuToCpu: gpuDataId=${t}, dataOffset=${r}, size=${n}`)),await i.download(t,(()=>e.HEAPU8.subarray(r>>>0,(r>>>0)+n)))}),((t,r,n)=>i.createKernel(t,r,n,e.UTF8ToString(e._JsepGetNodeName(r)))),(e=>i.releaseKernel(e)),((t,r,n,o)=>{Or("verbose",(()=>`[WebGPU] jsepRun: sessionHandle=${n}, kernel=${t}, contextDataOffset=${r}`));let a=new Yl(e,i,r);return i.computeKernel(t,a,o)}),(()=>i.captureBegin()),(()=>i.captureEnd()),(()=>i.replay()))}})),Nh=st((()=>{Wu(),Hu(),qu(),Gu(),Vu(),Yu(),Kl=(e,t)=>{0!==rr()._OrtInit(e,t)&&or("Can't initialize onnxruntime.")},Zl=async e=>{Kl(e.wasm.numThreads,mr(e.logLevel))},Jl=async(e,t)=>{if("webgpu"===t){if(typeof navigator>"u"||!navigator.gpu)throw new Error("WebGPU is not supported in current environment");let t=await navigator.gpu.requestAdapter();if(!t)throw new Error('Failed to get GPU adapter. You may need to enable flag "--enable-unsafe-webgpu" if you are using Chrome.');if(!e.wasm.simd)throw new Error("Not supported for WebGPU=ON and SIMD=OFF. Please set `env.wasm.simd` to true when using `webgpu` EP");let r=(Bh(),ht(Hl)).init;await r(rr(),e,t)}},Ql=new Map,eh=e=>{let t=rr(),r=t.stackSave();try{let r=t.stackAlloc(8);return 0!==t._OrtGetInputOutputCount(e,r,r+4)&&or("Can't get session input/output count."),[t.HEAP32[r/4],t.HEAP32[r/4+1]]}finally{t.stackRestore(r)}},th=e=>{let t=rr(),r=t._malloc(e.byteLength);if(0===r)throw new Error(`Can't create a session. failed to allocate a buffer of size ${e.byteLength}.`);return t.HEAPU8.set(e,r),[r,e.byteLength]},rh=async(e,t)=>{let r,n,i=rr();Array.isArray(e)?[r,n]=e:e.buffer===i.HEAPU8.buffer?[r,n]=[e.byteOffset,e.byteLength]:[r,n]=th(e);let o=0,a=0,s=0,u=[],l=[],h=[];try{if([a,u]=cr(t),t?.externalData&&i.mountExternalData){let e=[];for(let r of t.externalData){let t="string"==typeof r?r:r.path;e.push(vr("string"==typeof r?r:r.data).then((e=>{i.mountExternalData(t,e)})))}await Promise.all(e)}o=i._OrtCreateSession(r,n,a),0===o&&or("Can't create a session.");let[e,c]=eh(o),f=!!t?.enableGraphCapture,d=[],p=[],y=[];for(let t=0;t<e;t++){let e=i._OrtGetInputName(o,t);0===e&&or("Can't get an input name."),l.push(e),d.push(i.UTF8ToString(e))}for(let e=0;e<c;e++){let r=i._OrtGetOutputName(o,e);0===r&&or("Can't get an output name."),h.push(r);let n=i.UTF8ToString(r);p.push(n);{if(f&&void 0===t?.preferredOutputLocation){y.push("gpu-buffer");continue}let e="string"==typeof t?.preferredOutputLocation?t.preferredOutputLocation:t?.preferredOutputLocation?.[n]??"cpu";if("cpu"!==e&&"cpu-pinned"!==e&&"gpu-buffer"!==e)throw new Error(`Not supported preferred output location: ${e}.`);if(f&&"gpu-buffer"!==e)throw new Error(`Not supported preferred output location: ${e}. Only 'gpu-buffer' location is supported when enableGraphCapture is true.`);y.push(e)}}let m=null;return y.some((e=>"gpu-buffer"===e))&&(s=i._OrtCreateBinding(o),0===s&&or("Can't create IO binding."),m={handle:s,outputPreferredLocations:y,outputPreferredLocationsEncoded:y.map((e=>wr(e)))}),Ql.set(o,[o,l,h,m,f,!1]),[o,d,p]}catch(e){throw l.forEach((e=>i._OrtFree(e))),h.forEach((e=>i._OrtFree(e))),0!==s&&i._OrtReleaseBinding(s),0!==o&&i._OrtReleaseSession(o),e}finally{i._free(r),0!==a&&i._OrtReleaseSessionOptions(a),u.forEach((e=>i._free(e))),i.unmountExternalData?.()}},nh=e=>{let t=rr(),r=Ql.get(e);if(!r)throw new Error(`cannot release session. invalid session id: ${e}`);let[n,i,o,a,s]=r;a&&(s&&t._OrtClearBoundOutputs(a.handle),t._OrtReleaseBinding(a.handle)),t.jsepOnReleaseSession?.(e),i.forEach((e=>t._OrtFree(e))),o.forEach((e=>t._OrtFree(e))),t._OrtReleaseSession(n),Ql.delete(e)},ih=(e,t,r)=>{if(null!==e&&e[0]===t){let t=e[2];if(t.length===r)return t}return new(yr(t))(r)},oh=(e,t,r,n,i,o=!1)=>{if(!e)return void t.push(0);let a,s,u=rr(),l=e[0],h=e[1],c=e[3];if("string"===l&&"gpu-buffer"===c)throw new Error("String tensor is not supported on GPU.");if(o&&"gpu-buffer"!==c)throw new Error(`External buffer must be provided for input/output index ${i} when enableGraphCapture is true.`);if("gpu-buffer"===c){let t=e[2].gpuBuffer,r=pr(fr(l));s=h.reduce(((e,t)=>e*t),1)*r,a=u.jsepRegisterBuffer(n,i,t,s)}else{let t=e[2];if(Array.isArray(t)){s=4*t.length,a=u._malloc(s),r.push(a);let e=a/4;for(let n=0;n<t.length;n++){if("string"!=typeof t[n])throw new TypeError(`tensor data at index ${n} is not a string`);u.HEAPU32[e++]=nr(t[n],r)}}else s=t.byteLength,a=u._malloc(s),r.push(a),u.HEAPU8.set(new Uint8Array(t.buffer,t.byteOffset,s),a)}let f=u.stackSave(),d=u.stackAlloc(4*h.length);try{let e=d/4;h.forEach((t=>u.HEAP32[e++]=t));let r=u._OrtCreateTensor(fr(l),a,s,d,h.length,wr(c));0===r&&or(`Can't create tensor for input/output. session=${n}, index=${i}.`),t.push(r)}finally{u.stackRestore(f)}},ah=e=>{let t=(new TextEncoder).encode(e),r=rr(),n=r._malloc(t.byteLength);r.HEAPU8.set(t,n);let i=r._OrtConfigure(n,t.byteLength);if(0===i)throw new Error("Can't get an configure key");let o=r.UTF8ToString(i);return r._OrtFree(i),o},sh=e=>{let t=(new TextEncoder).encode(e),r=rr(),n=r._malloc(t.byteLength);r.HEAPU8.set(t,n);let i=r._OrtAuth(n,t.byteLength);if(0===i)throw new Error("Can't get an auth result");let o=r.UTF8ToString(i);return r._OrtFree(i),o},uh=async(e,t,r,n,i,o)=>{let a=rr(),s=Ql.get(e);if(!s)throw new Error(`cannot run inference. invalid session id: ${e}`);let u=s[0],l=s[1],h=s[2],c=s[3],f=s[4],d=s[5],p=t.length,y=n.length,m=0,g=[],w=[],v=[],b=[],x=a.stackSave(),_=a.stackAlloc(4*p),S=a.stackAlloc(4*p),T=a.stackAlloc(4*y),E=a.stackAlloc(4*y);try{[m,g]=ar(o);for(let n=0;n<p;n++)oh(r[n],w,b,e,t[n],f);for(let t=0;t<y;t++){let r=i[t];oh("gpu-buffer"===(r?.[3]??"")?r:null,v,b,e,p+n[t],f)}let s,x=_/4,O=S/4,A=T/4,I=E/4;for(let e=0;e<p;e++)a.HEAPU32[x++]=w[e],a.HEAPU32[O++]=l[t[e]];for(let e=0;e<y;e++)a.HEAPU32[A++]=v[e],a.HEAPU32[I++]=h[n[e]];if(c&&!d){let{handle:r,outputPreferredLocations:o,outputPreferredLocationsEncoded:s}=c;if(l.length!==p)throw new Error(`input count from feeds (${p}) is expected to be always equal to model's input count (${l.length}).`);for(let n=0;n<p;n++){let i=t[n];0!==await a._OrtBindInput(r,l[i],w[n])&&or(`Can't bind input[${n}] for session=${e}.`)}for(let t=0;t<y;t++){let u=n[t];i[t]?.[3]?0!==a._OrtBindOutput(r,h[u],v[t],0)&&or(`Can't bind pre-allocated output[${t}] for session=${e}.`):0!==a._OrtBindOutput(r,h[u],0,s[u])&&or(`Can't bind output[${t}] to ${o[t]} for session=${e}.`)}Ql.set(e,[u,l,h,c,f,!0])}a.jsepOnRunStart?.(u),s=c?await a._OrtRunWithBinding(u,c.handle,y,T,m):await a._OrtRun(u,S,_,p,E,y,T,m),0!==s&&or("failed to call OrtRun().");let P=[];for(let e=0;e<y;e++){let t=a.HEAPU32[T/4+e];if(t===v[e]){P.push(i[e]);continue}let r,o=a.stackSave(),s=a.stackAlloc(16),u=!1,l=0;try{0!==a._OrtGetTensorData(t,s,s+4,s+8,s+12)&&or(`Can't access output tensor data on index ${e}.`);let o=s/4,h=a.HEAPU32[o++];l=a.HEAPU32[o++];let f=a.HEAPU32[o++],d=a.HEAPU32[o++],p=[];for(let e=0;e<d;e++)p.push(a.HEAPU32[f/4+e]);a._OrtFree(f);let y=p.reduce(((e,t)=>e*t),1);r=dr(h);let m=c?.outputPreferredLocations[n[e]];if("string"===r){if("gpu-buffer"===m)throw new Error("String tensor is not supported on GPU.");let e=[],t=l/4;for(let r=0;r<y;r++){let n=a.HEAPU32[t++],i=r===y-1?void 0:a.HEAPU32[t]-n;e.push(a.UTF8ToString(n,i))}P.push([r,p,e,"cpu"])}else if("gpu-buffer"===m&&y>0){let e=a.jsepGetBuffer(l),n=pr(h);if(void 0===n||!gr(r))throw new Error(`Unsupported data type: ${r}`);u=!0,P.push([r,p,{gpuBuffer:e,download:a.jsepCreateDownloader(e,y*n,r),dispose:()=>{a._OrtReleaseTensor(t)}},"gpu-buffer"])}else{let t=ih(i[e],r,y);new Uint8Array(t.buffer,t.byteOffset,t.byteLength).set(a.HEAPU8.subarray(l,l+t.byteLength)),P.push([r,p,t,"cpu"])}}finally{a.stackRestore(o),"string"===r&&l&&a._free(l),u||a._OrtReleaseTensor(t)}}return c&&!f&&(a._OrtClearBoundOutputs(c.handle),Ql.set(e,[u,l,h,c,f,!1])),P}finally{a.stackRestore(x),w.forEach((e=>a._OrtReleaseTensor(e))),v.forEach((e=>a._OrtReleaseTensor(e))),b.forEach((e=>a._free(e))),0!==m&&a._OrtReleaseRunOptions(m),g.forEach((e=>a._free(e)))}},lh=e=>{let t=rr(),r=Ql.get(e);if(!r)throw new Error("invalid session id");let n=r[0],i=t._OrtEndProfiling(n);0===i&&or("Can't get an profile file name."),t._OrtFree(i)},hh=e=>{let t=[];for(let r of e){let e=r[2];!Array.isArray(e)&&"buffer"in e&&t.push(e.buffer)}return t}})),Fh=ut(((e,t)=>{t.exports='/*!\n * ONNX Runtime Web v1.17.0\n * Copyright (c) Microsoft Corporation. All rights reserved.\n * Licensed under the MIT License.\n */\n"use strict";(()=>{var In=Object.defineProperty;var rd=Object.getOwnPropertyDescriptor;var nd=Object.getOwnPropertyNames;var od=Object.prototype.hasOwnProperty;var q=(e,t)=>()=>(e&&(t=e(e=0)),t);var Sr=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),xr=(e,t)=>{for(var r in t)In(e,r,{get:t[r],enumerable:!0})},ad=(e,t,r,o)=>{if(t&&typeof t=="object"||typeof t=="function")for(let n of nd(t))!od.call(e,n)&&n!==r&&In(e,n,{get:()=>t[n],enumerable:!(o=rd(t,n))||o.enumerable});return e};var Ot=e=>ad(In({},"__esModule",{value:!0}),e);var An={};xr(An,{createReadStream:()=>Mo,readFile:()=>id,readFileSync:()=>sd});var id,sd,Mo,Tn=q(()=>{id=void 0,sd=void 0,Mo=void 0});var En={};xr(En,{join:()=>ud});var ud,On=q(()=>{ud=void 0});var Pn={};xr(Pn,{crypto:()=>dd});var dd,Bn=q(()=>{dd=void 0});var Vo=Sr((zo,kn)=>{"use strict";var Uo=(()=>{var e=typeof document<"u"&&document.currentScript?document.currentScript.src:void 0;return typeof __filename<"u"&&(e=e||__filename),function(t={}){var r=t,o,n;r.ready=new Promise((d,m)=>{o=d,n=m}),r.mountExternalData=(d,m)=>{(r.Ka||(r.Ka=new Map)).set(d,m)},r.unmountExternalData=()=>{delete r.Ka},r.jsepInit=(d,m,b,S,P,N,L,X,pe,me,fe)=>{r.jb=d,r.Wa=m,r.$a=b,r.Qa=S,r.Za=P,r.Ba=N,r.ab=L,r.cb=X,r.Xa=pe,r.Ya=me,r.bb=fe,m=(ue,we,B)=>(...ae)=>{let ge=Je,Ze=we?.();ae=ue(...ae);let It=we?.();return Ze!==It&&(ue=It,B(Ze),we=B=null),Je!=ge?Dr():ae},b=ue=>async(...we)=>{try{if(r.Ja)throw Error("Session already started");let B=r.Ja={eb:we[0],errors:[]},ae=await ue(...we);if(r.Ja!==B)throw Error("Session mismatch");d.flush();let ge=B.errors;if(0<ge.length){let Ze=await Promise.all(ge);if(Ze=Ze.filter(It=>It),0<Ze.length)throw Error(Ze.join(`\n`))}return ae}finally{r.Ja=null}},r._OrtRun=b(m(r._OrtRun,()=>r._OrtRun,ue=>r._OrtRun=ue)),r._OrtRunWithBinding=b(m(r._OrtRunWithBinding,()=>r._OrtRunWithBinding,ue=>r._OrtRunWithBinding=ue)),r._OrtBindInput=m(r._OrtBindInput,()=>r._OrtBindInput,ue=>r._OrtBindInput=ue),r.jsepRegisterBuffer=(ue,we,B,ae)=>d.registerBuffer(ue,we,B,ae),r.jsepGetBuffer=ue=>d.getBuffer(ue),r.jsepCreateDownloader=(ue,we,B)=>d.createDownloader(ue,we,B),r.jsepOnReleaseSession=ue=>{d.onReleaseSession(ue)},r.jsepOnRunStart=ue=>d.onRunStart(ue)};var s=Object.assign({},r),u="./this.program",l=(d,m)=>{throw m},a=typeof window=="object",p=typeof importScripts=="function",h=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string",g="",w,v,y;if(h){var _=(Tn(),Ot(An)),I=(On(),Ot(En));g=p?I.dirname(g)+"/":__dirname+"/",w=(d,m)=>(d=Ae(d)?new URL(d):I.normalize(d),_.readFileSync(d,m?void 0:"utf8")),y=d=>(d=w(d,!0),d.buffer||(d=new Uint8Array(d)),d),v=(d,m,b,S=!0)=>{d=Ae(d)?new URL(d):I.normalize(d),_.readFile(d,S?void 0:"utf8",(P,N)=>{P?b(P):m(S?N.buffer:N)})},!r.thisProgram&&1<process.argv.length&&(u=process.argv[1].replace(/\\\\/g,"/")),process.argv.slice(2),l=(d,m)=>{throw process.exitCode=d,m},r.inspect=()=>"[Emscripten Module object]"}else(a||p)&&(p?g=self.location.href:typeof document<"u"&&document.currentScript&&(g=document.currentScript.src),e&&(g=e),g.indexOf("blob:")!==0?g=g.substr(0,g.replace(/[?#].*/,"").lastIndexOf("/")+1):g="",w=d=>{var m=new XMLHttpRequest;return m.open("GET",d,!1),m.send(null),m.responseText},p&&(y=d=>{var m=new XMLHttpRequest;return m.open("GET",d,!1),m.responseType="arraybuffer",m.send(null),new Uint8Array(m.response)}),v=(d,m,b)=>{var S=new XMLHttpRequest;S.open("GET",d,!0),S.responseType="arraybuffer",S.onload=()=>{S.status==200||S.status==0&&S.response?m(S.response):b()},S.onerror=b,S.send(null)});var x=console.log.bind(console),A=console.error.bind(console);Object.assign(r,s),s=null,typeof WebAssembly!="object"&&ie("no native wasm support detected");var O,C=!1,M,D,G,E,W,te,Y;function Z(){var d=O.buffer;r.HEAP8=D=new Int8Array(d),r.HEAP16=new Int16Array(d),r.HEAPU8=G=new Uint8Array(d),r.HEAPU16=new Uint16Array(d),r.HEAP32=E=new Int32Array(d),r.HEAPU32=W=new Uint32Array(d),r.HEAPF32=te=new Float32Array(d),r.HEAPF64=Y=new Float64Array(d)}var ee=[],Te=[],De=[],re=0,Ie=null,Oe=null;function ie(d){throw d="Aborted("+d+")",A(d),C=!0,M=1,d=new WebAssembly.RuntimeError(d+". Build with -sASSERTIONS for more info."),n(d),d}var Se=d=>d.startsWith("data:application/octet-stream;base64,"),Ae=d=>d.startsWith("file://"),Pe;if(Pe="ort-wasm-simd.wasm",!Se(Pe)){var Fe=Pe;Pe=r.locateFile?r.locateFile(Fe,g):g+Fe}function H(d){if(y)return y(d);throw"both async and sync fetching of the wasm failed"}function J(d){if(a||p){if(typeof fetch=="function"&&!Ae(d))return fetch(d,{credentials:"same-origin"}).then(m=>{if(!m.ok)throw"failed to load wasm binary file at \'"+d+"\'";return m.arrayBuffer()}).catch(()=>H(d));if(v)return new Promise((m,b)=>{v(d,S=>m(new Uint8Array(S)),b)})}return Promise.resolve().then(()=>H(d))}function Ce(d,m,b){return J(d).then(S=>WebAssembly.instantiate(S,m)).then(S=>S).then(b,S=>{A(`failed to asynchronously prepare wasm: ${S}`),ie(S)})}function $t(d,m){var b=Pe;return typeof WebAssembly.instantiateStreaming!="function"||Se(b)||Ae(b)||h||typeof fetch!="function"?Ce(b,d,m):fetch(b,{credentials:"same-origin"}).then(S=>WebAssembly.instantiateStreaming(S,d).then(m,function(P){return A(`wasm streaming compile failed: ${P}`),A("falling back to ArrayBuffer instantiation"),Ce(b,d,m)}))}var Me,tt={898320:(d,m,b,S)=>{if(typeof r>"u"||!r.Ka)return 1;if(d=Ke(d>>>0),d.startsWith("./")&&(d=d.substring(2)),d=r.Ka.get(d),!d)return 2;if(m>>>=0,b>>>=0,m+b>d.byteLength)return 3;try{return G.set(d.subarray(m,m+b),S>>>0>>>0),0}catch{return 4}},898821:()=>{r.Xa()},898852:()=>{r.Ya()},898881:()=>{r.bb()},898906:d=>r.Wa(d),898939:d=>r.$a(d),898971:(d,m,b)=>{r.Qa(d,m,b,!0)},899010:(d,m,b)=>{r.Qa(d,m,b)},899043:d=>{r.Ba("Abs",d,void 0)},899094:d=>{r.Ba("Neg",d,void 0)},899145:d=>{r.Ba("Floor",d,void 0)},899198:d=>{r.Ba("Ceil",d,void 0)},899250:d=>{r.Ba("Reciprocal",d,void 0)},899308:d=>{r.Ba("Sqrt",d,void 0)},899360:d=>{r.Ba("Exp",d,void 0)},899411:d=>{r.Ba("Erf",d,void 0)},899462:d=>{r.Ba("Sigmoid",d,void 0)},899517:d=>{r.Ba("Log",d,void 0)},899568:d=>{r.Ba("Sin",d,void 0)},899619:d=>{r.Ba("Cos",d,void 0)},899670:d=>{r.Ba("Tan",d,void 0)},899721:d=>{r.Ba("Asin",d,void 0)},899773:d=>{r.Ba("Acos",d,void 0)},899825:d=>{r.Ba("Atan",d,void 0)},899877:d=>{r.Ba("Sinh",d,void 0)},899929:d=>{r.Ba("Cosh",d,void 0)},899981:d=>{r.Ba("Asinh",d,void 0)},900034:d=>{r.Ba("Acosh",d,void 0)},900087:d=>{r.Ba("Atanh",d,void 0)},900140:d=>{r.Ba("Tanh",d,void 0)},900192:d=>{r.Ba("Not",d,void 0)},900243:(d,m,b)=>{r.Ba("Clip",d,{min:m,max:b})},900312:d=>{r.Ba("Clip",d,void 0)},900364:(d,m)=>{r.Ba("Elu",d,{alpha:m})},900422:d=>{r.Ba("Relu",d,void 0)},900474:(d,m)=>{r.Ba("LeakyRelu",d,{alpha:m})},900538:(d,m)=>{r.Ba("ThresholdedRelu",d,{alpha:m})},900608:(d,m)=>{r.Ba("Cast",d,{to:m})},900666:d=>{r.Ba("Add",d,void 0)},900717:d=>{r.Ba("Sub",d,void 0)},900768:d=>{r.Ba("Mul",d,void 0)},900819:d=>{r.Ba("Div",d,void 0)},900870:d=>{r.Ba("Pow",d,void 0)},900921:d=>{r.Ba("Equal",d,void 0)},900974:d=>{r.Ba("Greater",d,void 0)},901029:d=>{r.Ba("GreaterOrEqual",d,void 0)},901091:d=>{r.Ba("Less",d,void 0)},901143:d=>{r.Ba("LessOrEqual",d,void 0)},901202:(d,m,b,S,P)=>{r.Ba("ReduceMean",d,{keepDims:!!m,noopWithEmptyAxes:!!b,axes:S?Array.from(E.subarray(S>>>0,P>>>0)):[]})},901361:(d,m,b,S,P)=>{r.Ba("ReduceMax",d,{keepDims:!!m,noopWithEmptyAxes:!!b,axes:S?Array.from(E.subarray(S>>>0,P>>>0)):[]})},901519:(d,m,b,S,P)=>{r.Ba("ReduceMin",d,{keepDims:!!m,noopWithEmptyAxes:!!b,axes:S?Array.from(E.subarray(S>>>0,P>>>0)):[]})},901677:(d,m,b,S,P)=>{r.Ba("ReduceProd",d,{keepDims:!!m,noopWithEmptyAxes:!!b,axes:S?Array.from(E.subarray(S>>>0,P>>>0)):[]})},901836:(d,m,b,S,P)=>{r.Ba("ReduceSum",d,{keepDims:!!m,noopWithEmptyAxes:!!b,axes:S?Array.from(E.subarray(S>>>0,P>>>0)):[]})},901994:(d,m,b,S,P)=>{r.Ba("ReduceL1",d,{keepDims:!!m,noopWithEmptyAxes:!!b,axes:S?Array.from(E.subarray(S>>>0,P>>>0)):[]})},902151:(d,m,b,S,P)=>{r.Ba("ReduceL2",d,{keepDims:!!m,noopWithEmptyAxes:!!b,axes:S?Array.from(E.subarray(S>>>0,P>>>0)):[]})},902308:(d,m,b,S,P)=>{r.Ba("ReduceLogSum",d,{keepDims:!!m,noopWithEmptyAxes:!!b,axes:S?Array.from(E.subarray(S>>>0,P>>>0)):[]})},902469:(d,m,b,S,P)=>{r.Ba("ReduceSumSquare",d,{keepDims:!!m,noopWithEmptyAxes:!!b,axes:S?Array.from(E.subarray(S>>>0,P>>>0)):[]})},902633:(d,m,b,S,P)=>{r.Ba("ReduceLogSumExp",d,{keepDims:!!m,noopWithEmptyAxes:!!b,axes:S?Array.from(E.subarray(S>>>0,P>>>0)):[]})},902797:d=>{r.Ba("Where",d,void 0)},902850:(d,m,b)=>{r.Ba("Transpose",d,{perm:m?Array.from(E.subarray(m>>>0,b>>>0)):[]})},902958:(d,m,b,S,P,N,L,X,pe,me,fe,ue,we,B,ae)=>{r.Ba("ConvTranspose",d,{format:pe?"NHWC":"NCHW",autoPad:m,dilations:[b],group:S,kernel_shape:[P],pads:[N,L],strides:[X],wIsConst:()=>!!D[me>>>0],outputPadding:fe?Array.from(E.subarray(fe>>>0,ue>>>0)):[],outputShape:we?Array.from(E.subarray(we>>>0,B>>>0)):[],activation:Ke(ae)})},903360:(d,m,b,S,P,N,L,X,pe,me,fe,ue,we,B)=>{r.Ba("ConvTranspose",d,{format:X?"NHWC":"NCHW",autoPad:m,dilations:Array.from(E.subarray(b>>>0,(b>>>0)+2>>>0)),group:S,kernelShape:Array.from(E.subarray(P>>>0,(P>>>0)+2>>>0)),pads:Array.from(E.subarray(N>>>0,(N>>>0)+4>>>0)),strides:Array.from(E.subarray(L>>>0,(L>>>0)+2>>>0)),wIsConst:()=>!!D[pe>>>0],outputPadding:me?Array.from(E.subarray(me>>>0,fe>>>0)):[],outputShape:ue?Array.from(E.subarray(ue>>>0,we>>>0)):[],activation:Ke(B)})},903925:(d,m,b,S,P,N,L,X,pe,me,fe,ue,we,B,ae)=>{r.Ba("ConvTranspose",d,{format:pe?"NHWC":"NCHW",autoPad:m,dilations:[b],group:S,kernel_shape:[P],pads:[N,L],strides:[X],wIsConst:()=>!!D[me>>>0],outputPadding:fe?Array.from(E.subarray(fe>>>0,ue>>>0)):[],outputShape:we?Array.from(E.subarray(we>>>0,B>>>0)):[],activation:Ke(ae)})},904327:(d,m,b,S,P,N,L,X,pe,me,fe,ue,we,B)=>{r.Ba("ConvTranspose",d,{format:X?"NHWC":"NCHW",autoPad:m,dilations:Array.from(E.subarray(b>>>0,(b>>>0)+2>>>0)),group:S,kernelShape:Array.from(E.subarray(P>>>0,(P>>>0)+2>>>0)),pads:Array.from(E.subarray(N>>>0,(N>>>0)+4>>>0)),strides:Array.from(E.subarray(L>>>0,(L>>>0)+2>>>0)),wIsConst:()=>!!D[pe>>>0],outputPadding:me?Array.from(E.subarray(me>>>0,fe>>>0)):[],outputShape:ue?Array.from(E.subarray(ue>>>0,we>>>0)):[],activation:Ke(B)})},904892:(d,m)=>{r.Ba("GlobalAveragePool",d,{format:m?"NHWC":"NCHW"})},904983:(d,m,b,S,P,N,L,X,pe,me,fe,ue,we,B,ae,ge)=>{r.Ba("AveragePool",d,{format:ge?"NHWC":"NCHW",auto_pad:m,ceil_mode:b,count_include_pad:S,storage_order:P,dilations:[N,L],kernel_shape:[X,pe],pads:[me,fe,ue,we],strides:[B,ae]})},905267:(d,m)=>{r.Ba("GlobalAveragePool",d,{format:m?"NHWC":"NCHW"})},905358:(d,m,b,S,P,N,L,X,pe,me,fe,ue,we,B,ae,ge)=>{r.Ba("AveragePool",d,{format:ge?"NHWC":"NCHW",auto_pad:m,ceil_mode:b,count_include_pad:S,storage_order:P,dilations:[N,L],kernel_shape:[X,pe],pads:[me,fe,ue,we],strides:[B,ae]})},905642:(d,m)=>{r.Ba("GlobalMaxPool",d,{format:m?"NHWC":"NCHW"})},905729:(d,m,b,S,P,N,L,X,pe,me,fe,ue,we,B,ae,ge)=>{r.Ba("MaxPool",d,{format:ge?"NHWC":"NCHW",auto_pad:m,ceil_mode:b,count_include_pad:S,storage_order:P,dilations:[N,L],kernel_shape:[X,pe],pads:[me,fe,ue,we],strides:[B,ae]})},906009:(d,m)=>{r.Ba("GlobalMaxPool",d,{format:m?"NHWC":"NCHW"})},906096:(d,m,b,S,P,N,L,X,pe,me,fe,ue,we,B,ae,ge)=>{r.Ba("MaxPool",d,{format:ge?"NHWC":"NCHW",auto_pad:m,ceil_mode:b,count_include_pad:S,storage_order:P,dilations:[N,L],kernel_shape:[X,pe],pads:[me,fe,ue,we],strides:[B,ae]})},906376:(d,m,b,S,P)=>{r.Ba("Gemm",d,{alpha:m,beta:b,transA:S,transB:P})},906480:d=>{r.Ba("MatMul",d,void 0)},906534:(d,m,b,S)=>{r.Ba("ArgMax",d,{keepDims:!!m,selectLastIndex:!!b,axis:S})},906642:(d,m,b,S)=>{r.Ba("ArgMin",d,{keepDims:!!m,selectLastIndex:!!b,axis:S})},906750:(d,m)=>{r.Ba("Softmax",d,{axis:m})},906813:(d,m)=>{r.Ba("Concat",d,{axis:m})},906873:(d,m,b,S,P)=>{r.Ba("Split",d,{axis:m,numOutputs:b,splitSizes:S?Array.from(E.subarray(S>>>0,P>>>0)):[]})},907013:d=>{r.Ba("Expand",d,void 0)},907067:(d,m)=>{r.Ba("Gather",d,{axis:Number(m)})},907138:(d,m)=>{r.Ba("GatherElements",d,{axis:Number(m)})},907217:(d,m,b,S,P,N,L,X,pe,me,fe)=>{r.Ba("Resize",d,{antialias:m,axes:b?Array.from(E.subarray(b>>>0,S>>>0)):[],coordinateTransformMode:Ke(P),cubicCoeffA:N,excludeOutside:L,extrapolationValue:X,keepAspectRatioPolicy:Ke(pe),mode:Ke(me),nearestMode:Ke(fe)})},907563:(d,m,b,S,P,N,L)=>{r.Ba("Slice",d,{starts:m?Array.from(E.subarray(m>>>0,b>>>0)):[],ends:S?Array.from(E.subarray(S>>>0,P>>>0)):[],axes:N?Array.from(E.subarray(N>>>0,L>>>0)):[]})},907779:d=>{r.Ba("Tile",d,void 0)},907831:(d,m,b)=>{r.Ba("LayerNormalization",d,{axis:Number(m),epsilon:Number(b)})},907938:(d,m,b)=>{r.Ba("InstanceNormalization",d,{epsilon:m,format:b?"NHWC":"NCHW"})},908052:(d,m,b)=>{r.Ba("InstanceNormalization",d,{epsilon:m,format:b?"NHWC":"NCHW"})},908166:d=>{r.Ba("Range",d,void 0)},908219:(d,m)=>{r.Ba("Einsum",d,{equation:Ke(m)})},908300:(d,m,b,S,P)=>{r.Ba("Pad",d,{mode:m,value:b,pads:S?Array.from(E.subarray(S>>>0,P>>>0)):[]})},908427:(d,m,b,S,P,N)=>{r.Ba("BatchNormalization",d,{epsilon:m,momentum:b,spatial:!!P,trainingMode:!!S,format:N?"NHWC":"NCHW"})},908596:(d,m,b,S,P,N)=>{r.Ba("BatchNormalization",d,{epsilon:m,momentum:b,spatial:!!P,trainingMode:!!S,format:N?"NHWC":"NCHW"})},908765:(d,m,b)=>{r.Ba("CumSum",d,{exclusive:Number(m),reverse:Number(b)})},908862:(d,m,b,S,P,N,L,X,pe)=>{r.Ba("Attention",d,{numHeads:m,isUnidirectional:b,maskFilterValue:S,scale:P,doRotary:N,qkvHiddenSizes:L?Array.from(E.subarray(Number(X)>>>0,Number(X)+L>>>0)):[],pastPresentShareBuffer:!!pe})},909134:d=>{r.Ba("Gelu",d,void 0)},909186:(d,m,b,S,P,N)=>{r.Ba("MultiHeadAttention",d,{numHeads:m,isUnidirectional:b,maskFilterValue:S,scale:P,doRotary:N})},909345:d=>{r.Ba("BiasAdd",d,void 0)},909400:d=>{r.Ba("BiasSplitGelu",d,void 0)},909461:(d,m)=>{r.Ba("SkipLayerNormalization",d,{epsilon:m})},909542:(d,m,b,S,P,N,L,X,pe,me,fe,ue,we)=>{r.Ba("Conv",d,{format:pe?"NHWC":"NCHW",auto_pad:m,dilations:[b],group:S,kernel_shape:[P],pads:N?Array.from(E.subarray(N>>>0,L>>>0)):[],strides:[X],w_is_const:()=>!!D[me>>>0],activation:Ke(fe),activation_params:ue?Array.from(te.subarray(ue>>>0,we>>>0)):[]})},909912:(d,m,b,S,P,N,L,X,pe,me,fe,ue,we,B,ae,ge)=>{r.Ba("Conv",d,{format:ue?"NHWC":"NCHW",auto_pad:m,dilations:[b,S],group:P,kernel_shape:[N,L],pads:X?Array.from(E.subarray(X>>>0,pe>>>0)):[],strides:[me,fe],w_is_const:()=>!!D[we>>>0],activation:Ke(B),activation_params:ae?Array.from(te.subarray(ae>>>0,ge>>>0)):[]})},910303:d=>{r.ab(d)},910337:(d,m)=>r.cb(d,m,r.Ja.eb,r.Ja.errors)};function at(d){this.name="ExitStatus",this.message=`Program terminated with exit(${d})`,this.status=d}function Ne(d){this.Na=d-24,this.Ua=function(m){W[this.Na+4>>>2>>>0]=m},this.Ta=function(m){W[this.Na+8>>>2>>>0]=m},this.Ra=function(m,b){this.Sa(),this.Ua(m),this.Ta(b)},this.Sa=function(){W[this.Na+16>>>2>>>0]=0}}var je=0,At=0,lt=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0,ct=(d,m,b)=>{m>>>=0;var S=m+b;for(b=m;d[b]&&!(b>=S);)++b;if(16<b-m&&d.buffer&&lt)return lt.decode(d.subarray(m,b));for(S="";m<b;){var P=d[m++];if(P&128){var N=d[m++]&63;if((P&224)==192)S+=String.fromCharCode((P&31)<<6|N);else{var L=d[m++]&63;P=(P&240)==224?(P&15)<<12|N<<6|L:(P&7)<<18|N<<12|L<<6|d[m++]&63,65536>P?S+=String.fromCharCode(P):(P-=65536,S+=String.fromCharCode(55296|P>>10,56320|P&1023))}}else S+=String.fromCharCode(P)}return S},Ke=(d,m)=>(d>>>=0)?ct(G,d,m):"",ar=d=>{for(var m=0,b=0;b<d.length;++b){var S=d.charCodeAt(b);127>=S?m++:2047>=S?m+=2:55296<=S&&57343>=S?(m+=4,++b):m+=3}return m},Ht=(d,m,b,S)=>{if(b>>>=0,!(0<S))return 0;var P=b;S=b+S-1;for(var N=0;N<d.length;++N){var L=d.charCodeAt(N);if(55296<=L&&57343>=L){var X=d.charCodeAt(++N);L=65536+((L&1023)<<10)|X&1023}if(127>=L){if(b>=S)break;m[b++>>>0]=L}else{if(2047>=L){if(b+1>=S)break;m[b++>>>0]=192|L>>6}else{if(65535>=L){if(b+2>=S)break;m[b++>>>0]=224|L>>12}else{if(b+3>=S)break;m[b++>>>0]=240|L>>18,m[b++>>>0]=128|L>>12&63}m[b++>>>0]=128|L>>6&63}m[b++>>>0]=128|L&63}}return m[b>>>0]=0,b-P},Tt=d=>d%4===0&&(d%100!==0||d%400===0),St=[0,31,60,91,121,152,182,213,244,274,305,335],Lt=[0,31,59,90,120,151,181,212,243,273,304,334],Ft=d=>{var m=ar(d)+1,b=Zt(m);return b&&Ht(d,G,b,m),b},kt=[],ir=(d,m)=>{kt.length=0;for(var b;b=G[d++>>>0];){var S=b!=105;S&=b!=112,m+=S&&m%8?4:0,kt.push(b==112?W[m>>>2>>>0]:b==105?E[m>>>2>>>0]:Y[m>>>3>>>0]),m+=S?8:4}return kt},it={},sr=()=>{if(!Kt){var d={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:(typeof navigator=="object"&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",_:u||"./this.program"},m;for(m in it)it[m]===void 0?delete d[m]:d[m]=it[m];var b=[];for(m in d)b.push(`${m}=${d[m]}`);Kt=b}return Kt},Kt,Ye=[null,[],[]],bn=()=>{if(typeof crypto=="object"&&typeof crypto.getRandomValues=="function")return b=>crypto.getRandomValues(b);if(h)try{var d=(Bn(),Ot(Pn));if(d.randomFillSync)return b=>d.randomFillSync(b);var m=d.randomBytes;return b=>(b.set(m(b.byteLength)),b)}catch{}ie("initRandomDevice")},Be=d=>(Be=bn())(d),ur=[31,29,31,30,31,30,31,31,30,31,30,31],qt=[31,28,31,30,31,30,31,31,30,31,30,31];function dr(d){var m=Array(ar(d)+1);return Ht(d,m,0,m.length),m}function Pr(d,m,b,S){function P(B,ae,ge){for(B=typeof B=="number"?B.toString():B||"";B.length<ae;)B=ge[0]+B;return B}function N(B,ae){return P(B,ae,"0")}function L(B,ae){function ge(It){return 0>It?-1:0<It?1:0}var Ze;return(Ze=ge(B.getFullYear()-ae.getFullYear()))===0&&(Ze=ge(B.getMonth()-ae.getMonth()))===0&&(Ze=ge(B.getDate()-ae.getDate())),Ze}function X(B){switch(B.getDay()){case 0:return new Date(B.getFullYear()-1,11,29);case 1:return B;case 2:return new Date(B.getFullYear(),0,3);case 3:return new Date(B.getFullYear(),0,2);case 4:return new Date(B.getFullYear(),0,1);case 5:return new Date(B.getFullYear()-1,11,31);case 6:return new Date(B.getFullYear()-1,11,30)}}function pe(B){var ae=B.Ha;for(B=new Date(new Date(B.Ia+1900,0,1).getTime());0<ae;){var ge=B.getMonth(),Ze=(Tt(B.getFullYear())?ur:qt)[ge];if(ae>Ze-B.getDate())ae-=Ze-B.getDate()+1,B.setDate(1),11>ge?B.setMonth(ge+1):(B.setMonth(0),B.setFullYear(B.getFullYear()+1));else{B.setDate(B.getDate()+ae);break}}return ge=new Date(B.getFullYear()+1,0,4),ae=X(new Date(B.getFullYear(),0,4)),ge=X(ge),0>=L(ae,B)?0>=L(ge,B)?B.getFullYear()+1:B.getFullYear():B.getFullYear()-1}d>>>=0,m>>>=0,b>>>=0,S>>>=0;var me=W[S+40>>>2>>>0];S={hb:E[S>>>2>>>0],gb:E[S+4>>>2>>>0],La:E[S+8>>>2>>>0],Pa:E[S+12>>>2>>>0],Ma:E[S+16>>>2>>>0],Ia:E[S+20>>>2>>>0],Ga:E[S+24>>>2>>>0],Ha:E[S+28>>>2>>>0],kb:E[S+32>>>2>>>0],fb:E[S+36>>>2>>>0],ib:me?Ke(me):""},b=Ke(b),me={"%c":"%a %b %d %H:%M:%S %Y","%D":"%m/%d/%y","%F":"%Y-%m-%d","%h":"%b","%r":"%I:%M:%S %p","%R":"%H:%M","%T":"%H:%M:%S","%x":"%m/%d/%y","%X":"%H:%M:%S","%Ec":"%c","%EC":"%C","%Ex":"%m/%d/%y","%EX":"%H:%M:%S","%Ey":"%y","%EY":"%Y","%Od":"%d","%Oe":"%e","%OH":"%H","%OI":"%I","%Om":"%m","%OM":"%M","%OS":"%S","%Ou":"%u","%OU":"%U","%OV":"%V","%Ow":"%w","%OW":"%W","%Oy":"%y"};for(var fe in me)b=b.replace(new RegExp(fe,"g"),me[fe]);var ue="Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),we="January February March April May June July August September October November December".split(" ");me={"%a":B=>ue[B.Ga].substring(0,3),"%A":B=>ue[B.Ga],"%b":B=>we[B.Ma].substring(0,3),"%B":B=>we[B.Ma],"%C":B=>N((B.Ia+1900)/100|0,2),"%d":B=>N(B.Pa,2),"%e":B=>P(B.Pa,2," "),"%g":B=>pe(B).toString().substring(2),"%G":B=>pe(B),"%H":B=>N(B.La,2),"%I":B=>(B=B.La,B==0?B=12:12<B&&(B-=12),N(B,2)),"%j":B=>{for(var ae=0,ge=0;ge<=B.Ma-1;ae+=(Tt(B.Ia+1900)?ur:qt)[ge++]);return N(B.Pa+ae,3)},"%m":B=>N(B.Ma+1,2),"%M":B=>N(B.gb,2),"%n":()=>`\n`,"%p":B=>0<=B.La&&12>B.La?"AM":"PM","%S":B=>N(B.hb,2),"%t":()=>"\t","%u":B=>B.Ga||7,"%U":B=>N(Math.floor((B.Ha+7-B.Ga)/7),2),"%V":B=>{var ae=Math.floor((B.Ha+7-(B.Ga+6)%7)/7);if(2>=(B.Ga+371-B.Ha-2)%7&&ae++,ae)ae==53&&(ge=(B.Ga+371-B.Ha)%7,ge==4||ge==3&&Tt(B.Ia)||(ae=1));else{ae=52;var ge=(B.Ga+7-B.Ha-1)%7;(ge==4||ge==5&&Tt(B.Ia%400-1))&&ae++}return N(ae,2)},"%w":B=>B.Ga,"%W":B=>N(Math.floor((B.Ha+7-(B.Ga+6)%7)/7),2),"%y":B=>(B.Ia+1900).toString().substring(2),"%Y":B=>B.Ia+1900,"%z":B=>{B=B.fb;var ae=0<=B;return B=Math.abs(B)/60,(ae?"+":"-")+("0000"+(B/60*100+B%60)).slice(-4)},"%Z":B=>B.ib,"%%":()=>"%"},b=b.replace(/%%/g,"\\0\\0");for(fe in me)b.includes(fe)&&(b=b.replace(new RegExp(fe,"g"),me[fe](S)));return b=b.replace(/\\0\\0/g,"%"),fe=dr(b),fe.length>m?0:(D.set(fe,d>>>0),fe.length-1)}var Rt=d=>{try{d()}catch(m){ie(m)}};function wn(){var d=oe,m={};for(let[b,S]of Object.entries(d))m[b]=typeof S=="function"?function(){jt.push(b);try{return S.apply(null,arguments)}finally{C||(jt.pop(),Je&&ne===1&&jt.length===0&&(ne=0,Rt(Ct),typeof Fibers<"u"&&Fibers.lb()))}}:S;return m}var ne=0,Je=null,lr=0,jt=[],cr={},Br={},kr=0,Yt=null,Rr=[];function Dr(){return new Promise((d,m)=>{Yt={resolve:d,reject:m}})}function pr(){var d=Zt(65548),m=d+12;W[d>>>2>>>0]=m,W[d+4>>>2>>>0]=m+65536,m=jt[0];var b=cr[m];return b===void 0&&(b=kr++,cr[m]=b,Br[b]=m),E[d+8>>>2>>>0]=b,d}function Mr(d){if(!C){if(ne===0){var m=!1,b=!1;d((S=0)=>{if(!C&&(lr=S,m=!0,b)){ne=2,Rt(()=>wr(Je)),typeof Browser<"u"&&Browser.Oa.Va&&Browser.Oa.resume(),S=!1;try{var P=(0,oe[Br[E[Je+8>>>2>>>0]]])()}catch(X){P=X,S=!0}var N=!1;if(!Je){var L=Yt;L&&(Yt=null,(S?L.reject:L.resolve)(P),N=!0)}if(S&&!N)throw P}}),b=!0,m||(ne=1,Je=pr(),typeof Browser<"u"&&Browser.Oa.Va&&Browser.Oa.pause(),Rt(()=>Jt(Je)))}else ne===2?(ne=0,Rt(vr),gr(Je),Je=null,Rr.forEach(S=>{if(!C)try{S();try{M=M=S=M,r.onExit?.(S),C=!0,l(S,new at(S))}catch(P){P instanceof at||P=="unwind"||l(1,P)}}catch(P){P instanceof at||P=="unwind"||l(1,P)}})):ie(`invalid state: ${ne}`);return lr}}function Ur(d){return Mr(m=>{d().then(m)})}var xt=[],rt,_t,mr=[],fr=(d,m)=>{if(!_t){_t=new WeakMap;var b=rt.length;if(_t)for(var S=0;S<0+b;S++){var P=S,N=xt[P];N||(P>=xt.length&&(xt.length=P+1),xt[P]=N=rt.get(P)),(P=N)&&_t.set(P,S)}}if(b=_t.get(d)||0)return b;if(mr.length)b=mr.pop();else{try{rt.grow(1)}catch(X){throw X instanceof RangeError?"Unable to grow wasm table. Set ALLOW_TABLE_GROWTH.":X}b=rt.length-1}try{S=b,rt.set(S,d),xt[S]=rt.get(S)}catch(X){if(!(X instanceof TypeError))throw X;if(typeof WebAssembly.Function=="function"){S=WebAssembly.Function,P={i:"i32",j:"i64",f:"f32",d:"f64",e:"externref",p:"i32"},N={parameters:[],results:m[0]=="v"?[]:[P[m[0]]]};for(var L=1;L<m.length;++L)N.parameters.push(P[m[L]]);m=new S(N,d)}else{for(S=[1],P=m.slice(0,1),m=m.slice(1),N={i:127,p:127,j:126,f:125,d:124,e:111},S.push(96),L=m.length,128>L?S.push(L):S.push(L%128|128,L>>7),L=0;L<m.length;++L)S.push(N[m[L]]);P=="v"?S.push(0):S.push(1,N[P]),m=[0,97,115,109,1,0,0,0,1],P=S.length,128>P?m.push(P):m.push(P%128|128,P>>7),m.push.apply(m,S),m.push(2,7,1,1,101,1,102,0,0,7,5,1,1,102,0,0),m=new WebAssembly.Module(new Uint8Array(m)),m=new WebAssembly.Instance(m,{e:{f:d}}).exports.f}S=b,rt.set(S,m),xt[S]=rt.get(S)}return _t.set(d,b),b},zr={n:function(d,m,b){return Ur(async()=>{await r.Za(d,m,b)})},a:function(d,m,b){throw d>>>=0,new Ne(d).Ra(m>>>0,b>>>0),je=d,At++,je},g:function(){return 0},M:function(){},C:function(){},E:function(){},v:function(){return 0},K:function(){},F:function(){},J:function(){},m:function(){},D:function(){},A:function(){},L:function(){},B:function(){},N:()=>1,q:function(d,m,b){d=m+2097152>>>0<4194305-!!d?(d>>>0)+4294967296*m:NaN,b>>>=0,d=new Date(1e3*d),E[b>>>2>>>0]=d.getUTCSeconds(),E[b+4>>>2>>>0]=d.getUTCMinutes(),E[b+8>>>2>>>0]=d.getUTCHours(),E[b+12>>>2>>>0]=d.getUTCDate(),E[b+16>>>2>>>0]=d.getUTCMonth(),E[b+20>>>2>>>0]=d.getUTCFullYear()-1900,E[b+24>>>2>>>0]=d.getUTCDay(),E[b+28>>>2>>>0]=(d.getTime()-Date.UTC(d.getUTCFullYear(),0,1,0,0,0,0))/864e5|0},r:function(d,m,b){d=m+2097152>>>0<4194305-!!d?(d>>>0)+4294967296*m:NaN,b>>>=0,d=new Date(1e3*d),E[b>>>2>>>0]=d.getSeconds(),E[b+4>>>2>>>0]=d.getMinutes(),E[b+8>>>2>>>0]=d.getHours(),E[b+12>>>2>>>0]=d.getDate(),E[b+16>>>2>>>0]=d.getMonth(),E[b+20>>>2>>>0]=d.getFullYear()-1900,E[b+24>>>2>>>0]=d.getDay(),E[b+28>>>2>>>0]=(Tt(d.getFullYear())?St:Lt)[d.getMonth()]+d.getDate()-1|0,E[b+36>>>2>>>0]=-(60*d.getTimezoneOffset()),m=new Date(d.getFullYear(),6,1).getTimezoneOffset();var S=new Date(d.getFullYear(),0,1).getTimezoneOffset();E[b+32>>>2>>>0]=(m!=S&&d.getTimezoneOffset()==Math.min(S,m))|0},s:function(d){d>>>=0;var m=new Date(E[d+20>>>2>>>0]+1900,E[d+16>>>2>>>0],E[d+12>>>2>>>0],E[d+8>>>2>>>0],E[d+4>>>2>>>0],E[d>>>2>>>0],0),b=E[d+32>>>2>>>0],S=m.getTimezoneOffset(),P=new Date(m.getFullYear(),6,1).getTimezoneOffset(),N=new Date(m.getFullYear(),0,1).getTimezoneOffset(),L=Math.min(N,P);return 0>b?E[d+32>>>2>>>0]=+(P!=N&&L==S):0<b!=(L==S)&&(P=Math.max(N,P),m.setTime(m.getTime()+6e4*((0<b?L:P)-S))),E[d+24>>>2>>>0]=m.getDay(),E[d+28>>>2>>>0]=(Tt(m.getFullYear())?St:Lt)[m.getMonth()]+m.getDate()-1|0,E[d>>>2>>>0]=m.getSeconds(),E[d+4>>>2>>>0]=m.getMinutes(),E[d+8>>>2>>>0]=m.getHours(),E[d+12>>>2>>>0]=m.getDate(),E[d+16>>>2>>>0]=m.getMonth(),E[d+20>>>2>>>0]=m.getYear(),d=m.getTime(),isNaN(d)?(E[hr()>>>2>>>0]=61,d=-1):d/=1e3,yr((Me=d,1<=+Math.abs(Me)?0<Me?+Math.floor(Me/4294967296)>>>0:~~+Math.ceil((Me-+(~~Me>>>0))/4294967296)>>>0:0)),d>>>0},o:function(){return-52},p:function(){},y:function(d,m,b){function S(pe){return(pe=pe.toTimeString().match(/\\(([A-Za-z ]+)\\)$/))?pe[1]:"GMT"}b>>>=0;var P=new Date().getFullYear(),N=new Date(P,0,1),L=new Date(P,6,1);P=N.getTimezoneOffset();var X=L.getTimezoneOffset();W[d>>>0>>>2>>>0]=60*Math.max(P,X),E[m>>>0>>>2>>>0]=+(P!=X),d=S(N),m=S(L),d=Ft(d),m=Ft(m),X<P?(W[b>>>2>>>0]=d,W[b+4>>>2>>>0]=m):(W[b>>>2>>>0]=m,W[b+4>>>2>>>0]=d)},e:()=>{ie("")},b:function(d,m,b){return d>>>=0,m=ir(m>>>0,b>>>0),tt[d].apply(null,m)},j:function(d,m,b){return d>>>=0,m=ir(m>>>0,b>>>0),tt[d].apply(null,m)},h:()=>Date.now(),z:function(){return 4294901760},c:()=>performance.now(),I:function(d,m,b){return m>>>=0,G.copyWithin(d>>>0>>>0,m>>>0,m+(b>>>0)>>>0)},w:function(d){d>>>=0;var m=G.length;if(4294901760<d)return!1;for(var b=1;4>=b;b*=2){var S=m*(1+.2/b);S=Math.min(S,d+100663296);var P=Math;S=Math.max(d,S);e:{P=(P.min.call(P,4294901760,S+(65536-S%65536)%65536)-O.buffer.byteLength+65535)/65536;try{O.grow(P),Z();var N=1;break e}catch{}N=void 0}if(N)return!0}return!1},G:function(d,m){d>>>=0,m>>>=0;var b=0;return sr().forEach((S,P)=>{var N=m+b;for(P=W[d+4*P>>>2>>>0]=N,N=0;N<S.length;++N)D[P++>>>0>>>0]=S.charCodeAt(N);D[P>>>0>>>0]=0,b+=S.length+1}),0},H:function(d,m){d>>>=0,m>>>=0;var b=sr();W[d>>>2>>>0]=b.length;var S=0;return b.forEach(P=>S+=P.length+1),W[m>>>2>>>0]=S,0},f:()=>52,l:function(){return 52},t:function(){return 70},k:function(d,m,b,S){m>>>=0,b>>>=0,S>>>=0;for(var P=0,N=0;N<b;N++){var L=W[m>>>2>>>0],X=W[m+4>>>2>>>0];m+=8;for(var pe=0;pe<X;pe++){var me=G[L+pe>>>0],fe=Ye[d];me===0||me===10?((d===1?x:A)(ct(fe,0)),fe.length=0):fe.push(me)}P+=X}return W[S>>>2>>>0]=P,0},u:function(d,m){return d>>>=0,Be(G.subarray(d>>>0,d+(m>>>0)>>>0)),0},x:Pr,d:function(d,m,b,S){return Pr(d>>>0,m>>>0,b>>>0,S>>>0)},i:function(d,m,b,S){let P=rt.length;d=new Uint8Array(G.slice(d+m,d+b));try{var N=new WebAssembly.Module(d),L=new WebAssembly.Instance(N,{env:{memory:O}}),X;for(X in L.exports)fr(L.exports[X]);return P<rt.length?P:S}catch(pe){return console.log(pe),S}}},oe=function(){function d(b){return oe=b.exports,oe=wn(),oe=Vr(),O=oe.O,Z(),rt=oe.wa,Te.unshift(oe.P),re--,re==0&&(Ie!==null&&(clearInterval(Ie),Ie=null),Oe&&(b=Oe,Oe=null,b())),oe}var m={a:zr};if(re++,r.instantiateWasm)try{return r.instantiateWasm(m,d)}catch(b){A(`Module.instantiateWasm callback failed with error: ${b}`),n(b)}return $t(m,function(b){d(b.instance)}).catch(n),{}}();r._OrtInit=(d,m)=>(r._OrtInit=oe.Q)(d,m),r._OrtGetLastError=(d,m)=>(r._OrtGetLastError=oe.R)(d,m),r._OrtCreateSessionOptions=(d,m,b,S,P,N,L,X,pe,me)=>(r._OrtCreateSessionOptions=oe.S)(d,m,b,S,P,N,L,X,pe,me),r._OrtAppendExecutionProvider=(d,m)=>(r._OrtAppendExecutionProvider=oe.T)(d,m),r._OrtAddFreeDimensionOverride=(d,m,b)=>(r._OrtAddFreeDimensionOverride=oe.U)(d,m,b),r._OrtAddSessionConfigEntry=(d,m,b)=>(r._OrtAddSessionConfigEntry=oe.V)(d,m,b),r._OrtReleaseSessionOptions=d=>(r._OrtReleaseSessionOptions=oe.W)(d),r._OrtCreateSession=(d,m,b)=>(r._OrtCreateSession=oe.X)(d,m,b),r._OrtReleaseSession=d=>(r._OrtReleaseSession=oe.Y)(d),r._OrtGetInputOutputCount=(d,m,b)=>(r._OrtGetInputOutputCount=oe.Z)(d,m,b),r._OrtGetInputName=(d,m)=>(r._OrtGetInputName=oe._)(d,m),r._OrtGetOutputName=(d,m)=>(r._OrtGetOutputName=oe.$)(d,m),r._OrtFree=d=>(r._OrtFree=oe.aa)(d),r._OrtCreateTensor=(d,m,b,S,P,N)=>(r._OrtCreateTensor=oe.ba)(d,m,b,S,P,N),r._OrtGetTensorData=(d,m,b,S,P)=>(r._OrtGetTensorData=oe.ca)(d,m,b,S,P),r._OrtReleaseTensor=d=>(r._OrtReleaseTensor=oe.da)(d),r._OrtCreateRunOptions=(d,m,b,S)=>(r._OrtCreateRunOptions=oe.ea)(d,m,b,S),r._OrtAddRunConfigEntry=(d,m,b)=>(r._OrtAddRunConfigEntry=oe.fa)(d,m,b),r._OrtReleaseRunOptions=d=>(r._OrtReleaseRunOptions=oe.ga)(d),r._OrtCreateBinding=d=>(r._OrtCreateBinding=oe.ha)(d),r._OrtBindInput=(d,m,b)=>(r._OrtBindInput=oe.ia)(d,m,b),r._OrtBindOutput=(d,m,b,S)=>(r._OrtBindOutput=oe.ja)(d,m,b,S),r._OrtClearBoundOutputs=d=>(r._OrtClearBoundOutputs=oe.ka)(d),r._OrtReleaseBinding=d=>(r._OrtReleaseBinding=oe.la)(d),r._OrtRunWithBinding=(d,m,b,S,P)=>(r._OrtRunWithBinding=oe.ma)(d,m,b,S,P),r._OrtRun=(d,m,b,S,P,N,L,X)=>(r._OrtRun=oe.na)(d,m,b,S,P,N,L,X),r._OrtEndProfiling=d=>(r._OrtEndProfiling=oe.oa)(d),r._OrtConfigure=(d,m)=>(r._OrtConfigure=oe.pa)(d,m),r._OrtAuth=(d,m)=>(r._OrtAuth=oe.qa)(d,m),r._JsepOutput=(d,m,b)=>(r._JsepOutput=oe.ra)(d,m,b),r._JsepGetNodeName=d=>(r._JsepGetNodeName=oe.sa)(d);var hr=()=>(hr=oe.ta)(),Zt=r._malloc=d=>(Zt=r._malloc=oe.ua)(d),gr=r._free=d=>(gr=r._free=oe.va)(d),yr=d=>(yr=oe.xa)(d),br=()=>(br=oe.ya)(),Qt=d=>(Qt=oe.za)(d),Dt=d=>(Dt=oe.Aa)(d),Jt=d=>(Jt=oe.Ca)(d),Ct=()=>(Ct=oe.Da)(),wr=d=>(wr=oe.Ea)(d),vr=()=>(vr=oe.Fa)();r.___start_em_js=910449,r.___stop_em_js=911222;function Vr(){var d=oe;d=Object.assign({},d);var m=S=>()=>S()>>>0,b=S=>P=>S(P)>>>0;return d.ta=m(d.ta),d.ua=b(d.ua),d.ya=m(d.ya),d.Aa=b(d.Aa),d}r.stackAlloc=Dt,r.stackSave=br,r.stackRestore=Qt,r.addFunction=fr,r.UTF8ToString=Ke,r.stringToUTF8=(d,m,b)=>Ht(d,G,m,b),r.lengthBytesUTF8=ar;var Mt;Oe=function d(){Mt||$r(),Mt||(Oe=d)};function $r(){if(!(0<re)){if(r.preRun)for(typeof r.preRun=="function"&&(r.preRun=[r.preRun]);r.preRun.length;){var d=r.preRun.shift();ee.unshift(d)}for(;0<ee.length;)ee.shift()(r);if(!(0<re||Mt||(Mt=!0,r.calledRun=!0,C))){for(;0<Te.length;)Te.shift()(r);for(o(r);0<De.length;)De.shift()(r)}}}return $r(),t.ready}})();typeof zo=="object"&&typeof kn=="object"?kn.exports=Uo:typeof define=="function"&&define.amd&&define([],()=>Uo)});var No=Sr(()=>{});var Wo=Sr(()=>{});var Go={};xr(Go,{cpus:()=>ld});var ld,Ho=q(()=>{ld=void 0});var Ko=Sr((Fo,Rn)=>{"use strict";var Lo=(()=>{var e=typeof document<"u"&&document.currentScript?document.currentScript.src:void 0;return typeof __filename<"u"&&(e=e||__filename),function(t={}){function r(){return ee.buffer!=Ie.buffer&&Fe(),Ie}function o(){return ee.buffer!=Ie.buffer&&Fe(),Oe}function n(){return ee.buffer!=Ie.buffer&&Fe(),ie}function s(){return ee.buffer!=Ie.buffer&&Fe(),Se}function u(){return ee.buffer!=Ie.buffer&&Fe(),Ae}function l(){return ee.buffer!=Ie.buffer&&Fe(),Pe}var a=t,p,h;a.ready=new Promise((i,c)=>{p=i,h=c}),a.mountExternalData=(i,c)=>{(a.ib||(a.ib=new Map)).set(i,c)},a.unmountExternalData=()=>{delete a.ib},a.jsepInit=(i,c,f,$,T,R,z,Q,be,ce,ye)=>{a.Ub=i,a.Bb=c,a.Fb=f,a.pb=$,a.Eb=T,a.Ua=R,a.Gb=z,a.Ib=Q,a.Cb=be,a.Db=ce,a.Hb=ye,c=(le,_e,k)=>(...se)=>{let ve=pt,Xe=_e?.();se=le(...se);let Ut=_e?.();return Xe!==Ut&&(le=Ut,k(Xe),_e=k=null),pt!=ve?ju():se},f=le=>async(..._e)=>{try{if(a.hb)throw Error("Session already started");let k=a.hb={Kb:_e[0],errors:[]},se=await le(..._e);if(a.hb!==k)throw Error("Session mismatch");i.flush();let ve=k.errors;if(0<ve.length){let Xe=await Promise.all(ve);if(Xe=Xe.filter(Ut=>Ut),0<Xe.length)throw Error(Xe.join(`\n`))}return se}finally{a.hb=null}},a._OrtRun=f(c(a._OrtRun,()=>a._OrtRun,le=>a._OrtRun=le)),a._OrtRunWithBinding=f(c(a._OrtRunWithBinding,()=>a._OrtRunWithBinding,le=>a._OrtRunWithBinding=le)),a._OrtBindInput=c(a._OrtBindInput,()=>a._OrtBindInput,le=>a._OrtBindInput=le),a.jsepRegisterBuffer=(le,_e,k,se)=>i.registerBuffer(le,_e,k,se),a.jsepGetBuffer=le=>i.getBuffer(le),a.jsepCreateDownloader=(le,_e,k)=>i.createDownloader(le,_e,k),a.jsepOnReleaseSession=le=>{i.onReleaseSession(le)},a.jsepOnRunStart=le=>i.onRunStart(le)};var g=Object.assign({},a),w="./this.program",v=(i,c)=>{throw c},y=typeof window=="object",_=typeof importScripts=="function",I=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string",x=a.ENVIRONMENT_IS_PTHREAD||!1,A="";function O(i){return a.locateFile?a.locateFile(i,A):A+i}var C,M,D;if(I){var G=(Tn(),Ot(An)),E=(On(),Ot(En));A=_?E.dirname(A)+"/":__dirname+"/",C=(c,f)=>(c=lt(c)?new URL(c):E.normalize(c),G.readFileSync(c,f?void 0:"utf8")),D=c=>(c=C(c,!0),c.buffer||(c=new Uint8Array(c)),c),M=(c,f,$,T=!0)=>{c=lt(c)?new URL(c):E.normalize(c),G.readFile(c,T?void 0:"utf8",(R,z)=>{R?$(R):f(T?z.buffer:z)})},!a.thisProgram&&1<process.argv.length&&(w=process.argv[1].replace(/\\\\/g,"/")),process.argv.slice(2),v=(c,f)=>{throw process.exitCode=c,f},a.inspect=()=>"[Emscripten Module object]";let i;try{i=No()}catch(c){throw console.error(\'The "worker_threads" module is not supported in this node.js build - perhaps a newer version is needed?\'),c}global.Worker=i.Worker}else(y||_)&&(_?A=self.location.href:typeof document<"u"&&document.currentScript&&(A=document.currentScript.src),typeof e<"u"&&e&&(A=e),A.indexOf("blob:")!==0?A=A.substr(0,A.replace(/[?#].*/,"").lastIndexOf("/")+1):A="",I||(C=i=>{var c=new XMLHttpRequest;return c.open("GET",i,!1),c.send(null),c.responseText},_&&(D=i=>{var c=new XMLHttpRequest;return c.open("GET",i,!1),c.responseType="arraybuffer",c.send(null),new Uint8Array(c.response)}),M=(i,c,f)=>{var $=new XMLHttpRequest;$.open("GET",i,!0),$.responseType="arraybuffer",$.onload=()=>{$.status==200||$.status==0&&$.response?c($.response):f()},$.onerror=f,$.send(null)}));I&&typeof performance>"u"&&(global.performance=Wo().performance);var W=console.log.bind(console),te=console.error.bind(console);I&&(W=(...i)=>G.writeSync(1,i.join(" ")+`\n`),te=(...i)=>G.writeSync(2,i.join(" ")+`\n`));var Y=W,Z=te;Object.assign(a,g),g=null,typeof WebAssembly!="object"&&je("no native wasm support detected");var ee,Te,De=!1,re,Ie,Oe,ie,Se,Ae,Pe;function Fe(){var i=ee.buffer;a.HEAP8=Ie=new Int8Array(i),a.HEAP16=new Int16Array(i),a.HEAPU8=Oe=new Uint8Array(i),a.HEAPU16=new Uint16Array(i),a.HEAP32=ie=new Int32Array(i),a.HEAPU32=Se=new Uint32Array(i),a.HEAPF32=Ae=new Float32Array(i),a.HEAPF64=Pe=new Float64Array(i)}var H=16777216;if(x)ee=a.wasmMemory;else if(a.wasmMemory)ee=a.wasmMemory;else if(ee=new WebAssembly.Memory({initial:H/65536,maximum:65536,shared:!0}),!(ee.buffer instanceof SharedArrayBuffer))throw Z("requested a shared WebAssembly.Memory but the returned buffer is not a SharedArrayBuffer, indicating that while the browser has SharedArrayBuffer it does not have WebAssembly threads support - you may need to set a flag"),I&&Z("(on node you may need: --experimental-wasm-threads --experimental-wasm-bulk-memory and/or recent version)"),Error("bad memory");Fe(),H=ee.buffer.byteLength;var J=[],Ce=[],$t=[],Me=0,tt=null,at=null;function Ne(){if(Me--,Me==0&&(tt!==null&&(clearInterval(tt),tt=null),at)){var i=at;at=null,i()}}function je(i){throw i="Aborted("+i+")",Z(i),De=!0,re=1,i=new WebAssembly.RuntimeError(i+". Build with -sASSERTIONS for more info."),h(i),i}var At=i=>i.startsWith("data:application/octet-stream;base64,"),lt=i=>i.startsWith("file://"),ct;ct="ort-wasm-simd-threaded.wasm",At(ct)||(ct=O(ct));function Ke(i){if(D)return D(i);throw"both async and sync fetching of the wasm failed"}function ar(i){if(y||_){if(typeof fetch=="function"&&!lt(i))return fetch(i,{credentials:"same-origin"}).then(c=>{if(!c.ok)throw"failed to load wasm binary file at \'"+i+"\'";return c.arrayBuffer()}).catch(()=>Ke(i));if(M)return new Promise((c,f)=>{M(i,$=>c(new Uint8Array($)),f)})}return Promise.resolve().then(()=>Ke(i))}function Ht(i,c,f){return ar(i).then($=>WebAssembly.instantiate($,c)).then($=>$).then(f,$=>{Z(`failed to asynchronously prepare wasm: ${$}`),je($)})}function Tt(i,c){var f=ct;return typeof WebAssembly.instantiateStreaming!="function"||At(f)||lt(f)||I||typeof fetch!="function"?Ht(f,i,c):fetch(f,{credentials:"same-origin"}).then($=>WebAssembly.instantiateStreaming($,i).then(c,function(T){return Z(`wasm streaming compile failed: ${T}`),Z("falling back to ArrayBuffer instantiation"),Ht(f,i,c)}))}var St,Lt={902852:(i,c,f,$)=>{if(typeof a>"u"||!a.ib)return 1;if(i=Ye(i>>>0),i.startsWith("./")&&(i=i.substring(2)),i=a.ib.get(i),!i)return 2;if(c>>>=0,f>>>=0,$>>>=0,c+f>i.byteLength)return 3;try{return o().set(i.subarray(c,c+f),$>>>0),0}catch{return 4}},903353:()=>{a.Cb()},903384:()=>{a.Db()},903413:()=>{a.Hb()},903438:i=>a.Bb(i),903471:i=>a.Fb(i),903503:(i,c,f)=>{a.pb(i,c,f,!0)},903542:(i,c,f)=>{a.pb(i,c,f)},903575:i=>{a.Ua("Abs",i,void 0)},903626:i=>{a.Ua("Neg",i,void 0)},903677:i=>{a.Ua("Floor",i,void 0)},903730:i=>{a.Ua("Ceil",i,void 0)},903782:i=>{a.Ua("Reciprocal",i,void 0)},903840:i=>{a.Ua("Sqrt",i,void 0)},903892:i=>{a.Ua("Exp",i,void 0)},903943:i=>{a.Ua("Erf",i,void 0)},903994:i=>{a.Ua("Sigmoid",i,void 0)},904049:i=>{a.Ua("Log",i,void 0)},904100:i=>{a.Ua("Sin",i,void 0)},904151:i=>{a.Ua("Cos",i,void 0)},904202:i=>{a.Ua("Tan",i,void 0)},904253:i=>{a.Ua("Asin",i,void 0)},904305:i=>{a.Ua("Acos",i,void 0)},904357:i=>{a.Ua("Atan",i,void 0)},904409:i=>{a.Ua("Sinh",i,void 0)},904461:i=>{a.Ua("Cosh",i,void 0)},904513:i=>{a.Ua("Asinh",i,void 0)},904566:i=>{a.Ua("Acosh",i,void 0)},904619:i=>{a.Ua("Atanh",i,void 0)},904672:i=>{a.Ua("Tanh",i,void 0)},904724:i=>{a.Ua("Not",i,void 0)},904775:(i,c,f)=>{a.Ua("Clip",i,{min:c,max:f})},904844:i=>{a.Ua("Clip",i,void 0)},904896:(i,c)=>{a.Ua("Elu",i,{alpha:c})},904954:i=>{a.Ua("Relu",i,void 0)},905006:(i,c)=>{a.Ua("LeakyRelu",i,{alpha:c})},905070:(i,c)=>{a.Ua("ThresholdedRelu",i,{alpha:c})},905140:(i,c)=>{a.Ua("Cast",i,{to:c})},905198:i=>{a.Ua("Add",i,void 0)},905249:i=>{a.Ua("Sub",i,void 0)},905300:i=>{a.Ua("Mul",i,void 0)},905351:i=>{a.Ua("Div",i,void 0)},905402:i=>{a.Ua("Pow",i,void 0)},905453:i=>{a.Ua("Equal",i,void 0)},905506:i=>{a.Ua("Greater",i,void 0)},905561:i=>{a.Ua("GreaterOrEqual",i,void 0)},905623:i=>{a.Ua("Less",i,void 0)},905675:i=>{a.Ua("LessOrEqual",i,void 0)},905734:(i,c,f,$,T)=>{a.Ua("ReduceMean",i,{keepDims:!!c,noopWithEmptyAxes:!!f,axes:$?Array.from(n().subarray($>>>0,T>>>0)):[]})},905893:(i,c,f,$,T)=>{a.Ua("ReduceMax",i,{keepDims:!!c,noopWithEmptyAxes:!!f,axes:$?Array.from(n().subarray($>>>0,T>>>0)):[]})},906051:(i,c,f,$,T)=>{a.Ua("ReduceMin",i,{keepDims:!!c,noopWithEmptyAxes:!!f,axes:$?Array.from(n().subarray($>>>0,T>>>0)):[]})},906209:(i,c,f,$,T)=>{a.Ua("ReduceProd",i,{keepDims:!!c,noopWithEmptyAxes:!!f,axes:$?Array.from(n().subarray($>>>0,T>>>0)):[]})},906368:(i,c,f,$,T)=>{a.Ua("ReduceSum",i,{keepDims:!!c,noopWithEmptyAxes:!!f,axes:$?Array.from(n().subarray($>>>0,T>>>0)):[]})},906526:(i,c,f,$,T)=>{a.Ua("ReduceL1",i,{keepDims:!!c,noopWithEmptyAxes:!!f,axes:$?Array.from(n().subarray($>>>0,T>>>0)):[]})},906683:(i,c,f,$,T)=>{a.Ua("ReduceL2",i,{keepDims:!!c,noopWithEmptyAxes:!!f,axes:$?Array.from(n().subarray($>>>0,T>>>0)):[]})},906840:(i,c,f,$,T)=>{a.Ua("ReduceLogSum",i,{keepDims:!!c,noopWithEmptyAxes:!!f,axes:$?Array.from(n().subarray($>>>0,T>>>0)):[]})},907001:(i,c,f,$,T)=>{a.Ua("ReduceSumSquare",i,{keepDims:!!c,noopWithEmptyAxes:!!f,axes:$?Array.from(n().subarray($>>>0,T>>>0)):[]})},907165:(i,c,f,$,T)=>{a.Ua("ReduceLogSumExp",i,{keepDims:!!c,noopWithEmptyAxes:!!f,axes:$?Array.from(n().subarray($>>>0,T>>>0)):[]})},907329:i=>{a.Ua("Where",i,void 0)},907382:(i,c,f)=>{a.Ua("Transpose",i,{perm:c?Array.from(n().subarray(c>>>0,f>>>0)):[]})},907490:(i,c,f,$,T,R,z,Q,be,ce,ye,le,_e,k,se)=>{a.Ua("ConvTranspose",i,{format:be?"NHWC":"NCHW",autoPad:c,dilations:[f],group:$,kernel_shape:[T],pads:[R,z],strides:[Q],wIsConst:()=>!!r()[ce>>>0],outputPadding:ye?Array.from(n().subarray(ye>>>0,le>>>0)):[],outputShape:_e?Array.from(n().subarray(_e>>>0,k>>>0)):[],activation:Ye(se)})},907892:(i,c,f,$,T,R,z,Q,be,ce,ye,le,_e,k)=>{a.Ua("ConvTranspose",i,{format:Q?"NHWC":"NCHW",autoPad:c,dilations:Array.from(n().subarray(f>>>0,(f>>>0)+2>>>0)),group:$,kernelShape:Array.from(n().subarray(T>>>0,(T>>>0)+2>>>0)),pads:Array.from(n().subarray(R>>>0,(R>>>0)+4>>>0)),strides:Array.from(n().subarray(z>>>0,(z>>>0)+2>>>0)),wIsConst:()=>!!r()[be>>>0],outputPadding:ce?Array.from(n().subarray(ce>>>0,ye>>>0)):[],outputShape:le?Array.from(n().subarray(le>>>0,_e>>>0)):[],activation:Ye(k)})},908457:(i,c,f,$,T,R,z,Q,be,ce,ye,le,_e,k,se)=>{a.Ua("ConvTranspose",i,{format:be?"NHWC":"NCHW",autoPad:c,dilations:[f],group:$,kernel_shape:[T],pads:[R,z],strides:[Q],wIsConst:()=>!!r()[ce>>>0],outputPadding:ye?Array.from(n().subarray(ye>>>0,le>>>0)):[],outputShape:_e?Array.from(n().subarray(_e>>>0,k>>>0)):[],activation:Ye(se)})},908859:(i,c,f,$,T,R,z,Q,be,ce,ye,le,_e,k)=>{a.Ua("ConvTranspose",i,{format:Q?"NHWC":"NCHW",autoPad:c,dilations:Array.from(n().subarray(f>>>0,(f>>>0)+2>>>0)),group:$,kernelShape:Array.from(n().subarray(T>>>0,(T>>>0)+2>>>0)),pads:Array.from(n().subarray(R>>>0,(R>>>0)+4>>>0)),strides:Array.from(n().subarray(z>>>0,(z>>>0)+2>>>0)),wIsConst:()=>!!r()[be>>>0],outputPadding:ce?Array.from(n().subarray(ce>>>0,ye>>>0)):[],outputShape:le?Array.from(n().subarray(le>>>0,_e>>>0)):[],activation:Ye(k)})},909424:(i,c)=>{a.Ua("GlobalAveragePool",i,{format:c?"NHWC":"NCHW"})},909515:(i,c,f,$,T,R,z,Q,be,ce,ye,le,_e,k,se,ve)=>{a.Ua("AveragePool",i,{format:ve?"NHWC":"NCHW",auto_pad:c,ceil_mode:f,count_include_pad:$,storage_order:T,dilations:[R,z],kernel_shape:[Q,be],pads:[ce,ye,le,_e],strides:[k,se]})},909799:(i,c)=>{a.Ua("GlobalAveragePool",i,{format:c?"NHWC":"NCHW"})},909890:(i,c,f,$,T,R,z,Q,be,ce,ye,le,_e,k,se,ve)=>{a.Ua("AveragePool",i,{format:ve?"NHWC":"NCHW",auto_pad:c,ceil_mode:f,count_include_pad:$,storage_order:T,dilations:[R,z],kernel_shape:[Q,be],pads:[ce,ye,le,_e],strides:[k,se]})},910174:(i,c)=>{a.Ua("GlobalMaxPool",i,{format:c?"NHWC":"NCHW"})},910261:(i,c,f,$,T,R,z,Q,be,ce,ye,le,_e,k,se,ve)=>{a.Ua("MaxPool",i,{format:ve?"NHWC":"NCHW",auto_pad:c,ceil_mode:f,count_include_pad:$,storage_order:T,dilations:[R,z],kernel_shape:[Q,be],pads:[ce,ye,le,_e],strides:[k,se]})},910541:(i,c)=>{a.Ua("GlobalMaxPool",i,{format:c?"NHWC":"NCHW"})},910628:(i,c,f,$,T,R,z,Q,be,ce,ye,le,_e,k,se,ve)=>{a.Ua("MaxPool",i,{format:ve?"NHWC":"NCHW",auto_pad:c,ceil_mode:f,count_include_pad:$,storage_order:T,dilations:[R,z],kernel_shape:[Q,be],pads:[ce,ye,le,_e],strides:[k,se]})},910908:(i,c,f,$,T)=>{a.Ua("Gemm",i,{alpha:c,beta:f,transA:$,transB:T})},911012:i=>{a.Ua("MatMul",i,void 0)},911066:(i,c,f,$)=>{a.Ua("ArgMax",i,{keepDims:!!c,selectLastIndex:!!f,axis:$})},911174:(i,c,f,$)=>{a.Ua("ArgMin",i,{keepDims:!!c,selectLastIndex:!!f,axis:$})},911282:(i,c)=>{a.Ua("Softmax",i,{axis:c})},911345:(i,c)=>{a.Ua("Concat",i,{axis:c})},911405:(i,c,f,$,T)=>{a.Ua("Split",i,{axis:c,numOutputs:f,splitSizes:$?Array.from(n().subarray($>>>0,T>>>0)):[]})},911545:i=>{a.Ua("Expand",i,void 0)},911599:(i,c)=>{a.Ua("Gather",i,{axis:Number(c)})},911670:(i,c)=>{a.Ua("GatherElements",i,{axis:Number(c)})},911749:(i,c,f,$,T,R,z,Q,be,ce,ye)=>{a.Ua("Resize",i,{antialias:c,axes:f?Array.from(n().subarray(f>>>0,$>>>0)):[],coordinateTransformMode:Ye(T),cubicCoeffA:R,excludeOutside:z,extrapolationValue:Q,keepAspectRatioPolicy:Ye(be),mode:Ye(ce),nearestMode:Ye(ye)})},912095:(i,c,f,$,T,R,z)=>{a.Ua("Slice",i,{starts:c?Array.from(n().subarray(c>>>0,f>>>0)):[],ends:$?Array.from(n().subarray($>>>0,T>>>0)):[],axes:R?Array.from(n().subarray(R>>>0,z>>>0)):[]})},912311:i=>{a.Ua("Tile",i,void 0)},912363:(i,c,f)=>{a.Ua("LayerNormalization",i,{axis:Number(c),epsilon:Number(f)})},912470:(i,c,f)=>{a.Ua("InstanceNormalization",i,{epsilon:c,format:f?"NHWC":"NCHW"})},912584:(i,c,f)=>{a.Ua("InstanceNormalization",i,{epsilon:c,format:f?"NHWC":"NCHW"})},912698:i=>{a.Ua("Range",i,void 0)},912751:(i,c)=>{a.Ua("Einsum",i,{equation:Ye(c)})},912832:(i,c,f,$,T)=>{a.Ua("Pad",i,{mode:c,value:f,pads:$?Array.from(n().subarray($>>>0,T>>>0)):[]})},912959:(i,c,f,$,T,R)=>{a.Ua("BatchNormalization",i,{epsilon:c,momentum:f,spatial:!!T,trainingMode:!!$,format:R?"NHWC":"NCHW"})},913128:(i,c,f,$,T,R)=>{a.Ua("BatchNormalization",i,{epsilon:c,momentum:f,spatial:!!T,trainingMode:!!$,format:R?"NHWC":"NCHW"})},913297:(i,c,f)=>{a.Ua("CumSum",i,{exclusive:Number(c),reverse:Number(f)})},913394:(i,c,f,$,T,R,z,Q,be)=>{a.Ua("Attention",i,{numHeads:c,isUnidirectional:f,maskFilterValue:$,scale:T,doRotary:R,qkvHiddenSizes:z?Array.from(n().subarray(Number(Q)>>>0,Number(Q)+z>>>0)):[],pastPresentShareBuffer:!!be})},913666:i=>{a.Ua("Gelu",i,void 0)},913718:(i,c,f,$,T,R)=>{a.Ua("MultiHeadAttention",i,{numHeads:c,isUnidirectional:f,maskFilterValue:$,scale:T,doRotary:R})},913877:i=>{a.Ua("BiasAdd",i,void 0)},913932:i=>{a.Ua("BiasSplitGelu",i,void 0)},913993:(i,c)=>{a.Ua("SkipLayerNormalization",i,{epsilon:c})},914074:(i,c,f,$,T,R,z,Q,be,ce,ye,le,_e)=>{a.Ua("Conv",i,{format:be?"NHWC":"NCHW",auto_pad:c,dilations:[f],group:$,kernel_shape:[T],pads:R?Array.from(n().subarray(R>>>0,z>>>0)):[],strides:[Q],w_is_const:()=>!!r()[ce>>>0],activation:Ye(ye),activation_params:le?Array.from(u().subarray(le>>>0,_e>>>0)):[]})},914444:(i,c,f,$,T,R,z,Q,be,ce,ye,le,_e,k,se,ve)=>{a.Ua("Conv",i,{format:le?"NHWC":"NCHW",auto_pad:c,dilations:[f,$],group:T,kernel_shape:[R,z],pads:Q?Array.from(n().subarray(Q>>>0,be>>>0)):[],strides:[ce,ye],w_is_const:()=>!!r()[_e>>>0],activation:Ye(k),activation_params:se?Array.from(u().subarray(se>>>0,ve>>>0)):[]})},914835:i=>{a.Gb(i)},914869:(i,c)=>a.Ib(i,c,a.hb.Kb,a.hb.errors)};function Ft(i){this.name="ExitStatus",this.message=`Program terminated with exit(${i})`,this.status=i}var kt=i=>{i.terminate(),i.onmessage=()=>{}},ir=i=>{ne.cb.length==0&&(Rt(),ne.qb(ne.cb[0]));var c=ne.cb.pop();if(!c)return 6;ne.eb.push(c),ne.$a[i.bb]=c,c.bb=i.bb;var f={cmd:"run",start_routine:i.Lb,arg:i.xb,pthread_ptr:i.bb};return I&&c.unref(),c.postMessage(f,i.Rb),0},it=0,sr=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0,Kt=(i,c,f)=>{c>>>=0;var $=c+f;for(f=c;i[f]&&!(f>=$);)++f;if(16<f-c&&i.buffer&&sr)return sr.decode(i.buffer instanceof SharedArrayBuffer?i.slice(c,f):i.subarray(c,f));for($="";c<f;){var T=i[c++];if(T&128){var R=i[c++]&63;if((T&224)==192)$+=String.fromCharCode((T&31)<<6|R);else{var z=i[c++]&63;T=(T&240)==224?(T&15)<<12|R<<6|z:(T&7)<<18|R<<12|z<<6|i[c++]&63,65536>T?$+=String.fromCharCode(T):(T-=65536,$+=String.fromCharCode(55296|T>>10,56320|T&1023))}}else $+=String.fromCharCode(T)}return $},Ye=(i,c)=>(i>>>=0)?Kt(o(),i,c):"",bn=i=>{var c=_n();return i=i(),Hr(c),i};function Be(i,c){var f=arguments.length-2,$=arguments;return bn(()=>{for(var T=Cn(8*f),R=T>>>3,z=0;z<f;z++){var Q=$[2+z];l()[R+z>>>0]=Q}return Io(i,f,T,c)})}function ur(i){if(x)return Be(0,1,i);re=i,0<it||(ne.Mb(),a.onExit?.(i),De=!0),v(i,new Ft(i))}var qt=i=>{if(re=i,x)throw lr(i),"unwind";ur(i)},dr=i=>{i instanceof Ft||i=="unwind"||v(1,i)};function Pr(){for(var i=a.numThreads;i--;)Rt();J.unshift(()=>{Me++,wn(()=>Ne())})}function Rt(){var i=O("ort-wasm-simd-threaded.worker.js");i=new Worker(i),ne.cb.push(i)}function wn(i){x?i():Promise.all(ne.cb.map(ne.qb)).then(i)}var ne={cb:[],eb:[],ub:[],$a:{},mb(){x?(ne.receiveObjectTransfer=ne.Jb,ne.threadInitTLS=ne.tb,ne.setExitStatus=ne.sb):Pr()},sb:i=>re=i,Vb:["$terminateWorker"],Mb:()=>{for(var i of ne.eb)kt(i);for(i of ne.cb)kt(i);ne.cb=[],ne.eb=[],ne.$a=[]},rb:i=>{var c=i.bb;delete ne.$a[c],ne.cb.push(i),ne.eb.splice(ne.eb.indexOf(i),1),i.bb=0,Sn(c)},Jb(){},tb(){ne.ub.forEach(i=>i())},qb:i=>new Promise(c=>{i.onmessage=R=>{R=R.data;var z=R.cmd;if(R.targetThread&&R.targetThread!=Gr()){var Q=ne.$a[R.targetThread];Q?Q.postMessage(R,R.transferList):Z(`Internal error! Worker sent a message "${z}" to target pthread ${R.targetThread}, but that thread no longer exists!`)}else z==="checkMailbox"?Dt():z==="spawnThread"?ir(R):z==="cleanupThread"?ne.rb(ne.$a[R.thread]):z==="killThread"?(R=R.thread,z=ne.$a[R],delete ne.$a[R],kt(z),Sn(R),ne.eb.splice(ne.eb.indexOf(z),1),z.bb=0):z==="cancelThread"?ne.$a[R.thread].postMessage({cmd:"cancel"}):z==="loaded"?(i.loaded=!0,I&&!i.bb&&i.unref(),c(i)):z==="alert"?alert(`Thread ${R.threadId}: ${R.text}`):R.target==="setimmediate"?i.postMessage(R):z==="callHandler"?a[R.handler](...R.args):z&&Z(`worker sent an unknown command ${z}`)},i.onerror=R=>{throw Z(`worker sent an error! ${R.filename}:${R.lineno}: ${R.message}`),R},I&&(i.on("message",R=>i.onmessage({data:R})),i.on("error",R=>i.onerror(R)));var f=[],$=["onExit"],T;for(T of $)a.hasOwnProperty(T)&&f.push(T);i.postMessage({cmd:"load",handlers:f,urlOrBlob:a.mainScriptUrlOrBlob||e,wasmMemory:ee,wasmModule:Te})})};a.PThread=ne;var Je=i=>{for(;0<i.length;)i.shift()(a)};a.establishStackSpace=()=>{var i=Gr(),c=s()[i+52>>>2>>>0];i=s()[i+56>>>2>>>0],Eo(c,c-i),Hr(c)};function lr(i){if(x)return Be(1,0,i);qt(i)}a.invokeEntryPoint=(i,c)=>{i=Oo.apply(null,[i,c]),0<it?ne.sb(i):xn(i)};function jt(i){this.lb=i-24,this.yb=function(c){s()[this.lb+4>>>2>>>0]=c},this.wb=function(c){s()[this.lb+8>>>2>>>0]=c},this.mb=function(c,f){this.vb(),this.yb(c),this.wb(f)},this.vb=function(){s()[this.lb+16>>>2>>>0]=0}}var cr=0,Br=0;function kr(i,c,f,$){return x?Be(2,1,i,c,f,$):Yt(i,c,f,$)}function Yt(i,c,f,$){if(i>>>=0,c>>>=0,f>>>=0,$>>>=0,typeof SharedArrayBuffer>"u")return Z("Current environment does not support SharedArrayBuffer, pthreads are not available!"),6;var T=[];return x&&T.length===0?kr(i,c,f,$):(i={Lb:f,bb:i,xb:$,Rb:T},x?(i.Tb="spawnThread",postMessage(i,T),0):ir(i))}function Rr(i,c,f){return x?Be(3,1,i,c,f):0}function Dr(i,c){if(x)return Be(4,1,i,c)}var pr=i=>{for(var c=0,f=0;f<i.length;++f){var $=i.charCodeAt(f);127>=$?c++:2047>=$?c+=2:55296<=$&&57343>=$?(c+=4,++f):c+=3}return c},Mr=(i,c,f,$)=>{if(f>>>=0,!(0<$))return 0;var T=f;$=f+$-1;for(var R=0;R<i.length;++R){var z=i.charCodeAt(R);if(55296<=z&&57343>=z){var Q=i.charCodeAt(++R);z=65536+((z&1023)<<10)|Q&1023}if(127>=z){if(f>=$)break;c[f++>>>0]=z}else{if(2047>=z){if(f+1>=$)break;c[f++>>>0]=192|z>>6}else{if(65535>=z){if(f+2>=$)break;c[f++>>>0]=224|z>>12}else{if(f+3>=$)break;c[f++>>>0]=240|z>>18,c[f++>>>0]=128|z>>12&63}c[f++>>>0]=128|z>>6&63}c[f++>>>0]=128|z&63}}return c[f>>>0]=0,f-T},Ur=(i,c,f)=>Mr(i,o(),c,f);function xt(i,c){if(x)return Be(5,1,i,c)}function rt(i,c,f){if(x)return Be(6,1,i,c,f)}function _t(i,c,f){return x?Be(7,1,i,c,f):0}function mr(i,c){if(x)return Be(8,1,i,c)}function fr(i,c,f){if(x)return Be(9,1,i,c,f)}function zr(i,c,f,$){if(x)return Be(10,1,i,c,f,$)}function oe(i,c,f,$){if(x)return Be(11,1,i,c,f,$)}function hr(i,c,f,$){if(x)return Be(12,1,i,c,f,$)}function Zt(i){if(x)return Be(13,1,i)}function gr(i,c){if(x)return Be(14,1,i,c)}function yr(i,c,f){if(x)return Be(15,1,i,c,f)}var br=()=>{if(!(0<it))try{x?xn(re):qt(re)}catch(i){dr(i)}};function Qt(i){i>>>=0,typeof Atomics.Sb=="function"&&(Atomics.Sb(n(),i>>>2,i).value.then(Dt),i+=128,Atomics.store(n(),i>>>2,1))}a.__emscripten_thread_mailbox_await=Qt;var Dt=()=>{var i=Gr();if(i&&(Qt(i),!De))try{Ao(),br()}catch(c){dr(c)}};a.checkMailbox=Dt;var Jt=[],Ct=i=>i%4===0&&(i%100!==0||i%400===0),wr=[0,31,60,91,121,152,182,213,244,274,305,335],vr=[0,31,59,90,120,151,181,212,243,273,304,334];function Vr(i,c,f,$,T,R,z,Q){return x?Be(16,1,i,c,f,$,T,R,z,Q):-52}function Mt(i,c,f,$,T,R,z){if(x)return Be(17,1,i,c,f,$,T,R,z)}var $r=i=>{var c=pr(i)+1,f=$n(c);return f&&Ur(i,f,c),f},d=[],m=(i,c)=>{d.length=0;for(var f;f=o()[i++>>>0];){var $=f!=105;$&=f!=112,c+=$&&c%8?4:0,d.push(f==112?s()[c>>>2>>>0]:f==105?n()[c>>>2>>>0]:l()[c>>>3>>>0]),c+=$?8:4}return d},b={},S=()=>{if(!P){var i={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:(typeof navigator=="object"&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",_:w||"./this.program"},c;for(c in b)b[c]===void 0?delete i[c]:i[c]=b[c];var f=[];for(c in i)f.push(`${c}=${i[c]}`);P=f}return P},P;function N(i,c){if(x)return Be(18,1,i,c);i>>>=0,c>>>=0;var f=0;return S().forEach(($,T)=>{var R=c+f;for(T=s()[i+4*T>>>2>>>0]=R,R=0;R<$.length;++R)r()[T++>>>0>>>0]=$.charCodeAt(R);r()[T>>>0>>>0]=0,f+=$.length+1}),0}function L(i,c){if(x)return Be(19,1,i,c);i>>>=0,c>>>=0;var f=S();s()[i>>>2>>>0]=f.length;var $=0;return f.forEach(T=>$+=T.length+1),s()[c>>>2>>>0]=$,0}function X(i){return x?Be(20,1,i):52}function pe(i,c,f,$){return x?Be(21,1,i,c,f,$):52}function me(i,c,f,$,T){return x?Be(22,1,i,c,f,$,T):70}var fe=[null,[],[]];function ue(i,c,f,$){if(x)return Be(23,1,i,c,f,$);c>>>=0,f>>>=0,$>>>=0;for(var T=0,R=0;R<f;R++){var z=s()[c>>>2>>>0],Q=s()[c+4>>>2>>>0];c+=8;for(var be=0;be<Q;be++){var ce=o()[z+be>>>0],ye=fe[i];ce===0||ce===10?((i===1?Y:Z)(Kt(ye,0)),ye.length=0):ye.push(ce)}T+=Q}return s()[$>>>2>>>0]=T,0}var we=()=>{if(typeof crypto=="object"&&typeof crypto.getRandomValues=="function")return f=>(f.set(crypto.getRandomValues(new Uint8Array(f.byteLength))),f);if(I)try{var i=(Bn(),Ot(Pn));if(i.randomFillSync)return f=>i.randomFillSync(f);var c=i.randomBytes;return f=>(f.set(c(f.byteLength)),f)}catch{}je("initRandomDevice")},B=i=>(B=we())(i),ae=[31,29,31,30,31,30,31,31,30,31,30,31],ge=[31,28,31,30,31,30,31,31,30,31,30,31];function Ze(i){var c=Array(pr(i)+1);return Mr(i,c,0,c.length),c}var It=(i,c)=>{r().set(i,c>>>0)};function yo(i,c,f,$){function T(k,se,ve){for(k=typeof k=="number"?k.toString():k||"";k.length<se;)k=ve[0]+k;return k}function R(k,se){return T(k,se,"0")}function z(k,se){function ve(Ut){return 0>Ut?-1:0<Ut?1:0}var Xe;return(Xe=ve(k.getFullYear()-se.getFullYear()))===0&&(Xe=ve(k.getMonth()-se.getMonth()))===0&&(Xe=ve(k.getDate()-se.getDate())),Xe}function Q(k){switch(k.getDay()){case 0:return new Date(k.getFullYear()-1,11,29);case 1:return k;case 2:return new Date(k.getFullYear(),0,3);case 3:return new Date(k.getFullYear(),0,2);case 4:return new Date(k.getFullYear(),0,1);case 5:return new Date(k.getFullYear()-1,11,31);case 6:return new Date(k.getFullYear()-1,11,30)}}function be(k){var se=k.fb;for(k=new Date(new Date(k.gb+1900,0,1).getTime());0<se;){var ve=k.getMonth(),Xe=(Ct(k.getFullYear())?ae:ge)[ve];if(se>Xe-k.getDate())se-=Xe-k.getDate()+1,k.setDate(1),11>ve?k.setMonth(ve+1):(k.setMonth(0),k.setFullYear(k.getFullYear()+1));else{k.setDate(k.getDate()+se);break}}return ve=new Date(k.getFullYear()+1,0,4),se=Q(new Date(k.getFullYear(),0,4)),ve=Q(ve),0>=z(se,k)?0>=z(ve,k)?k.getFullYear()+1:k.getFullYear():k.getFullYear()-1}i>>>=0,c>>>=0,f>>>=0,$>>>=0;var ce=s()[$+40>>>2>>>0];$={Pb:n()[$>>>2>>>0],Ob:n()[$+4>>>2>>>0],jb:n()[$+8>>>2>>>0],ob:n()[$+12>>>2>>>0],kb:n()[$+16>>>2>>>0],gb:n()[$+20>>>2>>>0],ab:n()[$+24>>>2>>>0],fb:n()[$+28>>>2>>>0],Wb:n()[$+32>>>2>>>0],Nb:n()[$+36>>>2>>>0],Qb:ce?Ye(ce):""},f=Ye(f),ce={"%c":"%a %b %d %H:%M:%S %Y","%D":"%m/%d/%y","%F":"%Y-%m-%d","%h":"%b","%r":"%I:%M:%S %p","%R":"%H:%M","%T":"%H:%M:%S","%x":"%m/%d/%y","%X":"%H:%M:%S","%Ec":"%c","%EC":"%C","%Ex":"%m/%d/%y","%EX":"%H:%M:%S","%Ey":"%y","%EY":"%Y","%Od":"%d","%Oe":"%e","%OH":"%H","%OI":"%I","%Om":"%m","%OM":"%M","%OS":"%S","%Ou":"%u","%OU":"%U","%OV":"%V","%Ow":"%w","%OW":"%W","%Oy":"%y"};for(var ye in ce)f=f.replace(new RegExp(ye,"g"),ce[ye]);var le="Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),_e="January February March April May June July August September October November December".split(" ");ce={"%a":k=>le[k.ab].substring(0,3),"%A":k=>le[k.ab],"%b":k=>_e[k.kb].substring(0,3),"%B":k=>_e[k.kb],"%C":k=>R((k.gb+1900)/100|0,2),"%d":k=>R(k.ob,2),"%e":k=>T(k.ob,2," "),"%g":k=>be(k).toString().substring(2),"%G":k=>be(k),"%H":k=>R(k.jb,2),"%I":k=>(k=k.jb,k==0?k=12:12<k&&(k-=12),R(k,2)),"%j":k=>{for(var se=0,ve=0;ve<=k.kb-1;se+=(Ct(k.gb+1900)?ae:ge)[ve++]);return R(k.ob+se,3)},"%m":k=>R(k.kb+1,2),"%M":k=>R(k.Ob,2),"%n":()=>`\n`,"%p":k=>0<=k.jb&&12>k.jb?"AM":"PM","%S":k=>R(k.Pb,2),"%t":()=>"\t","%u":k=>k.ab||7,"%U":k=>R(Math.floor((k.fb+7-k.ab)/7),2),"%V":k=>{var se=Math.floor((k.fb+7-(k.ab+6)%7)/7);if(2>=(k.ab+371-k.fb-2)%7&&se++,se)se==53&&(ve=(k.ab+371-k.fb)%7,ve==4||ve==3&&Ct(k.gb)||(se=1));else{se=52;var ve=(k.ab+7-k.fb-1)%7;(ve==4||ve==5&&Ct(k.gb%400-1))&&se++}return R(se,2)},"%w":k=>k.ab,"%W":k=>R(Math.floor((k.fb+7-(k.ab+6)%7)/7),2),"%y":k=>(k.gb+1900).toString().substring(2),"%Y":k=>k.gb+1900,"%z":k=>{k=k.Nb;var se=0<=k;return k=Math.abs(k)/60,(se?"+":"-")+("0000"+(k/60*100+k%60)).slice(-4)},"%Z":k=>k.Qb,"%%":()=>"%"},f=f.replace(/%%/g,"\\0\\0");for(ye in ce)f.includes(ye)&&(f=f.replace(new RegExp(ye,"g"),ce[ye]($)));return f=f.replace(/\\0\\0/g,"%"),ye=Ze(f),ye.length>c?0:(It(ye,i),ye.length-1)}var Nr=i=>{try{i()}catch(c){je(c)}};function Fu(){var i=j,c={};for(let[f,$]of Object.entries(i))c[f]=typeof $=="function"?function(){Wr.push(f);try{return $.apply(null,arguments)}finally{De||(Wr.pop(),pt&&Et===1&&Wr.length===0&&(Et=0,it+=1,Nr(Bo),typeof Fibers<"u"&&Fibers.Xb()))}}:$;return c}var Et=0,pt=null,bo=0,Wr=[],wo={},vo={},Ku=0,vn=null,qu=[];function ju(){return new Promise((i,c)=>{vn={resolve:i,reject:c}})}function Yu(){var i=$n(65548),c=i+12;s()[i>>>2>>>0]=c,s()[i+4>>>2>>>0]=c+65536,c=Wr[0];var f=wo[c];return f===void 0&&(f=Ku++,wo[c]=f,vo[f]=c),c=f,n()[i+8>>>2>>>0]=c,i}function Zu(){var i=n()[pt+8>>>2>>>0];return i=j[vo[i]],--it,i()}function Qu(i){if(!De){if(Et===0){var c=!1,f=!1;i(($=0)=>{if(!De&&(bo=$,c=!0,f)){Et=2,Nr(()=>ko(pt)),typeof Browser<"u"&&Browser.nb.Ab&&Browser.nb.resume(),$=!1;try{var T=Zu()}catch(Q){T=Q,$=!0}var R=!1;if(!pt){var z=vn;z&&(vn=null,($?z.reject:z.resolve)(T),R=!0)}if($&&!R)throw T}}),f=!0,c||(Et=1,pt=Yu(),typeof Browser<"u"&&Browser.nb.Ab&&Browser.nb.pause(),Nr(()=>Po(pt)))}else Et===2?(Et=0,Nr(Ro),_o(pt),pt=null,qu.forEach($=>{if(!De)try{$(),br()}catch(T){dr(T)}})):je(`invalid state: ${Et}`);return bo}}function Ju(i){return Qu(c=>{i().then(c)})}var Xt=[],st,er,$o=[],So=(i,c)=>{if(!er){er=new WeakMap;var f=st.length;if(er)for(var $=0;$<0+f;$++){var T=$,R=Xt[T];R||(T>=Xt.length&&(Xt.length=T+1),Xt[T]=R=st.get(T)),(T=R)&&er.set(T,$)}}if(f=er.get(i)||0)return f;if($o.length)f=$o.pop();else{try{st.grow(1)}catch(Q){throw Q instanceof RangeError?"Unable to grow wasm table. Set ALLOW_TABLE_GROWTH.":Q}f=st.length-1}try{$=f,st.set($,i),Xt[$]=st.get($)}catch(Q){if(!(Q instanceof TypeError))throw Q;if(typeof WebAssembly.Function=="function"){$=WebAssembly.Function,T={i:"i32",j:"i64",f:"f32",d:"f64",e:"externref",p:"i32"},R={parameters:[],results:c[0]=="v"?[]:[T[c[0]]]};for(var z=1;z<c.length;++z)R.parameters.push(T[c[z]]);c=new $(R,i)}else{for($=[1],T=c.slice(0,1),c=c.slice(1),R={i:127,p:127,j:126,f:125,d:124,e:111},$.push(96),z=c.length,128>z?$.push(z):$.push(z%128|128,z>>7),z=0;z<c.length;++z)$.push(R[c[z]]);T=="v"?$.push(0):$.push(1,R[T]),c=[0,97,115,109,1,0,0,0,1],T=$.length,128>T?c.push(T):c.push(T%128|128,T>>7),c.push.apply(c,$),c.push(2,7,1,1,101,1,102,0,0,7,5,1,1,102,0,0),c=new WebAssembly.Module(new Uint8Array(c)),c=new WebAssembly.Instance(c,{e:{f:i}}).exports.f}$=f,st.set($,c),Xt[$]=st.get($)}return er.set(i,f),f};ne.mb();var Xu=[ur,lr,kr,Rr,Dr,xt,rt,_t,mr,fr,zr,oe,hr,Zt,gr,yr,Vr,Mt,N,L,X,pe,me,ue],ed={r:function(i,c,f){return Ju(async()=>{await a.Eb(i,c,f)})},b:function(i,c,f){throw i>>>=0,new jt(i).mb(c>>>0,f>>>0),cr=i,Br++,cr},P:function(i){Co(i>>>0,!_,1,!y,131072,!1),ne.tb()},n:function(i){i>>>=0,x?postMessage({cmd:"cleanupThread",thread:i}):ne.rb(ne.$a[i])},L:Yt,i:Rr,V:Dr,H:xt,J:rt,z:_t,T:mr,N:fr,S:zr,p:oe,I:hr,F:Zt,U:gr,G:yr,Y:()=>1,D:function(i,c){i>>>=0,i==c>>>0?setTimeout(()=>Dt()):x?postMessage({targetThread:i,cmd:"checkMailbox"}):(i=ne.$a[i])&&i.postMessage({cmd:"checkMailbox"})},M:function(i,c,f,$){c>>>=0,Jt.length=f,$=$>>>0>>>3;for(var T=0;T<f;T++)Jt[T]=l()[$+T>>>0];return i=0>i?Lt[-i-1]:Xu[i],ne.zb=c,c=i.apply(null,Jt),ne.zb=0,c},O:Qt,X:function(i){I&&ne.$a[i>>>0].ref()},u:function(i,c,f){i=c+2097152>>>0<4194305-!!i?(i>>>0)+4294967296*c:NaN,f>>>=0,i=new Date(1e3*i),n()[f>>>2>>>0]=i.getUTCSeconds(),n()[f+4>>>2>>>0]=i.getUTCMinutes(),n()[f+8>>>2>>>0]=i.getUTCHours(),n()[f+12>>>2>>>0]=i.getUTCDate(),n()[f+16>>>2>>>0]=i.getUTCMonth(),n()[f+20>>>2>>>0]=i.getUTCFullYear()-1900,n()[f+24>>>2>>>0]=i.getUTCDay(),i=(i.getTime()-Date.UTC(i.getUTCFullYear(),0,1,0,0,0,0))/864e5|0,n()[f+28>>>2>>>0]=i},v:function(i,c,f){i=c+2097152>>>0<4194305-!!i?(i>>>0)+4294967296*c:NaN,f>>>=0,i=new Date(1e3*i),n()[f>>>2>>>0]=i.getSeconds(),n()[f+4>>>2>>>0]=i.getMinutes(),n()[f+8>>>2>>>0]=i.getHours(),n()[f+12>>>2>>>0]=i.getDate(),n()[f+16>>>2>>>0]=i.getMonth(),n()[f+20>>>2>>>0]=i.getFullYear()-1900,n()[f+24>>>2>>>0]=i.getDay(),c=(Ct(i.getFullYear())?wr:vr)[i.getMonth()]+i.getDate()-1|0,n()[f+28>>>2>>>0]=c,n()[f+36>>>2>>>0]=-(60*i.getTimezoneOffset()),c=new Date(i.getFullYear(),6,1).getTimezoneOffset();var $=new Date(i.getFullYear(),0,1).getTimezoneOffset();i=(c!=$&&i.getTimezoneOffset()==Math.min($,c))|0,n()[f+32>>>2>>>0]=i},w:function(i){i>>>=0;var c=new Date(n()[i+20>>>2>>>0]+1900,n()[i+16>>>2>>>0],n()[i+12>>>2>>>0],n()[i+8>>>2>>>0],n()[i+4>>>2>>>0],n()[i>>>2>>>0],0),f=n()[i+32>>>2>>>0],$=c.getTimezoneOffset(),T=new Date(c.getFullYear(),6,1).getTimezoneOffset(),R=new Date(c.getFullYear(),0,1).getTimezoneOffset(),z=Math.min(R,T);return 0>f?n()[i+32>>>2>>>0]=+(T!=R&&z==$):0<f!=(z==$)&&(T=Math.max(R,T),c.setTime(c.getTime()+6e4*((0<f?z:T)-$))),n()[i+24>>>2>>>0]=c.getDay(),f=(Ct(c.getFullYear())?wr:vr)[c.getMonth()]+c.getDate()-1|0,n()[i+28>>>2>>>0]=f,n()[i>>>2>>>0]=c.getSeconds(),n()[i+4>>>2>>>0]=c.getMinutes(),n()[i+8>>>2>>>0]=c.getHours(),n()[i+12>>>2>>>0]=c.getDate(),n()[i+16>>>2>>>0]=c.getMonth(),n()[i+20>>>2>>>0]=c.getYear(),i=c.getTime(),isNaN(i)?(n()[xo()>>>2>>>0]=61,i=-1):i/=1e3,To((St=i,1<=+Math.abs(St)?0<St?+Math.floor(St/4294967296)>>>0:~~+Math.ceil((St-+(~~St>>>0))/4294967296)>>>0:0)),i>>>0},s:Vr,t:Mt,C:function(i,c,f){function $(ce){return(ce=ce.toTimeString().match(/\\(([A-Za-z ]+)\\)$/))?ce[1]:"GMT"}i>>>=0,c>>>=0,f>>>=0;var T=new Date().getFullYear(),R=new Date(T,0,1),z=new Date(T,6,1);T=R.getTimezoneOffset();var Q=z.getTimezoneOffset(),be=Math.max(T,Q);s()[i>>>2>>>0]=60*be,n()[c>>>2>>>0]=+(T!=Q),i=$(R),c=$(z),i=$r(i),c=$r(c),Q<T?(s()[f>>>2>>>0]=i,s()[f+4>>>2>>>0]=c):(s()[f>>>2>>>0]=c,s()[f+4>>>2>>>0]=i)},d:()=>{je("")},c:function(i,c,f){return i>>>=0,c=m(c>>>0,f>>>0),Lt[i].apply(null,c)},k:function(i,c,f){return i>>>=0,c=m(c>>>0,f>>>0),Lt[i].apply(null,c)},o:()=>{},q:()=>Date.now(),W:()=>{throw it+=1,"unwind"},E:function(){return 4294901760},f:()=>performance.timeOrigin+performance.now(),g:()=>I?(Ho(),Ot(Go)).cpus().length:navigator.hardwareConcurrency,A:function(i){i>>>=0;var c=o().length;if(i<=c||4294901760<i)return!1;for(var f=1;4>=f;f*=2){var $=c*(1+.2/f);$=Math.min($,i+100663296);var T=Math;$=Math.max(i,$);e:{T=(T.min.call(T,4294901760,$+(65536-$%65536)%65536)-ee.buffer.byteLength+65535)/65536;try{ee.grow(T),Fe();var R=1;break e}catch{}R=void 0}if(R)return!0}return!1},Q:N,R:L,K:qt,h:X,m:pe,x:me,l:ue,y:function(i,c){return i>>>=0,c>>>=0,B(o().subarray(i>>>0,i+c>>>0)),0},a:ee||a.wasmMemory,B:yo,e:function(i,c,f,$){return yo(i>>>0,c>>>0,f>>>0,$>>>0)},j:function(i,c,f,$){let T=st.length;i=new Uint8Array(o().slice(i+c,i+f));try{var R=new WebAssembly.Module(i),z=new WebAssembly.Instance(R,{env:{memory:ee}}),Q;for(Q in z.exports)So(z.exports[Q]);return T<st.length?T:$}catch(be){return console.log(be),$}}},j=function(){function i(f,$){return j=f.exports,j=Fu(),j=td(),ne.ub.push(j.Ha),st=j.Ia,Ce.unshift(j.Z),Te=$,Ne(),j}var c={a:ed};if(Me++,a.instantiateWasm)try{return a.instantiateWasm(c,i)}catch(f){Z(`Module.instantiateWasm callback failed with error: ${f}`),h(f)}return Tt(c,function(f){i(f.instance,f.module)}).catch(h),{}}();a._OrtInit=(i,c)=>(a._OrtInit=j._)(i,c),a._OrtGetLastError=(i,c)=>(a._OrtGetLastError=j.$)(i,c),a._OrtCreateSessionOptions=(i,c,f,$,T,R,z,Q,be,ce)=>(a._OrtCreateSessionOptions=j.aa)(i,c,f,$,T,R,z,Q,be,ce),a._OrtAppendExecutionProvider=(i,c)=>(a._OrtAppendExecutionProvider=j.ba)(i,c),a._OrtAddFreeDimensionOverride=(i,c,f)=>(a._OrtAddFreeDimensionOverride=j.ca)(i,c,f),a._OrtAddSessionConfigEntry=(i,c,f)=>(a._OrtAddSessionConfigEntry=j.da)(i,c,f),a._OrtReleaseSessionOptions=i=>(a._OrtReleaseSessionOptions=j.ea)(i),a._OrtCreateSession=(i,c,f)=>(a._OrtCreateSession=j.fa)(i,c,f),a._OrtReleaseSession=i=>(a._OrtReleaseSession=j.ga)(i),a._OrtGetInputOutputCount=(i,c,f)=>(a._OrtGetInputOutputCount=j.ha)(i,c,f),a._OrtGetInputName=(i,c)=>(a._OrtGetInputName=j.ia)(i,c),a._OrtGetOutputName=(i,c)=>(a._OrtGetOutputName=j.ja)(i,c),a._OrtFree=i=>(a._OrtFree=j.ka)(i),a._OrtCreateTensor=(i,c,f,$,T,R)=>(a._OrtCreateTensor=j.la)(i,c,f,$,T,R),a._OrtGetTensorData=(i,c,f,$,T)=>(a._OrtGetTensorData=j.ma)(i,c,f,$,T),a._OrtReleaseTensor=i=>(a._OrtReleaseTensor=j.na)(i),a._OrtCreateRunOptions=(i,c,f,$)=>(a._OrtCreateRunOptions=j.oa)(i,c,f,$),a._OrtAddRunConfigEntry=(i,c,f)=>(a._OrtAddRunConfigEntry=j.pa)(i,c,f),a._OrtReleaseRunOptions=i=>(a._OrtReleaseRunOptions=j.qa)(i),a._OrtCreateBinding=i=>(a._OrtCreateBinding=j.ra)(i),a._OrtBindInput=(i,c,f)=>(a._OrtBindInput=j.sa)(i,c,f),a._OrtBindOutput=(i,c,f,$)=>(a._OrtBindOutput=j.ta)(i,c,f,$),a._OrtClearBoundOutputs=i=>(a._OrtClearBoundOutputs=j.ua)(i),a._OrtReleaseBinding=i=>(a._OrtReleaseBinding=j.va)(i),a._OrtRunWithBinding=(i,c,f,$,T)=>(a._OrtRunWithBinding=j.wa)(i,c,f,$,T),a._OrtRun=(i,c,f,$,T,R,z,Q)=>(a._OrtRun=j.xa)(i,c,f,$,T,R,z,Q),a._OrtEndProfiling=i=>(a._OrtEndProfiling=j.ya)(i),a._OrtConfigure=(i,c)=>(a._OrtConfigure=j.za)(i,c),a._OrtAuth=(i,c)=>(a._OrtAuth=j.Aa)(i,c),a._JsepOutput=(i,c,f)=>(a._JsepOutput=j.Ba)(i,c,f),a._JsepGetNodeName=i=>(a._JsepGetNodeName=j.Ca)(i);var xo=()=>(xo=j.Da)(),Gr=a._pthread_self=()=>(Gr=a._pthread_self=j.Ea)(),$n=a._malloc=i=>($n=a._malloc=j.Fa)(i),_o=a._free=i=>(_o=a._free=j.Ga)(i);a.__emscripten_tls_init=()=>(a.__emscripten_tls_init=j.Ha)();var Co=a.__emscripten_thread_init=(i,c,f,$,T,R)=>(Co=a.__emscripten_thread_init=j.Ja)(i,c,f,$,T,R);a.__emscripten_thread_crashed=()=>(a.__emscripten_thread_crashed=j.Ka)();var Io=(i,c,f,$)=>(Io=j.La)(i,c,f,$),Sn=i=>(Sn=j.Ma)(i),xn=a.__emscripten_thread_exit=i=>(xn=a.__emscripten_thread_exit=j.Na)(i),Ao=()=>(Ao=j.Oa)(),To=i=>(To=j.Pa)(i),Eo=(i,c)=>(Eo=j.Qa)(i,c),_n=()=>(_n=j.Ra)(),Hr=i=>(Hr=j.Sa)(i),Cn=i=>(Cn=j.Ta)(i),Oo=a.dynCall_ii=(i,c)=>(Oo=a.dynCall_ii=j.Va)(i,c),Po=i=>(Po=j.Wa)(i),Bo=()=>(Bo=j.Xa)(),ko=i=>(ko=j.Ya)(i),Ro=()=>(Ro=j.Za)();a.___start_em_js=914981,a.___stop_em_js=915754;function td(){var i=j;i=Object.assign({},i);var c=$=>()=>$()>>>0,f=$=>T=>$(T)>>>0;return i.Da=c(i.Da),i.Ea=c(i.Ea),i.Fa=f(i.Fa),i.emscripten_main_runtime_thread_id=c(i.emscripten_main_runtime_thread_id),i.Ra=c(i.Ra),i.Ta=f(i.Ta),i}a.wasmMemory=ee,a.stackAlloc=Cn,a.stackSave=_n,a.stackRestore=Hr,a.keepRuntimeAlive=()=>0<it,a.addFunction=So,a.UTF8ToString=Ye,a.stringToUTF8=Ur,a.lengthBytesUTF8=pr,a.ExitStatus=Ft,a.PThread=ne;var Lr;at=function i(){Lr||Do(),Lr||(at=i)};function Do(){if(!(0<Me))if(x)p(a),x||Je(Ce),startWorker(a);else{if(a.preRun)for(typeof a.preRun=="function"&&(a.preRun=[a.preRun]);a.preRun.length;)J.unshift(a.preRun.shift());Je(J),0<Me||Lr||(Lr=!0,a.calledRun=!0,De||(x||Je(Ce),p(a),x||Je($t)))}}return Do(),t.ready}})();typeof Fo=="object"&&typeof Rn=="object"?Rn.exports=Lo:typeof define=="function"&&define.amd&&define([],()=>Lo)});var qo=Sr((up,cd)=>{cd.exports=\'"use strict";var Module={},ENVIRONMENT_IS_NODE=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string";if(ENVIRONMENT_IS_NODE){var nodeWorkerThreads=require("worker_threads"),parentPort=nodeWorkerThreads.parentPort;parentPort.on("message",e=>onmessage({data:e}));var fs=require("fs"),vm=require("vm");Object.assign(global,{self:global,require,Module,location:{href:__filename},Worker:nodeWorkerThreads.Worker,importScripts:e=>vm.runInThisContext(fs.readFileSync(e,"utf8"),{filename:e}),postMessage:e=>parentPort.postMessage(e),performance:global.performance||{now:Date.now}})}var initializedJS=!1;function threadPrintErr(){var e=Array.prototype.slice.call(arguments).join(" ");if(ENVIRONMENT_IS_NODE){fs.writeSync(2,e+`\\n`);return}console.error(e)}function threadAlert(){var e=Array.prototype.slice.call(arguments).join(" ");postMessage({cmd:"alert",text:e,threadId:Module._pthread_self()})}var err=threadPrintErr;self.alert=threadAlert,Module.instantiateWasm=(e,t)=>{var a=Module.wasmModule;Module.wasmModule=null;var r=new WebAssembly.Instance(a,e);return t(r)},self.onunhandledrejection=e=>{throw e.reason||e};function handleMessage(e){try{if(e.data.cmd==="load"){let a=[];self.onmessage=r=>a.push(r),self.startWorker=r=>{Module=r,postMessage({cmd:"loaded"});for(let s of a)handleMessage(s);self.onmessage=handleMessage},Module.wasmModule=e.data.wasmModule;for(const r of e.data.handlers)Module[r]=(...s)=>{postMessage({cmd:"callHandler",handler:r,args:s})};if(Module.wasmMemory=e.data.wasmMemory,Module.buffer=Module.wasmMemory.buffer,Module.ENVIRONMENT_IS_PTHREAD=!0,typeof e.data.urlOrBlob=="string")importScripts(e.data.urlOrBlob);else{var t=URL.createObjectURL(e.data.urlOrBlob);importScripts(t),URL.revokeObjectURL(t)}ortWasmThreaded(Module)}else if(e.data.cmd==="run"){Module.__emscripten_thread_init(e.data.pthread_ptr,0,0,1),Module.__emscripten_thread_mailbox_await(e.data.pthread_ptr),Module.establishStackSpace(),Module.PThread.receiveObjectTransfer(e.data),Module.PThread.threadInitTLS(),initializedJS||(initializedJS=!0);try{Module.invokeEntryPoint(e.data.start_routine,e.data.arg)}catch(a){if(a!="unwind")throw a}}else e.data.cmd==="cancel"?Module._pthread_self()&&Module.__emscripten_thread_exit(-1):e.data.target==="setimmediate"||(e.data.cmd==="checkMailbox"?initializedJS&&Module.checkMailbox():e.data.cmd&&(err(`worker.js received unknown command ${e.data.cmd}`),err(e.data)))}catch(a){throw Module.__emscripten_thread_crashed?.(),a}}self.onmessage=handleMessage;\\n\'});var Un,nt,Cr,Kr,Ir,Xo,zn,We=q(()=>{"use strict";Un=e=>{switch(e){case"int8":return 3;case"uint8":return 2;case"bool":return 9;case"int16":return 5;case"uint16":return 4;case"int32":return 6;case"uint32":return 12;case"float16":return 10;case"float32":return 1;case"float64":return 11;case"string":return 8;case"int64":return 7;case"uint64":return 13;default:throw new Error(`unsupported data type: ${e}`)}},nt=e=>{switch(e){case 3:return"int8";case 2:return"uint8";case 9:return"bool";case 5:return"int16";case 4:return"uint16";case 6:return"int32";case 12:return"uint32";case 10:return"float16";case 1:return"float32";case 11:return"float64";case 8:return"string";case 7:return"int64";case 13:return"uint64";default:throw new Error(`unsupported data type: ${e}`)}},Cr=e=>[void 0,4,1,1,2,2,4,8,void 0,1,2,8,4,8,void 0,void 0,void 0][e],Kr=e=>{switch(e){case"float16":return Uint16Array;case"float32":return Float32Array;case"uint8":return Uint8Array;case"int8":return Int8Array;case"uint16":return Uint16Array;case"int16":return Int16Array;case"int32":return Int32Array;case"bool":return Uint8Array;case"float64":return Float64Array;case"uint32":return Uint32Array;case"int64":return BigInt64Array;case"uint64":return BigUint64Array;default:throw new Error(`unsupported type: ${e}`)}},Ir=e=>{switch(e){case"verbose":return 0;case"info":return 1;case"warning":return 2;case"error":return 3;case"fatal":return 4;default:throw new Error(`unsupported logging level: ${e}`)}},Xo=e=>e==="float32"||e==="int32"||e==="int64"||e==="bool"||e==="float16"||e==="uint32",zn=e=>{switch(e){case"none":return 0;case"cpu":return 1;case"cpu-pinned":return 2;case"texture":return 3;case"gpu-buffer":return 4;default:throw new Error(`unsupported data location: ${e}`)}}});var qr=q(()=>{"use strict"});var ta=q(()=>{"use strict";qr()});var ra,na=q(()=>{"use strict";ra="1.17.0"});var oa,zt,Vn=q(()=>{"use strict";na();oa="warning",zt={wasm:{},webgl:{},webgpu:{},versions:{common:ra},set logLevel(e){if(e!==void 0){if(typeof e!="string"||["verbose","info","warning","error","fatal"].indexOf(e)===-1)throw new Error(`Unsupported logging level: ${e}`);oa=e}},get logLevel(){return oa}};Object.defineProperty(zt,"logLevel",{enumerable:!0})});var tr,aa=q(()=>{"use strict";Vn();tr=zt});var ia=q(()=>{"use strict"});var sa=q(()=>{"use strict";jr()});var da=q(()=>{"use strict"});var la=q(()=>{"use strict";jr()});var jr=q(()=>{"use strict";ia();sa();da();la()});var Yr=q(()=>{"use strict";jr()});var Nn,ca,Vt,Nt,Wn=q(()=>{"use strict";Vn();Nn=(e,t)=>{zt.wasm.trace&&console.timeStamp(`${e}::ORT::${t}`)},ca=(e,t)=>{let r=new Error().stack?.split(/\\r\\n|\\r|\\n/g)||[],o=!1;for(let n=0;n<r.length;n++){if(o&&!r[n].includes("TRACE_FUNC")){let s=`FUNC_${e}::${r[n].trim().split(" ")[1]}`;t&&(s+=`::${t}`),Nn("CPU",s);return}r[n].includes("TRACE_FUNC")&&(o=!0)}},Vt=e=>{zt.wasm.trace&&ca("BEGIN",e)},Nt=e=>{zt.wasm.trace&&ca("END",e)}});var pa=q(()=>{"use strict";qr();Yr();Wn()});var ma=q(()=>{"use strict";pa()});var fa=q(()=>{"use strict"});var ha=q(()=>{"use strict";qr();Yr()});var ga=q(()=>{"use strict";ha()});var rr=q(()=>{"use strict";ta();aa();ma();Yr();Wn();fa();ga()});var Sd,xd,ya,ba,wa,_d,Re,Pt=q(()=>{"use strict";We();Sd=["V","I","W","E","F"],xd=(e,t)=>{console.log(`[${Sd[e]},${new Date().toISOString()}]${t}`)},wa=(e,t)=>{ya=e,ba=t},_d=(e,t)=>{let r=Ir(e),o=Ir(ya);r>=o&&xd(r,typeof t=="function"?t():t)},Re=(...e)=>{ba&&_d(...e)}});var va,$a=q(()=>{"use strict";We();va=(e,t)=>new(Kr(t))(e)});var Zr=q(()=>{"use strict"});var Qr,Cd,Sa,Id,Gn,Ln,Hn,_a,Ca=q(()=>{"use strict";Pt();Zr();Qr=e=>Math.ceil(e/16)*16,Cd=1,Sa=()=>Cd++,Id=1,Gn=()=>Id++,Ln=async(e,t,r,o)=>{let n=Qr(r),s=e.device.createBuffer({size:n,usage:GPUBufferUsage.COPY_DST|GPUBufferUsage.MAP_READ});try{let u=e.getCommandEncoder();e.endComputePass(),u.copyBufferToBuffer(t,0,s,0,n),e.flush(),await s.mapAsync(GPUMapMode.READ);let l=s.getMappedRange();if(o){let a=o();return a.set(new Uint8Array(l,0,r)),a}else return new Uint8Array(l.slice(0,r))}finally{s.destroy()}},Hn=class{constructor(t){this.backend=t;this.storageCache=new Map,this.freeBuffers=new Map,this.freeUniformBuffers=new Map,this.buffersForUploadingPending=[],this.buffersPending=[],this.externalBuffers=new Map,this.capturedPendingBuffers=new Map}upload(t,r){let o=r.buffer,n=r.byteOffset,s=r.byteLength,u=Qr(s),l=this.storageCache.get(t);if(!l)throw new Error("gpu data for uploading does not exist");if(l.originalSize!==s)throw new Error(`inconsistent data size. gpu data size=${l.originalSize}, data size=${s}`);let a=this.backend.device.createBuffer({mappedAtCreation:!0,size:u,usage:GPUBufferUsage.MAP_WRITE|GPUBufferUsage.COPY_SRC}),p=a.getMappedRange();new Uint8Array(p).set(new Uint8Array(o,n,s)),a.unmap();let h=this.backend.getCommandEncoder();this.backend.endComputePass(),h.copyBufferToBuffer(a,0,l.gpuData.buffer,0,u),Re("verbose",()=>`[WebGPU] GpuDataManager.upload(id=${t})`),this.buffersForUploadingPending.push(a)}memcpy(t,r){let o=this.storageCache.get(t);if(!o)throw new Error("source gpu data for memcpy does not exist");let n=this.storageCache.get(r);if(!n)throw new Error("destination gpu data for memcpy does not exist");if(o.originalSize!==n.originalSize)throw new Error("inconsistent source and destination gpu data size");let s=Qr(o.originalSize),u=this.backend.getCommandEncoder();this.backend.endComputePass(),u.copyBufferToBuffer(o.gpuData.buffer,0,n.gpuData.buffer,0,s)}registerExternalBuffer(t,r,o){let n;if(o){if(n=this.externalBuffers.get(o),n===void 0)throw new Error("previous buffer is not registered");if(t===o)return Re("verbose",()=>`[WebGPU] GpuDataManager.registerExternalBuffer(size=${r}) => id=${n}, buffer is the same, skip.`),n;if(this.backend.capturedCommandList.has(this.backend.currentSessionId))throw new Error(`Registering a different external buffer under graph capture mode is not supported yet.\n             Please use the previous external buffer!`);this.externalBuffers.delete(o)}else n=Sa();return this.storageCache.set(n,{gpuData:{id:n,type:0,buffer:t,permamentID:Gn()},originalSize:r}),this.externalBuffers.set(t,n),Re("verbose",()=>`[WebGPU] GpuDataManager.registerExternalBuffer(size=${r}) => id=${n}, registered.`),n}unregisterExternalBuffer(t){let r=this.externalBuffers.get(t);r!==void 0&&(this.storageCache.delete(r),this.externalBuffers.delete(t),Re("verbose",()=>`[WebGPU] GpuDataManager.unregisterExternalBuffer() => id=${r}`))}create(t,r=GPUBufferUsage.STORAGE|GPUBufferUsage.COPY_SRC|GPUBufferUsage.COPY_DST){let o=Qr(t),n,s=(r&GPUBufferUsage.STORAGE)===GPUBufferUsage.STORAGE,u=(r&GPUBufferUsage.UNIFORM)===GPUBufferUsage.UNIFORM;if(s||u){let a=s?this.freeBuffers:this.freeUniformBuffers,p=a.get(o);p||(p=[],a.set(o,p)),p.length>0?n=p.pop():n={buffer:this.backend.device.createBuffer({size:o,usage:r}),permamentID:Gn()}}else n={buffer:this.backend.device.createBuffer({size:o,usage:r}),permamentID:Gn()};let l={id:Sa(),type:0,buffer:n.buffer,permamentID:n.permamentID};return this.storageCache.set(l.id,{gpuData:l,originalSize:t}),Re("verbose",()=>`[WebGPU] GpuDataManager.create(size=${t}) => id=${l.id}`),l}get(t){return this.storageCache.get(t)?.gpuData}release(t){let r=this.storageCache.get(t);if(!r)throw new Error("releasing data does not exist");return Re("verbose",()=>`[WebGPU] GpuDataManager.release(id=${t}), gpuDataId=${r.gpuData.id}`),this.storageCache.delete(t),this.buffersPending.push({buffer:r.gpuData.buffer,permamentID:r.gpuData.permamentID}),r.originalSize}async download(t,r){let o=this.storageCache.get(t);if(!o)throw new Error("data does not exist");await Ln(this.backend,o.gpuData.buffer,o.originalSize,r)}refreshPendingBuffers(){for(let t of this.buffersForUploadingPending)t.destroy();if(this.buffersForUploadingPending=[],this.buffersPending.length!==0)if(this.backend.sessionStatus==="default"){for(let t of this.buffersPending)(t.buffer.usage&GPUBufferUsage.STORAGE)===GPUBufferUsage.STORAGE?this.freeBuffers.get(t.buffer.size).push(t):(t.buffer.usage&GPUBufferUsage.UNIFORM)===GPUBufferUsage.UNIFORM?this.freeUniformBuffers.get(t.buffer.size).push(t):t.buffer.destroy();this.buffersPending=[]}else{let t=this.capturedPendingBuffers.get(this.backend.currentSessionId);t||(t=[],this.capturedPendingBuffers.set(this.backend.currentSessionId,t));for(let r of this.buffersPending)t.push(r);this.buffersPending=[]}}dispose(){this.freeBuffers.forEach(t=>{t.forEach(r=>{r.buffer.destroy()})}),this.freeUniformBuffers.forEach(t=>{t.forEach(r=>{r.buffer.destroy()})}),this.storageCache.forEach(t=>{t.gpuData.buffer.destroy()}),this.capturedPendingBuffers.forEach(t=>{t.forEach(r=>{r.buffer.destroy()})}),this.storageCache=new Map,this.freeBuffers=new Map,this.freeUniformBuffers=new Map,this.capturedPendingBuffers=new Map}onReleaseSession(t){let r=this.capturedPendingBuffers.get(t);r&&(r.forEach(o=>{o.buffer.destroy()}),this.capturedPendingBuffers.delete(t))}},_a=(...e)=>new Hn(...e)});var Fn,he,Le=q(()=>{"use strict";Fn=class{constructor(t){Object.assign(this,t)}get cacheKey(){return this.key||(this.key=Object.getOwnPropertyNames(this).sort().map(t=>`${this[t]}`).join(";")),this.key}},he=e=>new Fn(e)});var Kn,mt,V,Wt,Jr,Xr,en,xe=q(()=>{"use strict";Kn=class{static calcMatMulShape(t,r){return t[1]!==r[0]?void 0:[t[0],r[1]]}},mt=class{static calcShape(t,r,o=!1){let n=t.length,s=r.length;if(n===0)return r;if(s===0)return t;let u=Math.max(t.length,r.length),l=new Array(u);if(o){if(n<2||s<2)return;let a=Kn.calcMatMulShape([t[n-2],t[n-1]],[r[s-2],r[s-1]]);if(a===void 0)return;[l[u-2],l[u-1]]=a}for(let a=o?3:1;a<=u;a++){let p=n-a<0?1:t[n-a],h=s-a<0?1:r[s-a];if(p!==h&&p>1&&h>1)return;l[u-a]=Math.max(p,h)}return l}static isValidBroadcast(t,r){let o=t.length,n=r.length;if(o>n)return!1;for(let s=1;s<=o;s++)if(t[o-s]!==1&&t[o-s]!==r[n-s])return!1;return!0}},V=class e{static size(t){return e.getSizeFromDimensionRange(t,0,t.length)}static sizeFromDimension(t,r){if(r<0||r>t.length)throw new Error(`invalid dimension of ${r} for sizeFromDimension as Tensor has ${t.length} dimensions.`);return e.getSizeFromDimensionRange(t,r,t.length)}static sizeToDimension(t,r){if(r<0||r>t.length)throw new Error(`invalid dimension of ${r} for sizeToDimension as Tensor has ${t.length} dimensions.`);return e.getSizeFromDimensionRange(t,0,r)}static getSizeFromDimensionRange(t,r,o){let n=1;for(let s=r;s<o;s++){if(t[s]<0)throw new Error("cannot get valid size from specified dimension range. Most likely the range contains negative values in them.");n*=t[s]}return n}static computeStrides(t){let r=t.length;if(r===0)return[];if(r===1)return[1];let o=new Array(r);o[r-1]=1,o[r-2]=t[r-1];for(let n=r-3;n>=0;--n)o[n]=o[n+1]*t[n+1];return o}static normalizeAxis(t,r){if(t<-r&&t>=r)throw new Error("unsupported axis for this operation.");return t<0?t+r:t}static normalizeAxes(t,r){return t.map(o=>this.normalizeAxis(o,r??t.length))}static sortBasedOnPerm(t,r){return r?r.map(o=>t[o]):t.slice().reverse()}static padShape(t,r){let o=t.length;return t.map((n,s)=>n+r[s]+r[s+o])}static areEqual(t,r){return t.length!==r.length?!1:t.every((o,n)=>o===r[n])}},Wt=class e{static adjustPoolAttributes(t,r,o,n,s,u){if(!t&&o.length!==r.length-2)throw new Error("length of specified kernel shapes should be 2 less than length of input dimensions");if(t)for(let l=0;l<r.length-2;l++)l>=o.length?o.push(r[l+2]):o[l]=r[l+2];for(let l=0;l<o.length;l++)if(l<n.length){if(n[l]<0)throw new Error("strides should be greater than or equal to 1")}else n.push(1);for(let l=0;l<o.length;l++)if(l<s.length){if(s[l]<0)throw new Error("dilations should be greater than or equal to 1")}else s.push(1);for(let l=0;l<o.length*2;l++)if(l<u.length){if(u[l]<0)throw new Error("pad should be greater than or equal to 1")}else u.push(0);for(let l=0;l<o.length;l++){if(o[l]<=0)throw new Error("kernel shapes need to be greater than 0");if(u[l]>=o[l]||u[l+o.length]>=o[l])throw new Error("pads should be smaller than kernel")}}static adjustPadsBasedOnAutoPad(t,r,o,n,s,u,l){if(l){if(s.length!==2*(t.length-2))throw new Error("length of pads should be twice the length of data dimensions");if(r.length!==t.length-2)throw new Error("length of strides should be the length of data dimensions");if(n.length!==t.length-2)throw new Error("length of kernel shapes should be the length of data dimensions");for(let a=0;a<t.length-2;a++)e.adjustPadAndReturnShape(t[a+(u?1:2)],r[a],o[a],n[a],s,a,a+t.length-2,l)}}static computePoolOutputShape(t,r,o,n,s,u,l){if(r.length<=0)throw new Error("input shape must be of size greater than 0");let a=[r[0],r[1]];return e.computeShapeHelper(t,r,a,o,n,s,u,l),a}static computeConvOutputShape(t,r,o,n,s,u,l){if(t.length<=0||r.length<=0)throw new Error("invalid input tensor dims or invalid filter tensor dims");let a=[t[0],r[0]];return e.computeShapeHelper(!1,t,a,o,n,s,u,l),a}static computeShapeHelper(t,r,o,n,s,u,l,a){if(t)for(let p=0;p<r.length-2;p++)o.push(1);else for(let p=0;p<r.length-2;p++)o.push(e.adjustPadAndReturnShape(r[p+2],n[p],s[p],u[p],l,p,p+r.length-2,a))}static adjustPadAndReturnShape(t,r,o,n,s,u,l,a){let p=o*(n-1)+1;if(a&&a!=="NOTSET")switch(a){case"VALID":return s[u]=0,s[l]=0,Math.floor((t-p)/r+1);case"SAME_LOWER":case"SAME_UPPER":if(o!==1)throw new Error("Dilation not supported for SAME_UPPER or SAME_LOWER");{let g=((t+r-1)/r-1)*r+n-t;return s[u]=Math.floor(a==="SAME_LOWER"?(g+1)/2:g/2),s[l]=g-s[u],Math.floor((t+g-n)/r+1)}default:throw new Error("Unsupported AutoPad type")}else return Math.floor((t+s[u]+s[l]-p)/r+1)}},Jr=class{static getShapeOfGemmResult(t,r,o,n,s){if(t.length!==2||o.length!==2)throw new Error("shape need to be of size 2");let u,l,a;r?(u=t[1],l=t[0]):(u=t[0],l=t[1]);let p=-1;if(n?(a=o[0],p=1):(a=o[1],p=0),o[p]!==l)throw new Error("dimension mismatch");if(u<=0||a<=0||l<=0)throw new Error("invalid shape specified");if(s&&!mt.isValidBroadcast(s,[u,a]))throw new Error("gemm: invalid bias shape for broadcast");return[u,a,l]}},Xr=-34028234663852886e22,en=34028234663852886e22});var Ad,jn,Ge,ft,F,He,Qe,ut,ot,de,Yn,U,K,tn,qn,Ia,nr,Ue,$e=q(()=>{"use strict";We();xe();Ad=64,jn=(e,t)=>{if(t===3)throw new Error("vec3 has same alignment as vec4, use vec4 instead");switch(e){case 10:return t>1?`vec${t}<f16>`:"f16";case 1:return t>1?`vec${t}<f32>`:"f32";case 6:return t>1?`vec${t}<i32>`:"i32";case 12:return t>1?`vec${t}<u32>`:"u32";case 7:if(t>1)throw new Error("currently not supported vecX of uint64 yet");return["vec2<u32>","i32"];case 13:if(t>1)throw new Error("currently not supported vecX of uint64 yet");return["vec2<u32>","u32"];case 9:if(t!==4)throw new Error("bool must be vec4");return["u32","vec4<bool>"];default:throw new Error(`Unknown data type: ${e}`)}},Ge=(e,t=1)=>{let r=jn(e,t);return typeof r=="string"?r:r[0]},ft=(e,t=1)=>{let r=jn(e,t);return typeof r=="string"?r:r[1]},F=e=>e.length===0?[]:[{type:"uint32",data:e},{type:"uint32",data:V.computeStrides(e)}],He=e=>e%4===0?4:e%2===0?2:1,Qe=(e="f32",t,r="0")=>!t||t===1?`${e}(${r})`:`vec${t}<${e}>(${r})`,ut=(e,t,r)=>e==="f32"?r:t===1?`f32(${r})`:`vec${t}f(${r})`,ot=(e,t)=>t===4?`(${e}.x + ${e}.y + ${e}.z + ${e}.w)`:t===2?`(${e}.x + ${e}.y)`:t===3?`(${e}.x + ${e}.y + ${e}.z)`:e,de=(e,t,r)=>e.startsWith("uniforms.")&&r>4?typeof t=="string"?`${e}[(${t}) / 4][(${t}) % 4]`:`${e}[${Math.floor(t/4)}][${t%4}]`:r>1?`${e}[${t}]`:e,Yn=(e,t,r,o,n)=>{let s=typeof r=="number",u=s?r:r.length,l=[...new Array(u).keys()],a=u<2?"u32":u<=4?`vec${u}<u32>`:`array<u32, ${u}>`,p=jn(t,n),h=typeof p=="string"?p:p[1],g=typeof p=="string"?p:p[0],w={indices:a,value:h,storage:g,tensor:t},v=H=>typeof H=="string"?H:`${H}u`,y={offsetToIndices:!1,indicesToOffset:!1,broadcastedIndicesToOffset:!1,set:!1,setByIndices:!1,get:!1,getByIndices:!1},_=s?"uniforms.":"",I=`${_}${e}_shape`,x=`${_}${e}_strides`,A="";for(let H=0;H<u-1;H++)A+=`\n    let dim${H} = current / ${de(x,H,u)};\n    let rest${H} = current % ${de(x,H,u)};\n    indices[${H}] = dim${H};\n    current = rest${H};\n    `;A+=`indices[${u-1}] = current;`;let O=u<2?"":`\n  fn o2i_${e}(offset: u32) -> ${w.indices} {\n    var indices: ${w.indices};\n    var current = offset;\n    ${A}\n    return indices;\n  }`,C=H=>(y.offsetToIndices=!0,u<2?H:`o2i_${e}(${H})`),M=[];if(u>=2)for(let H=u-1;H>=0;H--)M.push(`${de(x,H,u)} * (indices[${H}])`);let D=u<2?"":`\n  fn i2o_${e}(indices: ${w.indices}) -> u32 {\n    return ${M.join("+")};\n  }`,G=H=>(y.indicesToOffset=!0,u<2?H:`i2o_${e}(${H})`),E=(...H)=>u===0?"0u":`${w.indices}(${H.map(v).join(",")})`,W=(H,J)=>u<2?`${H}`:`${de(H,J,u)}`,te=(H,J,Ce)=>u<2?`${H}=${Ce};`:`${de(H,J,u)}=${Ce};`,Y={},Z=(H,J)=>{y.broadcastedIndicesToOffset=!0;let Ce=`${J.name}broadcastedIndicesTo${e}Offset`;if(Ce in Y)return`${Ce}(${H})`;let $t=[];for(let Me=u-1;Me>=0;Me--){let tt=J.indicesGet("outputIndices",Me+J.rank-u);$t.push(`${W(x,Me)} * (${tt} % ${W(I,Me)})`)}return Y[Ce]=`fn ${Ce}(outputIndices: ${J.type.indices}) -> u32 {\n             return ${$t.length>0?$t.join("+"):"0u"};\n           }`,`${Ce}(${H})`},ee=(H,J)=>(()=>{if(w.storage===w.value)return`${e}[${H}]=${J};`;if(w.storage==="vec2<u32>"&&w.value==="i32")return`${e}[${H}]=vec2<u32>(u32(${J}), select(0u, 0xFFFFFFFFu, ${J} < 0));`;if(w.storage==="vec2<u32>"&&w.value==="u32")return`${e}[${H}]=vec2<u32>(u32(${J}), 0u);`;if(w.storage==="u32"&&w.value==="vec4<bool>")return`${e}[${H}]=dot(vec4<u32>(0x1, 0x100, 0x10000, 0x1000000), vec4<u32>(${J}));`;throw new Error(`not supported combination of storage type ${w.storage} and value type ${w.value} yet`)})(),Te=H=>(()=>{if(w.storage===w.value)return`${e}[${H}]`;if(w.storage==="vec2<u32>"&&w.value==="i32")return`i32(${e}[${H}].x)`;if(w.storage==="vec2<u32>"&&w.value==="u32")return`u32(${e}[${H}].x)`;if(w.storage==="u32"&&w.value==="vec4<bool>")return`vec4<bool>(bool(${e}[${H}] & 0xFFu), bool(${e}[${H}] & 0xFF00u), bool(${e}[${H}] & 0xFF0000u), bool(${e}[${H}] & 0xFF000000u))`;throw new Error(`not supported combination of storage type ${w.storage} and value type ${w.value} yet`)})(),De=u<2?"":`\n  fn get_${e}ByIndices(indices: ${w.indices}) -> ${h} {\n    return ${Te(`i2o_${e}(indices)`)};\n  }`,re=u<2?"":(()=>{let H=l.map(Ce=>`d${Ce}: u32`).join(", "),J=l.map(Ce=>`d${Ce}`).join(", ");return`\n  fn get_${e}(${H}) -> ${h} {\n    return get_${e}ByIndices(${E(J)});\n  }`})(),Ie=(...H)=>{if(H.length!==u)throw new Error(`indices length must be ${u}`);let J=H.map(v).join(",");return u===0?Te("0u"):u===1?Te(J[0]):(y.get=!0,y.getByIndices=!0,y.indicesToOffset=!0,`get_${e}(${J})`)},Oe=H=>u<2?Te(H):(y.getByIndices=!0,y.indicesToOffset=!0,`get_${e}ByIndices(${H})`),ie=u<2?"":`\n  fn set_${e}ByIndices(indices: ${w.indices}, value: ${h}) {\n    ${ee(`i2o_${e}(indices)`,"value")}\n  }`,Se=u<2?"":(()=>{let H=l.map(Ce=>`d${Ce}: u32`).join(", "),J=l.map(Ce=>`d${Ce}`).join(", ");return`\n  fn set_${e}(${H}, value: ${h}) {\n    set_${e}ByIndices(${E(J)}, value);\n  }`})();return{impl:()=>{let H=[],J=!1;return y.offsetToIndices&&(H.push(O),J=!0),y.indicesToOffset&&(H.push(D),J=!0),y.broadcastedIndicesToOffset&&(Object.values(Y).forEach(Ce=>H.push(Ce)),J=!0),y.set&&(H.push(Se),J=!0),y.setByIndices&&(H.push(ie),J=!0),y.get&&(H.push(re),J=!0),y.getByIndices&&(H.push(De),J=!0),!s&&J&&H.unshift(`const ${I} = ${w.indices}(${r.join(",")});`,`const ${x} = ${w.indices}(${V.computeStrides(r).join(",")});`),H.join(`\n`)},type:w,offsetToIndices:C,indicesToOffset:G,broadcastedIndicesToOffset:Z,indices:E,indicesGet:W,indicesSet:te,set:(...H)=>{if(H.length!==u+1)throw new Error(`indices length must be ${u}`);let J=H[u];if(typeof J!="string")throw new Error("value must be string");let Ce=H.slice(0,u).map(v).join(",");return u===0?ee("0u",J):u===1?ee(Ce[0],J):(y.set=!0,y.setByIndices=!0,y.indicesToOffset=!0,`set_${e}(${Ce}, ${J})`)},setByOffset:ee,setByIndices:(H,J)=>u<2?ee(H,J):(y.setByIndices=!0,y.indicesToOffset=!0,`set_${e}ByIndices(${H}, ${J});`),get:Ie,getByOffset:Te,getByIndices:Oe,usage:o,name:e,strides:x,shape:I,rank:u}},U=(e,t,r,o=1)=>Yn(e,t,r,"input",o),K=(e,t,r,o=1)=>Yn(e,t,r,"output",o),tn=(e,t,r,o=1)=>Yn(e,t,r,"internal",o),qn=class{constructor(t){this.normalizedDispatchGroup=t;this.internalVariables=[];this.variables=[];this.uniforms=[];this.variableIndex=0}guardAgainstOutOfBoundsWorkgroupSizes(t){return`if (global_idx >= ${typeof t=="number"?`${t}u`:t}) { return; }`}mainStart(t=Ad){let r=typeof t=="number"?t:t[0],o=typeof t=="number"?1:t[1],n=typeof t=="number"?1:t[2],s=this.normalizedDispatchGroup[1]===1&&this.normalizedDispatchGroup[2]===1,u=s?`@builtin(global_invocation_id) global_id : vec3<u32>,\n    @builtin(workgroup_id) workgroup_id : vec3<u32>,\n    @builtin(local_invocation_id) local_id : vec3<u32>`:`@builtin(local_invocation_id) local_id : vec3<u32>,\n    @builtin(local_invocation_index) local_idx : u32,\n    @builtin(workgroup_id) workgroup_id : vec3<u32>,\n    @builtin(num_workgroups) num_workgroups : vec3<u32>`,l=s?"let global_idx = global_id.x; let local_idx = local_id.x;":`let global_idx = (workgroup_id.z * num_workgroups[0] * num_workgroups[1] +\n          workgroup_id.y * num_workgroups[0] + workgroup_id.x) * ${r*o*n}u + local_idx;`;return`@compute @workgroup_size(${r}, ${o}, ${n})\n  fn main(${u}) {\n    ${l}\n  `}appendVariableUniforms(t){t.rank!==0&&(t.shape.startsWith("uniforms.")&&this.uniforms.push({name:t.shape.replace("uniforms.",""),type:"u32",length:t.rank}),t.strides.startsWith("uniforms.")&&this.uniforms.push({name:t.strides.replace("uniforms.",""),type:"u32",length:t.rank}))}declareVariable(t,r){if(t.usage==="internal")throw new Error("cannot use internal variable with declareVariable(). use registerInternalVariables() instead.");this.variables.push(t),this.appendVariableUniforms(t);let o=t.usage==="input"?"read":"read_write",n=t.type.storage;return`@group(0) @binding(${r}) var<storage, ${o}> ${t.name}: array<${n}>;`}declareVariables(...t){return t.map(r=>this.declareVariable(r,this.variableIndex++)).join(`\n`)}registerInternalVariable(t){if(t.usage!=="internal")throw new Error("cannot use input or output variable with registerInternalVariable(). use declareVariables() instead.");this.internalVariables.push(t),this.appendVariableUniforms(t)}registerInternalVariables(...t){return t.forEach(r=>this.registerInternalVariable(r)),this}registerUniform(t,r,o=1){return this.uniforms.push({name:t,type:r,length:o}),this}registerUniforms(t){return this.uniforms=this.uniforms.concat(t),this}uniformDeclaration(){if(this.uniforms.length===0)return"";let t=[];for(let{name:r,type:o,length:n}of this.uniforms)if(n&&n>4)t.push(`${r}:array<vec4<${o}>, ${Math.ceil(n/4)}>`);else{let s=n==null||n===1?o:`vec${n}<${o}>`;t.push(`${r}:${s}`)}return`\n      struct Uniforms { ${t.join(", ")} };\n      @group(0) @binding(${this.variableIndex}) var<uniform> uniforms: Uniforms;`}get additionalImplementations(){return this.uniformDeclaration()+this.variables.map(t=>t.impl()).join(`\n`)+this.internalVariables.map(t=>t.impl()).join(`\n`)}},Ia=e=>new qn(e),nr=(e,t)=>{let r=e.length,o=[];for(let n=0;n<r;n++){let s=r-1-n,u=e[s]||1;(t[t.length-1-n]||1)>1&&u===1&&o.unshift(s)}return o},Ue=e=>!0});var Td,Aa,Ed,Od,dt,Ta,Ea,or=q(()=>{"use strict";xe();Le();$e();Td=e=>{if(!e||e.length!==1)throw new Error("Transpose requires 1 input.")},Aa=(e,t)=>t&&t.length!==e?[...new Array(e).keys()].reverse():t,Ed=(e,t)=>V.sortBasedOnPerm(e,Aa(e.length,t)),Od=(e,t,r,o)=>{let n=[];n.push(`fn perm(i: ${o.type.indices}) -> ${r.type.indices} {\n    var a: ${r.type.indices};`);for(let s=0;s<t;++s)n.push(r.indicesSet("a",e[s],`i[${s}]`));return n.push("return a;}"),n.join(`\n`)},dt=(e,t)=>{let r=e.dataType,o=e.dims.length,n=Aa(o,t),s=Ue(o),u=Ed(e.dims,n),l=s?u.length:u,a=s?o:e.dims,p=K("output",r,l),h=U("a",r,a),g=w=>`\n  ${w.registerUniform("output_size","u32").declareVariables(h,p)}\n\n  ${Od(n,o,h,p)}\n\n  ${w.mainStart()}\n    ${w.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}\n\n    let indices = ${p.offsetToIndices("global_idx")};\n    let aIndices = perm(indices);\n\n    ${p.setByOffset("global_idx",h.getByIndices("aIndices"))}\n  }`;return{name:"Transpose",shaderCache:{hint:`${t}`,inputDependencies:s?["rank"]:["dims"]},getRunData:w=>{let v=V.size(u);return{outputs:[{dims:u,dataType:w[0].dataType}],dispatchGroup:{x:Math.ceil(v/64)},programUniforms:s?[{type:"uint32",data:v},...F(w[0].dims),...F(u)]:[{type:"uint32",data:v}]}},getShaderSource:g}},Ta=(e,t)=>{Td(e.inputs),e.compute(dt(e.inputs[0],t.perm))},Ea=e=>he({perm:e.perm})});var Pd,Bd,kd,Rd,Dd,Md,Ud,zd,Vd,Nd,ht,Oa,Pa,Ba,ka,Ra,Da,Ma,Ua,za,Va,Na=q(()=>{"use strict";xe();$e();rn();or();Pd={max:"select(bestValue, candidate, candidate > bestValue)",min:"select(bestValue, candidate, candidate < bestValue)",mean:"bestValue + candidate",sum:"bestValue + candidate",prod:"bestValue * candidate",sumSquare:"bestValue + candidate * candidate",logSumExp:"bestValue + exp(candidate)",l1:"bestValue + abs(candidate)",l2:"bestValue + candidate * candidate",logSum:"bestValue + candidate"},Bd={max:"select(bestValue, candidate, candidate > bestValue)",min:"select(bestValue, candidate, candidate < bestValue)",mean:"bestValue + candidate",sum:"bestValue + candidate",prod:"bestValue * candidate",sumSquare:"bestValue + candidate",logSumExp:"bestValue + candidate",l1:"bestValue + candidate",l2:"bestValue + candidate",logSum:"bestValue + candidate"},kd={max:"_A[offset]",min:"_A[offset]",mean:"0",sum:"0",prod:"1",sumSquare:"0",logSumExp:"0",l1:"0",l2:"0",logSum:"0"},Rd={max:"bestValue",min:"bestValue",sum:"bestValue",prod:"bestValue",sumSquare:"bestValue",logSumExp:"log(bestValue)",l1:"bestValue",l2:"sqrt(bestValue)",logSum:"log(bestValue)"},Dd=(e,t)=>{let r=[];for(let o=t-e;o<t;++o)r.push(o);return r},Md=(e,t)=>{let r=[],o=e.length;for(let s=0;s<o;s++)t.indexOf(s)===-1&&r.push(e[s]);let n=t.map(s=>e[s]);return[r,n]},Ud=(e,t)=>{let r=e.length+t.length,o=[],n=0;for(let s=0;s<r;s++)t.indexOf(s)===-1?o.push(e[n++]):o.push(1);return o},zd=(e,t)=>{for(let r=0;r<e.length;++r)if(e[e.length-r-1]!==t-1-r)return!1;return!0},Vd=(e,t)=>{let r=[];if(!zd(e,t)){for(let o=0;o<t;++o)e.indexOf(o)===-1&&r.push(o);e.forEach(o=>r.push(o))}return r},Nd=(e,t,r,o,n,s,u)=>{let l=r[0].dims,a=V.size(s),p=V.size(u),h=U("_A",r[0].dataType,l),g=K("output",n,s),w=32,v=`\n          var<workgroup> aBestValues : array<${g.type.storage}, ${w}>;\n       `;return{name:e,shaderCache:t,getShaderSource:_=>`\n        ${_.registerUniform("reduceSize","u32").declareVariables(h,g)}\n        ${v}\n        fn DIV_CEIL(a : u32, b : u32) -> u32 {\n          return ((a - 1u) / b + 1u);\n         }\n         ${_.mainStart(w)}\n\n          let outputIndex = global_idx / ${w};\n          let offset = outputIndex * uniforms.reduceSize;\n\n          var bestValue = ${g.type.storage}(${kd[o]});\n          let Length = uniforms.reduceSize;\n          for (var k = local_idx; k < Length; k = k + ${w}) {\n           let candidate = ${g.type.storage}(${h.getByOffset("offset + k")});\n           bestValue = ${Pd[o]};\n          }\n          aBestValues[local_idx] = bestValue;\n          workgroupBarrier();\n\n         var reduceSize = min(Length, ${w}u);\n         for (var currentSize = reduceSize / 2u; reduceSize > 1u;\n             currentSize = reduceSize / 2u) {\n           let interval = DIV_CEIL(reduceSize, 2u);\n           if (local_idx < currentSize) {\n            let candidate = aBestValues[local_idx + interval];\n            bestValue = ${Bd[o]};\n            aBestValues[local_idx] = bestValue;\n           }\n           reduceSize = interval;\n           workgroupBarrier();\n         }\n\n         if (local_idx == 0u) {\n          ${g.setByOffset("outputIndex",`${o==="mean"?`bestValue / ${g.type.storage}(uniforms.reduceSize)`:`${Rd[o]}`}`)};\n         }\n        }`,getRunData:()=>({outputs:[{dims:s,dataType:n}],dispatchGroup:{x:a},programUniforms:[{type:"uint32",data:p}]})}},ht=(e,t,r,o)=>{let n=e.inputs.length===1?r:Zn(e.inputs,r),s=n.axes;s.length===0&&!n.noopWithEmptyAxes&&(s=e.inputs[0].dims.map((v,y)=>y));let u=V.normalizeAxes(s,e.inputs[0].dims.length),l=u,a=e.inputs[0],p=Vd(l,e.inputs[0].dims.length);p.length>0&&(a=e.compute(dt(e.inputs[0],p),{inputs:[0],outputs:[-1]})[0],l=Dd(l.length,a.dims.length));let[h,g]=Md(a.dims,l),w=h;n.keepDims&&(w=Ud(h,u)),e.compute(Nd(t,{hint:n.cacheKey,inputDependencies:["type"]},[a],o,e.inputs[0].dataType,w,g),{inputs:[a]})},Oa=(e,t)=>{ht(e,"ReduceMeanShared",t,"mean")},Pa=(e,t)=>{ht(e,"ReduceL1Shared",t,"l1")},Ba=(e,t)=>{ht(e,"ReduceL2Shared",t,"l2")},ka=(e,t)=>{ht(e,"ReduceLogSumExpShared",t,"logSumExp")},Ra=(e,t)=>{ht(e,"ReduceMaxShared",t,"max")},Da=(e,t)=>{ht(e,"ReduceMinShared",t,"min")},Ma=(e,t)=>{ht(e,"ReduceProdShared",t,"prod")},Ua=(e,t)=>{ht(e,"ReduceSumShared",t,"sum")},za=(e,t)=>{ht(e,"ReduceSumSquareShared",t,"sumSquare")},Va=(e,t)=>{ht(e,"ReduceLogSumShared",t,"logSum")}});var gt,Wd,nn,Zn,yt,Gd,Hd,Ld,Fd,Kd,qd,jd,Yd,Zd,Qd,bt,Wa,Ga,Ha,La,Fa,Ka,qa,ja,Ya,Za,rn=q(()=>{"use strict";xe();Le();$e();Na();gt=e=>{if(!e||e.length===0||e.length>2)throw new Error("Reduce op requires 1 or 2 inputs.");if(e.length===2&&e[1].dims.length!==1)throw new Error("Invalid axes input dims.")},Wd=e=>["","",`var value = ${e.getByIndices("input_indices")};`,""],nn=(e,t,r,o,n,s,u=!1,l=!1)=>{let a=[],p=r[0].dims,h=p.length,g=V.normalizeAxes(n,h),w=!l&&g.length===0;p.forEach((I,x)=>{w||g.indexOf(x)>=0?u&&a.push(1):a.push(I)});let v=a.length,y=V.size(a);return{name:e,shaderCache:t,getShaderSource:I=>{let x=[],A=U("_A",r[0].dataType,h),O=K("output",s,v),C=o(A,O,g),M=C[2];for(let D=0,G=0;D<h;D++)w||g.indexOf(D)>=0?(u&&G++,M=`for(var j${D}: u32 = 0; j${D} < ${p[D]}; j${D}++) {\n                  ${C[2].includes("last_index")?`let last_index = j${D};`:""}\n                  ${A.indicesSet("input_indices",D,`j${D}`)}\n                  ${M}\n                }`):(x.push(`${A.indicesSet("input_indices",D,O.indicesGet("output_indices",G))};`),G++);return`\n\n        ${I.registerUniform("output_size","u32").declareVariables(A,O)}\n\n        ${I.mainStart()}\n          ${I.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}\n          var input_indices: ${A.type.indices};\n          let output_indices = ${O.offsetToIndices("global_idx")};\n\n          ${x.join(`\n`)}\n          ${C[0]}       // init ops for reduce max/min\n          ${C[1]}\n          ${M}\n          ${C[3]}\n          ${C.length===4?O.setByOffset("global_idx","value"):C.slice(4).join(`\n`)}\n        }`},getRunData:()=>({outputs:[{dims:a,dataType:s}],dispatchGroup:{x:Math.ceil(y/64)},programUniforms:[{type:"uint32",data:y},...F(p),...F(a)]})}},Zn=(e,t)=>{let r=[];return e[1].dims[0]>0&&e[1].getBigInt64Array().forEach(o=>r.push(Number(o))),he({axes:r,keepDims:t.keepDims,noopWithEmptyAxes:t.noopWithEmptyAxes})},yt=(e,t,r,o)=>{let n=e.inputs,s=n.length===1?r:Zn(n,r);e.compute(nn(t,{hint:s.cacheKey,inputDependencies:["rank"]},[n[0]],s.noopWithEmptyAxes&&s.axes.length===0?Wd:o,s.axes,n[0].dataType,s.keepDims,s.noopWithEmptyAxes),{inputs:[0]})},Gd=(e,t)=>{gt(e.inputs),yt(e,"ReduceLogSum",t,(o,n)=>[`var value = ${n.type.storage}(0);`,"",`value += ${o.getByIndices("input_indices")};`,"value = log(value);"])},Hd=(e,t)=>{gt(e.inputs),yt(e,"ReduceL1",t,(o,n)=>[`var value = ${n.type.storage}(0);`,"",`value += abs(${o.getByIndices("input_indices")});`,""])},Ld=(e,t)=>{gt(e.inputs),yt(e,"ReduceL2",t,(o,n)=>[`var t = ${n.type.value}(0); var value = ${n.type.value}(0);`,"",`t = ${o.getByIndices("input_indices")}; value += (t * t);`,"value = sqrt(value);"])},Fd=(e,t)=>{gt(e.inputs),yt(e,"ReduceLogSumExp",t,(o,n)=>[`var value = ${n.type.storage}(0);`,"",`value += exp(${o.getByIndices("input_indices")});`,"value = log(value);"])},Kd=(e,t)=>{gt(e.inputs),yt(e,"ReduceMax",t,(o,n,s)=>{let u=[];for(let l=0;l<o.rank;l++)(s.indexOf(l)>=0||s.length===0)&&u.push(o.indicesSet("input_indices",l,0));return[`${u.join(`\n`)}`,`var value = ${o.getByIndices("input_indices")};`,`value = max(value, ${o.getByIndices("input_indices")});`,""]})},qd=(e,t)=>{gt(e.inputs),yt(e,"ReduceMean",t,(o,n,s)=>{let u=1;for(let l=0;l<o.rank;l++)(s.indexOf(l)>=0||s.length===0)&&(u*=e.inputs[0].dims[l]);return["var sum = f32(0);","",`sum += f32(${o.getByIndices("input_indices")});`,`let value = ${n.type.value}(sum / ${u});`]})},jd=(e,t)=>{gt(e.inputs),yt(e,"ReduceMin",t,(o,n,s)=>{let u=[];for(let l=0;l<o.rank;l++)(s.indexOf(l)>=0||s.length===0)&&u.push(`input_indices[${l}] = 0;`);return[`${u.join(`\n`)}`,`var value = ${o.getByIndices("input_indices")};`,`value = min(value, ${o.getByIndices("input_indices")});`,""]})},Yd=(e,t)=>{gt(e.inputs),yt(e,"ReduceProd",t,(o,n)=>[`var value = ${n.type.storage}(1);`,"",`value *= ${o.getByIndices("input_indices")};`,""])},Zd=(e,t)=>{gt(e.inputs),yt(e,"ReduceSum",t,(o,n)=>[`var value = ${n.type.storage}(0);`,"",`value += ${o.getByIndices("input_indices")};`,""])},Qd=(e,t)=>{gt(e.inputs),yt(e,"ReduceSumSquare",t,(o,n)=>[`var t = ${n.type.value}(0); var value = ${n.type.value}(0);`,"",`t = ${o.getByIndices("input_indices")}; value += t * t;`,""])},bt=(e,t,r)=>{if(t.length===0)return r;let o=1,n=1;for(let s=0;s<t.length;s++)t.indexOf(s)===-1?o*=e[s]:n*=e[s];return n<32&&o>1024},Wa=(e,t)=>{bt(e.inputs[0].dims,t.axes,t.noopWithEmptyAxes)?qd(e,t):Oa(e,t)},Ga=(e,t)=>{bt(e.inputs[0].dims,t.axes,t.noopWithEmptyAxes)?Hd(e,t):Pa(e,t)},Ha=(e,t)=>{bt(e.inputs[0].dims,t.axes,t.noopWithEmptyAxes)?Ld(e,t):Ba(e,t)},La=(e,t)=>{bt(e.inputs[0].dims,t.axes,t.noopWithEmptyAxes)?Fd(e,t):ka(e,t)},Fa=(e,t)=>{bt(e.inputs[0].dims,t.axes,t.noopWithEmptyAxes)?Kd(e,t):Ra(e,t)},Ka=(e,t)=>{bt(e.inputs[0].dims,t.axes,t.noopWithEmptyAxes)?jd(e,t):Da(e,t)},qa=(e,t)=>{bt(e.inputs[0].dims,t.axes,t.noopWithEmptyAxes)?Yd(e,t):Ma(e,t)},ja=(e,t)=>{bt(e.inputs[0].dims,t.axes,t.noopWithEmptyAxes)?Zd(e,t):Ua(e,t)},Ya=(e,t)=>{bt(e.inputs[0].dims,t.axes,t.noopWithEmptyAxes)?Qd(e,t):za(e,t)},Za=(e,t)=>{bt(e.inputs[0].dims,t.axes,t.noopWithEmptyAxes)?Gd(e,t):Va(e,t)}});var Qa,Ja,Xa,Qn,ei=q(()=>{"use strict";We();Le();rn();Qa=e=>{if(!e||e.length===0||e.length>2)throw new Error("ArgMinMaxOp op requires 1 or 2 inputs.");if(e[0].dataType!==1)throw new Error("Invalid input type.")},Ja=(e,t)=>{Qa(e.inputs);let r=(o,n,s)=>{let u=[];for(let l=0;l<o.rank;l++)(s.indexOf(l)>=0||s.length===0)&&u.push(`input_indices[${l}] = 0;`);return[`${u.join(`\n`)}`,`var value = ${o.getByIndices("input_indices")};\nvar best_index : i32 = 0;`,`if (${o.getByIndices("input_indices")} ${t.selectLastIndex>0?"<=":"<"} value) {\n         value = ${o.getByIndices("input_indices")};\n         best_index = i32(last_index);\n       }`,"",n.setByOffset("global_idx","best_index")]};e.compute(nn("ArgMin",{hint:t.cacheKey,inputDependencies:["rank"]},[e.inputs[0]],r,[t.axis],7,t.keepDims),{inputs:[0]})},Xa=(e,t)=>{Qa(e.inputs);let r=(o,n,s)=>{let u=[];for(let l=0;l<o.rank;l++)(s.indexOf(l)>=0||s.length===0)&&u.push(`input_indices[${l}] = 0;`);return[`${u.join(`\n`)}`,`var value = ${o.getByIndices("input_indices")};\nvar best_index : i32 = 0;`,`if (${o.getByIndices("input_indices")} ${t.selectLastIndex>0?">=":">"} value) {\n         value = ${o.getByIndices("input_indices")};\n         best_index = i32(last_index);\n       }`,"",n.setByOffset("global_idx","best_index")]};e.compute(nn("argMax",{hint:t.cacheKey,inputDependencies:["rank"]},[e.inputs[0]],r,[t.axis],7,t.keepDims),{inputs:[0]})},Qn=e=>he(e)});var Jd,Xd,el,tl,on,rl,ti,Jn=q(()=>{"use strict";We();Zr();$e();Jd=(e,t)=>{let r=e[0],o=e[1],n=e[2],s=e[3],u=e[4],l=e[5];if(u&&l)throw new Error("Attention cannot have both past and relative_position_bias");if(r.dims.length!==3)throw new Error(\'Input "input" must have 3 dimensions\');let a=r.dims[0],p=r.dims[1],h=r.dims[2];if(n.dims.length!==1)throw new Error(\'Input "bias" is expected to have 1 dimensions\');if(o.dims.length!==2)throw new Error(\'Input "weights" is expected to have 2 dimensions\');if(o.dims[0]!==h)throw new Error("Input 1 dimension 0 should have same length as dimension 2 of input 0");if(n.dims[0]!==o.dims[1])throw new Error(\'Input "bias" dimension 0 should have same length as dimension 1 of input "weights"\');let g=n.dims[0]/3,w=g,v=w;if(t.qkvHiddenSizes.length>0){if(t.qkvHiddenSizes.length!==3)throw new Error("qkv_hidden_sizes attribute should have 3 elements");for(let O of t.qkvHiddenSizes)if(O%t.numHeads!==0)throw new Error("qkv_hidden_sizes should be divisible by num_heads");g=t.qkvHiddenSizes[0],w=t.qkvHiddenSizes[1],v=t.qkvHiddenSizes[2]}let y=p;if(g!==w)throw new Error("qkv_hidden_sizes first element should be same as the second");if(n.dims[0]!==g+w+v)throw new Error(\'Input "bias" dimension 0 should have same length as sum of Q/K/V hidden sizes\');let _=0;if(u){if(w!==v)throw new Error(\'Input "past" expect k_hidden_size == v_hidden_size\');if(u.dims.length!==5)throw new Error(\'Input "past" must have 5 dimensions\');if(u.dims[0]!==2)throw new Error(\'Input "past" first dimension must be 2\');if(u.dims[1]!==a)throw new Error(\'Input "past" second dimension must be batch_size\');if(u.dims[2]!==t.numHeads)throw new Error(\'Input "past" third dimension must be num_heads\');if(u.dims[4]!==w/t.numHeads)throw new Error(\'Input "past" fifth dimension must be k_hidden_size / num_heads\');t.pastPresentShareBuffer||(_=u.dims[3])}let I=y+_,x=-1,A=0;if(s)throw new Error("Mask not supported");if(u)throw new Error("past is not supported");if(l)throw new Error("relativePositionBias is not supported");return{batchSize:a,sequenceLength:p,pastSequenceLength:_,kvSequenceLength:y,totalSequenceLength:I,maxSequenceLength:x,inputHiddenSize:h,hiddenSize:g,vHiddenSize:v,headSize:Math.floor(g/t.numHeads),vHeadSize:Math.floor(v/t.numHeads),numHeads:t.numHeads,isUnidirectional:!1,pastPresentShareBuffer:!1,maskFilterValue:t.maskFilterValue,maskType:A,scale:t.scale,broadcastResPosBias:!1,passPastInKv:!1,qkvFormat:1}},Xd=(e,t,r,o)=>{let n=He(o),s=64,u=o/n;u<s?s=1:u/8<64&&(s=Math.ceil(u/8));let l=Math.ceil(o/n/s),p=[{type:nt(t.dataType),data:1/o},{type:"uint32",data:u},{type:"uint32",data:l}],h=Ge(t.dataType,n),g=w=>{let v=K("x",t.dataType,t.dims,n),y="thread_max_vector";n===2?y="max(thread_max_vector.x, thread_max_vector.y)":n===4&&(y="max(max(thread_max_vector.x, thread_max_vector.y), max(thread_max_vector.z, thread_max_vector.w))");let _=ft(t.dataType),I=[{name:"d_inv",type:_},{name:"d_comp",type:"u32"},{name:"elements_per_wg",type:"u32"}];return`\n  var<workgroup> wgMax: array<f32, ${s}>;\n  var<workgroup> wgSum: array<f32, ${s}>;\n  ${w.registerUniforms(I).declareVariables(v)}\n  ${w.mainStart([s,1,1])}\n    let localOffset = local_idx * uniforms.elements_per_wg;\n    let offset: u32 = workgroup_id.x * uniforms.d_comp + localOffset;\n\n    var thread_max_vector = ${Qe("f32",n,"-3.402823e+38f")};\n    for (var i: u32 = 0; i < uniforms.elements_per_wg && i + localOffset < uniforms.d_comp; i++) {\n      thread_max_vector = max(${ut(_,n,"x[offset + i]")}, thread_max_vector);\n    }\n    wgMax[local_idx] = ${y};\n    workgroupBarrier();\n\n    var maxValue = -3.402823e+38f;\n    for (var i = 0u; i < ${s}; i++) {\n      maxValue = max(wgMax[i], maxValue);\n    }\n\n    var sumVector = ${Qe("f32",n,"0")};\n    for (var i: u32 = 0; i < uniforms.elements_per_wg && i + localOffset < uniforms.d_comp; i++) {\n      sumVector += exp(${ut(_,n,"x[offset + i]")} - maxValue);\n    }\n    wgSum[local_idx] = ${ot("sumVector",n)};\n    workgroupBarrier();\n\n    var sum: f32 = 0;\n    for (var i = 0u; i < ${s}; i++) {\n      sum += wgSum[i];\n    }\n\n    if (sum == 0) {\n      for (var i: u32 = 0; i < uniforms.elements_per_wg && i + localOffset < uniforms.d_comp; i++) {\n        x[offset + i] = ${Qe("f32",n,"uniforms.d_inv")};\n      }\n    } else {\n      for (var i: u32 = 0; i < uniforms.elements_per_wg && i + localOffset < uniforms.d_comp; i++) {\n        let f32input = ${ut(_,n,"x[offset + i]")};\n        x[offset + i] = ${v.type.value}(exp(f32input - maxValue) / sum);\n      }\n    }\n  }`};e.compute({name:"AttentionProbsSoftmax",shaderCache:{hint:`${s};${h};${n}`},getShaderSource:g,getRunData:()=>({outputs:[],dispatchGroup:{x:r},programUniforms:p})},{inputs:[t],outputs:[]})},el=(e,t,r,o,n,s)=>{let u=[n.batchSize,n.numHeads,n.sequenceLength,n.kvSequenceLength+n.pastSequenceLength],l=s.scale===0?1/Math.sqrt(n.headSize):s.scale,a=He(n.headSize),p=n.headSize/a,h=12,g={x:Math.ceil(n.totalSequenceLength/h),y:Math.ceil(n.sequenceLength/h),z:n.batchSize*n.numHeads},w=nt(t.dataType),v=[{type:"uint32",data:n.sequenceLength},{type:"uint32",data:p},{type:"uint32",data:n.totalSequenceLength},{type:"uint32",data:n.kvSequenceLength},{type:w,data:l}],y=[t,r],_=x=>{let A=U("q",t.dataType,t.dims,a),O=U("key",r.dataType,r.dims,a),C=K("output",t.dataType,u),M=Ge(t.dataType),D=[{name:"M",type:"u32"},{name:"K",type:"u32"},{name:"N",type:"u32"},{name:"kv_sequence_length",type:"u32"},{name:"alpha",type:M}];return`\n  const beta: ${M} = 1.0;\n  const TILE_SIZE = ${h}u;\n\n  var<workgroup> tileQ: array<${A.type.storage}, ${h*h}>;\n  var<workgroup> tileK: array<${A.type.storage}, ${h*h}>;\n  ${x.registerUniforms(D).declareVariables(A,O,C)}\n  ${x.mainStart([h,h,1])}\n    // x holds the N and y holds the M\n    let headIdx = workgroup_id.z;\n    let m = workgroup_id.y * TILE_SIZE;\n    let n = workgroup_id.x * TILE_SIZE;\n    let lm = m + local_id.y;\n    let ln = n + local_id.x;\n\n    let qOffset = uniforms.M * uniforms.K * headIdx + m * uniforms.K;\n    let kOffset = uniforms.kv_sequence_length * uniforms.K * headIdx + n * uniforms.K;\n\n    var value = ${Qe(M,a)};\n    for (var w: u32 = 0u; w < uniforms.K; w += TILE_SIZE) {\n      if (m + local_id.y < uniforms.M && w + local_id.x < uniforms.K) {\n        tileQ[TILE_SIZE * local_id.y + local_id.x] = q[qOffset + local_id.y * uniforms.K + w + local_id.x];\n      }\n      if (n + local_id.y < uniforms.N && w + local_id.x < uniforms.K) {\n        tileK[TILE_SIZE * local_id.y + local_id.x] = key[kOffset + local_id.y * uniforms.K + w + local_id.x];\n      }\n      workgroupBarrier();\n\n      for (var k: u32 = 0u; k<TILE_SIZE && w+k < uniforms.K; k++) {\n        value += tileQ[TILE_SIZE * local_id.y + k] * tileK[TILE_SIZE * local_id.x + k];\n      }\n\n      workgroupBarrier();\n    }\n\n    let headOffset = headIdx * uniforms.M * uniforms.N;\n    if (lm < uniforms.M && ln < uniforms.N) {\n      let outputIdx = headOffset + lm * uniforms.N + ln;\n      output[outputIdx] = ${ot("value",a)} * uniforms.alpha;\n    }\n  }`},I=e.compute({name:"AttentionProbs",shaderCache:{hint:`${a}`,inputDependencies:["type","type"]},getRunData:()=>({outputs:[{dims:u,dataType:t.dataType,gpuDataType:0}],dispatchGroup:g,programUniforms:v}),getShaderSource:_},{inputs:y,outputs:[-1]})[0];return Xd(e,I,n.batchSize*n.numHeads*n.sequenceLength,n.totalSequenceLength),I},tl=(e,t,r,o)=>{let n=[o.batchSize,o.sequenceLength,o.vHiddenSize],s=12,u={x:Math.ceil(o.vHeadSize/s),y:Math.ceil(o.sequenceLength/s),z:o.batchSize*o.numHeads},l=[{type:"uint32",data:o.sequenceLength},{type:"uint32",data:o.totalSequenceLength},{type:"uint32",data:o.vHeadSize},{type:"uint32",data:o.numHeads},{type:"uint32",data:o.vHiddenSize}],a=p=>{let h=U("probs",t.dataType,t.dims),g=U("v",r.dataType,r.dims),w=K("output",t.dataType,n),v=[{name:"M",type:"u32"},{name:"K",type:"u32"},{name:"N",type:"u32"},{name:"num_heads",type:"u32"},{name:"v_hidden_size",type:"u32"}];return`\n  const TILE_SIZE = ${s}u;\n  var<workgroup> tileQ: array<${h.type.value}, ${s*s}>;\n  var<workgroup> tileK: array<${h.type.value}, ${s*s}>;\n  ${p.registerUniforms(v).declareVariables(h,g,w)}\n  ${p.mainStart([s,s,1])}\n   let headIdx = workgroup_id.z;\n   let m = workgroup_id.y * TILE_SIZE + local_id.y;\n   let n = workgroup_id.x * TILE_SIZE + local_id.x;\n\n   let offsetA = headIdx * (uniforms.M * uniforms.K) + m * uniforms.K;\n   let offsetB = headIdx * (uniforms.N * uniforms.K) + n;\n\n   var value = ${h.type.storage}(0);\n   for (var w: u32 = 0u; w < uniforms.K; w += TILE_SIZE) {\n     if (m < uniforms.M && w + local_id.x < uniforms.K) {\n       tileQ[TILE_SIZE * local_id.y + local_id.x] = probs[offsetA + w + local_id.x];\n     }\n     if (n < uniforms.N && w + local_id.y < uniforms.K) {\n       tileK[TILE_SIZE * local_id.y + local_id.x] = v[offsetB + (w + local_id.y) * uniforms.N];\n     }\n     workgroupBarrier();\n     for (var k: u32 = 0u; k<TILE_SIZE && w+k < uniforms.K; k++) {\n       value += tileQ[TILE_SIZE * local_id.y + k] * tileK[TILE_SIZE * k + local_id.x];\n     }\n     workgroupBarrier();\n   }\n\n   // we need to transpose output from BNSH_v to BSND_v\n   let batchIdx = workgroup_id.z / uniforms.num_heads;\n   let currentBatchHeadNumber = workgroup_id.z % uniforms.num_heads;\n   let headOffset = (batchIdx * uniforms.M * uniforms.num_heads + currentBatchHeadNumber) * uniforms.N;\n   if (m < uniforms.M && n < uniforms.N) {\n     let outputIdx = batchIdx * uniforms.M *uniforms.v_hidden_size + m * uniforms.v_hidden_size\n       + currentBatchHeadNumber * uniforms.N + n;\n     output[outputIdx] = value;\n   }\n  }`};return e.compute({name:"AttentionScore",shaderCache:{inputDependencies:["type","type"]},getRunData:()=>({outputs:[{dims:n,dataType:t.dataType,gpuDataType:0}],dispatchGroup:u,programUniforms:l}),getShaderSource:a},{inputs:[t,r],outputs:[0]})[0]},on=(e,t,r,o,n,s,u,l,a,p,h)=>{let g=el(e,t,r,a,p,h);tl(e,g,o,p)},rl=(e,t)=>{let r=[t.batchSize,t.numHeads,t.sequenceLength,t.headSize],o=t.sequenceLength,n=t.inputHiddenSize,s=t.headSize,u=12,l={x:Math.ceil(t.headSize/u),y:Math.ceil(t.sequenceLength/u),z:t.batchSize*t.numHeads},a=[e.inputs[0],e.inputs[1],e.inputs[2]],p=[{type:"uint32",data:o},{type:"uint32",data:n},{type:"uint32",data:s},{type:"uint32",data:t.numHeads},{type:"uint32",data:t.headSize},{type:"uint32",data:t.hiddenSize},{type:"uint32",data:t.hiddenSize+t.hiddenSize+t.vHiddenSize}],h=g=>{let w=K("output_q",a[0].dataType,r),v=K("output_k",a[0].dataType,r),y=K("output_v",a[0].dataType,r),_=U("input",a[0].dataType,a[0].dims),I=U("weight",a[1].dataType,a[1].dims),x=U("bias",a[2].dataType,a[2].dims),A=_.type.storage,O=[{name:"M",type:"u32"},{name:"K",type:"u32"},{name:"N",type:"u32"},{name:"num_heads",type:"u32"},{name:"head_size",type:"u32"},{name:"hidden_size",type:"u32"},{name:"ldb",type:"u32"}];return`\n  const TILE_SIZE = ${u}u;\n  var<workgroup> tileInput: array<${A}, ${u*u}>;\n  var<workgroup> tileWeightQ: array<${A}, ${u*u}>;\n  var<workgroup> tileWeightK: array<${A}, ${u*u}>;\n  var<workgroup> tileWeightV: array<${A}, ${u*u}>;\n  ${g.registerUniforms(O).declareVariables(_,I,x,w,v,y)}\n  ${g.mainStart([u,u,1])}\n    let batchIndex = workgroup_id.z / uniforms.num_heads;\n    let headNumber = workgroup_id.z % uniforms.num_heads;\n    let m = workgroup_id.y * TILE_SIZE + local_id.y;\n    let n = workgroup_id.x * TILE_SIZE + local_id.x;\n\n    let inputOffset = batchIndex * (uniforms.M * uniforms.K) + m * uniforms.K;\n    let biasOffsetQ = headNumber * uniforms.head_size;\n    let biasOffsetK = uniforms.hidden_size + biasOffsetQ;\n    let biasOffsetV = uniforms.hidden_size + biasOffsetK;\n\n    var valueQ = ${A}(0);\n    var valueK = ${A}(0);\n    var valueV = ${A}(0);\n    for (var w: u32 = 0u; w < uniforms.K; w += TILE_SIZE) {\n      if (m < uniforms.M && w + local_id.x < uniforms.K) {\n        tileInput[TILE_SIZE * local_id.y + local_id.x] = input[inputOffset + w + local_id.x];\n      }\n      if (n < uniforms.N && w + local_id.y < uniforms.K) {\n        let offset = n + (w + local_id.y) * uniforms.ldb;\n        tileWeightQ[TILE_SIZE * local_id.y + local_id.x] = weight[biasOffsetQ + offset];\n        tileWeightK[TILE_SIZE * local_id.y + local_id.x] = weight[biasOffsetK + offset];\n        tileWeightV[TILE_SIZE * local_id.y + local_id.x] = weight[biasOffsetV + offset];\n      }\n      workgroupBarrier();\n      for (var k: u32 = 0u; k<TILE_SIZE && w+k < uniforms.K; k++) {\n        let inputTileOffset = TILE_SIZE * local_id.y + k;\n        let weightTileOffset = TILE_SIZE * k + local_id.x;\n        valueQ += tileInput[inputTileOffset] * tileWeightQ[weightTileOffset];\n        valueK += tileInput[inputTileOffset] * tileWeightK[weightTileOffset];\n        valueV += tileInput[inputTileOffset] * tileWeightV[weightTileOffset];\n      }\n\n      workgroupBarrier();\n    }\n\n    let headOffset = (m * uniforms.N + n) % uniforms.head_size;\n    valueQ += bias[headOffset + biasOffsetQ];\n    valueK += bias[headOffset + biasOffsetK];\n    valueV += bias[headOffset + biasOffsetV];\n\n    let offset = workgroup_id.z * uniforms.M * uniforms.N;\n    if (m < uniforms.M && n < uniforms.N) {\n      let outputIdx = offset + m * uniforms.N + n;\n      output_q[outputIdx] = valueQ;\n      output_k[outputIdx] = valueK;\n      output_v[outputIdx] = valueV;\n    }\n  }`};return e.compute({name:"AttentionPrepare",shaderCache:{inputDependencies:["type","type","type"]},getRunData:()=>({outputs:[{dims:r,dataType:e.inputs[0].dataType,gpuDataType:0},{dims:r,dataType:e.inputs[0].dataType,gpuDataType:0},{dims:r,dataType:e.inputs[0].dataType,gpuDataType:0}],dispatchGroup:l,programUniforms:p}),getShaderSource:h},{inputs:a,outputs:[-1,-1,-1]})},ti=(e,t)=>{let r=Jd(e.inputs,t),[o,n,s]=rl(e,r);return on(e,o,n,s,e.inputs[4],void 0,void 0,void 0,e.inputs[5],r,t)}});var nl,ol,al,ri,ni=q(()=>{"use strict";rr();xe();Le();$e();nl=(e,t)=>{if(!e||e.length!==5)throw new Error("BatchNormalization requires 5 inputs");let r=(o,n,s)=>{let u=n.length;if(u!==o.length)throw new Error(`${s}: num dimensions != ${u}`);n.forEach((l,a)=>{if(l!==o[a])throw new Error(`${s}: dim[${a}] do not match`)})};if(e[0].dims.length>1){let o=t.format==="NHWC"?t.spatial?e[0].dims.slice(-1):e[0].dims.slice(-1).concat(e[0].dims.slice(1,e[0].dims.length-1)):e[0].dims.slice(1,t.spatial?2:void 0);r(e[1].dims,o,"Invalid input scale"),r(e[2].dims,o,"Invalid input B"),r(e[3].dims,o,"Invalid input mean"),r(e[4].dims,o,"Invalid input var")}else r(e[1].dims,[1],"Invalid input scale"),r(e[2].dims,[1],"Invalid input B"),r(e[3].dims,[1],"Invalid input mean"),r(e[4].dims,[1],"Invalid input var")},ol=(e,t)=>{let{epsilon:r,spatial:o,format:n}=t,s=e[0].dims,u=o?He(s[s.length-1]):1,l=n==="NHWC"&&s.length>1?u:1,a=V.size(s)/u,p=Ue(s.length)&&o,h=p?s.length:s,g=U("x",e[0].dataType,e[0].dims,u),w=U("scale",e[1].dataType,e[1].dims,l),v=U("bias",e[2].dataType,e[2].dims,l),y=U("inputMean",e[3].dataType,e[3].dims,l),_=U("inputVar",e[4].dataType,e[4].dims,l),I=K("y",e[0].dataType,h,u),x=()=>{let O="";if(o)O=`let cOffset = ${s.length===1?"0u":n==="NHWC"?`outputIndices[${s.length-1}] / ${u}`:"outputIndices[1]"};`;else if(n==="NCHW")O=`\n            ${I.indicesSet("outputIndices","0","0")}\n            let cOffset = ${I.indicesToOffset("outputIndices")};`;else{O=`var cIndices = ${w.type.indices}(0);\n                       cIndices[0] = outputIndices[${s.length-1}];`;for(let C=1;C<w.rank;C++)O+=`cIndices[${C}] = outputIndices[${C}];`;O+=`let cOffset = ${w.indicesToOffset("cIndices")};`}return O},A=O=>`\n  const epsilon = ${r};\n  ${O.registerUniform("outputSize","u32").declareVariables(g,w,v,y,_,I)}\n  ${O.mainStart()}\n  ${O.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}\n    var outputIndices = ${I.offsetToIndices(`global_idx * ${u}`)};\n    ${x()}\n    let scale = ${w.getByOffset("cOffset")};\n    let bias = ${v.getByOffset("cOffset")};\n    let inputMean = ${y.getByOffset("cOffset")};\n    let inputVar = ${_.getByOffset("cOffset")};\n    let x = ${g.getByOffset("global_idx")};\n    let value = (x - inputMean) * inverseSqrt(inputVar + epsilon) * scale + bias;\n    ${I.setByOffset("global_idx","value")}\n  }`;return{name:"BatchNormalization",shaderCache:{hint:`${t.epsilon}_${t.format}_${o}_${u}`,inputDependencies:p?["rank","type","type","type","type"]:void 0},getShaderSource:A,getRunData:()=>({outputs:[{dims:e[0].dims,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(a/64)},programUniforms:p?[{type:"uint32",data:a},...F(s)]:[{type:"uint32",data:a}]})}},al=e=>he(e),ri=(e,t)=>{let{inputs:r,outputCount:o}=e,n=al({...t,outputCount:o});if(tr.webgpu.validateInputContent&&nl(r,n),t.trainingMode)throw new Error("BatchNormalization trainingMode is not supported yet.");e.compute(ol(r,n))}});var il,sl,oi,ai=q(()=>{"use strict";xe();$e();il=e=>{if(e[0].dims.length!==3)throw new Error("input should have 3 dimensions");if(![320,640,1280].includes(e[0].dims[2]))throw new Error("number of channels should be 320, 640 or 1280");if(e[1].dims.length!==1)throw new Error("bias is expected to have 1 dimensions");if(e[0].dims[2]!==e[1].dims[0])throw new Error("last dimension of input and bias are not the same")},sl=e=>{let t=e[0].dims,r=e[0].dims[2],o=V.size(t)/4,n=e[0].dataType,s=U("input",n,t,4),u=U("bias",n,[r],4),l=U("residual",n,t,4),a=K("output",n,t,4);return{name:"BiasAdd",getRunData:()=>({outputs:[{dims:t,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(o/64)}}),getShaderSource:h=>`\n  const channels = ${r}u / 4;\n  ${h.declareVariables(s,u,l,a)}\n\n  ${h.mainStart()}\n    ${h.guardAgainstOutOfBoundsWorkgroupSizes(o)}\n    let value = ${s.getByOffset("global_idx")}\n      + ${u.getByOffset("global_idx % channels")} + ${l.getByOffset("global_idx")};\n    ${a.setByOffset("global_idx","value")}\n  }`}},oi=e=>{il(e.inputs),e.compute(sl(e.inputs))}});var ul,Ee,ii,si,ui,di,li,ci,pi,mi,fi,dl,hi,gi,yi,bi,an,wi,sn,vi,$i,Si,xi,_i,Ci,Ii,Ai,Ti,Ei,Oi,Pi,Bi,ki,Ri,Di,Mi,Xn=q(()=>{"use strict";We();xe();Le();$e();ul=(e,t,r,o,n,s)=>{let u=Math.ceil(t/4),l="";typeof n=="string"?l=`${n}(a)`:l=n("a");let a=U("inputData",r,[u],4),p=K("outputData",o,[u],4);return`\n      ${e.registerUniform("vec_size","u32").declareVariables(a,p)}\n\n  ${s??""}\n\n  ${e.mainStart()}\n    ${e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.vec_size")}\n\n    let a = ${a.getByOffset("global_idx")};\n    ${p.setByOffset("global_idx",l)}\n  }`},Ee=(e,t,r,o,n,s=e.dataType)=>({name:t,shaderCache:{hint:n,inputDependencies:["type"]},getShaderSource:u=>ul(u,V.size(e.dims),e.dataType,s,r,o),getRunData:u=>({outputs:[{dims:e.dims,dataType:s}],dispatchGroup:{x:Math.ceil(V.size(u[0].dims)/64/4)},programUniforms:[{type:"uint32",data:Math.ceil(V.size(e.dims)/4)}]})}),ii=e=>{e.compute(Ee(e.inputs[0],"Abs","abs"))},si=e=>{e.compute(Ee(e.inputs[0],"Acos","acos"))},ui=e=>{e.compute(Ee(e.inputs[0],"Acosh","acosh"))},di=e=>{e.compute(Ee(e.inputs[0],"Asin","asin"))},li=e=>{e.compute(Ee(e.inputs[0],"Asinh","asinh"))},ci=e=>{e.compute(Ee(e.inputs[0],"Atan","atan"))},pi=e=>{e.compute(Ee(e.inputs[0],"Atanh","atanh"))},mi=e=>he(e),fi=(e,t)=>{let r;switch(t.to){case 10:r="vec4<f16>";break;case 1:r="vec4<f32>";break;case 12:r="vec4<u32>";break;case 6:r="vec4<i32>";break;case 9:r="vec4<bool>";break;default:throw new RangeError(`not supported type (specified in attribute \'to\' from \'Cast\' operator): ${t.to}`)}e.compute(Ee(e.inputs[0],"Cast",r,void 0,t.cacheKey,t.to))},dl=e=>{let t=e.length>=2&&e[1].data!==0?e[1].getFloat32Array()[0]:Xr,r=e.length>=3&&e[2].data!==0?e[2].getFloat32Array()[0]:en;return he({min:t,max:r})},hi=(e,t)=>{let r=e.inputs.length===1?t:dl(e.inputs),o=ft(e.inputs[0].dataType);e.compute(Ee(e.inputs[0],"Clip",n=>`clamp(${n}, clip_min_, clip_max_)`,`\n    const clip_min_: vec4<${o}> = vec4(${o}(${r.min}));\n    const clip_max_: vec4<${o}> = vec4(${o}(${r.max}));\n`,r.cacheKey),{inputs:[0]})},gi=e=>{e.compute(Ee(e.inputs[0],"Ceil","ceil"))},yi=e=>{e.compute(Ee(e.inputs[0],"Cos","cos"))},bi=e=>{e.compute(Ee(e.inputs[0],"Cosh","cosh"))},an=e=>he(e),wi=(e,t)=>{let r=ft(e.inputs[0].dataType);e.compute(Ee(e.inputs[0],"Elu",o=>`elu_vf32(${o})`,`\n  const elu_alpha_ = ${r}(${t.alpha});\n\n  fn elu_f32(a: ${r}) -> ${r} {\n  return select((exp(a) - 1.0) * elu_alpha_, a, a >= 0.0);\n  }\n\n  fn elu_vf32(v: vec4<${r}>) -> vec4<${r}> {\n  return vec4(elu_f32(v.x), elu_f32(v.y), elu_f32(v.z), elu_f32(v.w));\n  }`,t.cacheKey))},sn=(e,t="f32")=>`\nconst r0: ${t} = 0.3275911;\nconst r1: ${t} = 0.254829592;\nconst r2: ${t} = -0.284496736;\nconst r3: ${t} = 1.421413741;\nconst r4: ${t} = -1.453152027;\nconst r5: ${t} = 1.061405429;\n\nfn erf_vf32(v: ${e}) -> ${e} {\n  let absv = abs(v);\n  let x = 1.0 / (1.0 + r0 * absv);\n  return sign(v) * (1.0 - ((((r5 * x + r4) * x + r3) * x + r2) * x + r1) * x * exp(-absv * absv));\n}`,vi=e=>{let t=ft(e.inputs[0].dataType);e.compute(Ee(e.inputs[0],"Erf",r=>`erf_vf32(${r})`,sn(`vec4<${t}>`,t)))},$i=e=>{e.compute(Ee(e.inputs[0],"Exp","exp"))},Si=e=>{e.compute(Ee(e.inputs[0],"Floor","floor"))},xi=e=>{let t=ft(e.inputs[0].dataType);e.compute(Ee(e.inputs[0],"Gelu",r=>`0.5 * ${r} * (1.0 + erf_vf32(${r} * 0.7071067811865475))`,sn(`vec4<${t}>`,t)))},_i=(e,t)=>{let r=ft(e.inputs[0].dataType);e.compute(Ee(e.inputs[0],"LeakyRelu",o=>`select(leaky_relu_alpha_ * ${o}, ${o}, ${o} >= vec4<${r}>(0.0))`,`const leaky_relu_alpha_ = ${r}(${t.alpha});`,t.cacheKey))},Ci=e=>{e.compute(Ee(e.inputs[0],"Not",t=>`!${t}`))},Ii=e=>{e.compute(Ee(e.inputs[0],"Neg",t=>`-${t}`))},Ai=e=>{e.compute(Ee(e.inputs[0],"Reciprocal",t=>`1.0/${t}`))},Ti=e=>{let t=ft(e.inputs[0].dataType);e.compute(Ee(e.inputs[0],"Relu",r=>`select(vec4<${t}>(0.0), ${r}, ${r} > vec4<${t}>(0.0))`))},Ei=e=>{e.compute(Ee(e.inputs[0],"Sigmoid",t=>`(1.0 / (1.0 + exp(-${t})))`))},Oi=e=>{e.compute(Ee(e.inputs[0],"Sin","sin"))},Pi=e=>{e.compute(Ee(e.inputs[0],"Sinh","sinh"))},Bi=e=>{e.compute(Ee(e.inputs[0],"Sqrt","sqrt"))},ki=e=>{e.compute(Ee(e.inputs[0],"Tan","tan"))},Ri=e=>{e.compute(Ee(e.inputs[0],"Tanh","tanh"))},Di=(e,t)=>{let r=ft(e.inputs[0].dataType);return e.compute(Ee(e.inputs[0],"ThresholdedRelu",o=>`select(vec4<${r}>(0.0), ${o}, ${o} > thresholded_relu_alpha_)`,`const thresholded_relu_alpha_ = vec4<${r}>(${t.alpha});`,t.cacheKey)),0},Mi=e=>{e.compute(Ee(e.inputs[0],"Log","log"))}});var cl,pl,Ui,zi=q(()=>{"use strict";xe();$e();Xn();cl=e=>{if(e[0].dims.length!==3)throw new Error("input should have 3 dimensions");if(![2560,5120,10240].includes(e[0].dims[2]))throw new Error("hidden state should be 2560, 5120 or 10240");if(e[1].dims.length!==1)throw new Error("bias is expected to have 1 dimensions");if(e[0].dims[2]!==e[1].dims[0])throw new Error("last dimension of input and bias are not the same")},pl=e=>{let t=e[0].dims.slice();t[2]=t[2]/2;let r=U("input",e[0].dataType,e[0].dims,4),o=U("bias",e[0].dataType,[e[0].dims[2]],4),n=K("output",e[0].dataType,t,4),s=V.size(t)/4,u=Ge(e[0].dataType);return{name:"BiasSplitGelu",getRunData:()=>({outputs:[{dims:t,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(s/64)}}),getShaderSource:a=>`\n  const M_SQRT2 = sqrt(2.0);\n  const halfChannels = ${e[0].dims[2]/4/2}u;\n\n  ${a.declareVariables(r,o,n)}\n\n  ${sn(`vec4<${u}>`,u)}\n\n  ${a.mainStart()}\n    ${a.guardAgainstOutOfBoundsWorkgroupSizes(s)}\n    let biasIdx = global_idx % halfChannels;\n    let batchIndex = global_idx / halfChannels;\n    let inputOffset = biasIdx + batchIndex * halfChannels * 2;\n    let valueLeft = input[inputOffset] + bias[biasIdx];\n    let valueRight = input[inputOffset + halfChannels] + bias[biasIdx + halfChannels];\n    let geluRight = valueRight * 0.5 * (erf_vf32(valueRight / M_SQRT2) + 1);\n\n    ${n.setByOffset("global_idx","valueLeft * geluRight")}\n  }`}},Ui=e=>{cl(e.inputs),e.compute(pl(e.inputs))}});var ml,fl,wt,Vi,Ni,Wi,Gi,Hi,Li,Fi,Ki,qi,ji,Yi=q(()=>{"use strict";We();xe();$e();ml=(e,t,r,o,n,s,u,l,a,p,h,g,w)=>{let v,y;typeof l=="string"?v=y=(D,G)=>`${l}((${D}),(${G}))`:typeof l=="function"?v=y=l:(v=l.scalar,y=l.vector);let _=g?t.length:t,I=g?r.length:r,x=g?o.length:o,A=K("outputData",h,x,4),O=U("aData",a,_,4),C=U("bData",p,I,4),M;if(n)if(s){let D=V.size(t)===1,G=V.size(r)===1,E=t.length>0&&t[t.length-1]%4===0,W=r.length>0&&r[r.length-1]%4===0;D||G?M=A.setByOffset("global_idx",y(D?`${O.type.value}(${O.getByOffset("0")}.x)`:O.getByOffset("global_idx"),G?`${C.type.value}(${C.getByOffset("0")}.x)`:C.getByOffset("global_idx"))):M=`\n            let outputIndices = ${A.offsetToIndices("global_idx * 4u")};\n            let offsetA = ${O.broadcastedIndicesToOffset("outputIndices",A)};\n            let offsetB = ${C.broadcastedIndicesToOffset("outputIndices",A)};\n            ${A.setByOffset("global_idx",y(u||E?O.getByOffset("offsetA / 4u"):`${O.type.value}(${O.getByOffset("offsetA / 4u")}[offsetA % 4u])`,u||W?C.getByOffset("offsetB / 4u"):`${C.type.value}(${C.getByOffset("offsetB / 4u")}[offsetB % 4u])`))}\n          `}else M=A.setByOffset("global_idx",y(O.getByOffset("global_idx"),C.getByOffset("global_idx")));else{if(!s)throw new Error("no necessary to use scalar implementation for element-wise binary op implementation.");let D=(G,E,W="")=>{let te=`aData[indexA${E}][componentA${E}]`,Y=`bData[indexB${E}][componentB${E}]`;return`\n            let outputIndices${E} = ${A.offsetToIndices(`global_idx * 4u + ${E}u`)};\n            let offsetA${E} = ${O.broadcastedIndicesToOffset(`outputIndices${E}`,A)};\n            let offsetB${E} = ${C.broadcastedIndicesToOffset(`outputIndices${E}`,A)};\n            let indexA${E} = offsetA${E} / 4u;\n            let indexB${E} = offsetB${E} / 4u;\n            let componentA${E} = offsetA${E} % 4u;\n            let componentB${E} = offsetB${E} % 4u;\n            ${G}[${E}] = ${W}(${v(te,Y)});\n          `};h===9?M=`\n            var data = vec4<u32>(0);\n            ${D("data",0,"u32")}\n            ${D("data",1,"u32")}\n            ${D("data",2,"u32")}\n            ${D("data",3,"u32")}\n            outputData[global_idx] = dot(vec4<u32>(0x1, 0x100, 0x10000, 0x1000000), vec4<u32>(data));`:M=`\n            ${D("outputData[global_idx]",0)}\n            ${D("outputData[global_idx]",1)}\n            ${D("outputData[global_idx]",2)}\n            ${D("outputData[global_idx]",3)}\n          `}return`\n        ${e.registerUniform("vec_size","u32").declareVariables(O,C,A)}\n\n        ${w??""}\n\n        ${e.mainStart()}\n        ${e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.vec_size")}\n        ${M}\n      }`},fl=(e,t,r,o,n,s,u=r.dataType)=>{let l=!V.areEqual(r.dims,o.dims),a=r.dims,p=V.size(r.dims),h=!1,g=!1,w=[l];if(l){let y=mt.calcShape(r.dims,o.dims,!1);if(!y)throw new Error("Can\'t perform binary op on the given tensors");a=y,p=V.size(a);let _=V.size(r.dims)===1,I=V.size(o.dims)===1,x=r.dims.length>0&&r.dims[r.dims.length-1]%4===0,A=o.dims.length>0&&o.dims[o.dims.length-1]%4===0;w.push(_),w.push(I),w.push(x),w.push(A);let O=1;for(let C=1;C<a.length;C++){let M=r.dims[r.dims.length-C]??1,D=o.dims[o.dims.length-C]??1;if(M===D)O*=M;else break}O%4===0?(g=!0,h=!0):(_||I||x||A)&&(h=!0)}else h=!0;w.push(h);let v=Ue(r.dims.length)&&Ue(o.dims.length)&&Ue(a.length);return{name:e,shaderCache:{hint:t+w.map(y=>y.toString()).join("_"),inputDependencies:v?["rank","rank"]:["dims","dims"]},getShaderSource:y=>ml(y,r.dims,o.dims,a,h,l,g,n,r.dataType,o.dataType,u,v,s),getRunData:()=>({outputs:[{dims:a,dataType:u}],dispatchGroup:{x:Math.ceil(p/64/4)},programUniforms:v?[{type:"uint32",data:Math.ceil(V.size(a)/4)},...F(r.dims),...F(o.dims),...F(a)]:[{type:"uint32",data:Math.ceil(V.size(a)/4)}]})}},wt=(e,t,r,o,n,s)=>{e.compute(fl(t,n??"",e.inputs[0],e.inputs[1],r,o,s))},Vi=e=>{wt(e,"Add",(t,r)=>`${t}+${r}`)},Ni=e=>{wt(e,"Div",(t,r)=>`${t}/${r}`)},Wi=e=>{wt(e,"Equal",{scalar:(t,r)=>`u32(${t}==${r})`,vector:(t,r)=>`vec4<u32>(${t}==${r})`},void 0,void 0,9)},Gi=e=>{wt(e,"Mul",(t,r)=>`${t}*${r}`)},Hi=e=>{let t=U("input",e.inputs[0].dataType,e.inputs[0].dims).type.value;wt(e,"Pow",{scalar:(o,n)=>`pow_custom(${o},${n})`,vector:(o,n)=>`pow_vector_custom(${o},${n})`},`\n    fn pow_custom(a : ${t}, b : ${t}) -> ${t} {\n      if (b == ${t}(0.0)) {\n        return ${t}(1.0);\n      } else if (a < ${t}(0.0) && f32(b) != floor(f32(b))) {\n        return ${t}(pow(f32(a), f32(b))); // NaN\n      }\n      return select(sign(a), ${t}(1.0), round(f32(abs(b) % ${t}(2.0))) != 1.0) * ${t}(${t==="i32"?"round":""}(pow(f32(abs(a)), f32(b))));\n    }\n    fn pow_vector_custom(a : vec4<${t}>, b : vec4<${t}>) -> vec4<${t}> {\n      // TODO: implement vectorized pow\n      return vec4<${t}>(pow_custom(a.x, b.x), pow_custom(a.y, b.y), pow_custom(a.z, b.z), pow_custom(a.w, b.w));\n    }\n      `)},Li=e=>{wt(e,"Sub",(t,r)=>`${t}-${r}`)},Fi=e=>{wt(e,"Greater",{scalar:(t,r)=>`u32(${t}>${r})`,vector:(t,r)=>`vec4<u32>(${t}>${r})`},void 0,void 0,9)},Ki=e=>{wt(e,"Less",{scalar:(t,r)=>`u32(${t}<${r})`,vector:(t,r)=>`vec4<u32>(${t}<${r})`},void 0,void 0,9)},qi=e=>{wt(e,"GreaterOrEqual",{scalar:(t,r)=>`u32(${t}>=${r})`,vector:(t,r)=>`vec4<u32>(${t}>=${r})`},void 0,void 0,9)},ji=e=>{wt(e,"LessOrEqual",{scalar:(t,r)=>`u32(${t}<=${r})`,vector:(t,r)=>`vec4<u32>(${t}<=${r})`},void 0,void 0,9)}});var gl,yl,bl,wl,Zi,Qi,Ji=q(()=>{"use strict";xe();Le();$e();gl=e=>{if(!e||e.length<1)throw new Error("too few inputs");let t=e[0].dataType,r=e[0].dims.length;for(let o of e){if(o.dataType!==t)throw new Error("input tensors should be one type");if(o.dims.length!==r)throw new Error("input tensors should have the same shape")}},yl=(e,t)=>`\n  fn calculateInputIndex(index: u32) -> u32 {\n    let sizeInConcatAxis = array<u32, ${e}u>(${t});\n    for (var i: u32 = 0u; i < ${e}; i += 1u ) {\n      if (index < sizeInConcatAxis[i]) {\n        return i;\n      }\n    }\n    return ${e}u;\n  }`,bl=(e,t)=>{let r=e.length,o=[];for(let n=0;n<r;++n){let s=t.setByOffset("global_idx",e[n].getByIndices("indices"));r===1?o.push(s):n===0?o.push(`if (inputIndex == ${n}u) { ${s} }`):n===r-1?o.push(`else { ${s} }`):o.push(`else if (inputIndex == ${n}) { ${s} }`)}return o.join(`\n`)},wl=(e,t)=>{let r=e[0].dims.slice();if(t>=r.length||t<-1*r.length)throw new Error("axis specified for concat doesn\'t match input dimensionality");let o=t<0?r.length+t:t,n=r.slice(0);for(let C=1;C<e.length;C++){let M=e[C].dims.slice();for(let D=0;D<r.length;D++)if(D===o)n[o]+=M[D];else if(r[D]!==M[D])throw new Error("non concat dimensions must match")}let s=V.size(n),u=new Array(e.length),l=new Array(e.length),a=e[0].dataType,p=0,h=[],g=[],w=[],v=[{type:"uint32",data:s}];for(let C=0;C<e.length;++C)p+=e[C].dims[o],u[C]=p,w.push(Ue(e[C].dims.length)),g.push(w[C]?e[C].dims.length:e[C].dims),l[C]=U(`input${C}`,a,g[C]),h.push(w[C]?"rank":"dims"),v.push({type:"uint32",data:u[C]});for(let C=0;C<e.length;++C)w[C]&&v.push(...F(e[C].dims));let y=Ue(n.length);y&&v.push(...F(n));let _=y?n.length:n,I=K("output",a,_),x=I.indicesGet("indices",o),A=Array.from(Array(u.length).keys()).map(C=>`uniforms.sizeInConcatAxis${C}`).join(","),O=C=>`\n\n  ${(()=>{C.registerUniform("outputSize","u32");for(let M=0;M<e.length;M++)C.registerUniform(`sizeInConcatAxis${M}`,"u32");return C.declareVariables(...l,I)})()}\n\n  ${yl(u.length,A)}\n\n  ${C.mainStart()}\n    ${C.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}\n\n    var indices = ${I.offsetToIndices("global_idx")};\n\n    let inputIndex = calculateInputIndex(${x});\n    if (inputIndex != 0u) {\n      let sizeInConcatAxis = array<u32, ${u.length}u>(${A});\n      ${x} -= sizeInConcatAxis[inputIndex - 1u];\n    }\n\n    ${bl(l,I)}\n  }`;return{name:"Concat",shaderCache:{hint:`${t}`,inputDependencies:h},getRunData:()=>({outputs:[{dims:n,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(s/64)},programUniforms:v}),getShaderSource:O}},Zi=(e,t)=>{gl(e.inputs),e.compute(wl(e.inputs,t.axis))},Qi=e=>he({axis:e.axis})});var vt,un,Bt=q(()=>{"use strict";xe();vt=(e,t)=>{switch(e.activation){case"Relu":return{activationFunction:"",applyActivation:`value = max(value, ${t}(0.0));`};case"Sigmoid":return{activationFunction:"",applyActivation:`value = (${t}(1.0) / (${t}(1.0) + exp(-value)));`};case"Clip":return{activationFunction:`const clip_min_=${t}(${e.clipMin});const clip_max_=${t}(${e.clipMax});`,applyActivation:"value = clamp(value, clip_min_, clip_max_);"};default:return{activationFunction:"",applyActivation:""}}},un=e=>{let t=e?.activation||"";if(t==="Clip"){let[r,o]=e?.activation_params||[Xr,en];return{activation:t,clipMax:o,clipMin:r,activationCacheKey:`${t}:${r},${o}`}}return{activation:t,activationCacheKey:t}}});var qe,dn,ln=q(()=>{"use strict";qe=(e,t)=>{switch(e){case 1:return t;case 2:return`vec2<${t}>`;case 3:return`vec3<${t}>`;case 4:return`vec4<${t}>`;default:throw new Error(`${e}-component is not supported.`)}},dn=e=>`\n      ${e?"value = value + getBiasByOutputCoords(coords);":""}\n      `});var cn,eo=q(()=>{"use strict";cn=e=>`\nfn getIndexFromCoords4D(coords : vec4<i32>, shape : vec4<i32>) -> i32 {\n  return dot(coords, vec4<i32>(\n      shape.y * shape.z * shape.w, shape.z * shape.w, shape.w, 1));\n}\nfn getOutputIndexFromCoords(coords : vec4<i32>) -> i32 {\n  return dot(coords, vec4<i32>(\n    i32(${e}.x), i32(${e}.y), i32(${e}.z), 1));\n}\n`});var vl,$l,Ar,Xi,Sl,Tr,xl,pn,Er=q(()=>{"use strict";xe();$e();Bt();ln();vl=(e,t)=>e?`\n        mm_Asub[inputRow][inputCol] = mm_readA(batch,\n          kStart + inputRow,\n          globalRowStart / innerElementSize + inputCol${t?", batchIndices":""});\n        `:`\n        mm_Asub[inputRow][inputCol] = mm_readA(batch,\n          globalRow + innerRow,\n          kStart / innerElementSize + inputCol${t?", batchIndices":""});\n        `,$l=(e,t)=>e?`\n        let ACached0 = mm_Asub[k * innerElementSize][localRow];\n        let ACached1 = mm_Asub[k * innerElementSize + 1][localRow];\n        let ACached2 = mm_Asub[k * innerElementSize + 2][localRow];\n        ${t===3?"":"let ACached3 = mm_Asub[k * innerElementSize + 3][localRow];"}\n        for (var i = 0; i < rowPerThread; i = i + 1) {\n          acc[i] = BCached0 * ACached0[i] + acc[i];\n          acc[i] = BCached1 * ACached1[i] + acc[i];\n          acc[i] = BCached2 * ACached2[i] + acc[i];\n          ${t===3?"":"acc[i] = BCached3 * ACached3[i] + acc[i];"}\n        }`:`\n        for (var i = 0; i < rowPerThread; i = i + 1) {\n          let ACached = mm_Asub[tileRow + i][k];\n          acc[i] = BCached0 * ACached.x + acc[i];\n          acc[i] = BCached1 * ACached.y + acc[i];\n          acc[i] = BCached2 * ACached.z + acc[i];\n          ${t===3?"":"acc[i] = BCached3 * ACached.w + acc[i];"}\n        }`,Ar=(e,t,r="f32",o,n=!1,s=32,u=!1,l=32)=>{let a=t[1]*e[1],p=t[0]*e[0],h=n?a:s,g=n?s:a,w=h/t[0],v=s/t[1];if(!((n&&w===4&&e[1]===4||!n&&(w===3||w===4))&&h%t[0]===0&&s%t[1]===0&&e[0]===4))throw new Error(`If transposeA ${n} is true, innerElementSize ${w} and workPerThread[1] ${e[1]} must be 4.\n      Otherwise, innerElementSize ${w} must be 3 or 4.\n  tileAWidth ${h} must be divisible by workgroupSize[0]${t[0]}. tileInner ${s} must be divisible by workgroupSize[1] ${t[1]}. colPerThread ${e[0]} must be 4.`);return`\nvar<workgroup> mm_Asub: array<array<vec${w}<${r}>, ${h/w}>, ${g}>;\nvar<workgroup> mm_Bsub: array<array<vec4<${r}>, ${p/e[0]}>, ${s}>;\n\nconst rowPerThread = ${e[1]};\nconst colPerThread = ${e[0]};\nconst innerElementSize = ${w};\nconst tileInner = ${s};\n\n@compute @workgroup_size(${t[0]}, ${t[1]}, ${t[2]})\nfn main(@builtin(local_invocation_id) localId : vec3<u32>,\n        @builtin(global_invocation_id) globalId : vec3<u32>,\n        @builtin(workgroup_id) workgroupId : vec3<u32>) {\n  let localRow = i32(localId.y);\n  let tileRow = localRow * rowPerThread;\n  let tileCol = i32(localId.x);\n\n  let globalRow =i32(globalId.y) * rowPerThread;\n  let globalCol = i32(globalId.x);\n  let batch = ${u?"0":"i32(globalId.z)"};\n  ${o?`let batchIndices = ${o.offsetToIndices("u32(batch)")};`:""}\n  let globalRowStart = i32(workgroupId.y) * ${a};\n\n  let numTiles = ${u?`${Math.ceil(l/s)}`:"(uniforms.dimInner - 1) / tileInner + 1"};\n  var kStart = ${u?`i32(globalId.z) * ${l}`:"0"};\n\n  var acc: array<vec4<${r}>, rowPerThread>;\n\n  // Loop over shared dimension.\n  let tileRowB = localRow * ${v};\n  for (var t = 0; t < numTiles; t = t + 1) {\n      // Load one tile of A into local memory.\n      for (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {\n          let inputRow = tileRow + innerRow;\n          let inputCol = tileCol;\n          ${vl(n,o)}\n      }\n\n      // Load one tile of B into local memory.\n      for (var innerRow = 0; innerRow < ${v}; innerRow = innerRow + 1) {\n          let inputRow = tileRowB + innerRow;\n          let inputCol = tileCol;\n          mm_Bsub[inputRow][inputCol] = mm_readB(batch, kStart + inputRow, globalCol${o?", batchIndices":""});\n      }\n      kStart = kStart + tileInner;\n      workgroupBarrier();\n\n      // Compute acc values for a single thread.\n      for (var k = 0; k < tileInner / innerElementSize; k = k + 1) {\n          let BCached0 = mm_Bsub[k * innerElementSize][tileCol];\n          let BCached1 = mm_Bsub[k * innerElementSize + 1][tileCol];\n          let BCached2 = mm_Bsub[k * innerElementSize + 2][tileCol];\n          ${w===3?"":"let BCached3 = mm_Bsub[k * innerElementSize + 3][tileCol];"}\n\n          ${$l(n,w)}\n      }\n\n      workgroupBarrier();\n  }\n\n  for (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {\n      mm_write(batch, globalRow + innerRow, globalCol, acc[innerRow]);\n  }\n}`},Xi=(e,t)=>e?`\n            mm_Asub[inputRow][inputCol] = mm_readA(batch,\n              kStart + inputRow,\n              globalRowStart + inputCol${t?", batchIndices":""});\n            `:`\n            mm_Asub[inputRow][inputCol] = mm_readA(batch,\n              globalRowStart + inputRow,\n              kStart + inputCol${t?", batchIndices":""});\n            `,Sl=e=>e?"let ACached = mm_Asub[k][tileRow + innerRow];":"let ACached = mm_Asub[tileRow + innerRow][k];",Tr=(e,t,r="f32",o,n=!1,s=32,u=!1,l=32,a=!1)=>{let p=e[1]*t[1],h=e[0]*t[0],g=n?p:s,w=n?s:p;if(!(w%t[1]===0&&g%t[0]===0&&s%t[1]===0))throw new Error(`tileAHight ${w} must be divisible by workgroupSize[1]${t[1]}, tileAWidth ${g} must be divisible by workgroupSize[0]${t[0]}, tileInner ${s} must be divisible by workgroupSize[1]${t[1]}`);let v=w/t[1],y=g/t[0],_=s/t[1],I=a?`\n    let localRow = i32(localId.y);\n    let localCol = i32(localId.x);\n    let globalRowStart = i32(workgroupId.y) * ${p};\n    let globalColStart = i32(workgroupId.x) * ${h};\n\n    // Loop over shared dimension.\n    for (var t = 0; t < numTiles; t = t + 1) {\n      // Load one tile of A into local memory.\n      for (var inputRow = localRow; inputRow < ${w}; inputRow = inputRow + ${t[1]}) {\n        for (var inputCol = localCol; inputCol < ${g}; inputCol = inputCol + ${t[0]}) {\n          ${Xi(n,o)}\n        }\n      }\n      // Load one tile of B into local memory.\n      for (var inputRow = localRow; inputRow < ${s}; inputRow = inputRow + ${t[1]}) {\n            for (var inputCol = localCol; inputCol < ${h}; inputCol = inputCol + ${t[0]}) {\n          mm_Bsub[inputRow][inputCol] = mm_readB(batch,\n            kStart + inputRow,\n            globalColStart + inputCol${o?", batchIndices":""});\n        }\n      }\n      kStart = kStart + tileInner;\n      workgroupBarrier();\n\n      // Compute acc values for a single thread.\n      var BCached : array<${r}, colPerThread>;\n      for (var k = 0; k < tileInner; k = k + 1) {\n        for (var inner = 0; inner < colPerThread; inner = inner + 1) {\n          BCached[inner] = mm_Bsub[k][localCol + inner * ${t[0]}];\n        }\n        for (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {\n          let ACached = ${n?`mm_Asub[k][localRow + innerRow * ${t[1]}];`:`mm_Asub[localRow + innerRow * ${t[1]}][k];`}\n          for (var innerCol = 0; innerCol < colPerThread; innerCol = innerCol + 1) {\n            acc[innerRow][innerCol] = acc[innerRow][innerCol] +\n                ACached * BCached[innerCol];\n          }\n        }\n      }\n      workgroupBarrier();\n    }\n    for (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {\n      let gRow = globalRowStart + localRow + innerRow * ${t[1]};\n      for (var innerCol = 0; innerCol < colPerThread; innerCol = innerCol + 1) {\n        let gCol = globalColStart + localCol + innerCol * ${t[0]};\n        mm_write(batch, gRow, gCol, acc[innerRow][innerCol]);\n      }\n    }\n    `:`\nlet tileRow = i32(localId.y) * rowPerThread;\nlet tileCol = i32(localId.x) * colPerThread;\n\nlet globalRow = i32(globalId.y) * rowPerThread;\nlet globalCol = i32(globalId.x) * colPerThread;\nlet globalRowStart = i32(workgroupId.y) * ${p};\n\nlet tileRowA = i32(localId.y) * ${v};\nlet tileColA = i32(localId.x) * ${y};\nlet tileRowB = i32(localId.y) * ${_};\n// Loop over shared dimension.\nfor (var t = 0; t < numTiles; t = t + 1) {\n  // Load one tile of A into local memory.\n  for (var innerRow = 0; innerRow < ${v}; innerRow = innerRow + 1) {\n    for (var innerCol = 0; innerCol < ${y}; innerCol = innerCol + 1) {\n      let inputRow = tileRowA + innerRow;\n      let inputCol = tileColA + innerCol;\n      ${Xi(n,o)}\n    }\n  }\n\n  // Load one tile of B into local memory.\n  for (var innerRow = 0; innerRow < ${_}; innerRow = innerRow + 1) {\n    for (var innerCol = 0; innerCol < colPerThread; innerCol = innerCol + 1) {\n      let inputRow = tileRowB + innerRow;\n      let inputCol = tileCol + innerCol;\n      mm_Bsub[inputRow][inputCol] = mm_readB(batch,\n        kStart + inputRow,\n        globalCol + innerCol${o?", batchIndices":""});\n    }\n  }\n  kStart = kStart + tileInner;\n  workgroupBarrier();\n\n  // Compute acc values for a single thread.\n  var BCached : array<${r}, colPerThread>;\n  for (var k = 0; k < tileInner; k = k + 1) {\n    for (var inner = 0; inner < colPerThread; inner = inner + 1) {\n      BCached[inner] = mm_Bsub[k][tileCol + inner];\n    }\n\n    for (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {\n      ${Sl(n)}\n      for (var innerCol = 0; innerCol < colPerThread; innerCol = innerCol + 1) {\n        acc[innerRow][innerCol] = acc[innerRow][innerCol] + ACached * BCached[innerCol];\n      }\n    }\n  }\n\n  workgroupBarrier();\n}\n\nfor (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {\n  for (var innerCol = 0; innerCol < colPerThread; innerCol = innerCol + 1) {\n    mm_write(batch, globalRow + innerRow, globalCol + innerCol,\n        acc[innerRow][innerCol]);\n  }\n}\n`;return`\n  var<workgroup> mm_Asub : array<array<${r}, ${g}>, ${w}>;\n  var<workgroup> mm_Bsub : array<array<${r}, ${h}>, ${s}>;\n  const rowPerThread = ${e[1]};\n  const colPerThread = ${e[0]};\n  const tileInner = ${s};\n\n@compute @workgroup_size(${t[0]}, ${t[1]}, ${t[2]})\nfn main(@builtin(local_invocation_id) localId : vec3<u32>,\n        @builtin(global_invocation_id) globalId : vec3<u32>,\n        @builtin(workgroup_id) workgroupId : vec3<u32>) {\n    let batch = ${u?"0":"i32(globalId.z)"};\n    ${o?`let batchIndices = ${o.offsetToIndices("u32(batch)")};`:""}\n    let numTiles = ${u?`${Math.ceil(l/s)}`:"(uniforms.dimInner - 1) / tileInner + 1"};\n    var kStart = ${u?`i32(globalId.z) * ${l}`:"0"};\n\n    var acc : array<array<${r}, colPerThread>, rowPerThread>;\n\n    // Without this initialization strange values show up in acc.\n    for (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {\n      for (var innerCol = 0; innerCol < colPerThread; innerCol = innerCol + 1) {\n        acc[innerRow][innerCol] = 0.0;\n      }\n    }\n    ${I}\n  }\n`},xl=(e,t,r,o,n,s=!1)=>{let[u,l,a]=n,[p,h,g,w]=o,v=nr(u,a),y=nr(l,a),_=Ge(o[0].type.tensor),I=()=>{let O=h.rank,C=p.rank,M=`var aIndices: ${h.type.indices};`;for(let D=O-2-1,G=C-1;D>=0;D--,G--)M+=`\naIndices[${D}] = ${C>1?`batchIndices[${G}]`:"batchIndices"};`;return v.forEach(D=>{M+=`\naIndices[${D}] = 0;`}),M+=`\naIndices[${O-2}] = u32(row);\n                   aIndices[${O-1}] = u32(colIn);`,M},x=()=>{let O=g.rank,C=p.rank,M=`var bIndices: ${g.type.indices};`;for(let D=O-2-1,G=C-1;D>=0;D--,G--)M+=`\nbIndices[${D}] = ${C>1?`batchIndices[${G}]`:"batchIndices"};`;return y.forEach(D=>{M+=`\nbIndices[${D}] = 0;`}),M+=`\nbIndices[${O-2}] = u32(row);\n                   bIndices[${O-1}] = u32(colIn);`,M};return`\n    fn mm_readA(batch: i32, row: i32, colIn: i32, batchIndices: ${p.type.indices}) -> ${qe(e,_)} {\n      var value = ${qe(e,_)}(0.0);\n      let col = colIn * ${e};\n      if(row < uniforms.dimAOuter && col < uniforms.dimInner)\n      {\n        ${I()}\n        value = ${h.getByIndices("aIndices")};\n      }\n      return value;\n    }\n\n    fn mm_readB(batch: i32, row: i32, colIn: i32, batchIndices: ${p.type.indices}) -> ${qe(e,_)} {\n      var value = ${qe(e,_)}(0.0);\n      let col = colIn * ${e};\n      if(row < uniforms.dimInner && col < uniforms.dimBOuter)\n      {\n        ${x()}\n        value = ${g.getByIndices("bIndices")};\n      }\n      return value;\n    }\n\n    fn mm_write(batch: i32, row: i32, colIn: i32, valueIn: ${qe(e,_)}) {\n      let col = colIn * ${e};\n      if (row < uniforms.dimAOuter && col < uniforms.dimBOuter) {\n        var value = valueIn;\n        let coords = vec3<i32>(batch, row, colIn);\n        ${t?`value = value + ${s?"bias[colIn]":`${qe(e,_)}(bias[row])`};`:""}\n        ${r}\n        ${w.setByIndices("vec3<u32>(coords)","value")}\n      }\n    }\n    `},pn=(e,t,r,o,n=!1)=>{let s=e[0].dims,u=e[1].dims,l=s.slice(0,-2),a=u.slice(0,-2),p=o?o.slice(0,-2):r.slice(0,-2),h=Ue(p.length),g=h?p.length:p,w=tn("batchDims",e[0].dataType,g,1),v=V.size(p),y=s[s.length-2],_=s[s.length-1],I=u[u.length-1],x=_%4===0&&I%4===0,A=y<=8?[4,1,1]:[4,4,1],O=[8,8,1],C=[Math.ceil(I/O[0]/A[0]),Math.ceil(y/O[1]/A[1]),Math.ceil(v/O[2]/A[2])],M=Ge(e[0].dataType),D=x?4:1,G=[...l,y,_/D],E=Ue(G.length),W=E?G.length:G,te=[...a,_,I/D],Y=Ue(te.length),Z=Y?te.length:te,ee=[v,y,I/D],Te=U("a",e[0].dataType,W,D),De=U("b",e[1].dataType,Z,D),re=K("result",e[0].dataType,ee.length,D),Ie=[Te,De],Oe=[{type:"int32",data:y},{type:"int32",data:I},{type:"int32",data:_}];h&&Oe.push(...F(p)),E&&Oe.push(...F(G)),Y&&Oe.push(...F(te));let ie=[];ie.push(E?"rank":"dims"),ie.push(Y?"rank":"dims");let Se=e.length>2,{activationFunction:Ae,applyActivation:Pe}=vt(t,re.type.value),Fe=xl(D,Se,Pe,[w,Te,De,re],[l,a,p],n);if(Se){let J=n?D:1;Ie.push(U("bias",e[2].dataType,e[2].dims.length,J)),Oe.push(...F(e[2].dims)),ie.push("rank")}Oe.push(...F(ee));let H=J=>`\n  ${J.registerUniform("dimAOuter","i32").registerUniform("dimBOuter","i32").registerUniform("dimInner","i32").registerInternalVariables(w).declareVariables(...Ie,re)}\n  ${Ae}\n  ${Fe}\n  ${x?Ar(A,O,M,w):Tr(A,O,M,w)}\n                   `;return{name:"MatMul",shaderCache:{hint:t.activationCacheKey+`${A}${x}${n}`,inputDependencies:ie},getRunData:()=>({outputs:[{dims:r,dataType:e[0].dataType}],dispatchGroup:{x:C[0],y:C[1],z:C[2]},programUniforms:Oe}),getShaderSource:H}}});var _l,es,ts=q(()=>{"use strict";Pt();$e();Bt();ln();eo();Er();_l=(e,t,r,o,n=!1,s,u=4,l=4,a=4,p="f32")=>{let h=Y=>{switch(Y){case 1:return"resData = x[xIndex];";case 3:return`resData = vec3<${p}>(x[xIndex], x[xIndex + 1], x[xIndex + 2]);`;case 4:return"resData = x[xIndex / 4];";default:throw new Error(`innerElementSize ${Y} is not supported.`)}},g=Y=>{switch(Y){case 1:return"return w[row * i32(uniforms.w_shape[3]) + colIn];";case 4:return"return w[row * i32(uniforms.w_shape[3]) / 4 + colIn];";default:throw new Error(`innerElementSize ${Y} is not supported.`)}},w=e?`\n    let coord = vec4<i32>(batch, xRow, xCol, xCh);\n    `:`\n    let coord = vec4<i32>(batch, xCh, xRow, xCol);\n    `,v=e?`\n    let coords = vec4<i32>(\n      batch,\n      row / outWidth,\n      row % outWidth,\n      col);\n    `:`\n    let coords = vec4<i32>(\n      batch,\n      row,\n      col / outWidth,\n      col % outWidth);\n    `,y=e?"i32(uniforms.x_shape[1])":"i32(uniforms.x_shape[2])",_=e?"i32(uniforms.x_shape[2])":"i32(uniforms.x_shape[3])",I=e?"row":"col",x=e?"col":"row",A=`\n    let inChannels = i32(uniforms.w_shape[2]);\n    let outWidth = ${e?"i32(uniforms.result_shape[2])":"i32(uniforms.result_shape[3])"};\n    let outRow = ${I} / outWidth;\n    let outCol = ${I} % outWidth;\n\n    let WRow = ${x} / (filterDims[1] * inChannels);\n    let WCol = ${x} / inChannels % filterDims[1];\n    let xRow = outRow * stride[0] + dilation[0] * WRow - pad[0];\n    let xCol = outCol * stride[1] + dilation[1] * WCol - pad[1];\n    let xCh = ${x} % inChannels;\n    var resData = ${qe(u,p)}(0.0);\n    // The bounds checking is always needed since we use it to pad zero for\n    // the \'same\' padding type.\n    if (xRow >= 0 && xRow < ${y} && xCol >= 0 && xCol < ${_}) {\n      ${w}\n      let xIndex = getIndexFromCoords4D(coord, vec4<i32>(uniforms.x_shape));\n      ${h(u)}\n    }\n    return resData;`,O=e?t&&o?`\n    let col = colIn * ${u};\n    ${A}`:`\n    let col = colIn * ${u};\n    if (row < uniforms.dimAOuter && col < uniforms.dimInner) {\n      ${A}\n    }\n    return ${qe(u,p)}(0.0);`:o&&r?`\n    let col = colIn * ${u};\n    ${A}`:`\n    let col = colIn * ${u};\n    if (row < uniforms.dimInner && col < uniforms.dimBOuter) {\n      ${A}\n    }\n    return ${qe(u,p)}(0.0);`,C=`${g(l)}`,M=qe(a,p),D=e?qe(u,p):qe(l,p),G=e?qe(l,p):qe(u,p),{activationFunction:E,applyActivation:W}=vt(s,M);return`\n    ${E}\n    fn mm_readA(batch: i32, row : i32, colIn : i32) -> ${D} {\n      ${e?O:C}\n    }\n\n    fn mm_readB(batch: i32, row : i32, colIn : i32) -> ${G} {\n      ${e?C:O}\n    }\n\n    fn mm_write(batch: i32, row : i32, colIn : i32, valueIn : ${M}) {\n      let col = colIn * ${a};\n      if (row < uniforms.dimAOuter && col < uniforms.dimBOuter)\n      {\n      var value = valueIn;\n      let outWidth = ${e?"i32(uniforms.result_shape[2])":"i32(uniforms.result_shape[3])"};\n      ${v}\n      ${dn(n)}\n      ${W}\n      setOutputAtCoords(coords[0], coords[1], coords[2], coords[3], value);\n      }\n    }`},es=(e,t,r,o,n,s,u,l)=>{let a=t.format==="NHWC",p=a?e[0].dims[3]:e[0].dims[1],h=r[0],g=a?r[2]:r[3],w=a?r[1]:r[2],v=a?r[3]:r[1],y=a&&(p%4===0||p%3===0)&&v%4===0,_=a?v:g*w,I=a?g*w:v,x=[8,8,1],A=o<=8?[4,1,1]:[4,4,1],O=[Math.ceil(_/x[0]/A[0]),Math.ceil(I/x[1]/A[1]),Math.ceil(h/x[2]/A[2])];Re("verbose",()=>`[conv2d_mm_webgpu] dispatch = ${O}`);let C=y?a&&p%4!==0?3:4:1,M=x[1]*A[1],D=x[0]*A[0],G=Math.max(x[0]*C,x[1]),E=o%M===0,W=n%D===0,te=s%G===0,Y=y?[C,4,4]:[1,1,1],Z=Ge(e[0].dataType),ee=y?4:1,Te=[{type:"int32",data:o},{type:"int32",data:n},{type:"int32",data:s}],De=U("x",e[0].dataType,e[0].dims.length,C===3?1:C),re=U("w",e[1].dataType,e[1].dims.length,ee),Ie=[De,re];Te.push(...F(e[0].dims)),Te.push(...F(e[1].dims));let Oe=`\n      fn setOutputAtIndex(flatIndex : i32, value : ${y?`vec4<${Z}>`:Z}) {\n        result[flatIndex] = ${y?`vec4<${Z}>`:Z}(value);\n      }\n      fn setOutputAtCoords(d0 : i32, d1 : i32, d2 : i32, d3 : i32, value : ${y?`vec4<${Z}>`:Z}) {\n        let flatIndex = getOutputIndexFromCoords(vec4<i32>(d0, d1, d2, d3));\n        setOutputAtIndex(flatIndex ${y?"/ 4":""}, value);\n      }`;if(u){let Se=U("bias",e[2].dataType,e[2].dims.length,ee);Ie.push(Se),Te.push(...F(e[2].dims)),Oe+=`\n        fn getBiasByOutputCoords(coords : vec4<i32>) -> ${y?`vec4<${Z}>`:Z} {\n          return bias[coords.${a?"w":"y"}${y?"/ 4":""}];\n        }`}let ie=K("result",e[0].dataType,r.length,ee);return Te.push(...F(r)),{name:"Conv2DMatMul",shaderCache:{hint:t.cacheKey},getRunData:()=>({outputs:[{dims:r,dataType:e[0].dataType}],dispatchGroup:{x:O[0],y:O[1],z:O[2]},programUniforms:Te}),getShaderSource:Se=>`\n        ${cn("uniforms.result_strides")}\n        //struct Uniforms { xShape : vec4<i32>, wShape : vec4<i32>, outShape : vec4<i32>,\n        //  outShapeStrides: vec3<i32>, filterDims : vec2<i32>, pad : vec2<i32>, stride : vec2<i32>,\n        //  dilation : vec2<i32>, dimAOuter : i32, dimBOuter : i32, dimInner : i32 };\n        ${Se.registerUniform("dimAOuter","i32").registerUniform("dimBOuter","i32").registerUniform("dimInner","i32").declareVariables(...Ie,ie)}\n        const filterDims : vec2<i32> = vec2<i32>(${t.kernelShape[0]}, ${t.kernelShape[1]});\n        const pad : vec2<i32> = vec2<i32>(${t.pads[0]}, ${t.pads[1]});\n        const stride : vec2<i32> = vec2<i32>(${t.strides[0]}, ${t.strides[1]});\n        const dilation : vec2<i32> = vec2<i32>(${t.dilations[0]}, ${t.dilations[1]});\n        ${Oe}\n        ${_l(a,E,W,te,u,t,Y[0],Y[1],Y[2],Z)}\n            ${y?Ar(A,x,Z,void 0,!a,G):Tr(A,x,Z,void 0,!a,G,!1,void 0,l)}`}}});var to,rs=q(()=>{"use strict";xe();$e();no();Bt();to=(e,t,r)=>{let o=e.length>2,n=o?"value += b[output_channel];":"",s=e[0].dims,u=e[1].dims,l=u[0]/t.group,a=t.format==="NHWC",p=ro(s,u,t.dilations,t.pads,t.strides,a),h=V.size(p),g=K("output",e[0].dataType,p),{activationFunction:w,applyActivation:v}=vt(t,g.type.value),y=U("x",e[0].dataType,s),_=U("w",e[1].dataType,u),I=[y,_];o&&I.push(U("b",e[2].dataType,e[2].dims));let x=A=>`\n  const strides: vec2<u32> = vec2(${t.strides[0]}u, ${t.strides[1]}u);\n  const pads: vec2<u32> = vec2(${t.pads[0]}u, ${t.pads[1]}u);\n\n  ${A.declareVariables(...I,g)}\n\n  ${w}\n\n  ${A.mainStart()}\n    ${A.guardAgainstOutOfBoundsWorkgroupSizes(h)}\n\n    let outputIndices = ${g.offsetToIndices("global_idx")};\n    let batch: u32 = outputIndices[0];\n    let output_channel: u32 = outputIndices[${a?3:1}];\n    let xRCCorner: vec2<u32> = vec2<u32>(outputIndices[${a?1:2}], outputIndices[${a?2:3}]) * strides - pads;\n    let group_id: u32 = output_channel / ${l}u;\n\n    var value: ${g.type.value} = ${g.type.value}(0);\n    for (var wInChannel: u32 = 0u; wInChannel < ${u[1]}u; wInChannel++) {\n      let input_channel = group_id * ${u[1]}u + wInChannel;\n      for (var wHeight: u32 = 0u; wHeight < ${u[2]}u; wHeight++) {\n        let xHeight = xRCCorner.x + wHeight * ${t.dilations[0]}u;\n\n        if (xHeight < 0u || xHeight >= ${s[a?1:2]}u) {\n          continue;\n        }\n\n        for (var wWidth: u32 = 0u; wWidth < ${u[3]}u; wWidth++) {\n          let xWidth = xRCCorner.y + wWidth * ${t.dilations[1]}u;\n          if (xWidth < 0u || xWidth >= ${s[a?2:3]}u) {\n            continue;\n          }\n\n          let xVal = ${a?y.get("batch","xHeight","xWidth","input_channel"):y.get("batch","input_channel","xHeight","xWidth")};\n          let wVal = ${_.get("output_channel","wInChannel","wHeight","wWidth")};\n          value += xVal*wVal;\n        }\n      }\n    }\n    ${n}\n    ${v}\n    ${g.setByOffset("global_idx","value")}\n  }`;return{name:"GroupedConv",shaderCache:{hint:t.cacheKey},getRunData:()=>({outputs:[{dims:r?r(p):p,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(h/64)}}),getShaderSource:x}}});var oo,Cl,ns,ao=q(()=>{"use strict";xe();Er();$e();Bt();oo=(e,t,r,o,n=!1)=>{let s=e[0].dims,u=e[1].dims,l=s[s.length-2],a=u[u.length-1],p=s[s.length-1],h=He(a),g=He(p),w=He(l),v=V.size(r)/h/w,y=e.length>2,_=o?o.slice(0,-2):r.slice(0,-2),x=[V.size(_),l,a],A=[{type:"uint32",data:v},{type:"uint32",data:l},{type:"uint32",data:a},{type:"uint32",data:p},...F(_),...F(s),...F(u)];y&&A.push(...F(e[2].dims)),A.push(...F(x));let O=C=>{let M=tn("batch_dims",e[0].dataType,_.length),D=U("a",e[0].dataType,s.length,g),G=U("b",e[1].dataType,u.length,h),E=K("output",e[0].dataType,x.length,h),{activationFunction:W,applyActivation:te}=vt(t,E.type.value),Y=[D,G],Z="";if(y){let ie=n?h:1;Y.push(U("bias",e[2].dataType,e[2].dims.length,ie)),Z=`${n?`value += bias[col / ${ie}];`:`value += ${E.type.value}(bias[row + i]);`}`}let ee=s.slice(0,-2),Te=u.slice(0,-2),De=nr(ee,_),re=nr(Te,_),Ie=(ie,Se)=>{let Ae=ie.rank,Pe=ie.name;if(Ae===2)return`var ${Pe}_indices = ${ie.type.indices}(0u, 0u);`;let Fe=M.rank,H=`var ${Pe}_indices: ${ie.type.indices};`;for(let J=Ae-2-1,Ce=Fe-1;J>=0;J--,Ce--)H+=`\n${Pe}_indices[${J}] = ${Fe>1?`batch_indices[${Ce}]`:"batch_indices"};`;return Se.forEach(J=>{H+=`\n${Pe}_indices[${J}] = 0;`}),H+=`${Pe}_indices[${Ae-2}] = 0u;\n                     ${Pe}_indices[${Ae-1}] = 0u;`,H},Oe=()=>{let ie=`var a_data: ${D.type.value};`;for(let Se=0;Se<g;Se++)ie+=`\n              let b_data${Se} = b[(b_offset + (k + ${Se}) * uniforms.N + col) / ${h}];`;for(let Se=0;Se<w;Se++){ie+=`a_data = a[(a_offset + (row + ${Se}) * uniforms.K + k) / ${g}];`;for(let Ae=0;Ae<g;Ae++)ie+=`\n            values[${Se}] = fma(${G.type.value}(a_data${g===1?"":`[${Ae}]`}), b_data${Ae}, values[${Se}]);\n`}return ie};return`\n  ${C.registerUniform("outputSize","u32").registerUniform("M","u32").registerUniform("N","u32").registerUniform("K","u32").registerInternalVariables(M).declareVariables(...Y,E)}\n  ${W}\n  ${C.mainStart()}\n    ${C.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}\n    let col = (global_idx % (uniforms.N / ${h})) * ${h};\n    var index1 = global_idx / (uniforms.N / ${h});\n    let stride1 = uniforms.M / ${w};\n    let row = (index1 % stride1) * ${w};\n    let batch = index1 / stride1;\n\n    ${r.length===2?"":`let batch_indices = ${M.offsetToIndices("batch")};`}\n    ${Ie(D,De)}\n    let a_offset = ${D.indicesToOffset("a_indices")};\n    ${Ie(G,re)}\n    let b_offset = ${G.indicesToOffset("b_indices")};\n    var values: array<${E.type.value}, ${w}>;\n    for (var k: u32 = 0u; k < uniforms.K; k = k + ${g}) {\n      ${Oe()}\n    }\n    for (var i = 0u; i < ${w}u; i++) {\n      var value = values[i];\n      ${Z}\n      ${te}\n      let cur_indices = ${E.type.indices}(batch, row + i, col);\n      let offset = ${E.indicesToOffset("cur_indices")};\n      ${E.setByOffset(`offset / ${h}`,"value")};\n    }\n  }\n  `};return{name:"MatMulNaive",shaderCache:{hint:`${t.activationCacheKey}_${h}_${g}_${w}_${n}`,inputDependencies:y?["rank","rank","rank"]:["rank","rank"]},getRunData:()=>({outputs:[{dims:r,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(v/64)},programUniforms:A}),getShaderSource:O}},Cl=e=>{if(!e||e.length!==2)throw new Error("MatMul requires 2 inputs.");if(e[0].dims[e[0].dims.length-1]!==e[1].dims[e[1].dims.length-2])throw new Error("shared dimension does not match.")},ns=e=>{Cl(e.inputs);let t=mt.calcShape(e.inputs[0].dims,e.inputs[1].dims,!0);if(!t)throw new Error("Can\'t use matmul on the given tensors");let r=t[t.length-1],o=e.inputs[0].dims[e.inputs[0].dims.length-1];r<8&&o<8?e.compute(oo(e.inputs,{activation:"",activationCacheKey:""},t)):e.compute(pn(e.inputs,{activation:"",activationCacheKey:""},t))}});var ro,os,Il,as,io,Al,Tl,so,no=q(()=>{"use strict";xe();Le();ts();Er();rs();Bt();ao();or();ro=(e,t,r,o,n,s)=>{let u=e[0],l=e.slice(s?1:2,s?3:4),a=l.length,p=t[0],g=t.slice(2).map((y,_)=>y+(y-1)*(r[_]-1)),v=l.map((y,_)=>y+o[_]+o[_+a]).map((y,_)=>Math.floor((y-g[_]+n[_])/n[_]));return v.splice(0,0,u),v.splice(s?3:1,0,p),v},os=[2,3,1,0],Il=(e,t)=>{if(!e||e.length!==2&&e.length!==3)throw new Error("Conv requires 2 or 3 inputs");if(e[0].dims.length!==4&&e[0].dims.length!==3)throw new Error("currently only support conv 1D and 2D");if(e[0].dims.length!==e[1].dims.length)throw new Error("filter does not have same dimension as input");let r=e[0].dims[t.format==="NHWC"?e[0].dims.length-1:1],o=e[1].dims[1]*t.group;if(r!==o)throw new Error("FILTER_IN_CHANNEL should be equal to DATA_CHANNEL");if(e.length===3&&(e[2].dims.length!==1||e[1].dims[0]!==e[2].dims[0]))throw new Error("invalid bias");let n=e[0].dims.length-2;if(t.dilations.length!==n)throw new Error(`dilations should be ${n}D`);if(t.strides.length!==n)throw new Error(`strides should be ${n}D`);if(t.pads.length!==n*2)throw new Error(`pads should be ${n*2}D`);if(t.kernelShape.length!==0&&t.kernelShape.length!==e[1].dims.length-2)throw new Error("invalid kernel shape")},as=(e,t)=>{let r=e.kernelShape.slice();for(let s=2;s<t[1].dims.length;++s)r[s-2]===0&&(r[s-2]=t[1].dims[s]);let o=e.pads.slice();Wt.adjustPadsBasedOnAutoPad(t[0].dims,e.strides,e.dilations,r,o,e.format==="NHWC",e.autoPad);let n=Object.assign({},e);return Object.assign(n,{kernelShape:r,pads:o,cacheKey:e.cacheKey}),n},io=e=>{let t=un(e),r=e.format,o=["NOTSET","VALID","SAME_UPPER","SAME_LOWER"][e.auto_pad],n=e.dilations,s=e.group,u=e.kernel_shape,l=e.pads,a=e.strides,p=e.w_is_const();return he({autoPad:o,format:r,dilations:n,group:s,kernelShape:u,pads:l,strides:a,wIsConst:p,...t})},Al=(e,t,r)=>{let o=as(r,t),n=r.format==="NHWC";if(r.group!==1){e.compute(to(t,o));return}let s=t.length===3,u=t[0].dims[n?1:2],l=t[0].dims[n?2:3],a=t[0].dims[n?3:1],p=t[1].dims[2],h=t[1].dims[3],g=ro(t[0].dims,t[1].dims,r.dilations,o.pads,r.strides,n),w=g[n?1:2],v=g[n?2:3],y=g[n?3:1],_=n&&p===u&&h===l&&r.pads[0]===0&&r.pads[1]===0;if(_||p===1&&h===1&&r.dilations[0]===1&&r.dilations[1]===1&&r.strides[0]===1&&r.strides[1]===1&&r.pads[0]===0&&r.pads[1]===0){let D=g[0],G,E,W,te=[];if(n){let ee=e.kernelCustomData.wT??e.compute(dt(t[1],os),{inputs:[1],outputs:[r.wIsConst?-2:-1]})[0];if(r.wIsConst&&!e.kernelCustomData.wT&&(e.kernelCustomData.wT=ee),_){let Te=u*l*a;G=t[0].reshape([1,D,Te]),E=ee.reshape([1,Te,y]),W=[1,D,y]}else G=t[0].reshape([D,u*l,a]),E=ee.reshape([1,a,y]),W=[D,w*v,y];te.push(G),te.push(E)}else G=t[0].reshape([D,a,u*l]),E=t[1].reshape([1,y,a]),W=[D,y,w*v],te.push(E),te.push(G);s&&te.push(t[2]);let Y=W[2],Z=te[0].dims[te[0].dims.length-1];Y<8&&Z<8?e.compute(oo(te,o,g,W,n),{inputs:te}):e.compute(pn(te,o,g,W,n),{inputs:te});return}let I=!0,x=e.kernelCustomData.wT??e.compute(dt(t[1],os),{inputs:[1],outputs:[r.wIsConst?-2:-1]})[0];r.wIsConst&&!e.kernelCustomData.wT&&(e.kernelCustomData.wT=x);let A=[t[0],x];s&&A.push(t[2]);let O=n?w*v:y,C=n?y:w*v,M=p*h*a;e.compute(es(A,o,g,O,C,M,s,I),{inputs:A})},Tl=(e,t)=>{let r=t.format==="NHWC",o=[e.inputs[0].reshape(r?[e.inputs[0].dims[0],1,e.inputs[0].dims[1],e.inputs[0].dims[2]]:[e.inputs[0].dims[0],e.inputs[0].dims[1],1,e.inputs[0].dims[2]]),e.inputs[1].reshape([e.inputs[1].dims[0],e.inputs[1].dims[1],1,e.inputs[1].dims[2]])];e.inputs.length===3&&o.push(e.inputs[2]);let n=[0,t.pads[0],0,t.pads[1]],s=[1].concat(t.strides),u=[1].concat(t.dilations),l=[1].concat(t.kernelShape),a=as({...t,pads:n,strides:s,dilations:u,kernelShape:l},o);e.compute(to(o,a,p=>r?[p[0],p[2],p[3]]:[]))},so=(e,t)=>{Il(e.inputs,t),e.inputs[0].dims.length===3?Tl(e,t):Al(e,e.inputs,t)}});var El,is,ss=q(()=>{"use strict";Pt();$e();Bt();ln();eo();Er();El=(e,t=!1,r,o=4)=>{let n=qe(o,"f32"),s=A=>{switch(A){case 1:return"return w[getIndexFromCoords4D(coord, vec4<i32>(uniforms.w_shape))];";case 4:return`\n            let coord1 = vec4<i32>(coordX, coordY, col + 1, rowInner);\n            let coord2 = vec4<i32>(coordX, coordY, col + 2, rowInner);\n            let coord3 = vec4<i32>(coordX, coordY, col + 3, rowInner);\n            let v0 = w[getIndexFromCoords4D(coord, vec4<i32>(uniforms.w_shape))];\n            let v1 = w[getIndexFromCoords4D(coord1, vec4<i32>(uniforms.w_shape))];\n            let v2 = w[getIndexFromCoords4D(coord2, vec4<i32>(uniforms.w_shape))];\n            let v3 = w[getIndexFromCoords4D(coord3, vec4<i32>(uniforms.w_shape))];\n            return vec4<f32>(v0, v1, v2, v3);\n            `;default:throw new Error(`innerElementSize ${A} is not supported.`)}},u=e?`\n      let coord = vec4<i32>(batch, iXR, iXC, xCh);\n      `:`\n      let coord = vec4<i32>(batch, xCh, iXR, iXC);\n      `,l=e?`\n    let coords = vec4<i32>(\n      batch,\n      row / outWidth,\n      row % outWidth,\n      col);\n    `:`\n    let coords = vec4<i32>(\n      batch,\n      row,\n      col / outWidth,\n      col % outWidth);\n    `,a=e?"outBackprop[1]":"outBackprop[2]",p=e?"outBackprop[2]":"outBackprop[3]",h=e?"row":"col",g=e?"col":"row",w=`\n      let inChannels = ${e?"outBackprop[3]":"outBackprop[1]"};\n      let outWidth = ${e?"i32(uniforms.result_shape[2])":"i32(uniforms.result_shape[3])"};\n      let outRow = ${h} / outWidth;\n      let outCol = ${h} % outWidth;\n\n      let WRow = ${g} / (filterDims[1] * inChannels);\n      let WCol = ${g} / inChannels % filterDims[1];\n      let xR = f32(outRow - pads[0] + dilation[0] * WRow) / f32(strides[0]);\n      let xC = f32(outCol - pads[1] + dilation[1] * WCol) / f32(strides[1]);\n      if (xR < 0.0 || xR >= f32(${a}) || fract(xR) > 0.0) {\n        return ${n}(0.0);\n      }\n      if (xC < 0.0 || xC >= f32(${p}) || fract(xC) > 0.0) {\n        return ${n}(0.0);\n      }\n      let iXR = i32(xR);\n      let iXC = i32(xC);\n      let xCh = ${g} % inChannels;\n      ${u}\n      return x[getIndexFromCoords4D(coord, vec4<i32>(uniforms.x_shape))/${o}];`,v=e?`\n      let col = colIn * ${o};\n      if (row < uniforms.dimAOuter && col < uniforms.dimInner) {\n        ${w}\n      }\n      return ${n}(0.0);`:`\n      let col = colIn * ${o};\n      if (row < uniforms.dimInner && col < uniforms.dimBOuter) {\n        ${w}\n      }\n      return ${n}(0.0);`,y=`\n      let col = colIn * ${o};\n      let inChannels = ${e?"outBackprop[3]":"outBackprop[1]"};\n      let coordX = filterDims.x - 1 - row / (filterDims[1] * inChannels);\n      let coordY = filterDims.y - 1 - (row / inChannels) % filterDims[1];\n      if (${e?"row < uniforms.dimInner && col < uniforms.dimBOuter":"row < uniforms.dimInner && col < uniforms.dimAOuter"}  && coordX >= 0 && coordY >= 0) {\n        let rowInner = row % inChannels;\n        let coord = vec4<i32>(coordX, coordY, col, rowInner);\n        ${s(o)}\n      }\n      return ${n}(0.0);\n      `,{activationFunction:_,applyActivation:I}=vt(r,n);return`\n      ${_}\n  fn mm_readA(batch: i32, row : i32, colIn : i32) -> ${n} {\n    ${e?v:y}\n  }\n\n  fn mm_readB(batch: i32, row : i32, colIn : i32) -> ${n} {\n    ${e?y:v}\n  }\n\n  fn mm_write(batch: i32, row : i32, colIn : i32, valueInput : ${n}) {\n    let col = colIn * ${o};\n    if (row < uniforms.dimAOuter && col < uniforms.dimBOuter) {\n      var value = valueInput;\n      let outWidth = ${e?"i32(uniforms.result_shape[2])":"i32(uniforms.result_shape[3])"};\n      ${l}\n      ${dn(t)}\n      ${I}\n      result[getIndexFromCoords4D(coords, vec4<i32>(uniforms.result_shape))/${o}] = value;\n    }\n  }`},is=(e,t,r,o,n,s,u,l)=>{let a=t.format==="NHWC",p=a?e[0].dims[3]:e[0].dims[1],h=r[0],g=a?r[2]:r[3],w=a?r[1]:r[2],v=a?r[3]:r[1],y=a?p%4===0&&v%4===0:g%4===0&&v%4===0,_=a?v:g*w,I=a?g*w:v,x=y?[8,8,1]:[_<=4||I<=4?4:16,_>4&&I<=4?4:16,1],A=y?[4,4,1]:[_<=4?1:4,_>4&&I<=4?1:4,1],O=[Math.ceil(_/x[0]/A[0]),Math.ceil(I/x[1]/A[1]),Math.ceil(h/x[2]/A[2])];Re("verbose",()=>`[conv_backprop_mm_webgpu] dispatch = ${O}`);let C=y?4:1,M=Math.max(x[0]*C,x[1]),D=y?4:1,G=[{type:"int32",data:o},{type:"int32",data:n},{type:"int32",data:s}],E=U("x",e[0].dataType,e[0].dims.length,D),W=U("w",e[1].dataType,e[1].dims.length,1),te=K("result",e[0].dataType,r.length,D),Y=[E,W];G.push(...F(e[0].dims)),G.push(...F(e[1].dims));let Z="";if(u){let ee=U("bias",e[2].dataType,e[2].dims.length,D);Y.push(ee),G.push(...F(e[2].dims)),Z+=`\n        fn getBiasByOutputCoords(coords : vec4<i32>) -> ${y?"vec4<f32>":"f32"} {\n          return bias[coords.${a?"w":"y"}${y?"/ 4":""}];\n        }`}return G.push(...F(r)),{name:"Conv2DTransposeMatMul",shaderCache:{hint:t.cacheKey},getRunData:()=>({outputs:[{dims:r,dataType:e[0].dataType}],dispatchGroup:{x:O[0],y:O[1],z:O[2]},programUniforms:G}),getShaderSource:ee=>`\n        ${cn("uniforms.result_strides")}\n        ${ee.registerUniform("dimAOuter","i32").registerUniform("dimBOuter","i32").registerUniform("dimInner","i32").declareVariables(...Y,te)};\n        const outBackprop : vec4<i32> = vec4<i32>(${e[0].dims.join(",")});\n        const filterDims : vec2<i32> = vec2<i32>(${t.kernelShape[a?1:2]}, ${t.kernelShape[a?2:3]});\n        const effectiveFilterDims : vec2<i32> = filterDims + vec2<i32>(\n              ${t.dilations[0]<=1?0:(t.kernelShape[a?1:2]-1)*(t.dilations[0]-1)},\n              ${t.dilations[1]<=1?0:(t.kernelShape[a?2:3]-1)*(t.dilations[1]-1)});\n        const pads : vec2<i32> = vec2<i32>(i32(effectiveFilterDims[0]) - 1 - (${t.pads[0]+t.pads[2]})/2,\n                                         i32(effectiveFilterDims[1]) - 1 - (${t.pads[1]+t.pads[3]})/2);\n        const strides : vec2<i32> = vec2<i32>(${t.strides[0]}, ${t.strides[1]});\n        const dilation : vec2<i32> = vec2<i32>(${t.dilations[0]}, ${t.dilations[1]});\n        const dimAOuter : i32 = ${o};\n        const dimBOuter : i32 = ${n};\n        const dimInner : i32 = ${s};\n        ${Z}\n        ${El(a,u,t,C)}\n        ${y?Ar(A,x,"f32",void 0,!a,M):Tr(A,x,"f32",void 0,!a,M,!1,void 0,l)}`}}});var Ol,uo,us=q(()=>{"use strict";Pt();xe();$e();Ol=(e,t,r,o,n,s,u=!1,l)=>{let a=r.format==="NHWC",p=a?1:2,h=a?2:3,g=a?3:1,w=V.size(o),v=u?2:1,y=r.group,_=t[1].dims,I=_[0]/y,x=_[1],A=`\n  fn setOutputAtIndex(flatIndex : u32, value : ${u?`vec4<${l}>`:l}) {\n    result[flatIndex] = ${u?`vec4<${l}>`:l}(value);\n  }`;n&&(A+=`\n    fn getBiasByOutputCoords(coords : vec4<u32>) -> ${u?`vec4<${l}>`:l} {\n      return bias[coords.${a?"w":"y"}${u?"/ 4":""}];\n    }`);let O=u?4:1,C=U("W",t[1].dataType,t[1].dims,O),M=U("Dy",t[0].dataType,t[0].dims,O),D=[M,C];n&&D.push(U("bias",t[2].dataType,[o[g]],O));let G=K("result",t[0].dataType,o,O),E=`{\n        let batch: u32 = ${s?"global_id.z":"workgroup_id.z"} / outShape[1];\n        let r = ${s?"global_id.z":"workgroup_id.z"} % outShape[1];\n        let c = ${s?"global_id.y":"workgroup_id.y"} * ${v};\n        let d1: u32 = ${s?"global_id.x":"workgroup_id.x"} * 4;\n\n        let dyCorner = vec2<i32>(i32(r), i32(c)) - vec2<i32>(pads);\n\n        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).\n        // ? = to be determined. : = across all values in that axis.\n        var dotProd: array<vec4<${l}>, ${v}>;\n        for (var i = 0; i < ${v}; i++) {\n          dotProd[i] = vec4<${l}>(0.0);\n        }\n        for (var wR: u32 = 0; wR < filterDims[0]; wR = wR + 1) {\n          var dyR = (${l}(dyCorner.x) + ${l}(wR)) / ${l}(strides.x);\n          let wRPerm = filterDims[0] - 1 - wR;\n          if (dyR < 0.0 || dyR >= ${l}(outBackprop[1]) ||\n              fract(dyR) > 0.0 || wRPerm < 0) {\n            continue;\n          }\n          let idyR: u32 = u32(dyR);\n\n          for (var wC: u32 = 0; wC < filterDims[1]; wC = wC + 1) {\n            let dyC = (${l}(dyCorner.y) + ${l}(wC)) / ${l}(strides.y);\n            let dyC2 = (${l}(dyCorner.y) + 1.0 + ${l}(wC)) / ${l}(strides.y);\n            let wCPerm = filterDims[1] - 1 - wC;\n            if (wCPerm < 0) {\n              continue;\n            }\n            var bDyCVal = true;\n            var bDyCVal2 = true;\n            if (dyC < 0.0 || dyC >= ${l}(outBackprop[2]) ||\n                fract(dyC) > 0.0) {\n              bDyCVal = false;\n            }\n            if (dyC2 < 0.0 || dyC2 >= ${l}(outBackprop[2]) ||\n                fract(dyC2) > 0.0) {\n              bDyCVal2 = false;\n            }\n\n            let idyC: u32 = u32(dyC);\n            let idyC2: u32 = u32(dyC2);\n            if (bDyCVal && bDyCVal2) {\n              let d2Length = outBackprop[3];\n              for (var d2 :u32 = 0; d2 < d2Length; d2 = d2 + 4) {\n                let wValue0 = ${C.get("u32(wRPerm)","u32(wCPerm)","d1","d2")};\n                let wValue1 = ${C.get("u32(wRPerm)","u32(wCPerm)","d1 + 1","d2")};\n                let wValue2 = ${C.get("u32(wRPerm)","u32(wCPerm)","d1 + 2","d2")};\n                let wValue3 = ${C.get("u32(wRPerm)","u32(wCPerm)","d1 + 3","d2")};\n\n                var xValue = ${M.get("batch","idyR","idyC","d2")};\n                let tmpval = vec4<${l}>(dot(xValue, wValue0),\n                                      dot(xValue, wValue1),\n                                      dot(xValue, wValue2),\n                                      dot(xValue, wValue3));\n                dotProd[0] = dotProd[0] + tmpval;\n\n                xValue =  ${M.get("batch","idyR","idyC2","d2")};\n\n                dotProd[1] = dotProd[1] + vec4<${l}>(dot(xValue, wValue0),\n                                                    dot(xValue, wValue1),\n                                                    dot(xValue, wValue2),\n                                                    dot(xValue, wValue3));\n              }\n            } else if (bDyCVal) {\n              let d2Length = outBackprop[${g}];\n              for (var d2: u32 = 0; d2 < d2Length; d2 = d2 + 4) {\n                let wValue0 = ${C.get("u32(wRPerm)","u32(wCPerm)","d1","d2")};\n                let wValue1 = ${C.get("u32(wRPerm)","u32(wCPerm)","d1 + 1","d2")};\n                let wValue2 = ${C.get("u32(wRPerm)","u32(wCPerm)","d1 + 2","d2")};\n                let wValue3 = ${C.get("u32(wRPerm)","u32(wCPerm)","d1 + 3","d2")};\n\n                var xValue = ${M.get("batch","idyR","idyC","d2")};\n                let tmpval = vec4<${l}>(dot(xValue, wValue0),\n                                      dot(xValue, wValue1),\n                                      dot(xValue, wValue2),\n                                      dot(xValue, wValue3));\n                dotProd[0] = dotProd[0] + tmpval;\n              }\n            } else if (bDyCVal2) {\n              let d2Length = outBackprop[3];\n              for (var d2: u32 = 0; d2 < d2Length; d2 = d2 + 4) {\n                let wValue0 = ${C.get("u32(wRPerm)","u32(wCPerm)","d1","d2")};\n                let wValue1 = ${C.get("u32(wRPerm)","u32(wCPerm)","d1 + 1","d2")};\n                let wValue2 = ${C.get("u32(wRPerm)","u32(wCPerm)","d1 + 2","d2")};\n                let wValue3 = ${C.get("u32(wRPerm)","u32(wCPerm)","d1 + 3","d2")};\n\n                var xValue = ${M.get("batch","idyR","idyC2","d2")};\n                let tmpval = vec4<${l}>(dot(xValue, wValue0),\n                                      dot(xValue, wValue1),\n                                      dot(xValue, wValue2),\n                                      dot(xValue, wValue3));\n                dotProd[1] = dotProd[1] + tmpval;\n              }\n            }\n          }\n        }\n\n        for (var i: u32 = 0; i < ${v}; i = i + 1) {\n          let value = dotProd[i] + ${n?"bias[c+i]":`vec4<${l}>(0.0)`};\n          ${G.set("batch","r","c + i","d1","value")};\n        }\n      }`,W=`\n          let outputIndices = ${G.offsetToIndices("global_idx")};\n          let batch = ${G.indicesGet("outputIndices",0)};\n          let d1 = ${G.indicesGet("outputIndices",g)};\n          let r = ${G.indicesGet("outputIndices",p)};\n          let c = ${G.indicesGet("outputIndices",h)};\n          let dyCorner = vec2<i32>(i32(r), i32(c)) - pads;\n          let dyRCorner = dyCorner.x;\n          let dyCCorner = dyCorner.y;\n          let groupId = d1 / ${x};\n          let wOutChannel = d1 - groupId * ${x};\n          // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).\n          // ? = to be determined. : = across all values in that axis.\n          var dotProd = ${l}(0.0);\n          for (var wR: u32 = 0; wR < effectiveFilterDims.x; wR = wR + 1) {\n            if (wR % dilations.x != 0) {\n              continue;\n            }\n            let dyR = (${l}(dyRCorner) + ${l}(wR)) / ${l}(strides[0]);\n            let wRPerm = filterDims.x - 1 - wR / dilations.x;\n            if (dyR < 0.0 || dyR >= ${l}(outBackprop[${p}]) || fract(dyR) > 0.0 ||\n                wRPerm < 0) {\n              continue;\n            }\n            let idyR: u32 = u32(dyR);\n\n            for (var wC: u32 = 0; wC < effectiveFilterDims.y; wC = wC + 1) {\n              if (wC % dilations.y != 0) {\n                continue;\n              }\n              let dyC = (${l}(dyCCorner) + ${l}(wC)) / ${l}(strides.y);\n              let wCPerm = filterDims.y - 1 - wC / dilations.y;\n              if (dyC < 0.0 || dyC >= ${l}(outBackprop[${h}]) ||\n                  fract(dyC) > 0.0 || wCPerm < 0) {\n                continue;\n              }\n              let idyC: u32 = u32(dyC);\n              var inputChannel = groupId * ${I};\n              for (var d2: u32 = 0; d2 < ${I}; d2 = d2 + 1) {\n                let xValue = ${a?M.get("batch","idyR","idyC","inputChannel"):M.get("batch","inputChannel","idyR","idyC")};\n                let wValue = ${C.get("inputChannel","wOutChannel","u32(wRPerm)","u32(wCPerm)")};\n                dotProd = dotProd + xValue * wValue;\n                inputChannel = inputChannel + 1;\n              }\n            }\n          }\n          let value = dotProd + ${n?"bias[d1]":`${l}(0.0)`};\n          ${G.setByOffset("global_idx","value")};\n        `;return`\n  ${e.declareVariables(...D,G)}\n  ${A}\n  const outShape : vec4<u32> = vec4<u32>(${o.join(",")});\n  const outBackprop : vec4<u32> = vec4<u32>(${t[0].dims.join(",")});\n  const strides : vec2<u32> = vec2<u32>(${r.strides[0]}, ${r.strides[1]});\n  const filterDims : vec2<u32> = vec2<u32>(${r.kernelShape[a?1:2]}, ${r.kernelShape[a?2:3]});\n  const dilations : vec2<u32> = vec2<u32>(${r.dilations[0]}, ${r.dilations[1]});\n  const effectiveFilterDims : vec2<u32> = filterDims + vec2<u32>(\n          ${r.dilations[0]<=1?0:(r.kernelShape[a?1:2]-1)*(r.dilations[0]-1)},\n          ${r.dilations[1]<=1?0:(r.kernelShape[a?2:3]-1)*(r.dilations[1]-1)});\n  const pads : vec2<i32> = vec2<i32>(i32(effectiveFilterDims[0]) - 1 - (${r.pads[0]+r.pads[2]})/2,\n                                     i32(effectiveFilterDims[1]) - 1 - (${r.pads[1]+r.pads[3]})/2);\n    ${e.mainStart()}\n    ${e.guardAgainstOutOfBoundsWorkgroupSizes(w)};\n  ${u?E:W}}`},uo=(e,t,r)=>{let o=e.length>2,n=t.outputShape,s=V.size(n),u=[Math.ceil(s/64),1,1];Re("verbose",()=>`[conv2d_backprop_webgpu] dispatch = ${u}`);let l=Ge(e[0].dataType);return{name:"ConvTranspose2D",shaderCache:{hint:t.cacheKey},getRunData:()=>({dispatchGroup:{x:u[0],y:u[1],z:u[2]},outputs:[{dims:r?r(n):n,dataType:e[0].dataType}]}),getShaderSource:a=>Ol(a,e,t,n,o,u[1]===1&&u[2]===1,!1,l)}}});var Pl,Bl,kl,ds,ls,Rl,Dl,Ml,Ul,cs,ps=q(()=>{"use strict";Le();ss();us();Bt();or();Pl=(e,t,r,o,n,s)=>(e-1)*t+r+(o-1)*n+1-s,Bl=(e,t,r,o,n)=>{let s=Math.floor(e/2);t==="SAME_UPPER"?(r[o]=s,r[n]=e-s):t==="SAME_LOWER"&&(r[o]=e-s,r[n]=s)},kl=(e,t,r,o,n,s,u,l,a,p)=>{let h=e.length-2,g=p.length===0;if(a.length===0)for(let y=0;y<h;++y)a.push(0);let w=e[0],v=t[l?3:1]*n;for(let y=0,_=e.length-h-(l?1:0);y<h;++y,++_){let I=e[_],x=g?I*u[y]:p[y],A=Pl(I,u[y],s[y],t[_],r[y],x);Bl(A,o,s,y,y+h),g&&p.push(u[y]*(I-1)+a[y]+(t[_]-1)*r[y]+1-s[y]-s[y+h])}p.splice(0,0,w),p.splice(l?3:1,0,v)},ds=(e,t)=>{let r=e.kernelShape.slice();if(e.kernelShape.length===0||e.kernelShape.reduce((w,v)=>w*v,1)===0){r.length=0;for(let w=2;w<t[1].dims.length;++w)r.push(t[1].dims[w])}let o=e.format==="NHWC";r.splice(0,0,t[1].dims[0]),r.splice(o?3:1,0,t[1].dims[1]);let n=e.pads.slice(),s=e.outputShape.slice(),u=e.outputPadding.slice(),l=t[0].dims,a=e.dilations.slice();if(a.reduce((w,v)=>w+v,0)===0){let w=t[0].dims.length-2;a=new Array(w).fill(1)}let p=e.strides.slice();if(p.reduce((w,v)=>w+v,0)===0){let w=t[0].dims.length-2;p=new Array(w).fill(1)}kl(l,r,a,e.autoPad,e.group,n,p,o,u,s);let h=Object.assign({},e),g=e.cacheKey+[r.join("n,"),n.join(","),p.join(","),u.join(","),s.join(","),a.join(",")].join("_");return Object.assign(h,{kernelShape:r,pads:n,outputPadding:u,outputShape:s,dilations:a,strides:p,cacheKey:g}),h},ls=e=>{let t=un(e),r=e.format,o=["NOTSET","VALID","SAME_UPPER","SAME_LOWER"][typeof e.autoPad>"u"?0:e.autoPad],n=e.dilations,s=e.group,u=e.kernelShape,l=e.pads,a=e.strides,p=e.wIsConst(),h=e.outputPadding,g=e.outputShape;return he({autoPad:o,format:r,dilations:n,group:s,kernelShape:u,outputPadding:h,outputShape:g,pads:l,strides:a,wIsConst:p,...t})},Rl=(e,t)=>{if(!e||e.length!==2&&e.length!==3)throw new Error("Conv requires 2 or 3 inputs");if(e[0].dims.length!==4&&e[0].dims.length!==3)throw new Error("currently only support 2-dimensional conv");if(e[0].dims.length!==e[1].dims.length)throw new Error("filter does not have same dimension as input");let r=e[0].dims[t.format==="NHWC"?e[0].dims.length-1:1],o=e[1].dims[0];if(r!==o)throw new Error("FILTER_IN_CHANNEL should be equal to DATA_CHANNEL");let n=e[1].dims[1]*t.group;if(e.length===3&&(e[2].dims.length!==1||e[2].dims[0]!==n))throw new Error("invalid bias");let s=e[0].dims.length-2;if(t.dilations.reduce((h,g)=>h+g,0)>0&&t.dilations.length!==s)throw new Error(`dilations should be ${s}D`);if(t.strides.reduce((h,g)=>h+g,0)>0&&t.strides.length!==s)throw new Error(`strides should be ${s}D`);if(t.pads.reduce((h,g)=>h+g,0)>0&&t.pads.length!==s*2)throw new Error(`pads should be ${s*2}D`);if(t.outputPadding.length!==s&&t.outputPadding.length!==0)throw new Error(`output_padding should be ${s}D`);if(t.kernelShape.reduce((h,g)=>h+g,0)>0&&t.kernelShape.length!==0&&t.kernelShape.length!==e[1].dims.length-2)throw new Error("invalid kernel shape");if(t.outputShape.length!==0&&t.outputShape.length!==e[0].dims.length-2)throw new Error("invalid output shape")},Dl=[2,3,1,0],Ml=(e,t,r)=>{let o=ds(r,t),n=r.format==="NHWC",s=o.outputShape,u=s[n?3:1],l=t[0].dims[n?3:1];if(o.group!==1||u===1&&l===1){e.compute(uo(t,o));return}let a=s[n?1:2],p=s[n?2:3],h=t[1].dims[2],g=t[1].dims[3],w=n?a*p:u,v=n?u:a*p,y=h*g*l,_=!0,I=e.kernelCustomData.wT??e.compute(dt(t[1],Dl),{inputs:[1],outputs:[r.wIsConst?-2:-1]})[0];r.wIsConst&&!e.kernelCustomData.wT&&(e.kernelCustomData.wT=I);let x=[t[0],I],A=t.length===3;A&&(!n&&t[2].dims.length===1?x.push(t[2].reshape([t[2].dims[0],1,1])):x.push(t[2])),e.compute(is(x,o,s,w,v,y,A,_),{inputs:x})},Ul=(e,t)=>{let r=t.format==="NHWC",o=[e.inputs[0].reshape(r?[e.inputs[0].dims[0],1,e.inputs[0].dims[1],e.inputs[0].dims[2]]:[e.inputs[0].dims[0],e.inputs[0].dims[1],1,e.inputs[0].dims[2]]),e.inputs[1].reshape([e.inputs[1].dims[0],e.inputs[1].dims[1],1,e.inputs[1].dims[2]])];o.length===3&&o.push(e.inputs[2]);let n=t.kernelShape;(n.length===0||n[0]===0)&&(n=[e.inputs[1].dims[2]]);let s=t.dilations;(s.length===0||s[0]===0)&&(s=[1]);let u=t.strides;(u.length===0||u[0]===0)&&(u=[1]);let l=t.pads;l.length===0&&(l=[0,0]),l=[0,l[0],0,l[1]],u=[1].concat(u),s=[1].concat(s),n=[1].concat(n);let a=ds({...t,pads:l,strides:u,dilations:s,kernelShape:n},o);e.compute(uo(o,a,p=>r?[p[0],p[2],p[3]]:[p[0],p[1],p[3]]))},cs=(e,t)=>{Rl(e.inputs,t),e.inputs[0].dims.length===3?Ul(e,t):Ml(e,e.inputs,t)}});var zl,ms,fs,hs=q(()=>{"use strict";We();xe();Le();$e();zl=(e,t,r,o)=>{let n=V.size(t),s=t.length,u=U("input",e,s),l=K("output",e,s),a=r.dataType===6?r.getInt32Array()[0]:Number(r.getBigInt64Array()[0]),p=V.normalizeAxis(a,s),h=g=>{let w=` i32(${u.indicesGet("inputIndices","uniforms.axis")}) `,v=de("uniforms.input_shape","uniforms.axis",s),y=o.reverse?w+(o.exclusive?" + 1":""):"0",_=o.reverse?v:w+(o.exclusive?"":" + 1");return`\n                ${g.registerUniform("outputSize","u32").registerUniform("axis","u32").declareVariables(u,l)}\n                ${g.mainStart()}\n                  ${g.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}\n                  var inputIndices = ${l.offsetToIndices("global_idx")};\n                  var sum = ${l.type.value}(0);\n                  let first : i32 = ${y};\n                  let last : i32 = ${_};\n                  for (var i : i32 = first; i < last; i++) {\n                    ${u.indicesSet("inputIndices","uniforms.axis","u32(i)")};\n                    sum = sum + ${u.getByIndices("inputIndices")};\n                  }\n                  ${l.setByOffset("global_idx","sum")};\n                }`};return{name:"CumSum",shaderCache:{hint:o.cacheKey,inputDependencies:["rank"]},getRunData:()=>({outputs:[{dims:t,dataType:e}],dispatchGroup:{x:Math.ceil(n/64)},programUniforms:[{type:"uint32",data:n},{type:"int32",data:p},...F(t),...F(t)]}),getShaderSource:h}},ms=(e,t)=>{let r=e.inputs[0].dims,o=e.inputs[0].dataType,n=e.inputs[1];e.compute(zl(o,r,n,t),{inputs:[0]})},fs=e=>{let t=e.exclusive===1,r=e.reverse===1;return he({exclusive:t,reverse:r})}});var lo,mn,gs,Vl,Nl,co,po,ys,Wl,bs,ws,vs=q(()=>{"use strict";xe();Le();$e();lo="[a-zA-Z]|\\\\.\\\\.\\\\.",mn="("+lo+")+",gs="^"+mn+"$",Vl="("+mn+",)*"+mn,Nl="^"+Vl+"$",co=class{constructor(t=-1){this.symbolToIndices=new Map,this.inputIndex=t}addSymbol(t,r){let o=this.symbolToIndices.get(t);o===void 0?o=[r]:o.push(r),this.symbolToIndices.set(t,o)}},po=class{constructor(t,r){this.equation=r;this.hasEllipsis=!1,this.symbolToInfo=new Map,this.lhs=new Array,this.outputDims=[];let[o,n]=r.includes("->")?r.split("->",2):[r,""];if(!o.match(RegExp(Nl)))throw new Error("Invalid LHS term");if(o.split(",").forEach((l,a)=>{let p=t[a].dims.slice();if(!l.match(RegExp(gs)))throw new Error("Invalid LHS term");let h=this.processTerm(l,!0,p,a);this.lhs.push(h)}),n==="")n+=[...this.symbolToInfo.entries()].filter(([l,a])=>a.count===1||l==="...").map(([l])=>l).join("");else if(!n.match(RegExp(mn)))throw new Error("Invalid RHS");n.match(RegExp(lo,"g"))?.forEach(l=>{if(l==="...")this.outputDims=this.outputDims.concat(this.ellipsisDims);else{let a=this.symbolToInfo.get(l);if(a===void 0)throw new Error("Invalid RHS symbol");this.outputDims.push(a.dimValue)}}),this.rhs=this.processTerm(n,!1,this.outputDims)}addSymbol(t,r,o){let n=this.symbolToInfo.get(t);if(n!==void 0){if(n.dimValue!==r&&n.count!==1)throw new Error("Dimension mismatch");n.count++,n.inputIndices.push(o)}else n={count:1,dimValue:r,inputIndices:[o]};this.symbolToInfo.set(t,n)}processTerm(t,r,o,n=-1){let s=o.length,u=!1,l=[],a=0;if(!t.match(RegExp(gs))&&!r&&t!=="")throw new Error("Invalid LHS term");let p=t.match(RegExp(lo,"g")),h=new co(n);return p?.forEach((g,w)=>{if(g==="..."){if(u)throw new Error("Only one ellipsis is allowed per input term");u=!0;let v=s-p.length+1;if(v<0)throw new Error("Ellipsis out of bounds");if(l=o.slice(a,a+v),this.hasEllipsis){if(this.ellipsisDims.length!==l.length||this.ellipsisDims.toString()!==l.toString())throw new Error("Ellipsis dimensions mismatch")}else if(r)this.hasEllipsis=!0,this.ellipsisDims=l;else throw new Error("Ellipsis must be specified in the LHS");for(let y=0;y<l.length;y++){let _=String.fromCharCode("0".charCodeAt(0)+y);h.addSymbol(_,w+y),this.addSymbol(_,o[a++],n)}}else h.addSymbol(g,w+(this.hasEllipsis?this.ellipsisDims.length-1:0)),this.addSymbol(g,o[a++],n)}),h}},ys=e=>e+"_max",Wl=(e,t,r,o,n)=>{let u=t.map((v,y)=>e[y]?v.length:v).map((v,y)=>U(`input${y}`,r,v)),l=V.size(n),a=Ue(n.length),p=a?n.length:n,h=K("output",r,p),g=[...o.symbolToInfo.keys()].filter(v=>!o.rhs.symbolToIndices.has(v)),w=v=>{let y=[],_="var prod = 1.0;",I="var sum = 0.0;",x="sum += prod;",A=[],O=[],C=[],M=[],D=o.symbolToInfo.size===o.rhs.symbolToIndices.size;o.symbolToInfo.forEach((E,W)=>{if(o.rhs.symbolToIndices.has(W)){let te=o.rhs.symbolToIndices.get(W)?.[0];te!==void 0&&o.lhs.forEach((Y,Z)=>{if(E.inputIndices.includes(Z)){let ee=Y.symbolToIndices.get(W);if(ee===void 0)throw new Error("Invalid symbol error");ee.forEach(Te=>{y.push(`${u[Z].indicesSet(`input${Z}Indices`,Te,h.indicesGet("outputIndices",te))}`)})}})}else o.lhs.forEach((te,Y)=>{if(E.inputIndices.includes(Y)){let Z=te.symbolToIndices.get(W);if(Z===void 0)throw new Error("Invalid symbol error");Z.forEach(ee=>{A.push(`${u[Y].indicesSet(`input${Y}Indices`,ee,`${W}`)}`)}),M.push(`prod *= ${u[Y].getByIndices(`input${Y}Indices`)};`)}}),O.push(`for(var ${W}: u32 = 0; ${W} < uniforms.${ys(W)}; ${W}++) {`),C.push("}")});let G=D?[...y,`let sum = ${u.map((E,W)=>E.getByIndices(`input${W}Indices`)).join(" * ")};`]:[...y,I,...O,...A,_,...M,x,...C];return`\n            ${v.registerUniforms(g.map(E=>({name:`${ys(E)}`,type:"u32"}))).registerUniform("outputSize","u32").declareVariables(...u,h)}\n\n            ${v.mainStart()}\n            ${v.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}\n            var outputIndices = ${h.offsetToIndices("global_idx")};\n            ${u.map((E,W)=>`var input${W}Indices: ${u[W].type.indices};`).join(`\n`)}\n            ${G.join(`\n`)};\n            ${h.setByOffset("global_idx","sum")};\n          }`};return{name:"Einsum",shaderCache:{hint:o.equation,inputDependencies:e.map(v=>v?"rank":"dims")},getRunData:()=>{let v=g.filter(_=>o.symbolToInfo.has(_)).map(_=>({type:"uint32",data:o.symbolToInfo.get(_)?.dimValue||0}));v.push({type:"uint32",data:l});let y=t.filter((_,I)=>e[I]).map((_,I)=>[...F(_)]).reduce((_,I)=>_.concat(I),v);return a&&y.push(...F(n)),{outputs:[{dims:n,dataType:r}],dispatchGroup:{x:Math.ceil(l/64)},programUniforms:y}},getShaderSource:w}},bs=(e,t)=>{let r=new po(e.inputs,t.equation),o=e.inputs.map((u,l)=>Ue(u.dims.length)),n=r.outputDims,s=e.inputs.map((u,l)=>u.dims);e.compute(Wl(o,s,e.inputs[0].dataType,r,n))},ws=e=>{let t=e.equation.replace(/\\s+/g,"");return he({equation:t})}});var Gl,$s,Hl,Ll,Ss,xs=q(()=>{"use strict";We();xe();$e();Gl=e=>{if(!e||e.length!==2)throw new Error("Expand requires 2 input.");let t=e[0].dims,r=Array.from(e[1].getBigInt64Array(),Number),o=r.length<t.length?0:r.length-t.length,n=t.length<r.length?0:t.length-r.length;for(;o<r.length&&n<t.length;++o,++n)if(r[o]!==t[n]&&r[o]!==1&&t[n]!==1)throw new Error("Expand requires shape to be broadcastable to input")},$s=(e,t)=>{let r=e.length-t.length,o=[];for(let n=0;n<r;++n)o.push(e[n]);for(let n=0;n<t.length;++n)o.push(t[n]===1?e[n+r]:t[n]);return o},Hl=(e,t)=>e.length>t.length?$s(e,t):$s(t,e),Ll=e=>{let t=e[0].dims,r=Array.from(e[1].getBigInt64Array(),Number),o=Hl(t,r),n=e[0].dataType,s=n===9?4:1,u=Math.ceil(V.size(o)/s),l=Ue(t.length),a=Ue(o.length),p=g=>{let w=l?t.length:t,v=a?o.length:o,y=U("input",n,w,s),_=K("output",n,v,s),I;if(n===9){let x=(A,O,C="")=>`\n          let outputIndices${O} = ${_.offsetToIndices(`outputOffset + ${O}u`)};\n          let offset${O} = ${y.broadcastedIndicesToOffset(`outputIndices${O}`,_)};\n          let index${O} = offset${O} / 4u;\n          let component${O} = offset${O} % 4u;\n          ${A}[${O}] = ${C}(${y.getByOffset(`index${O}`)}[component${O}]);\n        `;I=`\n        let outputOffset = global_idx * ${s};\n        var data = vec4<u32>(0);\n        ${x("data",0,"u32")}\n        ${x("data",1,"u32")}\n        ${x("data",2,"u32")}\n        ${x("data",3,"u32")}\n        ${_.setByOffset("global_idx","data")}\n      }`}else I=`\n        let outputIndices = ${_.offsetToIndices("global_idx")};\n        let inputOffset = ${y.broadcastedIndicesToOffset("outputIndices",_)};\n        ${_.setByOffset("global_idx",y.getByOffset("inputOffset"))}\n      }`;return`\n    ${g.registerUniform("vec_size","u32").declareVariables(y,_)}\n    ${g.mainStart()}\n    ${g.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.vec_size")}\n    ${I}`},h=[{type:"uint32",data:u}];return l&&h.push(...F(t)),a&&h.push(...F(o)),{name:"Expand",shaderCache:{hint:`${o.length}`,inputDependencies:[l?"rank":"dims"]},getShaderSource:p,getRunData:()=>({outputs:[{dims:o,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(u/64)},programUniforms:h})}},Ss=e=>{Gl(e.inputs),e.compute(Ll(e.inputs),{inputs:[0]})}});var Fl,Kl,_s,Cs,Is=q(()=>{"use strict";We();xe();Le();$e();Fl=e=>{if(!e||e.length!==2)throw new Error("Gather requires 2 inputs.")},Kl=(e,t)=>{let r=e[0].dims,o=e[1].dims,n=r.length,s=V.normalizeAxis(t.axis,n),u=r.slice(0);u.splice(s,1,...o);let l=r[s],a=e[0].dataType===9?4:1,p=Math.ceil(V.size(u)/a),h=Ue(e[0].dims.length),g=h?e[0].dims.length:e[0].dims,w=Ue(e[1].dims.length),v=w?e[1].dims.length:e[1].dims,y=Ue(u.length),_=y?u.length:u,I=[{type:"uint32",data:p},{type:"int32",data:l},{type:"uint32",data:s}];h&&I.push(...F(e[0].dims)),w&&I.push(...F(e[1].dims)),y&&I.push(...F(u));let x=[];x.push(h?"rank":"dims"),x.push(w?"rank":"dims");let A=O=>{let C=U("data",e[0].dataType,g,a),M=U("inputIndices",e[1].dataType,v),D=K("output",e[0].dataType,_,a),G=W=>{let te=o.length,Y=`var indicesIndices${W}  = ${M.type.indices}(0);`;for(let Z=0;Z<te;Z++)Y+=`${te>1?`indicesIndices${W}[${Z}]`:`indicesIndices${W}`} = ${u.length>1?`outputIndices${W}[uniforms.axis + ${Z}]`:`outputIndices${W}`};`;Y+=`\n          var idx${W} = ${M.getByIndices(`indicesIndices${W}`)};\n          if (idx${W} < 0) {\n            idx${W} = idx${W} + uniforms.axisDimLimit;\n          }\n          var dataIndices${W} = ${C.type.indices}(0);\n        `;for(let Z=0,ee=0;Z<n;Z++)Z===s?(Y+=`${n>1?`dataIndices${W}[${Z}]`:`dataIndices${W}`} = u32(idx${W});`,ee+=te):(Y+=`${n>1?`dataIndices${W}[${Z}]`:`dataIndices${W}`} = ${u.length>1?`outputIndices${W}[${ee}]`:`outputIndices${W}`};`,ee++);return Y},E;if(e[0].dataType===9){let W=(te,Y,Z="")=>`\n          let outputIndices${Y} = ${D.offsetToIndices(`outputOffset + ${Y}u`)};\n          ${G(Y)};\n          let offset${Y} = ${C.indicesToOffset(`dataIndices${Y}`)};\n          let index${Y} = offset${Y} / 4u;\n          let component${Y} = offset${Y} % 4u;\n          ${te}[${Y}] = ${Z}(${C.getByOffset(`index${Y}`)}[component${Y}]);\n        `;E=`\n        let outputOffset = global_idx * ${a};\n        var value = vec4<u32>(0);\n        ${W("value",0,"u32")}\n        ${W("value",1,"u32")}\n        ${W("value",2,"u32")}\n        ${W("value",3,"u32")}\n        ${D.setByOffset("global_idx","value")}\n      `}else E=`\n      let outputIndices = ${D.offsetToIndices("global_idx")};\n      ${G("")};\n      let value = ${C.getByIndices("dataIndices")};\n      ${D.setByOffset("global_idx","value")};\n      `;return`\n      ${O.registerUniform("outputSize","u32").registerUniform("axisDimLimit","i32").registerUniform("axis","u32").declareVariables(C,M,D)}\n      ${O.mainStart()}\n        ${O.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}\n        ${E}\n      }`};return{name:"Gather",shaderCache:{hint:t.cacheKey,inputDependencies:x},getRunData:()=>({outputs:[{dims:u,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(p/64)},programUniforms:I}),getShaderSource:A}},_s=e=>he({axis:e.axis}),Cs=(e,t)=>{let r=e.inputs;Fl(r),e.compute(Kl(e.inputs,t))}});var ql,jl,As,Ts,Es=q(()=>{"use strict";xe();Le();$e();ql=e=>{if(!e||e.length!==2)throw new Error("GatherElements requires 2 inputs.");if(e[0].dims.length<1)throw new Error("GatherElements requires that the data input be rank >= 1.");if(e[0].dims.length!==e[1].dims.length)throw new Error(`GatherElements requires that the data input and\n                     indices input tensors be of same rank.`)},jl=(e,t)=>{let r=e[0].dims,o=e[0].dataType,n=r.length,s=e[1].dims,u=e[1].dataType,l=V.normalizeAxis(t.axis,n),a=r[l],p=s.slice(0),h=V.size(p),g=U("input",o,n),w=U("indicesInput",u,s.length),v=K("output",o,p.length),y=[{type:"uint32",data:h},{type:"int32",data:a},{type:"uint32",data:l}];return y.push(...F(r)),y.push(...F(s)),y.push(...F(p)),{name:"GatherElements",shaderCache:{inputDependencies:["rank","rank"]},getRunData:()=>({outputs:[{dims:p,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(h/64)},programUniforms:y}),getShaderSource:x=>`\n      ${x.registerUniform("outputSize","u32").registerUniform("axisDimLimit","i32").registerUniform("axis","u32").declareVariables(g,w,v)}\n      ${x.mainStart()}\n      ${x.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}\n\n      let outputIndices = ${v.offsetToIndices("global_idx")};\n\n      var idx = ${w.getByOffset("global_idx")};\n      if (idx < 0) {\n        idx = idx + uniforms.axisDimLimit;\n      }\n      var inputIndices = ${g.type.indices}(outputIndices);\n      ${g.indicesSet("inputIndices","uniforms.axis","u32(idx)")};\n      let value = ${g.getByIndices("inputIndices")};\n\n      ${v.setByOffset("global_idx","value")};\n  }`}},As=e=>he({axis:e.axis}),Ts=(e,t)=>{let r=e.inputs;ql(r),e.compute(jl(e.inputs,t))}});var Yl,Zl,Os,Ps,Bs=q(()=>{"use strict";xe();$e();Yl=e=>{if(!e)throw new Error("Input is missing");if(e.length<2||e.length>3)throw new Error("Invaid input number.");if(e.length===3&&e[2].dims.length>2)throw new Error("Invalid input shape of C");if(e[0].dataType!==e[1].dataType||e.length===3&&e[0].dataType!==e[2].dataType)throw new Error("Input types are mismatched")},Zl=(e,t)=>{let r=e[0].dims.slice(),o=e[1].dims.slice(),[n,s,u]=Jr.getShapeOfGemmResult(r,t.transA,o,t.transB,e.length===3?e[2].dims:void 0),l=[n,s];if(!l)throw new Error("Can\'t use gemm on the given tensors");let a=V.size(l),p=[{type:"uint32",data:a},{type:"uint32",data:n},{type:"uint32",data:s},{type:"uint32",data:u},{type:"float32",data:t.alpha},{type:"float32",data:t.beta}],h=["type","type"];e.length===3&&(p.push(...F(e[2].dims)),h.push("rank")),p.push(...F(l));let g=w=>{let v="";t.transA&&t.transB?v="value += a[k * uniforms.M + m] * b[n * uniforms.K + k];":t.transA&&!t.transB?v="value += a[k * uniforms.M + m] * b[k * uniforms.N + n];":!t.transA&&t.transB?v="value += a[m * uniforms.K + k] * b[n * uniforms.K + k];":!t.transA&&!t.transB&&(v="value += a[m * uniforms.K + k] * b[k * uniforms.N + n];");let y=t.alpha===1?"":"value *= uniforms.alpha;",_=U("a",e[0].dataType,e[0].dims),I=U("b",e[1].dataType,e[1].dims),x=_.type.value,A=null,O=[_,I];e.length===3&&(A=U("c",e[2].dataType,e[2].dims.length),O.push(A));let C=K("output",e[0].dataType,l.length);O.push(C);let M=[{name:"output_size",type:"u32"},{name:"M",type:"u32"},{name:"N",type:"u32"},{name:"K",type:"u32"},{name:"alpha",type:"f32"},{name:"beta",type:"f32"}];return`\n  ${w.registerUniforms(M).declareVariables(...O)}\n\n  ${w.mainStart()}\n    ${w.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}\n\n    let m = global_idx / uniforms.N;\n    let n = global_idx % uniforms.N;\n\n    var value = ${x}(0);\n    for (var k: u32 = 0u; k < uniforms.K; k++) {\n      ${v}\n    }\n\n    ${y}\n    ${(()=>A!=null?`let cOffset = ${A.broadcastedIndicesToOffset("vec2(m, n)",C)}; value += ${x}(uniforms.beta) * ${A.getByOffset("cOffset")};`:"")()}\n    output[global_idx] = value;\n  }`};return{name:"Gemm",shaderCache:{hint:`${t.cacheKey}`,inputDependencies:h},getRunData:()=>({outputs:[{dims:l,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(a/64)},programUniforms:p}),getShaderSource:g}},Os=e=>{let t=e.transA,r=e.transB,o=e.alpha,n=e.beta;return{transA:t,transB:r,alpha:o,beta:n,cacheKey:`${e.transA};${e.transB};${e.alpha===1}`}},Ps=(e,t)=>{Yl(e.inputs),e.compute(Zl(e.inputs,t))}});var Ql,Jl,Xl,ks,Rs=q(()=>{"use strict";We();xe();$e();Ql=(e,t)=>{let r=e[0].dims,o=r,n=2,s=V.sizeToDimension(r,n),u=V.sizeFromDimension(r,n),l=He(u),a=u/l,p=[r[0],r[1],a],h=["rank","type","type"],g=[{type:"uint32",data:u},{type:"uint32",data:a}];g.push(...F(p),...F(p));let w=v=>{let y=U("x",e[0].dataType,p.length,l),_=U("scale",e[1].dataType,e[1].dims),I=U("bias",e[2].dataType,e[2].dims),x=K("output",e[0].dataType,p.length,l),A=[y,_,I,x],O=y.type.value,C=l===1?"f32":`vec${l}<f32>`,M=64,D=[{name:"normSize",type:"u32"},{name:"normPackedSize",type:"u32"}];return`\n  var<workgroup> meanShared : f32;\n  var<workgroup> squaredNormShared : f32;\n  var<workgroup> workgroupShared : array<${C}, ${M}>;\n  const workgroupSize = ${M}u;\n  ${v.registerUniforms(D).declareVariables(...A)}\n  ${v.mainStart(M)}\n    let norm = global_idx / workgroupSize;\n    let batch = norm / uniforms.x_shape[1];\n    let channel = norm % uniforms.x_shape[1];\n    let localIndex = local_id.x;\n\n    // initialize workgroup memory\n    var initial = ${C}(0);\n    for (var h = localIndex; h < uniforms.normPackedSize; h += workgroupSize) {\n      initial = initial + ${C}(${y.get("batch","channel","h")});\n    }\n    workgroupShared[localIndex] = initial;\n    workgroupBarrier();\n\n    // Calculate the mean of current channel data.\n    for (var currSize = workgroupSize >> 1;  currSize > 0; currSize = currSize >> 1) {\n      if (localIndex < currSize) {\n        workgroupShared[localIndex] = workgroupShared[localIndex] + workgroupShared[localIndex + currSize];\n      }\n      workgroupBarrier();\n    }\n    if (localIndex == 0) {\n      meanShared = ${ot("workgroupShared[0]",l)} / f32(uniforms.normSize);\n    }\n    workgroupBarrier();\n\n    // reinitialize workgroup memory.\n    initial = ${C}(0);\n    for (var h = localIndex; h < uniforms.normPackedSize; h += workgroupSize) {\n      let deviation =  ${C}(${y.get("batch","channel","h")}) - ${C}(meanShared);\n      initial = initial + deviation * deviation;\n    }\n    workgroupShared[localIndex] = initial;\n    workgroupBarrier();\n\n    // Calculate the sum of square of deviation of current channel data.\n    for (var currSize = workgroupSize >> 1;  currSize > 0; currSize = currSize >> 1) {\n      if (localIndex < currSize) {\n        workgroupShared[localIndex] = workgroupShared[localIndex] + workgroupShared[localIndex + currSize];\n      }\n      workgroupBarrier();\n    }\n    if (localIndex == 0) {\n      squaredNormShared = ${ot("workgroupShared[0]",l)};\n    }\n    workgroupBarrier();\n\n    let invStdDev = inverseSqrt(squaredNormShared / f32(uniforms.normSize) + f32(${t.epsilon}));\n    let channelScale = invStdDev * f32(${_.getByOffset("channel")});\n    let channelShift = f32(${I.getByOffset("channel")}) - meanShared * channelScale;\n    for (var h = localIndex; h < uniforms.normPackedSize; h += workgroupSize) {\n      let value = ${y.get("batch","channel","h")} * ${O}(${C}(channelScale)) + ${O}(${C}(channelShift));\n      ${x.set("batch","channel","h","value")};\n    }\n  }`};return{name:"InstanceNormalization",shaderCache:{hint:`${t.epsilon};${l}`,inputDependencies:h},getRunData:()=>({outputs:[{dims:o,dataType:e[0].dataType}],dispatchGroup:{x:s},programUniforms:g}),getShaderSource:w}},Jl=(e,t,r,o,n,s,u,l)=>{let a=He(u),p=64,h=a===1?"vec2f":`mat2x${a}f`,g=a===1?"f32":`vec${a}f`,w=(D,G)=>`${h}(${D}, ${G})`,v=n*u/a,y=Math.ceil(s/p),_=["type"],I=[{type:"uint32",data:y},{type:"uint32",data:s},{type:"uint32",data:Math.floor(u/a)},{type:"uint32",data:Math.floor(s*u/a)}],x=D=>{let G=U("input",t.dataType,t.dims,a);return`\n  ${D.declareVariables(G)}\n  @group(0) @binding(1) var<storage, read_write> output : array<${h}>;\n  struct Uniforms {wg_size:u32, H:u32, C:u32, image_size:u32};\n  @group(0) @binding(2) var<uniform> uniforms: Uniforms;\n\n  ${D.mainStart(p)}\n    let currentImageNumber = global_idx / ${p} / uniforms.C;\n    let currentChannelNumber = (global_idx / ${p}) % uniforms.C;\n    let wgId = global_idx % ${p};\n    let wgOffset = wgId * uniforms.wg_size;\n    if (wgOffset >= uniforms.H) {\n        return;\n    }\n    let wgMax = min(wgOffset + uniforms.wg_size, uniforms.H);\n\n    let offset = currentImageNumber * uniforms.image_size + currentChannelNumber;\n    var sum = ${Qe("f32",a)};\n    var squaredSum = ${Qe("f32",a)};\n    for (var i: u32 = wgOffset; i < wgMax; i++) {\n        let value = ${g}(input[offset + i * uniforms.C]);\n        sum += value;\n        squaredSum += value * value;\n    }\n    output[global_idx] = ${w("sum","squaredSum")};\n  }`},A=e.compute({name:"InstanceNormComputeMean",shaderCache:{hint:`${a}`,inputDependencies:_},getRunData:()=>({outputs:[{dims:[n,u,p,2],dataType:1}],dispatchGroup:{x:n*u/a},programUniforms:I}),getShaderSource:x},{inputs:[t],outputs:[-1]})[0],O=[{type:"uint32",data:v},{type:"uint32",data:s},{type:"uint32",data:Math.floor(u/a)},{type:"uint32",data:Math.floor(p*u/a)}],C=["type","type","type"],M=D=>{let G=U("scale",r.dataType,r.dims,a),E=U("bias",o.dataType,o.dims,a);return`\n  @group(0) @binding(0) var<storage, read> input : array<${h}>;\n  @group(0) @binding(1) var<storage, read> scale : array<${G.type.storage}>;\n  @group(0) @binding(2) var<storage, read> bias : array<${E.type.storage}>;\n  @group(0) @binding(3) var<storage, read_write> output : array<${h}>;\n  struct Uniforms {units_of_work : u32, H: u32, C : u32, image_size : u32};\n  @group(0) @binding(4) var<uniform> uniforms: Uniforms;\n\n  ${D.mainStart()}\n    ${D.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.units_of_work")}\n    let currentImageNumber = global_idx / uniforms.C;\n    let currentChannelNumber = global_idx % uniforms.C;\n\n    let offset = currentImageNumber * uniforms.image_size;\n    var sum = ${Qe("f32",a)};\n    var squaredSum = ${Qe("f32",a)};\n    for (var i: u32 = 0; i < ${p}; i++) {\n        let value = input[offset + i + currentChannelNumber * ${p}];\n        sum += value[0];\n        squaredSum += value[1];\n    }\n    sum = sum / f32(uniforms.H);\n    squaredSum = squaredSum / f32(uniforms.H);\n    let invStdDev = inverseSqrt(squaredSum - sum * sum + f32(${l}));\n    let channelScale = invStdDev * ${g}(scale[currentChannelNumber]);\n    let channelShift = ${g}(bias[currentChannelNumber]) - sum * channelScale;\n\n    output[global_idx] = ${w("channelScale","channelShift")};\n  }`};return e.compute({name:"InstanceNormComputeChannelScaleShift",shaderCache:{hint:`${a};${l}`,inputDependencies:C},getRunData:()=>({outputs:[{dims:[n,u,2],dataType:1}],dispatchGroup:{x:Math.ceil(v/64)},programUniforms:O}),getShaderSource:M},{inputs:[A,r,o],outputs:[-1]})[0]},Xl=(e,t,r)=>{let o=t[0].dims,n=o,s=o[0],u=o[o.length-1],l=V.sizeFromDimension(o,1)/u,a=He(u),p=V.size(n)/a,h=[{type:"uint32",data:l},{type:"uint32",data:Math.floor(u/a)}],g=["type","type"],w=Jl(e,t[0],t[1],t[2],s,l,u,r.epsilon),v=y=>{let _=Ge(t[0].dataType),I=a===1?"vec2f":`mat2x${a}f`,x=a===1?_:`vec${a}<${_}>`,A=U("input",t[0].dataType,t[0].dims,a),O=K("output",t[0].dataType,n,a);return`\n  @group(0) @binding(0) var<storage, read> input : array<${A.type.storage}>;\n  @group(0) @binding(1) var<storage, read> scaleInput : array<${I}>;\n  @group(0) @binding(2) var<storage, read_write> output : array<${O.type.storage}>;\n  struct Uniforms {H: u32, C : u32};\n  @group(0) @binding(3) var<uniform> uniforms: Uniforms;\n\n  ${y.mainStart()}\n    let currentImageNumber = global_idx / (uniforms.C * uniforms.H);\n    let currentChannelNumber = global_idx % uniforms.C;\n\n    let scaleOffset = currentImageNumber * uniforms.C + currentChannelNumber;\n    let scale = scaleInput[scaleOffset];\n    output[global_idx] = fma(input[global_idx], ${x}(scale[0]), ${x}(scale[1]));\n  }`};e.compute({name:"InstanceNormalizationNHWC",shaderCache:{hint:`${a}`,inputDependencies:g},getRunData:()=>({outputs:[{dims:n,dataType:t[0].dataType}],dispatchGroup:{x:Math.ceil(p/64)},programUniforms:h}),getShaderSource:v},{inputs:[t[0],w]})},ks=(e,t)=>{t.format==="NHWC"?Xl(e,e.inputs,t):e.compute(Ql(e.inputs,t))}});var ec,tc,Ds,Ms=q(()=>{"use strict";We();xe();$e();ec=e=>{if(!e||e.length<2)throw new Error("layerNorm requires at least 2 inputs.")},tc=(e,t,r)=>{let o=e[0].dims,n=e[1],s=e[2],u=o,l=V.normalizeAxis(t.axis,o.length),a=V.sizeToDimension(o,l),p=V.sizeFromDimension(o,l),h=V.size(n.dims),g=s?V.size(s.dims):0;if(h!==p||s&&g!==p)throw new Error(`Size of X.shape()[axis:] == ${p}.\n       Size of scale and bias (if provided) must match this.\n       Got scale size of ${h} and bias size of ${g}`);let w=[];for(let C=0;C<o.length;++C)C<l?w.push(o[C]):w.push(1);let v=He(p),y=["type","type"],_=[{type:"uint32",data:a},{type:"float32",data:p},{type:"uint32",data:Math.floor(p/v)},{type:"float32",data:t.epsilon}];s&&y.push("type");let I=r>1,x=r>2,A=C=>{let M=Ge(e[0].dataType),D=[U("x",e[0].dataType,e[0].dims,v),U("scale",n.dataType,n.dims,v)];s&&D.push(U("bias",s.dataType,s.dims,v)),D.push(K("output",e[0].dataType,u,v)),I&&D.push(K("mean_data_output",1,w)),x&&D.push(K("inv_std_output",1,w));let G=[{name:"norm_count",type:"u32"},{name:"norm_size",type:"f32"},{name:"norm_size_vectorized",type:"u32"},{name:"epsilon",type:"f32"}];return`\n  ${C.registerUniforms(G).declareVariables(...D)}\n  ${C.mainStart()}\n    ${C.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.norm_count")}\n    let offset = global_idx * uniforms.norm_size_vectorized;\n    var meanVector = ${Qe("f32",v)};\n    var meanSquareVector = ${Qe("f32",v)};\n\n    for (var h: u32 = 0u; h < uniforms.norm_size_vectorized; h++) {\n      let value = ${ut(M,v,"x[h + offset]")};\n      meanVector += value;\n      meanSquareVector += value * value;\n    }\n    let mean = ${ot("meanVector",v)} / uniforms.norm_size;\n    let invStdDev =\n        inverseSqrt(${ot("meanSquareVector",v)} / uniforms.norm_size - mean * mean + uniforms.epsilon);\n\n    for (var j: u32 = 0; j < uniforms.norm_size_vectorized; j++) {\n      let f32input = ${ut(M,v,"x[j + offset]")};\n      let f32scale = ${ut(M,v,"scale[j]")};\n      output[j + offset] = ${D[0].type.value}((f32input - mean) * invStdDev * f32scale\n        ${s?`+ ${ut(M,v,"bias[j]")}`:""}\n      );\n    }\n\n    ${I?"mean_data_output[global_idx] = mean":""};\n    ${x?"inv_std_output[global_idx] = invStdDev":""};\n  }`},O=[{dims:u,dataType:e[0].dataType}];return I&&O.push({dims:w,dataType:1}),x&&O.push({dims:w,dataType:1}),{name:"LayerNormalization",shaderCache:{hint:`${v};${r}`,inputDependencies:y},getRunData:()=>({outputs:O,dispatchGroup:{x:Math.ceil(a/64)},programUniforms:_}),getShaderSource:A}},Ds=(e,t)=>{ec(e.inputs),e.compute(tc(e.inputs,t,e.outputCount))}});var rc,zs,Us,nc,mo,Vs,Ns=q(()=>{"use strict";xe();Le();Zr();Jn();$e();or();rc=(e,t)=>{let r=e[0],o=e[1],n=e[2],s=e[3],u=e[4],l=e[5],a=e[6],p=e[7];if(r.dims.length!==3&&r.dims.length!==5)throw new Error("Input query is expected to have 3 or 5 dimensions");let h=!1,g=r.dims[0],w=r.dims[1],v=r.dims.length===3?h?r.dims[2]/3:r.dims[2]:t.numHeads*r.dims[4],y=w,_=0,I=0,x=Math.floor(v/t.numHeads);if(a&&p){if(a.dims.length!==4)throw new Error(\'Input "past_key" is expected to have 4 dimensions\');if(p.dims.length!==4)throw new Error(\'Input "past_value" is expected to have 4 dimensions\');_=a.dims[2],I=a.dims[2]}else if(a||p)throw new Error(\'Input "past_key" and "past_value" shall be both present or both absent\');let A;if(o){if(r.dims.length!==3)throw new Error(\'Input "query" is expected to have 3 dimensions when key is given\');if(o.dims.length<3||o.dims.length>5)throw new Error(\'Input "key" is expected to have 3, 4, or 5 dimensions\');if(r.dims[0]!==o.dims[0])throw new Error(\'Input "query" and "key" shall have same dim 0 (batch size)\');if(o.dims.length===3){if(o.dims[2]!==r.dims[2])throw new Error(\'Input "query" and "key" shall have same dim 2 (hidden_size)\');A=2,y=o.dims[1]}else if(o.dims.length===5){if(o.dims[2]!==t.numHeads||o.dims[3]!==2||o.dims[4]!==x)throw new Error(\'Expect "key" shape (batch_size, kv_sequence_length, num_heads, 2, head_size) for packed kv\');if(n)throw new Error(\'Expect "value" be none when "key" has packed kv format.\');A=5,y=o.dims[1]}else{if(o.dims[1]!==t.numHeads||o.dims[3]!==x)throw new Error(\'Expect "key" shape (batch_size, num_heads, kv_sequence_length, head_size) for past_key\');A=0,y=o.dims[2]}}else{if(r.dims.length!==3&&r.dims.length!==5)throw new Error(\'Input "query" is expected to have 3 or 5 dimensions when key is empty\');if(r.dims.length===5&&(r.dims[2]!==t.numHeads||r.dims[3]!==3))throw new Error(\'Expect "query" shape (batch_size, kv_sequence_length, num_heads, 3, head_size) for packed kv\');A=3}if(s){if(s.dims.length!==1)throw new Error(\'Input "bias" is expected to have 1 dimension\');if(n&&r.dims.length===5&&r.dims[3]===2)throw new Error("bias is not allowed for packed kv.")}let O=0;if(u){O=8;let E=u.dims;throw E.length===1?E[0]===g?O=1:E[0]===3*g+2&&(O=3):E.length===2&&E[0]===g&&E[1]===y&&(O=5),O===8?new Error(\'Input "key_padding_mask" shape shall be (batch_size) or (batch_size, kv_sequence_length)\'):new Error("Mask not supported")}let C=!1,M=v;if(n){if(n.dims.length!==3&&n.dims.length!==4)throw new Error(\'Input "value" is expected to have 3 or 4 dimensions\');if(r.dims[0]!==n.dims[0])throw new Error(\'Input "query" and "value" shall have same dim 0 (batch_size)\');if(n.dims.length===3){if(y!==n.dims[1])throw new Error(\'Input "key" and "value" shall have the same dim 1 (kv_sequence_length)\');M=n.dims[2]}else{if(y!==n.dims[2])throw new Error(\'Input "past_key" and "past_value" shall have the same dim 2 (kv_sequence_length)\');M=n.dims[1]*n.dims[3],C=!0}}let D=_+y,G=!1;if(u)throw new Error("Key padding mask is not supported");if(l)throw new Error("extraAddQk is not supported");if(a)throw new Error("pastKey is not supported");if(p)throw new Error("pastValue is not supported");return{batchSize:g,sequenceLength:w,pastSequenceLength:_,kvSequenceLength:y,totalSequenceLength:D,maxSequenceLength:I,inputHiddenSize:0,hiddenSize:v,vHiddenSize:M,headSize:x,vHeadSize:Math.floor(M/t.numHeads),numHeads:t.numHeads,isUnidirectional:!1,pastPresentShareBuffer:!1,maskFilterValue:t.maskFilterValue,maskType:O,scale:t.scale,broadcastResPosBias:G,passPastInKv:C,qkvFormat:A}},zs=e=>he({...e}),Us=he({perm:[0,2,1,3]}),nc=(e,t,r,o,n,s,u)=>{let l=[o,n,s],a=V.size(l),p=[{type:"uint32",data:a},{type:"uint32",data:u},{type:"uint32",data:s}],h=g=>{let w=K("qkv_with_bias",t.dataType,l),v=U("qkv",t.dataType,l),y=U("bias",r.dataType,l),_=[{name:"output_size",type:"u32"},{name:"bias_offset",type:"u32"},{name:"hidden_size",type:"u32"}];return`\n  ${g.registerUniforms(_).declareVariables(v,y,w)}\n  ${g.mainStart()}\n    ${g.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}\n    let bias_offset_idx = (global_idx % uniforms.hidden_size) + uniforms.bias_offset;\n\n    qkv_with_bias[global_idx] = qkv[global_idx] + bias[bias_offset_idx];\n  }`};return e.compute({name:"MultiHeadAttentionAddBias",shaderCache:{inputDependencies:["type","type"]},getRunData:()=>({outputs:[{dims:l,dataType:t.dataType,gpuDataType:0}],dispatchGroup:{x:Math.ceil(a/64)},programUniforms:p}),getShaderSource:h},{inputs:[t,r],outputs:[-1]})[0]},mo=(e,t,r,o,n,s,u,l)=>{let a=s;if(u){if(o===1)throw new Error("AddBiasReshape is not implemented. Please export your model with packed QKV or KV");return a=nc(e,s,u,t,o,r*n,l),a=a.reshape([t,o,r,n]),e.compute(dt(a,Us.perm),{inputs:[a],outputs:[-1]})[0]}else return s.dims.length===3&&(a=s.reshape([t,o,r,n])),e.compute(dt(a,Us.perm),{inputs:[a],outputs:[-1]})[0]},Vs=(e,t)=>{let r=rc(e.inputs,t);if(e.inputs[0].dims.length===5)throw new Error("Packed QKV is not implemented");if(e.inputs[1]?.dims.length===5)throw new Error("Packed KV is not implemented");let o=e.inputs[1]&&e.inputs[2]&&e.inputs[1].dims.length===4&&e.inputs[2].dims.length===4,n=mo(e,r.batchSize,r.numHeads,r.sequenceLength,r.headSize,e.inputs[0],e.inputs[3],0);if(o)return on(e,n,e.inputs[1],e.inputs[2],e.inputs[4],void 0,void 0,void 0,e.inputs[5],r,t);let s=mo(e,r.batchSize,r.numHeads,r.kvSequenceLength,r.headSize,e.inputs[1],e.inputs[3],r.hiddenSize),u=mo(e,r.batchSize,r.numHeads,r.kvSequenceLength,r.vHeadSize,e.inputs[2],e.inputs[3],2*r.hiddenSize);on(e,n,s,u,e.inputs[4],void 0,e.inputs[6],e.inputs[7],e.inputs[5],r,t)}});var oc,ac,ic,sc,uc,dc,lc,cc,Ws,Gs=q(()=>{"use strict";We();xe();$e();oc=e=>{if(!e||e.length<1)throw new Error("Too few inputs");if(e[0].dataType!==1)throw new Error("Input type must be float.");if(e.length>=2){let t=e[0].dims.length*2===e[1].dims[0];if(e.length===4&&(t=e[3].dims[0]*2===e[1].dims[0]),!t)throw new Error("The pads should be a 1D tensor of shape [2 * input_rank] or [2 * num_axes].")}},ac=(e,t,r)=>{let o="";for(let n=t-1;n>=0;--n)o+=`\n            k = i32(${e.indicesGet("indices",n)}) - ${de("uniforms.pads",n,r)};\n            if (k < 0) {\n              break;\n            }\n            if (k >= i32(${de("uniforms.x_shape",n,t)})) {\n              break;\n            }\n            offset += k * i32(${de("uniforms.x_strides",n,t)});\n        `;return`\n          value = ${e.type.value}(uniforms.constant_value);\n          for (var i = 0; i < 1; i++) {\n            var offset = 0;\n            var k = 0;\n            ${o}\n            value = x[offset];\n          }\n      `},ic=(e,t,r)=>{let o="";for(let n=t-1;n>=0;--n)o+=`\n                k = i32(${e.indicesGet("indices",n)}) - ${de("uniforms.pads",n,r)};\n                if (k < 0) {\n                  k = -k;\n                }\n                {\n                  let _2n_1 = 2 * (i32(${de("uniforms.x_shape",n,t)}) - 1);\n                  k = k % _2n_1;\n                  if(k >= i32(${de("uniforms.x_shape",n,t)})) {\n                    k = _2n_1 - k;\n                  }\n                }\n                offset += k * i32(${de("uniforms.x_strides",n,t)});\n            `;return`\n              var offset = 0;\n              var k = 0;\n              ${o}\n              value = x[offset];\n          `},sc=(e,t,r)=>{let o="";for(let n=t-1;n>=0;--n)o+=`\n                k = i32(${e.indicesGet("indices",n)}) - ${de("uniforms.pads",n,r)};\n                if (k < 0) {\n                  k = 0;\n                }\n                if (k >= i32(${de("uniforms.x_shape",n,t)})) {\n                  k = i32(${de("uniforms.x_shape",n,t)}) - 1;\n                }\n                offset += k * i32(${de("uniforms.x_strides",n,t)});\n            `;return`\n              var offset = 0;\n              var k = 0;\n              ${o}\n              value = x[offset];\n          `},uc=(e,t,r)=>{let o="";for(let n=t-1;n>=0;--n)o+=`\n                k = i32(${e.indicesGet("indices",n)}) - ${de("uniforms.pads",n,r)};\n                if (k < 0)  {\n                  k += i32(${de("uniforms.x_shape",n,t)}]);\n                }\n                if (k >= i32(${de("uniforms.x_shape",n,t)})) {\n                  k -= i32(${de("uniforms.x_shape",n,t)});\n                }\n                offset += k * i32(${de("uniforms.x_strides",n,t)});\n            `;return`\n              var offset = 0;\n              var k = 0;\n              ${o}\n              value = x[offset];\n          `},dc=(e,t,r)=>{switch(r.mode){case 0:return ac(e,t,r.pads.length);case 1:return ic(e,t,r.pads.length);case 2:return sc(e,t,r.pads.length);case 3:return uc(e,t,r.pads.length);default:throw new Error("Invalid mode")}},lc=(e,t)=>{let r=V.padShape(e[0].dims.slice(),t.pads),o=e[0].dims,s=[{type:"uint32",data:V.size(r)},{type:"uint32",data:t.pads}];if(t.mode===0){let a=nt(e[0].dataType);s.push({type:a,data:t.value})}s.push(...F(e[0].dims),...F(r));let u=["rank"],l=a=>{let p=K("output",e[0].dataType,r.length),h=U("x",e[0].dataType,o.length),g=h.type.value,w=dc(p,o.length,t),v=[{name:"output_size",type:"u32"},{name:"pads",type:"i32",length:t.pads.length}];return t.mode===0&&v.push({name:"constant_value",type:g}),`\n            ${a.registerUniforms(v).declareVariables(h,p)}\n            ${a.mainStart()}\n            ${a.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}\n\n            let indices = ${p.offsetToIndices("global_idx")};\n\n            var value = ${g}(0);\n            ${w}\n            output[global_idx] = value;\n        }`};return{name:"Pad",shaderCache:{hint:`${t.mode}`,inputDependencies:u},getRunData:()=>({outputs:[{dims:r,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(V.size(r)/64)},programUniforms:s}),getShaderSource:l}},cc=(e,t)=>{if(e.length>1){let r=e[1].getBigInt64Array(),o=e.length>=3&&e[2].data?e[2].getFloat32Array()[0]:0,n=e[0].dims.length,s=new Int32Array(2*n).fill(0);if(e.length>=4){let l=e[3].getBigInt64Array();for(let a=0;a<l.length;a++)s[Number(l[a])]=Number(r[a]),s[Number(l[a])+n]=Number(r[a+l.length])}else r.forEach((l,a)=>s[Number(a)]=Number(l));let u=[];return s.forEach(l=>u.push(l)),{mode:t.mode,value:o,pads:u}}else return t},Ws=(e,t)=>{oc(e.inputs);let r=cc(e.inputs,t);e.compute(lc(e.inputs,r),{inputs:[0]})}});var fn,Hs,Ls,Fs,Ks,pc,mc,qs,js,Ys,Zs,Qs,Js,Xs,eu,tu,ru,nu,ou,au=q(()=>{"use strict";rr();xe();$e();fn=e=>{if(tr.webgpu.validateInputContent&&(!e||e.length!==1))throw new Error("Pool ops requires 1 input.")},Hs=(e,t,r)=>{let o=t.format==="NHWC",n=e.dims.slice();o&&n.splice(1,0,n.pop());let s=Object.hasOwnProperty.call(t,"dilations"),u=t.kernelShape.slice(),l=t.strides.slice(),a=s?t.dilations.slice():[],p=t.pads.slice();Wt.adjustPoolAttributes(r,n,u,l,a,p);let h=Wt.computePoolOutputShape(r,n,l,a,u,p,t.autoPad),g=Object.assign({},t);s?Object.assign(g,{kernelShape:u,strides:l,pads:p,dilations:a,cacheKey:t.cacheKey}):Object.assign(g,{kernelShape:u,strides:l,pads:p,cacheKey:t.cacheKey});let w=h.slice();return w.push(w.splice(1,1)[0]),[g,o?w:h]},Ls=(e,t)=>{let r=t.format==="NHWC",o=V.size(e),n=V.size(t.kernelShape),s=[{type:"uint32",data:o},{type:"uint32",data:n}],u=[{name:"outputSize",type:"u32"},{name:"kernelSize",type:"u32"}];if(t.kernelShape.length<=2){let l=t.kernelShape[t.kernelShape.length-1],a=t.strides[t.strides.length-1],p=t.pads[t.pads.length/2-1],h=t.pads[t.pads.length-1],g=!!(p+h);s.push({type:"uint32",data:l},{type:"uint32",data:a},{type:"uint32",data:p},{type:"uint32",data:h}),u.push({name:"kw",type:"u32"},{name:"sw",type:"u32"},{name:"pwStart",type:"u32"},{name:"pwEnd",type:"u32"});let w=!1;if(t.kernelShape.length===2){let v=t.kernelShape[t.kernelShape.length-2],y=t.strides[t.strides.length-2],_=t.pads[t.pads.length/2-2],I=t.pads[t.pads.length-2];w=!!(_+I),s.push({type:"uint32",data:v},{type:"uint32",data:y},{type:"uint32",data:_},{type:"uint32",data:I}),u.push({name:"kh",type:"u32"},{name:"sh",type:"u32"},{name:"phStart",type:"u32"},{name:"phEnd",type:"u32"})}return[s,u,!0,g,w]}else{if(r)throw new Error("Pooling with kernelShape.length > 2 is not supported for NHWC format.");let l=V.computeStrides(t.kernelShape);s.push({type:"uint32",data:l},{type:"uint32",data:t.pads},{type:"uint32",data:t.strides}),u.push({name:"kernelStrides",type:"u32",length:l.length},{name:"pads",type:"u32",length:t.pads.length},{name:"strides",type:"u32",length:t.strides.length});let a=t.pads.reduce((p,h)=>p+h);return[s,u,!!a,!1,!1]}},Fs=(e,t,r,o,n,s,u,l,a,p,h,g)=>{let w=n.format==="NHWC",v=t.type.value,y=K("output",t.type.tensor,o);if(n.kernelShape.length<=2){let _="",I="",x="",A=r-(w?2:1);if(h?_=`\n                for (var i: u32 = 0u; i < uniforms.kw; i++) {\n                  xIndices[${A}] = indices[${A}] * uniforms.sw - uniforms.pwStart + i;\n                  if (xIndices[${A}] < 0 || xIndices[${A}]\n                      >= uniforms.x_shape[${A}]) {\n                    pad++;\n                    continue;\n                  }\n                  let x_val = x[${t.indicesToOffset("xIndices")}];\n                  ${s}\n                }`:_=`\n                for (var i: u32 = 0u; i < uniforms.kw; i++) {\n                  xIndices[${A}] = indices[${A}] * uniforms.sw - uniforms.pwStart + i;\n                  let x_val = x[${t.indicesToOffset("xIndices")}];\n                  ${s}\n                }`,n.kernelShape.length===2){let C=r-(w?3:2);g?I=`\n                for (var j: u32 = 0u; j < uniforms.kh; j++) {\n                  xIndices[${C}] = indices[${C}] * uniforms.sh - uniforms.phStart + j;\n                  if (xIndices[${C}] < 0 || xIndices[${C}] >= uniforms.x_shape[${C}]) {\n                    pad += i32(uniforms.kw);\n                    continue;\n                  }\n              `:I=`\n                for (var j: u32 = 0u; j < uniforms.kh; j++) {\n                  xIndices[${C}] = indices[${C}] * uniforms.sh - uniforms.phStart + j;\n                `,x=`\n              }\n            `}return`\n            ${e.registerUniforms(a).declareVariables(t,y)}\n\n            ${e.mainStart()}\n              ${e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}\n\n              let indices = ${y.offsetToIndices("global_idx")};\n              var xIndices = ${y.offsetToIndices("global_idx")};\n\n              var value = ${v}(${l});\n              var pad = 0;\n              ${I}\n              ${_}\n              ${x}\n              ${u}\n\n              output[global_idx] = value;\n            }`}else{if(w)throw new Error("Pooling with kernelShape.length > 2 is not supported for NHWC format.");let _=n.kernelShape.length,I=n.pads.length,x="";return p?x=`\n                if (xIndices[j] >= uniforms.x_shape[j]) {\n                  pad++;\n                  isPad = true;\n                  break;\n                }\n              }\n              if (!isPad) {\n                let x_val = x[${t.indicesToOffset("xIndices")}];\n                ${s}\n              }`:x=`\n              }\n              let x_val = x[${t.indicesToOffset("xIndices")}];\n              ${s}\n            `,`\n            ${e.registerUniforms(a).declareVariables(t,y)}\n\n            ${e.mainStart()}\n              ${e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}\n              let indices = ${y.offsetToIndices("global_idx")};\n              var xIndices = ${y.offsetToIndices("global_idx")};\n\n              var offsets: array<u32, ${_}>;\n\n              var value = ${v}(${l});\n              var pad = 0;\n              var isPad = false;\n\n              for (var i: u32 = 0u; i < uniforms.kernelSize; i++) {\n                var offset = i;\n                for (var j = 0u; j < ${_-1}u; j++) {\n                  offsets[j] = offset / ${de("uniforms.kernelStrides","j",_)};\n                  offset -= offsets[j] * ${de("uniforms.kernelStrides","j",_)};\n                }\n                offsets[${_-1}] = offset;\n\n                isPad = false;\n                for (var j = ${r-_}u; j < ${r}u; j++) {\n                  xIndices[j] = indices[j] * ${de("uniforms.strides",`j - ${r-_}u`,_)}\n                    + offsets[j - ${r-_}u] - ${de("uniforms.pads","j - 2u",I)};\n                  ${x}\n              }\n              ${u}\n\n              output[global_idx] = value;\n            }`}},Ks=e=>`${e.format};${e.ceilMode};${e.autoPad};${e.kernelShape.length}`,pc=e=>`${Ks(e)};${e.countIncludePad}`,mc=e=>`${Ks(e)};${e.storageOrder};${e.dilations}`,qs=e=>({format:e.format,autoPad:["NOTSET","VALID","SAME_UPPER","SAME_LOWER"][e.auto_pad],ceilMode:e.ceil_mode,kernelShape:e.kernel_shape,strides:e.strides,pads:e.pads}),js=(e,t,r,o)=>{let[n,s]=Hs(t,o,r),u=U("x",t.dataType,t.dims.length),l=u.type.value,a="value += x_val;",p="";n.countIncludePad?p+=`value /= ${l}(uniforms.kernelSize);`:p+=`value /= ${l}(i32(uniforms.kernelSize) - pad);`;let[h,g,w,v,y]=Ls(s,n);h.push(...F(t.dims),...F(s));let _=["rank"];return{name:e,shaderCache:{hint:`${o.cacheKey};${w};${v};${y}`,inputDependencies:_},getRunData:()=>({outputs:[{dims:s,dataType:t.dataType}],dispatchGroup:{x:Math.ceil(V.size(s)/64)},programUniforms:h}),getShaderSource:I=>Fs(I,u,t.dims.length,s.length,n,a,p,0,g,w,v,y)}},Ys=e=>{let t=e.count_include_pad!==0,r=qs(e);if(r.ceilMode!==0)throw new Error("using ceil() in shape computation is not yet supported for AveragePool");let o={countIncludePad:t,...r,cacheKey:""};return{...o,cacheKey:pc(o)}},Zs=(e,t)=>{fn(e.inputs),e.compute(js("AveragePool",e.inputs[0],!1,t))},Qs={autoPad:"",ceilMode:0,countIncludePad:!1,kernelShape:[],strides:[],pads:[],storageOrder:0,dilations:[]},Js=e=>{let t=e.format;return{format:t,...Qs,cacheKey:t}},Xs=(e,t)=>{fn(e.inputs),e.compute(js("GlobalAveragePool",e.inputs[0],!0,t))},eu=(e,t,r,o)=>{let[n,s]=Hs(t,o,r),u=`\n      value = max(x_val, value);\n    `,l="",a=U("x",t.dataType,t.dims.length),p=["rank"],[h,g,w,v,y]=Ls(s,n);return h.push(...F(t.dims),...F(s)),{name:e,shaderCache:{hint:`${o.cacheKey};${w};${v};${y}`,inputDependencies:p},getRunData:()=>({outputs:[{dims:s,dataType:t.dataType}],dispatchGroup:{x:Math.ceil(V.size(s)/64)},programUniforms:h}),getShaderSource:_=>Fs(_,a,t.dims.length,s.length,n,u,l,-1e5,g,w,v,y)}},tu=(e,t)=>{fn(e.inputs),e.compute(eu("MaxPool",e.inputs[0],!1,t))},ru=e=>{let t=e.storage_order,r=e.dilations,o=qs(e);if(t!==0)throw new Error("column major storage order is not yet supported for MaxPool");if(o.ceilMode!==0)throw new Error("using ceil() in shape computation is not yet supported for MaxPool");let n={storageOrder:t,dilations:r,...o,cacheKey:""};return{...n,cacheKey:mc(n)}},nu=e=>{let t=e.format;return{format:t,...Qs,cacheKey:t}},ou=(e,t)=>{fn(e.inputs),e.compute(eu("GlobalMaxPool",e.inputs[0],!0,t))}});var hc,gc,iu,su=q(()=>{"use strict";rr();We();$e();hc=(e,t,r)=>{let o=e===t,n=e<t&&r<0,s=e>t&&r>0;if(o||n||s)throw new Error("Range these inputs\' contents are invalid.")},gc=(e,t,r,o)=>{let n=Math.abs(Math.ceil((t-e)/r)),s=[n],u=n,l=nt(o),a=[{type:"uint32",data:u},{type:l,data:e},{type:l,data:r},...F(s)],p=h=>{let g=K("output",o,s.length),w=g.type.value,v=[{name:"outputSize",type:"u32"},{name:"start",type:w},{name:"delta",type:w}];return`\n        ${h.registerUniforms(v).declareVariables(g)}\n        ${h.mainStart()}\n        ${h.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}\n        output[global_idx] = uniforms.start + ${w}(global_idx) * uniforms.delta;\n      }`};return{name:"Range",shaderCache:{hint:`${o}`},getShaderSource:p,getRunData:()=>({outputs:[{dims:s,dataType:o}],dispatchGroup:{x:Math.ceil(u/64)},programUniforms:a})}},iu=e=>{let t=0,r=0,o=0;e.inputs[0].dataType===6?(t=e.inputs[0].getInt32Array()[0],r=e.inputs[1].getInt32Array()[0],o=e.inputs[2].getInt32Array()[0]):e.inputs[0].dataType===1&&(t=e.inputs[0].getFloat32Array()[0],r=e.inputs[1].getFloat32Array()[0],o=e.inputs[2].getFloat32Array()[0]),tr.webgpu.validateInputContent&&hc(t,r,o),e.compute(gc(t,r,o,e.inputs[0].dataType),{inputs:[]})}});var yc,bc,wc,vc,$c,Sc,xc,_c,Cc,Ic,Ac,uu,Tc,Ec,Oc,Pc,Bc,du,lu,cu=q(()=>{"use strict";xe();Le();$e();yc=(e,t)=>{if(e.every(r=>r>0||(()=>{throw new Error("Resize requires scales input values to be positive")})),e.length>0){if(t.mode==="linear"){if(!(e.length===2||e.length===3||e.length===4&&e[0]===1&&e[1]===1||e.length===4&&e[0]===1&&e[3]===1||e.length===5&&e[0]===1&&e[1]===1))throw new Error(`For linear mode, Resize requires scales to be 2D, 3D, 4D with either two outermost or one innermost and\n            one outermost scale values equal to 1, or 5D with two outermost scale values equal to 1`)}else if(t.mode==="cubic"&&!(e.length===2||e.length===4&&e[0]===1&&e[1]===1||e.length===4&&e[0]===1&&e[3]===1))throw new Error("Resize requires scales input size to be 2 or 4 for cubic mode")}},bc=(e,t,r)=>{t.every(n=>n>=0&&n<r||(()=>{throw new Error("Resize requires axes input values to be positive and less than rank")}));let o=new Array(r).fill(1);return t.forEach((n,s)=>o[n]=e[s]),o},wc=(e,t,r,o,n,s)=>{let[u,l,a]=r>10?[1,2,3]:[-1,e.length>1?1:-1,-1],p=e[0].dims.length;if(u>0&&e.length>u&&e[u].dims.length>0)e[u].getFloat32Array().forEach(h=>s.push(h));else if(t.coordinateTransformMode==="tf_crop_and_resize")throw new Error("Resize requires RoI input to be specified when coordinateTransformMode is tfCropAndResize");if(l>0&&e.length>l&&e[l].dims.length>0){if(e[l].getFloat32Array().forEach(h=>o.push(h)),o.length!==0&&o.length!==p&&r>=18&&o.length!==t.axes.length)throw new Error("Resize requires scales input size to be same as input rank or axes size for opset 18 and up");yc(o,t),t.axes.length>0&&bc(o,t.axes,p).forEach((h,g)=>o[g]=h)}if(a>0&&e.length>a&&(e[a].getBigInt64Array().forEach(h=>n.push(Number(h))),n.length!==p||r>=18&&n.length===t.axes.length))throw new Error("Resize requires sizes input size to be same as input rank or axes size for opset 18 and up");if(t.axes.length>0){if(o.length!==t.axes.length)throw new Error(\'Resize requires "scales" input size to be of axes rank when axes attributes is specified\');if(n.length!==t.axes.length)throw new Error(\'Resize requires "sizes" input size to be of rank axes rank when axes attributes is specified\')}if(typeof o<"u"&&typeof n<"u"&&o.length>0&&n.length>p)throw new Error("Resize requires only of scales or sizes to be specified")},vc=(e,t)=>`fn getOriginalCoordinateFromResizedCoordinate(xResized: u32, xScale: f32, lengthResized: u32,\n     lengthOriginal: u32, roiStart: f32, roiEnd: f32) -> ${t} { `+(()=>{switch(e){case"asymmetric":return`return ${t}(xResized) / ${t}(xScale);`;case"pytorch_half_pixel":return`if (lengthResized > 1) {\n                    return (${t}(xResized) + 0.5) / ${t}(xScale) - 0.5;\n                  } else {\n                    return 0.0;\n                  }`;case"tf_half_pixel_for_nn":return`return (${t}(xResized) + 0.5) / ${t}(xScale);`;case"align_corners":return`if (lengthResized == 1) {\n                    return 0.0;\n                  } else {\n                    // The whole part and the fractional part are calculated separately due to inaccuracy of floating\n                    // point division. As an example, f32(21) / f32(7) may evaluate to 2.99... instead of 3, causing an\n                    // offset-by-one error later in floor().\n                    let whole = ${t}(xResized * (lengthOriginal - 1) / (lengthResized - 1));\n                    let fract =\n                        ${t}(xResized * (lengthOriginal - 1) % (lengthResized - 1)) / ${t}(lengthResized - 1);\n                    return whole + fract;\n                  }`;case"tf_crop_and_resize":return`if (lengthResized > 1) {\n                    return ${t}(roiStart) * ${t}(lengthOriginal - 1) +\n                        (${t}(xResized) * ${t}(roiEnd - roiStart) * ${t}(lengthOriginal - 1)) /\n                        ${t}(lengthResized - 1);\n                  } else {\n                    return 0.5 * ${t}(roiStart + roiEnd) * ${t}(lengthOriginal - 1);\n                  }`;case"half_pixel_symmetric":return`const outputWidth = ${t}xScale * ${t}(lengthResized);\n                  const adjustment = ${t}(lengthResized) / outputWidth;\n                  const center = ${t}(lengthOriginal) / 2;\n                  const offset = center * (1 - adjustment);\n                  return offset + ((${t}(xResized) + 0.5) / ${t}(xScale)) - 0.5;`;case"half_pixel":return`return ((${t}(xResized) + 0.5) / ${t}(xScale)) - 0.5;`;default:throw new Error(`Coordinate transform mode ${e} is not supported`)}})()+"}",$c=(e,t,r)=>`fn getNearestPixelFromOriginal(xOriginal: ${r}, isDownSample: bool) -> ${r} {`+(()=>{switch(e){case"round_prefer_ceil":return"if (fract(xOriginal) == 0.5) {             return ceil(xOriginal);           } else {             return round(xOriginal);           }";case"floor":return"return floor(xOriginal);";case"ceil":return"return ceil(xOriginal);";case"round_prefer_floor":return"if (fract(xOriginal) == 0.5) {                     return floor(xOriginal);                   } else {                     return round(xOriginal);                   }";case"simple":default:if(t<11)return"if (isDownSample)                     {                       return ceil(xOriginal);                     } else {                       return xOriginal;                     }";throw new Error(`Nearest mode ${e} is not supported`)}})()+"}",Sc=(e,t,r)=>{let o=new Array(r).fill(0).concat(new Array(r).fill(1)),n=e.length===0?o:e.slice();return t.length>0?(t.forEach((s,u)=>{o[s]=n[u],o[u+r]=n[t.length+u]}),o):n},xc=(e,t,r,o)=>{let n=[];if(r.length>0)if(o.length>0){if(e.forEach(s=>n.push(s)),Math.max(...o)>e.length)throw new Error("axes is out of bound");o.forEach((s,u)=>n[s]=r[u])}else r.forEach(s=>n.push(s));else{if(t.length===0)throw new Error("Resize requires either scales or sizes.");n=e.map((s,u)=>Math.round(s*t[u]))}return n},_c=(e,t,r)=>{let o=(()=>{switch(r.keepAspectRatioPolicy){case"not_larger":return r.axes.length>0?Math.min(...r.axes.map(s=>t[s]),Number.MAX_VALUE):Math.min(...t,Number.MAX_VALUE);case"not_smaller":return r.axes.length>0?Math.max(...r.axes.map(s=>t[s]),Number.MIN_VALUE):Math.max(...t,Number.MIN_VALUE);default:throw new Error(`Keep aspect ratio policy ${r.keepAspectRatioPolicy} is not supported`)}})();t.fill(1,0,t.length);let n=e.slice();return r.axes.length>0?(r.axes.forEach(s=>t[s]=o),r.axes.forEach(s=>n[s]=Math.round(e[s]*t[s]))):(t.fill(o,0,t.length),n.forEach((s,u)=>n[u]=Math.round(s*t[u]))),n},Cc=(e,t,r,o,n)=>`\n    fn calculateOriginalIndicesFromOutputIndices(output_indices: ${e.type.indices}) -> array<${e.type.value}, ${r.length}> {\n      var original_indices: array<${e.type.value}, ${r.length}>;\n      for (var i:u32 = 0; i < ${r.length}; i++) {\n        var output_index = ${e.indicesGet("output_indices","i")};\n        var scale = ${de("uniforms.scales","i",o)};\n        var roi_low = ${de("uniforms.roi","i",n)};\n        var roi_hi = ${de("uniforms.roi",`i + ${t.length}`,n)};\n        if (scale == 1.0) {\n          original_indices[i] = ${e.type.value}(output_index);\n        } else {\n          var input_shape_i = ${de("uniforms.input_shape","i",t.length)};\n          var output_shape_i = ${de("uniforms.output_shape","i",r.length)};\n          original_indices[i] = getOriginalCoordinateFromResizedCoordinate(output_index, scale, output_shape_i,\n                                                                           input_shape_i, roi_low, roi_hi);\n        }\n      }\n      return original_indices;\n    }`,Ic=(e,t,r,o,n,s,u)=>`\n    fn calculateInputIndicesFromOutputIndices(output_indices: ${t.type.indices}) -> ${e.type.indices} {\n      var input_indices: ${e.type.indices};\n      for (var i:u32 = 0; i < ${o.length}; i++) {\n        var output_index = ${t.indicesGet("output_indices","i")};\n        var input_index: u32;\n        var scale = ${de("uniforms.scales","i",n)};\n        if (scale == 1.0) {\n          input_index = output_index;\n        } else {\n          var roi_low = ${de("uniforms.roi","i",s)};\n          var roi_hi = ${de("uniforms.roi",`i + ${r.length}`,s)};\n          var input_shape_i = ${de("uniforms.input_shape","i",r.length)};\n          var output_shape_i = ${de("uniforms.output_shape","i",o.length)};\n          var original_idx = getOriginalCoordinateFromResizedCoordinate(output_index, scale, output_shape_i,\n                                                                        input_shape_i, roi_low, roi_hi);\n          if (!${u} || (original_idx >= 0 && original_idx < ${t.type.value}(input_shape_i))) {\n            if (original_idx < 0) {\n              input_index = 0;\n            } else if (original_idx > ${t.type.value}(input_shape_i - 1)) {\n              input_index = input_shape_i - 1;\n            } else {\n              input_index = u32(getNearestPixelFromOriginal(original_idx, scale < 1));\n            }\n          } else {\n            input_index = u32(original_idx);\n          }\n        }\n        ${e.indicesSet("input_indices","i"," input_index")}\n      }\n      return input_indices;\n    }`,Ac=(e,t)=>`\n    fn checkInputIndices(input_indices: ${e.type.indices}) -> bool {\n      for (var i:u32 = 0; i < ${t.length}; i++) {\n        var input_index = ${e.indicesGet("input_indices","i")};\n        if (input_index < 0 || input_index >= ${de("uniforms.input_shape","i",t.length)}) {\n          return false;\n        }\n      }\n      return true;\n    }`,uu=(e,t,r,o)=>e.rank>o?`\n    ${e.indicesSet("input_indices",t,"channel")};\n    ${e.indicesSet("input_indices",r,"batch")};\n`:"",Tc=(e,t,r,o,n)=>{let[u,l,a,p]=r.length===2?[-1,0,1,-1]:[0,2,3,1],h=e.type.value;return`\n    fn getInputValue(batch: u32, channel: u32, row: u32, col: u32) -> ${h} {\n      var input_indices: ${e.type.indices};\n      ${e.indicesSet("input_indices",l,`max(0, min(row, ${r[l]} - 1))`)};\n      ${e.indicesSet("input_indices",a,`max(0, min(col, ${r[a]} - 1))`)};\n      ${uu(e,p,u,2)}\n      return ${e.getByIndices("input_indices")};\n    }\n\n    fn bilinearInterpolation(output_indices: ${t.type.indices}) -> ${h} {\n      var originalIndices = calculateOriginalIndicesFromOutputIndices(output_indices);\n      var row:${h} = originalIndices[${l}];\n      var col:${h} = originalIndices[${a}];\n      ${o?`if (row < 0 || row > (${r[l]} - 1) || col < 0 || col > (${r[a]} - 1)) {\n        return ${n};\n      }`:""};\n      row = max(0, min(row, ${r[l]} - 1));\n      col = max(0, min(col, ${r[a]} - 1));\n      var row1: u32 = u32(row);\n      var col1: u32 = u32(col);\n      var row2: u32 = u32(row + 1);\n      var col2: u32 = u32(col + 1);\n      var channel: u32 = ${r.length>2?`u32(originalIndices[${p}])`:"0"};\n      var batch: u32 =  ${r.length>2?`u32(originalIndices[${u}])`:"0"};\n      var x11: ${h} = getInputValue(batch, channel, row1, col1);\n      var x12: ${h} = getInputValue(batch, channel, row1, col2);\n      var x21: ${h} = getInputValue(batch, channel, row2, col1);\n      var x22: ${h} = getInputValue(batch, channel, row2, col2);\n      var dx1: ${h} = abs(row - ${h}(row1));\n      var dx2: ${h} = abs(${h}(row2) - row);\n      var dy1: ${h} = abs(col - ${h}(col1));\n      var dy2: ${h} = abs(${h}(col2) - col);\n      if (row1 == row2) {\n        dx1 = 0.5;\n        dx2 = 0.5;\n      }\n      if (col1 == col2) {\n        dy1 = 0.5;\n        dy2 = 0.5;\n      }\n      return (x11 * dx2 * dy2 + x12 * dx2 * dy1 + x21 * dx1 * dy2 + x22 * dx1 * dy1);\n    }`},Ec=(e,t,r,o,n,s,u,l,a,p)=>{let h=r.length===2,g=!0,[w,v]=h?[0,1]:g?[2,3]:[1,2],y=e.type.value,_=I=>{let x=I===w?"row":"col";return`\n      fn ${x}CubicInterpolation(input_indices: ${e.type.indices}, output_indices: ${t.type.indices}) -> ${y} {\n        var output_index = ${t.indicesGet("output_indices",I)};\n        var originalIdx: ${y} = getOriginalCoordinateFromResizedCoordinate(output_index, ${n[I]},\n        ${o[I]}, ${r[I]}, ${s[I]}, ${s[I]} + ${r.length});\n        var fractOriginalIdx: ${y} = originalIdx - floor(originalIdx);\n        var coefs = getCubicInterpolationCoefs(fractOriginalIdx);\n\n        if (${l} && (originalIdx < 0 || originalIdx > (${r[I]} - 1))) {\n          return ${a};\n        }\n        var data: array<${y}, 4> = array<${y}, 4>(0.0, 0.0, 0.0, 0.0);\n        for (var i: i32 = -1; i < 3; i++) {\n          var ${x}: ${y} = originalIdx + ${y}(i);\n          if (${x} < 0 || ${x} >= ${r[I]}) {\n            ${(()=>p?`coefs[i + 1] = 0.0;\n                        continue;`:l?`return ${a};`:`${x} = max(0, min(${x}, ${r[I]} - 1));`)()};\n          }\n        var input_indices_copy: ${e.type.indices} = input_indices;\n          ${e.indicesSet("input_indices_copy",I,`u32(${x})`)};\n          data[i + 1] = ${I===w?e.getByIndices("input_indices_copy"):"rowCubicInterpolation(input_indices_copy, output_indices)"};\n        }\n        return cubicInterpolation1D(data, coefs);\n      }`};return`\n    ${_(w)};\n    ${_(v)};\n  fn getCubicInterpolationCoefs(s: ${y}) -> array<${y}, 4> {\n    var absS = abs(s);\n    var coeffs: array<${y}, 4> = array<${y}, 4>(0.0, 0.0, 0.0, 0.0);\n    var oneMinusAbsS: ${y} = 1.0 - absS;\n    var twoMinusAbsS: ${y} = 2.0 - absS;\n    var onePlusAbsS: ${y} = 1.0 + absS;\n    coeffs[0] = ((${u} * onePlusAbsS - 5 * ${u}) * onePlusAbsS + 8 * ${u}) * onePlusAbsS - 4 * ${u};\n    coeffs[1] = ((${u} + 2) * absS - (${u} + 3)) * absS * absS + 1;\n    coeffs[2] = ((${u} + 2) * oneMinusAbsS - (${u} + 3)) * oneMinusAbsS * oneMinusAbsS + 1;\n    coeffs[3] = ((${u} * twoMinusAbsS - 5 * ${u}) * twoMinusAbsS + 8 * ${u}) * twoMinusAbsS - 4 * ${u};\n    return coeffs;\n  }\n\n  fn cubicInterpolation1D(x: array<${y}, 4>, coefs: array<${y}, 4>) -> ${y} {\n    var coefsSum: ${y} = coefs[0] + coefs[1] + coefs[2] + coefs[3];\n    return (x[0] * coefs[0] + x[1] * coefs[1]+ x[2] * coefs[2]+ x[3] * coefs[3]) / coefsSum;\n  }\n\n  fn bicubicInterpolation(output_indices: ${t.type.indices}) -> ${y} {\n    var input_indices: ${e.type.indices} = output_indices;\n    return colCubicInterpolation(input_indices, output_indices);\n  }\n    `},Oc=(e,t,r,o,n)=>{let[u,l,a,p,h]=r.length===3?[-1,0,1,2,-1]:[0,2,3,4,1],g=e.type.value;return`\n    fn getInputValue(batch: u32, channel: u32, depth:u32, height: u32, width: u32) -> ${g} {\n      var input_indices: ${e.type.indices};\n      ${e.indicesSet("input_indices",l,`max(0, min(depth, ${r[l]} - 1))`)};\n      ${e.indicesSet("input_indices",a,`max(0, min(height, ${r[a]} - 1))`)};\n      ${e.indicesSet("input_indices",p,`max(0, min(width, ${r[p]} - 1))`)};\n      ${uu(e,h,u,3)}\n      return ${e.getByIndices("input_indices")};\n    }\n\n    fn trilinearInterpolation(output_indices: ${t.type.indices}) -> ${g} {\n      var originalIndices = calculateOriginalIndicesFromOutputIndices(output_indices);\n      var depth:${g} = originalIndices[${l}];\n      var height:${g} = originalIndices[${a}];\n      var width:${g} = originalIndices[${p}];\n      ${o?`if (depth < 0 || depth > (${r[l]} - 1) || height < 0 || height > (${r[a]} - 1) || width < 0 || (width > ${r[p]} - 1)) {\n      return ${n};\n        }`:""};\n\n    depth = max(0, min(depth, ${r[l]} - 1));\n      height = max(0, min(height, ${r[a]} - 1));\n      width = max(0, min(width, ${r[p]} - 1));\n      var depth1: u32 = u32(depth);\n      var height1: u32 = u32(height);\n      var width1: u32 = u32(width);\n      var depth2: u32 = u32(depth + 1);\n      var height2: u32 = u32(height + 1);\n      var width2: u32 = u32(width + 1);\n      var channel: u32 = ${r.length>3?`u32(originalIndices[${h}])`:"0"};\n      var batch: u32 =  ${r.length>3?`u32(originalIndices[${u}])`:"0"};\n\n      var x111: ${g} = getInputValue(batch, channel, depth1, height1, width1);\n      var x112: ${g} = getInputValue(batch, channel, depth1, height1, width2);\n      var x121: ${g} = getInputValue(batch, channel, depth1, height2, width1);\n      var x122: ${g} = getInputValue(batch, channel, depth1, height2, width2);\n      var x211: ${g} = getInputValue(batch, channel, depth2, height1, width1);\n      var x212: ${g} = getInputValue(batch, channel, depth2, height1, width2);\n      var x221: ${g} = getInputValue(batch, channel, depth2, height2, width1);\n      var x222: ${g} = getInputValue(batch, channel, depth2, height2, width2);\n      var dx1: ${g} = abs(depth - ${g}(depth1));\n      var dx2: ${g} = abs(${g}(depth2) - depth);\n      var dy1: ${g} = abs(height - ${g}(height1));\n      var dy2: ${g} = abs(${g}(height2) - height);\n      var dz1: ${g} = abs(width - ${g}(width1));\n      var dz2: ${g} = abs(${g}(width2) - width);\n      if (depth1 == depth2) {\n        dx1 = 0.5;\n        dx2 = 0.5;\n      }\n      if (height1 == height2) {\n        dy1 = 0.5;\n        dy2 = 0.5;\n      }\n      if (width1 == width2) {\n        dz1 = 0.5;\n        dz2 = 0.5;\n      }\n      return (x111 * dx2 * dy2 * dz2 + x112 * dx2 * dy2 * dz1 + x121 * dx2 * dy1 *dz2 + x122 * dx2 * dy1 * dz1 +\n              x211 * dx1 * dy2 * dz2 + x212 * dx1 * dy2 * dz1 + x221 * dx1 * dy1 *dz2 + x222 * dx1 * dy1 * dz1);\n    }`},Pc=(e,t,r,o,n,s)=>{let u=e.dims,l=Sc(s,t.axes,u.length),a=xc(u,o,n,t.axes),p=o.slice();o.length===0&&(p=u.map((A,O)=>A===0?1:a[O]/A),t.keepAspectRatioPolicy!=="stretch"&&(a=_c(u,p,t)));let h=K("output",e.dataType,a.length),g=U("input",e.dataType,u.length),w=V.size(a),v=u.length===a.length&&u.every((A,O)=>A===a[O]),y=t.coordinateTransformMode==="tf_crop_and_resize",_=t.extrapolationValue,I=g.type.value,x=A=>`\n      ${v?"":`\n      ${vc(t.coordinateTransformMode,I)};\n      ${(()=>{switch(t.mode){case"nearest":return`\n              ${Ac(g,u)};\n              ${$c(t.nearestMode,r,I)};\n              ${Ic(g,h,u,a,p.length,l.length,y)};\n              `;case"linear":return`\n              ${Cc(h,u,a,p.length,l.length)};\n              ${(()=>{if(u.length===2||u.length===4)return`${Tc(g,h,u,y,_)}`;if(u.length===3||u.length===5)return`${Oc(g,h,u,y,_)}`;throw Error("Linear mode only supports input dims 2, 3, 4 and 5 are supported in linear mode.")})()};\n            `;case"cubic":return`\n            ${(()=>{if(u.length===2||u.length===4)return`${Ec(g,h,u,a,p,l,t.cubicCoeffA,y,t.extrapolationValue,t.excludeOutside)}`;throw Error("Cubic mode only supports input dims 2 and 4 are supported in linear mode.")})()};\n            `;default:throw Error("Invalid resize mode")}})()};\n      `}\n      ${A.registerUniform("output_size","u32").registerUniform("scales","f32",p.length).registerUniform("roi","f32",l.length).declareVariables(g,h)}\n      ${A.mainStart()}\n        ${A.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}\n        ${v?"output[global_idx] = input[global_idx];":`\n        let output_indices = ${h.offsetToIndices("global_idx")};\n        var input_indices: ${g.type.indices};\n        ${(()=>{switch(t.mode){case"nearest":return`input_indices = calculateInputIndicesFromOutputIndices(output_indices);\n                if (checkInputIndices(input_indices)) {\n                  output[global_idx] = ${g.getByIndices("input_indices")};\n                } else {\n                  output[global_idx] = ${t.extrapolationValue};\n                }`;case"linear":return`output[global_idx] = ${u.length===2||u.length===4?"bilinearInterpolation":"trilinearInterpolation"}(output_indices);`;case"cubic":return"output[global_idx] = bicubicInterpolation(output_indices);";default:throw Error(`Unsupported resize mode: ${t.mode}`)}})()};\n`}\n      }`;return{name:"Resize",shaderCache:{hint:`${t.cacheKey}|${r}|${p.length>0?p:""}|${n.length>0?n:""}|${l.length>0?l:""}|${v}|${u}`,inputDependencies:["rank"]},getShaderSource:x,getRunData:()=>({outputs:[{dims:a,dataType:e.dataType}],dispatchGroup:{x:Math.ceil(w/64)},programUniforms:[{type:"uint32",data:w},{type:"float32",data:p},{type:"float32",data:l},...F(u),...F(a)]})}},Bc=e=>{let t=e.customDataBuffer;return new Uint32Array(t,t.byteOffset,1)[0]},du=(e,t)=>{let r=[],o=[],n=[],s=Bc(e);if(t.antialias!==0)throw Error("Only default value (0) for Antialias attribute is supported");wc(e.inputs,t,s,r,o,n),e.compute(Pc(e.inputs[0],t,s,r,o,n),{inputs:[0]})},lu=e=>{let t=e.antialias,r=e.axes,o=e.coordinateTransformMode,n=e.cubicCoeffA,s=e.excludeOutside!==0,u=e.extrapolationValue,l=e.keepAspectRatioPolicy,a=e.mode,p=e.nearestMode===""?"simple":e.nearestMode;return he({antialias:t,axes:r,coordinateTransformMode:o,cubicCoeffA:n,excludeOutside:s,extrapolationValue:u,keepAspectRatioPolicy:l,mode:a,nearestMode:p})}});var kc,Rc,pu,mu,fu=q(()=>{"use strict";We();xe();Le();$e();kc=e=>{if(!e||e.length<3)throw new Error("layerNorm requires at least 3 inputs.");let t=e[0],r=e[1],o=e[2];if(t.dataType!==r.dataType||t.dataType!==o.dataType)throw new Error("All inputs must have the same data type");if(t.dims.length!==3&&t.dims.length!==2)throw new Error("Input must be 2D or 3D");if(r.dims.length!==3&&r.dims.length!==2)throw new Error("Skip must be 2D or 3D");let n=t.dims[t.dims.length-1],s=t.dims[t.dims.length-2];if(r.dims[r.dims.length-1]!==n)throw new Error("Skip must have the same hidden size as input");if(r.dims[r.dims.length-2]!==s)throw new Error("Skip must have the same sequence length as input");if(o.dims.length!==1)throw new Error("Gamma must be 1D");if(o.dims[o.dims.length-1]!==n)throw new Error("Gamma must have the same hidden size as input");if(e.length>3){let u=e[3];if(u.dims.length!==1)throw new Error("Beta must be 1D");if(u.dims[u.dims.length-1]!==n)throw new Error("Beta must have the same hidden size as input")}if(e.length>4){let u=e[4];if(u.dims.length!==1)throw new Error("Bias must be 1D");if(u.dims[u.dims.length-1]!==n)throw new Error("Bias must have the same hidden size as input")}},Rc=(e,t,r,o)=>{let n=e[0].dims,s=V.size(n),u=n,l=s,a=n.slice(-1)[0],p=o?n.slice(0,-1).concat(1):[],h=e.length>3,g=e.length>4,w=o&&r>1,v=o&&r>2,y=r>3,_=He(a),I=[U("x",e[0].dataType,e[0].dims,_),U("skip",e[1].dataType,e[1].dims,_),U("gamma",e[2].dataType,e[2].dims,_)];h&&I.push(U("beta",e[3].dataType,e[3].dims,_)),g&&I.push(U("bias",e[4].dataType,e[4].dims,_)),I.push(K("output",e[0].dataType,u,_)),w&&I.push(K("meanOutput",1,p)),v&&I.push(K("invStdOutput",1,p)),y&&I.push(K("inputSkipBiasSum",e[0].dataType,u,_));let x=Ge(e[0].dataType),A=C=>`\n      const hiddenSize: f32 = ${a};\n      const hiddenSizeVectorized: u32 = ${a/_};\n      const epsilon: f32 = ${t.epsilon};\n\n      ${C.declareVariables(...I)}\n\n      ${C.mainStart()}\n        ${C.guardAgainstOutOfBoundsWorkgroupSizes(l/a)}\n        let offset = global_idx * hiddenSizeVectorized;\n        var sum = ${Qe("f32",_)};\n        var squareSum = ${Qe("f32",_)};\n        for (var i: u32 = 0; i < hiddenSizeVectorized; i++) {\n          let skipValue = skip[offset + i];\n          let biasValue = ${g?"bias[i]":"0.0"};\n          let inputValue = x[offset + i];\n          let value = inputValue + skipValue + biasValue;\n          ${y?"inputSkipBiasSum[offset + i] = value;":""}\n          output[offset + i] = value;\n          let f32Value = ${ut(x,_,"value")};\n          sum += f32Value;\n          squareSum += f32Value * f32Value;\n        }\n        let mean = ${ot("sum",_)} / hiddenSize;\n        let invStdDev = inverseSqrt(${ot("squareSum",_)} / hiddenSize - mean * mean + epsilon);\n        ${w?"meanOutput[global_idx] = mean;":""}\n        ${v?"invStdOutput[global_idx] = invStdDev;":""}\n        for (var i: u32 = 0; i < hiddenSizeVectorized; i++) {\n          output[offset + i] = (output[offset + i] - ${x}(mean)) * ${x}(invStdDev) * gamma[i]\n           + ${h?"beta[i]":"0.0"};\n        }\n      }`,O=[{dims:u,dataType:e[0].dataType}];return r>1&&O.push({dims:p,dataType:1}),r>2&&O.push({dims:p,dataType:1}),r>3&&O.push({dims:n,dataType:e[0].dataType}),{name:"SkipLayerNormalization",shaderCache:{hint:t.cacheKey},getShaderSource:A,getRunData:()=>({outputs:O,dispatchGroup:{x:Math.ceil(l/a/64)}})}},pu=(e,t)=>{kc(e.inputs);let o=[0];e.outputCount>1&&o.push(-3),e.outputCount>2&&o.push(-3),e.outputCount>3&&o.push(3),e.compute(Rc(e.inputs,t,e.outputCount,!1),{outputs:o})},mu=e=>{let t=e.epsilon;return he({epsilon:t})}});var Dc,hn,Mc,hu,Uc,zc,gu,yu,bu=q(()=>{"use strict";We();xe();Le();$e();Dc=(e,t)=>{if(!e||e.length<1)throw new Error("too few inputs");if(t.axes.length!==0){if(t.axes.length!==t.starts.length||t.axes.length!==t.ends.length)throw new Error("axes, starts and ends must have the same length")}else if(t.starts.length!==t.ends.length)throw new Error("starts and ends must have the same length");e.slice(1).forEach((r,o)=>{if(e[o+1].dataType!==6&&e[o+1].dataType!==7)throw new Error(`Input ${o} must be an array of int32 or int64`)})},hn=(e,t)=>{let r=[];if(e.length>t)if(e[t].dataType===7)e[t].getBigInt64Array().forEach(o=>r.push(Number(o)));else if(e[t].dataType===6)e[t].getInt32Array().forEach(o=>r.push(Number(o)));else throw new Error(`Input ${t} must be an array of int32 or int64`);return r},Mc=(e,t)=>{if(e.length>1){let r=hn(e,1),o=hn(e,2),n=hn(e,3);return n.length===0&&(n=[...Array(e[0].dims.length).keys()]),he({starts:r,ends:o,axes:n})}else return t},hu=(e,t,r,o,n)=>{let s=e;return e<0&&(s+=r[o[t]]),n[t]<0?Math.max(0,Math.min(s,r[o[t]]-1)):Math.max(0,Math.min(s,r[o[t]]))},Uc=(e,t,r)=>`fn calculateInputIndices(output_indices: ${t.type.indices}) -> ${e.type.indices} {\n          var input_indices: ${e.type.indices};\n          var carry = 0u;\n          for (var i = ${r.length}; i >= 0; i--) {\n            let input_shape_i = ${de("uniforms.input_shape","i",r.length)};\n            let steps_i = ${de("uniforms.steps","i",r.length)};\n            let signs_i = ${de("uniforms.signs","i",r.length)};\n            let starts_i = ${de("uniforms.starts","i",r.length)};\n            var output_index = ${t.indicesGet("output_indices","i")};\n            var input_index = output_index * steps_i + starts_i + carry;\n            carry = input_index / input_shape_i;\n            input_index = input_index % input_shape_i;\n            if (signs_i < 0) {\n              input_index = input_shape_i - input_index - 1u + starts_i;\n            }\n            ${e.indicesSet("input_indices","i","input_index")};\n          }\n          return input_indices;\n      }`,zc=(e,t)=>{let r=e[0].dims,o=V.size(r),n=t.axes.length>0?V.normalizeAxes(t.axes,r.length):[...Array(r.length).keys()],s=hn(e,4);s.forEach(x=>x!==0||(()=>{throw new Error("step cannot be 0")})),s.length===0&&(s=Array(n.length).fill(1));let u=t.starts.map((x,A)=>hu(x,A,r,n,s)),l=t.ends.map((x,A)=>hu(x,A,r,n,s));if(n.length!==u.length||n.length!==l.length)throw new Error("start, ends and axes should have the same number of elements");if(n.length!==r.length)for(let x=0;x<r.length;++x)n.includes(x)||(u.splice(x,0,0),l.splice(x,0,r[x]),s.splice(x,0,1));let a=s.map(x=>Math.sign(x));s.forEach((x,A,O)=>{if(x<0){let C=(l[A]-u[A])/x,M=u[A],D=M+C*s[A];u[A]=D,l[A]=M,O[A]=-x}});let p=r.slice(0);n.forEach((x,A)=>{p[x]=Math.ceil((l[x]-u[x])/s[x])});let h={dims:p,dataType:e[0].dataType},g=K("output",e[0].dataType,p.length),w=U("input",e[0].dataType,e[0].dims.length),v=V.size(p),y=[{name:"outputSize",type:"u32"},{name:"starts",type:"u32",length:u.length},{name:"signs",type:"i32",length:a.length},{name:"steps",type:"u32",length:s.length}],_=[{type:"uint32",data:v},{type:"uint32",data:u},{type:"int32",data:a},{type:"uint32",data:s},...F(e[0].dims),...F(p)],I=x=>`\n      ${x.registerUniforms(y).declareVariables(w,g)}\n        ${Uc(w,g,r)}\n        ${x.mainStart()}\n          ${x.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}\n          let output_indices = ${g.offsetToIndices("global_idx")};\n          let input_indices = calculateInputIndices(output_indices);\n          ${g.setByOffset("global_idx",w.getByIndices("input_indices"))}\n      }`;return{name:"Slice",shaderCache:{hint:`${a.length}_${u.length}_${s.length}`,inputDependencies:["rank"]},getShaderSource:I,getRunData:()=>({outputs:[h],dispatchGroup:{x:Math.ceil(o/64)},programUniforms:_})}},gu=(e,t)=>{Dc(e.inputs,t);let r=Mc(e.inputs,t);e.compute(zc(e.inputs,r),{inputs:[0]})},yu=e=>{let t=e.starts,r=e.ends,o=e.axes;return he({starts:t,ends:r,axes:o})}});var Vc,Nc,wu,vu,$u=q(()=>{"use strict";xe();Le();$e();Vc=e=>{if(!e||e.length!==1)throw new Error("Softmax op requires 1 input.")},Nc=(e,t)=>{let r=e.dims,o=V.size(r),n=64,s=t.axis;if(s<0&&(s=r.length+s),s<r.length-1)throw new Error("softmax only supports last axis for now.");let u=r[s],l=o/u,a=He(u),p=u/a,h=(I,x)=>x===4?`max(max(${I}.x, ${I}.y), max(${I}.z, ${I}.w))`:x===2?`max(${I}.x, ${I}.y)`:x===3?`max(max(${I}.x, ${I}.y), ${I}.z)`:I,g=U("x",e.dataType,e.dims,a),w=K("result",e.dataType,e.dims,a),v=g.type.value,y=Ge(e.dataType)==="f32"?`var threadMax = ${v}(-3.402823e+38f);`:`var threadMax = ${v}(-65504.0h);`,_=I=>`\n      var<workgroup> rowMaxShared : ${v};\n      var<workgroup> rowSumShared : ${v};\n      var<workgroup> threadShared : array<${v}, ${n}>;\n\n      fn getValue(row: i32, col: i32, row_stride: i32) -> ${v} {\n        let index = row * row_stride + col;\n        return x[index];\n      }\n\n      fn setValue(row: i32, col: i32, row_stride: i32, value: ${v}) {\n        let index = row * row_stride + col;\n        result[index] = value;\n      }\n      ${I.registerUniform("packedCols","i32").declareVariables(g,w)}\n      ${I.mainStart()}\n        let gindex = i32(global_idx);\n        let lindex = i32(local_idx);\n        const wg = ${n};\n        let row = gindex / wg;\n        let cols = uniforms.packedCols;\n        let row_stride : i32 = uniforms.packedCols;\n\n        // find the rows max\n        ${y}\n        for (var col = lindex; col < cols; col += wg) {\n          let value = getValue(row, col, row_stride);\n          threadMax = max(threadMax, value);\n        }\n        if (lindex < cols) {\n          threadShared[lindex] = threadMax;\n        }\n        workgroupBarrier();\n\n        var reduceSize = min(cols, wg);\n        for (var currSize = reduceSize >> 1;  currSize > 0; currSize = reduceSize >> 1) {\n          reduceSize = currSize + (reduceSize & 1);\n          if (lindex < currSize) {\n            threadShared[lindex] = max(threadShared[lindex], threadShared[lindex + reduceSize]);\n          }\n          workgroupBarrier();\n        }\n        if (lindex == 0) {\n          rowMaxShared = ${v}(${h("threadShared[0]",a)});\n        }\n        workgroupBarrier();\n\n        // find the rows sum\n        var threadSum = ${v}(0.0);\n        for (var col = lindex; col < cols; col += wg) {\n          let subExp = exp(getValue(row, col, row_stride) - rowMaxShared);\n          threadSum += subExp;\n        }\n        threadShared[lindex] = threadSum;\n        workgroupBarrier();\n\n        for (var currSize = wg >> 1;  currSize > 0; currSize = currSize >> 1) {\n          if (lindex < currSize) {\n            threadShared[lindex] = threadShared[lindex] + threadShared[lindex + currSize];\n          }\n          workgroupBarrier();\n        }\n        if (lindex == 0) {\n          rowSumShared = ${v}(${ot("threadShared[0]",a)});\n        }\n        workgroupBarrier();\n\n        // calculate final value for each element in the row\n        for (var col = lindex; col < cols; col += wg) {\n          let value = exp(getValue(row, col, row_stride) - rowMaxShared) / rowSumShared;\n          setValue(row, col, row_stride, value);\n        }\n      }`;return{name:"Softmax",shaderCache:{hint:`${a}`,inputDependencies:["type"]},getRunData:()=>({outputs:[{dims:r,dataType:e.dataType}],dispatchGroup:{x:l},programUniforms:[{type:"uint32",data:p}]}),getShaderSource:_}},wu=(e,t)=>{Vc(e.inputs),e.compute(Nc(e.inputs[0],t))},vu=e=>he({axis:e.axis})});var Wc,Gc,Hc,Lc,Fc,Su,xu,_u=q(()=>{"use strict";xe();Le();$e();Wc=e=>{if(!e||e.length<1)throw new Error("too few inputs")},Gc=(e,t)=>{let r=[],o=t.numOutputs;return e[1].dims[0]>0&&(e[1].getBigInt64Array().forEach(n=>r.push(Number(n))),o=r.length),he({numOutputs:o,axis:t.axis,splitSizes:r})},Hc=e=>`\nfn calculateOutputIndex(index: u32) -> u32 {\n    for (var i: u32 = 0u; i < ${e}u; i += 1u ) {\n    if (index < ${de("uniforms.size_in_split_axis","i",e)}) {\n        return i;\n    }\n    }\n    return ${e}u;\n}`,Lc=e=>{let t=e.length,r=[];for(let o=0;o<t;++o){let n=e[o].setByIndices("indices","input[global_idx]");t===1?r.push(n):o===0?r.push(`if (output_number == ${o}u) { ${n} }`):o===t-1?r.push(`else { ${n} }`):r.push(`else if (output_number == ${o}) { ${n} }`)}return`\n      fn writeBufferData(output_number: u32, indices: ${e[0].type.indices}, global_idx: u32) {\n        ${r.join(`\n`)}\n      }`},Fc=(e,t)=>{let r=e[0].dims,o=V.size(r),n=e[0].dataType,s=V.normalizeAxis(t.axis,r.length),u=new Array(t.numOutputs),l=U("input",n,r),a=new Array(t.numOutputs),p=[],h=[],g=0,w=[{type:"uint32",data:o}];for(let y=0;y<t.numOutputs;y++){g+=t.splitSizes[y],a[y]=g;let _=r.slice();_[t.axis]=t.splitSizes[y],h.push(_),u[y]=K(`output${y}`,n,_),p.push({dims:h[y],dataType:e[0].dataType})}w.push({type:"uint32",data:a}),w.push(...F(r)),h.forEach(y=>w.push(...F(y)));let v=y=>`\n  ${y.registerUniform("input_size","u32").registerUniform("size_in_split_axis","u32",a.length).declareVariables(l,...u)}\n  ${Hc(a.length)}\n  ${Lc(u)}\n\n  ${y.mainStart()}\n    ${y.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.input_size")}\n\n    var indices = ${l.offsetToIndices("global_idx")};\n    var index = ${l.indicesGet("indices",s)};\n    let output_number = calculateOutputIndex(index);\n    if (output_number != 0) {\n      index -= ${de("uniforms.size_in_split_axis","output_number - 1u",a.length)};\n      ${l.indicesSet("indices",s,"index")};\n    }\n    writeBufferData(output_number, indices, global_idx);\n  }`;return{name:"Split",shaderCache:{hint:t.cacheKey,inputDependencies:["rank"]},getShaderSource:v,getRunData:()=>({outputs:p,dispatchGroup:{x:Math.ceil(o/64)},programUniforms:w})}},Su=(e,t)=>{Wc(e.inputs);let r=e.inputs.length===1?t:Gc(e.inputs,t);e.compute(Fc(e.inputs,r),{inputs:[0]})},xu=e=>{let t=e.axis,r=e.splitSizes,o=e.numOutputs<0?r.length:e.numOutputs;if(o!==r.length)throw new Error("numOutputs and splitSizes lengh must be equal");return he({axis:t,numOutputs:o,splitSizes:r})}});var Cu,Kc,qc,jc,Iu,Au=q(()=>{"use strict";We();xe();$e();Cu=e=>Array.from(e.getBigInt64Array(),Number),Kc=e=>{if(!e||e.length!==2)throw new Error("Tile requires 2 inputs.");if(e[0].dataType!==1&&e[0].dataType!==6&&e[0].dataType!==12)throw new Error("Tile only support float, int32, and uint32 data types");if(e[1].dataType!==7)throw new Error("Tile `repeats` input should be of int64 data type");if(e[1].dims.length!==1)throw new Error("Tile `repeats` input should be 1-D");if(Cu(e[1]).length!==e[0].dims.length)throw new Error("Tile `repeats` input should have same number of elements as rank of input data tensor")},qc=(e,t)=>{let r=[];for(let o=0;o<e.length;++o)r.push(e[o]*t[o]);return r},jc=e=>{let t=e[0].dims,r=Cu(e[1]),o=qc(t,r),n=V.size(o),s=e[0].dataType,u=U("input",s,t.length),l=K("output",s,o.length),a=p=>`\n      const inputShape = ${u.indices(...t)};\n      ${p.registerUniform("output_size","u32").declareVariables(u,l)}\n      ${p.mainStart()}\n      ${p.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}\n      let output_indices = ${l.offsetToIndices("global_idx")};\n      var input_indices: ${u.type.indices};\n      for (var i = 0; i < ${t.length}; i++) {\n        let input_dim_i = ${u.indicesGet("uniforms.input_shape","i")};\n        let input_dim_value = ${l.indicesGet("output_indices","i")}  % input_dim_i;\n\n        ${u.indicesSet("input_indices","i","input_dim_value")}\n      }\n      ${l.setByOffset("global_idx",u.getByIndices("input_indices"))}\n    }`;return{name:"Tile",shaderCache:{hint:`${r}`,inputDependencies:["rank"]},getRunData:()=>({outputs:[{dims:o,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(n/64)},programUniforms:[{type:"uint32",data:n},...F(e[0].dims),...F(o)]}),getShaderSource:a}},Iu=e=>{Kc(e.inputs),e.compute(jc(e.inputs),{inputs:[0]})}});var Yc,Zc,Tu,Eu=q(()=>{"use strict";We();xe();$e();Yc=(e,t,r,o,n)=>{let s=K("output_data",n,r.length,4),u=U("a_data",t[1].dataType,t[1].dims.length,4),l=U("b_data",t[2].dataType,t[2].dims.length,4),a=U("c_data",t[0].dataType,t[0].dims.length,4),p,h=(g,w,v)=>`select(${w}, ${g}, ${v})`;if(!o)p=s.setByOffset("global_idx",h(u.getByOffset("global_idx"),l.getByOffset("global_idx"),a.getByOffset("global_idx")));else{let g=(w,v,y="")=>{let _=`a_data[index_a${v}][component_a${v}]`,I=`b_data[index_b${v}][component_b${v}]`,x=`bool(c_data[index_c${v}] & ${4278190080>>>(3-v)*8}u)`;return`\n            let output_indices${v} = ${s.offsetToIndices(`global_idx * 4u + ${v}u`)};\n            let offset_a${v} = ${u.broadcastedIndicesToOffset(`output_indices${v}`,s)};\n            let offset_b${v} = ${l.broadcastedIndicesToOffset(`output_indices${v}`,s)};\n            let offset_c${v} = ${a.broadcastedIndicesToOffset(`output_indices${v}`,s)};\n            let index_a${v} = offset_a${v} / 4u;\n            let index_b${v} = offset_b${v} / 4u;\n            let index_c${v} = offset_c${v} / 4u;\n            let component_a${v} = offset_a${v} % 4u;\n            let component_b${v} = offset_b${v} % 4u;\n            ${w}[${v}] = ${y}(${h(_,I,x)});\n          `};n===9?p=`\n            var data = vec4<u32>(0);\n            ${g("data",0,"u32")}\n            ${g("data",1,"u32")}\n            ${g("data",2,"u32")}\n            ${g("data",3,"u32")}\n            output_data[global_idx] = dot(vec4<u32>(0x1, 0x100, 0x10000, 0x1000000), vec4<u32>(data));`:p=`\n            ${g("output_data[global_idx]",0)}\n            ${g("output_data[global_idx]",1)}\n            ${g("output_data[global_idx]",2)}\n            ${g("output_data[global_idx]",3)}\n          `}return`\n        ${e.registerUniform("vec_size","u32").declareVariables(a,u,l,s)}\n        ${e.mainStart()}\n        ${e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.vec_size")}\n        ${p}\n      }`},Zc=e=>{let t=e[1].dims,r=e[2].dims,o=e[0].dims,n=e[1].dataType,s=!(V.areEqual(t,r)&&V.areEqual(r,o)),u=t,l=V.size(t);if(s){let p=mt.calcShape(mt.calcShape(t,r,!1),o,!1);if(!p)throw new Error("Can\'t perform where op on the given tensors");u=p,l=V.size(u)}let a=Math.ceil(l/4);return{name:"Where",shaderCache:{inputDependencies:["rank","rank","rank"]},getShaderSource:p=>Yc(p,e,u,s,n),getRunData:()=>({outputs:[{dims:u,dataType:n}],dispatchGroup:{x:Math.ceil(l/64/4)},programUniforms:[{type:"uint32",data:a},...F(o),...F(t),...F(r),...F(u)]})}},Tu=e=>{e.compute(Zc(e.inputs))}});var Ou,Pu=q(()=>{"use strict";ei();Jn();ni();ai();zi();Yi();Ji();no();ps();hs();vs();xs();Is();Es();Bs();Rs();Ms();ao();Ns();Gs();au();su();rn();cu();fu();bu();$u();_u();Au();or();Xn();Eu();Ou=new Map([["Abs",[ii]],["Acos",[si]],["Acosh",[ui]],["Add",[Vi]],["ArgMax",[Xa,Qn]],["ArgMin",[Ja,Qn]],["Asin",[di]],["Asinh",[li]],["Atan",[ci]],["Atanh",[pi]],["Attention",[ti]],["AveragePool",[Zs,Ys]],["BatchNormalization",[ri]],["BiasAdd",[oi]],["BiasSplitGelu",[Ui]],["Cast",[fi,mi]],["Ceil",[gi]],["Clip",[hi]],["Concat",[Zi,Qi]],["Conv",[so,io]],["ConvTranspose",[cs,ls]],["Cos",[yi]],["Cosh",[bi]],["CumSum",[ms,fs]],["Div",[Ni]],["Einsum",[bs,ws]],["Elu",[wi,an]],["Equal",[Wi]],["Erf",[vi]],["Exp",[$i]],["Expand",[Ss]],["Floor",[Si]],["FusedConv",[so,io]],["Gather",[Cs,_s]],["GatherElements",[Ts,As]],["Gelu",[xi]],["Gemm",[Ps,Os]],["GlobalAveragePool",[Xs,Js]],["GlobalMaxPool",[ou,nu]],["Greater",[Fi]],["GreaterOrEqual",[qi]],["InstanceNormalization",[ks]],["LayerNormalization",[Ds]],["LeakyRelu",[_i,an]],["Less",[Ki]],["LessOrEqual",[ji]],["Log",[Mi]],["MatMul",[ns]],["MaxPool",[tu,ru]],["Mul",[Gi]],["MultiHeadAttention",[Vs,zs]],["Neg",[Ii]],["Not",[Ci]],["Pad",[Ws]],["Pow",[Hi]],["Range",[iu]],["Reciprocal",[Ai]],["ReduceMin",[Ka]],["ReduceMean",[Wa]],["ReduceMax",[Fa]],["ReduceSum",[ja]],["ReduceProd",[qa]],["ReduceL1",[Ga]],["ReduceL2",[Ha]],["ReduceLogSum",[Za]],["ReduceLogSumExp",[La]],["ReduceSumSquare",[Ya]],["Relu",[Ti]],["Resize",[du,lu]],["Sigmoid",[Ei]],["Sin",[Oi]],["Sinh",[Pi]],["Slice",[gu,yu]],["SkipLayerNormalization",[pu,mu]],["Split",[Su,xu]],["Sqrt",[Bi]],["Softmax",[wu,vu]],["Sub",[Li]],["Tan",[ki]],["Tanh",[Ri]],["ThresholdedRelu",[Di,an]],["Tile",[Iu]],["Transpose",[Ta,Ea]],["Where",[Tu]]])});var gn,Bu=q(()=>{"use strict";rr();Pt();$e();gn=class{constructor(t){this.backend=t;this.repo=new Map,this.attributesBound=!1}getArtifact(t){return this.repo.get(t)}setArtifact(t,r){this.repo.set(t,r)}run(t,r,o){Vt(t.programInfo.name);let n=this.backend.getComputePassEncoder();if(this.backend.writeTimestamp(this.backend.pendingDispatchNumber*2),this.backend.sessionStatus==="capturing"){let s={kernelId:this.backend.currentKernelId,computePipeline:t.computePipeline,bindGroup:r,dispatchGroup:o};this.backend.capturedCommandList.get(this.backend.currentSessionId).push(s)}n.setPipeline(t.computePipeline),n.setBindGroup(0,r),n.dispatchWorkgroups(...o),this.backend.writeTimestamp(this.backend.pendingDispatchNumber*2+1),this.backend.pendingDispatchNumber++,(this.backend.pendingDispatchNumber>=this.backend.maxDispatchNumber||this.backend.queryType==="at-passes")&&this.backend.endComputePass(),this.backend.pendingDispatchNumber>=this.backend.maxDispatchNumber&&this.backend.flush(),Nt(t.programInfo.name)}dispose(){}build(t,r){Vt(t.name);let o=this.backend.device,n=[];o.features.has("shader-f16")&&n.push("enable f16;");let s=Ia(r),u=t.getShaderSource(s),l=`${n.join(`\n`)}\n${s.additionalImplementations}\n${u}`,a=o.createShaderModule({code:l,label:t.name});Re("verbose",()=>`[WebGPU] ${t.name} shader code: ${l}`);let p=o.createComputePipeline({compute:{module:a,entryPoint:"main"},layout:"auto",label:t.name});return Nt(t.name),{programInfo:t,computePipeline:p}}normalizeDispatchGroupSize(t){let r=typeof t=="number"?t:t.x,o=typeof t=="number"?1:t.y||1,n=typeof t=="number"?1:t.z||1,s=this.backend.device.limits.maxComputeWorkgroupsPerDimension;if(r<=s&&o<=s&&n<=s)return[r,o,n];let u=r*o*n,l=Math.ceil(Math.sqrt(u));if(l>s){if(l=Math.ceil(Math.cbrt(u)),l>s)throw new Error("Total dispatch size exceeds WebGPU maximum.");return[l,l,l]}else return[l,l,1]}}});var Qc,Jc,yn,ku=q(()=>{"use strict";rr();We();Pt();$a();Ca();Pu();Bu();Qc=(e,t)=>{if(t.length!==e.length)throw new Error(`inputDependencies length ${t.length} is not equal to inputTensors length ${e.length}.`);let r=[];for(let o=0;o<e.length;++o){let n=e[o].dataType;switch(t[o]){case"none":{r.push("");break}case"type":{r.push(`${n}`);break}case"rank":{let s=e[o].dims.length;r.push(`${n};${s}`);break}case"dims":{let s=e[o].dims.join(",");r.push(`${n};${s}`);break}default:throw new Error(`unsupported input dependency: ${t[o]}`)}}return r.join("|")},Jc=(e,t,r)=>{let o=e.name;return e.shaderCache?.hint&&(o+="["+e.shaderCache.hint+"]"),o+=":"+r+`:${Qc(t,e.shaderCache?.inputDependencies??new Array(t.length).fill("dims"))}`,o},yn=class{constructor(){this.currentSessionId=null;this.currentKernelId=null;this.commandEncoder=null;this.computePassEncoder=null;this.maxDispatchNumber=16;this.pendingDispatchNumber=0;this.pendingKernels=[];this.pendingQueries=new Map;this.sessionStatus="default";this.capturedCommandList=new Map;this.capturedPendingKernels=new Map;this.sessionExternalDataMapping=new Map}get currentKernelCustomData(){if(this.currentKernelId===null)throw new Error("currentKernelCustomData(): currentKernelId is null. (should not happen)");let t=this.kernelCustomData.get(this.currentKernelId);return t||(t={},this.kernelCustomData.set(this.currentKernelId,t)),t}async initialize(t,r){this.env=t;let o=[],n={requiredLimits:{maxComputeWorkgroupStorageSize:r.limits.maxComputeWorkgroupStorageSize,maxComputeWorkgroupsPerDimension:r.limits.maxComputeWorkgroupsPerDimension,maxStorageBufferBindingSize:r.limits.maxStorageBufferBindingSize,maxBufferSize:r.limits.maxBufferSize,maxComputeInvocationsPerWorkgroup:r.limits.maxComputeInvocationsPerWorkgroup,maxComputeWorkgroupSizeX:r.limits.maxComputeWorkgroupSizeX,maxComputeWorkgroupSizeY:r.limits.maxComputeWorkgroupSizeY,maxComputeWorkgroupSizeZ:r.limits.maxComputeWorkgroupSizeZ},requiredFeatures:o};r.features.has("chromium-experimental-timestamp-query-inside-passes")?o.push("chromium-experimental-timestamp-query-inside-passes"):r.features.has("timestamp-query")&&o.push("timestamp-query"),r.features.has("shader-f16")&&o.push("shader-f16"),this.device=await r.requestDevice(n),this.gpuDataManager=_a(this),this.programManager=new gn(this),this.kernels=new Map,this.kernelPersistentData=new Map,this.kernelCustomData=new Map,this.kernelUniformCache=new Map,this.kernelGpuBindGroupCache=new Map,wa(t.logLevel,!!t.debug),this.device.onuncapturederror=s=>{s.error instanceof GPUValidationError&&console.error(`An uncaught WebGPU validation error was raised: ${s.error.message}`)},Object.defineProperty(this.env.webgpu,"device",{value:this.device}),this.setQueryType()}dispose(){typeof this.querySet<"u"&&this.querySet.destroy(),this.gpuDataManager.dispose()}getCommandEncoder(){return this.commandEncoder||(this.commandEncoder=this.device.createCommandEncoder(),this.setQueryType(),this.queryType!=="none"&&typeof this.querySet>"u"&&(this.querySet=this.device.createQuerySet({type:"timestamp",count:this.maxDispatchNumber*2}),this.queryResolveBuffer=this.device.createBuffer({size:this.maxDispatchNumber*2*8,usage:GPUBufferUsage.COPY_SRC|GPUBufferUsage.QUERY_RESOLVE}))),this.commandEncoder}getComputePassEncoder(){if(!this.computePassEncoder){let t=this.getCommandEncoder(),r={};this.queryType==="at-passes"&&(r.timestampWrites={querySet:this.querySet,beginningOfPassWriteIndex:this.pendingDispatchNumber*2,endOfPassWriteIndex:this.pendingDispatchNumber*2+1}),this.computePassEncoder=t.beginComputePass(r)}return this.computePassEncoder}endComputePass(){this.computePassEncoder&&(this.computePassEncoder.end(),this.computePassEncoder=null)}flush(){if(!this.commandEncoder)return;Vt(),this.endComputePass();let t;this.queryType!=="none"&&(this.commandEncoder.resolveQuerySet(this.querySet,0,this.pendingDispatchNumber*2,this.queryResolveBuffer,0),t=this.device.createBuffer({size:this.pendingDispatchNumber*2*8,usage:GPUBufferUsage.MAP_READ|GPUBufferUsage.COPY_DST}),this.pendingQueries.set(t,this.pendingKernels),this.pendingKernels=[],this.commandEncoder.copyBufferToBuffer(this.queryResolveBuffer,0,t,0,this.pendingDispatchNumber*2*8)),this.device.queue.submit([this.commandEncoder.finish()]),this.gpuDataManager.refreshPendingBuffers(),this.commandEncoder=null,this.pendingDispatchNumber=0,this.queryType!=="none"&&t.mapAsync(GPUMapMode.READ).then(()=>{let r=new BigUint64Array(t.getMappedRange()),o=this.pendingQueries.get(t);for(let n=0;n<r.length/2;n++){let s=o[n],u=s.kernelId,l=this.kernels.get(u),a=l.kernelType,p=l.kernelName,h=s.programName,g=s.inputTensorViews,w=s.outputTensorViews,v=r[n*2],y=r[n*2+1];typeof this.queryTimeBase>"u"&&(this.queryTimeBase=v);let _=Number(v-this.queryTimeBase),I=Number(y-this.queryTimeBase);if(!Number.isSafeInteger(_)||!Number.isSafeInteger(I))throw new RangeError("incorrect timestamp range");if(this.env.webgpu.profiling?.ondata)this.env.webgpu.profiling.ondata({version:1,inputsMetadata:g.map(x=>({dims:x.dims,dataType:nt(x.dataType)})),outputsMetadata:w.map(x=>({dims:x.dims,dataType:nt(x.dataType)})),kernelId:u,kernelType:a,kernelName:p,programName:h,startTime:_,endTime:I});else{let x="";g.forEach((O,C)=>{x+=`input[${C}]: [${O.dims}] | ${nt(O.dataType)}, `});let A="";w.forEach((O,C)=>{A+=`output[${C}]: [${O.dims}] | ${nt(O.dataType)}, `}),console.log(`[profiling] kernel "${u}|${a}|${p}|${h}" ${x}${A}execution time: ${I-_} ns`)}Nn("GPU",`${h}::${v}::${y}`)}t.unmap(),this.pendingQueries.delete(t)}),Nt()}run(t,r,o,n,s){Vt(t.name);let u=[];for(let C=0;C<r.length;++C){let M=this.gpuDataManager.get(r[C].data);if(!M)throw new Error(`no GPU data for input: ${r[C].data}`);u[C]=M}let{outputs:l,dispatchGroup:a,programUniforms:p}=t.getRunData(r),h=o.length===0?l.map((C,M)=>M):o;if(h.length!==l.length)throw new Error(`Output size ${h.length} must be equal to ${l.length}.`);let g=[],w=[];for(let C=0;C<l.length;++C){if(!Number.isInteger(h[C])||h[C]<-3||h[C]>=l.length)throw new Error(`Invalid output index: ${h[C]}`);if(h[C]===-3)continue;let M=h[C]===-1,D=h[C]===-2,G=M||D?s(l[C].dataType,l[C].dims):n(h[C],l[C].dataType,l[C].dims),E=this.gpuDataManager.get(G.data);if(!E)throw new Error(`no GPU data for output: ${G.data}`);if(M&&this.temporaryData.push(E),D){let W=this.kernelPersistentData.get(this.currentKernelId);W||(W=[],this.kernelPersistentData.set(this.currentKernelId,W)),W.push(E)}g.push(G),w.push(E)}let v;if(p){let C=this.kernelUniformCache.get(this.currentKernelId);C&&(this.compareProgramUniforms(C.programUniforms,p)||(this.gpuDataManager.release(C.gpuData.id),C=void 0)),C||(C=this.createCachedUniform(p),this.kernelUniformCache.set(this.currentKernelId,C)),v=C.binding}let y=this.programManager.normalizeDispatchGroupSize(a),_=y[1]===1&&y[2]===1,I=Jc(t,r,_),x=this.programManager.getArtifact(I);if(x||(x=this.programManager.build(t,y),this.programManager.setArtifact(I,x),Re("info",()=>`[artifact] key: ${I}, programName: ${t.name}`)),Re("info",()=>`[ProgramManager] run "${t.name}" (key=${I}) with ${y[0]}x${y[1]}x${y[2]}`),this.queryType!=="none"||this.sessionStatus==="capturing"){let C={kernelId:this.currentKernelId,programName:x.programInfo.name,inputTensorViews:r,outputTensorViews:g};this.pendingKernels.push(C),this.capturedPendingKernels.get(this.currentSessionId).push(C)}let A=this.kernelGpuBindGroupCache.get(this.currentKernelId);A||(A=[],this.kernelGpuBindGroupCache.set(this.currentKernelId,A));let O;for(let C of A)if(this.checkCachedBindGroup(C,x,u,w,v)){O=C;break}if(!O)for(O=this.createCachedBindGroup(x,u,w,v),A.push(O);A.length>20;)A.shift();return this.programManager.run(x,O.binding,y),Nt(t.name),g}compareProgramUniforms(t,r){return t.length!==r.length?!1:t.every((n,s)=>n.type===r[s].type)}createCachedUniform(t){let r=0,o=[];t.forEach(a=>{let p=typeof a.data=="number"?[a.data]:a.data;if(p.length===0)return;let h=p.length<=2?p.length*4:16;r=Math.ceil(r/h)*h,o.push(r),r+=p.length>4?Math.ceil(p.length/4)*16:p.length*4});let n=16;r=Math.ceil(r/n)*n;let s=new ArrayBuffer(r);t.forEach((a,p)=>{let h=o[p],g=typeof a.data=="number"?[a.data]:a.data;a.type==="int32"?new Int32Array(s,h,g.length).set(g):a.type==="uint32"?new Uint32Array(s,h,g.length).set(g):new Float32Array(s,h,g.length).set(g)});let u=this.gpuDataManager.create(r,GPUBufferUsage.COPY_DST|GPUBufferUsage.UNIFORM);this.device.queue.writeBuffer(u.buffer,0,s,0,r);let l={offset:0,size:r,buffer:u.buffer};return{programUniforms:t,binding:l,gpuData:u}}checkCachedBindGroup(t,r,o,n,s){if(r!==t.artifact)return!1;let u=o.every((p,h)=>p.permamentID===t.inputPermamentIDs[h]),l=n.every((p,h)=>p.permamentID===t.outputPermamentIDs[h]),a=s===t.uniformBinding;return u&&l&&a}createCachedBindGroup(t,r,o,n){let s=[];for(let l of r)s.push({binding:s.length,resource:{buffer:l.buffer}});for(let l of o)s.push({binding:s.length,resource:{buffer:l.buffer}});return n&&s.push({binding:s.length,resource:n}),{binding:this.device.createBindGroup({layout:t.computePipeline.getBindGroupLayout(0),entries:s,label:t.programInfo.name}),artifact:t,inputPermamentIDs:r.map(l=>l.permamentID),outputPermamentIDs:o.map(l=>l.permamentID),uniformBinding:n}}upload(t,r){this.gpuDataManager.upload(t,r)}memcpy(t,r){this.gpuDataManager.memcpy(t,r)}async download(t,r){await this.gpuDataManager.download(t,r)}alloc(t){return this.gpuDataManager.create(t).id}free(t){return this.gpuDataManager.release(t)}createKernel(t,r,o,n){let s=Ou.get(t);if(!s)throw new Error(`kernel not implemented: ${t}`);let u={kernelType:t,kernelName:n,kernelEntry:s[0],attributes:[s[1],o]};this.kernels.set(r,u)}releaseKernel(t){let r=this.kernelPersistentData.get(t);if(r){for(let n of r)this.gpuDataManager.release(n.id);this.kernelPersistentData.delete(t)}this.kernelCustomData.delete(t),this.kernelGpuBindGroupCache.delete(t);let o=this.kernelUniformCache.get(t);o&&(this.gpuDataManager.release(o.gpuData.id),this.kernelUniformCache.delete(t)),this.kernels.delete(t)}computeKernel(t,r,o){let n=this.kernels.get(t);if(!n)throw new Error(`kernel not created: ${t}`);let s=n.kernelType,u=n.kernelName,l=n.kernelEntry,a=n.attributes;if(this.currentKernelId!==null)throw new Error(`kernel "[${s}] ${u}" is not allowed to be called recursively`);this.currentKernelId=t,a[0]&&(a[1]=a[0](a[1]),a[0]=void 0),Re("info",()=>`[WebGPU] Start to run kernel "[${s}] ${u}"...`);let p=this.env.debug;this.temporaryData=[];try{return p&&this.device.pushErrorScope("validation"),l(r,a[1]),0}catch(h){return o.push(Promise.resolve(`[WebGPU] Kernel "[${s}] ${u}" failed. ${h}`)),1}finally{p&&o.push(this.device.popErrorScope().then(h=>h?`GPU validation error for kernel "[${s}] ${u}": ${h.message}`:null));for(let h of this.temporaryData)this.gpuDataManager.release(h.id);this.temporaryData=[],this.currentKernelId=null}}registerBuffer(t,r,o,n){let s=this.sessionExternalDataMapping.get(t);s||(s=new Map,this.sessionExternalDataMapping.set(t,s));let u=s.get(r),l=this.gpuDataManager.registerExternalBuffer(o,n,u?.[1]);return s.set(r,[l,o]),l}unregisterBuffers(t){let r=this.sessionExternalDataMapping.get(t);r&&(r.forEach(o=>this.gpuDataManager.unregisterExternalBuffer(o[1])),this.sessionExternalDataMapping.delete(t))}getBuffer(t){let r=this.gpuDataManager.get(t);if(!r)throw new Error(`no GPU data for buffer: ${t}`);return r.buffer}createDownloader(t,r,o){return async()=>{let n=await Ln(this,t,r);return va(n.buffer,o)}}writeTimestamp(t){this.queryType==="inside-passes"&&this.computePassEncoder.writeTimestamp(this.querySet,t)}setQueryType(){this.queryType="none",(this.env.webgpu.profiling?.mode==="default"||this.env.wasm.trace)&&(this.device.features.has("chromium-experimental-timestamp-query-inside-passes")?this.queryType="inside-passes":this.device.features.has("timestamp-query")&&(this.queryType="at-passes"))}captureBegin(){Re("info","captureBegin");let t=this.capturedCommandList.get(this.currentSessionId),r=this.capturedPendingKernels.get(this.currentSessionId);t||(t=[],this.capturedCommandList.set(this.currentSessionId,t),r=[],this.capturedPendingKernels.set(this.currentSessionId,r)),this.flush(),this.sessionStatus="capturing"}captureEnd(){Re("info","captureEnd"),this.flush(),this.sessionStatus="default"}replay(){Re("info","replay"),this.sessionStatus="replaying";let t=this.capturedCommandList.get(this.currentSessionId),r=this.capturedPendingKernels.get(this.currentSessionId),o=t.length;this.pendingKernels=[];for(let n=0;n<o;n++){let s=this.getComputePassEncoder(),u=t[n];this.writeTimestamp(this.pendingDispatchNumber*2),s.setPipeline(u.computePipeline),s.setBindGroup(0,u.bindGroup),s.dispatchWorkgroups(...u.dispatchGroup),this.writeTimestamp(this.pendingDispatchNumber*2+1),this.pendingDispatchNumber++,this.queryType!=="none"&&this.pendingKernels.push(r[n]),(this.pendingDispatchNumber>=this.maxDispatchNumber||this.queryType==="at-passes")&&this.endComputePass(),this.pendingDispatchNumber>=this.maxDispatchNumber&&this.flush()}this.flush(),this.sessionStatus="default"}onReleaseSession(t){this.unregisterBuffers(t),this.capturedCommandList.has(t)&&this.capturedCommandList.delete(t),this.capturedPendingKernels.has(t)&&this.capturedPendingKernels.delete(t),this.gpuDataManager.onReleaseSession(t)}onRunStart(t){this.currentSessionId=t,this.setQueryType()}}});var Ru={};xr(Ru,{init:()=>Xc});var Or,fo,Xc,Du=q(()=>{"use strict";We();ku();Pt();xe();Or=class e{constructor(t,r,o,n){this.module=t;this.dataType=r;this.data=o;this.dims=n}getFloat32Array(){if(this.dataType!==1)throw new Error("Invalid data type");let t=V.size(this.dims);return t===0?new Float32Array:new Float32Array(this.module.HEAP8.buffer,this.data,t)}getBigInt64Array(){if(this.dataType!==7)throw new Error("Invalid data type");let t=V.size(this.dims);return t===0?new BigInt64Array:new BigInt64Array(this.module.HEAP8.buffer,this.data,t)}getInt32Array(){if(this.dataType!==6)throw new Error("Invalid data type");let t=V.size(this.dims);return t===0?new Int32Array:new Int32Array(this.module.HEAP8.buffer,this.data,t)}reshape(t){if(V.size(t)!==V.size(this.dims))throw new Error("Invalid new shape");return new e(this.module,this.dataType,this.data,t)}},fo=class{constructor(t,r,o){this.module=t;this.backend=r;this.customDataOffset=0;this.customDataSize=0;let n=t.HEAPU32,s=o>>>2;this.opKernelContext=n[s++];let u=n[s++];this.outputCount=n[s++],this.customDataOffset=n[s++],this.customDataSize=n[s++];let l=[];for(let a=0;a<u;a++){let p=n[s++],h=n[s++],g=n[s++],w=[];for(let v=0;v<g;v++)w.push(n[s++]);l.push(new Or(t,p,h,w))}this.inputs=l}get kernelCustomData(){return this.backend.currentKernelCustomData}get customDataBuffer(){return this.module.HEAPU8.subarray(this.customDataOffset,this.customDataOffset+this.customDataSize)}compute(t,r){let o=r?.inputs?.map(l=>typeof l=="number"?this.inputs[l]:l)??this.inputs,n=r?.outputs??[],s=(l,a,p)=>new Or(this.module,a,this.output(l,p),p),u=(l,a)=>{let p=Cr(l);if(!p)throw new Error(`Unsupported data type: ${l}`);let h=p*V.size(a);return new Or(this.module,l,this.backend.gpuDataManager.create(h).id,a)};return this.backend.run(t,o,n,s,u)}output(t,r){let o=this.module.stackSave();try{let n=this.module.stackAlloc((1+r.length)*4),s=n>>2;this.module.HEAPU32[s++]=r.length;for(let u=0;u<r.length;u++)this.module.HEAPU32[s++]=r[u];return this.module._JsepOutput(this.opKernelContext,t,n)}catch(n){throw new Error(`Failed to generate kernel\'s output[${t}] with dims [${r}]. If you are running with pre-allocated output, please make sure the output type/dims are correct. Error: ${n}`)}finally{this.module.stackRestore(o)}}},Xc=async(e,t,r)=>{let o=e.jsepInit;if(!o)throw new Error("Failed to initialize JSEP. The WebAssembly module is not built with JSEP support.");let n=new yn;await n.initialize(t,r),o(n,s=>n.alloc(s),s=>n.free(s),(s,u,l,a=!1)=>{if(a)Re("verbose",()=>`[WebGPU] jsepCopyGpuToGpu: src=${s}, dst=${u}, size=${l}`),n.memcpy(s,u);else{Re("verbose",()=>`[WebGPU] jsepCopyCpuToGpu: dataOffset=${s}, gpuDataId=${u}, size=${l}`);let p=e.HEAPU8.subarray(s>>>0,(s>>>0)+l);n.upload(u,p)}},async(s,u,l)=>{Re("verbose",()=>`[WebGPU] jsepCopyGpuToCpu: gpuDataId=${s}, dataOffset=${u}, size=${l}`),await n.download(s,()=>e.HEAPU8.subarray(u>>>0,(u>>>0)+l))},(s,u,l)=>n.createKernel(s,u,l,e.UTF8ToString(e._JsepGetNodeName(u))),s=>n.releaseKernel(s),(s,u,l,a)=>{Re("verbose",()=>`[WebGPU] jsepRun: sessionHandle=${l}, kernel=${s}, contextDataOffset=${u}`);let p=new fo(e,n,u);return n.computeKernel(s,p,a)},()=>n.captureBegin(),()=>n.captureEnd(),()=>n.replay())}});var Yo;Yo=Vo();var pd=Ko(),Dn,Mn=!1,Fr=!1,jo=!1,md=e=>{if(e===1)return!1;if(typeof SharedArrayBuffer>"u")return typeof self<"u"&&!self.crossOriginIsolated&&console.warn("env.wasm.numThreads is set to "+e+", but this will not work unless you enable crossOriginIsolated mode. See https://web.dev/cross-origin-isolation-guide/ for more info."),!1;typeof process<"u"&&process.versions&&process.versions.node&&console.warn("env.wasm.numThreads is set to "+e+", however, currently onnxruntime-web does not support multi-threads in Node.js. Please consider using onnxruntime-node for performance critical scenarios.");try{return typeof MessageChannel<"u"&&new MessageChannel().port1.postMessage(new SharedArrayBuffer(1)),WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,5,4,1,3,1,1,10,11,1,9,0,65,0,254,16,2,0,26,11]))}catch{return!1}},fd=()=>{try{return WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,10,30,1,28,0,65,0,253,15,253,12,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,253,186,1,26,11]))}catch{return!1}},hd=(e,t)=>e?t?"ort-wasm-simd-threaded.wasm":"ort-wasm-simd.wasm":t?"ort-wasm-threaded.wasm":"ort-wasm.wasm",Zo=async e=>{if(Mn)return Promise.resolve();if(Fr)throw new Error("multiple calls to \'initializeWebAssembly()\' detected.");if(jo)throw new Error("previous call to \'initializeWebAssembly()\' failed.");Fr=!0;let t=e.initTimeout,r=e.numThreads,o=e.simd,n=md(r),s=o&&fd(),u=e.wasmPaths,l=typeof u=="string"?u:void 0,a=hd(s,n),p=typeof u=="object"?u[a]:void 0,h=!1,g=[];if(t>0&&g.push(new Promise(w=>{setTimeout(()=>{h=!0,w()},t)})),g.push(new Promise((w,v)=>{let y=n?pd:Yo,_={locateFile:(I,x)=>{if(n&&I.endsWith(".worker.js")&&typeof Blob<"u")return URL.createObjectURL(new Blob([qo()],{type:"text/javascript"}));if(I.endsWith(".wasm")){if(p)return p;let A=l??x;return a==="ort-wasm-simd.wasm"?A+"ort-wasm-simd.jsep.wasm":a==="ort-wasm-simd-threaded.wasm"?A+"ort-wasm-simd-threaded.jsep.wasm":A+a}return x+I}};if(n)if(_.numThreads=r,typeof Blob>"u")_.mainScriptUrlOrBlob=(void 0)(__dirname,"ort-wasm-threaded.js");else{let I=`var ortWasmThreaded=${y.toString()};`;_.mainScriptUrlOrBlob=new Blob([I],{type:"text/javascript"})}y(_).then(I=>{Fr=!1,Mn=!0,Dn=I,w()},I=>{Fr=!1,jo=!0,v(I)})})),await Promise.race(g),h)throw new Error(`WebAssembly backend initializing failed due to timeout: ${t}ms`)},ze=()=>{if(Mn&&Dn)return Dn;throw new Error("WebAssembly is not initialized yet.")};var Ve=(e,t)=>{let r=ze(),o=r.lengthBytesUTF8(e)+1,n=r._malloc(o);return r.stringToUTF8(e,n,o),t.push(n),n},_r=(e,t,r,o)=>{if(typeof e=="object"&&e!==null){if(r.has(e))throw new Error("Circular reference in options");r.add(e)}Object.entries(e).forEach(([n,s])=>{let u=t?t+n:n;if(typeof s=="object")_r(s,u+".",r,o);else if(typeof s=="string"||typeof s=="number")o(u,s.toString());else if(typeof s=="boolean")o(u,s?"1":"0");else throw new Error(`Can\'t handle extra config type: ${typeof s}`)})},ke=e=>{let t=ze(),r=t.stackSave();try{let o=t.stackAlloc(8);t._OrtGetLastError(o,o+4);let n=t.HEAP32[o/4],s=t.HEAPU32[o/4+1],u=s?t.UTF8ToString(s):"";throw new Error(`${e} ERROR_CODE: ${n}, ERROR_MESSAGE: ${u}`)}finally{t.stackRestore(r)}};var Qo=e=>{let t=ze(),r=0,o=[],n=e||{};try{if(e?.logSeverityLevel===void 0)n.logSeverityLevel=2;else if(typeof e.logSeverityLevel!="number"||!Number.isInteger(e.logSeverityLevel)||e.logSeverityLevel<0||e.logSeverityLevel>4)throw new Error(`log serverity level is not valid: ${e.logSeverityLevel}`);if(e?.logVerbosityLevel===void 0)n.logVerbosityLevel=0;else if(typeof e.logVerbosityLevel!="number"||!Number.isInteger(e.logVerbosityLevel))throw new Error(`log verbosity level is not valid: ${e.logVerbosityLevel}`);e?.terminate===void 0&&(n.terminate=!1);let s=0;return e?.tag!==void 0&&(s=Ve(e.tag,o)),r=t._OrtCreateRunOptions(n.logSeverityLevel,n.logVerbosityLevel,!!n.terminate,s),r===0&&ke("Can\'t create run options."),e?.extra!==void 0&&_r(e.extra,"",new WeakSet,(u,l)=>{let a=Ve(u,o),p=Ve(l,o);t._OrtAddRunConfigEntry(r,a,p)!==0&&ke(`Can\'t set a run config entry: ${u} - ${l}.`)}),[r,o]}catch(s){throw r!==0&&t._OrtReleaseRunOptions(r),o.forEach(u=>t._free(u)),s}};var gd=e=>{switch(e){case"disabled":return 0;case"basic":return 1;case"extended":return 2;case"all":return 99;default:throw new Error(`unsupported graph optimization level: ${e}`)}},yd=e=>{switch(e){case"sequential":return 0;case"parallel":return 1;default:throw new Error(`unsupported execution mode: ${e}`)}},bd=e=>{e.extra||(e.extra={}),e.extra.session||(e.extra.session={});let t=e.extra.session;t.use_ort_model_bytes_directly||(t.use_ort_model_bytes_directly="1"),e.executionProviders&&e.executionProviders.some(r=>(typeof r=="string"?r:r.name)==="webgpu")&&(e.enableMemPattern=!1)},wd=(e,t,r)=>{for(let o of t){let n=typeof o=="string"?o:o.name;switch(n){case"webnn":if(n="WEBNN",typeof o!="string"){let u=o;if(u?.deviceType){let l=Ve("deviceType",r),a=Ve(u.deviceType,r);ze()._OrtAddSessionConfigEntry(e,l,a)!==0&&ke(`Can\'t set a session config entry: \'deviceType\' - ${u.deviceType}.`)}if(u?.numThreads){let l=u.numThreads;(typeof l!="number"||!Number.isInteger(l)||l<0)&&(l=0);let a=Ve("numThreads",r),p=Ve(l.toString(),r);ze()._OrtAddSessionConfigEntry(e,a,p)!==0&&ke(`Can\'t set a session config entry: \'numThreads\' - ${u.numThreads}.`)}if(u?.powerPreference){let l=Ve("powerPreference",r),a=Ve(u.powerPreference,r);ze()._OrtAddSessionConfigEntry(e,l,a)!==0&&ke(`Can\'t set a session config entry: \'powerPreference\' - ${u.powerPreference}.`)}}break;case"webgpu":if(n="JS",typeof o!="string"){let u=o;if(u?.preferredLayout){if(u.preferredLayout!=="NCHW"&&u.preferredLayout!=="NHWC")throw new Error(`preferredLayout must be either \'NCHW\' or \'NHWC\': ${u.preferredLayout}`);let l=Ve("preferredLayout",r),a=Ve(u.preferredLayout,r);ze()._OrtAddSessionConfigEntry(e,l,a)!==0&&ke(`Can\'t set a session config entry: \'preferredLayout\' - ${u.preferredLayout}.`)}}break;case"wasm":case"cpu":continue;default:throw new Error(`not supported execution provider: ${n}`)}let s=Ve(n,r);ze()._OrtAppendExecutionProvider(e,s)!==0&&ke(`Can\'t append execution provider: ${n}.`)}},Jo=e=>{let t=ze(),r=0,o=[],n=e||{};bd(n);try{let s=gd(n.graphOptimizationLevel??"all"),u=yd(n.executionMode??"sequential"),l=typeof n.logId=="string"?Ve(n.logId,o):0,a=n.logSeverityLevel??2;if(!Number.isInteger(a)||a<0||a>4)throw new Error(`log serverity level is not valid: ${a}`);let p=n.logVerbosityLevel??0;if(!Number.isInteger(p)||p<0||p>4)throw new Error(`log verbosity level is not valid: ${p}`);let h=typeof n.optimizedModelFilePath=="string"?Ve(n.optimizedModelFilePath,o):0;if(r=t._OrtCreateSessionOptions(s,!!n.enableCpuMemArena,!!n.enableMemPattern,u,!!n.enableProfiling,0,l,a,p,h),r===0&&ke("Can\'t create session options."),n.executionProviders&&wd(r,n.executionProviders,o),n.enableGraphCapture!==void 0){if(typeof n.enableGraphCapture!="boolean")throw new Error(`enableGraphCapture must be a boolean value: ${n.enableGraphCapture}`);let g=Ve("enableGraphCapture",o),w=Ve(n.enableGraphCapture.toString(),o);t._OrtAddSessionConfigEntry(r,g,w)!==0&&ke(`Can\'t set a session config entry: \'enableGraphCapture\' - ${n.enableGraphCapture}.`)}if(n.freeDimensionOverrides)for(let[g,w]of Object.entries(n.freeDimensionOverrides)){if(typeof g!="string")throw new Error(`free dimension override name must be a string: ${g}`);if(typeof w!="number"||!Number.isInteger(w)||w<0)throw new Error(`free dimension override value must be a non-negative integer: ${w}`);let v=Ve(g,o);t._OrtAddFreeDimensionOverride(r,v,w)!==0&&ke(`Can\'t set a free dimension override: ${g} - ${w}.`)}return n.extra!==void 0&&_r(n.extra,"",new WeakSet,(g,w)=>{let v=Ve(g,o),y=Ve(w,o);t._OrtAddSessionConfigEntry(r,v,y)!==0&&ke(`Can\'t set a session config entry: ${g} - ${w}.`)}),[r,o]}catch(s){throw r!==0&&t._OrtReleaseSessionOptions(r),o.forEach(u=>t._free(u)),s}};We();var ea=async e=>{if(typeof e=="string")if(typeof process<"u"&&process.versions&&process.versions.node)try{return new Uint8Array(await(void 0)(e))}catch(t){if(t.code==="ERR_FS_FILE_TOO_LARGE"){let r=(void 0)(e),o=[];for await(let n of r)o.push(n);return new Uint8Array(Buffer.concat(o))}throw t}else{let t=await fetch(e);if(!t.ok)throw new Error(`failed to load external data file: ${e}`);let r=t.headers.get("Content-Length"),o=r?parseInt(r,10):0;if(o<1073741824)return new Uint8Array(await t.arrayBuffer());{if(!t.body)throw new Error(`failed to load external data file: ${e}, no response body.`);let n=t.body.getReader(),s;try{s=new ArrayBuffer(o)}catch(l){if(l instanceof RangeError){let a=Math.ceil(o/65536);s=new WebAssembly.Memory({initial:a,maximum:a}).buffer}else throw l}let u=0;for(;;){let{done:l,value:a}=await n.read();if(l)break;let p=a.byteLength;new Uint8Array(s,u,p).set(a),u+=p}return new Uint8Array(s,0,o)}}else return e instanceof Blob?new Uint8Array(await e.arrayBuffer()):e instanceof Uint8Array?e:new Uint8Array(e)};var ep=(e,t)=>{ze()._OrtInit(e,t)!==0&&ke("Can\'t initialize onnxruntime.")},Uu=async e=>{ep(e.wasm.numThreads,Ir(e.logLevel))},zu=async(e,t)=>{if(t==="webgpu"){if(typeof navigator>"u"||!navigator.gpu)throw new Error("WebGPU is not supported in current environment");let r=await navigator.gpu.requestAdapter();if(!r)throw new Error(\'Failed to get GPU adapter. You may need to enable flag "--enable-unsafe-webgpu" if you are using Chrome.\');if(!e.wasm.simd)throw new Error("Not supported for WebGPU=ON and SIMD=OFF. Please set `env.wasm.simd` to true when using `webgpu` EP");let o=(Du(),Ot(Ru)).init;await o(ze(),e,r)}},Gt=new Map,tp=e=>{let t=ze(),r=t.stackSave();try{let o=t.stackAlloc(8);return t._OrtGetInputOutputCount(e,o,o+4)!==0&&ke("Can\'t get session input/output count."),[t.HEAP32[o/4],t.HEAP32[o/4+1]]}finally{t.stackRestore(r)}},ho=e=>{let t=ze(),r=t._malloc(e.byteLength);if(r===0)throw new Error(`Can\'t create a session. failed to allocate a buffer of size ${e.byteLength}.`);return t.HEAPU8.set(e,r),[r,e.byteLength]},Vu=async(e,t)=>{let r,o,n=ze();Array.isArray(e)?[r,o]=e:e.buffer===n.HEAPU8.buffer?[r,o]=[e.byteOffset,e.byteLength]:[r,o]=ho(e);let s=0,u=0,l=0,a=[],p=[],h=[];try{if([u,a]=Jo(t),t?.externalData&&n.mountExternalData){let A=[];for(let O of t.externalData){let C=typeof O=="string"?O:O.path;A.push(ea(typeof O=="string"?O:O.data).then(M=>{n.mountExternalData(C,M)}))}await Promise.all(A)}s=n._OrtCreateSession(r,o,u),s===0&&ke("Can\'t create a session.");let[g,w]=tp(s),v=!!t?.enableGraphCapture,y=[],_=[],I=[];for(let A=0;A<g;A++){let O=n._OrtGetInputName(s,A);O===0&&ke("Can\'t get an input name."),p.push(O),y.push(n.UTF8ToString(O))}for(let A=0;A<w;A++){let O=n._OrtGetOutputName(s,A);O===0&&ke("Can\'t get an output name."),h.push(O);let C=n.UTF8ToString(O);_.push(C);{if(v&&t?.preferredOutputLocation===void 0){I.push("gpu-buffer");continue}let M=typeof t?.preferredOutputLocation=="string"?t.preferredOutputLocation:t?.preferredOutputLocation?.[C]??"cpu";if(M!=="cpu"&&M!=="cpu-pinned"&&M!=="gpu-buffer")throw new Error(`Not supported preferred output location: ${M}.`);if(v&&M!=="gpu-buffer")throw new Error(`Not supported preferred output location: ${M}. Only \'gpu-buffer\' location is supported when enableGraphCapture is true.`);I.push(M)}}let x=null;return I.some(A=>A==="gpu-buffer")&&(l=n._OrtCreateBinding(s),l===0&&ke("Can\'t create IO binding."),x={handle:l,outputPreferredLocations:I,outputPreferredLocationsEncoded:I.map(A=>zn(A))}),Gt.set(s,[s,p,h,x,v,!1]),[s,y,_]}catch(g){throw p.forEach(w=>n._OrtFree(w)),h.forEach(w=>n._OrtFree(w)),l!==0&&n._OrtReleaseBinding(l),s!==0&&n._OrtReleaseSession(s),g}finally{n._free(r),u!==0&&n._OrtReleaseSessionOptions(u),a.forEach(g=>n._free(g)),n.unmountExternalData?.()}},Nu=e=>{let t=ze(),r=Gt.get(e);if(!r)throw new Error(`cannot release session. invalid session id: ${e}`);let[o,n,s,u,l]=r;u&&(l&&t._OrtClearBoundOutputs(u.handle),t._OrtReleaseBinding(u.handle)),t.jsepOnReleaseSession?.(e),n.forEach(a=>t._OrtFree(a)),s.forEach(a=>t._OrtFree(a)),t._OrtReleaseSession(o),Gt.delete(e)},rp=(e,t,r)=>{if(e!==null&&e[0]===t){let n=e[2];if(n.length===r)return n}let o=Kr(t);return new o(r)},Mu=(e,t,r,o,n,s=!1)=>{if(!e){t.push(0);return}let u=ze(),l=e[0],a=e[1],p=e[3],h,g;if(l==="string"&&p==="gpu-buffer")throw new Error("String tensor is not supported on GPU.");if(s&&p!=="gpu-buffer")throw new Error(`External buffer must be provided for input/output index ${n} when enableGraphCapture is true.`);if(p==="gpu-buffer"){let y=e[2].gpuBuffer,_=Cr(Un(l));g=a.reduce((I,x)=>I*x,1)*_,h=u.jsepRegisterBuffer(o,n,y,g)}else{let y=e[2];if(Array.isArray(y)){g=4*y.length,h=u._malloc(g),r.push(h);let _=h/4;for(let I=0;I<y.length;I++){if(typeof y[I]!="string")throw new TypeError(`tensor data at index ${I} is not a string`);u.HEAPU32[_++]=Ve(y[I],r)}}else g=y.byteLength,h=u._malloc(g),r.push(h),u.HEAPU8.set(new Uint8Array(y.buffer,y.byteOffset,g),h)}let w=u.stackSave(),v=u.stackAlloc(4*a.length);try{let y=v/4;a.forEach(I=>u.HEAP32[y++]=I);let _=u._OrtCreateTensor(Un(l),h,g,v,a.length,zn(p));_===0&&ke(`Can\'t create tensor for input/output. session=${o}, index=${n}.`),t.push(_)}finally{u.stackRestore(w)}},Wu=e=>{let r=new TextEncoder().encode(e),o=ze(),n=o._malloc(r.byteLength);o.HEAPU8.set(r,n);let s=o._OrtConfigure(n,r.byteLength);if(s===0)throw new Error("Can\'t get an configure key");let u=o.UTF8ToString(s);return o._OrtFree(s),u},Gu=e=>{let r=new TextEncoder().encode(e),o=ze(),n=o._malloc(r.byteLength);o.HEAPU8.set(r,n);let s=o._OrtAuth(n,r.byteLength);if(s===0)throw new Error("Can\'t get an auth result");let u=o.UTF8ToString(s);return o._OrtFree(s),u},Hu=async(e,t,r,o,n,s)=>{let u=ze(),l=Gt.get(e);if(!l)throw new Error(`cannot run inference. invalid session id: ${e}`);let a=l[0],p=l[1],h=l[2],g=l[3],w=l[4],v=l[5],y=t.length,_=o.length,I=0,x=[],A=[],O=[],C=[],M=u.stackSave(),D=u.stackAlloc(y*4),G=u.stackAlloc(y*4),E=u.stackAlloc(_*4),W=u.stackAlloc(_*4);try{[I,x]=Qo(s);for(let re=0;re<y;re++)Mu(r[re],A,C,e,t[re],w);for(let re=0;re<_;re++){let Ie=n[re],Oe=Ie?.[3]??"";Mu(Oe==="gpu-buffer"?Ie:null,O,C,e,y+o[re],w)}let te=D/4,Y=G/4,Z=E/4,ee=W/4;for(let re=0;re<y;re++)u.HEAPU32[te++]=A[re],u.HEAPU32[Y++]=p[t[re]];for(let re=0;re<_;re++)u.HEAPU32[Z++]=O[re],u.HEAPU32[ee++]=h[o[re]];if(g&&!v){let{handle:re,outputPreferredLocations:Ie,outputPreferredLocationsEncoded:Oe}=g;if(p.length!==y)throw new Error(`input count from feeds (${y}) is expected to be always equal to model\'s input count (${p.length}).`);for(let ie=0;ie<y;ie++){let Se=t[ie];await u._OrtBindInput(re,p[Se],A[ie])!==0&&ke(`Can\'t bind input[${ie}] for session=${e}.`)}for(let ie=0;ie<_;ie++){let Se=o[ie];n[ie]?.[3]?u._OrtBindOutput(re,h[Se],O[ie],0)!==0&&ke(`Can\'t bind pre-allocated output[${ie}] for session=${e}.`):u._OrtBindOutput(re,h[Se],0,Oe[Se])!==0&&ke(`Can\'t bind output[${ie}] to ${Ie[ie]} for session=${e}.`)}Gt.set(e,[a,p,h,g,w,!0])}let Te;u.jsepOnRunStart?.(a),g?Te=await u._OrtRunWithBinding(a,g.handle,_,E,I):Te=await u._OrtRun(a,G,D,y,W,_,E,I),Te!==0&&ke("failed to call OrtRun().");let De=[];for(let re=0;re<_;re++){let Ie=u.HEAPU32[E/4+re];if(Ie===O[re]){De.push(n[re]);continue}let Oe=u.stackSave(),ie=u.stackAlloc(4*4),Se=!1,Ae,Pe=0;try{u._OrtGetTensorData(Ie,ie,ie+4,ie+8,ie+12)!==0&&ke(`Can\'t access output tensor data on index ${re}.`);let H=ie/4,J=u.HEAPU32[H++];Pe=u.HEAPU32[H++];let Ce=u.HEAPU32[H++],$t=u.HEAPU32[H++],Me=[];for(let Ne=0;Ne<$t;Ne++)Me.push(u.HEAPU32[Ce/4+Ne]);u._OrtFree(Ce);let tt=Me.reduce((Ne,je)=>Ne*je,1);Ae=nt(J);let at=g?.outputPreferredLocations[o[re]];if(Ae==="string"){if(at==="gpu-buffer")throw new Error("String tensor is not supported on GPU.");let Ne=[],je=Pe/4;for(let At=0;At<tt;At++){let lt=u.HEAPU32[je++],ct=At===tt-1?void 0:u.HEAPU32[je]-lt;Ne.push(u.UTF8ToString(lt,ct))}De.push([Ae,Me,Ne,"cpu"])}else if(at==="gpu-buffer"&&tt>0){let Ne=u.jsepGetBuffer(Pe),je=Cr(J);if(je===void 0||!Xo(Ae))throw new Error(`Unsupported data type: ${Ae}`);Se=!0,De.push([Ae,Me,{gpuBuffer:Ne,download:u.jsepCreateDownloader(Ne,tt*je,Ae),dispose:()=>{u._OrtReleaseTensor(Ie)}},"gpu-buffer"])}else{let Ne=rp(n[re],Ae,tt);new Uint8Array(Ne.buffer,Ne.byteOffset,Ne.byteLength).set(u.HEAPU8.subarray(Pe,Pe+Ne.byteLength)),De.push([Ae,Me,Ne,"cpu"])}}finally{u.stackRestore(Oe),Ae==="string"&&Pe&&u._free(Pe),Se||u._OrtReleaseTensor(Ie)}}return g&&!w&&(u._OrtClearBoundOutputs(g.handle),Gt.set(e,[a,p,h,g,w,!1])),De}finally{u.stackRestore(M),A.forEach(te=>u._OrtReleaseTensor(te)),O.forEach(te=>u._OrtReleaseTensor(te)),C.forEach(te=>u._free(te)),I!==0&&u._OrtReleaseRunOptions(I),x.forEach(te=>u._free(te))}},Lu=e=>{let t=ze(),r=Gt.get(e);if(!r)throw new Error("invalid session id");let o=r[0],n=t._OrtEndProfiling(o);n===0&&ke("Can\'t get an profile file name."),t._OrtFree(n)},go=e=>{let t=[];for(let r of e){let o=r[2];!Array.isArray(o)&&"buffer"in o&&t.push(o.buffer)}return t};self.onmessage=e=>{let{type:t,in:r}=e.data;try{switch(t){case"init-wasm":Zo(r.wasm).then(()=>{Uu(r).then(()=>{postMessage({type:t})},o=>{postMessage({type:t,err:o})})},o=>{postMessage({type:t,err:o})});break;case"init-ep":{let{epName:o,env:n}=r;zu(n,o).then(()=>{postMessage({type:t})},s=>{postMessage({type:t,err:s})});break}case"copy-from":{let{buffer:o}=r,n=ho(o);postMessage({type:t,out:n});break}case"create":{let{model:o,options:n}=r;Vu(o,n).then(s=>{postMessage({type:t,out:s})},s=>{postMessage({type:t,err:s})});break}case"release":Nu(r),postMessage({type:t});break;case"run":{let{sessionId:o,inputIndices:n,inputs:s,outputIndices:u,options:l}=r,a=e.data.prealloc??[];for(;a.length<u.length;)a.push(null);Hu(o,n,s,u,a,l).then(p=>{p.some(h=>h[3]!=="cpu")?postMessage({type:t,err:"Proxy does not support non-cpu tensor location."}):postMessage({type:t,out:p,inputsBack:s},go(p).concat(go(s)))},p=>{postMessage({type:t,err:p})});break}case"configure":try{let o=Wu(e.data.in);postMessage({type:"configure",out:o})}catch(o){postMessage({type:"configure",err:o})}break;case"auth":try{let o=Gu(e.data.in);postMessage({type:"auth",out:o})}catch(o){postMessage({type:"auth",err:o})}break;case"end-profiling":Lu(r),postMessage({type:t});break;default:}}catch(o){postMessage({type:t,err:o})}};})();\n/**\n * @license\n * Copyright 2021 Google LLC. All Rights Reserved.\n * Licensed under the Apache License, Version 2.0 (the "License");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an "AS IS" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n * =============================================================================\n */\n/**\n * @license\n * Copyright 2020 Google LLC. All Rights Reserved.\n * Licensed under the Apache License, Version 2.0 (the "License");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an "AS IS" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n * =============================================================================\n */\n/**\n * @license\n * Copyright 2019 Google LLC. All Rights Reserved.\n * Licensed under the Apache License, Version 2.0 (the "License");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an "AS IS" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n * =============================================================================\n */\n'})),Uh=st((()=>{Pt(),Nh(),Gu(),ch=()=>!!Pe.wasm.proxy&&typeof document<"u",dh=!1,ph=!1,yh=!1,gh=new Map,wh=(e,t)=>{let r=gh.get(e);r?r.push(t):gh.set(e,[t])},vh=()=>{if(dh||!ph||yh||!fh)throw new Error("worker not ready")},bh=e=>{switch(e.data.type){case"init-wasm":dh=!1,e.data.err?(yh=!0,mh[1](e.data.err)):(ph=!0,mh[0]());break;case"init-ep":case"copy-from":case"create":case"configure":case"auth":case"release":case"end-profiling":{let t=gh.get(e.data.type);e.data.err?t.shift()[1](e.data.err):t.shift()[0](e.data.out);break}case"run":{let t=gh.get(e.data.type);e.data.err?t.shift()[1](e.data.err):t.shift()[0](e.data.out.concat(e.data.inputsBack));break}}},xh=typeof document<"u"?document?.currentScript?.src:void 0,_h=e=>{let t=[];for(var r=0;r<e.length;++r){let n=e[r];null!==n&&t.push(n)}return t},Sh=async()=>{if(!ph){if(dh)throw new Error("multiple calls to 'initWasm()' detected.");if(yh)throw new Error("previous call to 'initWasm()' failed.");if(dh=!0,ch())return void 0===Pe.wasm.wasmPaths&&xh&&0!==xh.indexOf("blob:")&&(Pe.wasm.wasmPaths=xh.substr(0,+xh.lastIndexOf("/")+1)),new Promise(((e,t)=>{fh?.terminate();let r=URL.createObjectURL(new Blob([Fh()],{type:"text/javascript"}));(fh=new Worker(r,{name:"ort-wasm-proxy-worker"})).onerror=e=>t(e),fh.onmessage=bh,URL.revokeObjectURL(r),mh=[e,t];let n={type:"init-wasm",in:Pe};fh.postMessage(n)}));try{await tr(Pe.wasm),await Zl(Pe),ph=!0}catch(e){throw yh=!0,e}finally{dh=!1}}},Th=async e=>{if(ch())return vh(),new Promise(((t,r)=>{wh("init-ep",[t,r]);let n={type:"init-ep",in:{epName:e,env:Pe}};fh.postMessage(n)}));await Jl(Pe,e)},Eh=async e=>ch()?(vh(),new Promise(((t,r)=>{wh("copy-from",[t,r]);let n={type:"copy-from",in:{buffer:e}};fh.postMessage(n,[e.buffer])}))):th(e),Oh=async(e,t)=>{if(ch()){if(t?.preferredOutputLocation)throw new Error('session option "preferredOutputLocation" is not supported for proxy.');return vh(),new Promise(((r,n)=>{wh("create",[r,n]);let i={type:"create",in:{model:e,options:t}},o=[];e instanceof Uint8Array&&o.push(e.buffer),fh.postMessage(i,o)}))}return rh(e,t)},Ah=async e=>{if(ch())return vh(),new Promise(((t,r)=>{wh("release",[t,r]);let n={type:"release",in:e};fh.postMessage(n)}));nh(e)},Ih=async e=>ch()?(vh(),new Promise(((t,r)=>{wh("configure",[t,r]);let n={type:"configure",in:e};fh.postMessage(n)}))):ah(e),Ph=async e=>ch()?(vh(),new Promise(((t,r)=>{wh("auth",[t,r]);let n={type:"auth",in:e};fh.postMessage(n)}))):sh(e),kh=async(e,t,r,n,i,o)=>{if(ch()){if(r.some((e=>"cpu"!==e[3])))throw new Error("input tensor on GPU is not supported for proxy.");return vh(),new Promise(((a,s)=>{wh("run",[a,s]);let u=r,l={type:"run",in:{sessionId:e,inputIndices:t,inputs:u,outputIndices:n,options:o},prealloc:i};fh.postMessage(l,hh(u).concat(hh(_h(i))))}))}return uh(e,t,r,n,i,o).then((e=>e.concat(r)))},Ch=async e=>{if(ch())return vh(),new Promise(((t,r)=>{wh("end-profiling",[t,r]);let n={type:"end-profiling",in:e};fh.postMessage(n)}));lh(e)}})),jh=st((()=>{Pt(),Uh(),qu(),Yu(),$h=(e,t)=>{switch(e.location){case"cpu":return[e.type,e.dims,e.data,"cpu"];case"gpu-buffer":return[e.type,e.dims,{gpuBuffer:e.gpuBuffer},"gpu-buffer"];default:throw new Error(`invalid data location: ${e.location} for ${t()}`)}},Rh=e=>{switch(e[3]){case"cpu":return new Ve(e[0],e[2],e[1]);case"gpu-buffer":{let t=e[0];if(!gr(t))throw new Error(`not supported data type: ${t} for deserializing GPU tensor`);let{gpuBuffer:r,download:n,dispose:i}=e[2];return Ve.fromGpuBuffer(r,{dataType:t,dims:e[1],download:n,dispose:i})}default:throw new Error(`invalid data location: ${e[3]}`)}},Dh=class{async fetchModelAndCopyToWasmMemory(e){return Eh(await vr(e))}async loadModel(e,t){let r;qe(),r="string"==typeof e?typeof tt<"u"&&tt.versions&&tt.versions.node?await vr(e):await this.fetchModelAndCopyToWasmMemory(e):e,[this.sessionId,this.inputNames,this.outputNames]=await Oh(r,t),Ye()}async dispose(){return Ah(this.sessionId)}async configure(e){return Ih(e)}async auth(e){return Ph(e)}async run(e,t,r){qe();let n=[],i=[];Object.entries(e).forEach((e=>{let t=e[0],r=e[1],o=this.inputNames.indexOf(t);if(-1===o)throw new Error(`invalid input '${t}'`);n.push(r),i.push(o)}));let o=[],a=[],s=e=>null!==e&&"gpu-buffer"===e.location?e:null;Object.entries(t).forEach((e=>{let t=e[0],r=e[1],n=this.outputNames.indexOf(t);if(-1===n)throw new Error(`invalid output '${t}'`);o.push(r),a.push(n)}));let u=n.map(((e,t)=>$h(e,(()=>`input "${this.inputNames[i[t]]}"`)))),l=o.map(((e,t)=>e?$h(e,(()=>`output "${this.outputNames[a[t]]}"`)):null)),h=await kh(this.sessionId,i,u,a,l,r),c={},f=[];for(let e=0;e<h.length;e++)e>=a.length?f.push(Rh(h[e])):c[this.outputNames[a[e]]]=s(o[e])??Rh(h[e]);return f.length>0&&(c.inputBack=f[0]),Ye(),c}startProfiling(){}endProfiling(){Ch(this.sessionId)}}})),zh=st((()=>{Pt(),Uh(),jh(),Mh=()=>{if(("number"!=typeof Pe.wasm.initTimeout||Pe.wasm.initTimeout<0)&&(Pe.wasm.initTimeout=0),"boolean"!=typeof Pe.wasm.simd&&(Pe.wasm.simd=!0),"boolean"!=typeof Pe.wasm.proxy&&(Pe.wasm.proxy=!1),"boolean"!=typeof Pe.wasm.trace&&(Pe.wasm.trace=!1),"number"!=typeof Pe.wasm.numThreads||!Number.isInteger(Pe.wasm.numThreads)||Pe.wasm.numThreads<=0){(typeof self<"u"&&!self.crossOriginIsolated||typeof tt<"u"&&tt.versions&&tt.versions.node)&&(Pe.wasm.numThreads=1);let e=typeof navigator>"u"?(void 0)().length:navigator.hardwareConcurrency;Pe.wasm.numThreads=Math.min(4,Math.ceil((e||1)/2))}},Lh=class{async init(e){Mh(),await Sh(),await Th(e)}async createInferenceSessionHandler(e,t){let r=new Dh;return await r.loadModel(e,t),Promise.resolve(r)}}})),Gh={};lt(Gh,{wasmBackend:()=>Vh});var Vh,Wh=st((()=>{zh(),Vh=new Lh}));Pt(),Pt(),Pt();var Hh;{let e=(Wh(),ht(Gh)).wasmBackend;Te("webgpu",e,5),Te("cpu",e,10),Te("wasm",e,10)}function qh(e){return qh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},qh(e)}function Yh(){Yh=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,i=Object.defineProperty||function(e,t,r){e[t]=r.value},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function l(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,r){return e[t]=r}}function h(e,t,r,n){var o=t&&t.prototype instanceof g?t:g,a=Object.create(o.prototype),s=new k(n||[]);return i(a,"_invoke",{value:O(e,r,s)}),a}function c(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=h;var f="suspendedStart",d="suspendedYield",p="executing",y="completed",m={};function g(){}function w(){}function v(){}var b={};l(b,a,(function(){return this}));var x=Object.getPrototypeOf,_=x&&x(x(C([])));_&&_!==r&&n.call(_,a)&&(b=_);var S=v.prototype=g.prototype=Object.create(b);function T(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function E(e,t){function r(i,o,a,s){var u=c(e[i],e,o);if("throw"!==u.type){var l=u.arg,h=l.value;return h&&"object"==qh(h)&&n.call(h,"__await")?t.resolve(h.__await).then((function(e){r("next",e,a,s)}),(function(e){r("throw",e,a,s)})):t.resolve(h).then((function(e){l.value=e,a(l)}),(function(e){return r("throw",e,a,s)}))}s(u.arg)}var o;i(this,"_invoke",{value:function(e,n){function i(){return new t((function(t,i){r(e,n,t,i)}))}return o=o?o.then(i,i):i()}})}function O(t,r,n){var i=f;return function(o,a){if(i===p)throw Error("Generator is already running");if(i===y){if("throw"===o)throw a;return{value:e,done:!0}}for(n.method=o,n.arg=a;;){var s=n.delegate;if(s){var u=A(s,n);if(u){if(u===m)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===f)throw i=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i=p;var l=c(t,r,n);if("normal"===l.type){if(i=n.done?y:d,l.arg===m)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(i=y,n.method="throw",n.arg=l.arg)}}}function A(t,r){var n=r.method,i=t.iterator[n];if(i===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,A(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),m;var o=c(i,t.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,m;var a=o.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,m):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,m)}function I(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function P(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function k(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(I,this),this.reset(!0)}function C(t){if(t||""===t){var r=t[a];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,o=function r(){for(;++i<t.length;)if(n.call(t,i))return r.value=t[i],r.done=!1,r;return r.value=e,r.done=!0,r};return o.next=o}}throw new TypeError(qh(t)+" is not iterable")}return w.prototype=v,i(S,"constructor",{value:v,configurable:!0}),i(v,"constructor",{value:w,configurable:!0}),w.displayName=l(v,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===w||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,v):(e.__proto__=v,l(e,u,"GeneratorFunction")),e.prototype=Object.create(S),e},t.awrap=function(e){return{__await:e}},T(E.prototype),l(E.prototype,s,(function(){return this})),t.AsyncIterator=E,t.async=function(e,r,n,i,o){void 0===o&&(o=Promise);var a=new E(h(e,r,n,i),o);return t.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},T(S),l(S,u,"Generator"),l(S,a,(function(){return this})),l(S,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=C,k.prototype={constructor:k,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(P),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function i(n,i){return s.type="throw",s.arg=t,r.next=n,i&&(r.method="next",r.arg=e),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),l=n.call(a,"finallyLoc");if(u&&l){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return i(a.catchLoc,!0)}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,m):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),P(r),m}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;P(r)}return i}}throw Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:C(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),m}},t}function Xh(e,t,r,n,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void r(e)}s.done?t(u):Promise.resolve(u).then(n,i)}function Kh(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var o=e.apply(t,r);function a(e){Xh(o,n,i,a,s,"next",e)}function s(e){Xh(o,n,i,a,s,"throw",e)}a(void 0)}))}}function Zh(){return Jh.apply(this,arguments)}function Jh(){return Jh=Kh(Yh().mark((function e(){var t,r=arguments;return Yh().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=r.length>0&&void 0!==r[0]?r[0]:{},void 0===Hh){e.next=3;break}return e.abrupt("return",Hh);case 3:return e.next=5,Kh(Yh().mark((function e(){var r;return Yh().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(navigator.gpu){e.next=3;break}return e.abrupt("return",!1);case 3:return e.prev=3,e.next=6,navigator.gpu.requestAdapter(t);case 6:return r=e.sent,e.next=9,r.requestDevice();case 9:return e.sent.destroy(),e.abrupt("return",!0);case 14:return e.prev=14,e.t0=e.catch(3),e.abrupt("return",!1);case 17:case"end":return e.stop()}}),e,null,[[3,14]])})))();case 5:return Hh=e.sent,e.abrupt("return",Hh);case 7:case"end":return e.stop()}}),e)}))),Jh.apply(this,arguments)}Object.defineProperty(Pe.versions,"web",{value:"1.17.0",enumerable:!0});var Qh=r(8380);function ec(e){return ec="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ec(e)}function tc(){tc=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,i=Object.defineProperty||function(e,t,r){e[t]=r.value},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function l(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,r){return e[t]=r}}function h(e,t,r,n){var o=t&&t.prototype instanceof g?t:g,a=Object.create(o.prototype),s=new k(n||[]);return i(a,"_invoke",{value:O(e,r,s)}),a}function c(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=h;var f="suspendedStart",d="suspendedYield",p="executing",y="completed",m={};function g(){}function w(){}function v(){}var b={};l(b,a,(function(){return this}));var x=Object.getPrototypeOf,_=x&&x(x(C([])));_&&_!==r&&n.call(_,a)&&(b=_);var S=v.prototype=g.prototype=Object.create(b);function T(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function E(e,t){function r(i,o,a,s){var u=c(e[i],e,o);if("throw"!==u.type){var l=u.arg,h=l.value;return h&&"object"==ec(h)&&n.call(h,"__await")?t.resolve(h.__await).then((function(e){r("next",e,a,s)}),(function(e){r("throw",e,a,s)})):t.resolve(h).then((function(e){l.value=e,a(l)}),(function(e){return r("throw",e,a,s)}))}s(u.arg)}var o;i(this,"_invoke",{value:function(e,n){function i(){return new t((function(t,i){r(e,n,t,i)}))}return o=o?o.then(i,i):i()}})}function O(t,r,n){var i=f;return function(o,a){if(i===p)throw Error("Generator is already running");if(i===y){if("throw"===o)throw a;return{value:e,done:!0}}for(n.method=o,n.arg=a;;){var s=n.delegate;if(s){var u=A(s,n);if(u){if(u===m)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===f)throw i=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i=p;var l=c(t,r,n);if("normal"===l.type){if(i=n.done?y:d,l.arg===m)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(i=y,n.method="throw",n.arg=l.arg)}}}function A(t,r){var n=r.method,i=t.iterator[n];if(i===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,A(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),m;var o=c(i,t.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,m;var a=o.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,m):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,m)}function I(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function P(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function k(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(I,this),this.reset(!0)}function C(t){if(t||""===t){var r=t[a];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,o=function r(){for(;++i<t.length;)if(n.call(t,i))return r.value=t[i],r.done=!1,r;return r.value=e,r.done=!0,r};return o.next=o}}throw new TypeError(ec(t)+" is not iterable")}return w.prototype=v,i(S,"constructor",{value:v,configurable:!0}),i(v,"constructor",{value:w,configurable:!0}),w.displayName=l(v,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===w||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,v):(e.__proto__=v,l(e,u,"GeneratorFunction")),e.prototype=Object.create(S),e},t.awrap=function(e){return{__await:e}},T(E.prototype),l(E.prototype,s,(function(){return this})),t.AsyncIterator=E,t.async=function(e,r,n,i,o){void 0===o&&(o=Promise);var a=new E(h(e,r,n,i),o);return t.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},T(S),l(S,u,"Generator"),l(S,a,(function(){return this})),l(S,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=C,k.prototype={constructor:k,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(P),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function i(n,i){return s.type="throw",s.arg=t,r.next=n,i&&(r.method="next",r.arg=e),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),l=n.call(a,"finallyLoc");if(u&&l){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return i(a.catchLoc,!0)}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,m):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),P(r),m}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;P(r)}return i}}throw Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:C(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),m}},t}function rc(e,t,r,n,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void r(e)}s.done?t(u):Promise.resolve(u).then(n,i)}function nc(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var o=e.apply(t,r);function a(e){rc(o,n,i,a,s,"next",e)}function s(e){rc(o,n,i,a,s,"throw",e)}a(void 0)}))}}function ic(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,oc(n.key),n)}}function oc(e){var t=function(e,t){if("object"!=ec(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=ec(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==ec(t)?t:t+""}var ac=function(){return e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._name="tsvb"},t=[{key:"get",value:function(){var e=nc(tc().mark((function e(t){var r,i,o;return tc().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._cache){e.next=4;break}return e.next=3,caches.open(this._name);case 3:this._cache=e.sent;case 4:return e.next=6,this._cache.match(t);case 6:if(void 0===(i=e.sent)){e.next=9;break}return e.abrupt("return",i);case 9:return e.next=11,fetch(t);case 11:if((i=e.sent).ok){e.next=15;break}return n.bv.notify({message:"".concat(t," don't found"),type:n.By.ERROR,code:n.O4.LOADER_ISSUE,emitter:n.JK.ML_INFERENCE}),e.abrupt("return",i);case 15:if(!Qh.y.CACHE_MODELS){e.next=26;break}return o=i.clone(),e.prev=17,e.next=20,this._cache.put(t,i);case 20:e.next=25;break;case 22:e.prev=22,e.t0=e.catch(17),n.bv.notify({message:null!==(r=e.t0.message)&&void 0!==r?r:"Wasn't able to cache model to local storage",type:n.By.INFO,emitter:n.JK.SESSION_MANAGER});case 25:return e.abrupt("return",o);case 26:return e.abrupt("return",i);case 27:case"end":return e.stop()}}),e,this,[[17,22]])})));return function(t){return e.apply(this,arguments)}}()},{key:"delete",value:(i=nc(tc().mark((function e(){return tc().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,caches.delete(this._name);case 2:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})}],t&&ic(e.prototype,t),r&&ic(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,r,i}(),sc=r(2004),uc=r(2505),lc=r.n(uc);function hc(e){return hc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},hc(e)}function cc(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,i,o,a,s=[],u=!0,l=!1;try{if(o=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=o.call(r)).done)&&(s.push(n.value),s.length!==t);u=!0);}catch(e){l=!0,i=e}finally{try{if(!u&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(l)throw i}}return s}}(e,t)||function(e,t){if(e){if("string"==typeof e)return fc(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?fc(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function fc(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function dc(){dc=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,i=Object.defineProperty||function(e,t,r){e[t]=r.value},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function l(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,r){return e[t]=r}}function h(e,t,r,n){var o=t&&t.prototype instanceof g?t:g,a=Object.create(o.prototype),s=new k(n||[]);return i(a,"_invoke",{value:O(e,r,s)}),a}function c(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=h;var f="suspendedStart",d="suspendedYield",p="executing",y="completed",m={};function g(){}function w(){}function v(){}var b={};l(b,a,(function(){return this}));var x=Object.getPrototypeOf,_=x&&x(x(C([])));_&&_!==r&&n.call(_,a)&&(b=_);var S=v.prototype=g.prototype=Object.create(b);function T(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function E(e,t){function r(i,o,a,s){var u=c(e[i],e,o);if("throw"!==u.type){var l=u.arg,h=l.value;return h&&"object"==hc(h)&&n.call(h,"__await")?t.resolve(h.__await).then((function(e){r("next",e,a,s)}),(function(e){r("throw",e,a,s)})):t.resolve(h).then((function(e){l.value=e,a(l)}),(function(e){return r("throw",e,a,s)}))}s(u.arg)}var o;i(this,"_invoke",{value:function(e,n){function i(){return new t((function(t,i){r(e,n,t,i)}))}return o=o?o.then(i,i):i()}})}function O(t,r,n){var i=f;return function(o,a){if(i===p)throw Error("Generator is already running");if(i===y){if("throw"===o)throw a;return{value:e,done:!0}}for(n.method=o,n.arg=a;;){var s=n.delegate;if(s){var u=A(s,n);if(u){if(u===m)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===f)throw i=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i=p;var l=c(t,r,n);if("normal"===l.type){if(i=n.done?y:d,l.arg===m)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(i=y,n.method="throw",n.arg=l.arg)}}}function A(t,r){var n=r.method,i=t.iterator[n];if(i===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,A(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),m;var o=c(i,t.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,m;var a=o.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,m):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,m)}function I(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function P(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function k(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(I,this),this.reset(!0)}function C(t){if(t||""===t){var r=t[a];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,o=function r(){for(;++i<t.length;)if(n.call(t,i))return r.value=t[i],r.done=!1,r;return r.value=e,r.done=!0,r};return o.next=o}}throw new TypeError(hc(t)+" is not iterable")}return w.prototype=v,i(S,"constructor",{value:v,configurable:!0}),i(v,"constructor",{value:w,configurable:!0}),w.displayName=l(v,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===w||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,v):(e.__proto__=v,l(e,u,"GeneratorFunction")),e.prototype=Object.create(S),e},t.awrap=function(e){return{__await:e}},T(E.prototype),l(E.prototype,s,(function(){return this})),t.AsyncIterator=E,t.async=function(e,r,n,i,o){void 0===o&&(o=Promise);var a=new E(h(e,r,n,i),o);return t.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},T(S),l(S,u,"Generator"),l(S,a,(function(){return this})),l(S,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=C,k.prototype={constructor:k,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(P),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function i(n,i){return s.type="throw",s.arg=t,r.next=n,i&&(r.method="next",r.arg=e),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),l=n.call(a,"finallyLoc");if(u&&l){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return i(a.catchLoc,!0)}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,m):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),P(r),m}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;P(r)}return i}}throw Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:C(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),m}},t}function pc(e,t,r,n,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void r(e)}s.done?t(u):Promise.resolve(u).then(n,i)}function yc(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var o=e.apply(t,r);function a(e){pc(o,n,i,a,s,"next",e)}function s(e){pc(o,n,i,a,s,"throw",e)}a(void 0)}))}}function mc(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function gc(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,vc(n.key),n)}}function wc(e,t,r){return t&&gc(e.prototype,t),r&&gc(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function vc(e){var t=function(e,t){if("object"!=hc(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=hc(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==hc(t)?t:t+""}var bc=function(){return wc((function e(){mc(this,e),this.inference=null,this.ready=!1,this.isGPU=!1}),[{key:"clearCache",value:(i=yc(dc().mark((function e(){return dc().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),function(){return i.apply(this,arguments)})},{key:"getSession",value:function(e){return this.inference}},{key:"onAuth",value:function(){}},{key:"preload",value:(r=yc(dc().mark((function e(t){return dc().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),function(e){return r.apply(this,arguments)})},{key:"cache",value:(t=yc(dc().mark((function e(t,r){return dc().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),function(e,r){return t.apply(this,arguments)})},{key:"getType",value:function(){return"custom"}},{key:"setBackend",value:function(e){this.inference=e}},{key:"setPreset",value:function(e){this.inference.setPreset(e)}},{key:"releaseSession",value:function(e){return!0}},{key:"init",value:(e=yc(dc().mark((function e(t){var r,i,o,a;return dc().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.ready){e.next=2;break}return e.abrupt("return");case 2:return t.data.preset||n.bv.notify({message:"No preset provided for Custom Inference Module",emitter:n.JK.ML_INFERENCE}),e.prev=3,e.next=6,this.inference.setPreset(t.data.preset);case 6:return e.next=8,this.inference.configure(Qh.y.CUSTOMER_ID);case 8:return i=e.sent,e.next=11,_c(i,Qh.y.CUSTOMER_ID);case 11:return o=e.sent,e.next=14,this.inference.auth(o.data.key);case 14:if(a=e.sent,"active"==JSON.parse(a).status){e.next=19;break}throw n.bv.notify({message:"Session initialisation failed",type:n.By.ERROR,code:n.O4.SESSION_INITIALIZATION_FAILED,emitter:n.JK.ML_INFERENCE}),new Error("Session initialisation failed");case 19:this.ready=!0,n.bv.notify({message:"Session initialized successfully",type:n.By.INFO,code:n.O4.SESSION_INITIALIZATION_SUCCESS,emitter:n.JK.ML_INFERENCE}),e.next=27;break;case 23:throw e.prev=23,e.t0=e.catch(3),n.bv.notify({message:null!==(r=e.t0.message)&&void 0!==r?r:e.t0,type:n.By.ERROR,code:n.O4.SESSION_INITIALIZATION_ISSUE,emitter:n.JK.ML_INFERENCE,cause:e.t0}),e.t0;case 27:case"end":return e.stop()}}),e,this,[[3,23]])}))),function(t){return e.apply(this,arguments)})},{key:"isReady",value:function(e){return this.ready}}]);var e,t,r,i}(),xc=function(){return wc((function e(){mc(this,e),this.sessions=new Map,this.sessionPromises=new Map,this._loader=new ac,this._sequentialExecutor=new Qe,this.sessionIdIncrement=0,this.CPUauthenticated=!1,this.GPUauthenticated=!1}),[{key:"clearCache",value:(i=yc(dc().mark((function e(){return dc().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._loader.delete();case 2:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})},{key:"isReady",value:function(e){return this.sessions.has(e)}},{key:"setBackend",value:function(e){}},{key:"getSession",value:function(e){if(this.sessions.has(e))return this.sessions.get(e);n.bv.notify({message:"ML inference for ".concat(e," model is not initialized"),type:n.By.ERROR,emitter:n.JK.ML_INFERENCE})}},{key:"releaseSession",value:function(e){var t=this.sessions.get(e);if(!t)return!0;this.sessions.delete(e),this.sessionPromises.delete(e);try{t.session.release()}catch(e){}return!0}},{key:"onAuth",value:function(e){var t="function"==typeof e;this.authFunction=t?e:void 0}},{key:"isAuthenticated",value:function(e){return"webgpu"==e?!(!this.GPUauthenticated&&!this.CPUauthenticated):!!this.CPUauthenticated}},{key:"init",value:(r=yc(dc().mark((function e(t,r){var i,o,s,u,l,h,c,f,d,p,y,m,g,w,v,b,x;return dc().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(u=[],this.sessionPromises.forEach((function(e,t,r){"pending"==e.state&&u.push(e.promise)})),l=t.modelPath,!this.sessionPromises.has(l)){e.next=5;break}return e.abrupt("return",null===(i=this.sessionPromises.get(l))||void 0===i?void 0:i.promise);case 5:return h=new a.c,this.sessionPromises.set(l,h),e.next=9,this._loader.get(l);case 9:return c=e.sent,e.next=12,c.arrayBuffer();case 12:return f=e.sent,e.next=15,Promise.all(u);case 15:if(et.wV,d="wasm","webgpu"!=t.backend){e.next=23;break}if("webgpu"!=Qh.y.PROVIDER&&"auto"!=Qh.y.PROVIDER){e.next=23;break}return e.next=21,Zh();case 21:e.sent?d="webgpu":n.bv.notify({message:"WebGPU is not supported, falling back to CPU WASM",type:n.By.INFO,code:n.O4.CPU_FALLBACK,emitter:n.JK.ML_INFERENCE});case 23:return p="webgpu"==d?this.createGPUSession(f):this.createCPUSession(f),e.prev=24,e.next=27,p;case 27:y=e.sent,e.next=34;break;case 30:return e.prev=30,e.t0=e.catch(24),n.bv.notify({message:"Model initialization error: ".concat(t.modelPath),type:n.By.ERROR,code:n.O4.MODEL_INITIALIZATION_ISSUE,emitter:n.JK.ML_INFERENCE,cause:e.t0}),e.abrupt("return");case 34:if(this.isAuthenticated(d)){e.next=67;break}return e.prev=35,e.next=38,y.configure(Qh.y.CUSTOMER_ID);case 38:if(m=e.sent,"extension"===Qh.y.APP_ENV){e.next=45;break}return e.next=42,_c(m,Qh.y.CUSTOMER_ID);case 42:g=e.sent,e.next=52;break;case 45:if("function"==typeof this.authFunction){e.next=47;break}throw"Can't find auth function";case 47:return w=Qh.y.API_URL+Qh.y.CUSTOMER_ID,v=sc.W.getInstance().getUID(Qh.y.CUSTOMER_ID),e.next=51,this.authFunction(w,{user_id:v,payload:m});case 51:g=e.sent;case 52:return e.next=54,y.auth(null!==(o=g.key)&&void 0!==o?o:g.data.key);case 54:if(b=e.sent,"active"===JSON.parse(b).status){e.next=59;break}throw n.bv.notify({message:"Session initialisation failed",type:n.By.ERROR,emitter:n.JK.ML_INFERENCE,code:n.O4.SESSION_INITIALIZATION_FAILED}),new Error("Session initialisation failed");case 59:"webgpu"==d?this.GPUauthenticated=!0:this.CPUauthenticated=!0,n.bv.notify({message:"Session initialized successfully",type:n.By.INFO,emitter:n.JK.ML_INFERENCE,code:n.O4.SESSION_INITIALIZATION_SUCCESS}),e.next=67;break;case 63:throw e.prev=63,e.t1=e.catch(35),n.bv.notify({message:null!==(s=e.t1.message)&&void 0!==s?s:e.t1,type:n.By.ERROR,emitter:n.JK.ML_INFERENCE,code:n.O4.SESSION_INITIALIZATION_ISSUE,cause:e.t1}),e.t1;case 67:x="webgpu"==d,this.sessions.set(l,{session:y,isGPU:x,id:++this.sessionIdIncrement,modelPath:l,gpuDevice:x?this.gpuDevice:void 0,inputName:null!=r?r:"input"}),h.resolve(),n.bv.notify({type:n.By.INFO,message:"Inited ".concat(l),emitter:n.JK.ML_INFERENCE});case 71:case"end":return e.stop()}}),e,this,[[24,30],[35,63]])}))),function(e,t){return r.apply(this,arguments)})},{key:"createCPUSession",value:(t=yc(dc().mark((function e(t){var r;return dc().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={executionProviders:["wasm"],enableCpuMemArena:!0,enableMemPattern:!0,executionMode:"parallel",graphOptimizationLevel:"all",extra:{session:{set_denormal_as_zero:"1",disable_prepacking:"1",dynamic_block_base:"4"},optimization:{enable_gelu_approximation:"1"}}},et._K.wasm.numThreads=1,Qh.y.PROXY&&(et._K.wasm.proxy=!0),Object.keys(Qh.y.WASM_PATHS).length&&(et._K.wasm.wasmPaths=Qh.y.WASM_PATHS),e.abrupt("return",et.wV.create(t,r));case 5:case"end":return e.stop()}}),e)}))),function(e){return t.apply(this,arguments)})},{key:"createGPUSession",value:(e=yc(dc().mark((function e(t){var r,i,o,a,s,u,l,h,c=this;return dc().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r={executionProviders:["webgpu"],enableGraphCapture:!0},Pe.wasm.numThreads=1,Qh.y.PROXY&&(Pe.wasm.proxy=!1),Object.keys(Qh.y.WASM_PATHS).length){for(i=[],o=0,a=Object.entries(Qh.y.WASM_PATHS);o<a.length;o++)s=cc(a[o],2),u=s[0],l=s[1],i[u]=l.replace(".wasm",".jsep.wasm");h=Object.assign({},i),Pe.wasm.wasmPaths=h}return e.abrupt("return",Ke.create(t,r).then((function(e){return c.gpuDevice||(c.gpuDevice=Pe.webgpu.device,c.gpuDevice.lost.then((function(e){n.bv.notify({message:"GPU adapter was lost: ".concat(e.message,", reason: ").concat(e.reason),code:n.O4.GPU_DEVICE_LOST,type:n.By.ERROR,emitter:n.JK.SESSION_MANAGER})})),c.gpuDevice.addEventListener("uncapturederror",(function(e){n.bv.notify({message:"GPU error: ".concat(e.error.constructor.name,", message: ").concat(e.error.message),code:n.O4.GPU_UNCAPTUREDERROR,type:n.By.ERROR,emitter:n.JK.SESSION_MANAGER})}))),Pe.webgpu.device.adapterInfo&&n.bv.notify({message:"GPU adapter info: ".concat(Pe.webgpu.device.adapterInfo.vendor," - ").concat(Pe.webgpu.device.adapterInfo.architecture),type:n.By.INFO,emitter:n.JK.SESSION_MANAGER}),e})));case 5:case"end":return e.stop()}}),e)}))),function(t){return e.apply(this,arguments)})}]);var e,t,r,i}();function _c(e,t){return Sc.apply(this,arguments)}function Sc(){return(Sc=yc(dc().mark((function e(t,r){return dc().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",lc().post(Qh.y.API_URL+r,{user_id:sc.W.getInstance().getUID(r),payload:t},{headers:{"Tsvb-Version":Qh.y.VERSION}}).catch((function(e){throw new Error(e.response.data.message)})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Tc(e){return Tc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Tc(e)}function Ec(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,i,o,a,s=[],u=!0,l=!1;try{if(o=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=o.call(r)).done)&&(s.push(n.value),s.length!==t);u=!0);}catch(e){l=!0,i=e}finally{try{if(!u&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(l)throw i}}return s}}(e,t)||Ic(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Oc(){Oc=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,i=Object.defineProperty||function(e,t,r){e[t]=r.value},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function l(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,r){return e[t]=r}}function h(e,t,r,n){var o=t&&t.prototype instanceof g?t:g,a=Object.create(o.prototype),s=new k(n||[]);return i(a,"_invoke",{value:O(e,r,s)}),a}function c(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=h;var f="suspendedStart",d="suspendedYield",p="executing",y="completed",m={};function g(){}function w(){}function v(){}var b={};l(b,a,(function(){return this}));var x=Object.getPrototypeOf,_=x&&x(x(C([])));_&&_!==r&&n.call(_,a)&&(b=_);var S=v.prototype=g.prototype=Object.create(b);function T(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function E(e,t){function r(i,o,a,s){var u=c(e[i],e,o);if("throw"!==u.type){var l=u.arg,h=l.value;return h&&"object"==Tc(h)&&n.call(h,"__await")?t.resolve(h.__await).then((function(e){r("next",e,a,s)}),(function(e){r("throw",e,a,s)})):t.resolve(h).then((function(e){l.value=e,a(l)}),(function(e){return r("throw",e,a,s)}))}s(u.arg)}var o;i(this,"_invoke",{value:function(e,n){function i(){return new t((function(t,i){r(e,n,t,i)}))}return o=o?o.then(i,i):i()}})}function O(t,r,n){var i=f;return function(o,a){if(i===p)throw Error("Generator is already running");if(i===y){if("throw"===o)throw a;return{value:e,done:!0}}for(n.method=o,n.arg=a;;){var s=n.delegate;if(s){var u=A(s,n);if(u){if(u===m)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===f)throw i=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i=p;var l=c(t,r,n);if("normal"===l.type){if(i=n.done?y:d,l.arg===m)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(i=y,n.method="throw",n.arg=l.arg)}}}function A(t,r){var n=r.method,i=t.iterator[n];if(i===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,A(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),m;var o=c(i,t.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,m;var a=o.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,m):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,m)}function I(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function P(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function k(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(I,this),this.reset(!0)}function C(t){if(t||""===t){var r=t[a];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,o=function r(){for(;++i<t.length;)if(n.call(t,i))return r.value=t[i],r.done=!1,r;return r.value=e,r.done=!0,r};return o.next=o}}throw new TypeError(Tc(t)+" is not iterable")}return w.prototype=v,i(S,"constructor",{value:v,configurable:!0}),i(v,"constructor",{value:w,configurable:!0}),w.displayName=l(v,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===w||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,v):(e.__proto__=v,l(e,u,"GeneratorFunction")),e.prototype=Object.create(S),e},t.awrap=function(e){return{__await:e}},T(E.prototype),l(E.prototype,s,(function(){return this})),t.AsyncIterator=E,t.async=function(e,r,n,i,o){void 0===o&&(o=Promise);var a=new E(h(e,r,n,i),o);return t.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},T(S),l(S,u,"Generator"),l(S,a,(function(){return this})),l(S,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=C,k.prototype={constructor:k,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(P),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function i(n,i){return s.type="throw",s.arg=t,r.next=n,i&&(r.method="next",r.arg=e),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),l=n.call(a,"finallyLoc");if(u&&l){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return i(a.catchLoc,!0)}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,m):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),P(r),m}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;P(r)}return i}}throw Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:C(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),m}},t}function Ac(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=Ic(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw o}}}}function Ic(e,t){if(e){if("string"==typeof e)return Pc(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Pc(e,t):void 0}}function Pc(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function kc(e,t,r,n,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void r(e)}s.done?t(u):Promise.resolve(u).then(n,i)}function Cc(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var o=e.apply(t,r);function a(e){kc(o,n,i,a,s,"next",e)}function s(e){kc(o,n,i,a,s,"throw",e)}a(void 0)}))}}function $c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Rc(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Mc(n.key),n)}}function Dc(e,t,r){return t&&Rc(e.prototype,t),r&&Rc(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Mc(e){var t=function(e,t){if("object"!=Tc(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=Tc(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Tc(t)?t:t+""}function Lc(e){return 4*e.reduce((function(e,t){return e*t}),1)}function Bc(e,t,r){return r?function(e,t){if(e instanceof GPUBuffer)return Ve.fromGpuBuffer(e,{dataType:"float32",dims:t});if(e instanceof Float32Array)return new Ve("float32",e,t);throw TypeError("Unsupported tensor data type, currently WebGPU session only supports Float32Array or GPUBuffer")}(e,t):function(e,t){if(e instanceof Float32Array)return new et.qY("float32",e,t);throw TypeError("Unsupported tensor data type, currently CPU session only supports Float32Array")}(e,t)}var Nc=function(){return Dc((function e(){$c(this,e),this._executor=new Qe}),[{key:"run",value:(e=Cc(Oc().mark((function e(t,r,i,o,a,s){var u,l,h,c,f,d,p,y;return Oc().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(l=Bc(r,[1,a,o,i],!1),(h={})[t.inputName]=l,!s){e.next=17;break}c={},f=Ac(t.session.outputNames);try{for(f.s();!(d=f.n()).done;)p=d.value,y=s[p],c[p]=Bc(y.data,y.dims,!1)}catch(e){f.e(e)}finally{f.f()}return e.prev=7,e.next=10,t.session.run(h,c);case 10:u=e.sent,e.next=16;break;case 13:e.prev=13,e.t0=e.catch(7),n.bv.notify({message:"Session run error: ".concat(e.t0,", session: ").concat(t," with prealloc ").concat(c),cause:e.t0,emitter:n.JK.SESSION_RUNNER});case 16:return e.abrupt("return",u);case 17:return e.prev=17,e.next=20,t.session.run(h);case 20:u=e.sent,e.next=26;break;case 23:e.prev=23,e.t1=e.catch(17),n.bv.notify({message:"Session run error: ".concat(e.t1,", session: ").concat(t),cause:e.t1,emitter:n.JK.SESSION_RUNNER});case 26:return e.abrupt("return",u);case 27:case"end":return e.stop()}}),e,null,[[7,13],[17,23]])}))),function(t,r,n,i,o,a){return e.apply(this,arguments)})}]);var e}(),Fc=function(){return Dc((function e(){$c(this,e),this._executor=new Qe,this.bindings=new Map}),[{key:"run",value:(e=Cc(Oc().mark((function e(t,r,i,o,a,s){var u,l,h,c,f,d,p,y,m,g,w,v,b,x,_,S,T,E,O;return Oc().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s){e.next=2;break}throw Error("Graph replay inference can not work without preallocs");case 2:l=[1,a,o,i],h=this.obtainedPreallocOutput(t.session,s),c=Ec(h,2),f=c[0],d=c[1],p=this.provideGPUBindings(t.gpuDevice,t.id,Lc(l),Lc(d.dims)),this.toInputBuffer(t.gpuDevice,r,p.inputGPUBuffer),(y={})[f]={data:p.outputGPUBuffer,dims:d.dims},m=Bc(p.inputGPUBuffer,[1,a,o,i],!0),g={},w=Ac(t.session.outputNames);try{for(w.s();!(v=w.n()).done;)b=v.value,x=y[b],g[b]=Bc(x.data,x.dims,!0)}catch(e){w.e(e)}finally{w.f()}return(_={})[t.inputName]=m,e.prev=14,e.next=17,t.session.run(_,g);case 17:e.next=22;break;case 19:e.prev=19,e.t0=e.catch(14),n.bv.notify({message:"Session run error: ".concat(e.t0,", session: ").concat(t," with prealloc ").concat(g),cause:e.t0,emitter:n.JK.SESSION_RUNNER});case 22:return(S=t.gpuDevice.createCommandEncoder()).copyBufferToBuffer(p.outputGPUBuffer,0,p.outputTransferGPUBuffer,0,p.outputTransferGPUBuffer.size),T=S.finish(),null===(u=t.gpuDevice)||void 0===u||u.queue.submit([T]),e.next=28,p.outputTransferGPUBuffer.mapAsync(GPUMapMode.READ);case 28:try{E=new Float32Array(p.outputTransferGPUBuffer.getMappedRange()),d.data.set(E)}finally{p.outputTransferGPUBuffer.unmap()}return(O={inputBack:r})[f]=d.data,e.abrupt("return",O);case 32:case"end":return e.stop()}}),e,this,[[14,19]])}))),function(t,r,n,i,o,a){return e.apply(this,arguments)})},{key:"obtainedPreallocOutput",value:function(e,t){var r=e.outputNames;if(r.length>1)throw Error("Graph replay wrapper does not support multiples outputs. TODO: Add multiple outputs support");return[r[0],t[r[0]]]}},{key:"provideGPUBindings",value:function(e,t,r,n){var i=this.bindings.get(t);if(!i){var o=this.allocateBindings(e,r,n);return this.bindings.set(t,o),o}if(!(i.inputGPUBuffer.size===r&&i.outputGPUBuffer.size===n))throw Error("onnxruntime session can not change input|output when replay mode is enabled");return i}},{key:"allocateBindings",value:function(e,t,r){return{inputGPUBuffer:e.createBuffer({size:t,usage:GPUBufferUsage.STORAGE|GPUBufferUsage.COPY_DST}),outputGPUBuffer:e.createBuffer({size:r,usage:GPUBufferUsage.STORAGE|GPUBufferUsage.COPY_SRC}),outputTransferGPUBuffer:e.createBuffer({size:r,usage:GPUBufferUsage.MAP_READ|GPUBufferUsage.COPY_DST})}}},{key:"toInputBuffer",value:function(e,t,r){if(!(t instanceof Float32Array))throw TypeError("Currently only Float32Array is supported");e.queue.writeBuffer(r,0,t.buffer,0,r.size)}}]);var e}();function Uc(e){return Uc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Uc(e)}function jc(){jc=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,i=Object.defineProperty||function(e,t,r){e[t]=r.value},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function l(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,r){return e[t]=r}}function h(e,t,r,n){var o=t&&t.prototype instanceof g?t:g,a=Object.create(o.prototype),s=new k(n||[]);return i(a,"_invoke",{value:O(e,r,s)}),a}function c(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=h;var f="suspendedStart",d="suspendedYield",p="executing",y="completed",m={};function g(){}function w(){}function v(){}var b={};l(b,a,(function(){return this}));var x=Object.getPrototypeOf,_=x&&x(x(C([])));_&&_!==r&&n.call(_,a)&&(b=_);var S=v.prototype=g.prototype=Object.create(b);function T(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function E(e,t){function r(i,o,a,s){var u=c(e[i],e,o);if("throw"!==u.type){var l=u.arg,h=l.value;return h&&"object"==Uc(h)&&n.call(h,"__await")?t.resolve(h.__await).then((function(e){r("next",e,a,s)}),(function(e){r("throw",e,a,s)})):t.resolve(h).then((function(e){l.value=e,a(l)}),(function(e){return r("throw",e,a,s)}))}s(u.arg)}var o;i(this,"_invoke",{value:function(e,n){function i(){return new t((function(t,i){r(e,n,t,i)}))}return o=o?o.then(i,i):i()}})}function O(t,r,n){var i=f;return function(o,a){if(i===p)throw Error("Generator is already running");if(i===y){if("throw"===o)throw a;return{value:e,done:!0}}for(n.method=o,n.arg=a;;){var s=n.delegate;if(s){var u=A(s,n);if(u){if(u===m)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===f)throw i=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i=p;var l=c(t,r,n);if("normal"===l.type){if(i=n.done?y:d,l.arg===m)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(i=y,n.method="throw",n.arg=l.arg)}}}function A(t,r){var n=r.method,i=t.iterator[n];if(i===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,A(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),m;var o=c(i,t.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,m;var a=o.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,m):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,m)}function I(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function P(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function k(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(I,this),this.reset(!0)}function C(t){if(t||""===t){var r=t[a];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,o=function r(){for(;++i<t.length;)if(n.call(t,i))return r.value=t[i],r.done=!1,r;return r.value=e,r.done=!0,r};return o.next=o}}throw new TypeError(Uc(t)+" is not iterable")}return w.prototype=v,i(S,"constructor",{value:v,configurable:!0}),i(v,"constructor",{value:w,configurable:!0}),w.displayName=l(v,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===w||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,v):(e.__proto__=v,l(e,u,"GeneratorFunction")),e.prototype=Object.create(S),e},t.awrap=function(e){return{__await:e}},T(E.prototype),l(E.prototype,s,(function(){return this})),t.AsyncIterator=E,t.async=function(e,r,n,i,o){void 0===o&&(o=Promise);var a=new E(h(e,r,n,i),o);return t.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},T(S),l(S,u,"Generator"),l(S,a,(function(){return this})),l(S,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=C,k.prototype={constructor:k,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(P),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function i(n,i){return s.type="throw",s.arg=t,r.next=n,i&&(r.method="next",r.arg=e),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),l=n.call(a,"finallyLoc");if(u&&l){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return i(a.catchLoc,!0)}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,m):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),P(r),m}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;P(r)}return i}}throw Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:C(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),m}},t}function zc(e,t,r,n,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void r(e)}s.done?t(u):Promise.resolve(u).then(n,i)}function Gc(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var o=e.apply(t,r);function a(e){zc(o,n,i,a,s,"next",e)}function s(e){zc(o,n,i,a,s,"throw",e)}a(void 0)}))}}function Vc(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Wc(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,qc(n.key),n)}}function Hc(e,t,r){return t&&Wc(e.prototype,t),r&&Wc(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function qc(e){var t=function(e,t){if("object"!=Uc(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=Uc(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Uc(t)?t:t+""}var Yc=function(){return Hc((function e(){Vc(this,e),this.sessionManager=new bc,this.cpuExecutor=new Qe,this.inferenceId=Math.floor(1e4*Math.random()),this.messageChannel=new MessageChannel}),[{key:"isReady",value:function(e){return this.sessionManager.isReady(e)}},{key:"configurePort",value:function(){window.postMessage({type:"tsvb-custom-inference-port",port:this.messageChannel.port1},"*",[this.messageChannel.port1])}},{key:"updateBuffer",value:function(e){this.output=new Float32Array(e)}},{key:"getType",value:function(){return"custom"}},{key:"isGPU",value:function(e){return!1}},{key:"run",value:(e=Gc(jc().mark((function e(t,r,i,o,a,s){var u=this;return jc().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.cpuExecutor.enqueue(Gc(jc().mark((function e(){return jc().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u.messageChannel.port2.postMessage({input:r,output:u.output},[r.buffer,u.output.buffer]),e.next=3,new Promise((function(e){u.messageChannel.port2.onmessage=function(t){u.output=new Float32Array(t.data.output),r=new Float32Array(t.data.input),e(!0)}}));case 3:u.messageChannel.port2.onmessage=null;case 4:case"end":return e.stop()}}),e)}))));case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),n.bv.notify({message:"Native session run error: ".concat(e.t0),type:n.By.ERROR,code:n.O4.INFERENCE_RUN_ISSUE,cause:e.t0,emitter:n.JK.ML_INFERENCE});case 8:return e.abrupt("return",{seg:{data:this.output},inputBack:{data:r}});case 9:case"end":return e.stop()}}),e,this,[[0,5]])}))),function(t,r,n,i,o,a){return e.apply(this,arguments)})}]);var e}(),Xc={onnx:function(){return Hc((function e(){Vc(this,e),this.sessionManager=new xc,this.cpuExecutor=new Qe,this.gpuExecutor=new Qe,this.cpuRunner=new Nc,this.gpuRunner=new Fc,this.inferenceId=Math.floor(1e4*Math.random())}),[{key:"getType",value:function(){return"onnx"}},{key:"isReady",value:function(e){return this.sessionManager.isReady(e)}},{key:"isGPU",value:function(e){var t=this.sessionManager.getSession(e);return!!t&&t.isGPU}},{key:"run",value:(e=Gc(jc().mark((function e(t,r,n,i,o,a){var s=this;return jc().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.isGPU){e.next=6;break}return e.next=3,this.gpuExecutor.enqueue((function(){return s.gpuRunner.run(t,r,n,i,o,a)}));case 3:case 8:return e.abrupt("return",e.sent);case 6:return e.next=8,this.cpuExecutor.enqueue((function(){return s.cpuRunner.run(t,r,n,i,o,a)}));case 9:case"end":return e.stop()}}),e,this)}))),function(t,r,n,i,o,a){return e.apply(this,arguments)})}]);var e}(),custom:Yc},Kc=function(){function e(){Vc(this,e)}return Hc(e,null,[{key:"getInference",value:function(t){return e.inferences.has(t)||e.inferences.set(t,new Xc[t]),e.inferences.get(t)}}])}();function Zc(e){return Zc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Zc(e)}function Jc(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Qc(n.key),n)}}function Qc(e){var t=function(e,t){if("object"!=Zc(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=Zc(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Zc(t)?t:t+""}Kc.inferences=new Map;var ef=function(){return e=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1?arguments[1]:void 0;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.sdkOptions=r,this.container=new c.Container,this.background=new c.Sprite(c.Texture.WHITE),this.background.tint=0,t.background&&(this.background.tint=t.background);var n={fontFamily:"Arial",fontSize:t.size?t.size:24,fill:t.color?t.color:16777215,align:"left"};this.text=new c.Text("",n);var i=t.padding?t.padding:7;this.text.x=i,this.text.y=i,this.container.addChild(this.background),this.container.addChild(this.text),this.container.visible=!1,this.sdkOptions.on("update",this.onOptionsUpdate,this)},(t=[{key:"onOptionsUpdate",value:function(){this.text.style.fontSize=Math.round(.02*this.sdkOptions.width)}},{key:"updateText",value:function(e){this.text.text=e;var t=this.text.getLocalBounds();this.background.width=2*this.text.x+t.width,this.background.height=2*this.text.y+t.height}},{key:"destroy",value:function(){this.sdkOptions.off("update",this.onOptionsUpdate,this)}}])&&Jc(e.prototype,t),r&&Jc(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,r}();function tf(e){return tf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},tf(e)}function rf(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,nf(n.key),n)}}function nf(e){var t=function(e,t){if("object"!=tf(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=tf(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==tf(t)?t:t+""}function of(e,t,r){return t=sf(t),function(e,t){if(t&&("object"==tf(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,af()?Reflect.construct(t,r||[],sf(e).constructor):t.apply(e,r))}function af(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(af=function(){return!!e})()}function sf(e){return sf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},sf(e)}function uf(e,t){return uf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},uf(e,t)}var lf=function(e){function t(e){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(r=of(this,t,["in vec2 aVertexPosition;\nin vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nout vec2 vVertexPosition;\nout vec2 vTextureCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition(void ) {\n  vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.0)) + outputFrame.xy;\n\n  return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord(void ) {\n  return aVertexPosition; // * (outputFrame.zw);\n}\n\nvoid main(void ) {\n  gl_Position = filterVertexPosition();\n  vTextureCoord = filterTextureCoord();\n}\n","precision mediump float;\nuniform sampler2D uSampler;\nin vec2 vTextureCoord;\nuniform vec4 filterArea;\nlayout(location = 0) out vec4 outColor;\n\nuniform sampler2D u_Texture;\nuniform float u_Offset;\nuniform vec2 u_ImgSize;\n//Y =  0.299R + 0.587G + 0.114B\n//U = -0.147R - 0.289G + 0.436B\n//V =  0.615R - 0.515G - 0.100B\nconst vec3 COEF_Y = vec3(0.2126, 0.7152, 0.0722);\nconst vec3 COEF_U = vec3(-0.1146, -0.3854, 0.5);\nconst vec3 COEF_V = vec3(0.5, -0.4542, -0.0458);\nconst float U_DIVIDE_LINE = 2.0 / 3.0;\nconst float V_DIVIDE_LINE = 5.0 / 6.0;\n\nvoid main() {\n  vec2 texelOffset = vec2(u_Offset, 0.0);\n  //outColor = vec4(vTextureCoord.y, vTextureCoord.y, vTextureCoord.y, vTextureCoord.y);\n\n  if (vTextureCoord.y <= U_DIVIDE_LINE) {\n    vec2 texCoord = vec2(vTextureCoord.x, vTextureCoord.y * 3.0 / 2.0);\n    vec4 color0 = texture(u_Texture, texCoord);\n    vec4 color1 = texture(u_Texture, texCoord + texelOffset);\n    vec4 color2 = texture(u_Texture, texCoord + texelOffset * 2.0);\n    vec4 color3 = texture(u_Texture, texCoord + texelOffset * 3.0);\n\n    float y0 = dot(color0.rgb, COEF_Y);\n    float y1 = dot(color1.rgb, COEF_Y);\n    float y2 = dot(color2.rgb, COEF_Y);\n    float y3 = dot(color3.rgb, COEF_Y);\n    outColor = vec4(y0, y1, y2, y3);\n  } else if (vTextureCoord.y <= V_DIVIDE_LINE) {\n    float offsetY = 1.0 / 3.0 / u_ImgSize.y;\n    vec2 texCoord;\n    if (vTextureCoord.x <= 0.5) {\n      texCoord = vec2(vTextureCoord.x * 2.0, (vTextureCoord.y - U_DIVIDE_LINE) * 2.0 * 3.0);\n    } else {\n      texCoord = vec2(\n        (vTextureCoord.x - 0.5) * 2.0,\n        ((vTextureCoord.y - U_DIVIDE_LINE) * 2.0 + offsetY) * 3.0\n      );\n    }\n\n    vec4 color0 = texture(u_Texture, texCoord);\n    vec4 color1 = texture(u_Texture, texCoord + texelOffset * 2.0);\n    vec4 color2 = texture(u_Texture, texCoord + texelOffset * 4.0);\n    vec4 color3 = texture(u_Texture, texCoord + texelOffset * 6.0);\n\n    float u0 = dot(color0.rgb, COEF_U) + 0.5;\n    float u1 = dot(color1.rgb, COEF_U) + 0.5;\n    float u2 = dot(color2.rgb, COEF_U) + 0.5;\n    float u3 = dot(color3.rgb, COEF_U) + 0.5;\n    outColor = vec4(u0, u1, u2, u3);\n  } else {\n    float offsetY = 1.0 / 3.0 / u_ImgSize.y;\n    vec2 texCoord;\n    if (vTextureCoord.x <= 0.5) {\n      texCoord = vec2(vTextureCoord.x * 2.0, (vTextureCoord.y - V_DIVIDE_LINE) * 2.0 * 3.0);\n    } else {\n      texCoord = vec2(\n        (vTextureCoord.x - 0.5) * 2.0,\n        ((vTextureCoord.y - V_DIVIDE_LINE) * 2.0 + offsetY) * 3.0\n      );\n    }\n\n    vec4 color0 = texture(u_Texture, texCoord);\n    vec4 color1 = texture(u_Texture, texCoord + texelOffset * 2.0);\n    vec4 color2 = texture(u_Texture, texCoord + texelOffset * 4.0);\n    vec4 color3 = texture(u_Texture, texCoord + texelOffset * 6.0);\n\n    float v0 = dot(color0.rgb, COEF_V) + 0.5;\n    float v1 = dot(color1.rgb, COEF_V) + 0.5;\n    float v2 = dot(color2.rgb, COEF_V) + 0.5;\n    float v3 = dot(color3.rgb, COEF_V) + 0.5;\n    outColor = vec4(v0, v1, v2, v3);\n  }\n}\n",e.uniforms])).program.fragmentSrc.includes("#version 300 es")||(r.program.fragmentSrc="#version 300 es \n"+r.program.fragmentSrc),r.program.vertexSrc.includes("#version 300 es")||(r.program.vertexSrc="#version 300 es \n"+r.program.vertexSrc),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&uf(e,t)}(t,e),r=t,n&&rf(r.prototype,n),i&&rf(r,i),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,i}(c.Filter);function hf(e){return hf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},hf(e)}function cf(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ff(n.key),n)}}function ff(e){var t=function(e,t){if("object"!=hf(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=hf(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==hf(t)?t:t+""}var df=function(){return e=function e(t,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.sdkOptions=r;var n=this.sdkOptions.width,i=this.sdkOptions.height;this.renderer=t,this.widthYUV=n/4,this.heightYUV=3*i/2,this.textureYUV=c.RenderTexture.create({width:this.widthYUV,height:this.heightYUV}),this.textureRBG=c.RenderTexture.create({width:n,height:i}),this.spriteYUV=new c.Sprite(this.textureYUV),this.filterYUV=new lf({uniforms:{u_Offset:1/n,u_ImgSize:[n,i],u_Texture:this.textureRBG}}),this.spriteYUV.filters=[this.filterYUV],this.sdkOptions.on("update",this.onOptionsUpdate,this)},t=[{key:"onOptionsUpdate",value:function(){var e=this.sdkOptions.width,t=this.sdkOptions.height;this.widthYUV=e/4,this.heightYUV=3*t/2,this.textureYUV.resize(this.widthYUV,this.heightYUV),this.textureRBG.resize(e,t),this.filterYUV.uniforms.u_Offset=1/e,this.filterYUV.uniforms.u_ImgSize=[e,t]}},{key:"getVideoFrameArray",value:function(){var e=new Uint8Array(4*this.widthYUV*this.heightYUV),t=this.renderer.generateTexture(this.spriteYUV);this.renderer.renderTexture.bind(t);var r=t.framebuffer.glFramebuffers[this.renderer.CONTEXT_UID];r.blitFramebuffer&&this.renderer.framebuffer.bind(r.blitFramebuffer);var n=this.renderer.gl;return n.readPixels(0,0,this.widthYUV,this.heightYUV,n.RGBA,n.UNSIGNED_BYTE,e),t.destroy(!0),e}},{key:"getVideoFrameSettings",value:function(){return{format:"I420",codedWidth:this.sdkOptions.width,codedHeight:this.sdkOptions.height}}},{key:"destroy",value:function(){this.sdkOptions.off("update",this.onOptionsUpdate,this)}}],t&&cf(e.prototype,t),r&&cf(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,r}();function pf(e){return pf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},pf(e)}function yf(){yf=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,i=Object.defineProperty||function(e,t,r){e[t]=r.value},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function l(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,r){return e[t]=r}}function h(e,t,r,n){var o=t&&t.prototype instanceof g?t:g,a=Object.create(o.prototype),s=new k(n||[]);return i(a,"_invoke",{value:O(e,r,s)}),a}function c(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=h;var f="suspendedStart",d="suspendedYield",p="executing",y="completed",m={};function g(){}function w(){}function v(){}var b={};l(b,a,(function(){return this}));var x=Object.getPrototypeOf,_=x&&x(x(C([])));_&&_!==r&&n.call(_,a)&&(b=_);var S=v.prototype=g.prototype=Object.create(b);function T(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function E(e,t){function r(i,o,a,s){var u=c(e[i],e,o);if("throw"!==u.type){var l=u.arg,h=l.value;return h&&"object"==pf(h)&&n.call(h,"__await")?t.resolve(h.__await).then((function(e){r("next",e,a,s)}),(function(e){r("throw",e,a,s)})):t.resolve(h).then((function(e){l.value=e,a(l)}),(function(e){return r("throw",e,a,s)}))}s(u.arg)}var o;i(this,"_invoke",{value:function(e,n){function i(){return new t((function(t,i){r(e,n,t,i)}))}return o=o?o.then(i,i):i()}})}function O(t,r,n){var i=f;return function(o,a){if(i===p)throw Error("Generator is already running");if(i===y){if("throw"===o)throw a;return{value:e,done:!0}}for(n.method=o,n.arg=a;;){var s=n.delegate;if(s){var u=A(s,n);if(u){if(u===m)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===f)throw i=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i=p;var l=c(t,r,n);if("normal"===l.type){if(i=n.done?y:d,l.arg===m)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(i=y,n.method="throw",n.arg=l.arg)}}}function A(t,r){var n=r.method,i=t.iterator[n];if(i===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,A(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),m;var o=c(i,t.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,m;var a=o.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,m):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,m)}function I(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function P(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function k(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(I,this),this.reset(!0)}function C(t){if(t||""===t){var r=t[a];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,o=function r(){for(;++i<t.length;)if(n.call(t,i))return r.value=t[i],r.done=!1,r;return r.value=e,r.done=!0,r};return o.next=o}}throw new TypeError(pf(t)+" is not iterable")}return w.prototype=v,i(S,"constructor",{value:v,configurable:!0}),i(v,"constructor",{value:w,configurable:!0}),w.displayName=l(v,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===w||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,v):(e.__proto__=v,l(e,u,"GeneratorFunction")),e.prototype=Object.create(S),e},t.awrap=function(e){return{__await:e}},T(E.prototype),l(E.prototype,s,(function(){return this})),t.AsyncIterator=E,t.async=function(e,r,n,i,o){void 0===o&&(o=Promise);var a=new E(h(e,r,n,i),o);return t.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},T(S),l(S,u,"Generator"),l(S,a,(function(){return this})),l(S,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=C,k.prototype={constructor:k,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(P),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function i(n,i){return s.type="throw",s.arg=t,r.next=n,i&&(r.method="next",r.arg=e),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),l=n.call(a,"finallyLoc");if(u&&l){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return i(a.catchLoc,!0)}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,m):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),P(r),m}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;P(r)}return i}}throw Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:C(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),m}},t}function mf(e,t,r,n,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void r(e)}s.done?t(u):Promise.resolve(u).then(n,i)}function gf(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var o=e.apply(t,r);function a(e){mf(o,n,i,a,s,"next",e)}function s(e){mf(o,n,i,a,s,"throw",e)}a(void 0)}))}}function wf(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,vf(n.key),n)}}function vf(e){var t=function(e,t){if("object"!=pf(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=pf(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==pf(t)?t:t+""}var bf=function(){return e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)},t=[{key:"clientWaitAsync",value:function(e,t,r,n){return new Promise((function(i,o){!function a(){var s=e.clientWaitSync(t,r,0);s!==e.WAIT_FAILED?s!==e.TIMEOUT_EXPIRED?i(!0):w(a,n):o()}()}))}},{key:"getBufferSubDataAsync",value:(i=gf(yf().mark((function e(t,r,n,i,o,a,s){var u;return yf().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u=t.fenceSync(t.SYNC_GPU_COMMANDS_COMPLETE,0),t.flush(),e.next=4,this.clientWaitAsync(t,u,0,4);case 4:t.deleteSync(u),t.bindBuffer(r,n),t.getBufferSubData(r,i,o,a,s),t.bindBuffer(r,null);case 8:case"end":return e.stop()}}),e,this)}))),function(e,t,r,n,o,a,s){return i.apply(this,arguments)})},{key:"readPixelsAsync",value:(n=gf(yf().mark((function e(t,r,n,i,o,a,s,u){var l;return yf().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l=t.createBuffer(),e.prev=1,t.bindBuffer(t.PIXEL_PACK_BUFFER,l),t.bufferData(t.PIXEL_PACK_BUFFER,u.byteLength,t.STREAM_READ),t.readPixels(r,n,i,o,a,s,0),t.bindBuffer(t.PIXEL_PACK_BUFFER,null),e.next=8,this.getBufferSubDataAsync(t,t.PIXEL_PACK_BUFFER,l,0,u);case 8:return e.abrupt("return",u);case 9:return e.prev=9,t.deleteBuffer(l),e.finish(9);case 12:case"end":return e.stop()}}),e,this,[[1,,9,12]])}))),function(e,t,r,i,o,a,s,u){return n.apply(this,arguments)})}],t&&wf(e.prototype,t),r&&wf(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,r,n,i}(),xf=r(9203);const _f={vec3(e,t,r,n){(r[0]!==n[0]||r[1]!==n[1]||r[2]!==n[2])&&(r[0]=n[0],r[1]=n[1],r[2]=n[2],e.uniform3f(t,n[0],n[1],n[2]))},int(e,t,r,n){e.uniform1i(t,n)},ivec2(e,t,r,n){e.uniform2i(t,n[0],n[1])},ivec3(e,t,r,n){e.uniform3i(t,n[0],n[1],n[2])},ivec4(e,t,r,n){e.uniform4i(t,n[0],n[1],n[2],n[3])},uint(e,t,r,n){e.uniform1ui(t,n)},uvec2(e,t,r,n){e.uniform2ui(t,n[0],n[1])},uvec3(e,t,r,n){e.uniform3ui(t,n[0],n[1],n[2])},uvec4(e,t,r,n){e.uniform4ui(t,n[0],n[1],n[2],n[3])},bvec2(e,t,r,n){e.uniform2i(t,n[0],n[1])},bvec3(e,t,r,n){e.uniform3i(t,n[0],n[1],n[2])},bvec4(e,t,r,n){e.uniform4i(t,n[0],n[1],n[2],n[3])},mat2(e,t,r,n){e.uniformMatrix2fv(t,!1,n)},mat4(e,t,r,n){e.uniformMatrix4fv(t,!1,n)}},Sf={float(e,t,r,n){e.uniform1fv(t,n)},vec2(e,t,r,n){e.uniform2fv(t,n)},vec3(e,t,r,n){e.uniform3fv(t,n)},vec4(e,t,r,n){e.uniform4fv(t,n)},int(e,t,r,n){e.uniform1iv(t,n)},ivec2(e,t,r,n){e.uniform2iv(t,n)},ivec3(e,t,r,n){e.uniform3iv(t,n)},ivec4(e,t,r,n){e.uniform4iv(t,n)},uint(e,t,r,n){e.uniform1uiv(t,n)},uvec2(e,t,r,n){e.uniform2uiv(t,n)},uvec3(e,t,r,n){e.uniform3uiv(t,n)},uvec4(e,t,r,n){e.uniform4uiv(t,n)},bool(e,t,r,n){e.uniform1iv(t,n)},bvec2(e,t,r,n){e.uniform2iv(t,n)},bvec3(e,t,r,n){e.uniform3iv(t,n)},bvec4(e,t,r,n){e.uniform4iv(t,n)},sampler2D(e,t,r,n){e.uniform1iv(t,n)},samplerCube(e,t,r,n){e.uniform1iv(t,n)},sampler2DArray(e,t,r,n){e.uniform1iv(t,n)}};function Tf(e){return Tf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Tf(e)}function Ef(){Ef=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,i=Object.defineProperty||function(e,t,r){e[t]=r.value},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function l(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,r){return e[t]=r}}function h(e,t,r,n){var o=t&&t.prototype instanceof g?t:g,a=Object.create(o.prototype),s=new k(n||[]);return i(a,"_invoke",{value:O(e,r,s)}),a}function c(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=h;var f="suspendedStart",d="suspendedYield",p="executing",y="completed",m={};function g(){}function w(){}function v(){}var b={};l(b,a,(function(){return this}));var x=Object.getPrototypeOf,_=x&&x(x(C([])));_&&_!==r&&n.call(_,a)&&(b=_);var S=v.prototype=g.prototype=Object.create(b);function T(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function E(e,t){function r(i,o,a,s){var u=c(e[i],e,o);if("throw"!==u.type){var l=u.arg,h=l.value;return h&&"object"==Tf(h)&&n.call(h,"__await")?t.resolve(h.__await).then((function(e){r("next",e,a,s)}),(function(e){r("throw",e,a,s)})):t.resolve(h).then((function(e){l.value=e,a(l)}),(function(e){return r("throw",e,a,s)}))}s(u.arg)}var o;i(this,"_invoke",{value:function(e,n){function i(){return new t((function(t,i){r(e,n,t,i)}))}return o=o?o.then(i,i):i()}})}function O(t,r,n){var i=f;return function(o,a){if(i===p)throw Error("Generator is already running");if(i===y){if("throw"===o)throw a;return{value:e,done:!0}}for(n.method=o,n.arg=a;;){var s=n.delegate;if(s){var u=A(s,n);if(u){if(u===m)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===f)throw i=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i=p;var l=c(t,r,n);if("normal"===l.type){if(i=n.done?y:d,l.arg===m)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(i=y,n.method="throw",n.arg=l.arg)}}}function A(t,r){var n=r.method,i=t.iterator[n];if(i===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,A(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),m;var o=c(i,t.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,m;var a=o.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,m):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,m)}function I(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function P(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function k(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(I,this),this.reset(!0)}function C(t){if(t||""===t){var r=t[a];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,o=function r(){for(;++i<t.length;)if(n.call(t,i))return r.value=t[i],r.done=!1,r;return r.value=e,r.done=!0,r};return o.next=o}}throw new TypeError(Tf(t)+" is not iterable")}return w.prototype=v,i(S,"constructor",{value:v,configurable:!0}),i(v,"constructor",{value:w,configurable:!0}),w.displayName=l(v,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===w||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,v):(e.__proto__=v,l(e,u,"GeneratorFunction")),e.prototype=Object.create(S),e},t.awrap=function(e){return{__await:e}},T(E.prototype),l(E.prototype,s,(function(){return this})),t.AsyncIterator=E,t.async=function(e,r,n,i,o){void 0===o&&(o=Promise);var a=new E(h(e,r,n,i),o);return t.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},T(S),l(S,u,"Generator"),l(S,a,(function(){return this})),l(S,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=C,k.prototype={constructor:k,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(P),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function i(n,i){return s.type="throw",s.arg=t,r.next=n,i&&(r.method="next",r.arg=e),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),l=n.call(a,"finallyLoc");if(u&&l){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return i(a.catchLoc,!0)}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,m):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),P(r),m}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;P(r)}return i}}throw Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:C(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),m}},t}function Of(e,t,r,n,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void r(e)}s.done?t(u):Promise.resolve(u).then(n,i)}function Af(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,If(n.key),n)}}function If(e){var t=function(e,t){if("object"!=Tf(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=Tf(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Tf(t)?t:t+""}Object.assign(xf.$P.prototype,{systemCheck(){},syncUniforms(e,t){const{shader:r,renderer:n}=this;!function(e,t,r,n,i){let o=0,a=null,s=null;const u=i.gl;for(const l in e.uniforms){const h=t[l],c=n[l],f=r[l],d=e.uniforms[l];h?"float"!==h.type||1!==h.size||h.isArray?"bool"!==h.type||1!==h.size||h.isArray?"sampler2D"!==h.type&&"samplerCube"!==h.type&&"sampler2DArray"!==h.type||1!==h.size||h.isArray?"mat3"!==h.type||1!==h.size||h.isArray?"vec2"!==h.type||1!==h.size||h.isArray?"vec4"!==h.type||1!==h.size||h.isArray?(1!==h.size||h.isArray?Sf:_f)[h.type].call(null,u,f.location,f.value,c):void 0!==d.width?(s=f.value,a=c,(s[0]!==a.x||s[1]!==a.y||s[2]!==a.width||s[3]!==a.height)&&(s[0]=a.x,s[1]=a.y,s[2]=a.width,s[3]=a.height,u.uniform4f(f.location,a.x,a.y,a.width,a.height))):(s=f.value,a=c,(s[0]!==a[0]||s[1]!==a[1]||s[2]!==a[2]||s[3]!==a[3])&&(s[0]=a[0],s[1]=a[1],s[2]=a[2],s[3]=a[3],u.uniform4f(f.location,a[0],a[1],a[2],a[3]))):void 0!==d.x?(s=f.value,a=c,(s[0]!==a.x||s[1]!==a.y)&&(s[0]=a.x,s[1]=a.y,u.uniform2f(f.location,a.x,a.y))):(s=f.value,a=c,(s[0]!==a[0]||s[1]!==a[1])&&(s[0]=a[0],s[1]=a[1],u.uniform2f(f.location,a[0],a[1]))):void 0!==d.a?u.uniformMatrix3fv(f.location,!1,c.toArray(!0)):u.uniformMatrix3fv(f.location,!1,c):(i.texture.bind(c,o),f.value!==o&&(f.value=o,u.uniform1i(f.location,o)),o++):c!==f.value&&(f.value=c,u.uniform1i(f.location,Number(c))):c!==f.value&&(f.value=c,u.uniform1f(f.location,c)):!0===d.group&&i.shader.syncUniformGroup(c)}}(e,r.program.uniformData,t.uniformData,e.uniforms,n)}});var Pf=function(){return e=function e(t,r){var i;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.color=65280,this.frameFormat="RGBX",r&&(this.frameFormat=r),this.sdkOptions=t,this.PIXI=c;try{this.renderer=new c.Application({width:this.sdkOptions.width,height:this.sdkOptions.height,antialias:!0,backgroundAlpha:0})}catch(e){n.bv.notify({type:n.By.ERROR,code:n.O4.APP_CREATION_ISSUE,message:null!==(i=e.message)&&void 0!==i?i:e,emitter:n.JK.RENDERER,cause:e})}this.filter_manager=new c.FilterSystem(this.renderer.renderer),this.timinngs={stats:new o.z,sprite:new ef({size:Math.round(.02*this.sdkOptions.width),padding:5},this.sdkOptions)},this.effectsContainer=new c.Container,this.renderer.stage.addChild(this.effectsContainer),this.overlayContainer=new c.Container,this.renderer.stage.addChild(this.overlayContainer),this.stopTickers(),this.GLHelper=new bf,"I420"===this.frameFormat&&(this.converterYUV=new df(this.renderer.renderer,this.sdkOptions)),this.sdkOptions.on("update",this.onOptionsUpdate,this)},t=[{key:"onOptionsUpdate",value:function(){this.renderer.renderer.resize(this.sdkOptions.width,this.sdkOptions.height)}},{key:"stopTickers",value:function(){this.renderer.ticker.stop(),c.Ticker.system.stop()}},{key:"startTickers",value:function(){this.renderer.ticker.start(),c.Ticker.system.start()}},{key:"updateVideoFrame",value:function(e){this.video_frame||(this.video_frame=this.createFrom(e)),this.video_frame.texture.destroy(!0),this.video_frame.texture=c.Texture.from(e)}},{key:"addStatistics",value:function(){this.addToStage(this.timinngs.sprite.container)}},{key:"removeStatistics",value:function(){this.removeFromStage(this.timinngs.sprite.container)}},{key:"updateStatistics",value:function(e,t){this.timinngs.stats.updateStats(e,t)}},{key:"hideStatistics",value:function(){this.timinngs.sprite.container.visible=!1}},{key:"drawStatistics",value:function(){this.timinngs.sprite.updateText(this.timinngs.stats.getText()),this.timinngs.sprite.container.visible=!0}},{key:"destroy",value:function(){this.renderer.renderer&&(this.sdkOptions.off("update",this.onOptionsUpdate,this),this.converterYUV&&this.converterYUV.destroy(),this.timinngs.sprite&&this.timinngs.sprite.destroy(),this.renderer.destroy(!0,{children:!0,texture:!0,baseTexture:!0}))}},{key:"renderTo",value:function(e,t){var r,i;try{(null===(r=this.renderer)||void 0===r?void 0:r.renderer)&&this.renderer.renderer.render(e,{renderTexture:t})}catch(e){n.bv.notify({message:null!==(i=e.message)&&void 0!==i?i:e,type:n.By.ERROR,code:n.O4.RENDERING_ISSUE,emitter:n.JK.RENDERER,cause:e})}}},{key:"createCanvas",value:function(e,t){var r=document.createElement("canvas");return r.width=e,r.height=t,r}},{key:"createTextureFromBuffer",value:function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return c.Texture.fromBuffer(e,t,r,n)}},{key:"createRenderTexture",value:function(e,t){return c.RenderTexture.create({width:e,height:t})}},{key:"pixels",value:function(e){return this.renderer.renderer.extract.pixels(e)}},{key:"pixelsAsync",value:(i=Ef().mark((function e(t,r){var n,i,o,a,s,u,l,h,c;return Ef().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(u=4*t._frame.width*t._frame.height,l=null!==(i=null===(n=null==r?void 0:r.pool)||void 0===n?void 0:n.getBuffer("u8",u))&&void 0!==i?i:new Uint8Array(u),h=null===(o=this.renderer)||void 0===o?void 0:o.renderer){e.next=5;break}return e.abrupt("return",l);case 5:return h.renderTexture.bind(t),(c=t.framebuffer.glFramebuffers[h.CONTEXT_UID]).blitFramebuffer&&h.framebuffer.bind(c.blitFramebuffer),e.prev=8,e.next=11,this.GLHelper.readPixelsAsync(h.gl,0,0,t._frame.width,t._frame.height,h.gl.RGBA,h.gl.UNSIGNED_BYTE,l);case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(8),null===(a=null==r?void 0:r.pool)||void 0===a||a.returnBuffer(l);case 16:return e.prev=16,null===(s=null==r?void 0:r.texturePool)||void 0===s||s.put(t),e.abrupt("return",l);case 20:case"end":return e.stop()}}),e,this,[[8,13,16,20]])})),a=function(){var e=this,t=arguments;return new Promise((function(r,n){var o=i.apply(e,t);function a(e){Of(o,r,n,a,s,"next",e)}function s(e){Of(o,r,n,a,s,"throw",e)}a(void 0)}))},function(e,t){return a.apply(this,arguments)})},{key:"calculateSpriteMatrix",value:function(e){var t=new c.Matrix;return this.filter_manager.calculateSpriteMatrix(t,e)}},{key:"getFilterManager",value:function(){return this.filter_manager}},{key:"setTintColor",value:function(e){this.color=e}},{key:"getTintColor",value:function(){return this.color}},{key:"createTexture",value:function(e){return e instanceof c.Texture?e:c.Texture.from(e)}},{key:"createFromTexture",value:function(e){return new c.Sprite(e)}},{key:"createFrom",value:function(e){return new c.Sprite(c.Texture.from(e))}},{key:"createFromURL",value:function(e){var t;return"string"==typeof e&&"color"===e?((t=new c.Sprite(c.Texture.WHITE)).tint=this.getTintColor(),t.width=this.sdkOptions.width,t.height=this.sdkOptions.height,t):t=c.Sprite.from(e)}},{key:"createContainer",value:function(){return new c.Container}},{key:"addToStage",value:function(e){var t;null===(t=this.renderer.stage)||void 0===t||t.addChild(e)}},{key:"addToEffects",value:function(e){var t;this.renderer.renderer&&(null===(t=this.effectsContainer)||void 0===t||t.addChild(e))}},{key:"addToOverlay",value:function(e){var t;null===(t=this.overlayContainer)||void 0===t||t.addChild(e)}},{key:"addToStageAt",value:function(e,t){var r;null===(r=this.renderer.stage)||void 0===r||r.addChildAt(e,t)}},{key:"addToEffectsAt",value:function(e,t){var r;null===(r=this.effectsContainer)||void 0===r||r.addChildAt(e,t)}},{key:"addToOverlayAt",value:function(e,t){var r;null===(r=this.overlayContainer)||void 0===r||r.addChildAt(e,t)}},{key:"removeFromStage",value:function(e){var t;null===(t=this.renderer.stage)||void 0===t||t.removeChild(e)}},{key:"removeFromEffects",value:function(e){var t;null===(t=this.effectsContainer)||void 0===t||t.removeChild(e)}},{key:"removeFromOverlay",value:function(e){var t;null===(t=this.overlayContainer)||void 0===t||t.removeChild(e)}},{key:"useAsMask",value:function(e){this.renderer.stage.mask=e}},{key:"setCanvas",value:function(e){this.canvas=e}},{key:"render",value:function(){var e;try{if(!this.renderer.renderer)return;this.renderer.render(),this.converterYUV&&(this.renderTo(this.renderer.stage,this.converterYUV.textureRBG),this.renderer.renderer.render(this.renderer.stage,{renderTexture:this.converterYUV.textureYUV}))}catch(t){n.bv.notify({message:null!==(e=t.message)&&void 0!==e?e:t,type:n.By.ERROR,code:n.O4.RENDERING_ISSUE,emitter:n.JK.RENDERER,cause:t})}}},{key:"getVideoFrameData",value:function(){return this.converterYUV?this.converterYUV.getVideoFrameArray():this.renderer.renderer.view}},{key:"getVideoFrameSettings",value:function(){return this.converterYUV?this.converterYUV.getVideoFrameSettings():{displayHeight:this.sdkOptions.height,displayWidth:this.sdkOptions.width}}}],t&&Af(e.prototype,t),r&&Af(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,r,i,a}();function kf(e){return kf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},kf(e)}function Cf(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,$f(n.key),n)}}function $f(e){var t=function(e,t){if("object"!=kf(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=kf(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==kf(t)?t:t+""}var Rf=function(){return e=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.frames=[],this.texturesPool=t},(t=[{key:"get",value:function(e,t,r){if(this.frames.length>0){var n=this.frames.shift();return this.texturesPool.put(n.update(e)),n.sprite.width=t,n.sprite.height=r,n}return new b.w(e,{width:t,height:r})}},{key:"put",value:function(e){this.frames.push(e)}}])&&Cf(e.prototype,t),r&&Cf(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,r}(),Df=r(8592);function Mf(e){return Mf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Mf(e)}function Lf(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Bf(n.key),n)}}function Bf(e){var t=function(e,t){if("object"!=Mf(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=Mf(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Mf(t)?t:t+""}var Nf=function(){return e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.u8Buffers={},this.f32Buffers={}},t=[{key:"getBuffer",value:function(e,t){var r,n;return null!==(n=null===(r=("f32"===e?this.f32Buffers:this.u8Buffers)[t])||void 0===r?void 0:r.pop())&&void 0!==n?n:"f32"===e?new Float32Array(t):new Uint8Array(t)}},{key:"returnBuffer",value:function(e){e instanceof Float32Array?this.returnBufferAs(e,this.f32Buffers,e.length):this.returnBufferAs(e,this.u8Buffers,e.length)}},{key:"returnBufferAs",value:function(e,t,r){var n=t[r];void 0!==n?n.push(e):t[r]=[e]}}],t&&Lf(e.prototype,t),r&&Lf(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,r}();function Ff(e){return Ff="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ff(e)}function Uf(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,i,o,a,s=[],u=!0,l=!1;try{if(o=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=o.call(r)).done)&&(s.push(n.value),s.length!==t);u=!0);}catch(e){l=!0,i=e}finally{try{if(!u&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(l)throw i}}return s}}(e,t)||zf(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function jf(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=zf(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw o}}}}function zf(e,t){if(e){if("string"==typeof e)return Gf(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Gf(e,t):void 0}}function Gf(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function Vf(){Vf=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,i=Object.defineProperty||function(e,t,r){e[t]=r.value},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function l(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,r){return e[t]=r}}function h(e,t,r,n){var o=t&&t.prototype instanceof g?t:g,a=Object.create(o.prototype),s=new k(n||[]);return i(a,"_invoke",{value:O(e,r,s)}),a}function c(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=h;var f="suspendedStart",d="suspendedYield",p="executing",y="completed",m={};function g(){}function w(){}function v(){}var b={};l(b,a,(function(){return this}));var x=Object.getPrototypeOf,_=x&&x(x(C([])));_&&_!==r&&n.call(_,a)&&(b=_);var S=v.prototype=g.prototype=Object.create(b);function T(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function E(e,t){function r(i,o,a,s){var u=c(e[i],e,o);if("throw"!==u.type){var l=u.arg,h=l.value;return h&&"object"==Ff(h)&&n.call(h,"__await")?t.resolve(h.__await).then((function(e){r("next",e,a,s)}),(function(e){r("throw",e,a,s)})):t.resolve(h).then((function(e){l.value=e,a(l)}),(function(e){return r("throw",e,a,s)}))}s(u.arg)}var o;i(this,"_invoke",{value:function(e,n){function i(){return new t((function(t,i){r(e,n,t,i)}))}return o=o?o.then(i,i):i()}})}function O(t,r,n){var i=f;return function(o,a){if(i===p)throw Error("Generator is already running");if(i===y){if("throw"===o)throw a;return{value:e,done:!0}}for(n.method=o,n.arg=a;;){var s=n.delegate;if(s){var u=A(s,n);if(u){if(u===m)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===f)throw i=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i=p;var l=c(t,r,n);if("normal"===l.type){if(i=n.done?y:d,l.arg===m)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(i=y,n.method="throw",n.arg=l.arg)}}}function A(t,r){var n=r.method,i=t.iterator[n];if(i===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,A(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),m;var o=c(i,t.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,m;var a=o.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,m):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,m)}function I(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function P(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function k(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(I,this),this.reset(!0)}function C(t){if(t||""===t){var r=t[a];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,o=function r(){for(;++i<t.length;)if(n.call(t,i))return r.value=t[i],r.done=!1,r;return r.value=e,r.done=!0,r};return o.next=o}}throw new TypeError(Ff(t)+" is not iterable")}return w.prototype=v,i(S,"constructor",{value:v,configurable:!0}),i(v,"constructor",{value:w,configurable:!0}),w.displayName=l(v,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===w||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,v):(e.__proto__=v,l(e,u,"GeneratorFunction")),e.prototype=Object.create(S),e},t.awrap=function(e){return{__await:e}},T(E.prototype),l(E.prototype,s,(function(){return this})),t.AsyncIterator=E,t.async=function(e,r,n,i,o){void 0===o&&(o=Promise);var a=new E(h(e,r,n,i),o);return t.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},T(S),l(S,u,"Generator"),l(S,a,(function(){return this})),l(S,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=C,k.prototype={constructor:k,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(P),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function i(n,i){return s.type="throw",s.arg=t,r.next=n,i&&(r.method="next",r.arg=e),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),l=n.call(a,"finallyLoc");if(u&&l){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return i(a.catchLoc,!0)}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,m):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),P(r),m}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;P(r)}return i}}throw Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:C(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),m}},t}function Wf(e,t,r,n,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void r(e)}s.done?t(u):Promise.resolve(u).then(n,i)}function Hf(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var o=e.apply(t,r);function a(e){Wf(o,n,i,a,s,"next",e)}function s(e){Wf(o,n,i,a,s,"throw",e)}a(void 0)}))}}function qf(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Xf(n.key),n)}}function Yf(e,t,r){return t&&qf(e.prototype,t),r&&qf(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Xf(e){var t=function(e,t){if("object"!=Ff(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=Ff(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Ff(t)?t:t+""}function Kf(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var Zf=Yf((function e(){Kf(this,e),this.filters=new Map,this.texturePool=new Df.O,this.bufferPool=new Nf})),Jf=function(){return Yf((function e(t,r,n){Kf(this,e),this.effects=[],this.isPaused=!1,this.isSkipPipeline=!1,this.components={},this.hasFrames=!1,this.frames=[],this.resources=new Zf,this.sdkOptions=r,this.resources.renderer=t,this.components=null!=n?n:{},this.framePool=new Rf(this.resources.texturePool)}),[{key:"destroy",value:function(){this.removeComponents(),this.resources.renderer.destroy(),this.effects.forEach((function(e){e.destroy()})),this.clearFrames()}},{key:"addEffect",value:function(e){this.effects.find((function(t){return t.name==e.name}))||(e.useResources(this.resources),e.prepare(),this.effects.push(e),this.effects.sort((function(e,t){return e.priority-t.priority})))}},{key:"removeEffect",value:function(e){this.effects=this.effects.filter((function(t){return t.name!==e.name}))}},{key:"addLastEffect",value:function(e){e.useResources(this.resources),e.prepare(),this.lastEffect=e}},{key:"clearFrames",value:function(){for(;this.frames.length>0;){var e=this.frames.shift();e&&this.framePool.put(e)}}},{key:"clearBuffers",value:function(){this.effects.forEach((function(e,t){e.clearBuffers()}))}},{key:"pause",value:function(){this.isPaused=!0,this.clearFrames()}},{key:"unpause",value:function(){this.isPaused=!1}},{key:"enablePipelineSkipping",value:function(){this.isSkipPipeline=!0}},{key:"disablePipelineSkipping",value:function(){this.isSkipPipeline=!1}},{key:"nextFrame",value:function(e){if(this.isPaused||this.isSkipPipeline)e.texture.destroy(!0);else{var t=this.framePool.get(e,this.sdkOptions.width,this.sdkOptions.height);if(this.effects.forEach(function(){var e=Hf(Vf().mark((function e(r,n){return Vf().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r.requireNextFrame&&r.nextFrame(t),!r.requireSyncDraw){e.next=4;break}return e.next=4,r.process(t);case 4:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}()),this.frames.length>1){var r=this.frames.shift();r&&this.framePool.put(r)}this.frames.push(t)}}},{key:"addComponents",value:function(){var e=this;this.components._getSortedComponentsArr.forEach((function(t){return e.resources.renderer.addToStage(t.container)}))}},{key:"removeComponents",value:function(){var e=this;Object.values(this.components).forEach((function(t){return e.resources.renderer.removeFromStage(t.container)}))}},{key:"process",value:(e=Hf(Vf().mark((function e(){var t,r,n,i,o;return Vf().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.isPaused){e.next=4;break}return(t=this.frames.shift())&&this.framePool.put(t),e.abrupt("return");case 4:if(!this.isSkipPipeline){e.next=9;break}return this.addComponents(),this.resources.renderer.render(),this.removeComponents(),e.abrupt("return");case 9:if(this.frames.length){e.next=11;break}return e.abrupt("return");case 11:t=this.frames.shift(),r=jf(this.effects.entries()),e.prev=13,r.s();case 15:if((n=r.n()).done){e.next=22;break}if((i=Uf(n.value,2))[0],(o=i[1]).requireSyncDraw){e.next=20;break}return e.next=20,o.process(t);case 20:e.next=15;break;case 22:e.next=27;break;case 24:e.prev=24,e.t0=e.catch(13),r.e(e.t0);case 27:return e.prev=27,r.f(),e.finish(27);case 30:return this.addComponents(),e.next=33,this.lastEffect.process(t);case 33:this.removeComponents(),t&&this.framePool.put(t),this.hasFrames=!0;case 36:case"end":return e.stop()}}),e,this,[[13,24,27,30]])}))),function(){return e.apply(this,arguments)})}]);var e}();function Qf(e){return Qf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Qf(e)}function ed(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,i,o,a,s=[],u=!0,l=!1;try{if(o=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=o.call(r)).done)&&(s.push(n.value),s.length!==t);u=!0);}catch(e){l=!0,i=e}finally{try{if(!u&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(l)throw i}}return s}}(e,t)||function(e,t){if(e){if("string"==typeof e)return td(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?td(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function td(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function rd(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,nd(n.key),n)}}function nd(e){var t=function(e,t){if("object"!=Qf(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=Qf(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Qf(t)?t:t+""}var id=function(){return e=function e(t,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.options={},this.sdkOptions=t,this.container=new c.Container,this.setOptions(r)},(t=[{key:"setOptions",value:function(e){var t=this;e&&Object.entries(e).forEach((function(e){var r=ed(e,2),n=r[0],i=r[1];t.options[n]=i}))}},{key:"show",value:function(){this.beforeShowFunction&&this.beforeShowFunction(),this.container.visible=!0,this.afterShowFunction&&this.afterShowFunction()}},{key:"hide",value:function(){this.beforeHideFunction&&this.beforeHideFunction(),this.container.visible=!1,this.afterHideFunction&&this.afterHideFunction()}},{key:"onBeforeShow",value:function(e){"function"==typeof e&&(this.beforeShowFunction=e)}},{key:"onAfterShow",value:function(e){"function"==typeof e&&(this.afterShowFunction=e)}},{key:"onBeforeHide",value:function(e){"function"==typeof e&&(this.beforeHideFunction=e)}},{key:"onAfterHide",value:function(e){"function"==typeof e&&(this.afterHideFunction=e)}},{key:"isVisible",value:function(){return this.container.visible}},{key:"getOptions",value:function(){return this.options}},{key:"destroy",value:function(){this.container.destroy(!0)}},{key:"px",value:function(e){return this.sdkOptions.width/640*e}},{key:"render",value:function(){}}])&&rd(e.prototype,t),r&&rd(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,r}(),od={set:function(e,t,r){return r instanceof id?"_"!==t[0]?Reflect.set(e,t,r):e.hasOwnProperty(t)?void 0!==e[t]?(n.bv.notify({type:n.By.WARNING,message:"You can't overwrite service component '".concat(t,"' (components that begin with a '_' character)"),emitter:n.JK.COMPONENTS_SYSTEM}),!1):Reflect.set(e,t,r):(n.bv.notify({type:n.By.WARNING,message:"The component ID('".concat(t,"') cannot begin with the character '_', this case reserved for service components."),emitter:n.JK.COMPONENTS_SYSTEM}),!1):(n.bv.notify({type:n.By.WARNING,message:"Wrong assigned value",emitter:n.JK.COMPONENTS_SYSTEM}),!1)},get:function(e,t,r){if("_getSortedComponentsArr"===t){var n=[],i=[];return Object.keys(e).forEach((function(t){e[t]&&("_"===t[0]?i.push(e[t]):n.push(e[t]))})),n.concat(i)}return Reflect.get(e,t,r)}},ad=r(6739);function sd(e){return sd="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},sd(e)}function ud(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ld(n.key),n)}}function ld(e){var t=function(e,t){if("object"!=sd(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=sd(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==sd(t)?t:t+""}var hd=function(){return e=function e(t,r,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.sprite=c.Sprite.from(t),this.sprite.width=null!=r?r:this.sprite.texture.baseTexture.width,this.sprite.height=null!=n?n:this.sprite.texture.baseTexture.height,this.ratio=this.sprite.width/this.sprite.height},t=[{key:"destroy",value:function(){var e,t;null===(t=null===(e=this.sprite)||void 0===e?void 0:e.texture)||void 0===t||t.destroy(!0)}}],t&&ud(e.prototype,t),r&&ud(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,r}();function cd(){cd=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,i=Object.defineProperty||function(e,t,r){e[t]=r.value},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function l(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,r){return e[t]=r}}function h(e,t,r,n){var o=t&&t.prototype instanceof g?t:g,a=Object.create(o.prototype),s=new k(n||[]);return i(a,"_invoke",{value:O(e,r,s)}),a}function c(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=h;var f="suspendedStart",d="suspendedYield",p="executing",y="completed",m={};function g(){}function w(){}function v(){}var b={};l(b,a,(function(){return this}));var x=Object.getPrototypeOf,_=x&&x(x(C([])));_&&_!==r&&n.call(_,a)&&(b=_);var S=v.prototype=g.prototype=Object.create(b);function T(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function E(e,t){function r(i,o,a,s){var u=c(e[i],e,o);if("throw"!==u.type){var l=u.arg,h=l.value;return h&&"object"==_d(h)&&n.call(h,"__await")?t.resolve(h.__await).then((function(e){r("next",e,a,s)}),(function(e){r("throw",e,a,s)})):t.resolve(h).then((function(e){l.value=e,a(l)}),(function(e){return r("throw",e,a,s)}))}s(u.arg)}var o;i(this,"_invoke",{value:function(e,n){function i(){return new t((function(t,i){r(e,n,t,i)}))}return o=o?o.then(i,i):i()}})}function O(t,r,n){var i=f;return function(o,a){if(i===p)throw Error("Generator is already running");if(i===y){if("throw"===o)throw a;return{value:e,done:!0}}for(n.method=o,n.arg=a;;){var s=n.delegate;if(s){var u=A(s,n);if(u){if(u===m)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===f)throw i=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i=p;var l=c(t,r,n);if("normal"===l.type){if(i=n.done?y:d,l.arg===m)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(i=y,n.method="throw",n.arg=l.arg)}}}function A(t,r){var n=r.method,i=t.iterator[n];if(i===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,A(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),m;var o=c(i,t.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,m;var a=o.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,m):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,m)}function I(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function P(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function k(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(I,this),this.reset(!0)}function C(t){if(t||""===t){var r=t[a];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,o=function r(){for(;++i<t.length;)if(n.call(t,i))return r.value=t[i],r.done=!1,r;return r.value=e,r.done=!0,r};return o.next=o}}throw new TypeError(_d(t)+" is not iterable")}return w.prototype=v,i(S,"constructor",{value:v,configurable:!0}),i(v,"constructor",{value:w,configurable:!0}),w.displayName=l(v,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===w||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,v):(e.__proto__=v,l(e,u,"GeneratorFunction")),e.prototype=Object.create(S),e},t.awrap=function(e){return{__await:e}},T(E.prototype),l(E.prototype,s,(function(){return this})),t.AsyncIterator=E,t.async=function(e,r,n,i,o){void 0===o&&(o=Promise);var a=new E(h(e,r,n,i),o);return t.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},T(S),l(S,u,"Generator"),l(S,a,(function(){return this})),l(S,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=C,k.prototype={constructor:k,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(P),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function i(n,i){return s.type="throw",s.arg=t,r.next=n,i&&(r.method="next",r.arg=e),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),l=n.call(a,"finallyLoc");if(u&&l){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return i(a.catchLoc,!0)}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,m):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),P(r),m}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;P(r)}return i}}throw Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:C(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),m}},t}function fd(e,t,r,n,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void r(e)}s.done?t(u):Promise.resolve(u).then(n,i)}function dd(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var o=e.apply(t,r);function a(e){fd(o,n,i,a,s,"next",e)}function s(e){fd(o,n,i,a,s,"throw",e)}a(void 0)}))}}function pd(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,yd(n.key),n)}}function yd(e){var t=function(e,t){if("object"!=_d(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=_d(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==_d(t)?t:t+""}function md(e,t,r){return t=bd(t),function(e,t){if(t&&("object"==_d(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,gd()?Reflect.construct(t,r||[],bd(e).constructor):t.apply(e,r))}function gd(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(gd=function(){return!!e})()}function wd(e,t,r,n){var i=vd(bd(1&n?e.prototype:e),t,r);return 2&n&&"function"==typeof i?function(e){return i.apply(r,e)}:i}function vd(){return vd="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=function(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=bd(e)););return e}(e,t);if(n){var i=Object.getOwnPropertyDescriptor(n,t);return i.get?i.get.call(arguments.length<3?e:r):i.value}},vd.apply(null,arguments)}function bd(e){return bd=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},bd(e)}function xd(e,t){return xd=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},xd(e,t)}function _d(e){return _d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_d(e)}var Sd=function(e,t,r,n){var i,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"===("undefined"==typeof Reflect?"undefined":_d(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a},Td=function(e,t){if("object"===("undefined"==typeof Reflect?"undefined":_d(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},Ed=function(e){function t(e,r){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=md(this,t,[e,r])).isVideo=!1,n.hide(),n.render(),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&xd(e,t)}(t,e),r=t,i=[{key:"render",value:function(){var e=this;this.container.removeChildren(),this.defaultOverlaySprite=new hd(c.Texture.WHITE,1920,1280),this.initOverlayFromUrl(this.options).finally((function(){return e.setOverlayImage()}))}},{key:"show",value:function(){this.switchVideoTexture(!0),wd(t,"show",this,3)([])}},{key:"hide",value:function(){wd(t,"hide",this,3)([]),this.switchVideoTexture(!1)}},{key:"initOverlayFromUrl",value:(u=dd(cd().mark((function e(t){return cd().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.loadImage(null==t?void 0:t.url).then((function(){var e;return null===(e=null==t?void 0:t.promise)||void 0===e?void 0:e.resolve()})).catch((function(e){var r;return null===(r=null==t?void 0:t.promise)||void 0===r?void 0:r.reject(e)})).finally((function(){return null==t||delete t.promise})));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return u.apply(this,arguments)})},{key:"setOptions",value:(s=dd(cd().mark((function e(t){return cd().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return");case 2:this.loadImage(t.url).then((function(){var e;return null===(e=t.promise)||void 0===e?void 0:e.resolve()})).catch((function(e){var r;return null===(r=t.promise)||void 0===r?void 0:r.reject(e)})).finally((function(){return null==t||delete t.promise}));case 3:case"end":return e.stop()}}),e,this)}))),function(e){return s.apply(this,arguments)})},{key:"setOverlayImage",value:function(){var e,t=null!==(e=this.loadedOverlaySprite)&&void 0!==e?e:this.defaultOverlaySprite,r=t.sprite,n=t.ratio,i=this.sdkOptions.width,o=this.sdkOptions.height,a=i/o-n,s=r.width;r.width=a>0?i:i-i*a,r.height=r.height*r.width/s,r.anchor.set(.5-i/r.width/2,.5-o/r.height/2),this.container.addChild(r)}},{key:"loadImage",value:(a=dd(cd().mark((function e(t){var r=this;return cd().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}throw new Error("Invalid url");case 2:if(this.currentURL!==t&&this.processedURL!==t){e.next=4;break}throw new Error("Same url");case 4:return this.processedURL=t,e.next=7,fetch(t,{method:"HEAD"}).then((function(e){if(!e.ok)throw new Error("Overlay Screen: Image loading error")})).catch((function(e){throw n.bv.notify({type:n.By.WARNING,message:'OverlayScreen image loading error [url = "'.concat(t,'"]. Error: ').concat(e),emitter:n.JK.COMPONENTS_SYSTEM,cause:e}),new Error("Overlay Screen: Image loading error")}));case 7:c.Texture.fromURL(t,{resourceOptions:{autoPlay:!1}}).then((function(e){var n,i;r.isVideo=(null===(n=e.baseTexture.resource)||void 0===n?void 0:n.source)instanceof HTMLVideoElement,r.resource=e.baseTexture.resource,r.isVideo&&(r.resource.source.loop=!0,r.resource.source.autoplay=!1,r.container.visible&&r.resource.source.play(),r.resource.source.loop=!0,r.resource.source.muted=!0),r.container.removeChildren(),null===(i=r.loadedOverlaySprite)||void 0===i||i.destroy(),r.loadedOverlaySprite=new hd(e),r.currentURL=t})).catch((function(e){throw n.bv.notify({type:n.By.WARNING,message:'OverlayScreen image loading error [url = "'.concat(t,'"]. Error: ').concat(e),emitter:n.JK.COMPONENTS_SYSTEM,cause:e}),new Error("Overlay Screen: Image loading error")})).finally((function(){r.setOverlayImage(),r.processedURL=""}));case 8:case"end":return e.stop()}}),e,this)}))),function(e){return a.apply(this,arguments)})},{key:"switchVideoTexture",value:function(e){if(this.isVideo)return e?(this.resource.source.currentTime=0,void this.resource.source.play()):void this.resource.source.pause()}}],i&&pd(r.prototype,i),o&&pd(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,i,o,a,s,u}(id);function Od(e){return Od="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Od(e)}function Ad(){Ad=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,i=Object.defineProperty||function(e,t,r){e[t]=r.value},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function l(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,r){return e[t]=r}}function h(e,t,r,n){var o=t&&t.prototype instanceof g?t:g,a=Object.create(o.prototype),s=new k(n||[]);return i(a,"_invoke",{value:O(e,r,s)}),a}function c(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=h;var f="suspendedStart",d="suspendedYield",p="executing",y="completed",m={};function g(){}function w(){}function v(){}var b={};l(b,a,(function(){return this}));var x=Object.getPrototypeOf,_=x&&x(x(C([])));_&&_!==r&&n.call(_,a)&&(b=_);var S=v.prototype=g.prototype=Object.create(b);function T(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function E(e,t){function r(i,o,a,s){var u=c(e[i],e,o);if("throw"!==u.type){var l=u.arg,h=l.value;return h&&"object"==Od(h)&&n.call(h,"__await")?t.resolve(h.__await).then((function(e){r("next",e,a,s)}),(function(e){r("throw",e,a,s)})):t.resolve(h).then((function(e){l.value=e,a(l)}),(function(e){return r("throw",e,a,s)}))}s(u.arg)}var o;i(this,"_invoke",{value:function(e,n){function i(){return new t((function(t,i){r(e,n,t,i)}))}return o=o?o.then(i,i):i()}})}function O(t,r,n){var i=f;return function(o,a){if(i===p)throw Error("Generator is already running");if(i===y){if("throw"===o)throw a;return{value:e,done:!0}}for(n.method=o,n.arg=a;;){var s=n.delegate;if(s){var u=A(s,n);if(u){if(u===m)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===f)throw i=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i=p;var l=c(t,r,n);if("normal"===l.type){if(i=n.done?y:d,l.arg===m)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(i=y,n.method="throw",n.arg=l.arg)}}}function A(t,r){var n=r.method,i=t.iterator[n];if(i===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,A(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),m;var o=c(i,t.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,m;var a=o.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,m):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,m)}function I(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function P(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function k(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(I,this),this.reset(!0)}function C(t){if(t||""===t){var r=t[a];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,o=function r(){for(;++i<t.length;)if(n.call(t,i))return r.value=t[i],r.done=!1,r;return r.value=e,r.done=!0,r};return o.next=o}}throw new TypeError(Od(t)+" is not iterable")}return w.prototype=v,i(S,"constructor",{value:v,configurable:!0}),i(v,"constructor",{value:w,configurable:!0}),w.displayName=l(v,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===w||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,v):(e.__proto__=v,l(e,u,"GeneratorFunction")),e.prototype=Object.create(S),e},t.awrap=function(e){return{__await:e}},T(E.prototype),l(E.prototype,s,(function(){return this})),t.AsyncIterator=E,t.async=function(e,r,n,i,o){void 0===o&&(o=Promise);var a=new E(h(e,r,n,i),o);return t.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},T(S),l(S,u,"Generator"),l(S,a,(function(){return this})),l(S,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=C,k.prototype={constructor:k,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(P),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function i(n,i){return s.type="throw",s.arg=t,r.next=n,i&&(r.method="next",r.arg=e),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),l=n.call(a,"finallyLoc");if(u&&l){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return i(a.catchLoc,!0)}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,m):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),P(r),m}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;P(r)}return i}}throw Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:C(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),m}},t}function Id(e,t,r,n,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void r(e)}s.done?t(u):Promise.resolve(u).then(n,i)}function Pd(e){return kd.apply(this,arguments)}function kd(){var e;return e=Ad().mark((function e(t){return Ad().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(t,{method:"HEAD"});case 2:if(e.sent.ok){e.next=5;break}throw new Error("Url is not available");case 5:return e.abrupt("return",!0);case 6:case"end":return e.stop()}}),e)})),kd=function(){var t=this,r=arguments;return new Promise((function(n,i){var o=e.apply(t,r);function a(e){Id(o,n,i,a,s,"next",e)}function s(e){Id(o,n,i,a,s,"throw",e)}a(void 0)}))},kd.apply(this,arguments)}function Cd(e){return Cd="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Cd(e)}function $d(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Rd(n.key),n)}}function Rd(e){var t=function(e,t){if("object"!=Cd(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=Cd(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Cd(t)?t:t+""}Sd([(0,ad.kc)("overlayScreen"),Td("design:type",Function),Td("design:paramtypes",[]),Td("design:returntype",void 0)],Ed.prototype,"show",null),Sd([(0,ad.kc)("overlayScreen"),Td("design:type",Function),Td("design:paramtypes",[]),Td("design:returntype",void 0)],Ed.prototype,"hide",null);var Dd=function(){return e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)},r=[{key:"calcPosition",value:function(e,t,r,n){return"custom"===r.placement?this.getCustomPosition(e,t,r.x,r.y):this.getPositionFromPlacement(e,t,r.placement,n)}},{key:"getPositionFromPlacement",value:function(e,t,r,n){var i=n.height,o=n.width,a=e,s=t,u={x:0,y:0};return"center"==r?(u.x=(a-o)/2,u.y=(s-i)/2,u):(r.endsWith("right")&&(u.x=a-o),r.startsWith("bottom")&&(u.y=s-i),u)}},{key:"getCustomPosition",value:function(e,t,r,n){return{x:e*r,y:t*n}}}],(t=null)&&$d(e.prototype,t),r&&$d(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,r}();function Md(e){return Md="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Md(e)}function Ld(){Ld=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,i=Object.defineProperty||function(e,t,r){e[t]=r.value},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function l(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,r){return e[t]=r}}function h(e,t,r,n){var o=t&&t.prototype instanceof g?t:g,a=Object.create(o.prototype),s=new k(n||[]);return i(a,"_invoke",{value:O(e,r,s)}),a}function c(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=h;var f="suspendedStart",d="suspendedYield",p="executing",y="completed",m={};function g(){}function w(){}function v(){}var b={};l(b,a,(function(){return this}));var x=Object.getPrototypeOf,_=x&&x(x(C([])));_&&_!==r&&n.call(_,a)&&(b=_);var S=v.prototype=g.prototype=Object.create(b);function T(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function E(e,t){function r(i,o,a,s){var u=c(e[i],e,o);if("throw"!==u.type){var l=u.arg,h=l.value;return h&&"object"==Md(h)&&n.call(h,"__await")?t.resolve(h.__await).then((function(e){r("next",e,a,s)}),(function(e){r("throw",e,a,s)})):t.resolve(h).then((function(e){l.value=e,a(l)}),(function(e){return r("throw",e,a,s)}))}s(u.arg)}var o;i(this,"_invoke",{value:function(e,n){function i(){return new t((function(t,i){r(e,n,t,i)}))}return o=o?o.then(i,i):i()}})}function O(t,r,n){var i=f;return function(o,a){if(i===p)throw Error("Generator is already running");if(i===y){if("throw"===o)throw a;return{value:e,done:!0}}for(n.method=o,n.arg=a;;){var s=n.delegate;if(s){var u=A(s,n);if(u){if(u===m)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===f)throw i=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i=p;var l=c(t,r,n);if("normal"===l.type){if(i=n.done?y:d,l.arg===m)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(i=y,n.method="throw",n.arg=l.arg)}}}function A(t,r){var n=r.method,i=t.iterator[n];if(i===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,A(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),m;var o=c(i,t.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,m;var a=o.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,m):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,m)}function I(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function P(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function k(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(I,this),this.reset(!0)}function C(t){if(t||""===t){var r=t[a];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,o=function r(){for(;++i<t.length;)if(n.call(t,i))return r.value=t[i],r.done=!1,r;return r.value=e,r.done=!0,r};return o.next=o}}throw new TypeError(Md(t)+" is not iterable")}return w.prototype=v,i(S,"constructor",{value:v,configurable:!0}),i(v,"constructor",{value:w,configurable:!0}),w.displayName=l(v,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===w||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,v):(e.__proto__=v,l(e,u,"GeneratorFunction")),e.prototype=Object.create(S),e},t.awrap=function(e){return{__await:e}},T(E.prototype),l(E.prototype,s,(function(){return this})),t.AsyncIterator=E,t.async=function(e,r,n,i,o){void 0===o&&(o=Promise);var a=new E(h(e,r,n,i),o);return t.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},T(S),l(S,u,"Generator"),l(S,a,(function(){return this})),l(S,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=C,k.prototype={constructor:k,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(P),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function i(n,i){return s.type="throw",s.arg=t,r.next=n,i&&(r.method="next",r.arg=e),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),l=n.call(a,"finallyLoc");if(u&&l){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return i(a.catchLoc,!0)}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,m):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),P(r),m}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;P(r)}return i}}throw Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:C(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),m}},t}function Bd(e,t,r,n,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void r(e)}s.done?t(u):Promise.resolve(u).then(n,i)}function Nd(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Fd(n.key),n)}}function Fd(e){var t=function(e,t){if("object"!=Md(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=Md(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Md(t)?t:t+""}function Ud(e,t,r){return t=zd(t),function(e,t){if(t&&("object"==Md(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,jd()?Reflect.construct(t,r||[],zd(e).constructor):t.apply(e,r))}function jd(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(jd=function(){return!!e})()}function zd(e){return zd=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},zd(e)}function Gd(e,t){return Gd=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Gd(e,t)}var Vd=function(e){function t(e,r){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=Ud(this,t,[e])).sprite=new c.Sprite,n.sprite.visible=!1,n.container.addChild(n.sprite),n.setOptions(Object.assign({url:"",position:{placement:"top-left",x:0,y:0},size:.05},r)),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Gd(e,t)}(t,e),r=t,i=[{key:"setOptions",value:function(e){(null==e?void 0:e.size)&&this.setSize(e.size),(null==e?void 0:e.position)&&this.setPosition(e.position),(null==e?void 0:e.url)&&this.setURL(e.url)}},{key:"setURL",value:(a=Ld().mark((function e(t){var r=this;return Ld().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.options.url!==t){e.next=2;break}return e.abrupt("return");case 2:return e.abrupt("return",Pd(t).then((function(){return c.Texture.fromURL(t)})).then((function(e){r.sprite.visible=!0,r.sprite.texture=e,r.sprite.height=r.sdkOptions.height*r.options.size,r.sprite.width=e.width/e.height*r.sprite.height,r.options.url=t,r.sprite.visible=!0})).catch((function(e){var t;n.bv.notify({message:null!==(t=null==e?void 0:e.message)&&void 0!==t?t:e,type:n.By.ERROR,emitter:n.JK.COMPONENTS_SYSTEM,cause:e})})));case 3:case"end":return e.stop()}}),e,this)})),s=function(){var e=this,t=arguments;return new Promise((function(r,n){var i=a.apply(e,t);function o(e){Bd(i,r,n,o,s,"next",e)}function s(e){Bd(i,r,n,o,s,"throw",e)}o(void 0)}))},function(e){return s.apply(this,arguments)})},{key:"setSize",value:function(e){this.options.size=Math.min(1,Math.max(.01,e));var t=this.sprite.width/this.sprite.height;this.sprite.height=this.sdkOptions.height*this.options.size,this.sprite.width=this.sprite.height*t,this.options.position&&"custom"!==this.options.position.placement&&this.setPosition(this.options.position)}},{key:"setPosition",value:function(e){this.options.position=e;var t={width:this.sprite.width,height:this.sprite.height},r=Dd.calcPosition(this.sdkOptions.width,this.sdkOptions.height,e,t),n=r.x,i=r.y;this.sprite.position.x=n,this.sprite.position.y=i}},{key:"clear",value:function(){this.sprite.visible=!1}},{key:"render",value:function(){this.setSize(this.options.size),this.setPosition(this.options.position)}}],i&&Nd(r.prototype,i),o&&Nd(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,i,o,a,s}(id);function Wd(e){return Wd="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Wd(e)}function Hd(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,qd(n.key),n)}}function qd(e){var t=function(e,t){if("object"!=Wd(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=Wd(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Wd(t)?t:t+""}var Yd=function(){return e=function e(t,r){var n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.sdkOptions=t,this.sprite=r.sprite,this.id=r.id,this.player=r.player,this.canvas=r.canvas,this.aminationPhase=null!==(n=r.aminationPhase)&&void 0!==n?n:"static",this.sprite.alpha=0,this.shrink=Math.max(0,Math.min(1,r.shrink)),this.sourceRatio=this.sprite.texture.baseTexture.width/this.sprite.texture.baseTexture.height,this.setSpriteSize(r.size),this.sprite.height=this.height*this.shrink,this.sprite.width=this.width*this.shrink},(t=[{key:"isShowing",value:function(){return"showing"===this.aminationPhase}},{key:"isStatic",value:function(){return"static"===this.aminationPhase}},{key:"isHidingStop",value:function(){return 0===this.sprite.alpha}},{key:"animateAlpha",value:function(e){this.isStatic()||(this.sprite.alpha=this.isShowing()?Math.min(this.sprite.alpha+e,1):Math.max(this.sprite.alpha-e,0),1!==this.sprite.alpha&&0!==this.sprite.alpha||(this.aminationPhase="static"))}},{key:"animateSize",value:function(e){if(!this.isStatic()){var t=this.height*e*(1-this.shrink),r=this.width*e*(1-this.shrink);this.sprite.height=this.isShowing()?Math.min(this.sprite.height+t,this.height):Math.max(this.sprite.height-t,this.height*this.shrink),this.sprite.width=this.isShowing()?Math.min(this.sprite.width+r,this.width):Math.max(this.sprite.width-r,this.width*this.shrink)}}},{key:"animatePosition",value:function(e){this.isStatic()||(this.sprite.position.x=e.x+(this.width-this.sprite.width)/2,this.sprite.position.y=e.y+(this.height-this.sprite.height)/2)}},{key:"reset",value:function(){this.sprite.height=this.height*this.shrink,this.sprite.width=this.width*this.shrink,this.sprite.alpha=0}},{key:"setSpriteSize",value:function(e){this.height=this.sdkOptions.height*(null!=e?e:.3),this.width=this.height*this.sourceRatio,this.sprite.height=this.height,this.sprite.width=this.width}}])&&Hd(e.prototype,t),r&&Hd(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,r}(),Xd=r(3161),Kd=r.n(Xd);function Zd(){Zd=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,i=Object.defineProperty||function(e,t,r){e[t]=r.value},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function l(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,r){return e[t]=r}}function h(e,t,r,n){var o=t&&t.prototype instanceof g?t:g,a=Object.create(o.prototype),s=new k(n||[]);return i(a,"_invoke",{value:O(e,r,s)}),a}function c(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=h;var f="suspendedStart",d="suspendedYield",p="executing",y="completed",m={};function g(){}function w(){}function v(){}var b={};l(b,a,(function(){return this}));var x=Object.getPrototypeOf,_=x&&x(x(C([])));_&&_!==r&&n.call(_,a)&&(b=_);var S=v.prototype=g.prototype=Object.create(b);function T(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function E(e,t){function r(i,o,a,s){var u=c(e[i],e,o);if("throw"!==u.type){var l=u.arg,h=l.value;return h&&"object"==up(h)&&n.call(h,"__await")?t.resolve(h.__await).then((function(e){r("next",e,a,s)}),(function(e){r("throw",e,a,s)})):t.resolve(h).then((function(e){l.value=e,a(l)}),(function(e){return r("throw",e,a,s)}))}s(u.arg)}var o;i(this,"_invoke",{value:function(e,n){function i(){return new t((function(t,i){r(e,n,t,i)}))}return o=o?o.then(i,i):i()}})}function O(t,r,n){var i=f;return function(o,a){if(i===p)throw Error("Generator is already running");if(i===y){if("throw"===o)throw a;return{value:e,done:!0}}for(n.method=o,n.arg=a;;){var s=n.delegate;if(s){var u=A(s,n);if(u){if(u===m)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===f)throw i=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i=p;var l=c(t,r,n);if("normal"===l.type){if(i=n.done?y:d,l.arg===m)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(i=y,n.method="throw",n.arg=l.arg)}}}function A(t,r){var n=r.method,i=t.iterator[n];if(i===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,A(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),m;var o=c(i,t.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,m;var a=o.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,m):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,m)}function I(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function P(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function k(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(I,this),this.reset(!0)}function C(t){if(t||""===t){var r=t[a];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,o=function r(){for(;++i<t.length;)if(n.call(t,i))return r.value=t[i],r.done=!1,r;return r.value=e,r.done=!0,r};return o.next=o}}throw new TypeError(up(t)+" is not iterable")}return w.prototype=v,i(S,"constructor",{value:v,configurable:!0}),i(v,"constructor",{value:w,configurable:!0}),w.displayName=l(v,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===w||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,v):(e.__proto__=v,l(e,u,"GeneratorFunction")),e.prototype=Object.create(S),e},t.awrap=function(e){return{__await:e}},T(E.prototype),l(E.prototype,s,(function(){return this})),t.AsyncIterator=E,t.async=function(e,r,n,i,o){void 0===o&&(o=Promise);var a=new E(h(e,r,n,i),o);return t.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},T(S),l(S,u,"Generator"),l(S,a,(function(){return this})),l(S,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=C,k.prototype={constructor:k,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(P),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function i(n,i){return s.type="throw",s.arg=t,r.next=n,i&&(r.method="next",r.arg=e),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),l=n.call(a,"finallyLoc");if(u&&l){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return i(a.catchLoc,!0)}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,m):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),P(r),m}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;P(r)}return i}}throw Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:C(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),m}},t}function Jd(e,t,r,n,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void r(e)}s.done?t(u):Promise.resolve(u).then(n,i)}function Qd(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var o=e.apply(t,r);function a(e){Jd(o,n,i,a,s,"next",e)}function s(e){Jd(o,n,i,a,s,"throw",e)}a(void 0)}))}}function ep(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,tp(n.key),n)}}function tp(e){var t=function(e,t){if("object"!=up(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=up(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==up(t)?t:t+""}function rp(e,t,r){return t=ap(t),function(e,t){if(t&&("object"==up(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,np()?Reflect.construct(t,r||[],ap(e).constructor):t.apply(e,r))}function np(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(np=function(){return!!e})()}function ip(e,t,r,n){var i=op(ap(1&n?e.prototype:e),t,r);return 2&n&&"function"==typeof i?function(e){return i.apply(r,e)}:i}function op(){return op="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=function(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=ap(e)););return e}(e,t);if(n){var i=Object.getOwnPropertyDescriptor(n,t);return i.get?i.get.call(arguments.length<3?e:r):i.value}},op.apply(null,arguments)}function ap(e){return ap=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},ap(e)}function sp(e,t){return sp=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},sp(e,t)}function up(e){return up="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},up(e)}var lp=function(e,t,r,n){var i,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"===("undefined"==typeof Reflect?"undefined":up(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a},hp=function(e,t){if("object"===("undefined"==typeof Reflect?"undefined":up(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},cp=function(e){function t(e){var r,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(r=rp(this,t,[e,Object.assign({capacity:8,duration:1500,animationSpeed:.08,position:{x:0,y:0,placement:"top-left"}},n)])).spriteStore=[],r.ticker=new c.Ticker,r.ticker.add((function(){return r.animateSticker()})),r.hide(),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&sp(e,t)}(t,e),r=t,n=[{key:"show",value:function(){ip(t,"show",this,3)([]),this.ticker.start()}},{key:"hide",value:function(){ip(t,"hide",this,3)([]),this.ticker.stop()}},{key:"onLoadSucccess",value:function(e){var t="function"==typeof e;this.loadSuccesssFunc=t?e:void 0}},{key:"onLoadError",value:function(e){var t="function"==typeof e;this.loadErrorFunc=t?e:void 0}},{key:"setOptions",value:(a=Qd(Zd().mark((function e(r){return Zd().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r){e.next=2;break}return e.abrupt("return");case 2:r.position&&(this.updateSpritePosition(r.position),delete r.position),r.sticker&&(this.addSticker(r.sticker),delete r.sticker),r.id&&(this.selectSticker(r.id),delete r.id),ip(t,"setOptions",this,3)([r]),r.size&&this.activeSticker&&this.activeSticker.setSpriteSize(r.size),r.duration&&this.activeSticker&&!this.activeSticker.isHidingStop()&&this.setOptions({id:this.activeID});case 8:case"end":return e.stop()}}),e,this)}))),function(e){return a.apply(this,arguments)})},{key:"selectSticker",value:function(e){var t,r,n=this;if(e===this.activeID)return 0===this.activeSticker.sprite.alpha&&this.show(),this.activeSticker.aminationPhase="showing",clearTimeout(this.timerId),void(this.timerId=setTimeout((function(){return n.activeSticker.aminationPhase="hiding"}),this.options.duration));this.activeSticker&&(this.container.removeChildren(),null===(t=this.activeSticker.player)||void 0===t||t.stop(),this.activeSticker.reset()),this.activeID=e;var i=this.spriteStore.find((function(e){return e.id===n.activeID}));i&&(null===(r=i.player)||void 0===r||r.play(),i.sprite.position.x=this.options.position.x,i.sprite.position.y=this.options.position.y,i.aminationPhase="showing",this.container.addChild(i.sprite),this.activeSticker=i,this.activeSticker.setSpriteSize(this.options.size),this.calcPosition(),clearTimeout(this.timerId),this.show(),this.timerId=setTimeout((function(){n.activeSticker.aminationPhase="hiding"}),this.options.duration))}},{key:"loadSticker",value:(o=Qd(Zd().mark((function e(t){var r,n,i,o,a,s,u,l,h,f=arguments;return Zd().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=f.length>1&&void 0!==f[1]&&f[1],i=void 0,o=void 0,a=void 0,e.next=6,fp(t);case 6:if(!e.sent){e.next=16;break}return e.t0=c.Sprite,e.next=11,c.Texture.fromURL(t);case 11:e.t1=e.sent,(a=new e.t0(e.t1)).texture.baseTexture.resource.source.loop=!0,e.next=35;break;case 16:return e.next=18,fetch(t).then((function(e){return e.arrayBuffer()})).catch((function(e){throw console.log("[ Stickers component ] - url fetching: ".concat(e)),e}));case 18:if(s=e.sent,!((u=Kd()(s))instanceof Error)){e.next=28;break}return e.t2=c.Sprite,e.next=24,c.Texture.fromURL(t);case 24:e.t3=e.sent,a=new e.t2(e.t3),e.next=35;break;case 28:return(i=document.createElement("canvas")).width=u.width,i.height=u.height,e.next=33,u.getPlayer(i.getContext("2d",{willReadFrequently:!0}),!0);case 33:o=e.sent,a=new c.Sprite(c.Texture.from(i));case 35:return this.spriteStore.push(new Yd(this.sdkOptions,{id:t,sprite:a,player:o,canvas:i,shrink:.99,size:this.options.size})),r||this.setOptions({id:t}),l={},this.spriteStore.length>this.options.capacity&&(h=this.spriteStore.shift(),l.removedID=null==h?void 0:h.id,null==h||h.sprite.destroy(!0),null===(n=null==h?void 0:h.canvas)||void 0===n||n.remove()),e.abrupt("return",l);case 40:case"end":return e.stop()}}),e,this)}))),function(e){return o.apply(this,arguments)})},{key:"animateSticker",value:function(){var e,t,r;(null===(r=null===(t=null===(e=this.activeSticker)||void 0===e?void 0:e.sprite)||void 0===t?void 0:t.texture)||void 0===r?void 0:r.baseTexture)&&(this.activeSticker.animateSize(this.options.animationSpeed),this.activeSticker.animatePosition(this.options.position),this.activeSticker.animateAlpha(this.options.animationSpeed),this.activeSticker.isHidingStop()?this.hide():this.activeSticker.sprite.texture.update())}},{key:"updateSpritePosition",value:function(e){var t;this.options.position||(this.options.position={});var r=this.sdkOptions.width,n=this.sdkOptions.height;e.x&&(this.options.position.x=r*e.x),e.y&&(this.options.position.y=n*e.y),e.placement&&(this.options.position.placement=e.placement),(null===(t=this.activeSticker)||void 0===t?void 0:t.sprite)&&(this.calcPosition(),this.activeSticker.sprite.position.x=this.options.position.x,this.activeSticker.sprite.position.y=this.options.position.y)}},{key:"addSticker",value:function(e){var t=this,r=function(r){var n,i;"function"==typeof(null===(n=null==e?void 0:e.promise)||void 0===n?void 0:n.resolve)&&(null===(i=null==e?void 0:e.promise)||void 0===i||i.resolve(r)),"function"==typeof t.loadSuccesssFunc&&t.loadSuccesssFunc(e.url,null==r?void 0:r.removedID)};this.spriteStore.some((function(t){return t.id===e.url}))?r():this.loadSticker(e.url,null==e?void 0:e.silenceMode).then(r).catch((function(r){var n,i;"function"==typeof(null===(n=null==e?void 0:e.promise)||void 0===n?void 0:n.reject)&&(null===(i=null==e?void 0:e.promise)||void 0===i||i.reject(r)),"function"==typeof t.loadErrorFunc&&t.loadErrorFunc(e.url)}))}},{key:"calcPosition",value:function(){if("custom"!==this.options.position.placement&&this.options.position.placement){var e=this.sdkOptions.width-this.activeSticker.width,t=this.sdkOptions.height-this.activeSticker.height;if("center"===this.options.position.placement)return this.options.position.x=.5*e,void(this.options.position.y=.5*t);this.options.position.x=~this.options.position.placement.indexOf("left")?0:e,this.options.position.y=~this.options.position.placement.indexOf("top")?0:t}}}],n&&ep(r.prototype,n),i&&ep(r,i),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,i,o,a}(id);function fp(e){return dp.apply(this,arguments)}function dp(){return(dp=Qd(Zd().mark((function e(t){var r;return Zd().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(t,{method:"HEAD"});case 2:return r=e.sent,e.abrupt("return",!!~r.headers.get("content-type").indexOf("video"));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function pp(){pp=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,i=Object.defineProperty||function(e,t,r){e[t]=r.value},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function l(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,r){return e[t]=r}}function h(e,t,r,n){var o=t&&t.prototype instanceof g?t:g,a=Object.create(o.prototype),s=new k(n||[]);return i(a,"_invoke",{value:O(e,r,s)}),a}function c(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=h;var f="suspendedStart",d="suspendedYield",p="executing",y="completed",m={};function g(){}function w(){}function v(){}var b={};l(b,a,(function(){return this}));var x=Object.getPrototypeOf,_=x&&x(x(C([])));_&&_!==r&&n.call(_,a)&&(b=_);var S=v.prototype=g.prototype=Object.create(b);function T(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function E(e,t){function r(i,o,a,s){var u=c(e[i],e,o);if("throw"!==u.type){var l=u.arg,h=l.value;return h&&"object"==_p(h)&&n.call(h,"__await")?t.resolve(h.__await).then((function(e){r("next",e,a,s)}),(function(e){r("throw",e,a,s)})):t.resolve(h).then((function(e){l.value=e,a(l)}),(function(e){return r("throw",e,a,s)}))}s(u.arg)}var o;i(this,"_invoke",{value:function(e,n){function i(){return new t((function(t,i){r(e,n,t,i)}))}return o=o?o.then(i,i):i()}})}function O(t,r,n){var i=f;return function(o,a){if(i===p)throw Error("Generator is already running");if(i===y){if("throw"===o)throw a;return{value:e,done:!0}}for(n.method=o,n.arg=a;;){var s=n.delegate;if(s){var u=A(s,n);if(u){if(u===m)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===f)throw i=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i=p;var l=c(t,r,n);if("normal"===l.type){if(i=n.done?y:d,l.arg===m)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(i=y,n.method="throw",n.arg=l.arg)}}}function A(t,r){var n=r.method,i=t.iterator[n];if(i===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,A(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),m;var o=c(i,t.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,m;var a=o.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,m):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,m)}function I(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function P(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function k(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(I,this),this.reset(!0)}function C(t){if(t||""===t){var r=t[a];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,o=function r(){for(;++i<t.length;)if(n.call(t,i))return r.value=t[i],r.done=!1,r;return r.value=e,r.done=!0,r};return o.next=o}}throw new TypeError(_p(t)+" is not iterable")}return w.prototype=v,i(S,"constructor",{value:v,configurable:!0}),i(v,"constructor",{value:w,configurable:!0}),w.displayName=l(v,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===w||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,v):(e.__proto__=v,l(e,u,"GeneratorFunction")),e.prototype=Object.create(S),e},t.awrap=function(e){return{__await:e}},T(E.prototype),l(E.prototype,s,(function(){return this})),t.AsyncIterator=E,t.async=function(e,r,n,i,o){void 0===o&&(o=Promise);var a=new E(h(e,r,n,i),o);return t.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},T(S),l(S,u,"Generator"),l(S,a,(function(){return this})),l(S,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=C,k.prototype={constructor:k,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(P),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function i(n,i){return s.type="throw",s.arg=t,r.next=n,i&&(r.method="next",r.arg=e),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),l=n.call(a,"finallyLoc");if(u&&l){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return i(a.catchLoc,!0)}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,m):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),P(r),m}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;P(r)}return i}}throw Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:C(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),m}},t}function yp(e,t,r,n,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void r(e)}s.done?t(u):Promise.resolve(u).then(n,i)}function mp(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,gp(n.key),n)}}function gp(e){var t=function(e,t){if("object"!=_p(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=_p(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==_p(t)?t:t+""}function wp(e,t,r){return t=bp(t),function(e,t){if(t&&("object"==_p(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,vp()?Reflect.construct(t,r||[],bp(e).constructor):t.apply(e,r))}function vp(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(vp=function(){return!!e})()}function bp(e){return bp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},bp(e)}function xp(e,t){return xp=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},xp(e,t)}function _p(e){return _p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_p(e)}lp([(0,ad.kc)(),hp("design:type",Function),hp("design:paramtypes",[String]),hp("design:returntype",void 0)],cp.prototype,"selectSticker",null);var Sp=function(e,t,r,n){var i,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"===("undefined"==typeof Reflect?"undefined":_p(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a},Tp=function(e,t){if("object"===("undefined"==typeof Reflect?"undefined":_p(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},Ep=function(e){function t(e,r){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=wp(this,t,[e])).fonts={},n.isShowing=!1,n.isHiding=!1,n.options={position:{x:0,y:0,placement:"bottom-left"},color:{primary:33777,secondary:16777215,text:1118481},offset:{x:0,y:0},text:{title:"LowerThird Title",subtitle:"LowerThird Subtitle",maxLengthTitle:10,maxLengthSubtitle:100}},n.setOptions(r,!1),n.ticker=new c.Ticker,n.container.visible=!1,n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&xp(e,t)}(t,e),r=t,i=[{key:"render",value:function(){}},{key:"setOptions",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];e&&(this.setColor(e.color),this.setOffset(e.offset),this.setPosition(e.position),this.setText(e.text),t&&this.render())}},{key:"showLowerThird",value:function(){this.stopHiding(),"function"==typeof this.showFunction&&(this.ticker.add(this.showFunction),this.ticker.started||this.ticker.start(),this.isShowing=!0)}},{key:"hideLowerThird",value:function(){this.stopShowing(),"function"==typeof this.hideFunction&&(this.isHiding=!0,this.ticker.add(this.hideFunction),this.ticker.started||this.ticker.start())}},{key:"stopShowing",value:function(){this.ticker.started&&this.ticker.stop(),this.ticker.remove(this.showFunction),this.isShowing=!1}},{key:"stopHiding",value:function(){this.ticker.started&&this.ticker.stop(),this.ticker.remove(this.hideFunction),this.isHiding=!1}},{key:"setColor",value:function(e){var t=this;e&&Object.keys(e).forEach((function(r){t.options.color[r]=e[r]}))}},{key:"setOffset",value:function(e){var t=this;e&&Object.keys(e).forEach((function(r){t.options.offset[r]=Math.min(.25,Math.max(0,e[r]))}))}},{key:"setPosition",value:function(e){var t=this;e&&Object.keys(e).forEach((function(r){t.options.position[r]=e[r]}))}},{key:"setText",value:function(e){var t=this;e&&Object.keys(e).forEach((function(r){t.options.text[r]=e[r]}))}},{key:"offsetX",value:function(){var e;return this.sdkOptions.width*(null!==(e=this.options.offset.x)&&void 0!==e?e:0)}},{key:"offsetY",value:function(){var e;return this.sdkOptions.height*(null!==(e=this.options.offset.y)&&void 0!==e?e:0)}},{key:"strTrimAndEllipsis",value:function(e,t){return(e=e.trim()).length<t?e:e.substring(0,t-3)+"..."}},{key:"showOffset",value:function(){var e=new c.Graphics;e.lineStyle({color:14550873,width:1}).drawRect(this.offsetX(),this.offsetY(),this.sdkOptions.width-2*this.offsetX(),this.sdkOptions.height-2*this.offsetY()),this.container.addChild(e)}},{key:"drawRectPrimary",value:function(e,t,r,n){var i=new c.Graphics;return i.beginFill(this.options.color.primary).drawRect(e,t,r,n).endFill(),i}},{key:"drawRectSecondary",value:function(e,t,r,n){var i=new c.Graphics;return i.beginFill(this.options.color.secondary).drawRect(e,t,r,n).endFill(),i}},{key:"fontFamily",value:function(e){var t;return null!==(t=this.fonts[e])&&void 0!==t?t:"Arial, Helvetica, sans-serif"}},{key:"loadFont",value:(a=pp().mark((function e(t,r){var i=this;return pp().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c.Assets.load(r).then((function(e){i.fonts[t]||(i.fonts[t]=[]),i.fonts[t].push('"'.concat(e.family.replace(/[\\"]/g,"\\$&"),'"'))})).catch((function(e){n.bv.notify({type:n.By.WARNING,message:"LowerThird font loading. ".concat(e),cause:e,emitter:n.JK.COMPONENTS_SYSTEM})}));case 2:case"end":return e.stop()}}),e)})),s=function(){var e=this,t=arguments;return new Promise((function(r,n){var i=a.apply(e,t);function o(e){yp(i,r,n,o,s,"next",e)}function s(e){yp(i,r,n,o,s,"throw",e)}o(void 0)}))},function(e,t){return s.apply(this,arguments)})},{key:"destroy",value:function(){var e;this.stopShowing(),this.stopHiding(),this.hide(),null===(e=this.container)||void 0===e||e.destroy(!0)}}],i&&mp(r.prototype,i),o&&mp(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,i,o,a,s}(id);function Op(e){return Op="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Op(e)}function Ap(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Ip(n.key),n)}}function Ip(e){var t=function(e,t){if("object"!=Op(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=Op(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Op(t)?t:t+""}Sp([(0,ad.kc)(),Tp("design:type",Function),Tp("design:paramtypes",[]),Tp("design:returntype",void 0)],Ep.prototype,"showLowerThird",null),Sp([(0,ad.kc)(),Tp("design:type",Function),Tp("design:paramtypes",[]),Tp("design:returntype",void 0)],Ep.prototype,"hideLowerThird",null);var Pp=function(){return e=function e(t){var r,n,i,o,a,s;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.startValue=t.startValue,this.currentValue=t.startValue,this.currentStep=0,this.endValue=null!==(r=t.endValue)&&void 0!==r?r:t.startValue,this.smoothPower=null!==(n=t.smoothPower)&&void 0!==n?n:1,this.range=this.endValue-this.startValue,this.speedNext=null!==(i=t.speedNext)&&void 0!==i?i:1,this.speedBack=null!==(a=null!==(o=t.speedBack)&&void 0!==o?o:t.speedNext)&&void 0!==a?a:1,this.smoothFunctionNext=this.getSmoothFunction(t.smoothFunctionNext),this.smoothFunctionBack=this.getSmoothFunction(null!==(s=t.smoothFunctionBack)&&void 0!==s?s:t.smoothFunctionNext)},(t=[{key:"setCurrentStep",value:function(e){this.currentStep=Math.max(0,Math.min(e,this.smoothPower))}},{key:"getCurrentStep",value:function(){return this.currentStep}},{key:"setEnd",value:function(){return this.currentStep=this.smoothPower,this.endValue}},{key:"isEnd",value:function(e){return this.currentStep>=this.smoothPower*(null!=e?e:1)}},{key:"isStart",value:function(e){return this.currentStep<=this.smoothPower*(null!=e?e:0)}},{key:"reset",value:function(){this.currentStep=0}},{key:"next",value:function(){if(this.startValue===this.endValue)return this.currentValue;var e=this.currentStep/this.smoothPower,t=this.smoothFunctionNext(e);return this.currentValue=this.startValue+this.range*t,this.currentStep=Math.min(this.smoothPower,this.currentStep+this.speedNext),this.currentValue}},{key:"back",value:function(){if(this.startValue===this.endValue)return this.currentValue;this.currentStep=Math.max(0,this.currentStep-this.speedBack);var e=this.currentStep/this.smoothPower,t=this.smoothFunctionBack(e);return this.currentValue=this.startValue+this.range*t,this.currentValue}},{key:"getSmoothFunction",value:function(e){return function(t){switch(e){case"ease-out-sine":return Math.sin(t*Math.PI/2);case"ease-out-quint":return 1-Math.pow(1-t,5);case"ease-out-cubic":Math.pow(1-t,3);default:return t}}}}])&&Ap(e.prototype,t),r&&Ap(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,r}();function kp(e){return kp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},kp(e)}function Cp(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,$p(n.key),n)}}function $p(e){var t=function(e,t){if("object"!=kp(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=kp(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==kp(t)?t:t+""}function Rp(e,t,r){return t=Mp(t),function(e,t){if(t&&("object"==kp(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,Dp()?Reflect.construct(t,r||[],Mp(e).constructor):t.apply(e,r))}function Dp(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Dp=function(){return!!e})()}function Mp(e){return Mp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Mp(e)}function Lp(e,t){return Lp=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Lp(e,t)}var Bp=function(e){function t(e,r){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=Rp(this,t,[e,r])).animations={},n.smoothPower=65,n.ltContainer=new c.Container,n.container.addChild(n.ltContainer),n.addShowFunction(),n.addHideFunction(),n.render(),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Lp(e,t)}(t,e),r=t,n=[{key:"render",value:function(){var e;null===(e=this.ltContainer)||void 0===e||e.destroy(!0),this.ltContainer=new c.Container,this.ltContainer.position.x=this.offsetX(),this.container.addChild(this.ltContainer),this.createText(),this.addRectangles(),this.addSpriteMask(),this.ltContainer.addChild(this.rectBack),this.ltContainer.addChild(this.rectFront),this.ltContainer.addChild(this.title),this.ltContainer.addChild(this.subtitle)}},{key:"createText",value:function(){var e=this,t=this.sdkOptions.width-2*this.offsetX()-this.px(70),r=function(r,n,i){return{fontFamily:"Trebuchet MS",fontSize:e.px(r),fontWeight:n,fill:i,wordWrapWidth:t,wordWrap:!0,breakWords:!0}};this.subtitle=new c.Text(this.options.text.subtitle,r(12,"400",this.options.color.primary)),this.subtitle.position.x=-this.subtitle.width,this.subtitle.position.y=this.sdkOptions.height-this.offsetY()-this.px(12)-this.subtitle.height,this.animations.subtitle=new Pp({startValue:-this.subtitle.width,endValue:this.px(15),smoothPower:this.smoothPower,smoothFunctionNext:"ease-out-quint",speedBack:1.3}),this.title=new c.Text(this.options.text.title,r(20,"700",1118481)),this.title.width=Math.min(t,this.title.width),this.title.position.x=-this.title.width,this.title.position.y=this.sdkOptions.height-this.offsetY()-this.px(15)-this.subtitle.height-this.title.height,this.animations.title=new Pp({startValue:-this.title.width,endValue:this.px(15),smoothPower:this.smoothPower,smoothFunctionNext:"ease-out-quint",speedBack:1.3}),this.ltWidth=Math.max(this.title.width,this.subtitle.width)+this.px(45),this.ltHeight=this.title.height+this.subtitle.height+this.px(23),this.isVisible()&&(this.title.position.x=this.animations.title.setEnd(),this.subtitle.position.x=this.animations.subtitle.setEnd())}},{key:"addRectangles",value:function(){var e=this.sdkOptions.height-this.offsetY()-this.ltHeight;this.rectBack=(new c.Graphics).beginFill(this.options.color.primary).drawRoundedRect(0,e,this.ltWidth,this.ltHeight,this.px(5)).endFill(),this.animations.rectBack=new Pp({startValue:-this.rectBack.width,endValue:0,smoothPower:this.smoothPower,smoothFunctionNext:"ease-out-quint",speedBack:1.1}),this.rectFront=(new c.Graphics).beginFill(16777215).drawRoundedRect(0,e,this.ltWidth-this.px(15),this.ltHeight,this.px(5)).endFill(),this.rectFront.position.x=-this.ltWidth+this.px(15),this.animations.rectFront=new Pp({startValue:-this.rectFront.width,endValue:0,smoothPower:this.smoothPower,smoothFunctionNext:"ease-out-quint",speedBack:1.1}),this.isVisible()&&(this.rectBack.position.x=this.animations.rectBack.setEnd(),this.rectFront.position.x=this.animations.rectFront.setEnd())}},{key:"addSpriteMask",value:function(){this.mask=new c.Sprite(c.Texture.WHITE),this.mask.width=this.ltWidth,this.mask.height=this.sdkOptions.height,this.ltContainer.addChild(this.mask),this.ltContainer.mask=this.mask}},{key:"addShowFunction",value:function(){var e=this;this.showFunction=function(){e.show(),e.rectBack.position.x=e.animations.rectBack.next(),e.animations.rectBack.isEnd(.3)&&(e.rectFront.position.x=e.animations.rectFront.next()),e.animations.rectBack.isEnd(.8)&&(e.title.position.x=e.animations.title.next()),e.animations.title.isEnd(.3)&&(e.subtitle.position.x=e.animations.subtitle.next()),Object.values(e.animations).reduce((function(e,t){return e&&t.isEnd()}),!0)&&e.stopShowing()}}},{key:"addHideFunction",value:function(){var e=this;this.hideFunction=function(){e.isHiding||(e.stopHiding(),e.hide()),e.subtitle.position.x=e.animations.subtitle.back(),e.title.position.x=e.animations.title.back(),e.rectFront.position.x=e.animations.rectFront.back(),e.rectBack.position.x=e.animations.rectBack.back(),e.isHiding=!e.animations.rectBack.isStart()}}}],n&&Cp(r.prototype,n),i&&Cp(r,i),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,i}(Ep);function Np(e){return Np="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Np(e)}function Fp(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Up(n.key),n)}}function Up(e){var t=function(e,t){if("object"!=Np(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=Np(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Np(t)?t:t+""}function jp(e,t,r){return t=Gp(t),function(e,t){if(t&&("object"==Np(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,zp()?Reflect.construct(t,r||[],Gp(e).constructor):t.apply(e,r))}function zp(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(zp=function(){return!!e})()}function Gp(e){return Gp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Gp(e)}function Vp(e,t){return Vp=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Vp(e,t)}var Wp={cyrillic:"https://fonts.gstatic.com/s/notosans/v28/o-0NIpQlx3QUlC5A4PNjFhdVYNyB1Wk.woff2",latin:"https://fonts.gstatic.com/s/notosans/v28/o-0NIpQlx3QUlC5A4PNjFhdVZNyB.woff2"},Hp={cyrillic:"https://fonts.gstatic.com/s/notosans/v28/o-0NIpQlx3QUlC5A4PNjKhVVYNyB1Wk.woff2",latin:"https://fonts.gstatic.com/s/notosans/v28/o-0NIpQlx3QUlC5A4PNjKhVVZNyB.woff2"},qp=function(e){function t(e,r){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=jp(this,t,[e,r])).isReady=!1,n.animations={},n.smoothPower={title:35,subtitle:35,middleLine:50},n.addShowFunction(),n.addHideFunction(),Promise.all([n.loadFont("title",Wp.cyrillic),n.loadFont("title",Wp.latin),n.loadFont("subtitle",Hp.cyrillic),n.loadFont("subtitle",Hp.latin)]).finally((function(){n.isReady=!0,n.render()})),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Vp(e,t)}(t,e),r=t,n=[{key:"render",value:function(){var e,t;this.container.removeChild(this.middleLine),this.container.removeChild(this.titleContainer),this.container.removeChild(this.subtitleContainer),null===(e=this.titleContainer)||void 0===e||e.destroy(!0),null===(t=this.subtitleContainer)||void 0===t||t.destroy(!0),this.createText(),this.createRectangles(),this.container.addChild(this.middleLine),this.container.addChild(this.titleContainer),this.container.addChild(this.subtitleContainer)}},{key:"createText",value:function(){this.title=new c.Text(this.options.text.title,{fontFamily:this.fontFamily("title"),fontSize:this.px(35),fill:16777215,wordWrapWidth:this.sdkOptions.width-2*this.offsetX(),wordWrap:!0,breakWords:!0,align:"right"}),this.title.position.x=0,this.title.position.y=this.title.height,this.titleContainer=new c.Container,this.titleContainer.width=this.title.width,this.titleContainer.height=this.title.height+this.px(200);var e=new c.Sprite(c.Texture.WHITE);e.tint=0,e.width=this.title.width,e.height=this.title.height,e.position.x=0,e.position.y=0,this.titleContainer.addChild(e),this.titleContainer.mask=e,this.titleContainer.addChild(this.title),this.animations.title=new Pp({startValue:this.title.position.y,endValue:0,smoothPower:this.smoothPower.title,smoothFunctionNext:"ease-out-quint"}),this.subtitle=new c.Text(this.options.text.subtitle,{fontFamily:this.fontFamily("subtitle"),fontSize:this.px(13),fontWeight:"100",fill:16777215,wordWrapWidth:this.sdkOptions.width-2*this.offsetX(),wordWrap:!0,breakWords:!0,align:"right"}),this.subtitle.position.x=0,this.subtitle.position.y=-this.subtitle.height-this.px(20),this.subtitleContainer=new c.Container,this.subtitleContainer.width=this.subtitle.width,this.subtitleContainer.height=this.subtitle.height+this.px(20);var t=new c.Sprite(c.Texture.WHITE);t.tint=0,t.width=this.subtitle.width,t.height=this.subtitle.height,t.position.x=0,t.position.y=0,this.subtitleContainer.addChild(t),this.subtitleContainer.mask=t,this.subtitleContainer.addChild(this.subtitle),this.animations.subtitle=new Pp({startValue:this.subtitle.position.y,smoothPower:this.smoothPower.subtitle,endValue:0,smoothFunctionNext:"ease-out-quint"}),this.ltWidth=Math.max(this.title.width,this.subtitle.width)+this.px(25),this.ltHeight=this.titleContainer.height+this.subtitleContainer.height+this.px(10),this.titleContainer.position.x=this.offsetX(),this.subtitleContainer.position.x=this.offsetX();var r=this.titleContainer.width-this.subtitleContainer.width;r>0?this.subtitleContainer.position.x+=r:this.titleContainer.position.x-=r,this.titleContainer.position.y=this.sdkOptions.height-this.offsetY()-this.ltHeight,this.subtitleContainer.position.y=this.sdkOptions.height-this.offsetY()-this.subtitleContainer.height,this.isVisible()&&(this.title.position.y=0,this.subtitle.position.y=0,this.animations.title.setCurrentStep(this.smoothPower.title),this.animations.subtitle.setCurrentStep(this.smoothPower.subtitle))}},{key:"createRectangles",value:function(){this.middleLine=new c.Graphics;var e=this.ltWidth+this.offsetX(),t=this.sdkOptions.height-this.offsetY()-this.subtitleContainer.height-this.px(8);this.middleLine.beginFill(this.options.color.primary).drawRoundedRect(-e-this.px(2),t,e,this.px(3),this.px(2)).endFill(),this.animations.middleLine=new Pp({startValue:0,smoothPower:this.smoothPower.middleLine,endValue:e,smoothFunctionNext:"ease-out-quint"}),this.isVisible()&&(this.middleLine.position.x=e,this.animations.middleLine.setCurrentStep(this.smoothPower.middleLine))}},{key:"addShowFunction",value:function(){var e=this;this.showFunction=function(){e.isReady&&(e.show(),e.middleLine.position.x=e.animations.middleLine.next(),e.animations.middleLine.isEnd(.5)&&(e.title.position.y=e.animations.title.next()),e.animations.middleLine.isEnd(.5)&&(e.subtitle.position.y=e.animations.subtitle.next()),Object.values(e.animations).reduce((function(e,t){return e&&t.isEnd()}),!0)&&e.stopShowing())}}},{key:"addHideFunction",value:function(){var e=this;this.hideFunction=function(){if(!e.isHiding)return e.stopHiding(),void e.hide();e.title.position.y=e.animations.title.back(),e.subtitle.position.y=e.animations.subtitle.back(),e.animations.title.isStart(.7)&&(e.middleLine.position.x=e.animations.middleLine.back()),e.isHiding=!Object.values(e.animations).reduce((function(e,t){return e&&t.isStart()}),!0)}}}],n&&Fp(r.prototype,n),i&&Fp(r,i),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,i}(Ep);function Yp(e){return Yp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Yp(e)}function Xp(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Kp(n.key),n)}}function Kp(e){var t=function(e,t){if("object"!=Yp(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=Yp(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Yp(t)?t:t+""}function Zp(e,t,r){return t=Qp(t),function(e,t){if(t&&("object"==Yp(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,Jp()?Reflect.construct(t,r||[],Qp(e).constructor):t.apply(e,r))}function Jp(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Jp=function(){return!!e})()}function Qp(e){return Qp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Qp(e)}function ey(e,t){return ey=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},ey(e,t)}var ty={cyrillic:"https://fonts.gstatic.com/s/montserrat/v25/JTUHjIg1_i6t8kCHKm4532VJOt5-QNFgpCvr73w9aXpsog.woff2",latin:"https://fonts.gstatic.com/s/montserrat/v25/JTUHjIg1_i6t8kCHKm4532VJOt5-QNFgpCvr73w5aXo.woff2"},ry={cyrillic:"https://fonts.gstatic.com/s/montserrat/v25/JTUHjIg1_i6t8kCHKm4532VJOt5-QNFgpCvr6Hw9aXpsog.woff2",latin:"https://fonts.gstatic.com/s/montserrat/v25/JTUHjIg1_i6t8kCHKm4532VJOt5-QNFgpCvr6Hw5aXo.woff2"},ny=function(e){function t(e,r){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=Zp(this,t,[e,r])).titleFontSize=35,n.animations={},n.isReady=!1,n.smoothPower={title:95,subtitle:95,titleRect:75,titleTextMask:75,titleRectMask:75,rectFront:40,rectBack:40},n.addShowFunction(),n.addHideFunction(),Promise.all([n.loadFont("title",ty.cyrillic),n.loadFont("title",ty.latin),n.loadFont("subtitle",ry.cyrillic),n.loadFont("subtitle",ry.latin)]).finally((function(){n.isReady=!0,n.render()})),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ey(e,t)}(t,e),r=t,n=[{key:"render",value:function(){var e,t,r;this.container.removeChild(this.titleContainer),this.container.removeChild(this.subtitleContainer),this.container.removeChild(this.vertLineContainer),null===(e=this.titleContainer)||void 0===e||e.destroy(!0),null===(t=this.subtitleContainer)||void 0===t||t.destroy(!0),null===(r=this.vertLineContainer)||void 0===r||r.destroy(!0),this.createSubtitle(),this.createTitle(),this.createRectangles(),this.container.addChild(this.titleContainer),this.container.addChild(this.subtitleContainer),this.container.addChild(this.vertLineContainer)}},{key:"createTitle",value:function(){var e;this.title=new c.Text(null===(e=this.options.text.title)||void 0===e?void 0:e.toUpperCase(),{fontFamily:this.fontFamily("title"),fontSize:this.px(this.titleFontSize),fill:16777215,wordWrapWidth:this.sdkOptions.width-2*this.offsetX(),wordWrap:!0,breakWords:!0,lineHeight:this.px(this.titleFontSize)}),this.title.position.x=.3*this.title.width,this.animations.title=new Pp({startValue:this.title.position.x,endValue:this.px(10),smoothPower:this.smoothPower.title,smoothFunctionNext:"ease-out-quint",speedBack:1.3});var t=new c.Container;t.width=this.title.width+this.px(10),t.height=this.title.height,t.addChild(this.title),this.titleTextMask=new c.Sprite(c.Texture.WHITE),this.titleTextMask.width=0,this.titleTextMask.height=this.title.height,t.addChild(this.titleTextMask),t.mask=this.titleTextMask,this.animations.titleTextMask=new Pp({startValue:0,endValue:this.title.width+this.px(10),smoothPower:this.smoothPower.titleTextMask,smoothFunctionNext:"ease-out-quint",speedBack:1.25}),this.titleRect=this.drawRectSecondary(0,this.px(this.titleFontSize/3.5),this.title.width,this.title.height-this.px(this.titleFontSize/2.2)),this.animations.titleRect=new Pp({startValue:.2*-this.title.width,endValue:this.title.width+this.px(35),smoothPower:this.smoothPower.titleRect,smoothFunctionNext:"ease-out-quint",speedNext:.5,speedBack:1.1});var r=new c.Container;r.width=this.titleRect.width,r.height=this.titleRect.height,r.addChild(this.titleRect),this.titleRectMask=new c.Sprite(c.Texture.WHITE),this.titleRectMask.width=0,this.titleRectMask.height=this.title.height,r.addChild(this.titleRectMask),r.mask=this.titleRectMask,this.animations.titleRectMask=new Pp({startValue:0,endValue:this.title.width+this.px(35),smoothPower:this.smoothPower.titleRectMask,smoothFunctionNext:"ease-out-quint",speedNext:1.5,speedBack:1}),this.titleContainer=new c.Container,this.titleContainer.width=this.title.width+this.px(10),this.titleContainer.height=this.title.height,this.titleContainer.addChild(t),this.titleContainer.addChild(r),this.ltHeight=this.title.height+this.subtitleContainer.height,this.titleContainer.position.x=this.offsetX(),this.titleContainer.position.y=this.sdkOptions.height-this.offsetY()-this.ltHeight+this.px(3),this.isVisible()&&(this.title.position.x=this.animations.title.setEnd(),this.titleTextMask.width=this.animations.titleTextMask.setEnd(),this.titleRect.position.x=this.animations.titleRect.setEnd(),this.titleRectMask.width=this.animations.titleRectMask.setEnd())}},{key:"createSubtitle",value:function(){var e;this.subtitle=new c.Text(null===(e=this.options.text.subtitle)||void 0===e?void 0:e.toUpperCase(),{fontFamily:this.fontFamily("subtitle"),fontSize:this.px(11),fill:16777215,wordWrapWidth:this.sdkOptions.width-2*this.offsetX(),wordWrap:!0,breakWords:!0}),this.subtitle.position.x=-this.subtitle.width,this.animations.subtitle=new Pp({startValue:this.subtitle.position.x,endValue:this.px(11),smoothPower:this.smoothPower.subtitle,smoothFunctionNext:"ease-out-quint",speedBack:1.2}),this.subtitleContainer=new c.Container,this.subtitleContainer.width=this.subtitle.width+this.px(10),this.subtitleContainer.height=this.subtitle.height,this.subtitleContainer.addChild(this.subtitle),this.subtitleContainer.position.x=this.offsetX(),this.subtitleContainer.position.y=this.sdkOptions.height-this.offsetY()-this.subtitle.height;var t=new c.Sprite(c.Texture.WHITE);t.width=this.subtitle.width+this.px(10),t.height=this.subtitle.height,this.subtitleContainer.addChild(t),this.subtitleContainer.mask=t,this.isVisible()&&(this.subtitle.position.x=this.animations.subtitle.setEnd())}},{key:"createRectangles",value:function(){var e=this.title.height-this.px(this.titleFontSize/2.2);this.rectFront=this.drawRectPrimary(0,0,this.px(4),e),this.animations.rectFront=new Pp({startValue:e,endValue:0,smoothPower:this.smoothPower.rectFront,smoothFunctionNext:"ease-out-quint",speedNext:.8,speedBack:1}),this.rectBack=this.drawRectSecondary(0,0,this.px(4),this.px(4)),this.animations.rectBack=new Pp({startValue:e,endValue:-this.px(4),smoothPower:this.smoothPower.rectFront,smoothFunctionNext:"ease-out-quint",speedNext:1.5,speedBack:.6}),this.vertLineContainer=new c.Container,this.vertLineContainer.width=this.rectFront.width,this.vertLineContainer.height=e,this.vertLineContainer.addChild(this.rectBack),this.vertLineContainer.addChild(this.rectFront),this.vertLineContainer.position.x=this.offsetX(),this.vertLineContainer.position.y=this.titleContainer.position.y+this.px(this.titleFontSize/3.5);var t=new c.Sprite(c.Texture.WHITE);t.width=this.vertLineContainer.width,t.height=e,this.vertLineContainer.addChild(t),this.vertLineContainer.mask=t,this.isVisible()&&(this.rectFront.position.y=this.animations.rectFront.setEnd())}},{key:"addShowFunction",value:function(){var e=this;this.showFunction=function(){e.isReady&&(e.show(),e.rectFront.position.y=e.animations.rectFront.next(),e.rectBack.position.y=e.animations.rectBack.next(),e.animations.rectFront.isEnd(.9)&&(e.title.position.x=e.animations.title.next(),e.subtitle.position.x=e.animations.subtitle.next(),e.titleTextMask.width=e.animations.titleTextMask.next(),e.titleRectMask.width=e.animations.titleRectMask.next(),e.titleRect.position.x=e.animations.titleRect.next(),Object.values(e.animations).reduce((function(e,t){return e&&t.isEnd()}),!0)&&e.stopShowing()))}}},{key:"addHideFunction",value:function(){var e=this;this.hideFunction=function(){if(!e.isHiding)return e.stopHiding(),void e.hide();e.title.position.x=e.animations.title.back(),e.subtitle.position.x=e.animations.subtitle.back(),e.animations.titleRect.getCurrentStep()<e.smoothPower.titleRect-2&&(e.titleTextMask.width=e.animations.titleTextMask.back()),e.titleRect.position.x=e.animations.titleRect.back(),e.titleRectMask.width=e.animations.titleRectMask.back(),e.animations.titleRectMask.isStart(.2)&&(e.rectBack.position.y=e.animations.rectBack.back(),e.rectFront.position.y=e.animations.rectFront.back()),e.isHiding=!Object.values(e.animations).reduce((function(e,t){return e&&t.isStart()}),!0)}}}],n&&Xp(r.prototype,n),i&&Xp(r,i),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,i}(Ep);function iy(e){return iy="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},iy(e)}function oy(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ay(n.key),n)}}function ay(e){var t=function(e,t){if("object"!=iy(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=iy(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==iy(t)?t:t+""}function sy(e,t,r){return t=ly(t),function(e,t){if(t&&("object"==iy(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,uy()?Reflect.construct(t,r||[],ly(e).constructor):t.apply(e,r))}function uy(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(uy=function(){return!!e})()}function ly(e){return ly=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},ly(e)}function hy(e,t){return hy=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},hy(e,t)}var cy={cyrillic:"https://fonts.gstatic.com/s/geologica/v1/oY1l8evIr7j9P3TN9YwNAdyjzUyDKkKdAGOJh1UlCDUIhAIdhCZOn1fLsig7jfvCCPHZckUWF1lEP2A.woff2",latin:"https://fonts.gstatic.com/s/geologica/v1/oY1l8evIr7j9P3TN9YwNAdyjzUyDKkKdAGOJh1UlCDUIhAIdhCZOn1fLsig7jfvCCPHZckUWE1lE.woff2"},fy={cyrillic:"https://fonts.gstatic.com/s/geologica/v1/oY1o8evIr7j9P3TN9YwNAdyjzUyDKkKdAGOJh1UlCDUIhAIdhCZOn1fLsig7jfvCCPHZckU8H3G11_z-_OZqD8Hsc-ASAEWn.woff2",latin:"https://fonts.gstatic.com/s/geologica/v1/oY1o8evIr7j9P3TN9YwNAdyjzUyDKkKdAGOJh1UlCDUIhAIdhCZOn1fLsig7jfvCCPHZckU8H3G11_z-_OZqD8Hsc-QSAA.woff2"},dy=function(e){function t(e,r){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=sy(this,t,[e,r])).animations={},n.isReady=!1,n.smoothPower={title:75,subtitle:65,rectFront:40,rectBack:40},n.addShowFunction(),n.addHideFunction(),Promise.all([n.loadFont("title",cy.cyrillic),n.loadFont("title",cy.latin),n.loadFont("subtitle",fy.cyrillic),n.loadFont("subtitle",fy.latin)]).finally((function(){n.isReady=!0,n.render()})),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&hy(e,t)}(t,e),r=t,n=[{key:"render",value:function(){var e,t;this.container.removeChild(this.titleContainer),this.container.removeChild(this.subtitleContainer),null===(e=this.titleContainer)||void 0===e||e.destroy(!0),null===(t=this.subtitleContainer)||void 0===t||t.destroy(!0),this.createSubtitle(),this.createTitle(),this.createRectangles(),this.container.addChild(this.titleContainer),this.container.addChild(this.subtitleContainer)}},{key:"createSubtitle",value:function(){this.subtitle=new c.Text(this.options.text.subtitle,{fontFamily:this.fontFamily("subtitle"),fontSize:this.px(13),fill:16777215,wordWrapWidth:this.sdkOptions.width-2*this.offsetX(),wordWrap:!0,breakWords:!0});var e=this.subtitle.width+this.px(6);this.subtitle.position.x=-this.subtitle.width,this.subtitle.position.y=this.px(3),this.animations.subtitle=new Pp({startValue:this.subtitle.position.x,endValue:this.px(10),smoothPower:this.smoothPower.subtitle,smoothFunctionNext:"ease-out-quint"}),this.subtitleContainer=new c.Container,this.subtitleContainer.width=e,this.subtitleContainer.height=this.subtitle.height+this.px(6),this.subtitleContainer.position.x=this.offsetX(),this.subtitleContainer.position.y=this.sdkOptions.height-this.offsetY()-this.subtitle.height-this.px(6),this.isVisible()&&(this.subtitle.position.x=this.animations.subtitle.setEnd())}},{key:"createTitle",value:function(){this.title=new c.Text(this.options.text.title,{fontFamily:this.fontFamily("title"),fontSize:this.px(30),fill:16777215,wordWrapWidth:this.sdkOptions.width-2*this.offsetX(),wordWrap:!0,breakWords:!0}),this.title.position.y=this.title.height,this.animations.title=new Pp({startValue:this.title.position.y,endValue:0,smoothPower:this.smoothPower.title,smoothFunctionNext:"ease-out-quint"});var e=new c.Sprite(c.Texture.WHITE);e.width=this.title.width,e.height=this.title.height,this.titleContainer=new c.Container,this.titleContainer.width=this.title.width,this.titleContainer.height=this.title.height,this.titleContainer.addChild(this.title),this.titleContainer.addChild(e),this.titleContainer.mask=e,this.ltWidth=Math.max(this.title.width,this.subtitle.width+this.px(15)),this.ltHeight=this.title.height+this.subtitle.height,this.titleContainer.position.x=this.offsetX(),this.titleContainer.position.y=this.sdkOptions.height-this.offsetY()-this.ltHeight-this.px(6),this.isVisible()&&(this.title.position.y=this.animations.title.setEnd())}},{key:"createRectangles",value:function(){var e=this.subtitle.height+this.px(6),t=this.ltWidth;this.rectFront=this.drawRectPrimary(0,0,t,e),this.rectFront.position.x=-t,this.animations.rectFront=new Pp({startValue:-t,endValue:0,smoothPower:this.smoothPower.rectFront,smoothFunctionNext:"ease-out-quint"}),this.rectBack=this.drawRectSecondary(0,0,t,e),this.rectBack.position.x=t,this.animations.rectBack=new Pp({startValue:t,endValue:0,smoothPower:this.smoothPower.rectFront,smoothFunctionNext:"ease-out-quint"});var r=new c.Sprite(c.Texture.WHITE);r.width=t,r.height=this.subtitle.height+this.px(6),this.subtitleContainer.addChild(r),this.subtitleContainer.mask=r,this.subtitleContainer.addChild(this.rectBack),this.subtitleContainer.addChild(this.rectFront),this.subtitleContainer.addChild(this.subtitle),this.isVisible()&&(this.rectFront.position.x=this.animations.rectFront.setEnd(),this.rectBack.position.x=this.animations.rectBack.setEnd())}},{key:"addShowFunction",value:function(){var e=this;this.showFunction=function(){e.isReady&&(e.show(),e.rectBack.position.x=e.animations.rectBack.next(),e.animations.rectBack.isEnd()&&(e.rectFront.position.x=e.animations.rectFront.next(),e.animations.rectFront.isEnd(.3)&&(e.subtitle.position.x=e.animations.subtitle.next(),e.title.position.y=e.animations.title.next(),e.animations.title.isEnd()&&e.animations.subtitle.isEnd()&&e.stopShowing())))}}},{key:"addHideFunction",value:function(){var e=this;this.hideFunction=function(){if(!e.isHiding)return e.stopHiding(),void e.hide();e.title.position.y=e.animations.title.back(),e.subtitle.position.x=e.animations.subtitle.back(),e.animations.subtitle.isStart(.5)&&(e.rectFront.position.x=e.animations.rectFront.back(),e.animations.rectFront.isStart()&&(e.rectBack.position.x=e.animations.rectBack.back())),e.isHiding=!Object.values(e.animations).reduce((function(e,t){return e&&t.isStart()}),!0)}}}],n&&oy(r.prototype,n),i&&oy(r,i),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,i}(Ep);function py(e){return py="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},py(e)}function yy(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,my(n.key),n)}}function my(e){var t=function(e,t){if("object"!=py(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=py(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==py(t)?t:t+""}var gy=function(){return e=function e(t,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.padding=20,this.smoothPower=75,this.startRectValue=0,this.sdkOptions=t,this.container=new c.Container,this.addText(r),this.addRect(r),this.addHidden(r);var n=new c.Sprite(c.Texture.WHITE);n.height=this.height,n.width=r.offsetX+this.width,n.position.x=-r.offsetX,this.container.addChild(n),this.container.mask=n,r.isVisible&&(this.text.position.x=this.textInAnimation.setEnd(),this.hiddenMask.position.x=this.hiddenMaskAnimation.setEnd(),this.rect.position.x=this.rectAnimation.setEnd())},t=[{key:"textInAnimateFunction",value:function(){this.text.position.x=this.textInAnimation.next()}},{key:"textOutAnimateFunction",value:function(){this.text.position.x=this.textOutAnimation.next()}},{key:"textResetFunction",value:function(){this.text.position.x=2*this.px(this.padding)+this.width}},{key:"rectAnimateFunction",value:function(e){this.rect.position.x=e?this.rectAnimation.next():this.rectAnimation.back()}},{key:"hiddenMaskAnimateFunction",value:function(e){this.hiddenMask.position.x=e?this.rectAnimation.next():this.rectAnimation.back()}},{key:"destroy",value:function(){var e;null===(e=this.container)||void 0===e||e.destroy(!0)}},{key:"addText",value:function(e){this.text=new c.Text(e.text,{fontFamily:e.fontfamily,fontSize:this.px(e.size),fill:e.colorText,wordWrapWidth:this.sdkOptions.width-2*e.offsetX-2*this.px(this.padding),wordWrap:!0,breakWords:!0}),this.height=1.2*this.text.height,this.width=this.text.width+2*this.px(this.padding);var t=2*this.px(this.padding)+this.width;this.text.position.x=t,this.text.position.y=this.px(e.size/8.5),this.textInAnimation=new Pp({startValue:t,endValue:this.px(this.padding),smoothPower:this.smoothPower,smoothFunctionNext:"ease-out-quint"}),this.textOutAnimation=new Pp({startValue:this.px(this.padding),endValue:-this.width-this.px(this.padding)-e.offsetX,smoothPower:this.smoothPower,smoothFunctionNext:"ease-out-quint"}),this.container.addChild(this.text)}},{key:"addRect",value:function(e){this.rect=(new c.Graphics).beginFill(e.colorRect).drawRect(0,0,this.width,this.height).endFill(),this.startRectValue=-e.offsetX-this.width,this.rect.position.x=this.startRectValue,this.rectAnimation=new Pp({startValue:this.startRectValue,endValue:0,smoothPower:this.smoothPower,smoothFunctionNext:"ease-out-quint"}),this.container.addChild(this.rect)}},{key:"addHidden",value:function(e){this.hiddenMask=new c.Sprite(c.Texture.WHITE),this.hiddenMask.width=this.width,this.hiddenMask.height=this.height,this.hiddenMask.position.x=this.startRectValue,this.hiddenMaskAnimation=new Pp({startValue:this.startRectValue,endValue:0,smoothPower:this.smoothPower,smoothFunctionNext:"ease-out-quint"});var t=new c.Text(e.text,{fontFamily:e.fontfamily,fontSize:this.px(e.size),fill:e.colorTextHidden,wordWrapWidth:this.sdkOptions.width-2*e.offsetX-2*this.px(this.padding),wordWrap:!0,breakWords:!0});this.hiddenContainer=new c.Container,this.hiddenContainer.addChild(t),this.hiddenContainer.position.x=this.px(this.padding),this.hiddenContainer.position.y=this.px(e.size/8.5),this.hiddenContainer.addChild(this.hiddenMask),this.hiddenContainer.mask=this.hiddenMask,this.container.addChild(this.hiddenContainer)}},{key:"px",value:function(e){return this.sdkOptions.width/640*e}}],t&&yy(e.prototype,t),r&&yy(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,r}();function wy(e){return wy="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},wy(e)}function vy(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,by(n.key),n)}}function by(e){var t=function(e,t){if("object"!=wy(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=wy(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==wy(t)?t:t+""}function xy(e,t,r){return t=Sy(t),function(e,t){if(t&&("object"==wy(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,_y()?Reflect.construct(t,r||[],Sy(e).constructor):t.apply(e,r))}function _y(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(_y=function(){return!!e})()}function Sy(e){return Sy=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Sy(e)}function Ty(e,t){return Ty=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Ty(e,t)}var Ey={cyrillic:"https://fonts.gstatic.com/s/geologica/v1/oY1o8evIr7j9P3TN9YwNAdyjzUyDKkKdAGOJh1UlCDUIhAIdhCZOn1fLsig7jfvCCPHZckU8H3G11_z-_OZqD8Hsc-ASAEWn.woff2",latin:"https://fonts.gstatic.com/s/geologica/v1/oY1o8evIr7j9P3TN9YwNAdyjzUyDKkKdAGOJh1UlCDUIhAIdhCZOn1fLsig7jfvCCPHZckU8H3G11_z-_OZqD8Hsc-QSAA.woff2"},Oy={cyrillic:"https://fonts.gstatic.com/s/geologica/v1/oY1o8evIr7j9P3TN9YwNAdyjzUyDKkKdAGOJh1UlCDUIhAIdhCZOn1fLsig7jfvCCPHZckU8H3G11_z-_OZqDx_rc-ASAEWn.woff2",latin:"https://fonts.gstatic.com/s/geologica/v1/oY1o8evIr7j9P3TN9YwNAdyjzUyDKkKdAGOJh1UlCDUIhAIdhCZOn1fLsig7jfvCCPHZckU8H3G11_z-_OZqDx_rc-QSAA.woff2"},Ay=function(e){function t(e,r){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=xy(this,t,[e,r])).isTitleTextShown=!1,n.isTitleRectHidden=!1,n.isSubtitleTextShown=!1,n.isSubtitleRectHidden=!1,n.delay=300,n.gap=3,n.isReady=!1,n.addShowFunction(),n.addHideFunction(),Promise.all([n.loadFont("title",Ey.cyrillic),n.loadFont("title",Ey.latin),n.loadFont("subtitle",Oy.cyrillic),n.loadFont("subtitle",Oy.latin)]).finally((function(){n.isReady=!0,n.render()})),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Ty(e,t)}(t,e),r=t,n=[{key:"render",value:function(){var e,t,r,n;this.container.removeChild(null===(e=this.titleBox)||void 0===e?void 0:e.container),null===(t=this.titleBox)||void 0===t||t.destroy(),this.container.removeChild(null===(r=this.subtitleBox)||void 0===r?void 0:r.container),null===(n=this.subtitleBox)||void 0===n||n.destroy(),this.subtitleBox=new gy(this.sdkOptions,{fontfamily:this.fontFamily("subtitle"),text:this.options.text.subtitle,colorText:this.options.color.primary,colorTextHidden:16777215,colorRect:this.options.color.primary,size:12,isVisible:this.isVisible(),offsetX:this.offsetX()}),this.subtitleBox.container.position.x=this.offsetX(),this.subtitleBox.container.position.y=this.sdkOptions.height-this.offsetY()-this.subtitleBox.height,this.titleBox=new gy(this.sdkOptions,{fontfamily:this.fontFamily("title"),text:this.options.text.title,colorText:this.options.color.primary,colorTextHidden:2236962,colorRect:this.options.color.secondary,size:25,isVisible:this.isVisible(),offsetX:this.offsetX()}),this.titleBox.container.position.x=this.offsetX(),this.titleBox.container.position.y=this.sdkOptions.height-this.offsetY()-this.titleBox.height-this.subtitleBox.height-this.px(this.gap),this.container.addChild(this.titleBox.container),this.container.addChild(this.subtitleBox.container)}},{key:"addShowFunction",value:function(){var e=this;this.showFunction=function(){var t,r;e.isReady&&(e.isTitleRectHidden=!1,e.isSubtitleRectHidden=!1,null===(t=e.titleBox)||void 0===t||t.textOutAnimation.reset(),null===(r=e.subtitleBox)||void 0===r||r.textOutAnimation.reset(),e.show(),e.titleBox.textInAnimateFunction(),e.titleBox.textInAnimation.isEnd(.8)&&setTimeout((function(){return e.isTitleTextShown=!0}),e.delay),e.isTitleTextShown&&(e.titleBox.rectAnimateFunction(!0),e.titleBox.hiddenMaskAnimateFunction(!0)),e.subtitleBox.textInAnimateFunction(),e.subtitleBox.textInAnimation.isEnd(.8)&&setTimeout((function(){e.isSubtitleTextShown=!0}),e.delay),e.isSubtitleTextShown&&(e.subtitleBox.rectAnimateFunction(!0),e.subtitleBox.hiddenMaskAnimateFunction(!0)),e.titleBox.rectAnimation.isEnd()&&e.subtitleBox.rectAnimation.isEnd()&&e.stopShowing())}}},{key:"addHideFunction",value:function(){var e=this;this.hideFunction=function(){if(e.isTitleTextShown=!1,e.isSubtitleTextShown=!1,e.titleBox.textInAnimation.reset(),e.subtitleBox.textInAnimation.reset(),!e.isHiding)return e.stopHiding(),e.hide(),e.titleBox.textResetFunction(),void e.subtitleBox.textResetFunction();e.titleBox.rectAnimateFunction(!1),e.titleBox.hiddenMaskAnimateFunction(!1),e.titleBox.rectAnimation.isStart()&&setTimeout((function(){return e.isTitleRectHidden=!0}),e.delay),e.isTitleRectHidden&&e.titleBox.textOutAnimateFunction(),e.subtitleBox.rectAnimateFunction(!1),e.subtitleBox.hiddenMaskAnimateFunction(!1),e.subtitleBox.rectAnimation.isStart()&&setTimeout((function(){return e.isSubtitleRectHidden=!0}),e.delay),e.isSubtitleRectHidden&&e.subtitleBox.textOutAnimateFunction(),e.isHiding=!e.titleBox.textOutAnimation.isEnd()&&!e.subtitleBox.textOutAnimation.isEnd()}}}],n&&vy(r.prototype,n),i&&vy(r,i),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,i}(Ep);function Iy(e){return Iy="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Iy(e)}function Py(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ky(n.key),n)}}function ky(e){var t=function(e,t){if("object"!=Iy(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=Iy(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Iy(t)?t:t+""}var Cy=function(){return e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.store=new Map},(t=[{key:"setCallback",value:function(e,t){return"function"!=typeof t?(this.store.delete(e),!1):(this.store.set(e,t),!0)}},{key:"getCallback",value:function(e){return this.store.get(e)}},{key:"call",value:function(e){var t=this.store.get(e);if("function"==typeof t)return t()}}])&&Py(e.prototype,t),r&&Py(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,r}(),$y=r(7036),Ry=r(1707),Dy=r.n(Ry);function My(e){return My="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},My(e)}function Ly(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,By(n.key),n)}}function By(e){var t=function(e,t){if("object"!=My(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=My(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==My(t)?t:t+""}var Ny=function(){return e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.state="inactive",this._duration=0,this.timeStart=0},(t=[{key:"duration",get:function(){return"active"===this.state?Date.now()-this.timeStart+this._duration:this._duration}},{key:"start",value:function(){"inactive"===this.state&&(this._duration=0,this.state="active",this.timeStart=Date.now())}},{key:"stop",value:function(){"inactive"!==this.state&&("active"===this.state&&(this._duration=this._duration+Date.now()-this.timeStart),this.state="inactive")}},{key:"pause",value:function(){"active"===this.state&&(this.state="paused",this._duration=this._duration+Date.now()-this.timeStart)}},{key:"resume",value:function(){"paused"===this.state&&(this.state="active",this.timeStart=Date.now())}}])&&Ly(e.prototype,t),r&&Ly(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,r}();function Fy(){Fy=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,i=Object.defineProperty||function(e,t,r){e[t]=r.value},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function l(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,r){return e[t]=r}}function h(e,t,r,n){var o=t&&t.prototype instanceof g?t:g,a=Object.create(o.prototype),s=new k(n||[]);return i(a,"_invoke",{value:O(e,r,s)}),a}function c(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=h;var f="suspendedStart",d="suspendedYield",p="executing",y="completed",m={};function g(){}function w(){}function v(){}var b={};l(b,a,(function(){return this}));var x=Object.getPrototypeOf,_=x&&x(x(C([])));_&&_!==r&&n.call(_,a)&&(b=_);var S=v.prototype=g.prototype=Object.create(b);function T(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function E(e,t){function r(i,o,a,s){var u=c(e[i],e,o);if("throw"!==u.type){var l=u.arg,h=l.value;return h&&"object"==Gy(h)&&n.call(h,"__await")?t.resolve(h.__await).then((function(e){r("next",e,a,s)}),(function(e){r("throw",e,a,s)})):t.resolve(h).then((function(e){l.value=e,a(l)}),(function(e){return r("throw",e,a,s)}))}s(u.arg)}var o;i(this,"_invoke",{value:function(e,n){function i(){return new t((function(t,i){r(e,n,t,i)}))}return o=o?o.then(i,i):i()}})}function O(t,r,n){var i=f;return function(o,a){if(i===p)throw Error("Generator is already running");if(i===y){if("throw"===o)throw a;return{value:e,done:!0}}for(n.method=o,n.arg=a;;){var s=n.delegate;if(s){var u=A(s,n);if(u){if(u===m)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===f)throw i=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i=p;var l=c(t,r,n);if("normal"===l.type){if(i=n.done?y:d,l.arg===m)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(i=y,n.method="throw",n.arg=l.arg)}}}function A(t,r){var n=r.method,i=t.iterator[n];if(i===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,A(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),m;var o=c(i,t.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,m;var a=o.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,m):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,m)}function I(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function P(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function k(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(I,this),this.reset(!0)}function C(t){if(t||""===t){var r=t[a];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,o=function r(){for(;++i<t.length;)if(n.call(t,i))return r.value=t[i],r.done=!1,r;return r.value=e,r.done=!0,r};return o.next=o}}throw new TypeError(Gy(t)+" is not iterable")}return w.prototype=v,i(S,"constructor",{value:v,configurable:!0}),i(v,"constructor",{value:w,configurable:!0}),w.displayName=l(v,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===w||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,v):(e.__proto__=v,l(e,u,"GeneratorFunction")),e.prototype=Object.create(S),e},t.awrap=function(e){return{__await:e}},T(E.prototype),l(E.prototype,s,(function(){return this})),t.AsyncIterator=E,t.async=function(e,r,n,i,o){void 0===o&&(o=Promise);var a=new E(h(e,r,n,i),o);return t.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},T(S),l(S,u,"Generator"),l(S,a,(function(){return this})),l(S,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=C,k.prototype={constructor:k,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(P),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function i(n,i){return s.type="throw",s.arg=t,r.next=n,i&&(r.method="next",r.arg=e),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),l=n.call(a,"finallyLoc");if(u&&l){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return i(a.catchLoc,!0)}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,m):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),P(r),m}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;P(r)}return i}}throw Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:C(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),m}},t}function Uy(e,t,r,n,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void r(e)}s.done?t(u):Promise.resolve(u).then(n,i)}function jy(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,zy(n.key),n)}}function zy(e){var t=function(e,t){if("object"!=Gy(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=Gy(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Gy(t)?t:t+""}function Gy(e){return Gy="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Gy(e)}var Vy=function(e,t,r,n){var i,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"===("undefined"==typeof Reflect?"undefined":Gy(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a},Wy=function(e,t){if("object"===("undefined"==typeof Reflect?"undefined":Gy(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},Hy=function(){return e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.onStartFunction=function(){},this.blobPromise=new $y.P,this.timer=new Ny},t=[{key:"removeTracks",value:function(e){var t=this;this.stream&&("audio"===e?t.stream.getAudioTracks():"video"===e?t.stream.getVideoTracks():t.stream.getTracks()).forEach((function(e){t.stream.removeTrack(e)}))}},{key:"initRecorder",value:function(e){var t=this;this.isActive()&&this.stop(),this.recorder=new MediaRecorder(e,{mimeType:this.mimeType}),this.recorder.ondataavailable=function(e){return t.blobPromise.resolve(e.data)}}},{key:"start",value:function(){return!!this.recorder&&"inactive"===this.recorder.state&&(this.blobPromise.createPromise(),this.recorder.start(),this.timer.start(),this.onStartFunction(),!0)}},{key:"resume",value:function(){return!!this.recorder&&"paused"===this.recorder.state&&(this.recorder.resume(),this.timer.resume(),!0)}},{key:"pause",value:function(){return!!this.recorder&&"recording"===this.recorder.state&&(this.recorder.pause(),this.timer.pause(),!0)}},{key:"stop",value:function(){return!!this.recorder&&"inactive"!==this.recorder.state&&(this.recorder.stop(),this.timer.stop(),!0)}},{key:"getRecord",value:(i=Fy().mark((function e(){var t;return Fy().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("inactive"===this.recorder.state){e.next=2;break}throw"[ recorder ]: Cannot get blob. First you need to stop the record.";case 2:return e.next=4,this.blobPromise.promise;case 4:if(t=e.sent){e.next=7;break}return e.abrupt("return",void 0);case 7:return e.next=9,Dy()(t,this.timer.duration,{logger:!1});case 9:return e.abrupt("return",t);case 10:case"end":return e.stop()}}),e,this)})),o=function(){var e=this,t=arguments;return new Promise((function(r,n){var o=i.apply(e,t);function a(e){Uy(o,r,n,a,s,"next",e)}function s(e){Uy(o,r,n,a,s,"throw",e)}a(void 0)}))},function(){return o.apply(this,arguments)})},{key:"setVideoTrack",value:function(e){e&&(this.removeTracks("video"),this.stream||(this.stream=new MediaStream),this.stream.addTrack(e),this.initRecorder(this.stream))}},{key:"setSDKVideoTrack",value:function(e){this.sdkVideoTrack=e,this.setVideoTrack(e)}},{key:"setAudioTracks",value:function(e){if(0!==e.length){if(this.removeTracks("audio"),this.stream||(this.stream=new MediaStream),1===e.length)return this.stream.addTrack(e[0]),void this.initRecorder(this.stream);var t=new AudioContext,r=t.createMediaStreamDestination();e.forEach((function(e){var n=new MediaStream;n.addTrack(e),t.createMediaStreamSource(n).connect(r)}));var n=r.stream;this.stream.addTrack(n.getAudioTracks()[0]),this.initRecorder(this.stream)}}},{key:"setMimeType",value:function(e){MediaRecorder.isTypeSupported(e)?(this.mimeType=e,this.recorder&&this.stream&&this.initRecorder(this.stream)):n.bv.notify({message:"mimeType ".concat(e," is not supported."),emitter:n.JK.RECORDER})}},{key:"onStart",value:function(e){"function"==typeof e&&(this.onStartFunction=e)}},{key:"isActive",value:function(){var e,t;return"recording"===(null===(e=this.recorder)||void 0===e?void 0:e.state)||"paused"===(null===(t=this.recorder)||void 0===t?void 0:t.state)}},{key:"getDuration",value:function(){return this.timer.duration}},{key:"getSDKTracks",value:function(){return{sdkAudioTrack:this.sdkAudioTrack,sdkVideoTrack:this.sdkVideoTrack}}}],t&&jy(e.prototype,t),r&&jy(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,r,i,o}();Hy=Vy([(0,ad.Y)("recorder"),Wy("design:paramtypes",[])],Hy);var qy=r(2111);function Yy(e){return Yy="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Yy(e)}function Xy(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Ky(n.key),n)}}function Ky(e){var t=function(e,t){if("object"!=Yy(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=Yy(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Yy(t)?t:t+""}function Zy(e,t,r){return t=Qy(t),function(e,t){if(t&&("object"==Yy(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,Jy()?Reflect.construct(t,r||[],Qy(e).constructor):t.apply(e,r))}function Jy(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Jy=function(){return!!e})()}function Qy(e){return Qy=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Qy(e)}function em(e,t){return em=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},em(e,t)}var tm,rm=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=Zy(this,t)).streamWidth=1280,e.streamHeight=720,e.customWidth=1280,e.customHeight=720,e.customSize=!1,e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&em(e,t)}(t,e),r=t,(n=[{key:"setSize",value:function(e,t){var r=!1;this.streamWidth!=e&&(this.streamWidth=e,r=!0),this.streamHeight!=t&&(this.streamHeight=t,r=!0),r&&this.emit("update",this)}},{key:"clearCustomSize",value:function(){this.customSize=!1,this.emit("update",this)}},{key:"setCustomSize",value:function(e,t){this.customSize=!0,this.customHeight=t,this.customWidth=e,this.emit("update",this)}},{key:"isCustomSize",value:function(){return this.customSize}},{key:"width",get:function(){return this.isCustomSize()?this.customWidth:this.streamWidth}},{key:"height",get:function(){return this.isCustomSize()?this.customHeight:this.streamHeight}}])&&Xy(r.prototype,n),i&&Xy(r,i),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,i}(r(4486).b);function nm(e){return function(e){if(Array.isArray(e))return im(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return im(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?im(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function im(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function om(){om=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,i=Object.defineProperty||function(e,t,r){e[t]=r.value},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function l(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,r){return e[t]=r}}function h(e,t,r,n){var o=t&&t.prototype instanceof g?t:g,a=Object.create(o.prototype),s=new k(n||[]);return i(a,"_invoke",{value:O(e,r,s)}),a}function c(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=h;var f="suspendedStart",d="suspendedYield",p="executing",y="completed",m={};function g(){}function w(){}function v(){}var b={};l(b,a,(function(){return this}));var x=Object.getPrototypeOf,_=x&&x(x(C([])));_&&_!==r&&n.call(_,a)&&(b=_);var S=v.prototype=g.prototype=Object.create(b);function T(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function E(e,t){function r(i,o,a,s){var u=c(e[i],e,o);if("throw"!==u.type){var l=u.arg,h=l.value;return h&&"object"==hm(h)&&n.call(h,"__await")?t.resolve(h.__await).then((function(e){r("next",e,a,s)}),(function(e){r("throw",e,a,s)})):t.resolve(h).then((function(e){l.value=e,a(l)}),(function(e){return r("throw",e,a,s)}))}s(u.arg)}var o;i(this,"_invoke",{value:function(e,n){function i(){return new t((function(t,i){r(e,n,t,i)}))}return o=o?o.then(i,i):i()}})}function O(t,r,n){var i=f;return function(o,a){if(i===p)throw Error("Generator is already running");if(i===y){if("throw"===o)throw a;return{value:e,done:!0}}for(n.method=o,n.arg=a;;){var s=n.delegate;if(s){var u=A(s,n);if(u){if(u===m)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===f)throw i=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i=p;var l=c(t,r,n);if("normal"===l.type){if(i=n.done?y:d,l.arg===m)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(i=y,n.method="throw",n.arg=l.arg)}}}function A(t,r){var n=r.method,i=t.iterator[n];if(i===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,A(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),m;var o=c(i,t.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,m;var a=o.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,m):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,m)}function I(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function P(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function k(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(I,this),this.reset(!0)}function C(t){if(t||""===t){var r=t[a];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,o=function r(){for(;++i<t.length;)if(n.call(t,i))return r.value=t[i],r.done=!1,r;return r.value=e,r.done=!0,r};return o.next=o}}throw new TypeError(hm(t)+" is not iterable")}return w.prototype=v,i(S,"constructor",{value:v,configurable:!0}),i(v,"constructor",{value:w,configurable:!0}),w.displayName=l(v,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===w||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,v):(e.__proto__=v,l(e,u,"GeneratorFunction")),e.prototype=Object.create(S),e},t.awrap=function(e){return{__await:e}},T(E.prototype),l(E.prototype,s,(function(){return this})),t.AsyncIterator=E,t.async=function(e,r,n,i,o){void 0===o&&(o=Promise);var a=new E(h(e,r,n,i),o);return t.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},T(S),l(S,u,"Generator"),l(S,a,(function(){return this})),l(S,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=C,k.prototype={constructor:k,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(P),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function i(n,i){return s.type="throw",s.arg=t,r.next=n,i&&(r.method="next",r.arg=e),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),l=n.call(a,"finallyLoc");if(u&&l){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return i(a.catchLoc,!0)}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,m):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),P(r),m}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;P(r)}return i}}throw Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:C(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),m}},t}function am(e,t,r,n,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void r(e)}s.done?t(u):Promise.resolve(u).then(n,i)}function sm(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var o=e.apply(t,r);function a(e){am(o,n,i,a,s,"next",e)}function s(e){am(o,n,i,a,s,"throw",e)}a(void 0)}))}}function um(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,lm(n.key),n)}}function lm(e){var t=function(e,t){if("object"!=hm(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=hm(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==hm(t)?t:t+""}function hm(e){return hm="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},hm(e)}var cm,fm=function(e,t,r,n){var i,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"===("undefined"==typeof Reflect?"undefined":hm(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a},dm=function(e,t){if("object"===("undefined"==typeof Reflect?"undefined":hm(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},pm=function(e,t,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)},ym=function(e,t,r,n,i){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?i.call(e,r):i?i.value=r:t.set(e,r),r},mm=function(){return e=function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.outputFrameFormat="RGBX",this.effects=new Map,this.components=new Proxy({},od),cm.set(this,void 0),this.customer_id=t,Qh.y.CUSTOMER_ID=t,Qh.y.setVersion(),sc.W.getInstance().getUID(this.customer_id),ad.Uz.Instance.setCustomerID(this.customer_id),r&&(this.custom_inference=Kc.getInference("custom"),this.custom_inference.sessionManager.setBackend(r),this.custom_inference.configurePort()),this.onnx_inference=Kc.getInference("onnx"),this.sdkOptions=new rm,this.recorder=new Hy,this.callbackStore=new Cy,this.sdkOptions.on("update",this.onOptionsUpdate,this)},t=[{key:"onOptionsUpdate",value:function(e){Object.values(this.components).forEach((function(e){return e.render()}))}},{key:"createEffectInstance",value:function(e){if(this.effects.has(e))return this.effects.get(e);var t=qy.Z.getEffect(e,this.sdkOptions);return this.effects.set(e,t),t}},{key:"getEffectInstance",value:function(e){return this.effects.has(e)?this.effects.get(e):null}},{key:"getSnapshot",value:(h=sm(om().mark((function e(){return om().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.streamProcessor.getSnapshot());case 1:case"end":return e.stop()}}),e,this)}))),function(){return h.apply(this,arguments)})},{key:"isSupported",value:function(){return function(){if(void 0!==tm)return tm;try{var e=document.createElement("canvas").getContext("webgl2");tm=e instanceof WebGL2RenderingContext}catch(e){tm=!1}return tm}()}},{key:"cache",value:(l=sm(om().mark((function e(){var t=arguments;return om().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t.length>0&&void 0!==t[0]&&t[0])){e.next=4;break}return e.next=4,this.onnx_inference.sessionManager.clearCache();case 4:Qh.y.CACHE_MODELS=!0;case 5:case"end":return e.stop()}}),e,this)}))),function(){return l.apply(this,arguments)})},{key:"clearModelCache",value:(u=sm(om().mark((function e(){return om().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.onnx_inference.sessionManager.clearCache();case 2:case"end":return e.stop()}}),e,this)}))),function(){return u.apply(this,arguments)})},{key:"preload",value:(s=sm(om().mark((function e(){var t,r=this;return om().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Qh.y.EFFECTS.forEach(function(){var e=sm(om().mark((function e(n){var i,o;return om().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=n,e.next=e.t0===qy.U.COLOR_CORRECION?3:e.t0===qy.U.SMART_ZOOM?9:e.t0===qy.U.LOW_LIGHT?15:e.t0===qy.U.VIRTUAL_BACKGROUND?21:28;break;case 3:if(Qh.y.MODELS.colorcorrector){e.next=5;break}return e.abrupt("break",28);case 5:return t={modelPath:Qh.y.getModelUrl(Qh.y.MODELS.colorcorrector),backend:"wasm",nchw:!1},e.next=8,r.onnx_inference.sessionManager.init(t);case 8:case 14:case 20:case 27:return e.abrupt("break",28);case 9:if(Qh.y.MODELS.facedetector){e.next=11;break}return e.abrupt("break",28);case 11:return t={modelPath:Qh.y.getModelUrl(Qh.y.MODELS.facedetector),backend:"wasm",nchw:!1},e.next=14,r.onnx_inference.sessionManager.init(t);case 15:if(Qh.y.MODELS.lowlighter){e.next=17;break}return e.abrupt("break",28);case 17:return t={modelPath:Qh.y.getModelUrl(Qh.y.MODELS.lowlighter),backend:"wasm",nchw:!1},e.next=20,r.onnx_inference.sessionManager.init(t);case 21:return i=r.sdkOptions.width/r.sdkOptions.height>1?"PRESETS":"PRESETS_PORTRAIT",o=(o=Qh.y[i][Qh.y.PRESET])?Qh.y.getPresetUrl(o):Qh.y.MODEL_URL,t={modelPath:o,backend:"wasm"==Qh.y.PROVIDER?"wasm":"webgpu",nchw:!1},e.next=27,r.onnx_inference.sessionManager.init(t);case 28:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 1:case"end":return e.stop()}}),e)}))),function(){return s.apply(this,arguments)})},{key:"config",value:function(e){e.hasOwnProperty("app_env")&&(Qh.y.APP_ENV=e.app_env),e.hasOwnProperty("api_url")&&(Qh.y.API_URL=e.api_url),e.hasOwnProperty("model_url")&&(Qh.y.MODEL_URL=e.model_url),e.hasOwnProperty("sdk_url")&&(Qh.y.SDK_URL=e.sdk_url),e.hasOwnProperty("provider")&&(Qh.y.PROVIDER=e.provider),e.hasOwnProperty("preset")&&(Qh.y.PRESET=e.preset),e.hasOwnProperty("proxy")&&(Qh.y.PROXY=e.proxy),e.hasOwnProperty("stats")&&(Qh.y.STATS=e.stats),e.hasOwnProperty("cache_models")&&(Qh.y.CACHE_MODELS=e.cache_models),e.hasOwnProperty("wasmPaths")&&Object.keys(e.wasmPaths).length&&(Qh.y.WASM_PATHS=Object.assign(Qh.y.WASM_PATHS,e.wasmPaths)),e.hasOwnProperty("presets")&&Object.keys(e.presets).length&&(Qh.y.PRESETS=Object.assign(Qh.y.PRESETS,e.presets)),e.hasOwnProperty("models")&&Object.keys(e.models).length&&(Qh.y.MODELS=Object.assign(Qh.y.MODELS,e.models)),e.hasOwnProperty("effects")&&Object.keys(e.effects).length&&(Qh.y.EFFECTS=nm(e.effects))}},{key:"init",value:(a=sm(om().mark((function e(t){var r;return om().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.aborted){e.next=2;break}return e.abrupt("return");case 2:if(this.streamProcessor&&this.streamProcessor.destroy(),r="requestAnimationFrameCallback","MediaStreamTrackProcessor"in window&&"MediaStreamTrackGenerator"in window?(this.streamProcessor=ye.getStreamProcessor("transform",this.sdkOptions),r="MediaStreamTrackProcessor"):"requestVideoFrameCallback"in HTMLVideoElement.prototype?(this.streamProcessor=ye.getStreamProcessor("videocallback",this.sdkOptions),r="requestVideoFrameCallback"):this.streamProcessor=ye.getStreamProcessor("animationcallback",this.sdkOptions),n.bv.notify({message:"".concat(r," supported"),type:n.By.INFO,emitter:n.JK.TSVB}),this.streamProcessor.onFrameDraw(this.callbackStore.getCallback("onFrameDraw")),this.streamProcessor.onChangeInputResolution(this.callbackStore.getCallback("onChangeInputResolution")),!this._renderer||!this.effectProcessor){e.next=13;break}return this.streamProcessor.setRenderer(this._renderer),this.streamProcessor.useEffectProcessor(this.effectProcessor),this.callbackStore.call("onReady"),e.abrupt("return");case 13:if(this._renderer=new Pf(this.sdkOptions,this.outputFrameFormat),this.streamProcessor.setRenderer(this._renderer),this.effectProcessor=new Jf(this._renderer,this.sdkOptions,this.components),this.effectProcessor.addEffect(this.createEffectInstance(qy.U.CUSTOM_RESOLUTION)),this.effectProcessor.addEffect(this.createEffectInstance(qy.U.MIRRORING)),this.effectProcessor.addEffect(this.createEffectInstance(qy.U.COLOR_FILTERS)),this.effectProcessor.addEffect(this.createEffectInstance(qy.U.SHARPNESS)),this.effectProcessor.addEffect(this.createEffectInstance(qy.U.FILTER_DRAW)),this.effectProcessor.addLastEffect(this.createEffectInstance(qy.U.FINAL_DRAW)),this.streamProcessor.useEffectProcessor(this.effectProcessor),!Qh.y.EFFECTS.includes(qy.U.SMART_ZOOM)){e.next=26;break}return e.next=26,this.loadEffect(qy.U.SMART_ZOOM);case 26:if(!Qh.y.EFFECTS.includes(qy.U.LOW_LIGHT)){e.next=29;break}return e.next=29,this.loadEffect(qy.U.LOW_LIGHT);case 29:if(!Qh.y.EFFECTS.includes(qy.U.COLOR_CORRECION)){e.next=32;break}return e.next=32,this.loadEffect(qy.U.COLOR_CORRECION);case 32:if(!Qh.y.EFFECTS.includes(qy.U.VIRTUAL_BACKGROUND)){e.next=35;break}return e.next=35,this.loadEffect(qy.U.VIRTUAL_BACKGROUND);case 35:this.callbackStore.call("onReady");case 36:case"end":return e.stop()}}),e,this)}))),function(e){return a.apply(this,arguments)})},{key:"loadEffect",value:(o=sm(om().mark((function e(t){var r,n,i,o;return om().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.getEffectInstance(t)){e.next=2;break}return e.abrupt("return");case 2:n=this.createEffectInstance(t),e.t0=t,e.next=e.t0===qy.U.VIRTUAL_BACKGROUND?6:e.t0===qy.U.LOW_LIGHT?12:e.t0===qy.U.SMART_ZOOM||e.t0===qy.U.COLOR_CORRECION?18:22;break;case 6:return e.next=8,n.init(null!==(r=this.custom_inference)&&void 0!==r?r:this.onnx_inference);case 8:return i=this.callbackStore.getCallback("onBackgroundSuccess"),n.onSuccess(i),this.effectProcessor.addEffect(n),e.abrupt("break",22);case 12:return e.next=14,n.init(this.onnx_inference);case 14:return o=this.callbackStore.getCallback("onLowLightSuccess"),n.onSuccess(o),this.effectProcessor.addEffect(n),e.abrupt("break",22);case 18:return e.next=20,n.init(this.onnx_inference);case 20:return this.effectProcessor.addEffect(n),e.abrupt("break",22);case 22:case"end":return e.stop()}}),e,this)}))),function(e){return o.apply(this,arguments)})},{key:"getCustomerId",value:function(){return this.customer_id}},{key:"useStream",value:function(e,t){var r;if(e.getVideoTracks().length){var i=e.getVideoTracks()[0].getSettings();if(t?this.sdkOptions.setCustomSize(t.width,t.height):this.sdkOptions.setSize(i.width,i.height),Object.values(this.components).forEach((function(e){return e.render()})),pm(this,cm,"f")&&pm(this,cm,"f").abort(),ym(this,cm,new AbortController,"f"),this.init(pm(this,cm,"f").signal),this.streamProcessor.useStream(e),this.streamProcessor.getInputVideoTrack()){this.streamProcessor.process();var o=null===(r=this.streamProcessor.getStream())||void 0===r?void 0:r.getVideoTracks()[0];o&&this.recorder.setSDKVideoTrack(o)}else n.bv.notify({message:"There is no input videoTrack to process",type:n.By.ERROR,code:n.O4.NO_VIDEO_TRACK,emitter:n.JK.TSVB})}else n.bv.notify({message:"There is no input videoTrack in the Media Stream",type:n.By.ERROR,code:n.O4.NO_VIDEO_TRACK,emitter:n.JK.TSVB})}},{key:"setSegmentationPreset",value:(i=sm(om().mark((function e(t){var r;return om().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=this.getEffectInstance(qy.U.VIRTUAL_BACKGROUND)){e.next=3;break}return e.abrupt("return",!1);case 3:if(r.isPresetSupported(t)){e.next=6;break}return n.bv.notify({message:"WebGPU backend support only quality and balanced presets",type:n.By.INFO,emitter:n.JK.TSVB}),e.abrupt("return",!1);case 6:return this.effectProcessor.hasFrames?this.effectProcessor.pause():this.streamProcessor.pause(),this.streamProcessor.clearBuffers(),this.streamProcessor.clearBuffers(),e.next=11,r.setPreset(t);case 11:return this.effectProcessor.hasFrames?this.effectProcessor.unpause():this.streamProcessor.unpause(),e.abrupt("return",!0);case 13:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})},{key:"getSegmentationPreset",value:function(){return this.getEffectInstance(qy.U.VIRTUAL_BACKGROUND).getPreset()}},{key:"setBackgroundColor",value:function(e){this.getEffectInstance(qy.U.VIRTUAL_BACKGROUND).setBackgroundColor(e)}},{key:"getStream",value:function(){return this.streamProcessor.getStream()}},{key:"toCanvas",value:function(e){this.streamProcessor.renderToCanvas(e)}},{key:"setFpsLimit",value:function(e){return!!this.streamProcessor&&(this.streamProcessor.setFpsLimit(e),!0)}},{key:"getMetrics",value:function(){return{fps:this.streamProcessor?this.streamProcessor.frameTimer.getFrameFps():0,segmentationInferenceTime:this.effectProcessor?this.effectProcessor.resources.renderer.timinngs.stats.stats.get("inference_time"):0,fullFrameDrawTime:this.effectProcessor?this.effectProcessor.resources.renderer.timinngs.stats.stats.get("frame_time"):0}}},{key:"showFps",value:function(){return!!this.streamProcessor&&(this.streamProcessor.showFps(),!0)}},{key:"hideFps",value:function(){return!!this.streamProcessor&&(this.streamProcessor.hideFps(),!0)}},{key:"freeze",value:function(){return!!this.effectProcessor&&(this.effectProcessor.pause(),!0)}},{key:"unfreeze",value:function(){return!!this.effectProcessor&&(this.effectProcessor.unpause(),!0)}},{key:"enableBeautification",value:function(){var e=this.getEffectInstance(qy.U.VIRTUAL_BACKGROUND);return!!e&&(e.enableBeautification(),!0)}},{key:"disableBeautification",value:function(){var e=this.getEffectInstance(qy.U.VIRTUAL_BACKGROUND);return!!e&&(e.disableBeautification(),!0)}},{key:"setBoundaryMode",value:function(e){var t=this.getEffectInstance(qy.U.VIRTUAL_BACKGROUND);return!!t&&(t.setBoundaryMode(e),!0)}},{key:"setBackgroundFitMode",value:function(e){var t=this.getEffectInstance(qy.U.VIRTUAL_BACKGROUND);return!!t&&(t.setBackgroundFitMode(e),!0)}},{key:"setBoundaryLevel",value:function(e){var t=this.getEffectInstance(qy.U.VIRTUAL_BACKGROUND);return!!t&&(t.setBoundaryLevel(e),!0)}},{key:"setBeautificationLevel",value:function(e){var t=this.getEffectInstance(qy.U.VIRTUAL_BACKGROUND);return!!t&&(t.setBeautificationLevel(e),!0)}},{key:"setBlur",value:function(e){var t=this.getEffectInstance(qy.U.VIRTUAL_BACKGROUND);if(!t)return!1;var r=15*Math.cbrt(this.sdkOptions.height*this.sdkOptions.width)/67;return t.setBlur(Math.round(e*r)),!0}},{key:"clearBlur",value:function(){var e=this.getEffectInstance(qy.U.VIRTUAL_BACKGROUND);return!!e&&(e.clearBlur(),!0)}},{key:"setBackground",value:function(e){var t=this.getEffectInstance(qy.U.VIRTUAL_BACKGROUND);return!!t&&(t.setBackground(e),!0)}},{key:"clearBackground",value:function(){var e=this.getEffectInstance(qy.U.VIRTUAL_BACKGROUND);return!!e&&(e.clearBackground(),!0)}},{key:"enableFrameSkipping",value:function(){var e=this.getEffectInstance(qy.U.VIRTUAL_BACKGROUND);return!!e&&(e.enableFrameSkipping(),!0)}},{key:"disableFrameSkipping",value:function(){var e=this.getEffectInstance(qy.U.VIRTUAL_BACKGROUND);return!!e&&(e.disableFrameSkipping(),!0)}},{key:"setLayout",value:function(e){var t=this.getEffectInstance(qy.U.VIRTUAL_BACKGROUND);return!!t&&(t.setLayout(e),!0)}},{key:"setLayoutMode",value:function(e){var t=this.getEffectInstance(qy.U.VIRTUAL_BACKGROUND);return!!t&&(t.setLayoutMode(e),!0)}},{key:"setCustomLayout",value:function(e){var t=this.getEffectInstance(qy.U.VIRTUAL_BACKGROUND);if(!t)return!1;var r={};return void 0!==e.xOffset&&(r.xOffset=e.xOffset*this.sdkOptions.width),void 0!==e.yOffset&&(r.yOffset=e.yOffset*this.sdkOptions.height),void 0!==e.size&&(r.width=e.size*this.sdkOptions.width,r.height=e.size*this.sdkOptions.height),t.setCustomLayout(r),!0}},{key:"setFaceArea",value:function(e){var t=this.getEffectInstance(qy.U.SMART_ZOOM);return!!t&&(e=Math.max(e,.01),e=Math.min(e,1),t.setConfig("faceAreaProportion",e),!0)}},{key:"setFaceDetectorAccuracy",value:function(e){var t=this.getEffectInstance(qy.U.SMART_ZOOM);return!!t&&(e=Math.max(e,.2),e=Math.min(e,1),t.setConfig("faceDetectorAccuracy",e),!0)}},{key:"getDetectedFaces",value:function(){var e=this.getEffectInstance(qy.U.SMART_ZOOM);return e?e.getFaces():[]}},{key:"setSmartZoomSmoothing",value:function(e){var t=this.getEffectInstance(qy.U.SMART_ZOOM);return!!t&&(e=Math.max(e,.01),e=Math.min(e,1),t.setConfig("smoothPower",100*e),!0)}},{key:"setSmartZoomSensitivity",value:function(e){var t=this.getEffectInstance(qy.U.SMART_ZOOM);return!!t&&(e=Math.max(e,0),e=Math.min(e,1),t.setConfig("sensitivityValue",e),!0)}},{key:"setSmartZoomPerod",value:function(e){var t=this.getEffectInstance(qy.U.SMART_ZOOM);return!!t&&(e=Math.max(e,0),e=Math.min(e,1e3),t.setConfig("faceDetectorPediod_ms",e),!0)}},{key:"switchDrawFaceSquare",value:function(e){var t=this.getEffectInstance(qy.U.SMART_ZOOM);return!!t&&(t.setConfig("isFaceSquareDrawingEnabled",e),!0)}},{key:"switchDrawPreFaceSquare",value:function(e){var t=this.getEffectInstance(qy.U.SMART_ZOOM);return!!t&&(t.setConfig("isPreFaceSquareDrawingEnabled",e),!0)}},{key:"enableSmartZoom",value:function(){var e=this.getEffectInstance(qy.U.SMART_ZOOM);return!!e&&(e.enable(),!0)}},{key:"disableSmartZoom",value:function(){var e=this.getEffectInstance(qy.U.SMART_ZOOM);return!!e&&(e.disable(),!0)}},{key:"enableColorCorrector",value:function(){var e=this.getEffectInstance(qy.U.COLOR_CORRECION);return!!e&&(e.enable(),!0)}},{key:"disableColorCorrector",value:function(){var e=this.getEffectInstance(qy.U.COLOR_CORRECION);return!!e&&(e.disable(),!0)}},{key:"enableMirroring",value:function(){var e=this.getEffectInstance(qy.U.MIRRORING);return!!e&&(e.enable(),!0)}},{key:"disableMirroring",value:function(){var e=this.getEffectInstance(qy.U.MIRRORING);return!!e&&(e.disable(),!0)}},{key:"enableColorFilter",value:function(){var e=this.getEffectInstance(qy.U.COLOR_FILTERS);return!!e&&(e.enable(),!0)}},{key:"disableColorFilter",value:function(){var e=this.getEffectInstance(qy.U.COLOR_FILTERS);return!!e&&(e.disable(),!0)}},{key:"setColorFilterConfig",value:function(e){var t=this.getEffectInstance(qy.U.COLOR_FILTERS);return!!t&&(t.setConfig(e),!0)}},{key:"setFilterPart",value:function(e){var t=this.getEffectInstance(qy.U.COLOR_CORRECION);return!!t&&(t.setConfig("filterPart",e),!0)}},{key:"setColorCorrectorPeriod",value:function(e){var t=this.getEffectInstance(qy.U.COLOR_CORRECION);return!!t&&(e=Math.max(e,0),e=Math.min(e,5e3),t.setConfig("modelPediod_ms",e),!0)}},{key:"setColorCorrectorPower",value:function(e){var t=this.getEffectInstance(qy.U.COLOR_CORRECION);return!!t&&(e=Math.max(e,0),e=Math.min(e,1),t.setConfig("cc_power",e),!0)}},{key:"enableLowLightEffect",value:function(){var e=this.getEffectInstance(qy.U.LOW_LIGHT);return!!e&&(e.enable(),!0)}},{key:"disableLowLightEffect",value:function(){var e=this.getEffectInstance(qy.U.LOW_LIGHT);return!!e&&(e.disable(),!0)}},{key:"setLowLightEffectConfig",value:function(e){var t=this.getEffectInstance(qy.U.LOW_LIGHT);return!!t&&(t.setConfig(e),!0)}},{key:"setLowLightEffectPower",value:function(e){return this.setLowLightEffectConfig({power:e}),!0}},{key:"enableSharpnessEffect",value:function(){var e=this.getEffectInstance(qy.U.SHARPNESS);return!!e&&(e.enable(),!0)}},{key:"disableSharpnessEffect",value:function(){var e=this.getEffectInstance(qy.U.SHARPNESS);return!!e&&(e.disable(),!0)}},{key:"setSharpnessEffectConfig",value:function(e){var t=this.getEffectInstance(qy.U.SHARPNESS);return!!t&&(t.setConfig(e),!0)}},{key:"clear",value:function(){return!!this.streamProcessor&&(this.streamProcessor.destroy(),!0)}},{key:"run",value:function(){return this.streamProcessor&&(this.streamProcessor.isRunning=!0),!0}},{key:"stop",value:function(){return this.streamProcessor&&(this.streamProcessor.isRunning=!1),!0}},{key:"enablePipelineSkipping",value:function(){var e;null===(e=this.effectProcessor)||void 0===e||e.enablePipelineSkipping()}},{key:"disablePipelineSkipping",value:function(){var e;null===(e=this.effectProcessor)||void 0===e||e.disablePipelineSkipping()}},{key:"getEffectProcessor",value:function(){return this.effectProcessor}},{key:"createComponent",value:function(e){return new gm[e.component](this.sdkOptions,e.options)}},{key:"addComponent",value:function(e,t){this.components[t]=e}},{key:"getComponentConstructor",value:function(e){return gm[e]}},{key:"setOutputResolution",value:function(e){this.streamProcessor&&this.streamProcessor.setCustomResolution(e.width,e.height)}},{key:"clearOutputResolution",value:function(){this.streamProcessor&&this.streamProcessor.clearOutputResolution()}},{key:"setCustomResolution",value:function(e){this.streamProcessor&&this.streamProcessor.setCustomResolution(e.width,e.height)}},{key:"clearCustomResolution",value:function(){this.streamProcessor&&this.streamProcessor.clearCustomResolution()}},{key:"setOutputFrameFormat",value:function(e){this.outputFrameFormat=e}},{key:"onReady",set:function(e){this.callbackStore.setCallback("onReady",e)}},{key:"onError",value:function(e){this._lastErrorHandler&&n.bv.unsubscribe(this._lastErrorHandler),n.bv.subscribe(e),this._lastErrorHandler=e}},{key:"getLatestErrors",value:function(){return n.bv.messageLog}},{key:"emulateError",value:function(e){n.bv.notify({message:"Emulated error with code: ".concat(e),code:e,type:n.By.ERROR,emitter:n.JK.EMULATOR})}},{key:"onFrame",set:function(e){var t;this.callbackStore.setCallback("onFrameDraw",e),null===(t=this.streamProcessor)||void 0===t||t.onFrameDraw(e)}},{key:"onChangeInputResolution",value:function(e){var t;this.callbackStore.setCallback("onChangeInputResolution",e),null===(t=this.streamProcessor)||void 0===t||t.onChangeInputResolution(e)}},{key:"onAuthRequest",value:function(e){this.onnx_inference&&this.onnx_inference.sessionManager.onAuth(e)}},{key:"onColorFilterSuccess",value:function(e){this.callbackStore.setCallback("onColorFilterSuccess",e);var t=this.getEffectInstance(qy.U.COLOR_FILTERS);null==t||t.onSuccess(e)}},{key:"onLowLightSuccess",value:function(e){this.callbackStore.setCallback("onLowLightSuccess",e);var t=this.getEffectInstance(qy.U.LOW_LIGHT);null==t||t.onSuccess(e)}},{key:"onBackgroundSuccess",value:function(e){this.callbackStore.setCallback("onBackgroundSuccess",e);var t=this.getEffectInstance(qy.U.VIRTUAL_BACKGROUND);null==t||t.onSuccess(e)}}],t&&um(e.prototype,t),r&&um(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,r,i,o,a,s,u,l,h}();cm=new WeakMap,mm=fm([(0,ad.Y)("tsvb"),dm("design:paramtypes",[String,Object])],mm);var gm={overlay_screen:Ed,watermark:Vd,lowerthird_1:Bp,lowerthird_2:qp,lowerthird_3:ny,lowerthird_4:dy,lowerthird_5:Ay,stickers:cp}},5862:(e,t,r)=>{r.d(t,{D:()=>m});var n=r(4486);function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}function o(){o=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,a=Object.defineProperty||function(e,t,r){e[t]=r.value},s="function"==typeof Symbol?Symbol:{},u=s.iterator||"@@iterator",l=s.asyncIterator||"@@asyncIterator",h=s.toStringTag||"@@toStringTag";function c(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(e){c=function(e,t,r){return e[t]=r}}function f(e,t,r,n){var i=t&&t.prototype instanceof v?t:v,o=Object.create(i.prototype),s=new $(n||[]);return a(o,"_invoke",{value:I(e,r,s)}),o}function d(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=f;var p="suspendedStart",y="suspendedYield",m="executing",g="completed",w={};function v(){}function b(){}function x(){}var _={};c(_,u,(function(){return this}));var S=Object.getPrototypeOf,T=S&&S(S(R([])));T&&T!==r&&n.call(T,u)&&(_=T);var E=x.prototype=v.prototype=Object.create(_);function O(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function A(e,t){function r(o,a,s,u){var l=d(e[o],e,a);if("throw"!==l.type){var h=l.arg,c=h.value;return c&&"object"==i(c)&&n.call(c,"__await")?t.resolve(c.__await).then((function(e){r("next",e,s,u)}),(function(e){r("throw",e,s,u)})):t.resolve(c).then((function(e){h.value=e,s(h)}),(function(e){return r("throw",e,s,u)}))}u(l.arg)}var o;a(this,"_invoke",{value:function(e,n){function i(){return new t((function(t,i){r(e,n,t,i)}))}return o=o?o.then(i,i):i()}})}function I(t,r,n){var i=p;return function(o,a){if(i===m)throw Error("Generator is already running");if(i===g){if("throw"===o)throw a;return{value:e,done:!0}}for(n.method=o,n.arg=a;;){var s=n.delegate;if(s){var u=P(s,n);if(u){if(u===w)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===p)throw i=g,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i=m;var l=d(t,r,n);if("normal"===l.type){if(i=n.done?g:y,l.arg===w)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(i=g,n.method="throw",n.arg=l.arg)}}}function P(t,r){var n=r.method,i=t.iterator[n];if(i===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,P(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),w;var o=d(i,t.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,w;var a=o.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,w):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,w)}function k(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function C(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function $(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(k,this),this.reset(!0)}function R(t){if(t||""===t){var r=t[u];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,a=function r(){for(;++o<t.length;)if(n.call(t,o))return r.value=t[o],r.done=!1,r;return r.value=e,r.done=!0,r};return a.next=a}}throw new TypeError(i(t)+" is not iterable")}return b.prototype=x,a(E,"constructor",{value:x,configurable:!0}),a(x,"constructor",{value:b,configurable:!0}),b.displayName=c(x,h,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===b||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,x):(e.__proto__=x,c(e,h,"GeneratorFunction")),e.prototype=Object.create(E),e},t.awrap=function(e){return{__await:e}},O(A.prototype),c(A.prototype,l,(function(){return this})),t.AsyncIterator=A,t.async=function(e,r,n,i,o){void 0===o&&(o=Promise);var a=new A(f(e,r,n,i),o);return t.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},O(E),c(E,h,"Generator"),c(E,u,(function(){return this})),c(E,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=R,$.prototype={constructor:$,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(C),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function i(n,i){return s.type="throw",s.arg=t,r.next=n,i&&(r.method="next",r.arg=e),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),l=n.call(a,"finallyLoc");if(u&&l){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return i(a.catchLoc,!0)}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,w):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),w},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),C(r),w}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;C(r)}return i}}throw Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:R(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),w}},t}function a(e,t,r,n,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void r(e)}s.done?t(u):Promise.resolve(u).then(n,i)}function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,u(n.key),n)}}function u(e){var t=function(e,t){if("object"!=i(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=i(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==i(t)?t:t+""}function l(e,t,r){return t=c(t),function(e,t){if(t&&("object"==i(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,h()?Reflect.construct(t,r||[],c(e).constructor):t.apply(e,r))}function h(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(h=function(){return!!e})()}function c(e){return c=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},c(e)}function f(e,t){return f=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},f(e,t)}var d,p=function(e,t,r,n,i){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?i.call(e,r):i?i.value=r:t.set(e,r),r},y=function(e,t,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)},m=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),e=l(this,t),d.set(e,void 0),e.width=0,e.height=0,e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&f(e,t)}(t,e),r=t,n=[{key:"setSdkOptions",value:function(e){this.sdkOptions=e}},{key:"set",value:function(e){var t=this;e instanceof MediaStream?p(this,d,e.getVideoTracks()[0],"f"):p(this,d,e,"f"),null!=y(this,d,"f").getSettings().width&&(this.width=y(this,d,"f").getSettings().width),null!=y(this,d,"f").getSettings().height&&(this.height=y(this,d,"f").getSettings().height),y(this,d,"f").onended&&(y(this,d,"f").onended=function(){return t.emit("ended",t)})}},{key:"stop",value:function(){y(this,d,"f")&&y(this,d,"f").stop()}},{key:"update",value:function(e,t){if(y(this,d,"f")){var r=!1;e||t||(e=y(this,d,"f").getSettings().width,t=y(this,d,"f").getSettings().height),this.width!=e&&(r=!0,this.width=e),this.height!=t&&(r=!0,this.height=t),r&&this.emit("update",this)}}},{key:"getSettings",value:function(e){return y(this,d,"f"),e||(e={width:this.sdkOptions?this.sdkOptions.width:this.width,height:this.sdkOptions?this.sdkOptions.height:this.height,aspectRatio:this.sdkOptions?this.sdkOptions.width/this.sdkOptions.height:this.width/this.height}),Object.assign(y(this,d,"f").getSettings(),e)}},{key:"getConstraints",value:function(e){return y(this,d,"f"),e||(e={width:this.sdkOptions?this.sdkOptions.width:this.width,height:this.sdkOptions?this.sdkOptions.height:this.height}),Object.assign(y(this,d,"f").getConstraints(),e)}},{key:"getCapabilities",value:function(e){return y(this,d,"f"),Object.assign(y(this,d,"f").getCapabilities(),e)}},{key:"applyConstraints",value:(u=o().mark((function e(t){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(y(this,d,"f")){e.next=2;break}return e.abrupt("return");case 2:y(this,d,"f").applyConstraints(t);case 3:case"end":return e.stop()}}),e,this)})),h=function(){var e=this,t=arguments;return new Promise((function(r,n){var i=u.apply(e,t);function o(e){a(i,r,n,o,s,"next",e)}function s(e){a(i,r,n,o,s,"throw",e)}o(void 0)}))},function(e){return h.apply(this,arguments)})}],n&&s(r.prototype,n),i&&s(r,i),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,i,u,h}(n.b);d=new WeakMap},6903:(e,t,r)=>{function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,o(n.key),n)}}function o(e){var t=function(e,t){if("object"!=n(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=n(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==n(t)?t:t+""}r.d(t,{c:()=>a});var a=function(){return e=function e(){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.state="pending",this.fate="unresolved",this.promise=new Promise((function(e,r){t._resolve=e,t._reject=r})),this.promise.then((function(){return t.state="fulfilled"}),(function(){return t.state="rejected"}))},(t=[{key:"resolve",value:function(e){if("resolved"===this.fate)throw"Deferred cannot be resolved twice";this.fate="resolved",this._resolve(e)}},{key:"reject",value:function(e){if("resolved"===this.fate)throw"Deferred cannot be resolved twice";this.fate="resolved",this._reject(e)}},{key:"isResolved",value:function(){return"resolved"===this.fate}},{key:"isPending",value:function(){return"pending"===this.state}},{key:"isFulfilled",value:function(){return"fulfilled"===this.state}},{key:"isRejected",value:function(){return"rejected"===this.state}}])&&i(e.prototype,t),r&&i(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,r}()},9672:(e,t,r)=>{function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,o(n.key),n)}}function o(e){var t=function(e,t){if("object"!=n(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=n(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==n(t)?t:t+""}r.d(t,{By:()=>s,JK:()=>u,O4:()=>a,bv:()=>l});var a,s,u,l=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.messageLog=[],this.subscribers=[]}return t=e,n=[{key:"getInstance",value:function(){return e._instance||(e._instance=new e),e._instance}}],(r=[{key:"subscribe",value:function(e){"function"==typeof e&&this.subscribers.push(e)}},{key:"unsubscribe",value:function(e){this.subscribers=this.subscribers.filter((function(t){return t!==e}))}},{key:"notify",value:function(e){for(e.emitter&&(e.message="[ ".concat(e.emitter," ]: ").concat(e.message)),e.type||(e.type=s.ERROR),this.subscribers.forEach((function(t){return t(e)}));this.messageLog.length>20;)this.messageLog.shift();this.messageLog.push(e)}}])&&i(t.prototype,r),n&&i(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,r,n}().getInstance();!function(e){e[e.GPU_DEVICE_LOST=1001]="GPU_DEVICE_LOST",e[e.APP_CREATION_ISSUE=1002]="APP_CREATION_ISSUE",e[e.GPU_UNCAPTUREDERROR=1010]="GPU_UNCAPTUREDERROR",e[e.SESSION_INITIALIZATION_FAILED=1020]="SESSION_INITIALIZATION_FAILED",e[e.SESSION_INITIALIZATION_ISSUE=1021]="SESSION_INITIALIZATION_ISSUE",e[e.LOADER_ISSUE=1023]="LOADER_ISSUE",e[e.PRESET_ISSUE=1024]="PRESET_ISSUE",e[e.SESSION_INITIALIZATION_SUCCESS=3020]="SESSION_INITIALIZATION_SUCCESS",e[e.MODEL_INITIALIZATION_ISSUE=1022]="MODEL_INITIALIZATION_ISSUE",e[e.EFFECT_INITIALIZATION_ISSUE=1025]="EFFECT_INITIALIZATION_ISSUE",e[e.EFFECT_INITIALIZATION_SUCCESS=3021]="EFFECT_INITIALIZATION_SUCCESS",e[e.NO_VIDEO_TRACK=1030]="NO_VIDEO_TRACK",e[e.INFERENCE_RUN_ISSUE=1040]="INFERENCE_RUN_ISSUE",e[e.RENDERING_ISSUE=1050]="RENDERING_ISSUE",e[e.ENQUEUE_FRAME_ISSUE=1060]="ENQUEUE_FRAME_ISSUE",e[e.READABLE_STREAM_ISSUE=1061]="READABLE_STREAM_ISSUE",e[e.CPU_FALLBACK=3001]="CPU_FALLBACK"}(a||(a={})),function(e){e.INFO="info",e.WARNING="warning",e.ERROR="error"}(s||(s={})),function(e){e.TSVB="tsvb",e.EMULATOR="emulator",e.COMPONENTS_SYSTEM="components_system",e.SRTEAM_PROCESSOR="stream_processor",e.ML_INFERENCE="ml_inference",e.SESSION_MANAGER="session_manager",e.SESSION_RUNNER="session_runner",e.PRESET_INIT="preset_init",e.RENDERER="renderer",e.RECORDER="recorder",e.WORKER_TIMERS="worker_timers",e.ABSTRACT_EFFECT="effects_loader",e.EFFECT_VIRTUAL_BACKGROUND="effect_virtual_background",e.EFFECT_COLOR_CORRECTION="effect_color_correction",e.EFFECT_COLOR_FILTER="effect_color_filter",e.EFFECT_SMART_ZOOM="effect_smart_zoom",e.EFFECT_LOW_LIGHT="effect_low_light"}(u||(u={}))},7036:(e,t,r)=>{function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,o(n.key),n)}}function o(e){var t=function(e,t){if("object"!=n(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=n(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==n(t)?t:t+""}r.d(t,{P:()=>a});var a=function(){return e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)},t=[{key:"createPromise",value:function(){var e=this;return this._promise=new Promise((function(t,r){e.resolver=t,e.rejecter=r})),this._promise}},{key:"promise",get:function(){return this._promise}},{key:"resolve",value:function(e){if("function"!=typeof this.resolver)return!1;this.resolver(e),this.resolver=void 0}},{key:"reject",value:function(e){if("function"!=typeof this.rejecter)return!1;this.rejecter(e),this.rejecter=void 0,this._promise=void 0}}],t&&i(e.prototype,t),r&&i(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,r}()},6739:(e,t,r)=>{function n(e){return e?e.charAt(0).toUpperCase()+e.slice(1):""}r.d(t,{Y:()=>$,kc:()=>p,Uz:()=>d});var i=r(8380),o=r(2004),a=r(2505),s=r.n(a);function u(e){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u(e)}function l(e){return function(e){if(Array.isArray(e))return h(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return h(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?h(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function h(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function c(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,f(n.key),n)}}function f(e){var t=function(e,t){if("object"!=u(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=u(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==u(t)?t:t+""}var d=function(){return e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.data=[],this.delay=5e3,this.isRunning=!1,this.deferred=new Map},r=[{key:"Instance",get:function(){return this._instance||(this._instance=new this)}}],(t=[{key:"setCustomerID",value:function(e){this.customer_id=e}},{key:"push",value:function(e,t){var r=this;i.y.STATS&&(this.checkRunning(e),this.isRunning?(clearTimeout(this.timer),this.data.push({feature:e,user_id:o.W.getInstance().getUID(this.customer_id),data:t}),this.timer=setTimeout((function(){return r.send()}),this.delay)):this.deferred.set(e,t))}},{key:"send",value:function(){var e=this,t=l(this.data);this.data=[];var r=i.y.STATS_URL+this.customer_id,n={"Tsvb-Version":i.y.VERSION};s().post(r,t,{headers:n}).catch((function(r){return e.data=[].concat(l(t),l(e.data)),r}))}},{key:"checkRunning",value:function(e){var t=this,r=o.W.getInstance().getUID(this.customer_id);"run"===e&&(this.isRunning=!0,this.deferred.forEach((function(e,n){t.data.push({feature:n,user_id:r,data:e})})),this.deferred.clear())}}])&&c(e.prototype,t),r&&c(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,r}();function p(e){return function(t,r,i){var o=i.value;i.value=function(){var t=r+n(e);d.Instance.push(t);for(var i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return o.apply(this,a)}}}function y(e){return y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},y(e)}function m(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,g(n.key),n)}}function g(e){var t=function(e,t){if("object"!=y(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=y(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==y(t)?t:t+""}var w=function(){return e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)},r=[{key:"isStattable",value:function(e,t){var r;return(null!==(r=this.FEATURES[e])&&void 0!==r?r:[]).includes(t)}}],(t=null)&&m(e.prototype,t),r&&m(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,r}();function v(e){return v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},v(e)}function b(){b=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,i=Object.defineProperty||function(e,t,r){e[t]=r.value},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function l(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,r){return e[t]=r}}function h(e,t,r,n){var o=t&&t.prototype instanceof g?t:g,a=Object.create(o.prototype),s=new $(n||[]);return i(a,"_invoke",{value:I(e,r,s)}),a}function c(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=h;var f="suspendedStart",d="suspendedYield",p="executing",y="completed",m={};function g(){}function w(){}function x(){}var _={};l(_,a,(function(){return this}));var S=Object.getPrototypeOf,T=S&&S(S(R([])));T&&T!==r&&n.call(T,a)&&(_=T);var E=x.prototype=g.prototype=Object.create(_);function O(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function A(e,t){function r(i,o,a,s){var u=c(e[i],e,o);if("throw"!==u.type){var l=u.arg,h=l.value;return h&&"object"==v(h)&&n.call(h,"__await")?t.resolve(h.__await).then((function(e){r("next",e,a,s)}),(function(e){r("throw",e,a,s)})):t.resolve(h).then((function(e){l.value=e,a(l)}),(function(e){return r("throw",e,a,s)}))}s(u.arg)}var o;i(this,"_invoke",{value:function(e,n){function i(){return new t((function(t,i){r(e,n,t,i)}))}return o=o?o.then(i,i):i()}})}function I(t,r,n){var i=f;return function(o,a){if(i===p)throw Error("Generator is already running");if(i===y){if("throw"===o)throw a;return{value:e,done:!0}}for(n.method=o,n.arg=a;;){var s=n.delegate;if(s){var u=P(s,n);if(u){if(u===m)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===f)throw i=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i=p;var l=c(t,r,n);if("normal"===l.type){if(i=n.done?y:d,l.arg===m)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(i=y,n.method="throw",n.arg=l.arg)}}}function P(t,r){var n=r.method,i=t.iterator[n];if(i===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,P(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),m;var o=c(i,t.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,m;var a=o.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,m):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,m)}function k(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function C(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function $(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(k,this),this.reset(!0)}function R(t){if(t||""===t){var r=t[a];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,o=function r(){for(;++i<t.length;)if(n.call(t,i))return r.value=t[i],r.done=!1,r;return r.value=e,r.done=!0,r};return o.next=o}}throw new TypeError(v(t)+" is not iterable")}return w.prototype=x,i(E,"constructor",{value:x,configurable:!0}),i(x,"constructor",{value:w,configurable:!0}),w.displayName=l(x,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===w||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,x):(e.__proto__=x,l(e,u,"GeneratorFunction")),e.prototype=Object.create(E),e},t.awrap=function(e){return{__await:e}},O(A.prototype),l(A.prototype,s,(function(){return this})),t.AsyncIterator=A,t.async=function(e,r,n,i,o){void 0===o&&(o=Promise);var a=new A(h(e,r,n,i),o);return t.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},O(E),l(E,u,"Generator"),l(E,a,(function(){return this})),l(E,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=R,$.prototype={constructor:$,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(C),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function i(n,i){return s.type="throw",s.arg=t,r.next=n,i&&(r.method="next",r.arg=e),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),l=n.call(a,"finallyLoc");if(u&&l){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return i(a.catchLoc,!0)}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,m):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),C(r),m}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;C(r)}return i}}throw Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:R(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),m}},t}w.FEATURES={recorder:["start","stop","pause","resume"],tsvb:["run","stop","enableBeautification","disableBeautification","setBlur","clearBlur","setBackground","clearBackground","enableSmartZoom","disableSmartZoom","enableColorCorrector","disableColorCorrector","enableFrameSkipping","disableFrameSkipping","setLayout","enableColorFilter","disableColorFilter","setSegmentationPreset","enableLowLightEffect","disableLowLightEffect","enableSharpnessEffect","disableSharpnessEffect"]},w.SDK_RUNNING_INTERVALS=[{feature:"run5",delay_ms:3e5},{feature:"run10",delay_ms:3e5},{feature:"run15",delay_ms:3e5},{feature:"run20",delay_ms:3e5}];var x=b().mark(T);function _(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return S(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?S(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw o}}}}function S(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function T(e){var t,r,n;return b().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:t=_(e),i.prev=1,t.s();case 3:if((r=t.n()).done){i.next=9;break}return n=r.value,i.next=7,n;case 7:i.next=3;break;case 9:i.next=14;break;case 11:i.prev=11,i.t0=i.catch(1),t.e(i.t0);case 14:return i.prev=14,t.f(),i.finish(14);case 17:case"end":return i.stop()}}),x,null,[[1,11,14,17]])}function E(e){return E="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},E(e)}function O(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,A(n.key),n)}}function A(e){var t=function(e,t){if("object"!=E(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=E(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==E(t)?t:t+""}var I=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return t=e,i=[{key:"getInstance",value:function(){return e._instance||(e._instance=new e),e._instance}}],(r=[{key:"setFeatureData",value:function(e,t){this.feature=t,this.type=e}},{key:"handle",value:function(){this.isDisableToPush()||(this.pushStat(),this.isSdkRunFeature()&&(clearTimeout(this.sdkRunningTimer),this.intervalIterator=T(w.SDK_RUNNING_INTERVALS),this.handleSdkRunningInterval()),this.isSdkStopFeature()&&clearTimeout(this.sdkRunningTimer))}},{key:"isDisableToPush",value:function(){return!w.isStattable(this.type,this.feature)||!!this.isEqualLastPushedFeature()}},{key:"pushStat",value:function(){var e=this.getFeatureName();d.Instance.push(e),this.lastPushedFeature=e}},{key:"getFeatureName",value:function(){var e="tsvb"!==this.type?n(this.type):"";return this.feature+e}},{key:"isSdkRunFeature",value:function(){return"tsvb"===this.type&&"run"===this.feature}},{key:"isSdkStopFeature",value:function(){return"tsvb"===this.type&&"stop"===this.feature}},{key:"isEqualLastPushedFeature",value:function(){return this.lastPushedFeature===this.getFeatureName()}},{key:"handleSdkRunningInterval",value:function(){var e=this.intervalIterator.next(),t=e.value;e.done||this.startSdkRunningTimer(t.feature,t.delay_ms)}},{key:"startSdkRunningTimer",value:function(e,t){var r=this;this.sdkRunningTimer=setTimeout((function(){d.Instance.push(e),r.handleSdkRunningInterval()}),t)}}])&&O(t.prototype,r),i&&O(t,i),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,r,i}().getInstance();function P(e){return P="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},P(e)}function k(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return C(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?C(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw o}}}}function C(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function $(e){return function(t){var r,n=k(Object.getOwnPropertyNames(t.prototype));try{var i=function(){var n=r.value,i=Object.getOwnPropertyDescriptor(t.prototype,n);if(!i)return 0;var o=i.value;if(!(o instanceof Function))return 0;i.value=function(){I.setFeatureData(e,n),I.handle();for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];var a=o.apply(this,r);if(a){var s=function(){};if("object"===P(a)&&"function"==typeof a.then){var u=a.then(s);"function"==typeof u.catch&&u.catch((function(e){return e}))}return a}},Object.defineProperty(t.prototype,n,i)};for(n.s();!(r=n.n()).done;)i()}catch(e){n.e(e)}finally{n.f()}}}},2004:(e,t,r)=>{function n(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)e[n]=r[n]}return e}r.d(t,{W:()=>y});var i=function e(t,r){function i(e,i,o){if("undefined"!=typeof document){"number"==typeof(o=n({},r,o)).expires&&(o.expires=new Date(Date.now()+864e5*o.expires)),o.expires&&(o.expires=o.expires.toUTCString()),e=encodeURIComponent(e).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var a="";for(var s in o)o[s]&&(a+="; "+s,!0!==o[s]&&(a+="="+o[s].split(";")[0]));return document.cookie=e+"="+t.write(i,e)+a}}return Object.create({set:i,get:function(e){if("undefined"!=typeof document&&(!arguments.length||e)){for(var r=document.cookie?document.cookie.split("; "):[],n={},i=0;i<r.length;i++){var o=r[i].split("="),a=o.slice(1).join("=");try{var s=decodeURIComponent(o[0]);if(n[s]=t.read(a,s),e===s)break}catch(e){}}return e?n[e]:n}},remove:function(e,t){i(e,"",n({},t,{expires:-1}))},withAttributes:function(t){return e(this.converter,n({},this.attributes,t))},withConverter:function(t){return e(n({},this.converter,t),this.attributes)}},{attributes:{value:Object.freeze(r)},converter:{value:Object.freeze(t)}})}({read:function(e){return'"'===e[0]&&(e=e.slice(1,-1)),e.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write:function(e){return encodeURIComponent(e).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)}},{path:"/"});const o={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};let a;const s=new Uint8Array(16);function u(){if(!a&&(a="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!a))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return a(s)}const l=[];for(let e=0;e<256;++e)l.push((e+256).toString(16).slice(1));function h(e,t=0){return l[e[t+0]]+l[e[t+1]]+l[e[t+2]]+l[e[t+3]]+"-"+l[e[t+4]]+l[e[t+5]]+"-"+l[e[t+6]]+l[e[t+7]]+"-"+l[e[t+8]]+l[e[t+9]]+"-"+l[e[t+10]]+l[e[t+11]]+l[e[t+12]]+l[e[t+13]]+l[e[t+14]]+l[e[t+15]]}const c=function(e,t,r){if(o.randomUUID&&!t&&!e)return o.randomUUID();const n=(e=e||{}).random||(e.rng||u)();if(n[6]=15&n[6]|64,n[8]=63&n[8]|128,t){r=r||0;for(let e=0;e<16;++e)t[r+e]=n[e];return t}return h(n)};function f(e){return f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},f(e)}function d(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,p(n.key),n)}}function p(e){var t=function(e,t){if("object"!=f(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=f(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==f(t)?t:t+""}var y=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return t=e,n=[{key:"getInstance",value:function(){return e.instance||(e.instance=new e),e.instance}}],(r=[{key:"getUID",value:function(e){if(this._uid)return this._uid;var t=i.get("TSVB_UID");return t||(t=c(),i.set("TSVB_UID",t)),t}},{key:"setUID",value:function(e){this._uid=e}}])&&d(t.prototype,r),n&&d(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,r,n}()},8699:(e,t,r)=>{function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,s(n.key),n)}}function a(e,t,r){return t&&o(e.prototype,t),r&&o(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function s(e){var t=function(e,t){if("object"!=n(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=n(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==n(t)?t:t+""}r.d(t,{S:()=>u,z:()=>l});var u=function(){return a((function e(){i(this,e),this.frame_count=30,this.frames=[1]}),[{key:"start",value:function(){this.t0=performance.now()}},{key:"finish",value:function(){var e=performance.now()-this.t0;this.frames.push(e),this.frames.length>this.frame_count&&this.frames.shift()}},{key:"getFrameFps",value:function(){var e=this.frames.reduce((function(e,t){return e+t}),0);return 0==e||isNaN(e)?1:Math.round(1e3/(e/this.frame_count))}},{key:"getFrameDuration",value:function(){return Math.round(1e6/this.getFrameFps())}},{key:"getFrameTime",value:function(){return Math.round(this.frames.reduce((function(e,t){return e+t}),0)/this.frame_count)}}])}(),l=function(){return a((function e(){i(this,e),this.pattern="Output FPS: {{output_fps}}\nFrame Draw Time: {{frame_time}}ms\nInference Time: {{inference_time}}ms",this.stats=new Map}),[{key:"updateStats",value:function(e,t){return this.stats.set(e,t),!0}},{key:"getText",value:function(){var e=this.pattern;return this.stats.forEach((function(t,r){e=e.replaceAll("{{"+r+"}}",t.toString())})),e}}])}()},7526:(e,t)=>{t.byteLength=function(e){var t=s(e),r=t[0],n=t[1];return 3*(r+n)/4-n},t.toByteArray=function(e){var t,r,o=s(e),a=o[0],u=o[1],l=new i(function(e,t,r){return 3*(t+r)/4-r}(0,a,u)),h=0,c=u>0?a-4:a;for(r=0;r<c;r+=4)t=n[e.charCodeAt(r)]<<18|n[e.charCodeAt(r+1)]<<12|n[e.charCodeAt(r+2)]<<6|n[e.charCodeAt(r+3)],l[h++]=t>>16&255,l[h++]=t>>8&255,l[h++]=255&t;2===u&&(t=n[e.charCodeAt(r)]<<2|n[e.charCodeAt(r+1)]>>4,l[h++]=255&t);1===u&&(t=n[e.charCodeAt(r)]<<10|n[e.charCodeAt(r+1)]<<4|n[e.charCodeAt(r+2)]>>2,l[h++]=t>>8&255,l[h++]=255&t);return l},t.fromByteArray=function(e){for(var t,n=e.length,i=n%3,o=[],a=16383,s=0,l=n-i;s<l;s+=a)o.push(u(e,s,s+a>l?l:s+a));1===i?(t=e[n-1],o.push(r[t>>2]+r[t<<4&63]+"==")):2===i&&(t=(e[n-2]<<8)+e[n-1],o.push(r[t>>10]+r[t>>4&63]+r[t<<2&63]+"="));return o.join("")};for(var r=[],n=[],i="undefined"!=typeof Uint8Array?Uint8Array:Array,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=0;a<64;++a)r[a]=o[a],n[o.charCodeAt(a)]=a;function s(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=e.indexOf("=");return-1===r&&(r=t),[r,r===t?0:4-r%4]}function u(e,t,n){for(var i,o,a=[],s=t;s<n;s+=3)i=(e[s]<<16&16711680)+(e[s+1]<<8&65280)+(255&e[s+2]),a.push(r[(o=i)>>18&63]+r[o>>12&63]+r[o>>6&63]+r[63&o]);return a.join("")}n["-".charCodeAt(0)]=62,n["_".charCodeAt(0)]=63},8287:(e,t,r)=>{var n=r(7526),i=r(251),o=r(4634);function a(){return u.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function s(e,t){if(a()<t)throw new RangeError("Invalid typed array length");return u.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t)).__proto__=u.prototype:(null===e&&(e=new u(t)),e.length=t),e}function u(e,t,r){if(!(u.TYPED_ARRAY_SUPPORT||this instanceof u))return new u(e,t,r);if("number"==typeof e){if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return c(this,e)}return l(this,e,t,r)}function l(e,t,r,n){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?function(e,t,r,n){if(t.byteLength,r<0||t.byteLength<r)throw new RangeError("'offset' is out of bounds");if(t.byteLength<r+(n||0))throw new RangeError("'length' is out of bounds");t=void 0===r&&void 0===n?new Uint8Array(t):void 0===n?new Uint8Array(t,r):new Uint8Array(t,r,n);u.TYPED_ARRAY_SUPPORT?(e=t).__proto__=u.prototype:e=f(e,t);return e}(e,t,r,n):"string"==typeof t?function(e,t,r){"string"==typeof r&&""!==r||(r="utf8");if(!u.isEncoding(r))throw new TypeError('"encoding" must be a valid string encoding');var n=0|p(t,r);e=s(e,n);var i=e.write(t,r);i!==n&&(e=e.slice(0,i));return e}(e,t,r):function(e,t){if(u.isBuffer(t)){var r=0|d(t.length);return 0===(e=s(e,r)).length||t.copy(e,0,0,r),e}if(t){if("undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!=typeof t.length||(n=t.length)!=n?s(e,0):f(e,t);if("Buffer"===t.type&&o(t.data))return f(e,t.data)}var n;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(e,t)}function h(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function c(e,t){if(h(t),e=s(e,t<0?0:0|d(t)),!u.TYPED_ARRAY_SUPPORT)for(var r=0;r<t;++r)e[r]=0;return e}function f(e,t){var r=t.length<0?0:0|d(t.length);e=s(e,r);for(var n=0;n<r;n+=1)e[n]=255&t[n];return e}function d(e){if(e>=a())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+a().toString(16)+" bytes");return 0|e}function p(e,t){if(u.isBuffer(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var r=e.length;if(0===r)return 0;for(var n=!1;;)switch(t){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":case void 0:return j(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return z(e).length;default:if(n)return j(e).length;t=(""+t).toLowerCase(),n=!0}}function y(e,t,r){var n=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return"";if((r>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return k(this,t,r);case"utf8":case"utf-8":return O(this,t,r);case"ascii":return I(this,t,r);case"latin1":case"binary":return P(this,t,r);case"base64":return E(this,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return C(this,t,r);default:if(n)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),n=!0}}function m(e,t,r){var n=e[t];e[t]=e[r],e[r]=n}function g(e,t,r,n,i){if(0===e.length)return-1;if("string"==typeof r?(n=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),r=+r,isNaN(r)&&(r=i?0:e.length-1),r<0&&(r=e.length+r),r>=e.length){if(i)return-1;r=e.length-1}else if(r<0){if(!i)return-1;r=0}if("string"==typeof t&&(t=u.from(t,n)),u.isBuffer(t))return 0===t.length?-1:w(e,t,r,n,i);if("number"==typeof t)return t&=255,u.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(e,t,r):Uint8Array.prototype.lastIndexOf.call(e,t,r):w(e,[t],r,n,i);throw new TypeError("val must be string, number or Buffer")}function w(e,t,r,n,i){var o,a=1,s=e.length,u=t.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(e.length<2||t.length<2)return-1;a=2,s/=2,u/=2,r/=2}function l(e,t){return 1===a?e[t]:e.readUInt16BE(t*a)}if(i){var h=-1;for(o=r;o<s;o++)if(l(e,o)===l(t,-1===h?0:o-h)){if(-1===h&&(h=o),o-h+1===u)return h*a}else-1!==h&&(o-=o-h),h=-1}else for(r+u>s&&(r=s-u),o=r;o>=0;o--){for(var c=!0,f=0;f<u;f++)if(l(e,o+f)!==l(t,f)){c=!1;break}if(c)return o}return-1}function v(e,t,r,n){r=Number(r)||0;var i=e.length-r;n?(n=Number(n))>i&&(n=i):n=i;var o=t.length;if(o%2!=0)throw new TypeError("Invalid hex string");n>o/2&&(n=o/2);for(var a=0;a<n;++a){var s=parseInt(t.substr(2*a,2),16);if(isNaN(s))return a;e[r+a]=s}return a}function b(e,t,r,n){return G(j(t,e.length-r),e,r,n)}function x(e,t,r,n){return G(function(e){for(var t=[],r=0;r<e.length;++r)t.push(255&e.charCodeAt(r));return t}(t),e,r,n)}function _(e,t,r,n){return x(e,t,r,n)}function S(e,t,r,n){return G(z(t),e,r,n)}function T(e,t,r,n){return G(function(e,t){for(var r,n,i,o=[],a=0;a<e.length&&!((t-=2)<0);++a)n=(r=e.charCodeAt(a))>>8,i=r%256,o.push(i),o.push(n);return o}(t,e.length-r),e,r,n)}function E(e,t,r){return 0===t&&r===e.length?n.fromByteArray(e):n.fromByteArray(e.slice(t,r))}function O(e,t,r){r=Math.min(e.length,r);for(var n=[],i=t;i<r;){var o,a,s,u,l=e[i],h=null,c=l>239?4:l>223?3:l>191?2:1;if(i+c<=r)switch(c){case 1:l<128&&(h=l);break;case 2:128==(192&(o=e[i+1]))&&(u=(31&l)<<6|63&o)>127&&(h=u);break;case 3:o=e[i+1],a=e[i+2],128==(192&o)&&128==(192&a)&&(u=(15&l)<<12|(63&o)<<6|63&a)>2047&&(u<55296||u>57343)&&(h=u);break;case 4:o=e[i+1],a=e[i+2],s=e[i+3],128==(192&o)&&128==(192&a)&&128==(192&s)&&(u=(15&l)<<18|(63&o)<<12|(63&a)<<6|63&s)>65535&&u<1114112&&(h=u)}null===h?(h=65533,c=1):h>65535&&(h-=65536,n.push(h>>>10&1023|55296),h=56320|1023&h),n.push(h),i+=c}return function(e){var t=e.length;if(t<=A)return String.fromCharCode.apply(String,e);var r="",n=0;for(;n<t;)r+=String.fromCharCode.apply(String,e.slice(n,n+=A));return r}(n)}t.hp=u,t.IS=50,u.TYPED_ARRAY_SUPPORT=void 0!==r.g.TYPED_ARRAY_SUPPORT?r.g.TYPED_ARRAY_SUPPORT:function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()&&"function"==typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(e){return!1}}(),a(),u.poolSize=8192,u._augment=function(e){return e.__proto__=u.prototype,e},u.from=function(e,t,r){return l(null,e,t,r)},u.TYPED_ARRAY_SUPPORT&&(u.prototype.__proto__=Uint8Array.prototype,u.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&u[Symbol.species]===u&&Object.defineProperty(u,Symbol.species,{value:null,configurable:!0})),u.alloc=function(e,t,r){return function(e,t,r,n){return h(t),t<=0?s(e,t):void 0!==r?"string"==typeof n?s(e,t).fill(r,n):s(e,t).fill(r):s(e,t)}(null,e,t,r)},u.allocUnsafe=function(e){return c(null,e)},u.allocUnsafeSlow=function(e){return c(null,e)},u.isBuffer=function(e){return!(null==e||!e._isBuffer)},u.compare=function(e,t){if(!u.isBuffer(e)||!u.isBuffer(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var r=e.length,n=t.length,i=0,o=Math.min(r,n);i<o;++i)if(e[i]!==t[i]){r=e[i],n=t[i];break}return r<n?-1:n<r?1:0},u.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},u.concat=function(e,t){if(!o(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return u.alloc(0);var r;if(void 0===t)for(t=0,r=0;r<e.length;++r)t+=e[r].length;var n=u.allocUnsafe(t),i=0;for(r=0;r<e.length;++r){var a=e[r];if(!u.isBuffer(a))throw new TypeError('"list" argument must be an Array of Buffers');a.copy(n,i),i+=a.length}return n},u.byteLength=p,u.prototype._isBuffer=!0,u.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)m(this,t,t+1);return this},u.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)m(this,t,t+3),m(this,t+1,t+2);return this},u.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)m(this,t,t+7),m(this,t+1,t+6),m(this,t+2,t+5),m(this,t+3,t+4);return this},u.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?O(this,0,e):y.apply(this,arguments)},u.prototype.equals=function(e){if(!u.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===u.compare(this,e)},u.prototype.inspect=function(){var e="",r=t.IS;return this.length>0&&(e=this.toString("hex",0,r).match(/.{2}/g).join(" "),this.length>r&&(e+=" ... ")),"<Buffer "+e+">"},u.prototype.compare=function(e,t,r,n,i){if(!u.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===r&&(r=e?e.length:0),void 0===n&&(n=0),void 0===i&&(i=this.length),t<0||r>e.length||n<0||i>this.length)throw new RangeError("out of range index");if(n>=i&&t>=r)return 0;if(n>=i)return-1;if(t>=r)return 1;if(this===e)return 0;for(var o=(i>>>=0)-(n>>>=0),a=(r>>>=0)-(t>>>=0),s=Math.min(o,a),l=this.slice(n,i),h=e.slice(t,r),c=0;c<s;++c)if(l[c]!==h[c]){o=l[c],a=h[c];break}return o<a?-1:a<o?1:0},u.prototype.includes=function(e,t,r){return-1!==this.indexOf(e,t,r)},u.prototype.indexOf=function(e,t,r){return g(this,e,t,r,!0)},u.prototype.lastIndexOf=function(e,t,r){return g(this,e,t,r,!1)},u.prototype.write=function(e,t,r,n){if(void 0===t)n="utf8",r=this.length,t=0;else if(void 0===r&&"string"==typeof t)n=t,r=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(r)?(r|=0,void 0===n&&(n="utf8")):(n=r,r=void 0)}var i=this.length-t;if((void 0===r||r>i)&&(r=i),e.length>0&&(r<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var o=!1;;)switch(n){case"hex":return v(this,e,t,r);case"utf8":case"utf-8":return b(this,e,t,r);case"ascii":return x(this,e,t,r);case"latin1":case"binary":return _(this,e,t,r);case"base64":return S(this,e,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return T(this,e,t,r);default:if(o)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),o=!0}},u.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var A=4096;function I(e,t,r){var n="";r=Math.min(e.length,r);for(var i=t;i<r;++i)n+=String.fromCharCode(127&e[i]);return n}function P(e,t,r){var n="";r=Math.min(e.length,r);for(var i=t;i<r;++i)n+=String.fromCharCode(e[i]);return n}function k(e,t,r){var n=e.length;(!t||t<0)&&(t=0),(!r||r<0||r>n)&&(r=n);for(var i="",o=t;o<r;++o)i+=U(e[o]);return i}function C(e,t,r){for(var n=e.slice(t,r),i="",o=0;o<n.length;o+=2)i+=String.fromCharCode(n[o]+256*n[o+1]);return i}function $(e,t,r){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>r)throw new RangeError("Trying to access beyond buffer length")}function R(e,t,r,n,i,o){if(!u.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<o)throw new RangeError('"value" argument is out of bounds');if(r+n>e.length)throw new RangeError("Index out of range")}function D(e,t,r,n){t<0&&(t=65535+t+1);for(var i=0,o=Math.min(e.length-r,2);i<o;++i)e[r+i]=(t&255<<8*(n?i:1-i))>>>8*(n?i:1-i)}function M(e,t,r,n){t<0&&(t=4294967295+t+1);for(var i=0,o=Math.min(e.length-r,4);i<o;++i)e[r+i]=t>>>8*(n?i:3-i)&255}function L(e,t,r,n,i,o){if(r+n>e.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function B(e,t,r,n,o){return o||L(e,0,r,4),i.write(e,t,r,n,23,4),r+4}function N(e,t,r,n,o){return o||L(e,0,r,8),i.write(e,t,r,n,52,8),r+8}u.prototype.slice=function(e,t){var r,n=this.length;if((e=~~e)<0?(e+=n)<0&&(e=0):e>n&&(e=n),(t=void 0===t?n:~~t)<0?(t+=n)<0&&(t=0):t>n&&(t=n),t<e&&(t=e),u.TYPED_ARRAY_SUPPORT)(r=this.subarray(e,t)).__proto__=u.prototype;else{var i=t-e;r=new u(i,void 0);for(var o=0;o<i;++o)r[o]=this[o+e]}return r},u.prototype.readUIntLE=function(e,t,r){e|=0,t|=0,r||$(e,t,this.length);for(var n=this[e],i=1,o=0;++o<t&&(i*=256);)n+=this[e+o]*i;return n},u.prototype.readUIntBE=function(e,t,r){e|=0,t|=0,r||$(e,t,this.length);for(var n=this[e+--t],i=1;t>0&&(i*=256);)n+=this[e+--t]*i;return n},u.prototype.readUInt8=function(e,t){return t||$(e,1,this.length),this[e]},u.prototype.readUInt16LE=function(e,t){return t||$(e,2,this.length),this[e]|this[e+1]<<8},u.prototype.readUInt16BE=function(e,t){return t||$(e,2,this.length),this[e]<<8|this[e+1]},u.prototype.readUInt32LE=function(e,t){return t||$(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},u.prototype.readUInt32BE=function(e,t){return t||$(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},u.prototype.readIntLE=function(e,t,r){e|=0,t|=0,r||$(e,t,this.length);for(var n=this[e],i=1,o=0;++o<t&&(i*=256);)n+=this[e+o]*i;return n>=(i*=128)&&(n-=Math.pow(2,8*t)),n},u.prototype.readIntBE=function(e,t,r){e|=0,t|=0,r||$(e,t,this.length);for(var n=t,i=1,o=this[e+--n];n>0&&(i*=256);)o+=this[e+--n]*i;return o>=(i*=128)&&(o-=Math.pow(2,8*t)),o},u.prototype.readInt8=function(e,t){return t||$(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},u.prototype.readInt16LE=function(e,t){t||$(e,2,this.length);var r=this[e]|this[e+1]<<8;return 32768&r?4294901760|r:r},u.prototype.readInt16BE=function(e,t){t||$(e,2,this.length);var r=this[e+1]|this[e]<<8;return 32768&r?4294901760|r:r},u.prototype.readInt32LE=function(e,t){return t||$(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},u.prototype.readInt32BE=function(e,t){return t||$(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},u.prototype.readFloatLE=function(e,t){return t||$(e,4,this.length),i.read(this,e,!0,23,4)},u.prototype.readFloatBE=function(e,t){return t||$(e,4,this.length),i.read(this,e,!1,23,4)},u.prototype.readDoubleLE=function(e,t){return t||$(e,8,this.length),i.read(this,e,!0,52,8)},u.prototype.readDoubleBE=function(e,t){return t||$(e,8,this.length),i.read(this,e,!1,52,8)},u.prototype.writeUIntLE=function(e,t,r,n){(e=+e,t|=0,r|=0,n)||R(this,e,t,r,Math.pow(2,8*r)-1,0);var i=1,o=0;for(this[t]=255&e;++o<r&&(i*=256);)this[t+o]=e/i&255;return t+r},u.prototype.writeUIntBE=function(e,t,r,n){(e=+e,t|=0,r|=0,n)||R(this,e,t,r,Math.pow(2,8*r)-1,0);var i=r-1,o=1;for(this[t+i]=255&e;--i>=0&&(o*=256);)this[t+i]=e/o&255;return t+r},u.prototype.writeUInt8=function(e,t,r){return e=+e,t|=0,r||R(this,e,t,1,255,0),u.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},u.prototype.writeUInt16LE=function(e,t,r){return e=+e,t|=0,r||R(this,e,t,2,65535,0),u.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):D(this,e,t,!0),t+2},u.prototype.writeUInt16BE=function(e,t,r){return e=+e,t|=0,r||R(this,e,t,2,65535,0),u.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):D(this,e,t,!1),t+2},u.prototype.writeUInt32LE=function(e,t,r){return e=+e,t|=0,r||R(this,e,t,4,4294967295,0),u.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):M(this,e,t,!0),t+4},u.prototype.writeUInt32BE=function(e,t,r){return e=+e,t|=0,r||R(this,e,t,4,4294967295,0),u.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):M(this,e,t,!1),t+4},u.prototype.writeIntLE=function(e,t,r,n){if(e=+e,t|=0,!n){var i=Math.pow(2,8*r-1);R(this,e,t,r,i-1,-i)}var o=0,a=1,s=0;for(this[t]=255&e;++o<r&&(a*=256);)e<0&&0===s&&0!==this[t+o-1]&&(s=1),this[t+o]=(e/a|0)-s&255;return t+r},u.prototype.writeIntBE=function(e,t,r,n){if(e=+e,t|=0,!n){var i=Math.pow(2,8*r-1);R(this,e,t,r,i-1,-i)}var o=r-1,a=1,s=0;for(this[t+o]=255&e;--o>=0&&(a*=256);)e<0&&0===s&&0!==this[t+o+1]&&(s=1),this[t+o]=(e/a|0)-s&255;return t+r},u.prototype.writeInt8=function(e,t,r){return e=+e,t|=0,r||R(this,e,t,1,127,-128),u.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},u.prototype.writeInt16LE=function(e,t,r){return e=+e,t|=0,r||R(this,e,t,2,32767,-32768),u.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):D(this,e,t,!0),t+2},u.prototype.writeInt16BE=function(e,t,r){return e=+e,t|=0,r||R(this,e,t,2,32767,-32768),u.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):D(this,e,t,!1),t+2},u.prototype.writeInt32LE=function(e,t,r){return e=+e,t|=0,r||R(this,e,t,4,2147483647,-2147483648),u.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):M(this,e,t,!0),t+4},u.prototype.writeInt32BE=function(e,t,r){return e=+e,t|=0,r||R(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),u.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):M(this,e,t,!1),t+4},u.prototype.writeFloatLE=function(e,t,r){return B(this,e,t,!0,r)},u.prototype.writeFloatBE=function(e,t,r){return B(this,e,t,!1,r)},u.prototype.writeDoubleLE=function(e,t,r){return N(this,e,t,!0,r)},u.prototype.writeDoubleBE=function(e,t,r){return N(this,e,t,!1,r)},u.prototype.copy=function(e,t,r,n){if(r||(r=0),n||0===n||(n=this.length),t>=e.length&&(t=e.length),t||(t=0),n>0&&n<r&&(n=r),n===r)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("sourceStart out of bounds");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),e.length-t<n-r&&(n=e.length-t+r);var i,o=n-r;if(this===e&&r<t&&t<n)for(i=o-1;i>=0;--i)e[i+t]=this[i+r];else if(o<1e3||!u.TYPED_ARRAY_SUPPORT)for(i=0;i<o;++i)e[i+t]=this[i+r];else Uint8Array.prototype.set.call(e,this.subarray(r,r+o),t);return o},u.prototype.fill=function(e,t,r,n){if("string"==typeof e){if("string"==typeof t?(n=t,t=0,r=this.length):"string"==typeof r&&(n=r,r=this.length),1===e.length){var i=e.charCodeAt(0);i<256&&(e=i)}if(void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!u.isEncoding(n))throw new TypeError("Unknown encoding: "+n)}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<r)throw new RangeError("Out of range index");if(r<=t)return this;var o;if(t>>>=0,r=void 0===r?this.length:r>>>0,e||(e=0),"number"==typeof e)for(o=t;o<r;++o)this[o]=e;else{var a=u.isBuffer(e)?e:j(new u(e,n).toString()),s=a.length;for(o=0;o<r-t;++o)this[o+t]=a[o%s]}return this};var F=/[^+\/0-9A-Za-z-_]/g;function U(e){return e<16?"0"+e.toString(16):e.toString(16)}function j(e,t){var r;t=t||1/0;for(var n=e.length,i=null,o=[],a=0;a<n;++a){if((r=e.charCodeAt(a))>55295&&r<57344){if(!i){if(r>56319){(t-=3)>-1&&o.push(239,191,189);continue}if(a+1===n){(t-=3)>-1&&o.push(239,191,189);continue}i=r;continue}if(r<56320){(t-=3)>-1&&o.push(239,191,189),i=r;continue}r=65536+(i-55296<<10|r-56320)}else i&&(t-=3)>-1&&o.push(239,191,189);if(i=null,r<128){if((t-=1)<0)break;o.push(r)}else if(r<2048){if((t-=2)<0)break;o.push(r>>6|192,63&r|128)}else if(r<65536){if((t-=3)<0)break;o.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;o.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return o}function z(e){return n.toByteArray(function(e){if((e=function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}(e).replace(F,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function G(e,t,r,n){for(var i=0;i<n&&!(i+r>=t.length||i>=e.length);++i)t[i+r]=e[i];return i}},3144:(e,t,r)=>{var n=r(6743),i=r(1002),o=r(76),a=r(7119);e.exports=a||n.call(o,i)},1002:e=>{e.exports=Function.prototype.apply},76:e=>{e.exports=Function.prototype.call},3126:(e,t,r)=>{var n=r(6743),i=r(9675),o=r(76),a=r(3144);e.exports=function(e){if(e.length<1||"function"!=typeof e[0])throw new i("a function is required");return a(n,o,e)}},7119:e=>{e.exports="undefined"!=typeof Reflect&&Reflect&&Reflect.apply},6556:(e,t,r)=>{var n=r(453),i=r(3126),o=i([n("%String.prototype.indexOf%")]);e.exports=function(e,t){var r=n(e,!!t);return"function"==typeof r&&o(e,".prototype.")>-1?i([r]):r}},7176:(e,t,r)=>{var n,i=r(3126),o=r(5795);try{n=[].__proto__===Array.prototype}catch(e){if(!e||"object"!=typeof e||!("code"in e)||"ERR_PROTO_ACCESS"!==e.code)throw e}var a=!!n&&o&&o(Object.prototype,"__proto__"),s=Object,u=s.getPrototypeOf;e.exports=a&&"function"==typeof a.get?i([a.get]):"function"==typeof u&&function(e){return u(null==e?e:s(e))}},6570:e=>{function t(e,t,n){n=n||2;var o,a,s,u,c,f,p,y=t&&t.length,m=y?t[0]*n:e.length,g=r(e,0,m,n,!0),w=[];if(!g||g.next===g.prev)return w;if(y&&(g=function(e,t,n,i){var o,a,s,u=[];for(o=0,a=t.length;o<a;o++)(s=r(e,t[o]*i,o<a-1?t[o+1]*i:e.length,i,!1))===s.next&&(s.steiner=!0),u.push(d(s));for(u.sort(l),o=0;o<u.length;o++)n=h(u[o],n);return n}(e,t,g,n)),e.length>80*n){o=s=e[0],a=u=e[1];for(var v=n;v<m;v+=n)(c=e[v])<o&&(o=c),(f=e[v+1])<a&&(a=f),c>s&&(s=c),f>u&&(u=f);p=0!==(p=Math.max(s-o,u-a))?32767/p:0}return i(g,w,n,o,a,p,0),w}function r(e,t,r,n,i){var o,a;if(i===O(e,t,r,n)>0)for(o=t;o<r;o+=n)a=S(o,e[o],e[o+1],a);else for(o=r-n;o>=t;o-=n)a=S(o,e[o],e[o+1],a);return a&&g(a,a.next)&&(T(a),a=a.next),a}function n(e,t){if(!e)return e;t||(t=e);var r,n=e;do{if(r=!1,n.steiner||!g(n,n.next)&&0!==m(n.prev,n,n.next))n=n.next;else{if(T(n),(n=t=n.prev)===n.next)break;r=!0}}while(r||n!==t);return t}function i(e,t,r,l,h,c,d){if(e){!d&&c&&function(e,t,r,n){var i=e;do{0===i.z&&(i.z=f(i.x,i.y,t,r,n)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next}while(i!==e);i.prevZ.nextZ=null,i.prevZ=null,function(e){var t,r,n,i,o,a,s,u,l=1;do{for(r=e,e=null,o=null,a=0;r;){for(a++,n=r,s=0,t=0;t<l&&(s++,n=n.nextZ);t++);for(u=l;s>0||u>0&&n;)0!==s&&(0===u||!n||r.z<=n.z)?(i=r,r=r.nextZ,s--):(i=n,n=n.nextZ,u--),o?o.nextZ=i:e=i,i.prevZ=o,o=i;r=n}o.nextZ=null,l*=2}while(a>1)}(i)}(e,l,h,c);for(var p,y,m=e;e.prev!==e.next;)if(p=e.prev,y=e.next,c?a(e,l,h,c):o(e))t.push(p.i/r|0),t.push(e.i/r|0),t.push(y.i/r|0),T(e),e=y.next,m=y.next;else if((e=y)===m){d?1===d?i(e=s(n(e),t,r),t,r,l,h,c,2):2===d&&u(e,t,r,l,h,c):i(n(e),t,r,l,h,c,1);break}}}function o(e){var t=e.prev,r=e,n=e.next;if(m(t,r,n)>=0)return!1;for(var i=t.x,o=r.x,a=n.x,s=t.y,u=r.y,l=n.y,h=i<o?i<a?i:a:o<a?o:a,c=s<u?s<l?s:l:u<l?u:l,f=i>o?i>a?i:a:o>a?o:a,d=s>u?s>l?s:l:u>l?u:l,y=n.next;y!==t;){if(y.x>=h&&y.x<=f&&y.y>=c&&y.y<=d&&p(i,s,o,u,a,l,y.x,y.y)&&m(y.prev,y,y.next)>=0)return!1;y=y.next}return!0}function a(e,t,r,n){var i=e.prev,o=e,a=e.next;if(m(i,o,a)>=0)return!1;for(var s=i.x,u=o.x,l=a.x,h=i.y,c=o.y,d=a.y,y=s<u?s<l?s:l:u<l?u:l,g=h<c?h<d?h:d:c<d?c:d,w=s>u?s>l?s:l:u>l?u:l,v=h>c?h>d?h:d:c>d?c:d,b=f(y,g,t,r,n),x=f(w,v,t,r,n),_=e.prevZ,S=e.nextZ;_&&_.z>=b&&S&&S.z<=x;){if(_.x>=y&&_.x<=w&&_.y>=g&&_.y<=v&&_!==i&&_!==a&&p(s,h,u,c,l,d,_.x,_.y)&&m(_.prev,_,_.next)>=0)return!1;if(_=_.prevZ,S.x>=y&&S.x<=w&&S.y>=g&&S.y<=v&&S!==i&&S!==a&&p(s,h,u,c,l,d,S.x,S.y)&&m(S.prev,S,S.next)>=0)return!1;S=S.nextZ}for(;_&&_.z>=b;){if(_.x>=y&&_.x<=w&&_.y>=g&&_.y<=v&&_!==i&&_!==a&&p(s,h,u,c,l,d,_.x,_.y)&&m(_.prev,_,_.next)>=0)return!1;_=_.prevZ}for(;S&&S.z<=x;){if(S.x>=y&&S.x<=w&&S.y>=g&&S.y<=v&&S!==i&&S!==a&&p(s,h,u,c,l,d,S.x,S.y)&&m(S.prev,S,S.next)>=0)return!1;S=S.nextZ}return!0}function s(e,t,r){var i=e;do{var o=i.prev,a=i.next.next;!g(o,a)&&w(o,i,i.next,a)&&x(o,a)&&x(a,o)&&(t.push(o.i/r|0),t.push(i.i/r|0),t.push(a.i/r|0),T(i),T(i.next),i=e=a),i=i.next}while(i!==e);return n(i)}function u(e,t,r,o,a,s){var u=e;do{for(var l=u.next.next;l!==u.prev;){if(u.i!==l.i&&y(u,l)){var h=_(u,l);return u=n(u,u.next),h=n(h,h.next),i(u,t,r,o,a,s,0),void i(h,t,r,o,a,s,0)}l=l.next}u=u.next}while(u!==e)}function l(e,t){return e.x-t.x}function h(e,t){var r=function(e,t){var r,n=t,i=e.x,o=e.y,a=-1/0;do{if(o<=n.y&&o>=n.next.y&&n.next.y!==n.y){var s=n.x+(o-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(s<=i&&s>a&&(a=s,r=n.x<n.next.x?n:n.next,s===i))return r}n=n.next}while(n!==t);if(!r)return null;var u,l=r,h=r.x,f=r.y,d=1/0;n=r;do{i>=n.x&&n.x>=h&&i!==n.x&&p(o<f?i:a,o,h,f,o<f?a:i,o,n.x,n.y)&&(u=Math.abs(o-n.y)/(i-n.x),x(n,e)&&(u<d||u===d&&(n.x>r.x||n.x===r.x&&c(r,n)))&&(r=n,d=u)),n=n.next}while(n!==l);return r}(e,t);if(!r)return t;var i=_(r,e);return n(i,i.next),n(r,r.next)}function c(e,t){return m(e.prev,e,t.prev)<0&&m(t.next,e,e.next)<0}function f(e,t,r,n,i){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-r)*i|0)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-n)*i|0)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function d(e){var t=e,r=e;do{(t.x<r.x||t.x===r.x&&t.y<r.y)&&(r=t),t=t.next}while(t!==e);return r}function p(e,t,r,n,i,o,a,s){return(i-a)*(t-s)>=(e-a)*(o-s)&&(e-a)*(n-s)>=(r-a)*(t-s)&&(r-a)*(o-s)>=(i-a)*(n-s)}function y(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(e,t){var r=e;do{if(r.i!==e.i&&r.next.i!==e.i&&r.i!==t.i&&r.next.i!==t.i&&w(r,r.next,e,t))return!0;r=r.next}while(r!==e);return!1}(e,t)&&(x(e,t)&&x(t,e)&&function(e,t){var r=e,n=!1,i=(e.x+t.x)/2,o=(e.y+t.y)/2;do{r.y>o!=r.next.y>o&&r.next.y!==r.y&&i<(r.next.x-r.x)*(o-r.y)/(r.next.y-r.y)+r.x&&(n=!n),r=r.next}while(r!==e);return n}(e,t)&&(m(e.prev,e,t.prev)||m(e,t.prev,t))||g(e,t)&&m(e.prev,e,e.next)>0&&m(t.prev,t,t.next)>0)}function m(e,t,r){return(t.y-e.y)*(r.x-t.x)-(t.x-e.x)*(r.y-t.y)}function g(e,t){return e.x===t.x&&e.y===t.y}function w(e,t,r,n){var i=b(m(e,t,r)),o=b(m(e,t,n)),a=b(m(r,n,e)),s=b(m(r,n,t));return i!==o&&a!==s||(!(0!==i||!v(e,r,t))||(!(0!==o||!v(e,n,t))||(!(0!==a||!v(r,e,n))||!(0!==s||!v(r,t,n)))))}function v(e,t,r){return t.x<=Math.max(e.x,r.x)&&t.x>=Math.min(e.x,r.x)&&t.y<=Math.max(e.y,r.y)&&t.y>=Math.min(e.y,r.y)}function b(e){return e>0?1:e<0?-1:0}function x(e,t){return m(e.prev,e,e.next)<0?m(e,t,e.next)>=0&&m(e,e.prev,t)>=0:m(e,t,e.prev)<0||m(e,e.next,t)<0}function _(e,t){var r=new E(e.i,e.x,e.y),n=new E(t.i,t.x,t.y),i=e.next,o=t.prev;return e.next=t,t.prev=e,r.next=i,i.prev=r,n.next=r,r.prev=n,o.next=n,n.prev=o,n}function S(e,t,r,n){var i=new E(e,t,r);return n?(i.next=n.next,i.prev=n,n.next.prev=i,n.next=i):(i.prev=i,i.next=i),i}function T(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function E(e,t,r){this.i=e,this.x=t,this.y=r,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function O(e,t,r,n){for(var i=0,o=t,a=r-n;o<r;o+=n)i+=(e[a]-e[o])*(e[o+1]+e[a+1]),a=o;return i}e.exports=t,e.exports.default=t,t.deviation=function(e,t,r,n){var i=t&&t.length,o=i?t[0]*r:e.length,a=Math.abs(O(e,0,o,r));if(i)for(var s=0,u=t.length;s<u;s++){var l=t[s]*r,h=s<u-1?t[s+1]*r:e.length;a-=Math.abs(O(e,l,h,r))}var c=0;for(s=0;s<n.length;s+=3){var f=n[s]*r,d=n[s+1]*r,p=n[s+2]*r;c+=Math.abs((e[f]-e[p])*(e[d+1]-e[f+1])-(e[f]-e[d])*(e[p+1]-e[f+1]))}return 0===a&&0===c?0:Math.abs((c-a)/a)},t.flatten=function(e){for(var t=e[0][0].length,r={vertices:[],holes:[],dimensions:t},n=0,i=0;i<e.length;i++){for(var o=0;o<e[i].length;o++)for(var a=0;a<t;a++)r.vertices.push(e[i][o][a]);i>0&&(n+=e[i-1].length,r.holes.push(n))}return r}},655:e=>{var t=Object.defineProperty||!1;if(t)try{t({},"a",{value:1})}catch(e){t=!1}e.exports=t},1237:e=>{e.exports=EvalError},9383:e=>{e.exports=Error},9290:e=>{e.exports=RangeError},9538:e=>{e.exports=ReferenceError},8068:e=>{e.exports=SyntaxError},9675:e=>{e.exports=TypeError},5345:e=>{e.exports=URIError},9612:e=>{e.exports=Object},228:e=>{var t=Object.prototype.hasOwnProperty,r="~";function n(){}function i(e,t,r){this.fn=e,this.context=t,this.once=r||!1}function o(e,t,n,o,a){if("function"!=typeof n)throw new TypeError("The listener must be a function");var s=new i(n,o||e,a),u=r?r+t:t;return e._events[u]?e._events[u].fn?e._events[u]=[e._events[u],s]:e._events[u].push(s):(e._events[u]=s,e._eventsCount++),e}function a(e,t){0==--e._eventsCount?e._events=new n:delete e._events[t]}function s(){this._events=new n,this._eventsCount=0}Object.create&&(n.prototype=Object.create(null),(new n).__proto__||(r=!1)),s.prototype.eventNames=function(){var e,n,i=[];if(0===this._eventsCount)return i;for(n in e=this._events)t.call(e,n)&&i.push(r?n.slice(1):n);return Object.getOwnPropertySymbols?i.concat(Object.getOwnPropertySymbols(e)):i},s.prototype.listeners=function(e){var t=r?r+e:e,n=this._events[t];if(!n)return[];if(n.fn)return[n.fn];for(var i=0,o=n.length,a=new Array(o);i<o;i++)a[i]=n[i].fn;return a},s.prototype.listenerCount=function(e){var t=r?r+e:e,n=this._events[t];return n?n.fn?1:n.length:0},s.prototype.emit=function(e,t,n,i,o,a){var s=r?r+e:e;if(!this._events[s])return!1;var u,l,h=this._events[s],c=arguments.length;if(h.fn){switch(h.once&&this.removeListener(e,h.fn,void 0,!0),c){case 1:return h.fn.call(h.context),!0;case 2:return h.fn.call(h.context,t),!0;case 3:return h.fn.call(h.context,t,n),!0;case 4:return h.fn.call(h.context,t,n,i),!0;case 5:return h.fn.call(h.context,t,n,i,o),!0;case 6:return h.fn.call(h.context,t,n,i,o,a),!0}for(l=1,u=new Array(c-1);l<c;l++)u[l-1]=arguments[l];h.fn.apply(h.context,u)}else{var f,d=h.length;for(l=0;l<d;l++)switch(h[l].once&&this.removeListener(e,h[l].fn,void 0,!0),c){case 1:h[l].fn.call(h[l].context);break;case 2:h[l].fn.call(h[l].context,t);break;case 3:h[l].fn.call(h[l].context,t,n);break;case 4:h[l].fn.call(h[l].context,t,n,i);break;default:if(!u)for(f=1,u=new Array(c-1);f<c;f++)u[f-1]=arguments[f];h[l].fn.apply(h[l].context,u)}}return!0},s.prototype.on=function(e,t,r){return o(this,e,t,r,!1)},s.prototype.once=function(e,t,r){return o(this,e,t,r,!0)},s.prototype.removeListener=function(e,t,n,i){var o=r?r+e:e;if(!this._events[o])return this;if(!t)return a(this,o),this;var s=this._events[o];if(s.fn)s.fn!==t||i&&!s.once||n&&s.context!==n||a(this,o);else{for(var u=0,l=[],h=s.length;u<h;u++)(s[u].fn!==t||i&&!s[u].once||n&&s[u].context!==n)&&l.push(s[u]);l.length?this._events[o]=1===l.length?l[0]:l:a(this,o)}return this},s.prototype.removeAllListeners=function(e){var t;return e?(t=r?r+e:e,this._events[t]&&a(this,t)):(this._events=new n,this._eventsCount=0),this},s.prototype.off=s.prototype.removeListener,s.prototype.addListener=s.prototype.on,s.prefixed=r,s.EventEmitter=s,e.exports=s},8389:function(e,t){!function(e){var t=function(e){return function(t){var r=e(t);return t.add(r),r}},r=function(e){return function(t,r){return e.set(t,r),r}},n=void 0===Number.MAX_SAFE_INTEGER?9007199254740991:Number.MAX_SAFE_INTEGER,i=536870912,o=2*i,a=function(e,t){return function(r){var a=t.get(r),s=void 0===a?r.size:a<o?a+1:0;if(!r.has(s))return e(r,s);if(r.size<i){for(;r.has(s);)s=Math.floor(Math.random()*o);return e(r,s)}if(r.size>n)throw new Error("Congratulations, you created a collection of unique numbers which uses all available integers!");for(;r.has(s);)s=Math.floor(Math.random()*n);return e(r,s)}},s=new WeakMap,u=r(s),l=a(u,s),h=t(l);e.addUniqueNumber=h,e.generateUniqueNumber=l}(t)},1707:(e,t,r)=>{var n,i;void 0===(i="function"==typeof(n=function(){var e={172351395:{name:"EBML",type:"Container"},646:{name:"EBMLVersion",type:"Uint"},759:{name:"EBMLReadVersion",type:"Uint"},754:{name:"EBMLMaxIDLength",type:"Uint"},755:{name:"EBMLMaxSizeLength",type:"Uint"},642:{name:"DocType",type:"String"},647:{name:"DocTypeVersion",type:"Uint"},645:{name:"DocTypeReadVersion",type:"Uint"},108:{name:"Void",type:"Binary"},63:{name:"CRC-32",type:"Binary"},190023271:{name:"SignatureSlot",type:"Container"},16010:{name:"SignatureAlgo",type:"Uint"},16026:{name:"SignatureHash",type:"Uint"},16037:{name:"SignaturePublicKey",type:"Binary"},16053:{name:"Signature",type:"Binary"},15963:{name:"SignatureElements",type:"Container"},15995:{name:"SignatureElementList",type:"Container"},9522:{name:"SignedElement",type:"Binary"},139690087:{name:"Segment",type:"Container"},21863284:{name:"SeekHead",type:"Container"},3515:{name:"Seek",type:"Container"},5035:{name:"SeekID",type:"Binary"},5036:{name:"SeekPosition",type:"Uint"},88713574:{name:"Info",type:"Container"},13220:{name:"SegmentUID",type:"Binary"},13188:{name:"SegmentFilename",type:"String"},1882403:{name:"PrevUID",type:"Binary"},1868715:{name:"PrevFilename",type:"String"},2013475:{name:"NextUID",type:"Binary"},1999803:{name:"NextFilename",type:"String"},1092:{name:"SegmentFamily",type:"Binary"},10532:{name:"ChapterTranslate",type:"Container"},10748:{name:"ChapterTranslateEditionUID",type:"Uint"},10687:{name:"ChapterTranslateCodec",type:"Uint"},10661:{name:"ChapterTranslateID",type:"Binary"},710577:{name:"TimecodeScale",type:"Uint"},1161:{name:"Duration",type:"Float"},1121:{name:"DateUTC",type:"Date"},15273:{name:"Title",type:"String"},3456:{name:"MuxingApp",type:"String"},5953:{name:"WritingApp",type:"String"},103:{name:"Timecode",type:"Uint"},6228:{name:"SilentTracks",type:"Container"},6359:{name:"SilentTrackNumber",type:"Uint"},39:{name:"Position",type:"Uint"},43:{name:"PrevSize",type:"Uint"},35:{name:"SimpleBlock",type:"Binary"},32:{name:"BlockGroup",type:"Container"},33:{name:"Block",type:"Binary"},34:{name:"BlockVirtual",type:"Binary"},13729:{name:"BlockAdditions",type:"Container"},38:{name:"BlockMore",type:"Container"},110:{name:"BlockAddID",type:"Uint"},37:{name:"BlockAdditional",type:"Binary"},27:{name:"BlockDuration",type:"Uint"},122:{name:"ReferencePriority",type:"Uint"},123:{name:"ReferenceBlock",type:"Int"},125:{name:"ReferenceVirtual",type:"Int"},36:{name:"CodecState",type:"Binary"},13730:{name:"DiscardPadding",type:"Int"},14:{name:"Slices",type:"Container"},104:{name:"TimeSlice",type:"Container"},76:{name:"LaceNumber",type:"Uint"},77:{name:"FrameNumber",type:"Uint"},75:{name:"BlockAdditionID",type:"Uint"},78:{name:"Delay",type:"Uint"},79:{name:"SliceDuration",type:"Uint"},72:{name:"ReferenceFrame",type:"Container"},73:{name:"ReferenceOffset",type:"Uint"},74:{name:"ReferenceTimeCode",type:"Uint"},47:{name:"EncryptedBlock",type:"Binary"},106212971:{name:"Tracks",type:"Container"},46:{name:"TrackEntry",type:"Container"},87:{name:"TrackNumber",type:"Uint"},13253:{name:"TrackUID",type:"Uint"},3:{name:"TrackType",type:"Uint"},57:{name:"FlagEnabled",type:"Uint"},8:{name:"FlagDefault",type:"Uint"},5546:{name:"FlagForced",type:"Uint"},28:{name:"FlagLacing",type:"Uint"},11751:{name:"MinCache",type:"Uint"},11768:{name:"MaxCache",type:"Uint"},254851:{name:"DefaultDuration",type:"Uint"},216698:{name:"DefaultDecodedFieldDuration",type:"Uint"},209231:{name:"TrackTimecodeScale",type:"Float"},4991:{name:"TrackOffset",type:"Int"},5614:{name:"MaxBlockAdditionID",type:"Uint"},4974:{name:"Name",type:"String"},177564:{name:"Language",type:"String"},6:{name:"CodecID",type:"String"},9122:{name:"CodecPrivate",type:"Binary"},362120:{name:"CodecName",type:"String"},13382:{name:"AttachmentLink",type:"Uint"},1742487:{name:"CodecSettings",type:"String"},1785920:{name:"CodecInfoURL",type:"String"},438848:{name:"CodecDownloadURL",type:"String"},42:{name:"CodecDecodeAll",type:"Uint"},12203:{name:"TrackOverlay",type:"Uint"},5802:{name:"CodecDelay",type:"Uint"},5819:{name:"SeekPreRoll",type:"Uint"},9764:{name:"TrackTranslate",type:"Container"},9980:{name:"TrackTranslateEditionUID",type:"Uint"},9919:{name:"TrackTranslateCodec",type:"Uint"},9893:{name:"TrackTranslateTrackID",type:"Binary"},96:{name:"Video",type:"Container"},26:{name:"FlagInterlaced",type:"Uint"},5048:{name:"StereoMode",type:"Uint"},5056:{name:"AlphaMode",type:"Uint"},5049:{name:"OldStereoMode",type:"Uint"},48:{name:"PixelWidth",type:"Uint"},58:{name:"PixelHeight",type:"Uint"},5290:{name:"PixelCropBottom",type:"Uint"},5307:{name:"PixelCropTop",type:"Uint"},5324:{name:"PixelCropLeft",type:"Uint"},5341:{name:"PixelCropRight",type:"Uint"},5296:{name:"DisplayWidth",type:"Uint"},5306:{name:"DisplayHeight",type:"Uint"},5298:{name:"DisplayUnit",type:"Uint"},5299:{name:"AspectRatioType",type:"Uint"},963876:{name:"ColourSpace",type:"Binary"},1029411:{name:"GammaValue",type:"Float"},230371:{name:"FrameRate",type:"Float"},97:{name:"Audio",type:"Container"},53:{name:"SamplingFrequency",type:"Float"},14517:{name:"OutputSamplingFrequency",type:"Float"},31:{name:"Channels",type:"Uint"},15739:{name:"ChannelPositions",type:"Binary"},8804:{name:"BitDepth",type:"Uint"},98:{name:"TrackOperation",type:"Container"},99:{name:"TrackCombinePlanes",type:"Container"},100:{name:"TrackPlane",type:"Container"},101:{name:"TrackPlaneUID",type:"Uint"},102:{name:"TrackPlaneType",type:"Uint"},105:{name:"TrackJoinBlocks",type:"Container"},109:{name:"TrackJoinUID",type:"Uint"},64:{name:"TrickTrackUID",type:"Uint"},65:{name:"TrickTrackSegmentUID",type:"Binary"},70:{name:"TrickTrackFlag",type:"Uint"},71:{name:"TrickMasterTrackUID",type:"Uint"},68:{name:"TrickMasterTrackSegmentUID",type:"Binary"},11648:{name:"ContentEncodings",type:"Container"},8768:{name:"ContentEncoding",type:"Container"},4145:{name:"ContentEncodingOrder",type:"Uint"},4146:{name:"ContentEncodingScope",type:"Uint"},4147:{name:"ContentEncodingType",type:"Uint"},4148:{name:"ContentCompression",type:"Container"},596:{name:"ContentCompAlgo",type:"Uint"},597:{name:"ContentCompSettings",type:"Binary"},4149:{name:"ContentEncryption",type:"Container"},2017:{name:"ContentEncAlgo",type:"Uint"},2018:{name:"ContentEncKeyID",type:"Binary"},2019:{name:"ContentSignature",type:"Binary"},2020:{name:"ContentSigKeyID",type:"Binary"},2021:{name:"ContentSigAlgo",type:"Uint"},2022:{name:"ContentSigHashAlgo",type:"Uint"},206814059:{name:"Cues",type:"Container"},59:{name:"CuePoint",type:"Container"},51:{name:"CueTime",type:"Uint"},55:{name:"CueTrackPositions",type:"Container"},119:{name:"CueTrack",type:"Uint"},113:{name:"CueClusterPosition",type:"Uint"},112:{name:"CueRelativePosition",type:"Uint"},50:{name:"CueDuration",type:"Uint"},4984:{name:"CueBlockNumber",type:"Uint"},106:{name:"CueCodecState",type:"Uint"},91:{name:"CueReference",type:"Container"},22:{name:"CueRefTime",type:"Uint"},23:{name:"CueRefCluster",type:"Uint"},4959:{name:"CueRefNumber",type:"Uint"},107:{name:"CueRefCodecState",type:"Uint"},155296873:{name:"Attachments",type:"Container"},8615:{name:"AttachedFile",type:"Container"},1662:{name:"FileDescription",type:"String"},1646:{name:"FileName",type:"String"},1632:{name:"FileMimeType",type:"String"},1628:{name:"FileData",type:"Binary"},1710:{name:"FileUID",type:"Uint"},1653:{name:"FileReferral",type:"Binary"},1633:{name:"FileUsedStartTime",type:"Uint"},1634:{name:"FileUsedEndTime",type:"Uint"},4433776:{name:"Chapters",type:"Container"},1465:{name:"EditionEntry",type:"Container"},1468:{name:"EditionUID",type:"Uint"},1469:{name:"EditionFlagHidden",type:"Uint"},1499:{name:"EditionFlagDefault",type:"Uint"},1501:{name:"EditionFlagOrdered",type:"Uint"},54:{name:"ChapterAtom",type:"Container"},13252:{name:"ChapterUID",type:"Uint"},5716:{name:"ChapterStringUID",type:"String"},17:{name:"ChapterTimeStart",type:"Uint"},18:{name:"ChapterTimeEnd",type:"Uint"},24:{name:"ChapterFlagHidden",type:"Uint"},1432:{name:"ChapterFlagEnabled",type:"Uint"},11879:{name:"ChapterSegmentUID",type:"Binary"},11964:{name:"ChapterSegmentEditionUID",type:"Uint"},9155:{name:"ChapterPhysicalEquiv",type:"Uint"},15:{name:"ChapterTrack",type:"Container"},9:{name:"ChapterTrackNumber",type:"Uint"},0:{name:"ChapterDisplay",type:"Container"},5:{name:"ChapString",type:"String"},892:{name:"ChapLanguage",type:"String"},894:{name:"ChapCountry",type:"String"},10564:{name:"ChapProcess",type:"Container"},10581:{name:"ChapProcessCodecID",type:"Uint"},1293:{name:"ChapProcessPrivate",type:"Binary"},10513:{name:"ChapProcessCommand",type:"Container"},10530:{name:"ChapProcessTime",type:"Uint"},10547:{name:"ChapProcessData",type:"Binary"},39109479:{name:"Tags",type:"Container"},13171:{name:"Tag",type:"Container"},9152:{name:"Targets",type:"Container"},10442:{name:"TargetTypeValue",type:"Uint"},9162:{name:"TargetType",type:"String"},9157:{name:"TagTrackUID",type:"Uint"},9161:{name:"TagEditionUID",type:"Uint"},9156:{name:"TagChapterUID",type:"Uint"},9158:{name:"TagAttachmentUID",type:"Uint"},10184:{name:"SimpleTag",type:"Container"},1443:{name:"TagName",type:"String"},1146:{name:"TagLanguage",type:"String"},1156:{name:"TagDefault",type:"Uint"},1159:{name:"TagString",type:"String"},1157:{name:"TagBinary",type:"Binary"}};function t(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e}function r(e,t){this.name=e||"Unknown",this.type=t||"Unknown"}function n(e,t){r.call(this,e,t||"Uint")}function i(e){return e.length%2==1?"0"+e:e}function o(e,t){r.call(this,e,t||"Float")}function a(e,t){r.call(this,e,t||"Container")}function s(e){a.call(this,"File","File"),this.setSource(e)}function u(e,t,r,n){if("object"==typeof r&&(n=r,r=void 0),!r)return new Promise((function(r){u(e,t,r,n)}));try{var i=new FileReader;i.onloadend=function(){try{var o=new s(new Uint8Array(i.result));o.fixDuration(t,n)&&(e=o.toBlob(e.type))}catch(e){}r(e)},i.readAsArrayBuffer(e)}catch(t){r(e)}}return r.prototype.updateBySource=function(){},r.prototype.setSource=function(e){this.source=e,this.updateBySource()},r.prototype.updateByData=function(){},r.prototype.setData=function(e){this.data=e,this.updateByData()},t(n,r),n.prototype.updateBySource=function(){this.data="";for(var e=0;e<this.source.length;e++){var t=this.source[e].toString(16);this.data+=i(t)}},n.prototype.updateByData=function(){var e=this.data.length/2;this.source=new Uint8Array(e);for(var t=0;t<e;t++){var r=this.data.substr(2*t,2);this.source[t]=parseInt(r,16)}},n.prototype.getValue=function(){return parseInt(this.data,16)},n.prototype.setValue=function(e){this.setData(i(e.toString(16)))},t(o,r),o.prototype.getFloatArrayType=function(){return this.source&&4===this.source.length?Float32Array:Float64Array},o.prototype.updateBySource=function(){var e=this.source.reverse(),t=new(this.getFloatArrayType())(e.buffer);this.data=t[0]},o.prototype.updateByData=function(){var e=new(this.getFloatArrayType())([this.data]),t=new Uint8Array(e.buffer);this.source=t.reverse()},o.prototype.getValue=function(){return this.data},o.prototype.setValue=function(e){this.setData(e)},t(a,r),a.prototype.readByte=function(){return this.source[this.offset++]},a.prototype.readUint=function(){for(var e=this.readByte(),t=8-e.toString(2).length,r=e-(1<<7-t),n=0;n<t;n++)r*=256,r+=this.readByte();return r},a.prototype.updateBySource=function(){for(this.data=[],this.offset=0;this.offset<this.source.length;this.offset=s){var t=this.readUint(),i=this.readUint(),s=Math.min(this.offset+i,this.source.length),u=this.source.slice(this.offset,s),l=e[t]||{name:"Unknown",type:"Unknown"},h=r;switch(l.type){case"Container":h=a;break;case"Uint":h=n;break;case"Float":h=o}var c=new h(l.name,l.type);c.setSource(u),this.data.push({id:t,idHex:t.toString(16),data:c})}},a.prototype.writeUint=function(e,t){for(var r=1,n=128;e>=n&&r<8;r++,n*=128);if(!t)for(var i=n+e,o=r-1;o>=0;o--){var a=i%256;this.source[this.offset+o]=a,i=(i-a)/256}this.offset+=r},a.prototype.writeSections=function(e){this.offset=0;for(var t=0;t<this.data.length;t++){var r=this.data[t],n=r.data.source,i=n.length;this.writeUint(r.id,e),this.writeUint(i,e),e||this.source.set(n,this.offset),this.offset+=i}return this.offset},a.prototype.updateByData=function(){var e=this.writeSections("draft");this.source=new Uint8Array(e),this.writeSections()},a.prototype.getSectionById=function(e){for(var t=0;t<this.data.length;t++){var r=this.data[t];if(r.id===e)return r.data}return null},t(s,a),s.prototype.fixDuration=function(e,t){var r=t&&t.logger;void 0===r?r=function(e){console.log(e)}:r||(r=function(){});var n=this.getSectionById(139690087);if(!n)return r("[fix-webm-duration] Segment section is missing"),!1;var i=n.getSectionById(88713574);if(!i)return r("[fix-webm-duration] Info section is missing"),!1;var a=i.getSectionById(710577);if(!a)return r("[fix-webm-duration] TimecodeScale section is missing"),!1;var s=i.getSectionById(1161);if(s){if(!(s.getValue()<=0))return r(`[fix-webm-duration] Duration section is present, and the value is ${s.getValue()}`),!1;r(`[fix-webm-duration] Duration section is present, but the value is ${s.getValue()}`),s.setValue(e)}else r("[fix-webm-duration] Duration section is missing"),(s=new o("Duration","Float")).setValue(e),i.data.push({id:1161,data:s});return a.setValue(1e6),i.updateByData(),n.updateByData(),this.updateByData(),!0},s.prototype.toBlob=function(e){return new Blob([this.source.buffer],{type:e||"video/webm"})},u.default=u,u})?n.call(t,r,t,e):n)||(e.exports=i)},9353:e=>{var t=Object.prototype.toString,r=Math.max,n=function(e,t){for(var r=[],n=0;n<e.length;n+=1)r[n]=e[n];for(var i=0;i<t.length;i+=1)r[i+e.length]=t[i];return r};e.exports=function(e){var i=this;if("function"!=typeof i||"[object Function]"!==t.apply(i))throw new TypeError("Function.prototype.bind called on incompatible "+i);for(var o,a=function(e,t){for(var r=[],n=t||0,i=0;n<e.length;n+=1,i+=1)r[i]=e[n];return r}(arguments,1),s=r(0,i.length-a.length),u=[],l=0;l<s;l++)u[l]="$"+l;if(o=Function("binder","return function ("+function(e,t){for(var r="",n=0;n<e.length;n+=1)r+=e[n],n+1<e.length&&(r+=t);return r}(u,",")+"){ return binder.apply(this,arguments); }")((function(){if(this instanceof o){var t=i.apply(this,n(a,arguments));return Object(t)===t?t:this}return i.apply(e,n(a,arguments))})),i.prototype){var h=function(){};h.prototype=i.prototype,o.prototype=new h,h.prototype=null}return o}},6743:(e,t,r)=>{var n=r(9353);e.exports=Function.prototype.bind||n},453:(e,t,r)=>{var n,i=r(9612),o=r(9383),a=r(1237),s=r(9290),u=r(9538),l=r(8068),h=r(9675),c=r(5345),f=r(1514),d=r(8968),p=r(6188),y=r(8002),m=r(5880),g=r(414),w=r(3093),v=Function,b=function(e){try{return v('"use strict"; return ('+e+").constructor;")()}catch(e){}},x=r(5795),_=r(655),S=function(){throw new h},T=x?function(){try{return S}catch(e){try{return x(arguments,"callee").get}catch(e){return S}}}():S,E=r(4039)(),O=r(3628),A=r(1064),I=r(8648),P=r(1002),k=r(76),C={},$="undefined"!=typeof Uint8Array&&O?O(Uint8Array):n,R={__proto__:null,"%AggregateError%":"undefined"==typeof AggregateError?n:AggregateError,"%Array%":Array,"%ArrayBuffer%":"undefined"==typeof ArrayBuffer?n:ArrayBuffer,"%ArrayIteratorPrototype%":E&&O?O([][Symbol.iterator]()):n,"%AsyncFromSyncIteratorPrototype%":n,"%AsyncFunction%":C,"%AsyncGenerator%":C,"%AsyncGeneratorFunction%":C,"%AsyncIteratorPrototype%":C,"%Atomics%":"undefined"==typeof Atomics?n:Atomics,"%BigInt%":"undefined"==typeof BigInt?n:BigInt,"%BigInt64Array%":"undefined"==typeof BigInt64Array?n:BigInt64Array,"%BigUint64Array%":"undefined"==typeof BigUint64Array?n:BigUint64Array,"%Boolean%":Boolean,"%DataView%":"undefined"==typeof DataView?n:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":o,"%eval%":eval,"%EvalError%":a,"%Float32Array%":"undefined"==typeof Float32Array?n:Float32Array,"%Float64Array%":"undefined"==typeof Float64Array?n:Float64Array,"%FinalizationRegistry%":"undefined"==typeof FinalizationRegistry?n:FinalizationRegistry,"%Function%":v,"%GeneratorFunction%":C,"%Int8Array%":"undefined"==typeof Int8Array?n:Int8Array,"%Int16Array%":"undefined"==typeof Int16Array?n:Int16Array,"%Int32Array%":"undefined"==typeof Int32Array?n:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":E&&O?O(O([][Symbol.iterator]())):n,"%JSON%":"object"==typeof JSON?JSON:n,"%Map%":"undefined"==typeof Map?n:Map,"%MapIteratorPrototype%":"undefined"!=typeof Map&&E&&O?O((new Map)[Symbol.iterator]()):n,"%Math%":Math,"%Number%":Number,"%Object%":i,"%Object.getOwnPropertyDescriptor%":x,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":"undefined"==typeof Promise?n:Promise,"%Proxy%":"undefined"==typeof Proxy?n:Proxy,"%RangeError%":s,"%ReferenceError%":u,"%Reflect%":"undefined"==typeof Reflect?n:Reflect,"%RegExp%":RegExp,"%Set%":"undefined"==typeof Set?n:Set,"%SetIteratorPrototype%":"undefined"!=typeof Set&&E&&O?O((new Set)[Symbol.iterator]()):n,"%SharedArrayBuffer%":"undefined"==typeof SharedArrayBuffer?n:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":E&&O?O(""[Symbol.iterator]()):n,"%Symbol%":E?Symbol:n,"%SyntaxError%":l,"%ThrowTypeError%":T,"%TypedArray%":$,"%TypeError%":h,"%Uint8Array%":"undefined"==typeof Uint8Array?n:Uint8Array,"%Uint8ClampedArray%":"undefined"==typeof Uint8ClampedArray?n:Uint8ClampedArray,"%Uint16Array%":"undefined"==typeof Uint16Array?n:Uint16Array,"%Uint32Array%":"undefined"==typeof Uint32Array?n:Uint32Array,"%URIError%":c,"%WeakMap%":"undefined"==typeof WeakMap?n:WeakMap,"%WeakRef%":"undefined"==typeof WeakRef?n:WeakRef,"%WeakSet%":"undefined"==typeof WeakSet?n:WeakSet,"%Function.prototype.call%":k,"%Function.prototype.apply%":P,"%Object.defineProperty%":_,"%Object.getPrototypeOf%":A,"%Math.abs%":f,"%Math.floor%":d,"%Math.max%":p,"%Math.min%":y,"%Math.pow%":m,"%Math.round%":g,"%Math.sign%":w,"%Reflect.getPrototypeOf%":I};if(O)try{null.error}catch(e){var D=O(O(e));R["%Error.prototype%"]=D}var M=function e(t){var r;if("%AsyncFunction%"===t)r=b("async function () {}");else if("%GeneratorFunction%"===t)r=b("function* () {}");else if("%AsyncGeneratorFunction%"===t)r=b("async function* () {}");else if("%AsyncGenerator%"===t){var n=e("%AsyncGeneratorFunction%");n&&(r=n.prototype)}else if("%AsyncIteratorPrototype%"===t){var i=e("%AsyncGenerator%");i&&O&&(r=O(i.prototype))}return R[t]=r,r},L={__proto__:null,"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},B=r(6743),N=r(9957),F=B.call(k,Array.prototype.concat),U=B.call(P,Array.prototype.splice),j=B.call(k,String.prototype.replace),z=B.call(k,String.prototype.slice),G=B.call(k,RegExp.prototype.exec),V=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,W=/\\(\\)?/g,H=function(e,t){var r,n=e;if(N(L,n)&&(n="%"+(r=L[n])[0]+"%"),N(R,n)){var i=R[n];if(i===C&&(i=M(n)),void 0===i&&!t)throw new h("intrinsic "+e+" exists, but is not available. Please file an issue!");return{alias:r,name:n,value:i}}throw new l("intrinsic "+e+" does not exist!")};e.exports=function(e,t){if("string"!=typeof e||0===e.length)throw new h("intrinsic name must be a non-empty string");if(arguments.length>1&&"boolean"!=typeof t)throw new h('"allowMissing" argument must be a boolean');if(null===G(/^%?[^%]*%?$/,e))throw new l("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var r=function(e){var t=z(e,0,1),r=z(e,-1);if("%"===t&&"%"!==r)throw new l("invalid intrinsic syntax, expected closing `%`");if("%"===r&&"%"!==t)throw new l("invalid intrinsic syntax, expected opening `%`");var n=[];return j(e,V,(function(e,t,r,i){n[n.length]=r?j(i,W,"$1"):t||e})),n}(e),n=r.length>0?r[0]:"",i=H("%"+n+"%",t),o=i.name,a=i.value,s=!1,u=i.alias;u&&(n=u[0],U(r,F([0,1],u)));for(var c=1,f=!0;c<r.length;c+=1){var d=r[c],p=z(d,0,1),y=z(d,-1);if(('"'===p||"'"===p||"`"===p||'"'===y||"'"===y||"`"===y)&&p!==y)throw new l("property names with quotes must have matching quotes");if("constructor"!==d&&f||(s=!0),N(R,o="%"+(n+="."+d)+"%"))a=R[o];else if(null!=a){if(!(d in a)){if(!t)throw new h("base intrinsic for "+e+" exists, but the property is not available.");return}if(x&&c+1>=r.length){var m=x(a,d);a=(f=!!m)&&"get"in m&&!("originalValue"in m.get)?m.get:a[d]}else f=N(a,d),a=a[d];f&&!s&&(R[o]=a)}}return a}},1064:(e,t,r)=>{var n=r(9612);e.exports=n.getPrototypeOf||null},8648:e=>{e.exports="undefined"!=typeof Reflect&&Reflect.getPrototypeOf||null},3628:(e,t,r)=>{var n=r(8648),i=r(1064),o=r(7176);e.exports=n?function(e){return n(e)}:i?function(e){if(!e||"object"!=typeof e&&"function"!=typeof e)throw new TypeError("getProto: not an object");return i(e)}:o?function(e){return o(e)}:null},6549:e=>{e.exports=Object.getOwnPropertyDescriptor},5795:(e,t,r)=>{var n=r(6549);if(n)try{n([],"length")}catch(e){n=null}e.exports=n},4039:(e,t,r)=>{var n="undefined"!=typeof Symbol&&Symbol,i=r(1333);e.exports=function(){return"function"==typeof n&&("function"==typeof Symbol&&("symbol"==typeof n("foo")&&("symbol"==typeof Symbol("bar")&&i())))}},1333:e=>{e.exports=function(){if("function"!=typeof Symbol||"function"!=typeof Object.getOwnPropertySymbols)return!1;if("symbol"==typeof Symbol.iterator)return!0;var e={},t=Symbol("test"),r=Object(t);if("string"==typeof t)return!1;if("[object Symbol]"!==Object.prototype.toString.call(t))return!1;if("[object Symbol]"!==Object.prototype.toString.call(r))return!1;for(var n in e[t]=42,e)return!1;if("function"==typeof Object.keys&&0!==Object.keys(e).length)return!1;if("function"==typeof Object.getOwnPropertyNames&&0!==Object.getOwnPropertyNames(e).length)return!1;var i=Object.getOwnPropertySymbols(e);if(1!==i.length||i[0]!==t)return!1;if(!Object.prototype.propertyIsEnumerable.call(e,t))return!1;if("function"==typeof Object.getOwnPropertyDescriptor){var o=Object.getOwnPropertyDescriptor(e,t);if(42!==o.value||!0!==o.enumerable)return!1}return!0}},9957:(e,t,r)=>{var n=Function.prototype.call,i=Object.prototype.hasOwnProperty,o=r(6743);e.exports=o.call(n,i)},251:(e,t)=>{t.read=function(e,t,r,n,i){var o,a,s=8*i-n-1,u=(1<<s)-1,l=u>>1,h=-7,c=r?i-1:0,f=r?-1:1,d=e[t+c];for(c+=f,o=d&(1<<-h)-1,d>>=-h,h+=s;h>0;o=256*o+e[t+c],c+=f,h-=8);for(a=o&(1<<-h)-1,o>>=-h,h+=n;h>0;a=256*a+e[t+c],c+=f,h-=8);if(0===o)o=1-l;else{if(o===u)return a?NaN:1/0*(d?-1:1);a+=Math.pow(2,n),o-=l}return(d?-1:1)*a*Math.pow(2,o-n)},t.write=function(e,t,r,n,i,o){var a,s,u,l=8*o-i-1,h=(1<<l)-1,c=h>>1,f=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,d=n?0:o-1,p=n?1:-1,y=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,a=h):(a=Math.floor(Math.log(t)/Math.LN2),t*(u=Math.pow(2,-a))<1&&(a--,u*=2),(t+=a+c>=1?f/u:f*Math.pow(2,1-c))*u>=2&&(a++,u/=2),a+c>=h?(s=0,a=h):a+c>=1?(s=(t*u-1)*Math.pow(2,i),a+=c):(s=t*Math.pow(2,c-1)*Math.pow(2,i),a=0));i>=8;e[r+d]=255&s,d+=p,s/=256,i-=8);for(a=a<<i|s,l+=i;l>0;e[r+d]=255&a,d+=p,a/=256,l-=8);e[r+d-p]|=128*y}},4634:e=>{var t={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==t.call(e)}},1514:e=>{e.exports=Math.abs},8968:e=>{e.exports=Math.floor},4459:e=>{e.exports=Number.isNaN||function(e){return e!=e}},6188:e=>{e.exports=Math.max},8002:e=>{e.exports=Math.min},5880:e=>{e.exports=Math.pow},414:e=>{e.exports=Math.round},3093:(e,t,r)=>{var n=r(4459);e.exports=function(e){return n(e)||0===e?e:e<0?-1:1}},8859:(e,t,r)=>{var n="function"==typeof Map&&Map.prototype,i=Object.getOwnPropertyDescriptor&&n?Object.getOwnPropertyDescriptor(Map.prototype,"size"):null,o=n&&i&&"function"==typeof i.get?i.get:null,a=n&&Map.prototype.forEach,s="function"==typeof Set&&Set.prototype,u=Object.getOwnPropertyDescriptor&&s?Object.getOwnPropertyDescriptor(Set.prototype,"size"):null,l=s&&u&&"function"==typeof u.get?u.get:null,h=s&&Set.prototype.forEach,c="function"==typeof WeakMap&&WeakMap.prototype?WeakMap.prototype.has:null,f="function"==typeof WeakSet&&WeakSet.prototype?WeakSet.prototype.has:null,d="function"==typeof WeakRef&&WeakRef.prototype?WeakRef.prototype.deref:null,p=Boolean.prototype.valueOf,y=Object.prototype.toString,m=Function.prototype.toString,g=String.prototype.match,w=String.prototype.slice,v=String.prototype.replace,b=String.prototype.toUpperCase,x=String.prototype.toLowerCase,_=RegExp.prototype.test,S=Array.prototype.concat,T=Array.prototype.join,E=Array.prototype.slice,O=Math.floor,A="function"==typeof BigInt?BigInt.prototype.valueOf:null,I=Object.getOwnPropertySymbols,P="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?Symbol.prototype.toString:null,k="function"==typeof Symbol&&"object"==typeof Symbol.iterator,C="function"==typeof Symbol&&Symbol.toStringTag&&(typeof Symbol.toStringTag===k||"symbol")?Symbol.toStringTag:null,$=Object.prototype.propertyIsEnumerable,R=("function"==typeof Reflect?Reflect.getPrototypeOf:Object.getPrototypeOf)||([].__proto__===Array.prototype?function(e){return e.__proto__}:null);function D(e,t){if(e===1/0||e===-1/0||e!=e||e&&e>-1e3&&e<1e3||_.call(/e/,t))return t;var r=/[0-9](?=(?:[0-9]{3})+(?![0-9]))/g;if("number"==typeof e){var n=e<0?-O(-e):O(e);if(n!==e){var i=String(n),o=w.call(t,i.length+1);return v.call(i,r,"$&_")+"."+v.call(v.call(o,/([0-9]{3})/g,"$&_"),/_$/,"")}}return v.call(t,r,"$&_")}var M=r(2634),L=M.custom,B=V(L)?L:null,N={__proto__:null,double:'"',single:"'"},F={__proto__:null,double:/(["\\])/g,single:/(['\\])/g};function U(e,t,r){var n=r.quoteStyle||t,i=N[n];return i+e+i}function j(e){return v.call(String(e),/"/g,"&quot;")}function z(e){return!("[object Array]"!==q(e)||C&&"object"==typeof e&&C in e)}function G(e){return!("[object RegExp]"!==q(e)||C&&"object"==typeof e&&C in e)}function V(e){if(k)return e&&"object"==typeof e&&e instanceof Symbol;if("symbol"==typeof e)return!0;if(!e||"object"!=typeof e||!P)return!1;try{return P.call(e),!0}catch(e){}return!1}e.exports=function e(t,n,i,s){var u=n||{};if(H(u,"quoteStyle")&&!H(N,u.quoteStyle))throw new TypeError('option "quoteStyle" must be "single" or "double"');if(H(u,"maxStringLength")&&("number"==typeof u.maxStringLength?u.maxStringLength<0&&u.maxStringLength!==1/0:null!==u.maxStringLength))throw new TypeError('option "maxStringLength", if provided, must be a positive integer, Infinity, or `null`');var y=!H(u,"customInspect")||u.customInspect;if("boolean"!=typeof y&&"symbol"!==y)throw new TypeError("option \"customInspect\", if provided, must be `true`, `false`, or `'symbol'`");if(H(u,"indent")&&null!==u.indent&&"\t"!==u.indent&&!(parseInt(u.indent,10)===u.indent&&u.indent>0))throw new TypeError('option "indent" must be "\\t", an integer > 0, or `null`');if(H(u,"numericSeparator")&&"boolean"!=typeof u.numericSeparator)throw new TypeError('option "numericSeparator", if provided, must be `true` or `false`');var b=u.numericSeparator;if(void 0===t)return"undefined";if(null===t)return"null";if("boolean"==typeof t)return t?"true":"false";if("string"==typeof t)return X(t,u);if("number"==typeof t){if(0===t)return 1/0/t>0?"0":"-0";var _=String(t);return b?D(t,_):_}if("bigint"==typeof t){var O=String(t)+"n";return b?D(t,O):O}var I=void 0===u.depth?5:u.depth;if(void 0===i&&(i=0),i>=I&&I>0&&"object"==typeof t)return z(t)?"[Array]":"[Object]";var L=function(e,t){var r;if("\t"===e.indent)r="\t";else{if(!("number"==typeof e.indent&&e.indent>0))return null;r=T.call(Array(e.indent+1)," ")}return{base:r,prev:T.call(Array(t+1),r)}}(u,i);if(void 0===s)s=[];else if(Y(s,t)>=0)return"[Circular]";function F(t,r,n){if(r&&(s=E.call(s)).push(r),n){var o={depth:u.depth};return H(u,"quoteStyle")&&(o.quoteStyle=u.quoteStyle),e(t,o,i+1,s)}return e(t,u,i+1,s)}if("function"==typeof t&&!G(t)){var W=function(e){if(e.name)return e.name;var t=g.call(m.call(e),/^function\s*([\w$]+)/);if(t)return t[1];return null}(t),K=te(t,F);return"[Function"+(W?": "+W:" (anonymous)")+"]"+(K.length>0?" { "+T.call(K,", ")+" }":"")}if(V(t)){var re=k?v.call(String(t),/^(Symbol\(.*\))_[^)]*$/,"$1"):P.call(t);return"object"!=typeof t||k?re:Z(re)}if(function(e){if(!e||"object"!=typeof e)return!1;if("undefined"!=typeof HTMLElement&&e instanceof HTMLElement)return!0;return"string"==typeof e.nodeName&&"function"==typeof e.getAttribute}(t)){for(var ne="<"+x.call(String(t.nodeName)),ie=t.attributes||[],oe=0;oe<ie.length;oe++)ne+=" "+ie[oe].name+"="+U(j(ie[oe].value),"double",u);return ne+=">",t.childNodes&&t.childNodes.length&&(ne+="..."),ne+="</"+x.call(String(t.nodeName))+">"}if(z(t)){if(0===t.length)return"[]";var ae=te(t,F);return L&&!function(e){for(var t=0;t<e.length;t++)if(Y(e[t],"\n")>=0)return!1;return!0}(ae)?"["+ee(ae,L)+"]":"[ "+T.call(ae,", ")+" ]"}if(function(e){return!("[object Error]"!==q(e)||C&&"object"==typeof e&&C in e)}(t)){var se=te(t,F);return"cause"in Error.prototype||!("cause"in t)||$.call(t,"cause")?0===se.length?"["+String(t)+"]":"{ ["+String(t)+"] "+T.call(se,", ")+" }":"{ ["+String(t)+"] "+T.call(S.call("[cause]: "+F(t.cause),se),", ")+" }"}if("object"==typeof t&&y){if(B&&"function"==typeof t[B]&&M)return M(t,{depth:I-i});if("symbol"!==y&&"function"==typeof t.inspect)return t.inspect()}if(function(e){if(!o||!e||"object"!=typeof e)return!1;try{o.call(e);try{l.call(e)}catch(e){return!0}return e instanceof Map}catch(e){}return!1}(t)){var ue=[];return a&&a.call(t,(function(e,r){ue.push(F(r,t,!0)+" => "+F(e,t))})),Q("Map",o.call(t),ue,L)}if(function(e){if(!l||!e||"object"!=typeof e)return!1;try{l.call(e);try{o.call(e)}catch(e){return!0}return e instanceof Set}catch(e){}return!1}(t)){var le=[];return h&&h.call(t,(function(e){le.push(F(e,t))})),Q("Set",l.call(t),le,L)}if(function(e){if(!c||!e||"object"!=typeof e)return!1;try{c.call(e,c);try{f.call(e,f)}catch(e){return!0}return e instanceof WeakMap}catch(e){}return!1}(t))return J("WeakMap");if(function(e){if(!f||!e||"object"!=typeof e)return!1;try{f.call(e,f);try{c.call(e,c)}catch(e){return!0}return e instanceof WeakSet}catch(e){}return!1}(t))return J("WeakSet");if(function(e){if(!d||!e||"object"!=typeof e)return!1;try{return d.call(e),!0}catch(e){}return!1}(t))return J("WeakRef");if(function(e){return!("[object Number]"!==q(e)||C&&"object"==typeof e&&C in e)}(t))return Z(F(Number(t)));if(function(e){if(!e||"object"!=typeof e||!A)return!1;try{return A.call(e),!0}catch(e){}return!1}(t))return Z(F(A.call(t)));if(function(e){return!("[object Boolean]"!==q(e)||C&&"object"==typeof e&&C in e)}(t))return Z(p.call(t));if(function(e){return!("[object String]"!==q(e)||C&&"object"==typeof e&&C in e)}(t))return Z(F(String(t)));if("undefined"!=typeof window&&t===window)return"{ [object Window] }";if("undefined"!=typeof globalThis&&t===globalThis||void 0!==r.g&&t===r.g)return"{ [object globalThis] }";if(!function(e){return!("[object Date]"!==q(e)||C&&"object"==typeof e&&C in e)}(t)&&!G(t)){var he=te(t,F),ce=R?R(t)===Object.prototype:t instanceof Object||t.constructor===Object,fe=t instanceof Object?"":"null prototype",de=!ce&&C&&Object(t)===t&&C in t?w.call(q(t),8,-1):fe?"Object":"",pe=(ce||"function"!=typeof t.constructor?"":t.constructor.name?t.constructor.name+" ":"")+(de||fe?"["+T.call(S.call([],de||[],fe||[]),": ")+"] ":"");return 0===he.length?pe+"{}":L?pe+"{"+ee(he,L)+"}":pe+"{ "+T.call(he,", ")+" }"}return String(t)};var W=Object.prototype.hasOwnProperty||function(e){return e in this};function H(e,t){return W.call(e,t)}function q(e){return y.call(e)}function Y(e,t){if(e.indexOf)return e.indexOf(t);for(var r=0,n=e.length;r<n;r++)if(e[r]===t)return r;return-1}function X(e,t){if(e.length>t.maxStringLength){var r=e.length-t.maxStringLength,n="... "+r+" more character"+(r>1?"s":"");return X(w.call(e,0,t.maxStringLength),t)+n}var i=F[t.quoteStyle||"single"];return i.lastIndex=0,U(v.call(v.call(e,i,"\\$1"),/[\x00-\x1f]/g,K),"single",t)}function K(e){var t=e.charCodeAt(0),r={8:"b",9:"t",10:"n",12:"f",13:"r"}[t];return r?"\\"+r:"\\x"+(t<16?"0":"")+b.call(t.toString(16))}function Z(e){return"Object("+e+")"}function J(e){return e+" { ? }"}function Q(e,t,r,n){return e+" ("+t+") {"+(n?ee(r,n):T.call(r,", "))+"}"}function ee(e,t){if(0===e.length)return"";var r="\n"+t.prev+t.base;return r+T.call(e,","+r)+"\n"+t.prev}function te(e,t){var r=z(e),n=[];if(r){n.length=e.length;for(var i=0;i<e.length;i++)n[i]=H(e,i)?t(e[i],e):""}var o,a="function"==typeof I?I(e):[];if(k){o={};for(var s=0;s<a.length;s++)o["$"+a[s]]=a[s]}for(var u in e)H(e,u)&&(r&&String(Number(u))===u&&u<e.length||k&&o["$"+u]instanceof Symbol||(_.call(/[^\w$]/,u)?n.push(t(u,e)+": "+t(e[u],e)):n.push(u+": "+t(e[u],e))));if("function"==typeof I)for(var l=0;l<a.length;l++)$.call(e,a[l])&&n.push("["+t(a[l])+"]: "+t(e[a[l]],e));return n}},5606:e=>{var t,r,n=e.exports={};function i(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function a(e){if(t===setTimeout)return setTimeout(e,0);if((t===i||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(r){try{return t.call(null,e,0)}catch(r){return t.call(this,e,0)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:i}catch(e){t=i}try{r="function"==typeof clearTimeout?clearTimeout:o}catch(e){r=o}}();var s,u=[],l=!1,h=-1;function c(){l&&s&&(l=!1,s.length?u=s.concat(u):h=-1,u.length&&f())}function f(){if(!l){var e=a(c);l=!0;for(var t=u.length;t;){for(s=u,u=[];++h<t;)s&&s[h].run();h=-1,t=u.length}s=null,l=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===o||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{return r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function d(e,t){this.fun=e,this.array=t}function p(){}n.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];u.push(new d(e,t)),1!==u.length||l||a(f)},d.prototype.run=function(){this.fun.apply(null,this.array)},n.title="browser",n.browser=!0,n.env={},n.argv=[],n.version="",n.versions={},n.on=p,n.addListener=p,n.once=p,n.off=p,n.removeListener=p,n.removeAllListeners=p,n.emit=p,n.prependListener=p,n.prependOnceListener=p,n.listeners=function(e){return[]},n.binding=function(e){throw new Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(e){throw new Error("process.chdir is not supported")},n.umask=function(){return 0}},9655:function(e,t,r){var n;e=r.nmd(e),function(){t&&t.nodeType,e&&e.nodeType;var i="object"==typeof r.g&&r.g;i.global!==i&&i.window!==i&&i.self;var o,a=2147483647,s=36,u=/^xn--/,l=/[^\x20-\x7E]/,h=/[\x2E\u3002\uFF0E\uFF61]/g,c={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},f=Math.floor,d=String.fromCharCode;function p(e){throw new RangeError(c[e])}function y(e,t){for(var r=e.length,n=[];r--;)n[r]=t(e[r]);return n}function m(e,t){var r=e.split("@"),n="";return r.length>1&&(n=r[0]+"@",e=r[1]),n+y((e=e.replace(h,".")).split("."),t).join(".")}function g(e){for(var t,r,n=[],i=0,o=e.length;i<o;)(t=e.charCodeAt(i++))>=55296&&t<=56319&&i<o?56320==(64512&(r=e.charCodeAt(i++)))?n.push(((1023&t)<<10)+(1023&r)+65536):(n.push(t),i--):n.push(t);return n}function w(e){return y(e,(function(e){var t="";return e>65535&&(t+=d((e-=65536)>>>10&1023|55296),e=56320|1023&e),t+=d(e)})).join("")}function v(e,t){return e+22+75*(e<26)-((0!=t)<<5)}function b(e,t,r){var n=0;for(e=r?f(e/700):e>>1,e+=f(e/t);e>455;n+=s)e=f(e/35);return f(n+36*e/(e+38))}function x(e){var t,r,n,i,o,u,l,h,c,d,y,m=[],g=e.length,v=0,x=128,_=72;for((r=e.lastIndexOf("-"))<0&&(r=0),n=0;n<r;++n)e.charCodeAt(n)>=128&&p("not-basic"),m.push(e.charCodeAt(n));for(i=r>0?r+1:0;i<g;){for(o=v,u=1,l=s;i>=g&&p("invalid-input"),((h=(y=e.charCodeAt(i++))-48<10?y-22:y-65<26?y-65:y-97<26?y-97:s)>=s||h>f((a-v)/u))&&p("overflow"),v+=h*u,!(h<(c=l<=_?1:l>=_+26?26:l-_));l+=s)u>f(a/(d=s-c))&&p("overflow"),u*=d;_=b(v-o,t=m.length+1,0==o),f(v/t)>a-x&&p("overflow"),x+=f(v/t),v%=t,m.splice(v++,0,x)}return w(m)}function _(e){var t,r,n,i,o,u,l,h,c,y,m,w,x,_,S,T=[];for(w=(e=g(e)).length,t=128,r=0,o=72,u=0;u<w;++u)(m=e[u])<128&&T.push(d(m));for(n=i=T.length,i&&T.push("-");n<w;){for(l=a,u=0;u<w;++u)(m=e[u])>=t&&m<l&&(l=m);for(l-t>f((a-r)/(x=n+1))&&p("overflow"),r+=(l-t)*x,t=l,u=0;u<w;++u)if((m=e[u])<t&&++r>a&&p("overflow"),m==t){for(h=r,c=s;!(h<(y=c<=o?1:c>=o+26?26:c-o));c+=s)S=h-y,_=s-y,T.push(d(v(y+S%_,0))),h=f(S/_);T.push(d(v(h,0))),o=b(r,x,n==i),r=0,++n}++r,++t}return T.join("")}o={version:"1.4.1",ucs2:{decode:g,encode:w},decode:x,encode:_,toASCII:function(e){return m(e,(function(e){return l.test(e)?"xn--"+_(e):e}))},toUnicode:function(e){return m(e,(function(e){return u.test(e)?x(e.slice(4).toLowerCase()):e}))}},void 0===(n=function(){return o}.call(t,r,t,e))||(e.exports=n)}()},4765:e=>{var t=String.prototype.replace,r=/%20/g,n="RFC1738",i="RFC3986";e.exports={default:i,formatters:{RFC1738:function(e){return t.call(e,r,"+")},RFC3986:function(e){return String(e)}},RFC1738:n,RFC3986:i}},5373:(e,t,r)=>{var n=r(8636),i=r(2642),o=r(4765);e.exports={formats:o,parse:i,stringify:n}},2642:(e,t,r)=>{var n=r(7720),i=Object.prototype.hasOwnProperty,o=Array.isArray,a={allowDots:!1,allowEmptyArrays:!1,allowPrototypes:!1,allowSparse:!1,arrayLimit:20,charset:"utf-8",charsetSentinel:!1,comma:!1,decodeDotInKeys:!1,decoder:n.decode,delimiter:"&",depth:5,duplicates:"combine",ignoreQueryPrefix:!1,interpretNumericEntities:!1,parameterLimit:1e3,parseArrays:!0,plainObjects:!1,strictDepth:!1,strictNullHandling:!1,throwOnLimitExceeded:!1},s=function(e){return e.replace(/&#(\d+);/g,(function(e,t){return String.fromCharCode(parseInt(t,10))}))},u=function(e,t,r){if(e&&"string"==typeof e&&t.comma&&e.indexOf(",")>-1)return e.split(",");if(t.throwOnLimitExceeded&&r>=t.arrayLimit)throw new RangeError("Array limit exceeded. Only "+t.arrayLimit+" element"+(1===t.arrayLimit?"":"s")+" allowed in an array.");return e},l=function(e,t,r,o){if(e){var a=r.allowDots?e.replace(/\.([^.[]+)/g,"[$1]"):e,s=/(\[[^[\]]*])/g,l=r.depth>0&&/(\[[^[\]]*])/.exec(a),h=l?a.slice(0,l.index):a,c=[];if(h){if(!r.plainObjects&&i.call(Object.prototype,h)&&!r.allowPrototypes)return;c.push(h)}for(var f=0;r.depth>0&&null!==(l=s.exec(a))&&f<r.depth;){if(f+=1,!r.plainObjects&&i.call(Object.prototype,l[1].slice(1,-1))&&!r.allowPrototypes)return;c.push(l[1])}if(l){if(!0===r.strictDepth)throw new RangeError("Input depth exceeded depth option of "+r.depth+" and strictDepth is true");c.push("["+a.slice(l.index)+"]")}return function(e,t,r,i){var o=0;if(e.length>0&&"[]"===e[e.length-1]){var a=e.slice(0,-1).join("");o=Array.isArray(t)&&t[a]?t[a].length:0}for(var s=i?t:u(t,r,o),l=e.length-1;l>=0;--l){var h,c=e[l];if("[]"===c&&r.parseArrays)h=r.allowEmptyArrays&&(""===s||r.strictNullHandling&&null===s)?[]:n.combine([],s);else{h=r.plainObjects?{__proto__:null}:{};var f="["===c.charAt(0)&&"]"===c.charAt(c.length-1)?c.slice(1,-1):c,d=r.decodeDotInKeys?f.replace(/%2E/g,"."):f,p=parseInt(d,10);r.parseArrays||""!==d?!isNaN(p)&&c!==d&&String(p)===d&&p>=0&&r.parseArrays&&p<=r.arrayLimit?(h=[])[p]=s:"__proto__"!==d&&(h[d]=s):h={0:s}}s=h}return s}(c,t,r,o)}};e.exports=function(e,t){var r=function(e){if(!e)return a;if(void 0!==e.allowEmptyArrays&&"boolean"!=typeof e.allowEmptyArrays)throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(void 0!==e.decodeDotInKeys&&"boolean"!=typeof e.decodeDotInKeys)throw new TypeError("`decodeDotInKeys` option can only be `true` or `false`, when provided");if(null!==e.decoder&&void 0!==e.decoder&&"function"!=typeof e.decoder)throw new TypeError("Decoder has to be a function.");if(void 0!==e.charset&&"utf-8"!==e.charset&&"iso-8859-1"!==e.charset)throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");if(void 0!==e.throwOnLimitExceeded&&"boolean"!=typeof e.throwOnLimitExceeded)throw new TypeError("`throwOnLimitExceeded` option must be a boolean");var t=void 0===e.charset?a.charset:e.charset,r=void 0===e.duplicates?a.duplicates:e.duplicates;if("combine"!==r&&"first"!==r&&"last"!==r)throw new TypeError("The duplicates option must be either combine, first, or last");return{allowDots:void 0===e.allowDots?!0===e.decodeDotInKeys||a.allowDots:!!e.allowDots,allowEmptyArrays:"boolean"==typeof e.allowEmptyArrays?!!e.allowEmptyArrays:a.allowEmptyArrays,allowPrototypes:"boolean"==typeof e.allowPrototypes?e.allowPrototypes:a.allowPrototypes,allowSparse:"boolean"==typeof e.allowSparse?e.allowSparse:a.allowSparse,arrayLimit:"number"==typeof e.arrayLimit?e.arrayLimit:a.arrayLimit,charset:t,charsetSentinel:"boolean"==typeof e.charsetSentinel?e.charsetSentinel:a.charsetSentinel,comma:"boolean"==typeof e.comma?e.comma:a.comma,decodeDotInKeys:"boolean"==typeof e.decodeDotInKeys?e.decodeDotInKeys:a.decodeDotInKeys,decoder:"function"==typeof e.decoder?e.decoder:a.decoder,delimiter:"string"==typeof e.delimiter||n.isRegExp(e.delimiter)?e.delimiter:a.delimiter,depth:"number"==typeof e.depth||!1===e.depth?+e.depth:a.depth,duplicates:r,ignoreQueryPrefix:!0===e.ignoreQueryPrefix,interpretNumericEntities:"boolean"==typeof e.interpretNumericEntities?e.interpretNumericEntities:a.interpretNumericEntities,parameterLimit:"number"==typeof e.parameterLimit?e.parameterLimit:a.parameterLimit,parseArrays:!1!==e.parseArrays,plainObjects:"boolean"==typeof e.plainObjects?e.plainObjects:a.plainObjects,strictDepth:"boolean"==typeof e.strictDepth?!!e.strictDepth:a.strictDepth,strictNullHandling:"boolean"==typeof e.strictNullHandling?e.strictNullHandling:a.strictNullHandling,throwOnLimitExceeded:"boolean"==typeof e.throwOnLimitExceeded&&e.throwOnLimitExceeded}}(t);if(""===e||null==e)return r.plainObjects?{__proto__:null}:{};for(var h="string"==typeof e?function(e,t){var r={__proto__:null},l=t.ignoreQueryPrefix?e.replace(/^\?/,""):e;l=l.replace(/%5B/gi,"[").replace(/%5D/gi,"]");var h=t.parameterLimit===1/0?void 0:t.parameterLimit,c=l.split(t.delimiter,t.throwOnLimitExceeded?h+1:h);if(t.throwOnLimitExceeded&&c.length>h)throw new RangeError("Parameter limit exceeded. Only "+h+" parameter"+(1===h?"":"s")+" allowed.");var f,d=-1,p=t.charset;if(t.charsetSentinel)for(f=0;f<c.length;++f)0===c[f].indexOf("utf8=")&&("utf8=%E2%9C%93"===c[f]?p="utf-8":"utf8=%26%2310003%3B"===c[f]&&(p="iso-8859-1"),d=f,f=c.length);for(f=0;f<c.length;++f)if(f!==d){var y,m,g=c[f],w=g.indexOf("]="),v=-1===w?g.indexOf("="):w+1;-1===v?(y=t.decoder(g,a.decoder,p,"key"),m=t.strictNullHandling?null:""):(y=t.decoder(g.slice(0,v),a.decoder,p,"key"),m=n.maybeMap(u(g.slice(v+1),t,o(r[y])?r[y].length:0),(function(e){return t.decoder(e,a.decoder,p,"value")}))),m&&t.interpretNumericEntities&&"iso-8859-1"===p&&(m=s(String(m))),g.indexOf("[]=")>-1&&(m=o(m)?[m]:m);var b=i.call(r,y);b&&"combine"===t.duplicates?r[y]=n.combine(r[y],m):b&&"last"!==t.duplicates||(r[y]=m)}return r}(e,r):e,c=r.plainObjects?{__proto__:null}:{},f=Object.keys(h),d=0;d<f.length;++d){var p=f[d],y=l(p,h[p],r,"string"==typeof e);c=n.merge(c,y,r)}return!0===r.allowSparse?c:n.compact(c)}},8636:(e,t,r)=>{var n=r(920),i=r(7720),o=r(4765),a=Object.prototype.hasOwnProperty,s={brackets:function(e){return e+"[]"},comma:"comma",indices:function(e,t){return e+"["+t+"]"},repeat:function(e){return e}},u=Array.isArray,l=Array.prototype.push,h=function(e,t){l.apply(e,u(t)?t:[t])},c=Date.prototype.toISOString,f=o.default,d={addQueryPrefix:!1,allowDots:!1,allowEmptyArrays:!1,arrayFormat:"indices",charset:"utf-8",charsetSentinel:!1,commaRoundTrip:!1,delimiter:"&",encode:!0,encodeDotInKeys:!1,encoder:i.encode,encodeValuesOnly:!1,filter:void 0,format:f,formatter:o.formatters[f],indices:!1,serializeDate:function(e){return c.call(e)},skipNulls:!1,strictNullHandling:!1},p={},y=function e(t,r,o,a,s,l,c,f,y,m,g,w,v,b,x,_,S,T){for(var E,O=t,A=T,I=0,P=!1;void 0!==(A=A.get(p))&&!P;){var k=A.get(t);if(I+=1,void 0!==k){if(k===I)throw new RangeError("Cyclic object value");P=!0}void 0===A.get(p)&&(I=0)}if("function"==typeof m?O=m(r,O):O instanceof Date?O=v(O):"comma"===o&&u(O)&&(O=i.maybeMap(O,(function(e){return e instanceof Date?v(e):e}))),null===O){if(l)return y&&!_?y(r,d.encoder,S,"key",b):r;O=""}if("string"==typeof(E=O)||"number"==typeof E||"boolean"==typeof E||"symbol"==typeof E||"bigint"==typeof E||i.isBuffer(O))return y?[x(_?r:y(r,d.encoder,S,"key",b))+"="+x(y(O,d.encoder,S,"value",b))]:[x(r)+"="+x(String(O))];var C,$=[];if(void 0===O)return $;if("comma"===o&&u(O))_&&y&&(O=i.maybeMap(O,y)),C=[{value:O.length>0?O.join(",")||null:void 0}];else if(u(m))C=m;else{var R=Object.keys(O);C=g?R.sort(g):R}var D=f?String(r).replace(/\./g,"%2E"):String(r),M=a&&u(O)&&1===O.length?D+"[]":D;if(s&&u(O)&&0===O.length)return M+"[]";for(var L=0;L<C.length;++L){var B=C[L],N="object"==typeof B&&B&&void 0!==B.value?B.value:O[B];if(!c||null!==N){var F=w&&f?String(B).replace(/\./g,"%2E"):String(B),U=u(O)?"function"==typeof o?o(M,F):M:M+(w?"."+F:"["+F+"]");T.set(t,I);var j=n();j.set(p,T),h($,e(N,U,o,a,s,l,c,f,"comma"===o&&_&&u(O)?null:y,m,g,w,v,b,x,_,S,j))}}return $};e.exports=function(e,t){var r,i=e,l=function(e){if(!e)return d;if(void 0!==e.allowEmptyArrays&&"boolean"!=typeof e.allowEmptyArrays)throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(void 0!==e.encodeDotInKeys&&"boolean"!=typeof e.encodeDotInKeys)throw new TypeError("`encodeDotInKeys` option can only be `true` or `false`, when provided");if(null!==e.encoder&&void 0!==e.encoder&&"function"!=typeof e.encoder)throw new TypeError("Encoder has to be a function.");var t=e.charset||d.charset;if(void 0!==e.charset&&"utf-8"!==e.charset&&"iso-8859-1"!==e.charset)throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var r=o.default;if(void 0!==e.format){if(!a.call(o.formatters,e.format))throw new TypeError("Unknown format option provided.");r=e.format}var n,i=o.formatters[r],l=d.filter;if(("function"==typeof e.filter||u(e.filter))&&(l=e.filter),n=e.arrayFormat in s?e.arrayFormat:"indices"in e?e.indices?"indices":"repeat":d.arrayFormat,"commaRoundTrip"in e&&"boolean"!=typeof e.commaRoundTrip)throw new TypeError("`commaRoundTrip` must be a boolean, or absent");var h=void 0===e.allowDots?!0===e.encodeDotInKeys||d.allowDots:!!e.allowDots;return{addQueryPrefix:"boolean"==typeof e.addQueryPrefix?e.addQueryPrefix:d.addQueryPrefix,allowDots:h,allowEmptyArrays:"boolean"==typeof e.allowEmptyArrays?!!e.allowEmptyArrays:d.allowEmptyArrays,arrayFormat:n,charset:t,charsetSentinel:"boolean"==typeof e.charsetSentinel?e.charsetSentinel:d.charsetSentinel,commaRoundTrip:!!e.commaRoundTrip,delimiter:void 0===e.delimiter?d.delimiter:e.delimiter,encode:"boolean"==typeof e.encode?e.encode:d.encode,encodeDotInKeys:"boolean"==typeof e.encodeDotInKeys?e.encodeDotInKeys:d.encodeDotInKeys,encoder:"function"==typeof e.encoder?e.encoder:d.encoder,encodeValuesOnly:"boolean"==typeof e.encodeValuesOnly?e.encodeValuesOnly:d.encodeValuesOnly,filter:l,format:r,formatter:i,serializeDate:"function"==typeof e.serializeDate?e.serializeDate:d.serializeDate,skipNulls:"boolean"==typeof e.skipNulls?e.skipNulls:d.skipNulls,sort:"function"==typeof e.sort?e.sort:null,strictNullHandling:"boolean"==typeof e.strictNullHandling?e.strictNullHandling:d.strictNullHandling}}(t);"function"==typeof l.filter?i=(0,l.filter)("",i):u(l.filter)&&(r=l.filter);var c=[];if("object"!=typeof i||null===i)return"";var f=s[l.arrayFormat],p="comma"===f&&l.commaRoundTrip;r||(r=Object.keys(i)),l.sort&&r.sort(l.sort);for(var m=n(),g=0;g<r.length;++g){var w=r[g],v=i[w];l.skipNulls&&null===v||h(c,y(v,w,f,p,l.allowEmptyArrays,l.strictNullHandling,l.skipNulls,l.encodeDotInKeys,l.encode?l.encoder:null,l.filter,l.sort,l.allowDots,l.serializeDate,l.format,l.formatter,l.encodeValuesOnly,l.charset,m))}var b=c.join(l.delimiter),x=!0===l.addQueryPrefix?"?":"";return l.charsetSentinel&&("iso-8859-1"===l.charset?x+="utf8=%26%2310003%3B&":x+="utf8=%E2%9C%93&"),b.length>0?x+b:""}},7720:(e,t,r)=>{var n=r(4765),i=Object.prototype.hasOwnProperty,o=Array.isArray,a=function(){for(var e=[],t=0;t<256;++t)e.push("%"+((t<16?"0":"")+t.toString(16)).toUpperCase());return e}(),s=function(e,t){for(var r=t&&t.plainObjects?{__proto__:null}:{},n=0;n<e.length;++n)void 0!==e[n]&&(r[n]=e[n]);return r},u=1024;e.exports={arrayToObject:s,assign:function(e,t){return Object.keys(t).reduce((function(e,r){return e[r]=t[r],e}),e)},combine:function(e,t){return[].concat(e,t)},compact:function(e){for(var t=[{obj:{o:e},prop:"o"}],r=[],n=0;n<t.length;++n)for(var i=t[n],a=i.obj[i.prop],s=Object.keys(a),u=0;u<s.length;++u){var l=s[u],h=a[l];"object"==typeof h&&null!==h&&-1===r.indexOf(h)&&(t.push({obj:a,prop:l}),r.push(h))}return function(e){for(;e.length>1;){var t=e.pop(),r=t.obj[t.prop];if(o(r)){for(var n=[],i=0;i<r.length;++i)void 0!==r[i]&&n.push(r[i]);t.obj[t.prop]=n}}}(t),e},decode:function(e,t,r){var n=e.replace(/\+/g," ");if("iso-8859-1"===r)return n.replace(/%[0-9a-f]{2}/gi,unescape);try{return decodeURIComponent(n)}catch(e){return n}},encode:function(e,t,r,i,o){if(0===e.length)return e;var s=e;if("symbol"==typeof e?s=Symbol.prototype.toString.call(e):"string"!=typeof e&&(s=String(e)),"iso-8859-1"===r)return escape(s).replace(/%u[0-9a-f]{4}/gi,(function(e){return"%26%23"+parseInt(e.slice(2),16)+"%3B"}));for(var l="",h=0;h<s.length;h+=u){for(var c=s.length>=u?s.slice(h,h+u):s,f=[],d=0;d<c.length;++d){var p=c.charCodeAt(d);45===p||46===p||95===p||126===p||p>=48&&p<=57||p>=65&&p<=90||p>=97&&p<=122||o===n.RFC1738&&(40===p||41===p)?f[f.length]=c.charAt(d):p<128?f[f.length]=a[p]:p<2048?f[f.length]=a[192|p>>6]+a[128|63&p]:p<55296||p>=57344?f[f.length]=a[224|p>>12]+a[128|p>>6&63]+a[128|63&p]:(d+=1,p=65536+((1023&p)<<10|1023&c.charCodeAt(d)),f[f.length]=a[240|p>>18]+a[128|p>>12&63]+a[128|p>>6&63]+a[128|63&p])}l+=f.join("")}return l},isBuffer:function(e){return!(!e||"object"!=typeof e)&&!!(e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer(e))},isRegExp:function(e){return"[object RegExp]"===Object.prototype.toString.call(e)},maybeMap:function(e,t){if(o(e)){for(var r=[],n=0;n<e.length;n+=1)r.push(t(e[n]));return r}return t(e)},merge:function e(t,r,n){if(!r)return t;if("object"!=typeof r&&"function"!=typeof r){if(o(t))t.push(r);else{if(!t||"object"!=typeof t)return[t,r];(n&&(n.plainObjects||n.allowPrototypes)||!i.call(Object.prototype,r))&&(t[r]=!0)}return t}if(!t||"object"!=typeof t)return[t].concat(r);var a=t;return o(t)&&!o(r)&&(a=s(t,n)),o(t)&&o(r)?(r.forEach((function(r,o){if(i.call(t,o)){var a=t[o];a&&"object"==typeof a&&r&&"object"==typeof r?t[o]=e(a,r,n):t.push(r)}else t[o]=r})),t):Object.keys(r).reduce((function(t,o){var a=r[o];return i.call(t,o)?t[o]=e(t[o],a,n):t[o]=a,t}),a)}}},4803:(e,t,r)=>{var n=r(8859),i=r(9675),o=function(e,t,r){for(var n,i=e;null!=(n=i.next);i=n)if(n.key===t)return i.next=n.next,r||(n.next=e.next,e.next=n),n};e.exports=function(){var e,t={assert:function(e){if(!t.has(e))throw new i("Side channel does not contain "+n(e))},delete:function(t){var r=e&&e.next,n=function(e,t){if(e)return o(e,t,!0)}(e,t);return n&&r&&r===n&&(e=void 0),!!n},get:function(t){return function(e,t){if(e){var r=o(e,t);return r&&r.value}}(e,t)},has:function(t){return function(e,t){return!!e&&!!o(e,t)}(e,t)},set:function(t,r){e||(e={next:void 0}),function(e,t,r){var n=o(e,t);n?n.value=r:e.next={key:t,next:e.next,value:r}}(e,t,r)}};return t}},507:(e,t,r)=>{var n=r(453),i=r(6556),o=r(8859),a=r(9675),s=n("%Map%",!0),u=i("Map.prototype.get",!0),l=i("Map.prototype.set",!0),h=i("Map.prototype.has",!0),c=i("Map.prototype.delete",!0),f=i("Map.prototype.size",!0);e.exports=!!s&&function(){var e,t={assert:function(e){if(!t.has(e))throw new a("Side channel does not contain "+o(e))},delete:function(t){if(e){var r=c(e,t);return 0===f(e)&&(e=void 0),r}return!1},get:function(t){if(e)return u(e,t)},has:function(t){return!!e&&h(e,t)},set:function(t,r){e||(e=new s),l(e,t,r)}};return t}},2271:(e,t,r)=>{var n=r(453),i=r(6556),o=r(8859),a=r(507),s=r(9675),u=n("%WeakMap%",!0),l=i("WeakMap.prototype.get",!0),h=i("WeakMap.prototype.set",!0),c=i("WeakMap.prototype.has",!0),f=i("WeakMap.prototype.delete",!0);e.exports=u?function(){var e,t,r={assert:function(e){if(!r.has(e))throw new s("Side channel does not contain "+o(e))},delete:function(r){if(u&&r&&("object"==typeof r||"function"==typeof r)){if(e)return f(e,r)}else if(a&&t)return t.delete(r);return!1},get:function(r){return u&&r&&("object"==typeof r||"function"==typeof r)&&e?l(e,r):t&&t.get(r)},has:function(r){return u&&r&&("object"==typeof r||"function"==typeof r)&&e?c(e,r):!!t&&t.has(r)},set:function(r,n){u&&r&&("object"==typeof r||"function"==typeof r)?(e||(e=new u),h(e,r,n)):a&&(t||(t=a()),t.set(r,n))}};return r}:a},920:(e,t,r)=>{var n=r(9675),i=r(8859),o=r(4803),a=r(507),s=r(2271)||a||o;e.exports=function(){var e,t={assert:function(e){if(!t.has(e))throw new n("Side channel does not contain "+i(e))},delete:function(t){return!!e&&e.delete(t)},get:function(t){return e&&e.get(t)},has:function(t){return!!e&&e.has(t)},set:function(t,r){e||(e=s()),e.set(t,r)}};return t}},8835:(e,t,r)=>{var n=r(9655);function i(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}var o=/^([a-z0-9.+-]+:)/i,a=/:[0-9]*$/,s=/^(\/\/?(?!\/)[^?\s]*)(\?[^\s]*)?$/,u=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r","\n","\t"]),l=["'"].concat(u),h=["%","/","?",";","#"].concat(l),c=["/","?","#"],f=/^[+a-z0-9A-Z_-]{0,63}$/,d=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,p={javascript:!0,"javascript:":!0},y={javascript:!0,"javascript:":!0},m={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},g=r(5373);function w(e,t,r){if(e&&"object"==typeof e&&e instanceof i)return e;var n=new i;return n.parse(e,t,r),n}i.prototype.parse=function(e,t,r){if("string"!=typeof e)throw new TypeError("Parameter 'url' must be a string, not "+typeof e);var i=e.indexOf("?"),a=-1!==i&&i<e.indexOf("#")?"?":"#",u=e.split(a);u[0]=u[0].replace(/\\/g,"/");var w=e=u.join(a);if(w=w.trim(),!r&&1===e.split("#").length){var v=s.exec(w);if(v)return this.path=w,this.href=w,this.pathname=v[1],v[2]?(this.search=v[2],this.query=t?g.parse(this.search.substr(1)):this.search.substr(1)):t&&(this.search="",this.query={}),this}var b=o.exec(w);if(b){var x=(b=b[0]).toLowerCase();this.protocol=x,w=w.substr(b.length)}if(r||b||w.match(/^\/\/[^@/]+@[^@/]+/)){var _="//"===w.substr(0,2);!_||b&&y[b]||(w=w.substr(2),this.slashes=!0)}if(!y[b]&&(_||b&&!m[b])){for(var S,T,E=-1,O=0;O<c.length;O++){-1!==(A=w.indexOf(c[O]))&&(-1===E||A<E)&&(E=A)}-1!==(T=-1===E?w.lastIndexOf("@"):w.lastIndexOf("@",E))&&(S=w.slice(0,T),w=w.slice(T+1),this.auth=decodeURIComponent(S)),E=-1;for(O=0;O<h.length;O++){var A;-1!==(A=w.indexOf(h[O]))&&(-1===E||A<E)&&(E=A)}-1===E&&(E=w.length),this.host=w.slice(0,E),w=w.slice(E),this.parseHost(),this.hostname=this.hostname||"";var I="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!I)for(var P=this.hostname.split(/\./),k=(O=0,P.length);O<k;O++){var C=P[O];if(C&&!C.match(f)){for(var $="",R=0,D=C.length;R<D;R++)C.charCodeAt(R)>127?$+="x":$+=C[R];if(!$.match(f)){var M=P.slice(0,O),L=P.slice(O+1),B=C.match(d);B&&(M.push(B[1]),L.unshift(B[2])),L.length&&(w="/"+L.join(".")+w),this.hostname=M.join(".");break}}}this.hostname.length>255?this.hostname="":this.hostname=this.hostname.toLowerCase(),I||(this.hostname=n.toASCII(this.hostname));var N=this.port?":"+this.port:"",F=this.hostname||"";this.host=F+N,this.href+=this.host,I&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==w[0]&&(w="/"+w))}if(!p[x])for(O=0,k=l.length;O<k;O++){var U=l[O];if(-1!==w.indexOf(U)){var j=encodeURIComponent(U);j===U&&(j=escape(U)),w=w.split(U).join(j)}}var z=w.indexOf("#");-1!==z&&(this.hash=w.substr(z),w=w.slice(0,z));var G=w.indexOf("?");if(-1!==G?(this.search=w.substr(G),this.query=w.substr(G+1),t&&(this.query=g.parse(this.query)),w=w.slice(0,G)):t&&(this.search="",this.query={}),w&&(this.pathname=w),m[x]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){N=this.pathname||"";var V=this.search||"";this.path=N+V}return this.href=this.format(),this},i.prototype.format=function(){var e=this.auth||"";e&&(e=(e=encodeURIComponent(e)).replace(/%3A/i,":"),e+="@");var t=this.protocol||"",r=this.pathname||"",n=this.hash||"",i=!1,o="";this.host?i=e+this.host:this.hostname&&(i=e+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(i+=":"+this.port)),this.query&&"object"==typeof this.query&&Object.keys(this.query).length&&(o=g.stringify(this.query,{arrayFormat:"repeat",addQueryPrefix:!1}));var a=this.search||o&&"?"+o||"";return t&&":"!==t.substr(-1)&&(t+=":"),this.slashes||(!t||m[t])&&!1!==i?(i="//"+(i||""),r&&"/"!==r.charAt(0)&&(r="/"+r)):i||(i=""),n&&"#"!==n.charAt(0)&&(n="#"+n),a&&"?"!==a.charAt(0)&&(a="?"+a),t+i+(r=r.replace(/[?#]/g,(function(e){return encodeURIComponent(e)})))+(a=a.replace("#","%23"))+n},i.prototype.resolve=function(e){return this.resolveObject(w(e,!1,!0)).format()},i.prototype.resolveObject=function(e){if("string"==typeof e){var t=new i;t.parse(e,!1,!0),e=t}for(var r=new i,n=Object.keys(this),o=0;o<n.length;o++){var a=n[o];r[a]=this[a]}if(r.hash=e.hash,""===e.href)return r.href=r.format(),r;if(e.slashes&&!e.protocol){for(var s=Object.keys(e),u=0;u<s.length;u++){var l=s[u];"protocol"!==l&&(r[l]=e[l])}return m[r.protocol]&&r.hostname&&!r.pathname&&(r.pathname="/",r.path=r.pathname),r.href=r.format(),r}if(e.protocol&&e.protocol!==r.protocol){if(!m[e.protocol]){for(var h=Object.keys(e),c=0;c<h.length;c++){var f=h[c];r[f]=e[f]}return r.href=r.format(),r}if(r.protocol=e.protocol,e.host||y[e.protocol])r.pathname=e.pathname;else{for(var d=(e.pathname||"").split("/");d.length&&!(e.host=d.shift()););e.host||(e.host=""),e.hostname||(e.hostname=""),""!==d[0]&&d.unshift(""),d.length<2&&d.unshift(""),r.pathname=d.join("/")}if(r.search=e.search,r.query=e.query,r.host=e.host||"",r.auth=e.auth,r.hostname=e.hostname||e.host,r.port=e.port,r.pathname||r.search){var p=r.pathname||"",g=r.search||"";r.path=p+g}return r.slashes=r.slashes||e.slashes,r.href=r.format(),r}var w=r.pathname&&"/"===r.pathname.charAt(0),v=e.host||e.pathname&&"/"===e.pathname.charAt(0),b=v||w||r.host&&e.pathname,x=b,_=r.pathname&&r.pathname.split("/")||[],S=(d=e.pathname&&e.pathname.split("/")||[],r.protocol&&!m[r.protocol]);if(S&&(r.hostname="",r.port=null,r.host&&(""===_[0]?_[0]=r.host:_.unshift(r.host)),r.host="",e.protocol&&(e.hostname=null,e.port=null,e.host&&(""===d[0]?d[0]=e.host:d.unshift(e.host)),e.host=null),b=b&&(""===d[0]||""===_[0])),v)r.host=e.host||""===e.host?e.host:r.host,r.hostname=e.hostname||""===e.hostname?e.hostname:r.hostname,r.search=e.search,r.query=e.query,_=d;else if(d.length)_||(_=[]),_.pop(),_=_.concat(d),r.search=e.search,r.query=e.query;else if(null!=e.search){if(S)r.host=_.shift(),r.hostname=r.host,(I=!!(r.host&&r.host.indexOf("@")>0)&&r.host.split("@"))&&(r.auth=I.shift(),r.hostname=I.shift(),r.host=r.hostname);return r.search=e.search,r.query=e.query,null===r.pathname&&null===r.search||(r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")),r.href=r.format(),r}if(!_.length)return r.pathname=null,r.search?r.path="/"+r.search:r.path=null,r.href=r.format(),r;for(var T=_.slice(-1)[0],E=(r.host||e.host||_.length>1)&&("."===T||".."===T)||""===T,O=0,A=_.length;A>=0;A--)"."===(T=_[A])?_.splice(A,1):".."===T?(_.splice(A,1),O++):O&&(_.splice(A,1),O--);if(!b&&!x)for(;O--;O)_.unshift("..");!b||""===_[0]||_[0]&&"/"===_[0].charAt(0)||_.unshift(""),E&&"/"!==_.join("/").substr(-1)&&_.push("");var I,P=""===_[0]||_[0]&&"/"===_[0].charAt(0);S&&(r.hostname=P?"":_.length?_.shift():"",r.host=r.hostname,(I=!!(r.host&&r.host.indexOf("@")>0)&&r.host.split("@"))&&(r.auth=I.shift(),r.hostname=I.shift(),r.host=r.hostname));return(b=b||r.host&&_.length)&&!P&&_.unshift(""),_.length>0?r.pathname=_.join("/"):(r.pathname=null,r.path=null),null===r.pathname&&null===r.search||(r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")),r.auth=e.auth||r.auth,r.slashes=r.slashes||e.slashes,r.href=r.format(),r},i.prototype.parseHost=function(){var e=this.host,t=a.exec(e);t&&(":"!==(t=t[0])&&(this.port=t.substr(1)),e=e.substr(0,e.length-t.length)),e&&(this.hostname=e)},t.qg=w,t.hd=function(e,t){return w(e,!1,!0).resolve(t)},t.GP=function(e){return"string"==typeof e&&(e=w(e)),e instanceof i?e.format():i.prototype.format.call(e)}},2634:()=>{},9203:(e,t,r)=>{r.d(t,{Gk:()=>m,CI:()=>bi,aV:()=>xi,nW:()=>Bt,B9:()=>s,wn:()=>a,yw:()=>S,sN:()=>Ur,jH:()=>Hr,LE:()=>Wr,t5:()=>Rt,hq:()=>Dt,JH:()=>Gt,ch:()=>Br,LQ:()=>Rr,A6:()=>jr,cc:()=>Dr,OF:()=>T,hp:()=>Lt,dZ:()=>kt,yn:()=>mi,fr:()=>g,Eq:()=>x,Bu:()=>_i,jl:()=>Zt,Q1:()=>De,bD:()=>Gr,WQ:()=>Ti,Td:()=>Ht,_4:()=>u,Km:()=>i,Pp:()=>Jt,Ag:()=>gt,hR:()=>l,dJ:()=>Fr,OO:()=>rn,u9:()=>an,GW:()=>Vr,nj:()=>ln,OS:()=>w,pq:()=>sn,_H:()=>$n,Ru:()=>ti,yI:()=>An,V2:()=>zt,kb:()=>cn,n1:()=>Cn,Ln:()=>Ot,di:()=>Ei,Gj:()=>qr,vg:()=>b,E8:()=>y,he:()=>_,XN:()=>yn,iW:()=>mn,uq:()=>tr,DT:()=>pi,Pt:()=>Mr,IH:()=>gi,oA:()=>hr,TO:()=>Vt,Pk:()=>v,$o:()=>Sn,bR:()=>Yt,tS:()=>Qt,BP:()=>Pr,hk:()=>Tn,kO:()=>en,X1:()=>tn,bO:()=>Wt,h3:()=>o,M_:()=>Kt,Y7:()=>Jr,O1:()=>Qr,Bw:()=>kn,A4:()=>vi,FW:()=>Pt,TE:()=>er,by:()=>It,XZ:()=>f,M6:()=>d,HY:()=>qt,$f:()=>Ai,s9:()=>xn,Mt:()=>$r,$P:()=>Yn,ah:()=>pn,fE:()=>Xn,Uw:()=>Et,D8:()=>Zn,iH:()=>_n,zi:()=>Jn,dW:()=>h,QE:()=>c,gP:()=>Zr,lB:()=>ei,NW:()=>dn,vB:()=>ri,OE:()=>Yr,Rv:()=>ui,y:()=>li,dL:()=>fr,wF:()=>ki,vT:()=>ni,dQ:()=>oi,k2:()=>Cr,xv:()=>Ci,A5:()=>Pi,vr:()=>ii,u3:()=>xt,uR:()=>p,q5:()=>ci,Nc:()=>At,uC:()=>Tt,_J:()=>jn,Eo:()=>di,MT:()=>fi,XO:()=>bt,CF:()=>Bn,He:()=>Gn,WD:()=>vr,RO:()=>zn,ER:()=>lr,Fr:()=>G,W0:()=>E,$Z:()=>dr,ff:()=>Wn,Wp:()=>n});var n={};r.r(n),r.d(n,{BaseTextureCache:()=>at,BoundingBox:()=>nt,CanvasRenderTarget:()=>lt,DATA_URI:()=>Ve,EventEmitter:()=>V,ProgramCache:()=>it,TextureCache:()=>ot,clearTextureCache:()=>ut,correctBlendMode:()=>Ue,createIndicesForQuads:()=>We,decomposeDataUri:()=>pt,deprecation:()=>Y,destroyTextureCache:()=>st,detectVideoAlphaMode:()=>te,determineCrossOrigin:()=>yt,earcut:()=>W,getBufferType:()=>He,getCanvasBoundingBox:()=>ft,getResolutionOfUrl:()=>mt,hex2rgb:()=>Me,hex2string:()=>Le,interleaveTypedArrays:()=>Ye,isMobile:()=>G,isPow2:()=>Ke,isWebGLSupported:()=>ie,log2:()=>Ze,nextPow2:()=>Xe,path:()=>J,premultiplyBlendMode:()=>Fe,premultiplyRgba:()=>je,premultiplyTint:()=>ze,premultiplyTintToRgba:()=>Ge,removeItems:()=>Je,rgb2hex:()=>Ne,sayHello:()=>ne,sign:()=>Qe,skipHello:()=>re,string2hex:()=>Be,trimCanvas:()=>dt,uid:()=>tt,url:()=>X});var i=(e=>(e[e.WEBGL_LEGACY=0]="WEBGL_LEGACY",e[e.WEBGL=1]="WEBGL",e[e.WEBGL2=2]="WEBGL2",e))(i||{}),o=(e=>(e[e.UNKNOWN=0]="UNKNOWN",e[e.WEBGL=1]="WEBGL",e[e.CANVAS=2]="CANVAS",e))(o||{}),a=(e=>(e[e.COLOR=16384]="COLOR",e[e.DEPTH=256]="DEPTH",e[e.STENCIL=1024]="STENCIL",e))(a||{}),s=(e=>(e[e.NORMAL=0]="NORMAL",e[e.ADD=1]="ADD",e[e.MULTIPLY=2]="MULTIPLY",e[e.SCREEN=3]="SCREEN",e[e.OVERLAY=4]="OVERLAY",e[e.DARKEN=5]="DARKEN",e[e.LIGHTEN=6]="LIGHTEN",e[e.COLOR_DODGE=7]="COLOR_DODGE",e[e.COLOR_BURN=8]="COLOR_BURN",e[e.HARD_LIGHT=9]="HARD_LIGHT",e[e.SOFT_LIGHT=10]="SOFT_LIGHT",e[e.DIFFERENCE=11]="DIFFERENCE",e[e.EXCLUSION=12]="EXCLUSION",e[e.HUE=13]="HUE",e[e.SATURATION=14]="SATURATION",e[e.COLOR=15]="COLOR",e[e.LUMINOSITY=16]="LUMINOSITY",e[e.NORMAL_NPM=17]="NORMAL_NPM",e[e.ADD_NPM=18]="ADD_NPM",e[e.SCREEN_NPM=19]="SCREEN_NPM",e[e.NONE=20]="NONE",e[e.SRC_OVER=0]="SRC_OVER",e[e.SRC_IN=21]="SRC_IN",e[e.SRC_OUT=22]="SRC_OUT",e[e.SRC_ATOP=23]="SRC_ATOP",e[e.DST_OVER=24]="DST_OVER",e[e.DST_IN=25]="DST_IN",e[e.DST_OUT=26]="DST_OUT",e[e.DST_ATOP=27]="DST_ATOP",e[e.ERASE=26]="ERASE",e[e.SUBTRACT=28]="SUBTRACT",e[e.XOR=29]="XOR",e))(s||{}),u=(e=>(e[e.POINTS=0]="POINTS",e[e.LINES=1]="LINES",e[e.LINE_LOOP=2]="LINE_LOOP",e[e.LINE_STRIP=3]="LINE_STRIP",e[e.TRIANGLES=4]="TRIANGLES",e[e.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",e[e.TRIANGLE_FAN=6]="TRIANGLE_FAN",e))(u||{}),l=(e=>(e[e.RGBA=6408]="RGBA",e[e.RGB=6407]="RGB",e[e.RG=33319]="RG",e[e.RED=6403]="RED",e[e.RGBA_INTEGER=36249]="RGBA_INTEGER",e[e.RGB_INTEGER=36248]="RGB_INTEGER",e[e.RG_INTEGER=33320]="RG_INTEGER",e[e.RED_INTEGER=36244]="RED_INTEGER",e[e.ALPHA=6406]="ALPHA",e[e.LUMINANCE=6409]="LUMINANCE",e[e.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",e[e.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",e[e.DEPTH_STENCIL=34041]="DEPTH_STENCIL",e))(l||{}),h=(e=>(e[e.TEXTURE_2D=3553]="TEXTURE_2D",e[e.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",e[e.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",e[e.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",e[e.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",e[e.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",e[e.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",e[e.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",e[e.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",e))(h||{}),c=(e=>(e[e.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",e[e.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",e[e.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",e[e.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",e[e.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",e[e.UNSIGNED_INT=5125]="UNSIGNED_INT",e[e.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",e[e.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",e[e.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",e[e.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",e[e.BYTE=5120]="BYTE",e[e.SHORT=5122]="SHORT",e[e.INT=5124]="INT",e[e.FLOAT=5126]="FLOAT",e[e.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",e[e.HALF_FLOAT=36193]="HALF_FLOAT",e))(c||{}),f=(e=>(e[e.FLOAT=0]="FLOAT",e[e.INT=1]="INT",e[e.UINT=2]="UINT",e))(f||{}),d=(e=>(e[e.NEAREST=0]="NEAREST",e[e.LINEAR=1]="LINEAR",e))(d||{}),p=(e=>(e[e.CLAMP=33071]="CLAMP",e[e.REPEAT=10497]="REPEAT",e[e.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",e))(p||{}),y=(e=>(e[e.OFF=0]="OFF",e[e.POW2=1]="POW2",e[e.ON=2]="ON",e[e.ON_MANUAL=3]="ON_MANUAL",e))(y||{}),m=(e=>(e[e.NPM=0]="NPM",e[e.UNPACK=1]="UNPACK",e[e.PMA=2]="PMA",e[e.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",e[e.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",e[e.PREMULTIPLIED_ALPHA=2]="PREMULTIPLIED_ALPHA",e))(m||{}),g=(e=>(e[e.NO=0]="NO",e[e.YES=1]="YES",e[e.AUTO=2]="AUTO",e[e.BLEND=0]="BLEND",e[e.CLEAR=1]="CLEAR",e[e.BLIT=2]="BLIT",e))(g||{}),w=(e=>(e[e.AUTO=0]="AUTO",e[e.MANUAL=1]="MANUAL",e))(w||{}),v=(e=>(e.LOW="lowp",e.MEDIUM="mediump",e.HIGH="highp",e))(v||{}),b=(e=>(e[e.NONE=0]="NONE",e[e.SCISSOR=1]="SCISSOR",e[e.STENCIL=2]="STENCIL",e[e.SPRITE=3]="SPRITE",e[e.COLOR=4]="COLOR",e))(b||{}),x=(e=>(e[e.RED=1]="RED",e[e.GREEN=2]="GREEN",e[e.BLUE=4]="BLUE",e[e.ALPHA=8]="ALPHA",e))(x||{}),_=(e=>(e[e.NONE=0]="NONE",e[e.LOW=2]="LOW",e[e.MEDIUM=4]="MEDIUM",e[e.HIGH=8]="HIGH",e))(_||{}),S=(e=>(e[e.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",e[e.ARRAY_BUFFER=34962]="ARRAY_BUFFER",e[e.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER",e))(S||{});const T={createCanvas:(e,t)=>{const r=document.createElement("canvas");return r.width=e,r.height=t,r},getCanvasRenderingContext2D:()=>CanvasRenderingContext2D,getWebGLRenderingContext:()=>WebGLRenderingContext,getNavigator:()=>navigator,getBaseUrl:()=>document.baseURI??window.location.href,getFontFaceSet:()=>document.fonts,fetch:(e,t)=>fetch(e,t),parseXML:e=>(new DOMParser).parseFromString(e,"text/xml")},E={ADAPTER:T,RESOLUTION:1,CREATE_IMAGE_BITMAP:!1,ROUND_PIXELS:!1};var O=/iPhone/i,A=/iPod/i,I=/iPad/i,P=/\biOS-universal(?:.+)Mac\b/i,k=/\bAndroid(?:.+)Mobile\b/i,C=/Android/i,$=/(?:SD4930UR|\bSilk(?:.+)Mobile\b)/i,R=/Silk/i,D=/Windows Phone/i,M=/\bWindows(?:.+)ARM\b/i,L=/BlackBerry/i,B=/BB10/i,N=/Opera Mini/i,F=/\b(CriOS|Chrome)(?:.+)Mobile/i,U=/Mobile(?:.+)Firefox\b/i,j=function(e){return void 0!==e&&"MacIntel"===e.platform&&"number"==typeof e.maxTouchPoints&&e.maxTouchPoints>1&&"undefined"==typeof MSStream};function z(e){var t={userAgent:"",platform:"",maxTouchPoints:0};e||"undefined"==typeof navigator?"string"==typeof e?t.userAgent=e:e&&e.userAgent&&(t={userAgent:e.userAgent,platform:e.platform,maxTouchPoints:e.maxTouchPoints||0}):t={userAgent:navigator.userAgent,platform:navigator.platform,maxTouchPoints:navigator.maxTouchPoints||0};var r=t.userAgent,n=r.split("[FBAN");void 0!==n[1]&&(r=n[0]),void 0!==(n=r.split("Twitter"))[1]&&(r=n[0]);var i=function(e){return function(t){return t.test(e)}}(r),o={apple:{phone:i(O)&&!i(D),ipod:i(A),tablet:!i(O)&&(i(I)||j(t))&&!i(D),universal:i(P),device:(i(O)||i(A)||i(I)||i(P)||j(t))&&!i(D)},amazon:{phone:i($),tablet:!i($)&&i(R),device:i($)||i(R)},android:{phone:!i(D)&&i($)||!i(D)&&i(k),tablet:!i(D)&&!i($)&&!i(k)&&(i(R)||i(C)),device:!i(D)&&(i($)||i(R)||i(k)||i(C))||i(/\bokhttp\b/i)},windows:{phone:i(D),tablet:i(M),device:i(D)||i(M)},other:{blackberry:i(L),blackberry10:i(B),opera:i(N),firefox:i(U),chrome:i(F),device:i(L)||i(B)||i(N)||i(U)||i(F)},any:!1,phone:!1,tablet:!1};return o.any=o.apple.device||o.android.device||o.windows.device||o.other.device,o.phone=o.apple.phone||o.android.phone||o.windows.phone,o.tablet=o.apple.tablet||o.android.tablet||o.windows.tablet,o}const G=(z.default??z)(globalThis.navigator);E.RETINA_PREFIX=/@([0-9\.]+)x/,E.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT=!1;var V=r(9452),W=r(6570),H=r(8835);const q={};function Y(e,t,r=3){if(q[t])return;let n=(new Error).stack;typeof n>"u"?console.warn("PixiJS Deprecation Warning: ",`${t}\nDeprecated since v${e}`):(n=n.split("\n").splice(r).join("\n"),console.groupCollapsed?(console.groupCollapsed("%cPixiJS Deprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",`${t}\nDeprecated since v${e}`),console.warn(n),console.groupEnd()):(console.warn("PixiJS Deprecation Warning: ",`${t}\nDeprecated since v${e}`),console.warn(n))),q[t]=!0}const X={get parse(){return Y("7.3.0","utils.url.parse is deprecated, use native URL API instead."),H.qg},get format(){return Y("7.3.0","utils.url.format is deprecated, use native URL API instead."),H.GP},get resolve(){return Y("7.3.0","utils.url.resolve is deprecated, use native URL API instead."),H.hd}};function K(e){if("string"!=typeof e)throw new TypeError(`Path must be a string. Received ${JSON.stringify(e)}`)}function Z(e){return e.split("?")[0].split("#")[0]}const J={toPosix(e){return t="\\",r="/",e.replace(new RegExp(t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"g"),r);var t,r},isUrl(e){return/^https?:/.test(this.toPosix(e))},isDataUrl:e=>/^data:([a-z]+\/[a-z0-9-+.]+(;[a-z0-9-.!#$%*+.{}|~`]+=[a-z0-9-.!#$%*+.{}()_|~`]+)*)?(;base64)?,([a-z0-9!$&',()*+;=\-._~:@\/?%\s<>]*?)$/i.test(e),isBlobUrl:e=>e.startsWith("blob:"),hasProtocol(e){return/^[^/:]+:/.test(this.toPosix(e))},getProtocol(e){K(e),e=this.toPosix(e);const t=/^file:\/\/\//.exec(e);if(t)return t[0];const r=/^[^/:]+:\/{0,2}/.exec(e);return r?r[0]:""},toAbsolute(e,t,r){if(K(e),this.isDataUrl(e)||this.isBlobUrl(e))return e;const n=Z(this.toPosix(t??E.ADAPTER.getBaseUrl())),i=Z(this.toPosix(r??this.rootname(n)));return(e=this.toPosix(e)).startsWith("/")?J.join(i,e.slice(1)):this.isAbsolute(e)?e:this.join(n,e)},normalize(e){if(K(e),0===e.length)return".";if(this.isDataUrl(e)||this.isBlobUrl(e))return e;let t="";const r=(e=this.toPosix(e)).startsWith("/");this.hasProtocol(e)&&(t=this.rootname(e),e=e.slice(t.length));const n=e.endsWith("/");return e=function(e,t){let r="",n=0,i=-1,o=0,a=-1;for(let s=0;s<=e.length;++s){if(s<e.length)a=e.charCodeAt(s);else{if(47===a)break;a=47}if(47===a){if(i!==s-1&&1!==o)if(i!==s-1&&2===o){if(r.length<2||2!==n||46!==r.charCodeAt(r.length-1)||46!==r.charCodeAt(r.length-2))if(r.length>2){const e=r.lastIndexOf("/");if(e!==r.length-1){-1===e?(r="",n=0):(r=r.slice(0,e),n=r.length-1-r.lastIndexOf("/")),i=s,o=0;continue}}else if(2===r.length||1===r.length){r="",n=0,i=s,o=0;continue}t&&(r.length>0?r+="/..":r="..",n=2)}else r.length>0?r+=`/${e.slice(i+1,s)}`:r=e.slice(i+1,s),n=s-i-1;i=s,o=0}else 46===a&&-1!==o?++o:o=-1}return r}(e,!1),e.length>0&&n&&(e+="/"),r?`/${e}`:t+e},isAbsolute(e){return K(e),e=this.toPosix(e),!!this.hasProtocol(e)||e.startsWith("/")},join(...e){if(0===e.length)return".";let t;for(let r=0;r<e.length;++r){const n=e[r];if(K(n),n.length>0)if(void 0===t)t=n;else{const i=e[r-1]??"";this.joinExtensions.includes(this.extname(i).toLowerCase())?t+=`/../${n}`:t+=`/${n}`}}return void 0===t?".":this.normalize(t)},dirname(e){if(K(e),0===e.length)return".";let t=(e=this.toPosix(e)).charCodeAt(0);const r=47===t;let n=-1,i=!0;const o=this.getProtocol(e),a=e;for(let r=(e=e.slice(o.length)).length-1;r>=1;--r)if(t=e.charCodeAt(r),47===t){if(!i){n=r;break}}else i=!1;return-1===n?r?"/":this.isUrl(a)?o+e:o:r&&1===n?"//":o+e.slice(0,n)},rootname(e){K(e);let t="";if(t=(e=this.toPosix(e)).startsWith("/")?"/":this.getProtocol(e),this.isUrl(e)){const r=e.indexOf("/",t.length);t=-1!==r?e.slice(0,r):e,t.endsWith("/")||(t+="/")}return t},basename(e,t){K(e),t&&K(t),e=Z(this.toPosix(e));let r,n=0,i=-1,o=!0;if(void 0!==t&&t.length>0&&t.length<=e.length){if(t.length===e.length&&t===e)return"";let a=t.length-1,s=-1;for(r=e.length-1;r>=0;--r){const u=e.charCodeAt(r);if(47===u){if(!o){n=r+1;break}}else-1===s&&(o=!1,s=r+1),a>=0&&(u===t.charCodeAt(a)?-1==--a&&(i=r):(a=-1,i=s))}return n===i?i=s:-1===i&&(i=e.length),e.slice(n,i)}for(r=e.length-1;r>=0;--r)if(47===e.charCodeAt(r)){if(!o){n=r+1;break}}else-1===i&&(o=!1,i=r+1);return-1===i?"":e.slice(n,i)},extname(e){K(e);let t=-1,r=0,n=-1,i=!0,o=0;for(let a=(e=Z(this.toPosix(e))).length-1;a>=0;--a){const s=e.charCodeAt(a);if(47!==s)-1===n&&(i=!1,n=a+1),46===s?-1===t?t=a:1!==o&&(o=1):-1!==t&&(o=-1);else if(!i){r=a+1;break}}return-1===t||-1===n||0===o||1===o&&t===n-1&&t===r+1?"":e.slice(t,n)},parse(e){K(e);const t={root:"",dir:"",base:"",ext:"",name:""};if(0===e.length)return t;let r=(e=Z(this.toPosix(e))).charCodeAt(0);const n=this.isAbsolute(e);let i;t.root=this.rootname(e),i=n||this.hasProtocol(e)?1:0;let o=-1,a=0,s=-1,u=!0,l=e.length-1,h=0;for(;l>=i;--l)if(r=e.charCodeAt(l),47!==r)-1===s&&(u=!1,s=l+1),46===r?-1===o?o=l:1!==h&&(h=1):-1!==o&&(h=-1);else if(!u){a=l+1;break}return-1===o||-1===s||0===h||1===h&&o===s-1&&o===a+1?-1!==s&&(t.base=t.name=0===a&&n?e.slice(1,s):e.slice(a,s)):(0===a&&n?(t.name=e.slice(1,o),t.base=e.slice(1,s)):(t.name=e.slice(a,o),t.base=e.slice(a,s)),t.ext=e.slice(o,s)),t.dir=this.dirname(e),t},sep:"/",delimiter:":",joinExtensions:[".html"]};let Q,ee;async function te(){return Q??(Q=(async()=>{const e=document.createElement("canvas").getContext("webgl");if(!e)return m.UNPACK;const t=await new Promise((e=>{const t=document.createElement("video");t.onloadeddata=()=>e(t),t.onerror=()=>e(null),t.autoplay=!1,t.crossOrigin="anonymous",t.preload="auto",t.src="data:video/webm;base64,GkXfo59ChoEBQveBAULygQRC84EIQoKEd2VibUKHgQJChYECGFOAZwEAAAAAAAHTEU2bdLpNu4tTq4QVSalmU6yBoU27i1OrhBZUrmtTrIHGTbuMU6uEElTDZ1OsggEXTbuMU6uEHFO7a1OsggG97AEAAAAAAABZAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAVSalmoCrXsYMPQkBNgIRMYXZmV0GETGF2ZkSJiEBEAAAAAAAAFlSua8yuAQAAAAAAAEPXgQFzxYgAAAAAAAAAAZyBACK1nIN1bmSIgQCGhVZfVlA5g4EBI+ODhAJiWgDglLCBArqBApqBAlPAgQFVsIRVuYEBElTDZ9Vzc9JjwItjxYgAAAAAAAAAAWfInEWjh0VOQ09ERVJEh49MYXZjIGxpYnZweC12cDlnyKJFo4hEVVJBVElPTkSHlDAwOjAwOjAwLjA0MDAwMDAwMAAAH0O2dcfngQCgwqGggQAAAIJJg0IAABAAFgA4JBwYSgAAICAAEb///4r+AAB1oZ2mm+6BAaWWgkmDQgAAEAAWADgkHBhKAAAgIABIQBxTu2uRu4+zgQC3iveBAfGCAXHwgQM=",t.load()}));if(!t)return m.UNPACK;const r=e.createTexture();e.bindTexture(e.TEXTURE_2D,r);const n=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,n),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,r,0),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),e.pixelStorei(e.UNPACK_COLORSPACE_CONVERSION_WEBGL,e.NONE),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,t);const i=new Uint8Array(4);return e.readPixels(0,0,1,1,e.RGBA,e.UNSIGNED_BYTE,i),e.deleteFramebuffer(n),e.deleteTexture(r),e.getExtension("WEBGL_lose_context")?.loseContext(),i[0]<=i[3]?m.PMA:m.UNPACK})()),Q}function re(){Y("7.0.0","skipHello is deprecated, please use settings.RENDER_OPTIONS.hello")}function ne(){Y("7.0.0",'sayHello is deprecated, please use Renderer\'s "hello" option')}function ie(){return typeof ee>"u"&&(ee=function(){const e={stencil:!0,failIfMajorPerformanceCaveat:E.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT};try{if(!E.ADAPTER.getWebGLRenderingContext())return!1;const t=E.ADAPTER.createCanvas();let r=t.getContext("webgl",e)||t.getContext("experimental-webgl",e);const n=!!r?.getContextAttributes()?.stencil;if(r){const e=r.getExtension("WEBGL_lose_context");e&&e.loseContext()}return r=null,n}catch{return!1}}()),ee}var oe={grad:.9,turn:360,rad:360/(2*Math.PI)},ae=function(e){return"string"==typeof e?e.length>0:"number"==typeof e},se=function(e,t,r){return void 0===t&&(t=0),void 0===r&&(r=Math.pow(10,t)),Math.round(r*e)/r+0},ue=function(e,t,r){return void 0===t&&(t=0),void 0===r&&(r=1),e>r?r:e>t?e:t},le=function(e){return(e=isFinite(e)?e%360:0)>0?e:e+360},he=function(e){return{r:ue(e.r,0,255),g:ue(e.g,0,255),b:ue(e.b,0,255),a:ue(e.a)}},ce=function(e){return{r:se(e.r),g:se(e.g),b:se(e.b),a:se(e.a,3)}},fe=/^#([0-9a-f]{3,8})$/i,de=function(e){var t=e.toString(16);return t.length<2?"0"+t:t},pe=function(e){var t=e.r,r=e.g,n=e.b,i=e.a,o=Math.max(t,r,n),a=o-Math.min(t,r,n),s=a?o===t?(r-n)/a:o===r?2+(n-t)/a:4+(t-r)/a:0;return{h:60*(s<0?s+6:s),s:o?a/o*100:0,v:o/255*100,a:i}},ye=function(e){var t=e.h,r=e.s,n=e.v,i=e.a;t=t/360*6,r/=100,n/=100;var o=Math.floor(t),a=n*(1-r),s=n*(1-(t-o)*r),u=n*(1-(1-t+o)*r),l=o%6;return{r:255*[n,s,a,a,u,n][l],g:255*[u,n,n,s,a,a][l],b:255*[a,a,u,n,n,s][l],a:i}},me=function(e){return{h:le(e.h),s:ue(e.s,0,100),l:ue(e.l,0,100),a:ue(e.a)}},ge=function(e){return{h:se(e.h),s:se(e.s),l:se(e.l),a:se(e.a,3)}},we=function(e){return ye((r=(t=e).s,{h:t.h,s:(r*=((n=t.l)<50?n:100-n)/100)>0?2*r/(n+r)*100:0,v:n+r,a:t.a}));var t,r,n},ve=function(e){return{h:(t=pe(e)).h,s:(i=(200-(r=t.s))*(n=t.v)/100)>0&&i<200?r*n/100/(i<=100?i:200-i)*100:0,l:i/2,a:t.a};var t,r,n,i},be=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s*,\s*([+-]?\d*\.?\d+)%\s*,\s*([+-]?\d*\.?\d+)%\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,xe=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s+([+-]?\d*\.?\d+)%\s+([+-]?\d*\.?\d+)%\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,_e=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,Se=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,Te={string:[[function(e){var t=fe.exec(e);return t?(e=t[1]).length<=4?{r:parseInt(e[0]+e[0],16),g:parseInt(e[1]+e[1],16),b:parseInt(e[2]+e[2],16),a:4===e.length?se(parseInt(e[3]+e[3],16)/255,2):1}:6===e.length||8===e.length?{r:parseInt(e.substr(0,2),16),g:parseInt(e.substr(2,2),16),b:parseInt(e.substr(4,2),16),a:8===e.length?se(parseInt(e.substr(6,2),16)/255,2):1}:null:null},"hex"],[function(e){var t=_e.exec(e)||Se.exec(e);return t?t[2]!==t[4]||t[4]!==t[6]?null:he({r:Number(t[1])/(t[2]?100/255:1),g:Number(t[3])/(t[4]?100/255:1),b:Number(t[5])/(t[6]?100/255:1),a:void 0===t[7]?1:Number(t[7])/(t[8]?100:1)}):null},"rgb"],[function(e){var t=be.exec(e)||xe.exec(e);if(!t)return null;var r,n,i=me({h:(r=t[1],n=t[2],void 0===n&&(n="deg"),Number(r)*(oe[n]||1)),s:Number(t[3]),l:Number(t[4]),a:void 0===t[5]?1:Number(t[5])/(t[6]?100:1)});return we(i)},"hsl"]],object:[[function(e){var t=e.r,r=e.g,n=e.b,i=e.a,o=void 0===i?1:i;return ae(t)&&ae(r)&&ae(n)?he({r:Number(t),g:Number(r),b:Number(n),a:Number(o)}):null},"rgb"],[function(e){var t=e.h,r=e.s,n=e.l,i=e.a,o=void 0===i?1:i;if(!ae(t)||!ae(r)||!ae(n))return null;var a=me({h:Number(t),s:Number(r),l:Number(n),a:Number(o)});return we(a)},"hsl"],[function(e){var t=e.h,r=e.s,n=e.v,i=e.a,o=void 0===i?1:i;if(!ae(t)||!ae(r)||!ae(n))return null;var a=function(e){return{h:le(e.h),s:ue(e.s,0,100),v:ue(e.v,0,100),a:ue(e.a)}}({h:Number(t),s:Number(r),v:Number(n),a:Number(o)});return ye(a)},"hsv"]]},Ee=function(e,t){for(var r=0;r<t.length;r++){var n=t[r][0](e);if(n)return[n,t[r][1]]}return[null,void 0]},Oe=function(e){return"string"==typeof e?Ee(e.trim(),Te.string):"object"==typeof e&&null!==e?Ee(e,Te.object):[null,void 0]},Ae=function(e,t){var r=ve(e);return{h:r.h,s:ue(r.s+100*t,0,100),l:r.l,a:r.a}},Ie=function(e){return(299*e.r+587*e.g+114*e.b)/1e3/255},Pe=function(e,t){var r=ve(e);return{h:r.h,s:r.s,l:ue(r.l+100*t,0,100),a:r.a}},ke=function(){function e(e){this.parsed=Oe(e)[0],this.rgba=this.parsed||{r:0,g:0,b:0,a:1}}return e.prototype.isValid=function(){return null!==this.parsed},e.prototype.brightness=function(){return se(Ie(this.rgba),2)},e.prototype.isDark=function(){return Ie(this.rgba)<.5},e.prototype.isLight=function(){return Ie(this.rgba)>=.5},e.prototype.toHex=function(){return t=(e=ce(this.rgba)).r,r=e.g,n=e.b,o=(i=e.a)<1?de(se(255*i)):"","#"+de(t)+de(r)+de(n)+o;var e,t,r,n,i,o},e.prototype.toRgb=function(){return ce(this.rgba)},e.prototype.toRgbString=function(){return t=(e=ce(this.rgba)).r,r=e.g,n=e.b,(i=e.a)<1?"rgba("+t+", "+r+", "+n+", "+i+")":"rgb("+t+", "+r+", "+n+")";var e,t,r,n,i},e.prototype.toHsl=function(){return ge(ve(this.rgba))},e.prototype.toHslString=function(){return t=(e=ge(ve(this.rgba))).h,r=e.s,n=e.l,(i=e.a)<1?"hsla("+t+", "+r+"%, "+n+"%, "+i+")":"hsl("+t+", "+r+"%, "+n+"%)";var e,t,r,n,i},e.prototype.toHsv=function(){return e=pe(this.rgba),{h:se(e.h),s:se(e.s),v:se(e.v),a:se(e.a,3)};var e},e.prototype.invert=function(){return Ce({r:255-(e=this.rgba).r,g:255-e.g,b:255-e.b,a:e.a});var e},e.prototype.saturate=function(e){return void 0===e&&(e=.1),Ce(Ae(this.rgba,e))},e.prototype.desaturate=function(e){return void 0===e&&(e=.1),Ce(Ae(this.rgba,-e))},e.prototype.grayscale=function(){return Ce(Ae(this.rgba,-1))},e.prototype.lighten=function(e){return void 0===e&&(e=.1),Ce(Pe(this.rgba,e))},e.prototype.darken=function(e){return void 0===e&&(e=.1),Ce(Pe(this.rgba,-e))},e.prototype.rotate=function(e){return void 0===e&&(e=15),this.hue(this.hue()+e)},e.prototype.alpha=function(e){return"number"==typeof e?Ce({r:(t=this.rgba).r,g:t.g,b:t.b,a:e}):se(this.rgba.a,3);var t},e.prototype.hue=function(e){var t=ve(this.rgba);return"number"==typeof e?Ce({h:e,s:t.s,l:t.l,a:t.a}):se(t.h)},e.prototype.isEqual=function(e){return this.toHex()===Ce(e).toHex()},e}(),Ce=function(e){return e instanceof ke?e:new ke(e)},$e=[];!function(e){e.forEach((function(e){$e.indexOf(e)<0&&(e(ke,Te),$e.push(e))}))}([function(e,t){var r={white:"#ffffff",bisque:"#ffe4c4",blue:"#0000ff",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",antiquewhite:"#faebd7",aqua:"#00ffff",azure:"#f0ffff",whitesmoke:"#f5f5f5",papayawhip:"#ffefd5",plum:"#dda0dd",blanchedalmond:"#ffebcd",black:"#000000",gold:"#ffd700",goldenrod:"#daa520",gainsboro:"#dcdcdc",cornsilk:"#fff8dc",cornflowerblue:"#6495ed",burlywood:"#deb887",aquamarine:"#7fffd4",beige:"#f5f5dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkkhaki:"#bdb76b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",peachpuff:"#ffdab9",darkmagenta:"#8b008b",darkred:"#8b0000",darkorchid:"#9932cc",darkorange:"#ff8c00",darkslateblue:"#483d8b",gray:"#808080",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",deeppink:"#ff1493",deepskyblue:"#00bfff",wheat:"#f5deb3",firebrick:"#b22222",floralwhite:"#fffaf0",ghostwhite:"#f8f8ff",darkviolet:"#9400d3",magenta:"#ff00ff",green:"#008000",dodgerblue:"#1e90ff",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",blueviolet:"#8a2be2",forestgreen:"#228b22",lawngreen:"#7cfc00",indianred:"#cd5c5c",indigo:"#4b0082",fuchsia:"#ff00ff",brown:"#a52a2a",maroon:"#800000",mediumblue:"#0000cd",lightcoral:"#f08080",darkturquoise:"#00ced1",lightcyan:"#e0ffff",ivory:"#fffff0",lightyellow:"#ffffe0",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",linen:"#faf0e6",mediumaquamarine:"#66cdaa",lemonchiffon:"#fffacd",lime:"#00ff00",khaki:"#f0e68c",mediumseagreen:"#3cb371",limegreen:"#32cd32",mediumspringgreen:"#00fa9a",lightskyblue:"#87cefa",lightblue:"#add8e6",midnightblue:"#191970",lightpink:"#ffb6c1",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",mintcream:"#f5fffa",lightslategray:"#778899",lightslategrey:"#778899",navajowhite:"#ffdead",navy:"#000080",mediumvioletred:"#c71585",powderblue:"#b0e0e6",palegoldenrod:"#eee8aa",oldlace:"#fdf5e6",paleturquoise:"#afeeee",mediumturquoise:"#48d1cc",mediumorchid:"#ba55d3",rebeccapurple:"#663399",lightsteelblue:"#b0c4de",mediumslateblue:"#7b68ee",thistle:"#d8bfd8",tan:"#d2b48c",orchid:"#da70d6",mediumpurple:"#9370db",purple:"#800080",pink:"#ffc0cb",skyblue:"#87ceeb",springgreen:"#00ff7f",palegreen:"#98fb98",red:"#ff0000",yellow:"#ffff00",slateblue:"#6a5acd",lavenderblush:"#fff0f5",peru:"#cd853f",palevioletred:"#db7093",violet:"#ee82ee",teal:"#008080",slategray:"#708090",slategrey:"#708090",aliceblue:"#f0f8ff",darkseagreen:"#8fbc8f",darkolivegreen:"#556b2f",greenyellow:"#adff2f",seagreen:"#2e8b57",seashell:"#fff5ee",tomato:"#ff6347",silver:"#c0c0c0",sienna:"#a0522d",lavender:"#e6e6fa",lightgreen:"#90ee90",orange:"#ffa500",orangered:"#ff4500",steelblue:"#4682b4",royalblue:"#4169e1",turquoise:"#40e0d0",yellowgreen:"#9acd32",salmon:"#fa8072",saddlebrown:"#8b4513",sandybrown:"#f4a460",rosybrown:"#bc8f8f",darksalmon:"#e9967a",lightgoldenrodyellow:"#fafad2",snow:"#fffafa",lightgrey:"#d3d3d3",lightgray:"#d3d3d3",dimgray:"#696969",dimgrey:"#696969",olivedrab:"#6b8e23",olive:"#808000"},n={};for(var i in r)n[r[i]]=i;var o={};e.prototype.toName=function(t){if(!(this.rgba.a||this.rgba.r||this.rgba.g||this.rgba.b))return"transparent";var i,a,s=n[this.toHex()];if(s)return s;if(null==t?void 0:t.closest){var u=this.toRgb(),l=1/0,h="black";if(!o.length)for(var c in r)o[c]=new e(r[c]).toRgb();for(var f in r){var d=(i=u,a=o[f],Math.pow(i.r-a.r,2)+Math.pow(i.g-a.g,2)+Math.pow(i.b-a.b,2));d<l&&(l=d,h=f)}return h}},t.string.push([function(t){var n=t.toLowerCase(),i="transparent"===n?"#0000":r[n];return i?new e(i).toRgb():null},"name"])}]);const Re=class e{constructor(e=16777215){this._value=null,this._components=new Float32Array(4),this._components.fill(1),this._int=16777215,this.value=e}get red(){return this._components[0]}get green(){return this._components[1]}get blue(){return this._components[2]}get alpha(){return this._components[3]}setValue(e){return this.value=e,this}set value(t){if(t instanceof e)this._value=this.cloneSource(t._value),this._int=t._int,this._components.set(t._components);else{if(null===t)throw new Error("Cannot set PIXI.Color#value to null");(null===this._value||!this.isSourceEqual(this._value,t))&&(this.normalize(t),this._value=this.cloneSource(t))}}get value(){return this._value}cloneSource(e){return"string"==typeof e||"number"==typeof e||e instanceof Number||null===e?e:Array.isArray(e)||ArrayBuffer.isView(e)?e.slice(0):"object"==typeof e&&null!==e?{...e}:e}isSourceEqual(e,t){const r=typeof e;if(r!==typeof t)return!1;if("number"===r||"string"===r||e instanceof Number)return e===t;if(Array.isArray(e)&&Array.isArray(t)||ArrayBuffer.isView(e)&&ArrayBuffer.isView(t))return e.length===t.length&&e.every(((e,r)=>e===t[r]));if(null!==e&&null!==t){const r=Object.keys(e),n=Object.keys(t);return r.length===n.length&&r.every((r=>e[r]===t[r]))}return e===t}toRgba(){const[e,t,r,n]=this._components;return{r:e,g:t,b:r,a:n}}toRgb(){const[e,t,r]=this._components;return{r:e,g:t,b:r}}toRgbaString(){const[e,t,r]=this.toUint8RgbArray();return`rgba(${e},${t},${r},${this.alpha})`}toUint8RgbArray(e){const[t,r,n]=this._components;return(e=e??[])[0]=Math.round(255*t),e[1]=Math.round(255*r),e[2]=Math.round(255*n),e}toRgbArray(e){e=e??[];const[t,r,n]=this._components;return e[0]=t,e[1]=r,e[2]=n,e}toNumber(){return this._int}toLittleEndianNumber(){const e=this._int;return(e>>16)+(65280&e)+((255&e)<<16)}multiply(t){const[r,n,i,o]=e.temp.setValue(t)._components;return this._components[0]*=r,this._components[1]*=n,this._components[2]*=i,this._components[3]*=o,this.refreshInt(),this._value=null,this}premultiply(e,t=!0){return t&&(this._components[0]*=e,this._components[1]*=e,this._components[2]*=e),this._components[3]=e,this.refreshInt(),this._value=null,this}toPremultiplied(e,t=!0){if(1===e)return(255<<24)+this._int;if(0===e)return t?0:this._int;let r=this._int>>16&255,n=this._int>>8&255,i=255&this._int;return t&&(r=r*e+.5|0,n=n*e+.5|0,i=i*e+.5|0),(255*e<<24)+(r<<16)+(n<<8)+i}toHex(){const e=this._int.toString(16);return`#${"000000".substring(0,6-e.length)+e}`}toHexa(){const e=Math.round(255*this._components[3]).toString(16);return this.toHex()+"00".substring(0,2-e.length)+e}setAlpha(e){return this._components[3]=this._clamp(e),this}round(e){const[t,r,n]=this._components;return this._components[0]=Math.round(t*e)/e,this._components[1]=Math.round(r*e)/e,this._components[2]=Math.round(n*e)/e,this.refreshInt(),this._value=null,this}toArray(e){e=e??[];const[t,r,n,i]=this._components;return e[0]=t,e[1]=r,e[2]=n,e[3]=i,e}normalize(t){let r,n,i,o;if(("number"==typeof t||t instanceof Number)&&t>=0&&t<=16777215){r=(t>>16&255)/255,n=(t>>8&255)/255,i=(255&t)/255,o=1}else if((Array.isArray(t)||t instanceof Float32Array)&&t.length>=3&&t.length<=4)t=this._clamp(t),[r,n,i,o=1]=t;else if((t instanceof Uint8Array||t instanceof Uint8ClampedArray)&&t.length>=3&&t.length<=4)t=this._clamp(t,0,255),[r,n,i,o=255]=t,r/=255,n/=255,i/=255,o/=255;else if("string"==typeof t||"object"==typeof t){if("string"==typeof t){const r=e.HEX_PATTERN.exec(t);r&&(t=`#${r[2]}`)}const a=Ce(t);a.isValid()&&(({r,g:n,b:i,a:o}=a.rgba),r/=255,n/=255,i/=255)}if(void 0===r)throw new Error(`Unable to convert color ${t}`);this._components[0]=r,this._components[1]=n,this._components[2]=i,this._components[3]=o,this.refreshInt()}refreshInt(){this._clamp(this._components);const[e,t,r]=this._components;this._int=(255*e<<16)+(255*t<<8)+(255*r|0)}_clamp(e,t=0,r=1){return"number"==typeof e?Math.min(Math.max(e,t),r):(e.forEach(((n,i)=>{e[i]=Math.min(Math.max(n,t),r)})),e)}};Re.shared=new Re,Re.temp=new Re,Re.HEX_PATTERN=/^(#|0x)?(([a-f0-9]{3}){1,2}([a-f0-9]{2})?)$/i;let De=Re;function Me(e,t=[]){return Y("7.2.0","utils.hex2rgb is deprecated, use Color#toRgbArray instead"),De.shared.setValue(e).toRgbArray(t)}function Le(e){return Y("7.2.0","utils.hex2string is deprecated, use Color#toHex instead"),De.shared.setValue(e).toHex()}function Be(e){return Y("7.2.0","utils.string2hex is deprecated, use Color#toNumber instead"),De.shared.setValue(e).toNumber()}function Ne(e){return Y("7.2.0","utils.rgb2hex is deprecated, use Color#toNumber instead"),De.shared.setValue(e).toNumber()}const Fe=function(){const e=[],t=[];for(let r=0;r<32;r++)e[r]=r,t[r]=r;e[s.NORMAL_NPM]=s.NORMAL,e[s.ADD_NPM]=s.ADD,e[s.SCREEN_NPM]=s.SCREEN,t[s.NORMAL]=s.NORMAL_NPM,t[s.ADD]=s.ADD_NPM,t[s.SCREEN]=s.SCREEN_NPM;const r=[];return r.push(t),r.push(e),r}();function Ue(e,t){return Fe[t?1:0][e]}function je(e,t,r,n=!0){return Y("7.2.0","utils.premultiplyRgba has moved to Color.premultiply"),De.shared.setValue(e).premultiply(t,n).toArray(r??new Float32Array(4))}function ze(e,t){return Y("7.2.0","utils.premultiplyTint has moved to Color.toPremultiplied"),De.shared.setValue(e).toPremultiplied(t)}function Ge(e,t,r,n=!0){return Y("7.2.0","utils.premultiplyTintToRgba has moved to Color.premultiply"),De.shared.setValue(e).premultiply(t,n).toArray(r??new Float32Array(4))}const Ve=/^\s*data:(?:([\w-]+)\/([\w+.-]+))?(?:;charset=([\w-]+))?(?:;(base64))?,(.*)/i;function We(e,t=null){const r=6*e;if((t=t||new Uint16Array(r)).length!==r)throw new Error(`Out buffer length is incorrect, got ${t.length} and expected ${r}`);for(let e=0,n=0;e<r;e+=6,n+=4)t[e+0]=n+0,t[e+1]=n+1,t[e+2]=n+2,t[e+3]=n+0,t[e+4]=n+2,t[e+5]=n+3;return t}function He(e){if(4===e.BYTES_PER_ELEMENT)return e instanceof Float32Array?"Float32Array":e instanceof Uint32Array?"Uint32Array":"Int32Array";if(2===e.BYTES_PER_ELEMENT){if(e instanceof Uint16Array)return"Uint16Array"}else if(1===e.BYTES_PER_ELEMENT&&e instanceof Uint8Array)return"Uint8Array";return null}const qe={Float32Array,Uint32Array,Int32Array,Uint8Array};function Ye(e,t){let r=0,n=0;const i={};for(let i=0;i<e.length;i++)n+=t[i],r+=e[i].length;const o=new ArrayBuffer(4*r);let a=null,s=0;for(let r=0;r<e.length;r++){const u=t[r],l=e[r],h=He(l);i[h]||(i[h]=new qe[h](o)),a=i[h];for(let e=0;e<l.length;e++){a[(e/u|0)*n+s+e%u]=l[e]}s+=u}return new Float32Array(o)}function Xe(e){return e+=0===e?1:0,--e,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,(e|=e>>>16)+1}function Ke(e){return!(e&e-1||!e)}function Ze(e){let t=(e>65535?1:0)<<4,r=((e>>>=t)>255?1:0)<<3;return t|=r,r=((e>>>=r)>15?1:0)<<2,t|=r,r=((e>>>=r)>3?1:0)<<1,t|=r,t|(e>>>=r)>>1}function Je(e,t,r){const n=e.length;let i;if(t>=n||0===r)return;const o=n-(r=t+r>n?n-t:r);for(i=t;i<o;++i)e[i]=e[i+r];e.length=o}function Qe(e){return 0===e?0:e<0?-1:1}let et=0;function tt(){return++et}const rt=class{constructor(e,t,r,n){this.left=e,this.top=t,this.right=r,this.bottom=n}get width(){return this.right-this.left}get height(){return this.bottom-this.top}isEmpty(){return this.left===this.right||this.top===this.bottom}};rt.EMPTY=new rt(0,0,0,0);let nt=rt;const it={},ot=Object.create(null),at=Object.create(null);function st(){let e;for(e in ot)ot[e].destroy();for(e in at)at[e].destroy()}function ut(){let e;for(e in ot)delete ot[e];for(e in at)delete at[e]}class lt{constructor(e,t,r){this._canvas=E.ADAPTER.createCanvas(),this._context=this._canvas.getContext("2d"),this.resolution=r||E.RESOLUTION,this.resize(e,t)}clear(){this._checkDestroyed(),this._context.setTransform(1,0,0,1,0,0),this._context.clearRect(0,0,this._canvas.width,this._canvas.height)}resize(e,t){this._checkDestroyed(),this._canvas.width=Math.round(e*this.resolution),this._canvas.height=Math.round(t*this.resolution)}destroy(){this._context=null,this._canvas=null}get width(){return this._checkDestroyed(),this._canvas.width}set width(e){this._checkDestroyed(),this._canvas.width=Math.round(e)}get height(){return this._checkDestroyed(),this._canvas.height}set height(e){this._checkDestroyed(),this._canvas.height=Math.round(e)}get canvas(){return this._checkDestroyed(),this._canvas}get context(){return this._checkDestroyed(),this._context}_checkDestroyed(){if(null===this._canvas)throw new TypeError("The CanvasRenderTarget has already been destroyed")}}function ht(e,t,r){for(let n=0,i=4*r*t;n<t;++n,i+=4)if(0!==e[i+3])return!1;return!0}function ct(e,t,r,n,i){const o=4*t;for(let t=n,a=n*o+4*r;t<=i;++t,a+=o)if(0!==e[a+3])return!1;return!0}function ft(e){const{width:t,height:r}=e,n=e.getContext("2d",{willReadFrequently:!0});if(null===n)throw new TypeError("Failed to get canvas 2D context");const i=n.getImageData(0,0,t,r).data;let o=0,a=0,s=t-1,u=r-1;for(;a<r&&ht(i,t,a);)++a;if(a===r)return nt.EMPTY;for(;ht(i,t,u);)--u;for(;ct(i,t,o,a,u);)++o;for(;ct(i,t,s,a,u);)--s;return++s,++u,new nt(o,a,s,u)}function dt(e){const t=ft(e),{width:r,height:n}=t;let i=null;if(!t.isEmpty()){const o=e.getContext("2d");if(null===o)throw new TypeError("Failed to get canvas 2D context");i=o.getImageData(t.left,t.top,r,n)}return{width:r,height:n,data:i}}function pt(e){const t=Ve.exec(e);if(t)return{mediaType:t[1]?t[1].toLowerCase():void 0,subType:t[2]?t[2].toLowerCase():void 0,charset:t[3]?t[3].toLowerCase():void 0,encoding:t[4]?t[4].toLowerCase():void 0,data:t[5]}}function yt(e,t=globalThis.location){if(e.startsWith("data:"))return"";t=t||globalThis.location;const r=new URL(e,document.baseURI);return r.hostname!==t.hostname||r.port!==t.port||r.protocol!==t.protocol?"anonymous":""}function mt(e,t=1){const r=E.RETINA_PREFIX?.exec(e);return r?parseFloat(r[1]):t}var gt=(e=>(e.Renderer="renderer",e.Application="application",e.RendererSystem="renderer-webgl-system",e.RendererPlugin="renderer-webgl-plugin",e.CanvasRendererSystem="renderer-canvas-system",e.CanvasRendererPlugin="renderer-canvas-plugin",e.Asset="asset",e.LoadParser="load-parser",e.ResolveParser="resolve-parser",e.CacheParser="cache-parser",e.DetectionParser="detection-parser",e))(gt||{});const wt=e=>{if("function"==typeof e||"object"==typeof e&&e.extension){if(!e.extension)throw new Error("Extension class must have an extension object");e={..."object"!=typeof e.extension?{type:e.extension}:e.extension,ref:e}}if("object"!=typeof e)throw new Error("Invalid extension type");return"string"==typeof(e={...e}).type&&(e.type=[e.type]),e},vt=(e,t)=>wt(e).priority??t,bt={_addHandlers:{},_removeHandlers:{},_queue:{},remove(...e){return e.map(wt).forEach((e=>{e.type.forEach((t=>this._removeHandlers[t]?.(e)))})),this},add(...e){return e.map(wt).forEach((e=>{e.type.forEach((t=>{const r=this._addHandlers,n=this._queue;r[t]?r[t]?.(e):(n[t]=n[t]||[],n[t]?.push(e))}))})),this},handle(e,t,r){const n=this._addHandlers,i=this._removeHandlers;if(n[e]||i[e])throw new Error(`Extension type ${e} already has a handler`);n[e]=t,i[e]=r;const o=this._queue;return o[e]&&(o[e]?.forEach((e=>t(e))),delete o[e]),this},handleByMap(e,t){return this.handle(e,(e=>{e.name&&(t[e.name]=e.ref)}),(e=>{e.name&&delete t[e.name]}))},handleByList(e,t,r=-1){return this.handle(e,(e=>{t.includes(e.ref)||(t.push(e.ref),t.sort(((e,t)=>vt(t,r)-vt(e,r))))}),(e=>{const r=t.indexOf(e.ref);-1!==r&&t.splice(r,1)}))}};class xt{constructor(e){"number"==typeof e?this.rawBinaryData=new ArrayBuffer(e):e instanceof Uint8Array?this.rawBinaryData=e.buffer:this.rawBinaryData=e,this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData)}get int8View(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View}get uint8View(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View}get int16View(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View}get uint16View(){return this._uint16View||(this._uint16View=new Uint16Array(this.rawBinaryData)),this._uint16View}get int32View(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View}view(e){return this[`${e}View`]}destroy(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this._uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null}static sizeOf(e){switch(e){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(`${e} isn't a valid view type`)}}}const _t=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join("\n");function St(e){let t="";for(let r=0;r<e;++r)r>0&&(t+="\nelse "),r<e-1&&(t+=`if(test == ${r}.0){}`);return t}function Tt(e,t){if(0===e)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");const r=t.createShader(t.FRAGMENT_SHADER);for(;;){const n=_t.replace(/%forloop%/gi,St(e));if(t.shaderSource(r,n),t.compileShader(r),t.getShaderParameter(r,t.COMPILE_STATUS))break;e=e/2|0}return e}class Et{constructor(){this.data=0,this.blendMode=s.NORMAL,this.polygonOffset=0,this.blend=!0,this.depthMask=!0}get blend(){return!!(1&this.data)}set blend(e){!!(1&this.data)!==e&&(this.data^=1)}get offsets(){return!!(2&this.data)}set offsets(e){!!(2&this.data)!==e&&(this.data^=2)}get culling(){return!!(4&this.data)}set culling(e){!!(4&this.data)!==e&&(this.data^=4)}get depthTest(){return!!(8&this.data)}set depthTest(e){!!(8&this.data)!==e&&(this.data^=8)}get depthMask(){return!!(32&this.data)}set depthMask(e){!!(32&this.data)!==e&&(this.data^=32)}get clockwiseFrontFace(){return!!(16&this.data)}set clockwiseFrontFace(e){!!(16&this.data)!==e&&(this.data^=16)}get blendMode(){return this._blendMode}set blendMode(e){this.blend=e!==s.NONE,this._blendMode=e}get polygonOffset(){return this._polygonOffset}set polygonOffset(e){this.offsets=!!e,this._polygonOffset=e}static for2d(){const e=new Et;return e.depthTest=!1,e.blend=!0,e}}Et.prototype.toString=function(){return`[@pixi/core:State blendMode=${this.blendMode} clockwiseFrontFace=${this.clockwiseFrontFace} culling=${this.culling} depthMask=${this.depthMask} polygonOffset=${this.polygonOffset}]`};const Ot=[];function At(e,t){if(!e)return null;let r="";if("string"==typeof e){const t=/\.(\w{3,4})(?:$|\?|#)/i.exec(e);t&&(r=t[1].toLowerCase())}for(let n=Ot.length-1;n>=0;--n){const i=Ot[n];if(i.test&&i.test(e,r))return new i(e,t)}throw new Error("Unrecognized source type to auto-detect Resource")}class It{constructor(e){this.items=[],this._name=e,this._aliasCount=0}emit(e,t,r,n,i,o,a,s){if(arguments.length>8)throw new Error("max arguments reached");const{name:u,items:l}=this;this._aliasCount++;for(let h=0,c=l.length;h<c;h++)l[h][u](e,t,r,n,i,o,a,s);return l===this.items&&this._aliasCount--,this}ensureNonAliasedItems(){this._aliasCount>0&&this.items.length>1&&(this._aliasCount=0,this.items=this.items.slice(0))}add(e){return e[this._name]&&(this.ensureNonAliasedItems(),this.remove(e),this.items.push(e)),this}remove(e){const t=this.items.indexOf(e);return-1!==t&&(this.ensureNonAliasedItems(),this.items.splice(t,1)),this}contains(e){return this.items.includes(e)}removeAll(){return this.ensureNonAliasedItems(),this.items.length=0,this}destroy(){this.removeAll(),this.items.length=0,this._name=""}get empty(){return 0===this.items.length}get name(){return this._name}}Object.defineProperties(It.prototype,{dispatch:{value:It.prototype.emit},run:{value:It.prototype.emit}});class Pt{constructor(e=0,t=0){this._width=e,this._height=t,this.destroyed=!1,this.internal=!1,this.onResize=new It("setRealSize"),this.onUpdate=new It("update"),this.onError=new It("onError")}bind(e){this.onResize.add(e),this.onUpdate.add(e),this.onError.add(e),(this._width||this._height)&&this.onResize.emit(this._width,this._height)}unbind(e){this.onResize.remove(e),this.onUpdate.remove(e),this.onError.remove(e)}resize(e,t){(e!==this._width||t!==this._height)&&(this._width=e,this._height=t,this.onResize.emit(e,t))}get valid(){return!!this._width&&!!this._height}update(){this.destroyed||this.onUpdate.emit()}load(){return Promise.resolve(this)}get width(){return this._width}get height(){return this._height}style(e,t,r){return!1}dispose(){}destroy(){this.destroyed||(this.destroyed=!0,this.dispose(),this.onError.removeAll(),this.onError=null,this.onResize.removeAll(),this.onResize=null,this.onUpdate.removeAll(),this.onUpdate=null)}static test(e,t){return!1}}class kt extends Pt{constructor(e,t){const{width:r,height:n}=t||{};if(!r||!n)throw new Error("BufferResource width or height invalid");super(r,n),this.data=e,this.unpackAlignment=t.unpackAlignment??4}upload(e,t,r){const n=e.gl;n.pixelStorei(n.UNPACK_ALIGNMENT,this.unpackAlignment),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t.alphaMode===m.UNPACK);const i=t.realWidth,o=t.realHeight;return r.width===i&&r.height===o?n.texSubImage2D(t.target,0,0,0,i,o,t.format,r.type,this.data):(r.width=i,r.height=o,n.texImage2D(t.target,0,r.internalFormat,i,o,0,t.format,r.type,this.data)),!0}dispose(){this.data=null}static test(e){return null===e||e instanceof Int8Array||e instanceof Uint8Array||e instanceof Uint8ClampedArray||e instanceof Int16Array||e instanceof Uint16Array||e instanceof Int32Array||e instanceof Uint32Array||e instanceof Float32Array}}const Ct={scaleMode:d.NEAREST,alphaMode:m.NPM},$t=class e extends V{constructor(t=null,r=null){super(),r=Object.assign({},e.defaultOptions,r);const{alphaMode:n,mipmap:i,anisotropicLevel:o,scaleMode:a,width:s,height:u,wrapMode:l,format:h,type:c,target:f,resolution:d,resourceOptions:p}=r;t&&!(t instanceof Pt)&&((t=At(t,p)).internal=!0),this.resolution=d||E.RESOLUTION,this.width=Math.round((s||0)*this.resolution)/this.resolution,this.height=Math.round((u||0)*this.resolution)/this.resolution,this._mipmap=i,this.anisotropicLevel=o,this._wrapMode=l,this._scaleMode=a,this.format=h,this.type=c,this.target=f,this.alphaMode=n,this.uid=tt(),this.touched=0,this.isPowerOfTwo=!1,this._refreshPOT(),this._glTextures={},this.dirtyId=0,this.dirtyStyleId=0,this.cacheId=null,this.valid=s>0&&u>0,this.textureCacheIds=[],this.destroyed=!1,this.resource=null,this._batchEnabled=0,this._batchLocation=0,this.parentTextureArray=null,this.setResource(t)}get realWidth(){return Math.round(this.width*this.resolution)}get realHeight(){return Math.round(this.height*this.resolution)}get mipmap(){return this._mipmap}set mipmap(e){this._mipmap!==e&&(this._mipmap=e,this.dirtyStyleId++)}get scaleMode(){return this._scaleMode}set scaleMode(e){this._scaleMode!==e&&(this._scaleMode=e,this.dirtyStyleId++)}get wrapMode(){return this._wrapMode}set wrapMode(e){this._wrapMode!==e&&(this._wrapMode=e,this.dirtyStyleId++)}setStyle(e,t){let r;return void 0!==e&&e!==this.scaleMode&&(this.scaleMode=e,r=!0),void 0!==t&&t!==this.mipmap&&(this.mipmap=t,r=!0),r&&this.dirtyStyleId++,this}setSize(e,t,r){return r=r||this.resolution,this.setRealSize(e*r,t*r,r)}setRealSize(e,t,r){return this.resolution=r||this.resolution,this.width=Math.round(e)/this.resolution,this.height=Math.round(t)/this.resolution,this._refreshPOT(),this.update(),this}_refreshPOT(){this.isPowerOfTwo=Ke(this.realWidth)&&Ke(this.realHeight)}setResolution(e){const t=this.resolution;return t===e||(this.resolution=e,this.valid&&(this.width=Math.round(this.width*t)/e,this.height=Math.round(this.height*t)/e,this.emit("update",this)),this._refreshPOT()),this}setResource(e){if(this.resource===e)return this;if(this.resource)throw new Error("Resource can be set only once");return e.bind(this),this.resource=e,this}update(){this.valid?(this.dirtyId++,this.dirtyStyleId++,this.emit("update",this)):this.width>0&&this.height>0&&(this.valid=!0,this.emit("loaded",this),this.emit("update",this))}onError(e){this.emit("error",this,e)}destroy(){this.resource&&(this.resource.unbind(this),this.resource.internal&&this.resource.destroy(),this.resource=null),this.cacheId&&(delete at[this.cacheId],delete ot[this.cacheId],this.cacheId=null),this.valid=!1,this.dispose(),e.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0,this.emit("destroyed",this),this.removeAllListeners()}dispose(){this.emit("dispose",this)}castToBaseTexture(){return this}static from(t,r,n=E.STRICT_TEXTURE_CACHE){const i="string"==typeof t;let o=null;if(i)o=t;else{if(!t._pixiId){const e=r?.pixiIdPrefix||"pixiid";t._pixiId=`${e}_${tt()}`}o=t._pixiId}let a=at[o];if(i&&n&&!a)throw new Error(`The cacheId "${o}" does not exist in BaseTextureCache.`);return a||(a=new e(t,r),a.cacheId=o,e.addToCache(a,o)),a}static fromBuffer(t,r,n,i){t=t||new Float32Array(r*n*4);const o=new kt(t,{width:r,height:n,...i?.resourceOptions});let a,s;return t instanceof Float32Array?(a=l.RGBA,s=c.FLOAT):t instanceof Int32Array?(a=l.RGBA_INTEGER,s=c.INT):t instanceof Uint32Array?(a=l.RGBA_INTEGER,s=c.UNSIGNED_INT):t instanceof Int16Array?(a=l.RGBA_INTEGER,s=c.SHORT):t instanceof Uint16Array?(a=l.RGBA_INTEGER,s=c.UNSIGNED_SHORT):t instanceof Int8Array?(a=l.RGBA,s=c.BYTE):(a=l.RGBA,s=c.UNSIGNED_BYTE),o.internal=!0,new e(o,Object.assign({},Ct,{type:s,format:a},i))}static addToCache(e,t){t&&(e.textureCacheIds.includes(t)||e.textureCacheIds.push(t),at[t]&&at[t]!==e&&console.warn(`BaseTexture added to the cache with an id [${t}] that already had an entry`),at[t]=e)}static removeFromCache(e){if("string"==typeof e){const t=at[e];if(t){const r=t.textureCacheIds.indexOf(e);return r>-1&&t.textureCacheIds.splice(r,1),delete at[e],t}}else if(e?.textureCacheIds){for(let t=0;t<e.textureCacheIds.length;++t)delete at[e.textureCacheIds[t]];return e.textureCacheIds.length=0,e}return null}};$t.defaultOptions={mipmap:y.POW2,anisotropicLevel:0,scaleMode:d.LINEAR,wrapMode:p.CLAMP,alphaMode:m.UNPACK,target:h.TEXTURE_2D,format:l.RGBA,type:c.UNSIGNED_BYTE},$t._globalBatch=0;let Rt=$t;class Dt{constructor(){this.texArray=null,this.blend=0,this.type=u.TRIANGLES,this.start=0,this.size=0,this.data=null}}let Mt=0;class Lt{constructor(e,t=!0,r=!1){this.data=e||new Float32Array(1),this._glBuffers={},this._updateID=0,this.index=r,this.static=t,this.id=Mt++,this.disposeRunner=new It("disposeBuffer")}update(e){e instanceof Array&&(e=new Float32Array(e)),this.data=e||this.data,this._updateID++}dispose(){this.disposeRunner.emit(this,!1)}destroy(){this.dispose(),this.data=null}set index(e){this.type=e?S.ELEMENT_ARRAY_BUFFER:S.ARRAY_BUFFER}get index(){return this.type===S.ELEMENT_ARRAY_BUFFER}static from(e){return e instanceof Array&&(e=new Float32Array(e)),new Lt(e)}}class Bt{constructor(e,t=0,r=!1,n=c.FLOAT,i,o,a,s=1){this.buffer=e,this.size=t,this.normalized=r,this.type=n,this.stride=i,this.start=o,this.instance=a,this.divisor=s}destroy(){this.buffer=null}static from(e,t,r,n,i){return new Bt(e,t,r,n,i)}}const Nt={Float32Array,Uint32Array,Int32Array,Uint8Array};const Ft={5126:4,5123:2,5121:1};let Ut=0;const jt={Float32Array,Uint32Array,Int32Array,Uint8Array,Uint16Array};class zt{constructor(e=[],t={}){this.buffers=e,this.indexBuffer=null,this.attributes=t,this.glVertexArrayObjects={},this.id=Ut++,this.instanced=!1,this.instanceCount=1,this.disposeRunner=new It("disposeGeometry"),this.refCount=0}addAttribute(e,t,r=0,n=!1,i,o,a,s=!1){if(!t)throw new Error("You must pass a buffer when creating an attribute");t instanceof Lt||(t instanceof Array&&(t=new Float32Array(t)),t=new Lt(t));const u=e.split("|");if(u.length>1){for(let e=0;e<u.length;e++)this.addAttribute(u[e],t,r,n,i);return this}let l=this.buffers.indexOf(t);return-1===l&&(this.buffers.push(t),l=this.buffers.length-1),this.attributes[e]=new Bt(l,r,n,i,o,a,s),this.instanced=this.instanced||s,this}getAttribute(e){return this.attributes[e]}getBuffer(e){return this.buffers[this.getAttribute(e).buffer]}addIndex(e){return e instanceof Lt||(e instanceof Array&&(e=new Uint16Array(e)),e=new Lt(e)),e.type=S.ELEMENT_ARRAY_BUFFER,this.indexBuffer=e,this.buffers.includes(e)||this.buffers.push(e),this}getIndex(){return this.indexBuffer}interleave(){if(1===this.buffers.length||2===this.buffers.length&&this.indexBuffer)return this;const e=[],t=[],r=new Lt;let n;for(n in this.attributes){const r=this.attributes[n],i=this.buffers[r.buffer];e.push(i.data),t.push(r.size*Ft[r.type]/4),r.buffer=0}for(r.data=function(e,t){let r=0,n=0;const i={};for(let i=0;i<e.length;i++)n+=t[i],r+=e[i].length;const o=new ArrayBuffer(4*r);let a=null,s=0;for(let r=0;r<e.length;r++){const u=t[r],l=e[r],h=He(l);i[h]||(i[h]=new Nt[h](o)),a=i[h];for(let e=0;e<l.length;e++)a[(e/u|0)*n+s+e%u]=l[e];s+=u}return new Float32Array(o)}(e,t),n=0;n<this.buffers.length;n++)this.buffers[n]!==this.indexBuffer&&this.buffers[n].destroy();return this.buffers=[r],this.indexBuffer&&this.buffers.push(this.indexBuffer),this}getSize(){for(const e in this.attributes){const t=this.attributes[e];return this.buffers[t.buffer].data.length/(t.stride/4||t.size)}return 0}dispose(){this.disposeRunner.emit(this,!1)}destroy(){this.dispose(),this.buffers=null,this.indexBuffer=null,this.attributes=null}clone(){const e=new zt;for(let t=0;t<this.buffers.length;t++)e.buffers[t]=new Lt(this.buffers[t].data.slice(0));for(const t in this.attributes){const r=this.attributes[t];e.attributes[t]=new Bt(r.buffer,r.size,r.normalized,r.type,r.stride,r.start,r.instance)}return this.indexBuffer&&(e.indexBuffer=e.buffers[this.buffers.indexOf(this.indexBuffer)],e.indexBuffer.type=S.ELEMENT_ARRAY_BUFFER),e}static merge(e){const t=new zt,r=[],n=[],i=[];let o;for(let t=0;t<e.length;t++){o=e[t];for(let e=0;e<o.buffers.length;e++)n[e]=n[e]||0,n[e]+=o.buffers[e].data.length,i[e]=0}for(let e=0;e<o.buffers.length;e++)r[e]=new(jt[He(o.buffers[e].data)])(n[e]),t.buffers[e]=new Lt(r[e]);for(let t=0;t<e.length;t++){o=e[t];for(let e=0;e<o.buffers.length;e++)r[e].set(o.buffers[e].data,i[e]),i[e]+=o.buffers[e].data.length}if(t.attributes=o.attributes,o.indexBuffer){t.indexBuffer=t.buffers[o.buffers.indexOf(o.indexBuffer)],t.indexBuffer.type=S.ELEMENT_ARRAY_BUFFER;let r=0,n=0,i=0,a=0;for(let e=0;e<o.buffers.length;e++)if(o.buffers[e]!==o.indexBuffer){a=e;break}for(const e in o.attributes){const t=o.attributes[e];(0|t.buffer)===a&&(n+=t.size*Ft[t.type]/4)}for(let o=0;o<e.length;o++){const s=e[o].indexBuffer.data;for(let e=0;e<s.length;e++)t.indexBuffer.data[e+i]+=r;r+=e[o].buffers[a].data.length/n,i+=s.length}}return t}}class Gt extends zt{constructor(e=!1){super(),this._buffer=new Lt(null,e,!1),this._indexBuffer=new Lt(null,e,!0),this.addAttribute("aVertexPosition",this._buffer,2,!1,c.FLOAT).addAttribute("aTextureCoord",this._buffer,2,!1,c.FLOAT).addAttribute("aColor",this._buffer,4,!0,c.UNSIGNED_BYTE).addAttribute("aTextureId",this._buffer,1,!0,c.FLOAT).addIndex(this._indexBuffer)}}const Vt=2*Math.PI,Wt=180/Math.PI,Ht=Math.PI/180;var qt=(e=>(e[e.POLY=0]="POLY",e[e.RECT=1]="RECT",e[e.CIRC=2]="CIRC",e[e.ELIP=3]="ELIP",e[e.RREC=4]="RREC",e))(qt||{});class Yt{constructor(e=0,t=0){this.x=0,this.y=0,this.x=e,this.y=t}clone(){return new Yt(this.x,this.y)}copyFrom(e){return this.set(e.x,e.y),this}copyTo(e){return e.set(this.x,this.y),e}equals(e){return e.x===this.x&&e.y===this.y}set(e=0,t=e){return this.x=e,this.y=t,this}}Yt.prototype.toString=function(){return`[@pixi/math:Point x=${this.x} y=${this.y}]`};const Xt=[new Yt,new Yt,new Yt,new Yt];class Kt{constructor(e=0,t=0,r=0,n=0){this.x=Number(e),this.y=Number(t),this.width=Number(r),this.height=Number(n),this.type=qt.RECT}get left(){return this.x}get right(){return this.x+this.width}get top(){return this.y}get bottom(){return this.y+this.height}static get EMPTY(){return new Kt(0,0,0,0)}clone(){return new Kt(this.x,this.y,this.width,this.height)}copyFrom(e){return this.x=e.x,this.y=e.y,this.width=e.width,this.height=e.height,this}copyTo(e){return e.x=this.x,e.y=this.y,e.width=this.width,e.height=this.height,e}contains(e,t){return!(this.width<=0||this.height<=0)&&(e>=this.x&&e<this.x+this.width&&t>=this.y&&t<this.y+this.height)}intersects(e,t){if(!t){const t=this.x<e.x?e.x:this.x;if((this.right>e.right?e.right:this.right)<=t)return!1;const r=this.y<e.y?e.y:this.y;return(this.bottom>e.bottom?e.bottom:this.bottom)>r}const r=this.left,n=this.right,i=this.top,o=this.bottom;if(n<=r||o<=i)return!1;const a=Xt[0].set(e.left,e.top),s=Xt[1].set(e.left,e.bottom),u=Xt[2].set(e.right,e.top),l=Xt[3].set(e.right,e.bottom);if(u.x<=a.x||s.y<=a.y)return!1;const h=Math.sign(t.a*t.d-t.b*t.c);if(0===h||(t.apply(a,a),t.apply(s,s),t.apply(u,u),t.apply(l,l),Math.max(a.x,s.x,u.x,l.x)<=r||Math.min(a.x,s.x,u.x,l.x)>=n||Math.max(a.y,s.y,u.y,l.y)<=i||Math.min(a.y,s.y,u.y,l.y)>=o))return!1;const c=h*(s.y-a.y),f=h*(a.x-s.x),d=c*r+f*i,p=c*n+f*i,y=c*r+f*o,m=c*n+f*o;if(Math.max(d,p,y,m)<=c*a.x+f*a.y||Math.min(d,p,y,m)>=c*l.x+f*l.y)return!1;const g=h*(a.y-u.y),w=h*(u.x-a.x),v=g*r+w*i,b=g*n+w*i,x=g*r+w*o,_=g*n+w*o;return!(Math.max(v,b,x,_)<=g*a.x+w*a.y||Math.min(v,b,x,_)>=g*l.x+w*l.y)}pad(e=0,t=e){return this.x-=e,this.y-=t,this.width+=2*e,this.height+=2*t,this}fit(e){const t=Math.max(this.x,e.x),r=Math.min(this.x+this.width,e.x+e.width),n=Math.max(this.y,e.y),i=Math.min(this.y+this.height,e.y+e.height);return this.x=t,this.width=Math.max(r-t,0),this.y=n,this.height=Math.max(i-n,0),this}ceil(e=1,t=.001){const r=Math.ceil((this.x+this.width-t)*e)/e,n=Math.ceil((this.y+this.height-t)*e)/e;return this.x=Math.floor((this.x+t)*e)/e,this.y=Math.floor((this.y+t)*e)/e,this.width=r-this.x,this.height=n-this.y,this}enlarge(e){const t=Math.min(this.x,e.x),r=Math.max(this.x+this.width,e.x+e.width),n=Math.min(this.y,e.y),i=Math.max(this.y+this.height,e.y+e.height);return this.x=t,this.width=r-t,this.y=n,this.height=i-n,this}}Kt.prototype.toString=function(){return`[@pixi/math:Rectangle x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`};class Zt{constructor(e=0,t=0,r=0){this.x=e,this.y=t,this.radius=r,this.type=qt.CIRC}clone(){return new Zt(this.x,this.y,this.radius)}contains(e,t){if(this.radius<=0)return!1;const r=this.radius*this.radius;let n=this.x-e,i=this.y-t;return n*=n,i*=i,n+i<=r}getBounds(){return new Kt(this.x-this.radius,this.y-this.radius,2*this.radius,2*this.radius)}}Zt.prototype.toString=function(){return`[@pixi/math:Circle x=${this.x} y=${this.y} radius=${this.radius}]`};class Jt{constructor(e=0,t=0,r=0,n=0){this.x=e,this.y=t,this.width=r,this.height=n,this.type=qt.ELIP}clone(){return new Jt(this.x,this.y,this.width,this.height)}contains(e,t){if(this.width<=0||this.height<=0)return!1;let r=(e-this.x)/this.width,n=(t-this.y)/this.height;return r*=r,n*=n,r+n<=1}getBounds(){return new Kt(this.x-this.width,this.y-this.height,this.width,this.height)}}Jt.prototype.toString=function(){return`[@pixi/math:Ellipse x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`};class Qt{constructor(...e){let t=Array.isArray(e[0])?e[0]:e;if("number"!=typeof t[0]){const e=[];for(let r=0,n=t.length;r<n;r++)e.push(t[r].x,t[r].y);t=e}this.points=t,this.type=qt.POLY,this.closeStroke=!0}clone(){const e=this.points.slice(),t=new Qt(e);return t.closeStroke=this.closeStroke,t}contains(e,t){let r=!1;const n=this.points.length/2;for(let i=0,o=n-1;i<n;o=i++){const n=this.points[2*i],a=this.points[2*i+1],s=this.points[2*o],u=this.points[2*o+1];a>t!=u>t&&e<(t-a)/(u-a)*(s-n)+n&&(r=!r)}return r}}Qt.prototype.toString=function(){return`[@pixi/math:PolygoncloseStroke=${this.closeStroke}points=${this.points.reduce(((e,t)=>`${e}, ${t}`),"")}]`};class er{constructor(e=0,t=0,r=0,n=0,i=20){this.x=e,this.y=t,this.width=r,this.height=n,this.radius=i,this.type=qt.RREC}clone(){return new er(this.x,this.y,this.width,this.height,this.radius)}contains(e,t){if(this.width<=0||this.height<=0)return!1;if(e>=this.x&&e<=this.x+this.width&&t>=this.y&&t<=this.y+this.height){const r=Math.max(0,Math.min(this.radius,Math.min(this.width,this.height)/2));if(t>=this.y+r&&t<=this.y+this.height-r||e>=this.x+r&&e<=this.x+this.width-r)return!0;let n=e-(this.x+r),i=t-(this.y+r);const o=r*r;if(n*n+i*i<=o||(n=e-(this.x+this.width-r),n*n+i*i<=o)||(i=t-(this.y+this.height-r),n*n+i*i<=o)||(n=e-(this.x+r),n*n+i*i<=o))return!0}return!1}}er.prototype.toString=function(){return`[@pixi/math:RoundedRectangle x=${this.x} y=${this.y}width=${this.width} height=${this.height} radius=${this.radius}]`};class tr{constructor(e=1,t=0,r=0,n=1,i=0,o=0){this.array=null,this.a=e,this.b=t,this.c=r,this.d=n,this.tx=i,this.ty=o}fromArray(e){this.a=e[0],this.b=e[1],this.c=e[3],this.d=e[4],this.tx=e[2],this.ty=e[5]}set(e,t,r,n,i,o){return this.a=e,this.b=t,this.c=r,this.d=n,this.tx=i,this.ty=o,this}toArray(e,t){this.array||(this.array=new Float32Array(9));const r=t||this.array;return e?(r[0]=this.a,r[1]=this.b,r[2]=0,r[3]=this.c,r[4]=this.d,r[5]=0,r[6]=this.tx,r[7]=this.ty,r[8]=1):(r[0]=this.a,r[1]=this.c,r[2]=this.tx,r[3]=this.b,r[4]=this.d,r[5]=this.ty,r[6]=0,r[7]=0,r[8]=1),r}apply(e,t){t=t||new Yt;const r=e.x,n=e.y;return t.x=this.a*r+this.c*n+this.tx,t.y=this.b*r+this.d*n+this.ty,t}applyInverse(e,t){t=t||new Yt;const r=1/(this.a*this.d+this.c*-this.b),n=e.x,i=e.y;return t.x=this.d*r*n+-this.c*r*i+(this.ty*this.c-this.tx*this.d)*r,t.y=this.a*r*i+-this.b*r*n+(-this.ty*this.a+this.tx*this.b)*r,t}translate(e,t){return this.tx+=e,this.ty+=t,this}scale(e,t){return this.a*=e,this.d*=t,this.c*=e,this.b*=t,this.tx*=e,this.ty*=t,this}rotate(e){const t=Math.cos(e),r=Math.sin(e),n=this.a,i=this.c,o=this.tx;return this.a=n*t-this.b*r,this.b=n*r+this.b*t,this.c=i*t-this.d*r,this.d=i*r+this.d*t,this.tx=o*t-this.ty*r,this.ty=o*r+this.ty*t,this}append(e){const t=this.a,r=this.b,n=this.c,i=this.d;return this.a=e.a*t+e.b*n,this.b=e.a*r+e.b*i,this.c=e.c*t+e.d*n,this.d=e.c*r+e.d*i,this.tx=e.tx*t+e.ty*n+this.tx,this.ty=e.tx*r+e.ty*i+this.ty,this}setTransform(e,t,r,n,i,o,a,s,u){return this.a=Math.cos(a+u)*i,this.b=Math.sin(a+u)*i,this.c=-Math.sin(a-s)*o,this.d=Math.cos(a-s)*o,this.tx=e-(r*this.a+n*this.c),this.ty=t-(r*this.b+n*this.d),this}prepend(e){const t=this.tx;if(1!==e.a||0!==e.b||0!==e.c||1!==e.d){const t=this.a,r=this.c;this.a=t*e.a+this.b*e.c,this.b=t*e.b+this.b*e.d,this.c=r*e.a+this.d*e.c,this.d=r*e.b+this.d*e.d}return this.tx=t*e.a+this.ty*e.c+e.tx,this.ty=t*e.b+this.ty*e.d+e.ty,this}decompose(e){const t=this.a,r=this.b,n=this.c,i=this.d,o=e.pivot,a=-Math.atan2(-n,i),s=Math.atan2(r,t),u=Math.abs(a+s);return u<1e-5||Math.abs(Vt-u)<1e-5?(e.rotation=s,e.skew.x=e.skew.y=0):(e.rotation=0,e.skew.x=a,e.skew.y=s),e.scale.x=Math.sqrt(t*t+r*r),e.scale.y=Math.sqrt(n*n+i*i),e.position.x=this.tx+(o.x*t+o.y*n),e.position.y=this.ty+(o.x*r+o.y*i),e}invert(){const e=this.a,t=this.b,r=this.c,n=this.d,i=this.tx,o=e*n-t*r;return this.a=n/o,this.b=-t/o,this.c=-r/o,this.d=e/o,this.tx=(r*this.ty-n*i)/o,this.ty=-(e*this.ty-t*i)/o,this}identity(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this}clone(){const e=new tr;return e.a=this.a,e.b=this.b,e.c=this.c,e.d=this.d,e.tx=this.tx,e.ty=this.ty,e}copyTo(e){return e.a=this.a,e.b=this.b,e.c=this.c,e.d=this.d,e.tx=this.tx,e.ty=this.ty,e}copyFrom(e){return this.a=e.a,this.b=e.b,this.c=e.c,this.d=e.d,this.tx=e.tx,this.ty=e.ty,this}static get IDENTITY(){return new tr}static get TEMP_MATRIX(){return new tr}}tr.prototype.toString=function(){return`[@pixi/math:Matrix a=${this.a} b=${this.b} c=${this.c} d=${this.d} tx=${this.tx} ty=${this.ty}]`};const rr=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],nr=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],ir=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],or=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],ar=[],sr=[],ur=Math.sign;!function(){for(let e=0;e<16;e++){const t=[];ar.push(t);for(let r=0;r<16;r++){const n=ur(rr[e]*rr[r]+ir[e]*nr[r]),i=ur(nr[e]*rr[r]+or[e]*nr[r]),o=ur(rr[e]*ir[r]+ir[e]*or[r]),a=ur(nr[e]*ir[r]+or[e]*or[r]);for(let e=0;e<16;e++)if(rr[e]===n&&nr[e]===i&&ir[e]===o&&or[e]===a){t.push(e);break}}}for(let e=0;e<16;e++){const t=new tr;t.set(rr[e],nr[e],ir[e],or[e],0,0),sr.push(t)}}();const lr={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:e=>rr[e],uY:e=>nr[e],vX:e=>ir[e],vY:e=>or[e],inv:e=>8&e?15&e:7&-e,add:(e,t)=>ar[e][t],sub:(e,t)=>ar[e][lr.inv(t)],rotate180:e=>4^e,isVertical:e=>2==(3&e),byDirection:(e,t)=>2*Math.abs(e)<=Math.abs(t)?t>=0?lr.S:lr.N:2*Math.abs(t)<=Math.abs(e)?e>0?lr.E:lr.W:t>0?e>0?lr.SE:lr.SW:e>0?lr.NE:lr.NW,matrixAppendRotationInv:(e,t,r=0,n=0)=>{const i=sr[lr.inv(t)];i.tx=r,i.ty=n,e.append(i)}};class hr{constructor(e,t,r=0,n=0){this._x=r,this._y=n,this.cb=e,this.scope=t}clone(e=this.cb,t=this.scope){return new hr(e,t,this._x,this._y)}set(e=0,t=e){return(this._x!==e||this._y!==t)&&(this._x=e,this._y=t,this.cb.call(this.scope)),this}copyFrom(e){return(this._x!==e.x||this._y!==e.y)&&(this._x=e.x,this._y=e.y,this.cb.call(this.scope)),this}copyTo(e){return e.set(this._x,this._y),e}equals(e){return e.x===this._x&&e.y===this._y}get x(){return this._x}set x(e){this._x!==e&&(this._x=e,this.cb.call(this.scope))}get y(){return this._y}set y(e){this._y!==e&&(this._y=e,this.cb.call(this.scope))}}hr.prototype.toString=function(){return`[@pixi/math:ObservablePoint x=${this.x} y=${this.y} scope=${this.scope}]`};const cr=class{constructor(){this.worldTransform=new tr,this.localTransform=new tr,this.position=new hr(this.onChange,this,0,0),this.scale=new hr(this.onChange,this,1,1),this.pivot=new hr(this.onChange,this,0,0),this.skew=new hr(this.updateSkew,this,0,0),this._rotation=0,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._localID=0,this._currentLocalID=0,this._worldID=0,this._parentID=0}onChange(){this._localID++}updateSkew(){this._cx=Math.cos(this._rotation+this.skew.y),this._sx=Math.sin(this._rotation+this.skew.y),this._cy=-Math.sin(this._rotation-this.skew.x),this._sy=Math.cos(this._rotation-this.skew.x),this._localID++}updateLocalTransform(){const e=this.localTransform;this._localID!==this._currentLocalID&&(e.a=this._cx*this.scale.x,e.b=this._sx*this.scale.x,e.c=this._cy*this.scale.y,e.d=this._sy*this.scale.y,e.tx=this.position.x-(this.pivot.x*e.a+this.pivot.y*e.c),e.ty=this.position.y-(this.pivot.x*e.b+this.pivot.y*e.d),this._currentLocalID=this._localID,this._parentID=-1)}updateTransform(e){const t=this.localTransform;if(this._localID!==this._currentLocalID&&(t.a=this._cx*this.scale.x,t.b=this._sx*this.scale.x,t.c=this._cy*this.scale.y,t.d=this._sy*this.scale.y,t.tx=this.position.x-(this.pivot.x*t.a+this.pivot.y*t.c),t.ty=this.position.y-(this.pivot.x*t.b+this.pivot.y*t.d),this._currentLocalID=this._localID,this._parentID=-1),this._parentID!==e._worldID){const r=e.worldTransform,n=this.worldTransform;n.a=t.a*r.a+t.b*r.c,n.b=t.a*r.b+t.b*r.d,n.c=t.c*r.a+t.d*r.c,n.d=t.c*r.b+t.d*r.d,n.tx=t.tx*r.a+t.ty*r.c+r.tx,n.ty=t.tx*r.b+t.ty*r.d+r.ty,this._parentID=e._worldID,this._worldID++}}setFromMatrix(e){e.decompose(this),this._localID++}get rotation(){return this._rotation}set rotation(e){this._rotation!==e&&(this._rotation=e,this.updateSkew())}};cr.IDENTITY=new cr;let fr=cr;fr.prototype.toString=function(){return`[@pixi/math:Transform position=(${this.position.x}, ${this.position.y}) rotation=${this.rotation} scale=(${this.scale.x}, ${this.scale.y}) skew=(${this.skew.x}, ${this.skew.y}) ]`};const dr=[{test:e=>"float"===e.type&&1===e.size&&!e.isArray,code:e=>`\n            if(uv["${e}"] !== ud["${e}"].value)\n            {\n                ud["${e}"].value = uv["${e}"]\n                gl.uniform1f(ud["${e}"].location, uv["${e}"])\n            }\n            `},{test:(e,t)=>!("sampler2D"!==e.type&&"samplerCube"!==e.type&&"sampler2DArray"!==e.type||1!==e.size||e.isArray||null!=t&&void 0===t.castToBaseTexture),code:e=>`t = syncData.textureCount++;\n\n            renderer.texture.bind(uv["${e}"], t);\n\n            if(ud["${e}"].value !== t)\n            {\n                ud["${e}"].value = t;\n                gl.uniform1i(ud["${e}"].location, t);\n; // eslint-disable-line max-len\n            }`},{test:(e,t)=>"mat3"===e.type&&1===e.size&&!e.isArray&&void 0!==t.a,code:e=>`\n            gl.uniformMatrix3fv(ud["${e}"].location, false, uv["${e}"].toArray(true));\n            `,codeUbo:e=>`\n                var ${e}_matrix = uv.${e}.toArray(true);\n\n                data[offset] = ${e}_matrix[0];\n                data[offset+1] = ${e}_matrix[1];\n                data[offset+2] = ${e}_matrix[2];\n        \n                data[offset + 4] = ${e}_matrix[3];\n                data[offset + 5] = ${e}_matrix[4];\n                data[offset + 6] = ${e}_matrix[5];\n        \n                data[offset + 8] = ${e}_matrix[6];\n                data[offset + 9] = ${e}_matrix[7];\n                data[offset + 10] = ${e}_matrix[8];\n            `},{test:(e,t)=>"vec2"===e.type&&1===e.size&&!e.isArray&&void 0!==t.x,code:e=>`\n                cv = ud["${e}"].value;\n                v = uv["${e}"];\n\n                if(cv[0] !== v.x || cv[1] !== v.y)\n                {\n                    cv[0] = v.x;\n                    cv[1] = v.y;\n                    gl.uniform2f(ud["${e}"].location, v.x, v.y);\n                }`,codeUbo:e=>`\n                v = uv.${e};\n\n                data[offset] = v.x;\n                data[offset+1] = v.y;\n            `},{test:e=>"vec2"===e.type&&1===e.size&&!e.isArray,code:e=>`\n                cv = ud["${e}"].value;\n                v = uv["${e}"];\n\n                if(cv[0] !== v[0] || cv[1] !== v[1])\n                {\n                    cv[0] = v[0];\n                    cv[1] = v[1];\n                    gl.uniform2f(ud["${e}"].location, v[0], v[1]);\n                }\n            `},{test:(e,t)=>"vec4"===e.type&&1===e.size&&!e.isArray&&void 0!==t.width,code:e=>`\n                cv = ud["${e}"].value;\n                v = uv["${e}"];\n\n                if(cv[0] !== v.x || cv[1] !== v.y || cv[2] !== v.width || cv[3] !== v.height)\n                {\n                    cv[0] = v.x;\n                    cv[1] = v.y;\n                    cv[2] = v.width;\n                    cv[3] = v.height;\n                    gl.uniform4f(ud["${e}"].location, v.x, v.y, v.width, v.height)\n                }`,codeUbo:e=>`\n                    v = uv.${e};\n\n                    data[offset] = v.x;\n                    data[offset+1] = v.y;\n                    data[offset+2] = v.width;\n                    data[offset+3] = v.height;\n                `},{test:(e,t)=>"vec4"===e.type&&1===e.size&&!e.isArray&&void 0!==t.red,code:e=>`\n                cv = ud["${e}"].value;\n                v = uv["${e}"];\n\n                if(cv[0] !== v.red || cv[1] !== v.green || cv[2] !== v.blue || cv[3] !== v.alpha)\n                {\n                    cv[0] = v.red;\n                    cv[1] = v.green;\n                    cv[2] = v.blue;\n                    cv[3] = v.alpha;\n                    gl.uniform4f(ud["${e}"].location, v.red, v.green, v.blue, v.alpha)\n                }`,codeUbo:e=>`\n                    v = uv.${e};\n\n                    data[offset] = v.red;\n                    data[offset+1] = v.green;\n                    data[offset+2] = v.blue;\n                    data[offset+3] = v.alpha;\n                `},{test:(e,t)=>"vec3"===e.type&&1===e.size&&!e.isArray&&void 0!==t.red,code:e=>`\n                cv = ud["${e}"].value;\n                v = uv["${e}"];\n\n                if(cv[0] !== v.red || cv[1] !== v.green || cv[2] !== v.blue || cv[3] !== v.a)\n                {\n                    cv[0] = v.red;\n                    cv[1] = v.green;\n                    cv[2] = v.blue;\n    \n                    gl.uniform3f(ud["${e}"].location, v.red, v.green, v.blue)\n                }`,codeUbo:e=>`\n                    v = uv.${e};\n\n                    data[offset] = v.red;\n                    data[offset+1] = v.green;\n                    data[offset+2] = v.blue;\n                `},{test:e=>"vec4"===e.type&&1===e.size&&!e.isArray,code:e=>`\n                cv = ud["${e}"].value;\n                v = uv["${e}"];\n\n                if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n                {\n                    cv[0] = v[0];\n                    cv[1] = v[1];\n                    cv[2] = v[2];\n                    cv[3] = v[3];\n\n                    gl.uniform4f(ud["${e}"].location, v[0], v[1], v[2], v[3])\n                }`}],pr={float:"\n    if (cv !== v)\n    {\n        cu.value = v;\n        gl.uniform1f(location, v);\n    }",vec2:"\n    if (cv[0] !== v[0] || cv[1] !== v[1])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n\n        gl.uniform2f(location, v[0], v[1])\n    }",vec3:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n\n        gl.uniform3f(location, v[0], v[1], v[2])\n    }",vec4:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n        cv[3] = v[3];\n\n        gl.uniform4f(location, v[0], v[1], v[2], v[3]);\n    }",int:"\n    if (cv !== v)\n    {\n        cu.value = v;\n\n        gl.uniform1i(location, v);\n    }",ivec2:"\n    if (cv[0] !== v[0] || cv[1] !== v[1])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n\n        gl.uniform2i(location, v[0], v[1]);\n    }",ivec3:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n\n        gl.uniform3i(location, v[0], v[1], v[2]);\n    }",ivec4:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n        cv[3] = v[3];\n\n        gl.uniform4i(location, v[0], v[1], v[2], v[3]);\n    }",uint:"\n    if (cv !== v)\n    {\n        cu.value = v;\n\n        gl.uniform1ui(location, v);\n    }",uvec2:"\n    if (cv[0] !== v[0] || cv[1] !== v[1])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n\n        gl.uniform2ui(location, v[0], v[1]);\n    }",uvec3:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n\n        gl.uniform3ui(location, v[0], v[1], v[2]);\n    }",uvec4:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n        cv[3] = v[3];\n\n        gl.uniform4ui(location, v[0], v[1], v[2], v[3]);\n    }",bool:"\n    if (cv !== v)\n    {\n        cu.value = v;\n        gl.uniform1i(location, v);\n    }",bvec2:"\n    if (cv[0] != v[0] || cv[1] != v[1])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n\n        gl.uniform2i(location, v[0], v[1]);\n    }",bvec3:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n\n        gl.uniform3i(location, v[0], v[1], v[2]);\n    }",bvec4:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n        cv[3] = v[3];\n\n        gl.uniform4i(location, v[0], v[1], v[2], v[3]);\n    }",mat2:"gl.uniformMatrix2fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",sampler2D:"\n    if (cv !== v)\n    {\n        cu.value = v;\n\n        gl.uniform1i(location, v);\n    }",samplerCube:"\n    if (cv !== v)\n    {\n        cu.value = v;\n\n        gl.uniform1i(location, v);\n    }",sampler2DArray:"\n    if (cv !== v)\n    {\n        cu.value = v;\n\n        gl.uniform1i(location, v);\n    }"},yr={float:"gl.uniform1fv(location, v)",vec2:"gl.uniform2fv(location, v)",vec3:"gl.uniform3fv(location, v)",vec4:"gl.uniform4fv(location, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat2:"gl.uniformMatrix2fv(location, false, v)",int:"gl.uniform1iv(location, v)",ivec2:"gl.uniform2iv(location, v)",ivec3:"gl.uniform3iv(location, v)",ivec4:"gl.uniform4iv(location, v)",uint:"gl.uniform1uiv(location, v)",uvec2:"gl.uniform2uiv(location, v)",uvec3:"gl.uniform3uiv(location, v)",uvec4:"gl.uniform4uiv(location, v)",bool:"gl.uniform1iv(location, v)",bvec2:"gl.uniform2iv(location, v)",bvec3:"gl.uniform3iv(location, v)",bvec4:"gl.uniform4iv(location, v)",sampler2D:"gl.uniform1iv(location, v)",samplerCube:"gl.uniform1iv(location, v)",sampler2DArray:"gl.uniform1iv(location, v)"};const mr={};let gr,wr=mr;function vr(){if(wr===mr||wr?.isContextLost()){const e=E.ADAPTER.createCanvas();let t;E.PREFER_ENV>=i.WEBGL2&&(t=e.getContext("webgl2",{})),t||(t=e.getContext("webgl",{})||e.getContext("experimental-webgl",{}),t?t.getExtension("WEBGL_draw_buffers"):t=null),wr=t}return wr}const br={float:1,vec2:2,vec3:3,vec4:4,int:1,ivec2:2,ivec3:3,ivec4:4,uint:1,uvec2:2,uvec3:3,uvec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1};function xr(e){return br[e]}let _r=null;const Sr={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",UNSIGNED_INT:"uint",UNSIGNED_INT_VEC2:"uvec2",UNSIGNED_INT_VEC3:"uvec3",UNSIGNED_INT_VEC4:"uvec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",INT_SAMPLER_2D:"sampler2D",UNSIGNED_INT_SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube",INT_SAMPLER_CUBE:"samplerCube",UNSIGNED_INT_SAMPLER_CUBE:"samplerCube",SAMPLER_2D_ARRAY:"sampler2DArray",INT_SAMPLER_2D_ARRAY:"sampler2DArray",UNSIGNED_INT_SAMPLER_2D_ARRAY:"sampler2DArray"};function Tr(e,t){if(!_r){const t=Object.keys(Sr);_r={};for(let r=0;r<t.length;++r){const n=t[r];_r[e[n]]=Sr[n]}}return _r[t]}function Er(e,t,r){if("precision"!==e.substring(0,9)){let n=t;return t===v.HIGH&&r!==v.HIGH&&(n=v.MEDIUM),`precision ${n} float;\n${e}`}return r!==v.HIGH&&"precision highp"===e.substring(0,15)?e.replace("precision highp","precision mediump"):e}let Or=0;const Ar={},Ir=class e{constructor(t,r,n="pixi-shader",i={}){this.extra={},this.id=Or++,this.vertexSrc=t||e.defaultVertexSrc,this.fragmentSrc=r||e.defaultFragmentSrc,this.vertexSrc=this.vertexSrc.trim(),this.fragmentSrc=this.fragmentSrc.trim(),this.extra=i,"#version"!==this.vertexSrc.substring(0,8)&&(n=n.replace(/\s+/g,"-"),Ar[n]?(Ar[n]++,n+=`-${Ar[n]}`):Ar[n]=1,this.vertexSrc=`#define SHADER_NAME ${n}\n${this.vertexSrc}`,this.fragmentSrc=`#define SHADER_NAME ${n}\n${this.fragmentSrc}`,this.vertexSrc=Er(this.vertexSrc,e.defaultVertexPrecision,v.HIGH),this.fragmentSrc=Er(this.fragmentSrc,e.defaultFragmentPrecision,function(){if(!gr){gr=v.MEDIUM;const e=vr();if(e&&e.getShaderPrecisionFormat){const t=e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.HIGH_FLOAT);t&&(gr=t.precision?v.HIGH:v.MEDIUM)}}return gr}())),this.glPrograms={},this.syncUniforms=null}static get defaultVertexSrc(){return"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void){\n   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n   vTextureCoord = aTextureCoord;\n}\n"}static get defaultFragmentSrc(){return"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n   gl_FragColor *= texture2D(uSampler, vTextureCoord);\n}"}static from(t,r,n){const i=t+r;let o=it[i];return o||(it[i]=o=new e(t,r,n)),o}};Ir.defaultVertexPrecision=v.HIGH,Ir.defaultFragmentPrecision=G.apple.device?v.HIGH:v.MEDIUM;let Pr=Ir,kr=0;class Cr{constructor(e,t,r){this.group=!0,this.syncUniforms={},this.dirtyId=0,this.id=kr++,this.static=!!t,this.ubo=!!r,e instanceof Lt?(this.buffer=e,this.buffer.type=S.UNIFORM_BUFFER,this.autoManage=!1,this.ubo=!0):(this.uniforms=e,this.ubo&&(this.buffer=new Lt(new Float32Array(1)),this.buffer.type=S.UNIFORM_BUFFER,this.autoManage=!0))}update(){this.dirtyId++,!this.autoManage&&this.buffer&&this.buffer.update()}add(e,t,r){if(this.ubo)throw new Error("[UniformGroup] uniform groups in ubo mode cannot be modified, or have uniform groups nested in them");this.uniforms[e]=new Cr(t,r)}static from(e,t,r){return new Cr(e,t,r)}static uboFrom(e,t){return new Cr(e,t??!0,!0)}}class $r{constructor(e,t){this.uniformBindCount=0,this.program=e,this.uniformGroup=t?t instanceof Cr?t:new Cr(t):new Cr({}),this.disposeRunner=new It("disposeShader")}checkUniformExists(e,t){if(t.uniforms[e])return!0;for(const r in t.uniforms){const n=t.uniforms[r];if(!0===n.group&&this.checkUniformExists(e,n))return!0}return!1}destroy(){this.uniformGroup=null,this.disposeRunner.emit(this),this.disposeRunner.destroy()}get uniforms(){return this.uniformGroup.uniforms}static from(e,t,r){const n=Pr.from(e,t);return new $r(n,r)}}class Rr{constructor(e,t){if(this.vertexSrc=e,this.fragTemplate=t,this.programCache={},this.defaultGroupCache={},!t.includes("%count%"))throw new Error('Fragment template must contain "%count%".');if(!t.includes("%forloop%"))throw new Error('Fragment template must contain "%forloop%".')}generateShader(e){if(!this.programCache[e]){const t=new Int32Array(e);for(let r=0;r<e;r++)t[r]=r;this.defaultGroupCache[e]=Cr.from({uSamplers:t},!0);let r=this.fragTemplate;r=r.replace(/%count%/gi,`${e}`),r=r.replace(/%forloop%/gi,this.generateSampleSrc(e)),this.programCache[e]=new Pr(this.vertexSrc,r)}const t={tint:new Float32Array([1,1,1,1]),translationMatrix:new tr,default:this.defaultGroupCache[e]};return new $r(this.programCache[e],t)}generateSampleSrc(e){let t="";t+="\n",t+="\n";for(let r=0;r<e;r++)r>0&&(t+="\nelse "),r<e-1&&(t+=`if(vTextureId < ${r}.5)`),t+="\n{",t+=`\n\tcolor = texture2D(uSamplers[${r}], vTextureCoord);`,t+="\n}";return t+="\n",t+="\n",t}}class Dr{constructor(){this.elements=[],this.ids=[],this.count=0}clear(){for(let e=0;e<this.count;e++)this.elements[e]=null;this.count=0}}class Mr{constructor(e){this.renderer=e}flush(){}destroy(){this.renderer=null}start(){}stop(){this.flush()}render(e){}}const Lr=class e extends Mr{constructor(t){super(t),this.setShaderGenerator(),this.geometryClass=Gt,this.vertexSize=6,this.state=Et.for2d(),this.size=4*e.defaultBatchSize,this._vertexCount=0,this._indexCount=0,this._bufferedElements=[],this._bufferedTextures=[],this._bufferSize=0,this._shader=null,this._packedGeometries=[],this._packedGeometryPoolSize=2,this._flushId=0,this._aBuffers={},this._iBuffers={},this.maxTextures=1,this.renderer.on("prerender",this.onPrerender,this),t.runners.contextChange.add(this),this._dcIndex=0,this._aIndex=0,this._iIndex=0,this._attributeBuffer=null,this._indexBuffer=null,this._tempBoundTextures=[]}static get defaultMaxTextures(){return this._defaultMaxTextures=this._defaultMaxTextures??function(e){let t=!0;const r=E.ADAPTER.getNavigator();if(G.tablet||G.phone){if(G.apple.device){const e=r.userAgent.match(/OS (\d+)_(\d+)?/);e&&parseInt(e[1],10)<11&&(t=!1)}if(G.android.device){const e=r.userAgent.match(/Android\s([0-9.]*)/);e&&parseInt(e[1],10)<7&&(t=!1)}}return t?e:4}(32),this._defaultMaxTextures}static set defaultMaxTextures(e){this._defaultMaxTextures=e}static get canUploadSameBuffer(){return this._canUploadSameBuffer=this._canUploadSameBuffer??!G.apple.device,this._canUploadSameBuffer}static set canUploadSameBuffer(e){this._canUploadSameBuffer=e}get MAX_TEXTURES(){return Y("7.1.0","BatchRenderer#MAX_TEXTURES renamed to BatchRenderer#maxTextures"),this.maxTextures}static get defaultVertexSrc(){return"precision highp float;\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\nattribute float aTextureId;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform vec4 tint;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\n\nvoid main(void){\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vTextureId = aTextureId;\n    vColor = aColor * tint;\n}\n"}static get defaultFragmentTemplate(){return"varying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\nuniform sampler2D uSamplers[%count%];\n\nvoid main(void){\n    vec4 color;\n    %forloop%\n    gl_FragColor = color * vColor;\n}\n"}setShaderGenerator({vertex:t=e.defaultVertexSrc,fragment:r=e.defaultFragmentTemplate}={}){this.shaderGenerator=new Rr(t,r)}contextChange(){const t=this.renderer.gl;E.PREFER_ENV===i.WEBGL_LEGACY?this.maxTextures=1:(this.maxTextures=Math.min(t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),e.defaultMaxTextures),this.maxTextures=Tt(this.maxTextures,t)),this._shader=this.shaderGenerator.generateShader(this.maxTextures);for(let e=0;e<this._packedGeometryPoolSize;e++)this._packedGeometries[e]=new this.geometryClass;this.initFlushBuffers()}initFlushBuffers(){const{_drawCallPool:t,_textureArrayPool:r}=e,n=this.size/4,i=Math.floor(n/this.maxTextures)+1;for(;t.length<n;)t.push(new Dt);for(;r.length<i;)r.push(new Dr);for(let e=0;e<this.maxTextures;e++)this._tempBoundTextures[e]=null}onPrerender(){this._flushId=0}render(e){e._texture.valid&&(this._vertexCount+e.vertexData.length/2>this.size&&this.flush(),this._vertexCount+=e.vertexData.length/2,this._indexCount+=e.indices.length,this._bufferedTextures[this._bufferSize]=e._texture.baseTexture,this._bufferedElements[this._bufferSize++]=e)}buildTexturesAndDrawCalls(){const{_bufferedTextures:t,maxTextures:r}=this,n=e._textureArrayPool,i=this.renderer.batch,o=this._tempBoundTextures,a=this.renderer.textureGC.count;let s=++Rt._globalBatch,u=0,l=n[0],h=0;i.copyBoundTextures(o,r);for(let e=0;e<this._bufferSize;++e){const c=t[e];t[e]=null,c._batchEnabled!==s&&(l.count>=r&&(i.boundArray(l,o,s,r),this.buildDrawCalls(l,h,e),h=e,l=n[++u],++s),c._batchEnabled=s,c.touched=a,l.elements[l.count++]=c)}l.count>0&&(i.boundArray(l,o,s,r),this.buildDrawCalls(l,h,this._bufferSize),++u,++s);for(let e=0;e<o.length;e++)o[e]=null;Rt._globalBatch=s}buildDrawCalls(t,r,n){const{_bufferedElements:i,_attributeBuffer:o,_indexBuffer:a,vertexSize:s}=this,u=e._drawCallPool;let l=this._dcIndex,h=this._aIndex,c=this._iIndex,f=u[l];f.start=this._iIndex,f.texArray=t;for(let e=r;e<n;++e){const n=i[e],d=n._texture.baseTexture,p=Fe[d.alphaMode?1:0][n.blendMode];i[e]=null,r<e&&f.blend!==p&&(f.size=c-f.start,r=e,f=u[++l],f.texArray=t,f.start=c),this.packInterleavedGeometry(n,o,a,h,c),h+=n.vertexData.length/2*s,c+=n.indices.length,f.blend=p}r<n&&(f.size=c-f.start,++l),this._dcIndex=l,this._aIndex=h,this._iIndex=c}bindAndClearTexArray(e){const t=this.renderer.texture;for(let r=0;r<e.count;r++)t.bind(e.elements[r],e.ids[r]),e.elements[r]=null;e.count=0}updateGeometry(){const{_packedGeometries:t,_attributeBuffer:r,_indexBuffer:n}=this;e.canUploadSameBuffer?(t[this._flushId]._buffer.update(r.rawBinaryData),t[this._flushId]._indexBuffer.update(n),this.renderer.geometry.updateBuffers()):(this._packedGeometryPoolSize<=this._flushId&&(this._packedGeometryPoolSize++,t[this._flushId]=new this.geometryClass),t[this._flushId]._buffer.update(r.rawBinaryData),t[this._flushId]._indexBuffer.update(n),this.renderer.geometry.bind(t[this._flushId]),this.renderer.geometry.updateBuffers(),this._flushId++)}drawBatches(){const t=this._dcIndex,{gl:r,state:n}=this.renderer,i=e._drawCallPool;let o=null;for(let e=0;e<t;e++){const{texArray:t,type:a,size:s,start:u,blend:l}=i[e];o!==t&&(o=t,this.bindAndClearTexArray(t)),this.state.blendMode=l,n.set(this.state),r.drawElements(a,s,r.UNSIGNED_SHORT,2*u)}}flush(){0!==this._vertexCount&&(this._attributeBuffer=this.getAttributeBuffer(this._vertexCount),this._indexBuffer=this.getIndexBuffer(this._indexCount),this._aIndex=0,this._iIndex=0,this._dcIndex=0,this.buildTexturesAndDrawCalls(),this.updateGeometry(),this.drawBatches(),this._bufferSize=0,this._vertexCount=0,this._indexCount=0)}start(){this.renderer.state.set(this.state),this.renderer.texture.ensureSamplerType(this.maxTextures),this.renderer.shader.bind(this._shader),e.canUploadSameBuffer&&this.renderer.geometry.bind(this._packedGeometries[this._flushId])}stop(){this.flush()}destroy(){for(let e=0;e<this._packedGeometryPoolSize;e++)this._packedGeometries[e]&&this._packedGeometries[e].destroy();this.renderer.off("prerender",this.onPrerender,this),this._aBuffers=null,this._iBuffers=null,this._packedGeometries=null,this._attributeBuffer=null,this._indexBuffer=null,this._shader&&(this._shader.destroy(),this._shader=null),super.destroy()}getAttributeBuffer(e){const t=Xe(Math.ceil(e/8)),r=Ze(t),n=8*t;this._aBuffers.length<=r&&(this._iBuffers.length=r+1);let i=this._aBuffers[n];return i||(this._aBuffers[n]=i=new xt(n*this.vertexSize*4)),i}getIndexBuffer(e){const t=Xe(Math.ceil(e/12)),r=Ze(t),n=12*t;this._iBuffers.length<=r&&(this._iBuffers.length=r+1);let i=this._iBuffers[r];return i||(this._iBuffers[r]=i=new Uint16Array(n)),i}packInterleavedGeometry(e,t,r,n,i){const{uint32View:o,float32View:a}=t,s=n/this.vertexSize,u=e.uvs,l=e.indices,h=e.vertexData,c=e._texture.baseTexture._batchLocation,f=Math.min(e.worldAlpha,1),d=De.shared.setValue(e._tintRGB).toPremultiplied(f,e._texture.baseTexture.alphaMode>0);for(let e=0;e<h.length;e+=2)a[n++]=h[e],a[n++]=h[e+1],a[n++]=u[e],a[n++]=u[e+1],o[n++]=d,a[n++]=c;for(let e=0;e<l.length;e++)r[i++]=s+l[e]}};Lr.defaultBatchSize=4096,Lr.extension={name:"batch",type:gt.RendererPlugin},Lr._drawCallPool=[],Lr._textureArrayPool=[];let Br=Lr;bt.add(Br);const Nr=class e extends $r{constructor(t,r,n){super(Pr.from(t||e.defaultVertexSrc,r||e.defaultFragmentSrc),n),this.padding=0,this.resolution=e.defaultResolution,this.multisample=e.defaultMultisample,this.enabled=!0,this.autoFit=!0,this.state=new Et}apply(e,t,r,n,i){e.applyFilter(this,t,r,n)}get blendMode(){return this.state.blendMode}set blendMode(e){this.state.blendMode=e}get resolution(){return this._resolution}set resolution(e){this._resolution=e}static get defaultVertexSrc(){return"attribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord( void )\n{\n    return aVertexPosition * (outputFrame.zw * inputSize.zw);\n}\n\nvoid main(void)\n{\n    gl_Position = filterVertexPosition();\n    vTextureCoord = filterTextureCoord();\n}\n"}static get defaultFragmentSrc(){return"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n   gl_FragColor = texture2D(uSampler, vTextureCoord);\n}\n"}};Nr.defaultResolution=1,Nr.defaultMultisample=_.NONE;let Fr=Nr;class Ur{constructor(){this.clearBeforeRender=!0,this._backgroundColor=new De(0),this.alpha=1}init(e){this.clearBeforeRender=e.clearBeforeRender;const{backgroundColor:t,background:r,backgroundAlpha:n}=e,i=r??t;void 0!==i&&(this.color=i),this.alpha=n}get color(){return this._backgroundColor.value}set color(e){this._backgroundColor.setValue(e)}get alpha(){return this._backgroundColor.alpha}set alpha(e){this._backgroundColor.setAlpha(e)}get backgroundColor(){return this._backgroundColor}destroy(){}}Ur.defaultOptions={backgroundAlpha:1,backgroundColor:0,clearBeforeRender:!0},Ur.extension={type:[gt.RendererSystem,gt.CanvasRendererSystem],name:"background"},bt.add(Ur);class jr{constructor(e){this.renderer=e,this.emptyRenderer=new Mr(e),this.currentRenderer=this.emptyRenderer}setObjectRenderer(e){this.currentRenderer!==e&&(this.currentRenderer.stop(),this.currentRenderer=e,this.currentRenderer.start())}flush(){this.setObjectRenderer(this.emptyRenderer)}reset(){this.setObjectRenderer(this.emptyRenderer)}copyBoundTextures(e,t){const{boundTextures:r}=this.renderer.texture;for(let n=t-1;n>=0;--n)e[n]=r[n]||null,e[n]&&(e[n]._batchLocation=n)}boundArray(e,t,r,n){const{elements:i,ids:o,count:a}=e;let s=0;for(let e=0;e<a;e++){const a=i[e],u=a._batchLocation;if(u>=0&&u<n&&t[u]===a)o[e]=u;else for(;s<n;){const n=t[s];if(!n||n._batchEnabled!==r||n._batchLocation!==s){o[e]=s,a._batchLocation=s,t[s]=a;break}s++}}}destroy(){this.renderer=null}}jr.extension={type:gt.RendererSystem,name:"batch"},bt.add(jr);let zr=0;class Gr{constructor(e){this.renderer=e,this.webGLVersion=1,this.extensions={},this.supports={uint32Indices:!1},this.handleContextLost=this.handleContextLost.bind(this),this.handleContextRestored=this.handleContextRestored.bind(this)}get isLost(){return!this.gl||this.gl.isContextLost()}contextChange(e){this.gl=e,this.renderer.gl=e,this.renderer.CONTEXT_UID=zr++}init(e){if(e.context)this.initFromContext(e.context);else{const t=this.renderer.background.alpha<1,r=e.premultipliedAlpha;this.preserveDrawingBuffer=e.preserveDrawingBuffer,this.useContextAlpha=e.useContextAlpha,this.powerPreference=e.powerPreference,this.initFromOptions({alpha:t,premultipliedAlpha:r,antialias:e.antialias,stencil:!0,preserveDrawingBuffer:e.preserveDrawingBuffer,powerPreference:e.powerPreference})}}initFromContext(e){this.gl=e,this.validateContext(e),this.renderer.gl=e,this.renderer.CONTEXT_UID=zr++,this.renderer.runners.contextChange.emit(e);const t=this.renderer.view;void 0!==t.addEventListener&&(t.addEventListener("webglcontextlost",this.handleContextLost,!1),t.addEventListener("webglcontextrestored",this.handleContextRestored,!1))}initFromOptions(e){const t=this.createContext(this.renderer.view,e);this.initFromContext(t)}createContext(e,t){let r;if(E.PREFER_ENV>=i.WEBGL2&&(r=e.getContext("webgl2",t)),r)this.webGLVersion=2;else if(this.webGLVersion=1,r=e.getContext("webgl",t)||e.getContext("experimental-webgl",t),!r)throw new Error("This browser does not support WebGL. Try using the canvas renderer");return this.gl=r,this.getExtensions(),this.gl}getExtensions(){const{gl:e}=this,t={loseContext:e.getExtension("WEBGL_lose_context"),anisotropicFiltering:e.getExtension("EXT_texture_filter_anisotropic"),floatTextureLinear:e.getExtension("OES_texture_float_linear"),s3tc:e.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:e.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:e.getExtension("WEBGL_compressed_texture_etc"),etc1:e.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:e.getExtension("WEBGL_compressed_texture_pvrtc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:e.getExtension("WEBGL_compressed_texture_atc"),astc:e.getExtension("WEBGL_compressed_texture_astc"),bptc:e.getExtension("EXT_texture_compression_bptc")};1===this.webGLVersion?Object.assign(this.extensions,t,{drawBuffers:e.getExtension("WEBGL_draw_buffers"),depthTexture:e.getExtension("WEBGL_depth_texture"),vertexArrayObject:e.getExtension("OES_vertex_array_object")||e.getExtension("MOZ_OES_vertex_array_object")||e.getExtension("WEBKIT_OES_vertex_array_object"),uint32ElementIndex:e.getExtension("OES_element_index_uint"),floatTexture:e.getExtension("OES_texture_float"),floatTextureLinear:e.getExtension("OES_texture_float_linear"),textureHalfFloat:e.getExtension("OES_texture_half_float"),textureHalfFloatLinear:e.getExtension("OES_texture_half_float_linear")}):2===this.webGLVersion&&Object.assign(this.extensions,t,{colorBufferFloat:e.getExtension("EXT_color_buffer_float")})}handleContextLost(e){e.preventDefault(),setTimeout((()=>{this.gl.isContextLost()&&this.extensions.loseContext&&this.extensions.loseContext.restoreContext()}),0)}handleContextRestored(){this.renderer.runners.contextChange.emit(this.gl)}destroy(){const e=this.renderer.view;this.renderer=null,void 0!==e.removeEventListener&&(e.removeEventListener("webglcontextlost",this.handleContextLost),e.removeEventListener("webglcontextrestored",this.handleContextRestored)),this.gl.useProgram(null),this.extensions.loseContext&&this.extensions.loseContext.loseContext()}postrender(){this.renderer.objectRenderer.renderingToScreen&&this.gl.flush()}validateContext(e){const t=e.getContextAttributes(),r="WebGL2RenderingContext"in globalThis&&e instanceof globalThis.WebGL2RenderingContext;r&&(this.webGLVersion=2),t&&!t.stencil&&console.warn("Provided WebGL context does not have a stencil buffer, masks may not render correctly");const n=r||!!e.getExtension("OES_element_index_uint");this.supports.uint32Indices=n,n||console.warn("Provided WebGL context does not support 32 index buffer, complex graphics may not render correctly")}}Gr.defaultOptions={context:null,antialias:!1,premultipliedAlpha:!0,preserveDrawingBuffer:!1,powerPreference:"default"},Gr.extension={type:gt.RendererSystem,name:"context"},bt.add(Gr);class Vr{constructor(e,t){if(this.width=Math.round(e),this.height=Math.round(t),!this.width||!this.height)throw new Error("Framebuffer width or height is zero");this.stencil=!1,this.depth=!1,this.dirtyId=0,this.dirtyFormat=0,this.dirtySize=0,this.depthTexture=null,this.colorTextures=[],this.glFramebuffers={},this.disposeRunner=new It("disposeFramebuffer"),this.multisample=_.NONE}get colorTexture(){return this.colorTextures[0]}addColorTexture(e=0,t){return this.colorTextures[e]=t||new Rt(null,{scaleMode:d.NEAREST,resolution:1,mipmap:y.OFF,width:this.width,height:this.height}),this.dirtyId++,this.dirtyFormat++,this}addDepthTexture(e){return this.depthTexture=e||new Rt(null,{scaleMode:d.NEAREST,resolution:1,width:this.width,height:this.height,mipmap:y.OFF,format:l.DEPTH_COMPONENT,type:c.UNSIGNED_SHORT}),this.dirtyId++,this.dirtyFormat++,this}enableDepth(){return this.depth=!0,this.dirtyId++,this.dirtyFormat++,this}enableStencil(){return this.stencil=!0,this.dirtyId++,this.dirtyFormat++,this}resize(e,t){if(e=Math.round(e),t=Math.round(t),!e||!t)throw new Error("Framebuffer width and height must not be zero");if(e!==this.width||t!==this.height){this.width=e,this.height=t,this.dirtyId++,this.dirtySize++;for(let r=0;r<this.colorTextures.length;r++){const n=this.colorTextures[r],i=n.resolution;n.setSize(e/i,t/i)}if(this.depthTexture){const r=this.depthTexture.resolution;this.depthTexture.setSize(e/r,t/r)}}}dispose(){this.disposeRunner.emit(this,!1)}destroyDepthTexture(){this.depthTexture&&(this.depthTexture.destroy(),this.depthTexture=null,++this.dirtyId,++this.dirtyFormat)}}class Wr extends Rt{constructor(e={}){if("number"==typeof e){e={width:arguments[0],height:arguments[1],scaleMode:arguments[2],resolution:arguments[3]}}e.width=e.width??100,e.height=e.height??100,e.multisample??(e.multisample=_.NONE),super(null,e),this.mipmap=y.OFF,this.valid=!0,this._clear=new De([0,0,0,0]),this.framebuffer=new Vr(this.realWidth,this.realHeight).addColorTexture(0,this),this.framebuffer.multisample=e.multisample,this.maskStack=[],this.filterStack=[{}]}set clearColor(e){this._clear.setValue(e)}get clearColor(){return this._clear.value}get clear(){return this._clear}get multisample(){return this.framebuffer.multisample}set multisample(e){this.framebuffer.multisample=e}resize(e,t){this.framebuffer.resize(e*this.resolution,t*this.resolution),this.setRealSize(this.framebuffer.width,this.framebuffer.height)}dispose(){this.framebuffer.dispose(),super.dispose()}destroy(){super.destroy(),this.framebuffer.destroyDepthTexture(),this.framebuffer=null}}class Hr extends Pt{constructor(e){const t=e;super(t.naturalWidth||t.videoWidth||t.displayWidth||t.width,t.naturalHeight||t.videoHeight||t.displayHeight||t.height),this.source=e,this.noSubImage=!1}static crossOrigin(e,t,r){void 0!==r||t.startsWith("data:")?!1!==r&&(e.crossOrigin="string"==typeof r?r:"anonymous"):e.crossOrigin=yt(t)}upload(e,t,r,n){const i=e.gl,o=t.realWidth,a=t.realHeight;if(n=n||this.source,typeof HTMLImageElement<"u"&&n instanceof HTMLImageElement){if(!n.complete||0===n.naturalWidth)return!1}else if(typeof HTMLVideoElement<"u"&&n instanceof HTMLVideoElement&&n.readyState<=1)return!1;return i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t.alphaMode===m.UNPACK),this.noSubImage||t.target!==i.TEXTURE_2D||r.width!==o||r.height!==a?(r.width=o,r.height=a,i.texImage2D(t.target,0,r.internalFormat,t.format,r.type,n)):i.texSubImage2D(i.TEXTURE_2D,0,0,0,t.format,r.type,n),!0}update(){if(this.destroyed)return;const e=this.source,t=e.naturalWidth||e.videoWidth||e.width,r=e.naturalHeight||e.videoHeight||e.height;this.resize(t,r),super.update()}dispose(){this.source=null}}class qr extends Hr{constructor(e,t){if(t=t||{},"string"==typeof e){const r=new Image;Hr.crossOrigin(r,e,t.crossorigin),r.src=e,e=r}super(e),!e.complete&&this._width&&this._height&&(this._width=0,this._height=0),this.url=e.src,this._process=null,this.preserveBitmap=!1,this.createBitmap=(t.createBitmap??E.CREATE_IMAGE_BITMAP)&&!!globalThis.createImageBitmap,this.alphaMode="number"==typeof t.alphaMode?t.alphaMode:null,this.bitmap=null,this._load=null,!1!==t.autoLoad&&this.load()}load(e){return this._load||(void 0!==e&&(this.createBitmap=e),this._load=new Promise(((e,t)=>{const r=this.source;this.url=r.src;const n=()=>{this.destroyed||(r.onload=null,r.onerror=null,this.update(),this._load=null,this.createBitmap?e(this.process()):e(this))};r.complete&&r.src?n():(r.onload=n,r.onerror=e=>{t(e),this.onError.emit(e)})}))),this._load}process(){const e=this.source;if(null!==this._process)return this._process;if(null!==this.bitmap||!globalThis.createImageBitmap)return Promise.resolve(this);const t=globalThis.createImageBitmap,r=!e.crossOrigin||"anonymous"===e.crossOrigin;return this._process=fetch(e.src,{mode:r?"cors":"no-cors"}).then((e=>e.blob())).then((r=>t(r,0,0,e.width,e.height,{premultiplyAlpha:null===this.alphaMode||this.alphaMode===m.UNPACK?"premultiply":"none"}))).then((e=>this.destroyed?Promise.reject():(this.bitmap=e,this.update(),this._process=null,Promise.resolve(this)))),this._process}upload(e,t,r){if("number"==typeof this.alphaMode&&(t.alphaMode=this.alphaMode),!this.createBitmap)return super.upload(e,t,r);if(!this.bitmap&&(this.process(),!this.bitmap))return!1;if(super.upload(e,t,r,this.bitmap),!this.preserveBitmap){let e=!0;const n=t._glTextures;for(const i in n){const o=n[i];if(o!==r&&o.dirtyId!==t.dirtyId){e=!1;break}}e&&(this.bitmap.close&&this.bitmap.close(),this.bitmap=null)}return!0}dispose(){this.source.onload=null,this.source.onerror=null,super.dispose(),this.bitmap&&(this.bitmap.close(),this.bitmap=null),this._process=null,this._load=null}static test(e){return typeof HTMLImageElement<"u"&&("string"==typeof e||e instanceof HTMLImageElement)}}class Yr{constructor(){this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1,this.uvsFloat32=new Float32Array(8)}set(e,t,r){const n=t.width,i=t.height;if(r){const t=e.width/2/n,o=e.height/2/i,a=e.x/n+t,s=e.y/i+o;r=lr.add(r,lr.NW),this.x0=a+t*lr.uX(r),this.y0=s+o*lr.uY(r),r=lr.add(r,2),this.x1=a+t*lr.uX(r),this.y1=s+o*lr.uY(r),r=lr.add(r,2),this.x2=a+t*lr.uX(r),this.y2=s+o*lr.uY(r),r=lr.add(r,2),this.x3=a+t*lr.uX(r),this.y3=s+o*lr.uY(r)}else this.x0=e.x/n,this.y0=e.y/i,this.x1=(e.x+e.width)/n,this.y1=e.y/i,this.x2=(e.x+e.width)/n,this.y2=(e.y+e.height)/i,this.x3=e.x/n,this.y3=(e.y+e.height)/i;this.uvsFloat32[0]=this.x0,this.uvsFloat32[1]=this.y0,this.uvsFloat32[2]=this.x1,this.uvsFloat32[3]=this.y1,this.uvsFloat32[4]=this.x2,this.uvsFloat32[5]=this.y2,this.uvsFloat32[6]=this.x3,this.uvsFloat32[7]=this.y3}}Yr.prototype.toString=function(){return`[@pixi/core:TextureUvs x0=${this.x0} y0=${this.y0} x1=${this.x1} y1=${this.y1} x2=${this.x2} y2=${this.y2} x3=${this.x3} y3=${this.y3}]`};const Xr=new Yr;function Kr(e){e.destroy=function(){},e.on=function(){},e.once=function(){},e.emit=function(){}}class Zr extends V{constructor(e,t,r,n,i,o,a){if(super(),this.noFrame=!1,t||(this.noFrame=!0,t=new Kt(0,0,1,1)),e instanceof Zr&&(e=e.baseTexture),this.baseTexture=e,this._frame=t,this.trim=n,this.valid=!1,this.destroyed=!1,this._uvs=Xr,this.uvMatrix=null,this.orig=r||t,this._rotate=Number(i||0),!0===i)this._rotate=2;else if(this._rotate%2!=0)throw new Error("attempt to use diamond-shaped UVs. If you are sure, set rotation manually");this.defaultAnchor=o?new Yt(o.x,o.y):new Yt(0,0),this.defaultBorders=a,this._updateID=0,this.textureCacheIds=[],e.valid?this.noFrame?e.valid&&this.onBaseTextureUpdated(e):this.frame=t:e.once("loaded",this.onBaseTextureUpdated,this),this.noFrame&&e.on("update",this.onBaseTextureUpdated,this)}update(){this.baseTexture.resource&&this.baseTexture.resource.update()}onBaseTextureUpdated(e){if(this.noFrame){if(!this.baseTexture.valid)return;this._frame.width=e.width,this._frame.height=e.height,this.valid=!0,this.updateUvs()}else this.frame=this._frame;this.emit("update",this)}destroy(e){if(this.baseTexture){if(e){const{resource:e}=this.baseTexture;e?.url&&ot[e.url]&&Zr.removeFromCache(e.url),this.baseTexture.destroy()}this.baseTexture.off("loaded",this.onBaseTextureUpdated,this),this.baseTexture.off("update",this.onBaseTextureUpdated,this),this.baseTexture=null}this._frame=null,this._uvs=null,this.trim=null,this.orig=null,this.valid=!1,Zr.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0,this.emit("destroyed",this),this.removeAllListeners()}clone(){const e=this._frame.clone(),t=this._frame===this.orig?e:this.orig.clone(),r=new Zr(this.baseTexture,!this.noFrame&&e,t,this.trim?.clone(),this.rotate,this.defaultAnchor,this.defaultBorders);return this.noFrame&&(r._frame=e),r}updateUvs(){this._uvs===Xr&&(this._uvs=new Yr),this._uvs.set(this._frame,this.baseTexture,this.rotate),this._updateID++}static from(e,t={},r=E.STRICT_TEXTURE_CACHE){const n="string"==typeof e;let i=null;if(n)i=e;else if(e instanceof Rt){if(!e.cacheId){const r=t?.pixiIdPrefix||"pixiid";e.cacheId=`${r}-${tt()}`,Rt.addToCache(e,e.cacheId)}i=e.cacheId}else{if(!e._pixiId){const r=t?.pixiIdPrefix||"pixiid";e._pixiId=`${r}_${tt()}`}i=e._pixiId}let o=ot[i];if(n&&r&&!o)throw new Error(`The cacheId "${i}" does not exist in TextureCache.`);return o||e instanceof Rt?!o&&e instanceof Rt&&(o=new Zr(e),Zr.addToCache(o,i)):(t.resolution||(t.resolution=mt(e)),o=new Zr(new Rt(e,t)),o.baseTexture.cacheId=i,Rt.addToCache(o.baseTexture,i),Zr.addToCache(o,i)),o}static fromURL(e,t){const r=Object.assign({autoLoad:!1},t?.resourceOptions),n=Zr.from(e,Object.assign({resourceOptions:r},t),!1),i=n.baseTexture.resource;return n.baseTexture.valid?Promise.resolve(n):i.load().then((()=>Promise.resolve(n)))}static fromBuffer(e,t,r,n){return new Zr(Rt.fromBuffer(e,t,r,n))}static fromLoader(e,t,r,n){const i=new Rt(e,Object.assign({scaleMode:Rt.defaultOptions.scaleMode,resolution:mt(t)},n)),{resource:o}=i;o instanceof qr&&(o.url=t);const a=new Zr(i);return r||(r=t),Rt.addToCache(a.baseTexture,r),Zr.addToCache(a,r),r!==t&&(Rt.addToCache(a.baseTexture,t),Zr.addToCache(a,t)),a.baseTexture.valid?Promise.resolve(a):new Promise((e=>{a.baseTexture.once("loaded",(()=>e(a)))}))}static addToCache(e,t){t&&(e.textureCacheIds.includes(t)||e.textureCacheIds.push(t),ot[t]&&ot[t]!==e&&console.warn(`Texture added to the cache with an id [${t}] that already had an entry`),ot[t]=e)}static removeFromCache(e){if("string"==typeof e){const t=ot[e];if(t){const r=t.textureCacheIds.indexOf(e);return r>-1&&t.textureCacheIds.splice(r,1),delete ot[e],t}}else if(e?.textureCacheIds){for(let t=0;t<e.textureCacheIds.length;++t)ot[e.textureCacheIds[t]]===e&&delete ot[e.textureCacheIds[t]];return e.textureCacheIds.length=0,e}return null}get resolution(){return this.baseTexture.resolution}get frame(){return this._frame}set frame(e){this._frame=e,this.noFrame=!1;const{x:t,y:r,width:n,height:i}=e,o=t+n>this.baseTexture.width,a=r+i>this.baseTexture.height;if(o||a){const e=o&&a?"and":"or",s=`X: ${t} + ${n} = ${t+n} > ${this.baseTexture.width}`,u=`Y: ${r} + ${i} = ${r+i} > ${this.baseTexture.height}`;throw new Error(`Texture Error: frame does not fit inside the base Texture dimensions: ${s} ${e} ${u}`)}this.valid=n&&i&&this.baseTexture.valid,!this.trim&&!this.rotate&&(this.orig=e),this.valid&&this.updateUvs()}get rotate(){return this._rotate}set rotate(e){this._rotate=e,this.valid&&this.updateUvs()}get width(){return this.orig.width}get height(){return this.orig.height}castToBaseTexture(){return this.baseTexture}static get EMPTY(){return Zr._EMPTY||(Zr._EMPTY=new Zr(new Rt),Kr(Zr._EMPTY),Kr(Zr._EMPTY.baseTexture)),Zr._EMPTY}static get WHITE(){if(!Zr._WHITE){const e=E.ADAPTER.createCanvas(16,16),t=e.getContext("2d");e.width=16,e.height=16,t.fillStyle="white",t.fillRect(0,0,16,16),Zr._WHITE=new Zr(Rt.from(e)),Kr(Zr._WHITE),Kr(Zr._WHITE.baseTexture)}return Zr._WHITE}}class Jr extends Zr{constructor(e,t){super(e,t),this.valid=!0,this.filterFrame=null,this.filterPoolKey=null,this.updateUvs()}get framebuffer(){return this.baseTexture.framebuffer}get multisample(){return this.framebuffer.multisample}set multisample(e){this.framebuffer.multisample=e}resize(e,t,r=!0){const n=this.baseTexture.resolution,i=Math.round(e*n)/n,o=Math.round(t*n)/n;this.valid=i>0&&o>0,this._frame.width=this.orig.width=i,this._frame.height=this.orig.height=o,r&&this.baseTexture.resize(i,o),this.updateUvs()}setResolution(e){const{baseTexture:t}=this;t.resolution!==e&&(t.setResolution(e),this.resize(t.width,t.height,!1))}static create(e){return new Jr(new Wr(e))}}class Qr{constructor(e){this.texturePool={},this.textureOptions=e||{},this.enableFullScreen=!1,this._pixelsWidth=0,this._pixelsHeight=0}createTexture(e,t,r=_.NONE){const n=new Wr(Object.assign({width:e,height:t,resolution:1,multisample:r},this.textureOptions));return new Jr(n)}getOptimalTexture(e,t,r=1,n=_.NONE){let i;e=Math.max(Math.ceil(e*r-1e-6),1),t=Math.max(Math.ceil(t*r-1e-6),1),this.enableFullScreen&&e===this._pixelsWidth&&t===this._pixelsHeight?i=n>1?-n:-1:(i=((65535&(e=Xe(e)))<<16|65535&(t=Xe(t)))>>>0,n>1&&(i+=4294967296*n)),this.texturePool[i]||(this.texturePool[i]=[]);let o=this.texturePool[i].pop();return o||(o=this.createTexture(e,t,n)),o.filterPoolKey=i,o.setResolution(r),o}getFilterTexture(e,t,r){const n=this.getOptimalTexture(e.width,e.height,t||e.resolution,r||_.NONE);return n.filterFrame=e.filterFrame,n}returnTexture(e){const t=e.filterPoolKey;e.filterFrame=null,this.texturePool[t].push(e)}returnFilterTexture(e){this.returnTexture(e)}clear(e){if(e=!1!==e)for(const e in this.texturePool){const t=this.texturePool[e];if(t)for(let e=0;e<t.length;e++)t[e].destroy(!0)}this.texturePool={}}setScreenSize(e){if(e.width!==this._pixelsWidth||e.height!==this._pixelsHeight){this.enableFullScreen=e.width>0&&e.height>0;for(const e in this.texturePool){if(!(Number(e)<0))continue;const t=this.texturePool[e];if(t)for(let e=0;e<t.length;e++)t[e].destroy(!0);this.texturePool[e]=[]}this._pixelsWidth=e.width,this._pixelsHeight=e.height}}}Qr.SCREEN_KEY=-1;class en extends zt{constructor(){super(),this.addAttribute("aVertexPosition",new Float32Array([0,0,1,0,1,1,0,1])).addIndex([0,1,3,2])}}class tn extends zt{constructor(){super(),this.vertices=new Float32Array([-1,-1,1,-1,1,1,-1,1]),this.uvs=new Float32Array([0,0,1,0,1,1,0,1]),this.vertexBuffer=new Lt(this.vertices),this.uvBuffer=new Lt(this.uvs),this.addAttribute("aVertexPosition",this.vertexBuffer).addAttribute("aTextureCoord",this.uvBuffer).addIndex([0,1,2,0,2,3])}map(e,t){let r=0,n=0;return this.uvs[0]=r,this.uvs[1]=n,this.uvs[2]=r+t.width/e.width,this.uvs[3]=n,this.uvs[4]=r+t.width/e.width,this.uvs[5]=n+t.height/e.height,this.uvs[6]=r,this.uvs[7]=n+t.height/e.height,r=t.x,n=t.y,this.vertices[0]=r,this.vertices[1]=n,this.vertices[2]=r+t.width,this.vertices[3]=n,this.vertices[4]=r+t.width,this.vertices[5]=n+t.height,this.vertices[6]=r,this.vertices[7]=n+t.height,this.invalidate(),this}invalidate(){return this.vertexBuffer._updateID++,this.uvBuffer._updateID++,this}}class rn{constructor(){this.renderTexture=null,this.target=null,this.legacy=!1,this.resolution=1,this.multisample=_.NONE,this.sourceFrame=new Kt,this.destinationFrame=new Kt,this.bindingSourceFrame=new Kt,this.bindingDestinationFrame=new Kt,this.filters=[],this.transform=null}clear(){this.target=null,this.filters=null,this.renderTexture=null}}const nn=[new Yt,new Yt,new Yt,new Yt],on=new tr;class an{constructor(e){this.renderer=e,this.defaultFilterStack=[{}],this.texturePool=new Qr,this.statePool=[],this.quad=new en,this.quadUv=new tn,this.tempRect=new Kt,this.activeState={},this.globalUniforms=new Cr({outputFrame:new Kt,inputSize:new Float32Array(4),inputPixel:new Float32Array(4),inputClamp:new Float32Array(4),resolution:1,filterArea:new Float32Array(4),filterClamp:new Float32Array(4)},!0),this.forceClear=!1,this.useMaxPadding=!1}init(){this.texturePool.setScreenSize(this.renderer.view)}push(e,t){const r=this.renderer,n=this.defaultFilterStack,i=this.statePool.pop()||new rn,o=r.renderTexture;let a,s;if(o.current){const e=o.current;a=e.resolution,s=e.multisample}else a=r.resolution,s=r.multisample;let u=t[0].resolution||a,l=t[0].multisample??s,h=t[0].padding,c=t[0].autoFit,f=t[0].legacy??!0;for(let e=1;e<t.length;e++){const r=t[e];u=Math.min(u,r.resolution||a),l=Math.min(l,r.multisample??s),h=this.useMaxPadding?Math.max(h,r.padding):h+r.padding,c=c&&r.autoFit,f=f||(r.legacy??!0)}1===n.length&&(this.defaultFilterStack[0].renderTexture=o.current),n.push(i),i.resolution=u,i.multisample=l,i.legacy=f,i.target=e,i.sourceFrame.copyFrom(e.filterArea||e.getBounds(!0)),i.sourceFrame.pad(h);const d=this.tempRect.copyFrom(o.sourceFrame);r.projection.transform&&this.transformAABB(on.copyFrom(r.projection.transform).invert(),d),c?(i.sourceFrame.fit(d),(i.sourceFrame.width<=0||i.sourceFrame.height<=0)&&(i.sourceFrame.width=0,i.sourceFrame.height=0)):i.sourceFrame.intersects(d)||(i.sourceFrame.width=0,i.sourceFrame.height=0),this.roundFrame(i.sourceFrame,o.current?o.current.resolution:r.resolution,o.sourceFrame,o.destinationFrame,r.projection.transform),i.renderTexture=this.getOptimalFilterTexture(i.sourceFrame.width,i.sourceFrame.height,u,l),i.filters=t,i.destinationFrame.width=i.renderTexture.width,i.destinationFrame.height=i.renderTexture.height;const p=this.tempRect;p.x=0,p.y=0,p.width=i.sourceFrame.width,p.height=i.sourceFrame.height,i.renderTexture.filterFrame=i.sourceFrame,i.bindingSourceFrame.copyFrom(o.sourceFrame),i.bindingDestinationFrame.copyFrom(o.destinationFrame),i.transform=r.projection.transform,r.projection.transform=null,o.bind(i.renderTexture,i.sourceFrame,p),r.framebuffer.clear(0,0,0,0)}pop(){const e=this.defaultFilterStack,t=e.pop(),r=t.filters;this.activeState=t;const n=this.globalUniforms.uniforms;n.outputFrame=t.sourceFrame,n.resolution=t.resolution;const i=n.inputSize,o=n.inputPixel,a=n.inputClamp;if(i[0]=t.destinationFrame.width,i[1]=t.destinationFrame.height,i[2]=1/i[0],i[3]=1/i[1],o[0]=Math.round(i[0]*t.resolution),o[1]=Math.round(i[1]*t.resolution),o[2]=1/o[0],o[3]=1/o[1],a[0]=.5*o[2],a[1]=.5*o[3],a[2]=t.sourceFrame.width*i[2]-.5*o[2],a[3]=t.sourceFrame.height*i[3]-.5*o[3],t.legacy){const e=n.filterArea;e[0]=t.destinationFrame.width,e[1]=t.destinationFrame.height,e[2]=t.sourceFrame.x,e[3]=t.sourceFrame.y,n.filterClamp=n.inputClamp}this.globalUniforms.update();const s=e[e.length-1];if(this.renderer.framebuffer.blit(),1===r.length)r[0].apply(this,t.renderTexture,s.renderTexture,g.BLEND,t),this.returnFilterTexture(t.renderTexture);else{let e=t.renderTexture,n=this.getOptimalFilterTexture(e.width,e.height,t.resolution);n.filterFrame=e.filterFrame;let i=0;for(i=0;i<r.length-1;++i){1===i&&t.multisample>1&&(n=this.getOptimalFilterTexture(e.width,e.height,t.resolution),n.filterFrame=e.filterFrame),r[i].apply(this,e,n,g.CLEAR,t);const o=e;e=n,n=o}r[i].apply(this,e,s.renderTexture,g.BLEND,t),i>1&&t.multisample>1&&this.returnFilterTexture(t.renderTexture),this.returnFilterTexture(e),this.returnFilterTexture(n)}t.clear(),this.statePool.push(t)}bindAndClear(e,t=g.CLEAR){const{renderTexture:r,state:n}=this.renderer;if(e===this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?this.renderer.projection.transform=this.activeState.transform:this.renderer.projection.transform=null,e?.filterFrame){const t=this.tempRect;t.x=0,t.y=0,t.width=e.filterFrame.width,t.height=e.filterFrame.height,r.bind(e,e.filterFrame,t)}else e!==this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?r.bind(e):this.renderer.renderTexture.bind(e,this.activeState.bindingSourceFrame,this.activeState.bindingDestinationFrame);const i=1&n.stateId||this.forceClear;(t===g.CLEAR||t===g.BLIT&&i)&&this.renderer.framebuffer.clear(0,0,0,0)}applyFilter(e,t,r,n){const i=this.renderer;i.state.set(e.state),this.bindAndClear(r,n),e.uniforms.uSampler=t,e.uniforms.filterGlobals=this.globalUniforms,i.shader.bind(e),e.legacy=!!e.program.attributeData.aTextureCoord,e.legacy?(this.quadUv.map(t._frame,t.filterFrame),i.geometry.bind(this.quadUv),i.geometry.draw(u.TRIANGLES)):(i.geometry.bind(this.quad),i.geometry.draw(u.TRIANGLE_STRIP))}calculateSpriteMatrix(e,t){const{sourceFrame:r,destinationFrame:n}=this.activeState,{orig:i}=t._texture,o=e.set(n.width,0,0,n.height,r.x,r.y),a=t.worldTransform.copyTo(tr.TEMP_MATRIX);return a.invert(),o.prepend(a),o.scale(1/i.width,1/i.height),o.translate(t.anchor.x,t.anchor.y),o}destroy(){this.renderer=null,this.texturePool.clear(!1)}getOptimalFilterTexture(e,t,r=1,n=_.NONE){return this.texturePool.getOptimalTexture(e,t,r,n)}getFilterTexture(e,t,r){if("number"==typeof e){const r=e;e=t,t=r}e=e||this.activeState.renderTexture;const n=this.texturePool.getOptimalTexture(e.width,e.height,t||e.resolution,r||_.NONE);return n.filterFrame=e.filterFrame,n}returnFilterTexture(e){this.texturePool.returnTexture(e)}emptyPool(){this.texturePool.clear(!0)}resize(){this.texturePool.setScreenSize(this.renderer.view)}transformAABB(e,t){const r=nn[0],n=nn[1],i=nn[2],o=nn[3];r.set(t.left,t.top),n.set(t.left,t.bottom),i.set(t.right,t.top),o.set(t.right,t.bottom),e.apply(r,r),e.apply(n,n),e.apply(i,i),e.apply(o,o);const a=Math.min(r.x,n.x,i.x,o.x),s=Math.min(r.y,n.y,i.y,o.y),u=Math.max(r.x,n.x,i.x,o.x),l=Math.max(r.y,n.y,i.y,o.y);t.x=a,t.y=s,t.width=u-a,t.height=l-s}roundFrame(e,t,r,n,i){if(!(e.width<=0||e.height<=0||r.width<=0||r.height<=0)){if(i){const{a:e,b:t,c:r,d:n}=i;if((Math.abs(t)>1e-4||Math.abs(r)>1e-4)&&(Math.abs(e)>1e-4||Math.abs(n)>1e-4))return}(i=i?on.copyFrom(i):on.identity()).translate(-r.x,-r.y).scale(n.width/r.width,n.height/r.height).translate(n.x,n.y),this.transformAABB(i,e),e.ceil(t),this.transformAABB(i.invert(),e)}}}an.extension={type:gt.RendererSystem,name:"filter"},bt.add(an);class sn{constructor(e){this.framebuffer=e,this.stencil=null,this.dirtyId=-1,this.dirtyFormat=-1,this.dirtySize=-1,this.multisample=_.NONE,this.msaaBuffer=null,this.blitFramebuffer=null,this.mipLevel=0}}const un=new Kt;class ln{constructor(e){this.renderer=e,this.managedFramebuffers=[],this.unknownFramebuffer=new Vr(10,10),this.msaaSamples=null}contextChange(){this.disposeAll(!0);const e=this.gl=this.renderer.gl;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.current=this.unknownFramebuffer,this.viewport=new Kt,this.hasMRT=!0,this.writeDepthTexture=!0,1===this.renderer.context.webGLVersion){let t=this.renderer.context.extensions.drawBuffers,r=this.renderer.context.extensions.depthTexture;E.PREFER_ENV===i.WEBGL_LEGACY&&(t=null,r=null),t?e.drawBuffers=e=>t.drawBuffersWEBGL(e):(this.hasMRT=!1,e.drawBuffers=()=>{}),r||(this.writeDepthTexture=!1)}else this.msaaSamples=e.getInternalformatParameter(e.RENDERBUFFER,e.RGBA8,e.SAMPLES)}bind(e,t,r=0){const{gl:n}=this;if(e){const i=e.glFramebuffers[this.CONTEXT_UID]||this.initFramebuffer(e);this.current!==e&&(this.current=e,n.bindFramebuffer(n.FRAMEBUFFER,i.framebuffer)),i.mipLevel!==r&&(e.dirtyId++,e.dirtyFormat++,i.mipLevel=r),i.dirtyId!==e.dirtyId&&(i.dirtyId=e.dirtyId,i.dirtyFormat!==e.dirtyFormat?(i.dirtyFormat=e.dirtyFormat,i.dirtySize=e.dirtySize,this.updateFramebuffer(e,r)):i.dirtySize!==e.dirtySize&&(i.dirtySize=e.dirtySize,this.resizeFramebuffer(e)));for(let t=0;t<e.colorTextures.length;t++){const r=e.colorTextures[t];this.renderer.texture.unbind(r.parentTextureArray||r)}if(e.depthTexture&&this.renderer.texture.unbind(e.depthTexture),t){const e=t.width>>r,n=t.height>>r,i=e/t.width;this.setViewport(t.x*i,t.y*i,e,n)}else{const t=e.width>>r,n=e.height>>r;this.setViewport(0,0,t,n)}}else this.current&&(this.current=null,n.bindFramebuffer(n.FRAMEBUFFER,null)),t?this.setViewport(t.x,t.y,t.width,t.height):this.setViewport(0,0,this.renderer.width,this.renderer.height)}setViewport(e,t,r,n){const i=this.viewport;e=Math.round(e),t=Math.round(t),r=Math.round(r),n=Math.round(n),(i.width!==r||i.height!==n||i.x!==e||i.y!==t)&&(i.x=e,i.y=t,i.width=r,i.height=n,this.gl.viewport(e,t,r,n))}get size(){return this.current?{x:0,y:0,width:this.current.width,height:this.current.height}:{x:0,y:0,width:this.renderer.width,height:this.renderer.height}}clear(e,t,r,n,i=a.COLOR|a.DEPTH){const{gl:o}=this;o.clearColor(e,t,r,n),o.clear(i)}initFramebuffer(e){const{gl:t}=this,r=new sn(t.createFramebuffer());return r.multisample=this.detectSamples(e.multisample),e.glFramebuffers[this.CONTEXT_UID]=r,this.managedFramebuffers.push(e),e.disposeRunner.add(this),r}resizeFramebuffer(e){const{gl:t}=this,r=e.glFramebuffers[this.CONTEXT_UID];if(r.stencil){let n;t.bindRenderbuffer(t.RENDERBUFFER,r.stencil),n=1===this.renderer.context.webGLVersion?t.DEPTH_STENCIL:e.depth&&e.stencil?t.DEPTH24_STENCIL8:e.depth?t.DEPTH_COMPONENT24:t.STENCIL_INDEX8,r.msaaBuffer?t.renderbufferStorageMultisample(t.RENDERBUFFER,r.multisample,n,e.width,e.height):t.renderbufferStorage(t.RENDERBUFFER,n,e.width,e.height)}const n=e.colorTextures;let i=n.length;t.drawBuffers||(i=Math.min(i,1));for(let o=0;o<i;o++){const i=n[o],a=i.parentTextureArray||i;this.renderer.texture.bind(a,0),0===o&&r.msaaBuffer&&(t.bindRenderbuffer(t.RENDERBUFFER,r.msaaBuffer),t.renderbufferStorageMultisample(t.RENDERBUFFER,r.multisample,a._glTextures[this.CONTEXT_UID].internalFormat,e.width,e.height))}e.depthTexture&&this.writeDepthTexture&&this.renderer.texture.bind(e.depthTexture,0)}updateFramebuffer(e,t){const{gl:r}=this,n=e.glFramebuffers[this.CONTEXT_UID],i=e.colorTextures;let o=i.length;r.drawBuffers||(o=Math.min(o,1)),n.multisample>1&&this.canMultisampleFramebuffer(e)?n.msaaBuffer=n.msaaBuffer||r.createRenderbuffer():n.msaaBuffer&&(r.deleteRenderbuffer(n.msaaBuffer),n.msaaBuffer=null,n.blitFramebuffer&&(n.blitFramebuffer.dispose(),n.blitFramebuffer=null));const a=[];for(let s=0;s<o;s++){const o=i[s],u=o.parentTextureArray||o;this.renderer.texture.bind(u,0),0===s&&n.msaaBuffer?(r.bindRenderbuffer(r.RENDERBUFFER,n.msaaBuffer),r.renderbufferStorageMultisample(r.RENDERBUFFER,n.multisample,u._glTextures[this.CONTEXT_UID].internalFormat,e.width,e.height),r.framebufferRenderbuffer(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.RENDERBUFFER,n.msaaBuffer)):(r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0+s,o.target,u._glTextures[this.CONTEXT_UID].texture,t),a.push(r.COLOR_ATTACHMENT0+s))}if(a.length>1&&r.drawBuffers(a),e.depthTexture&&this.writeDepthTexture){const n=e.depthTexture;this.renderer.texture.bind(n,0),r.framebufferTexture2D(r.FRAMEBUFFER,r.DEPTH_ATTACHMENT,r.TEXTURE_2D,n._glTextures[this.CONTEXT_UID].texture,t)}if(!e.stencil&&!e.depth||e.depthTexture&&this.writeDepthTexture)n.stencil&&(r.deleteRenderbuffer(n.stencil),n.stencil=null);else{let t,i;n.stencil=n.stencil||r.createRenderbuffer(),1===this.renderer.context.webGLVersion?(t=r.DEPTH_STENCIL_ATTACHMENT,i=r.DEPTH_STENCIL):e.depth&&e.stencil?(t=r.DEPTH_STENCIL_ATTACHMENT,i=r.DEPTH24_STENCIL8):e.depth?(t=r.DEPTH_ATTACHMENT,i=r.DEPTH_COMPONENT24):(t=r.STENCIL_ATTACHMENT,i=r.STENCIL_INDEX8),r.bindRenderbuffer(r.RENDERBUFFER,n.stencil),n.msaaBuffer?r.renderbufferStorageMultisample(r.RENDERBUFFER,n.multisample,i,e.width,e.height):r.renderbufferStorage(r.RENDERBUFFER,i,e.width,e.height),r.framebufferRenderbuffer(r.FRAMEBUFFER,t,r.RENDERBUFFER,n.stencil)}}canMultisampleFramebuffer(e){return 1!==this.renderer.context.webGLVersion&&e.colorTextures.length<=1&&!e.depthTexture}detectSamples(e){const{msaaSamples:t}=this;let r=_.NONE;if(e<=1||null===t)return r;for(let n=0;n<t.length;n++)if(t[n]<=e){r=t[n];break}return 1===r&&(r=_.NONE),r}blit(e,t,r){const{current:n,renderer:i,gl:o,CONTEXT_UID:a}=this;if(2!==i.context.webGLVersion||!n)return;const s=n.glFramebuffers[a];if(!s)return;if(!e){if(!s.msaaBuffer)return;const t=n.colorTextures[0];if(!t)return;s.blitFramebuffer||(s.blitFramebuffer=new Vr(n.width,n.height),s.blitFramebuffer.addColorTexture(0,t)),(e=s.blitFramebuffer).colorTextures[0]!==t&&(e.colorTextures[0]=t,e.dirtyId++,e.dirtyFormat++),(e.width!==n.width||e.height!==n.height)&&(e.width=n.width,e.height=n.height,e.dirtyId++,e.dirtySize++)}t||((t=un).width=n.width,t.height=n.height),r||(r=t);const u=t.width===r.width&&t.height===r.height;this.bind(e),o.bindFramebuffer(o.READ_FRAMEBUFFER,s.framebuffer),o.blitFramebuffer(t.left,t.top,t.right,t.bottom,r.left,r.top,r.right,r.bottom,o.COLOR_BUFFER_BIT,u?o.NEAREST:o.LINEAR),o.bindFramebuffer(o.READ_FRAMEBUFFER,e.glFramebuffers[this.CONTEXT_UID].framebuffer)}disposeFramebuffer(e,t){const r=e.glFramebuffers[this.CONTEXT_UID],n=this.gl;if(!r)return;delete e.glFramebuffers[this.CONTEXT_UID];const i=this.managedFramebuffers.indexOf(e);i>=0&&this.managedFramebuffers.splice(i,1),e.disposeRunner.remove(this),t||(n.deleteFramebuffer(r.framebuffer),r.msaaBuffer&&n.deleteRenderbuffer(r.msaaBuffer),r.stencil&&n.deleteRenderbuffer(r.stencil)),r.blitFramebuffer&&this.disposeFramebuffer(r.blitFramebuffer,t)}disposeAll(e){const t=this.managedFramebuffers;this.managedFramebuffers=[];for(let r=0;r<t.length;r++)this.disposeFramebuffer(t[r],e)}forceStencil(){const e=this.current;if(!e)return;const t=e.glFramebuffers[this.CONTEXT_UID];if(!t||t.stencil&&e.stencil)return;e.stencil=!0;const r=e.width,n=e.height,i=this.gl,o=t.stencil=i.createRenderbuffer();let a,s;i.bindRenderbuffer(i.RENDERBUFFER,o),1===this.renderer.context.webGLVersion?(a=i.DEPTH_STENCIL_ATTACHMENT,s=i.DEPTH_STENCIL):e.depth?(a=i.DEPTH_STENCIL_ATTACHMENT,s=i.DEPTH24_STENCIL8):(a=i.STENCIL_ATTACHMENT,s=i.STENCIL_INDEX8),t.msaaBuffer?i.renderbufferStorageMultisample(i.RENDERBUFFER,t.multisample,s,r,n):i.renderbufferStorage(i.RENDERBUFFER,s,r,n),i.framebufferRenderbuffer(i.FRAMEBUFFER,a,i.RENDERBUFFER,o)}reset(){this.current=this.unknownFramebuffer,this.viewport=new Kt}destroy(){this.renderer=null}}ln.extension={type:gt.RendererSystem,name:"framebuffer"},bt.add(ln);const hn={5126:4,5123:2,5121:1};class cn{constructor(e){this.renderer=e,this._activeGeometry=null,this._activeVao=null,this.hasVao=!0,this.hasInstance=!0,this.canUseUInt32ElementIndex=!1,this.managedGeometries={}}contextChange(){this.disposeAll(!0);const e=this.gl=this.renderer.gl,t=this.renderer.context;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,2!==t.webGLVersion){let t=this.renderer.context.extensions.vertexArrayObject;E.PREFER_ENV===i.WEBGL_LEGACY&&(t=null),t?(e.createVertexArray=()=>t.createVertexArrayOES(),e.bindVertexArray=e=>t.bindVertexArrayOES(e),e.deleteVertexArray=e=>t.deleteVertexArrayOES(e)):(this.hasVao=!1,e.createVertexArray=()=>null,e.bindVertexArray=()=>null,e.deleteVertexArray=()=>null)}if(2!==t.webGLVersion){const t=e.getExtension("ANGLE_instanced_arrays");t?(e.vertexAttribDivisor=(e,r)=>t.vertexAttribDivisorANGLE(e,r),e.drawElementsInstanced=(e,r,n,i,o)=>t.drawElementsInstancedANGLE(e,r,n,i,o),e.drawArraysInstanced=(e,r,n,i)=>t.drawArraysInstancedANGLE(e,r,n,i)):this.hasInstance=!1}this.canUseUInt32ElementIndex=2===t.webGLVersion||!!t.extensions.uint32ElementIndex}bind(e,t){t=t||this.renderer.shader.shader;const{gl:r}=this;let n=e.glVertexArrayObjects[this.CONTEXT_UID],i=!1;n||(this.managedGeometries[e.id]=e,e.disposeRunner.add(this),e.glVertexArrayObjects[this.CONTEXT_UID]=n={},i=!0);const o=n[t.program.id]||this.initGeometryVao(e,t,i);this._activeGeometry=e,this._activeVao!==o&&(this._activeVao=o,this.hasVao?r.bindVertexArray(o):this.activateVao(e,t.program)),this.updateBuffers()}reset(){this.unbind()}updateBuffers(){const e=this._activeGeometry,t=this.renderer.buffer;for(let r=0;r<e.buffers.length;r++){const n=e.buffers[r];t.update(n)}}checkCompatibility(e,t){const r=e.attributes,n=t.attributeData;for(const e in n)if(!r[e])throw new Error(`shader and geometry incompatible, geometry missing the "${e}" attribute`)}getSignature(e,t){const r=e.attributes,n=t.attributeData,i=["g",e.id];for(const e in r)n[e]&&i.push(e,n[e].location);return i.join("-")}initGeometryVao(e,t,r=!0){const n=this.gl,i=this.CONTEXT_UID,o=this.renderer.buffer,a=t.program;a.glPrograms[i]||this.renderer.shader.generateProgram(t),this.checkCompatibility(e,a);const s=this.getSignature(e,a),u=e.glVertexArrayObjects[this.CONTEXT_UID];let l=u[s];if(l)return u[a.id]=l,l;const h=e.buffers,c=e.attributes,f={},d={};for(const e in h)f[e]=0,d[e]=0;for(const e in c)!c[e].size&&a.attributeData[e]?c[e].size=a.attributeData[e].size:c[e].size||console.warn(`PIXI Geometry attribute '${e}' size cannot be determined (likely the bound shader does not have the attribute)`),f[c[e].buffer]+=c[e].size*hn[c[e].type];for(const e in c){const t=c[e],r=t.size;void 0===t.stride&&(f[t.buffer]===r*hn[t.type]?t.stride=0:t.stride=f[t.buffer]),void 0===t.start&&(t.start=d[t.buffer],d[t.buffer]+=r*hn[t.type])}l=n.createVertexArray(),n.bindVertexArray(l);for(let e=0;e<h.length;e++){const t=h[e];o.bind(t),r&&t._glBuffers[i].refCount++}return this.activateVao(e,a),u[a.id]=l,u[s]=l,n.bindVertexArray(null),o.unbind(S.ARRAY_BUFFER),l}disposeGeometry(e,t){if(!this.managedGeometries[e.id])return;delete this.managedGeometries[e.id];const r=e.glVertexArrayObjects[this.CONTEXT_UID],n=this.gl,i=e.buffers,o=this.renderer?.buffer;if(e.disposeRunner.remove(this),r){if(o)for(let e=0;e<i.length;e++){const r=i[e]._glBuffers[this.CONTEXT_UID];r&&(r.refCount--,0===r.refCount&&!t&&o.dispose(i[e],t))}if(!t)for(const e in r)if("g"===e[0]){const t=r[e];this._activeVao===t&&this.unbind(),n.deleteVertexArray(t)}delete e.glVertexArrayObjects[this.CONTEXT_UID]}}disposeAll(e){const t=Object.keys(this.managedGeometries);for(let r=0;r<t.length;r++)this.disposeGeometry(this.managedGeometries[t[r]],e)}activateVao(e,t){const r=this.gl,n=this.CONTEXT_UID,i=this.renderer.buffer,o=e.buffers,a=e.attributes;e.indexBuffer&&i.bind(e.indexBuffer);let s=null;for(const e in a){const u=a[e],l=o[u.buffer],h=l._glBuffers[n];if(t.attributeData[e]){s!==h&&(i.bind(l),s=h);const n=t.attributeData[e].location;if(r.enableVertexAttribArray(n),r.vertexAttribPointer(n,u.size,u.type||r.FLOAT,u.normalized,u.stride,u.start),u.instance){if(!this.hasInstance)throw new Error("geometry error, GPU Instancing is not supported on this device");r.vertexAttribDivisor(n,u.divisor)}}}}draw(e,t,r,n){const{gl:i}=this,o=this._activeGeometry;if(o.indexBuffer){const a=o.indexBuffer.data.BYTES_PER_ELEMENT,s=2===a?i.UNSIGNED_SHORT:i.UNSIGNED_INT;2===a||4===a&&this.canUseUInt32ElementIndex?o.instanced?i.drawElementsInstanced(e,t||o.indexBuffer.data.length,s,(r||0)*a,n||1):i.drawElements(e,t||o.indexBuffer.data.length,s,(r||0)*a):console.warn("unsupported index buffer type: uint32")}else o.instanced?i.drawArraysInstanced(e,r,t||o.getSize(),n||1):i.drawArrays(e,r,t||o.getSize());return this}unbind(){this.gl.bindVertexArray(null),this._activeVao=null,this._activeGeometry=null}destroy(){this.renderer=null}}cn.extension={type:gt.RendererSystem,name:"geometry"},bt.add(cn);const fn=new tr;class dn{constructor(e,t){this._texture=e,this.mapCoord=new tr,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._textureID=-1,this._updateID=0,this.clampOffset=0,this.clampMargin=typeof t>"u"?.5:t,this.isSimple=!1}get texture(){return this._texture}set texture(e){this._texture=e,this._textureID=-1}multiplyUvs(e,t){void 0===t&&(t=e);const r=this.mapCoord;for(let n=0;n<e.length;n+=2){const i=e[n],o=e[n+1];t[n]=i*r.a+o*r.c+r.tx,t[n+1]=i*r.b+o*r.d+r.ty}return t}update(e){const t=this._texture;if(!t||!t.valid||!e&&this._textureID===t._updateID)return!1;this._textureID=t._updateID,this._updateID++;const r=t._uvs;this.mapCoord.set(r.x1-r.x0,r.y1-r.y0,r.x3-r.x0,r.y3-r.y0,r.x0,r.y0);const n=t.orig,i=t.trim;i&&(fn.set(n.width/i.width,0,0,n.height/i.height,-i.x/i.width,-i.y/i.height),this.mapCoord.append(fn));const o=t.baseTexture,a=this.uClampFrame,s=this.clampMargin/o.resolution,u=this.clampOffset;return a[0]=(t._frame.x+s+u)/o.width,a[1]=(t._frame.y+s+u)/o.height,a[2]=(t._frame.x+t._frame.width-s+u)/o.width,a[3]=(t._frame.y+t._frame.height-s+u)/o.height,this.uClampOffset[0]=u/o.realWidth,this.uClampOffset[1]=u/o.realHeight,this.isSimple=t._frame.width===o.width&&t._frame.height===o.height&&0===t.rotate,!0}}class pn extends Fr{constructor(e,t,r){let n=null;"string"!=typeof e&&void 0===t&&void 0===r&&(n=e,e=void 0,t=void 0,r=void 0),super(e||"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 otherMatrix;\n\nvarying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;\n}\n",t||"varying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform sampler2D mask;\nuniform float alpha;\nuniform float npmAlpha;\nuniform vec4 maskClamp;\n\nvoid main(void)\n{\n    float clip = step(3.5,\n        step(maskClamp.x, vMaskCoord.x) +\n        step(maskClamp.y, vMaskCoord.y) +\n        step(vMaskCoord.x, maskClamp.z) +\n        step(vMaskCoord.y, maskClamp.w));\n\n    vec4 original = texture2D(uSampler, vTextureCoord);\n    vec4 masky = texture2D(mask, vMaskCoord);\n    float alphaMul = 1.0 - npmAlpha * (1.0 - masky.a);\n\n    original *= (alphaMul * masky.r * alpha * clip);\n\n    gl_FragColor = original;\n}\n",r),this.maskSprite=n,this.maskMatrix=new tr}get maskSprite(){return this._maskSprite}set maskSprite(e){this._maskSprite=e,this._maskSprite&&(this._maskSprite.renderable=!1)}apply(e,t,r,n){const i=this._maskSprite,o=i._texture;o.valid&&(o.uvMatrix||(o.uvMatrix=new dn(o,0)),o.uvMatrix.update(),this.uniforms.npmAlpha=o.baseTexture.alphaMode?0:1,this.uniforms.mask=o,this.uniforms.otherMatrix=e.calculateSpriteMatrix(this.maskMatrix,i).prepend(o.uvMatrix.mapCoord),this.uniforms.alpha=i.worldAlpha,this.uniforms.maskClamp=o.uvMatrix.uClampFrame,e.applyFilter(this,t,r,n))}}class yn{constructor(e=null){this.type=b.NONE,this.autoDetect=!0,this.maskObject=e||null,this.pooled=!1,this.isMaskData=!0,this.resolution=null,this.multisample=Fr.defaultMultisample,this.enabled=!0,this.colorMask=15,this._filters=null,this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null,this._scissorRectLocal=null,this._colorMask=15,this._target=null}get filter(){return this._filters?this._filters[0]:null}set filter(e){e?this._filters?this._filters[0]=e:this._filters=[e]:this._filters=null}reset(){this.pooled&&(this.maskObject=null,this.type=b.NONE,this.autoDetect=!0),this._target=null,this._scissorRectLocal=null}copyCountersOrReset(e){e?(this._stencilCounter=e._stencilCounter,this._scissorCounter=e._scissorCounter,this._scissorRect=e._scissorRect):(this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null)}}class mn{constructor(e){this.renderer=e,this.enableScissor=!0,this.alphaMaskPool=[],this.maskDataPool=[],this.maskStack=[],this.alphaMaskIndex=0}setMaskStack(e){this.maskStack=e,this.renderer.scissor.setMaskStack(e),this.renderer.stencil.setMaskStack(e)}push(e,t){let r=t;if(!r.isMaskData){const e=this.maskDataPool.pop()||new yn;e.pooled=!0,e.maskObject=t,r=e}const n=0!==this.maskStack.length?this.maskStack[this.maskStack.length-1]:null;if(r.copyCountersOrReset(n),r._colorMask=n?n._colorMask:15,r.autoDetect&&this.detect(r),r._target=e,r.type!==b.SPRITE&&this.maskStack.push(r),r.enabled)switch(r.type){case b.SCISSOR:this.renderer.scissor.push(r);break;case b.STENCIL:this.renderer.stencil.push(r);break;case b.SPRITE:r.copyCountersOrReset(null),this.pushSpriteMask(r);break;case b.COLOR:this.pushColorMask(r)}r.type===b.SPRITE&&this.maskStack.push(r)}pop(e){const t=this.maskStack.pop();if(t&&t._target===e){if(t.enabled)switch(t.type){case b.SCISSOR:this.renderer.scissor.pop(t);break;case b.STENCIL:this.renderer.stencil.pop(t.maskObject);break;case b.SPRITE:this.popSpriteMask(t);break;case b.COLOR:this.popColorMask(t)}if(t.reset(),t.pooled&&this.maskDataPool.push(t),0!==this.maskStack.length){const e=this.maskStack[this.maskStack.length-1];e.type===b.SPRITE&&e._filters&&(e._filters[0].maskSprite=e.maskObject)}}}detect(e){const t=e.maskObject;t?t.isSprite?e.type=b.SPRITE:this.enableScissor&&this.renderer.scissor.testScissor(e)?e.type=b.SCISSOR:e.type=b.STENCIL:e.type=b.COLOR}pushSpriteMask(e){const{maskObject:t}=e,r=e._target;let n=e._filters;n||(n=this.alphaMaskPool[this.alphaMaskIndex],n||(n=this.alphaMaskPool[this.alphaMaskIndex]=[new pn])),n[0].resolution=e.resolution,n[0].multisample=e.multisample,n[0].maskSprite=t;const i=r.filterArea;r.filterArea=t.getBounds(!0),this.renderer.filter.push(r,n),r.filterArea=i,e._filters||this.alphaMaskIndex++}popSpriteMask(e){this.renderer.filter.pop(),e._filters?e._filters[0].maskSprite=null:(this.alphaMaskIndex--,this.alphaMaskPool[this.alphaMaskIndex][0].maskSprite=null)}pushColorMask(e){const t=e._colorMask,r=e._colorMask=t&e.colorMask;r!==t&&this.renderer.gl.colorMask(!!(1&r),!!(2&r),!!(4&r),!!(8&r))}popColorMask(e){const t=e._colorMask,r=this.maskStack.length>0?this.maskStack[this.maskStack.length-1]._colorMask:15;r!==t&&this.renderer.gl.colorMask(!!(1&r),!!(2&r),!!(4&r),!!(8&r))}destroy(){this.renderer=null}}mn.extension={type:gt.RendererSystem,name:"mask"},bt.add(mn);class gn{constructor(e){this.renderer=e,this.maskStack=[],this.glConst=0}getStackLength(){return this.maskStack.length}setMaskStack(e){const{gl:t}=this.renderer,r=this.getStackLength();this.maskStack=e;const n=this.getStackLength();n!==r&&(0===n?t.disable(this.glConst):(t.enable(this.glConst),this._useCurrent()))}_useCurrent(){}destroy(){this.renderer=null,this.maskStack=null}}const wn=new tr,vn=[],bn=class e extends gn{constructor(e){super(e),this.glConst=E.ADAPTER.getWebGLRenderingContext().SCISSOR_TEST}getStackLength(){const e=this.maskStack[this.maskStack.length-1];return e?e._scissorCounter:0}calcScissorRect(e){if(e._scissorRectLocal)return;const t=e._scissorRect,{maskObject:r}=e,{renderer:n}=this,i=n.renderTexture,o=r.getBounds(!0,vn.pop()??new Kt);this.roundFrameToPixels(o,i.current?i.current.resolution:n.resolution,i.sourceFrame,i.destinationFrame,n.projection.transform),t&&o.fit(t),e._scissorRectLocal=o}static isMatrixRotated(e){if(!e)return!1;const{a:t,b:r,c:n,d:i}=e;return(Math.abs(r)>1e-4||Math.abs(n)>1e-4)&&(Math.abs(t)>1e-4||Math.abs(i)>1e-4)}testScissor(t){const{maskObject:r}=t;if(!r.isFastRect||!r.isFastRect()||e.isMatrixRotated(r.worldTransform)||e.isMatrixRotated(this.renderer.projection.transform))return!1;this.calcScissorRect(t);const n=t._scissorRectLocal;return n.width>0&&n.height>0}roundFrameToPixels(t,r,n,i,o){e.isMatrixRotated(o)||((o=o?wn.copyFrom(o):wn.identity()).translate(-n.x,-n.y).scale(i.width/n.width,i.height/n.height).translate(i.x,i.y),this.renderer.filter.transformAABB(o,t),t.fit(i),t.x=Math.round(t.x*r),t.y=Math.round(t.y*r),t.width=Math.round(t.width*r),t.height=Math.round(t.height*r))}push(e){e._scissorRectLocal||this.calcScissorRect(e);const{gl:t}=this.renderer;e._scissorRect||t.enable(t.SCISSOR_TEST),e._scissorCounter++,e._scissorRect=e._scissorRectLocal,this._useCurrent()}pop(e){const{gl:t}=this.renderer;e&&vn.push(e._scissorRectLocal),this.getStackLength()>0?this._useCurrent():t.disable(t.SCISSOR_TEST)}_useCurrent(){const e=this.maskStack[this.maskStack.length-1]._scissorRect;let t;t=this.renderer.renderTexture.current?e.y:this.renderer.height-e.height-e.y,this.renderer.gl.scissor(e.x,t,e.width,e.height)}};bn.extension={type:gt.RendererSystem,name:"scissor"};let xn=bn;bt.add(xn);class _n extends gn{constructor(e){super(e),this.glConst=E.ADAPTER.getWebGLRenderingContext().STENCIL_TEST}getStackLength(){const e=this.maskStack[this.maskStack.length-1];return e?e._stencilCounter:0}push(e){const t=e.maskObject,{gl:r}=this.renderer,n=e._stencilCounter;0===n&&(this.renderer.framebuffer.forceStencil(),r.clearStencil(0),r.clear(r.STENCIL_BUFFER_BIT),r.enable(r.STENCIL_TEST)),e._stencilCounter++;const i=e._colorMask;0!==i&&(e._colorMask=0,r.colorMask(!1,!1,!1,!1)),r.stencilFunc(r.EQUAL,n,4294967295),r.stencilOp(r.KEEP,r.KEEP,r.INCR),t.renderable=!0,t.render(this.renderer),this.renderer.batch.flush(),t.renderable=!1,0!==i&&(e._colorMask=i,r.colorMask(!!(1&i),!!(2&i),!!(4&i),!!(8&i))),this._useCurrent()}pop(e){const t=this.renderer.gl;if(0===this.getStackLength())t.disable(t.STENCIL_TEST);else{const r=0!==this.maskStack.length?this.maskStack[this.maskStack.length-1]:null,n=r?r._colorMask:15;0!==n&&(r._colorMask=0,t.colorMask(!1,!1,!1,!1)),t.stencilOp(t.KEEP,t.KEEP,t.DECR),e.renderable=!0,e.render(this.renderer),this.renderer.batch.flush(),e.renderable=!1,0!==n&&(r._colorMask=n,t.colorMask(!!(1&n),!!(2&n),!!(4&n),!!(8&n))),this._useCurrent()}}_useCurrent(){const e=this.renderer.gl;e.stencilFunc(e.EQUAL,this.getStackLength(),4294967295),e.stencilOp(e.KEEP,e.KEEP,e.KEEP)}}_n.extension={type:gt.RendererSystem,name:"stencil"},bt.add(_n);class Sn{constructor(e){this.renderer=e,this.plugins={},Object.defineProperties(this.plugins,{extract:{enumerable:!1,get:()=>(Y("7.0.0","renderer.plugins.extract has moved to renderer.extract"),e.extract)},prepare:{enumerable:!1,get:()=>(Y("7.0.0","renderer.plugins.prepare has moved to renderer.prepare"),e.prepare)},interaction:{enumerable:!1,get:()=>(Y("7.0.0","renderer.plugins.interaction has been deprecated, use renderer.events"),e.events)}})}init(){const e=this.rendererPlugins;for(const t in e)this.plugins[t]=new e[t](this.renderer)}destroy(){for(const e in this.plugins)this.plugins[e].destroy(),this.plugins[e]=null}}Sn.extension={type:[gt.RendererSystem,gt.CanvasRendererSystem],name:"_plugin"},bt.add(Sn);class Tn{constructor(e){this.renderer=e,this.destinationFrame=null,this.sourceFrame=null,this.defaultFrame=null,this.projectionMatrix=new tr,this.transform=null}update(e,t,r,n){this.destinationFrame=e||this.destinationFrame||this.defaultFrame,this.sourceFrame=t||this.sourceFrame||e,this.calculateProjection(this.destinationFrame,this.sourceFrame,r,n),this.transform&&this.projectionMatrix.append(this.transform);const i=this.renderer;i.globalUniforms.uniforms.projectionMatrix=this.projectionMatrix,i.globalUniforms.update(),i.shader.shader&&i.shader.syncUniformGroup(i.shader.shader.uniforms.globals)}calculateProjection(e,t,r,n){const i=this.projectionMatrix,o=n?-1:1;i.identity(),i.a=1/t.width*2,i.d=o*(1/t.height*2),i.tx=-1-t.x*i.a,i.ty=-o-t.y*i.d}setTransform(e){}destroy(){this.renderer=null}}Tn.extension={type:gt.RendererSystem,name:"projection"},bt.add(Tn);const En=new fr,On=new Kt;class An{constructor(e){this.renderer=e,this._tempMatrix=new tr}generateTexture(e,t){const{region:r,...n}=t||{},i=r?.copyTo(On)||e.getLocalBounds(On,!0),o=n.resolution||this.renderer.resolution;i.width=Math.max(i.width,1/o),i.height=Math.max(i.height,1/o),n.width=i.width,n.height=i.height,n.resolution=o,n.multisample??(n.multisample=this.renderer.multisample);const a=Jr.create(n);this._tempMatrix.tx=-i.x,this._tempMatrix.ty=-i.y;const s=e.transform;return e.transform=En,this.renderer.render(e,{renderTexture:a,transform:this._tempMatrix,skipUpdateTransform:!!e.parent,blit:!0}),e.transform=s,a}destroy(){}}An.extension={type:[gt.RendererSystem,gt.CanvasRendererSystem],name:"textureGenerator"},bt.add(An);const In=new Kt,Pn=new Kt;class kn{constructor(e){this.renderer=e,this.defaultMaskStack=[],this.current=null,this.sourceFrame=new Kt,this.destinationFrame=new Kt,this.viewportFrame=new Kt}contextChange(){const e=this.renderer?.gl.getContextAttributes();this._rendererPremultipliedAlpha=!!(e&&e.alpha&&e.premultipliedAlpha)}bind(e=null,t,r){const n=this.renderer;let i,o,a;this.current=e,e?(i=e.baseTexture,a=i.resolution,t||(In.width=e.frame.width,In.height=e.frame.height,t=In),r||(Pn.x=e.frame.x,Pn.y=e.frame.y,Pn.width=t.width,Pn.height=t.height,r=Pn),o=i.framebuffer):(a=n.resolution,t||(In.width=n._view.screen.width,In.height=n._view.screen.height,t=In),r||((r=In).width=t.width,r.height=t.height));const s=this.viewportFrame;s.x=r.x*a,s.y=r.y*a,s.width=r.width*a,s.height=r.height*a,e||(s.y=n.view.height-(s.y+s.height)),s.ceil(),this.renderer.framebuffer.bind(o,s),this.renderer.projection.update(r,t,a,!o),e?this.renderer.mask.setMaskStack(i.maskStack):this.renderer.mask.setMaskStack(this.defaultMaskStack),this.sourceFrame.copyFrom(t),this.destinationFrame.copyFrom(r)}clear(e,t){const r=this.current?this.current.baseTexture.clear:this.renderer.background.backgroundColor,n=De.shared.setValue(e||r);(this.current&&this.current.baseTexture.alphaMode>0||!this.current&&this._rendererPremultipliedAlpha)&&n.premultiply(n.alpha);const i=this.destinationFrame,o=this.current?this.current.baseTexture:this.renderer._view.screen,a=i.width!==o.width||i.height!==o.height;if(a){let{x:e,y:t,width:r,height:n}=this.viewportFrame;e=Math.round(e),t=Math.round(t),r=Math.round(r),n=Math.round(n),this.renderer.gl.enable(this.renderer.gl.SCISSOR_TEST),this.renderer.gl.scissor(e,t,r,n)}this.renderer.framebuffer.clear(n.red,n.green,n.blue,n.alpha,t),a&&this.renderer.scissor.pop()}resize(){this.bind(null)}reset(){this.bind(null)}destroy(){this.renderer=null}}kn.extension={type:gt.RendererSystem,name:"renderTexture"},bt.add(kn);class Cn{}class $n{constructor(e,t){this.program=e,this.uniformData=t,this.uniformGroups={},this.uniformDirtyGroups={},this.uniformBufferBindings={}}destroy(){this.uniformData=null,this.uniformGroups=null,this.uniformDirtyGroups=null,this.uniformBufferBindings=null,this.program=null}}function Rn(e,t,r){const n=e.createShader(t);return e.shaderSource(n,r),e.compileShader(n),n}function Dn(e){const t=new Array(e);for(let e=0;e<t.length;e++)t[e]=!1;return t}function Mn(e,t){switch(e){case"float":case"int":case"uint":case"sampler2D":case"sampler2DArray":return 0;case"vec2":return new Float32Array(2*t);case"vec3":return new Float32Array(3*t);case"vec4":return new Float32Array(4*t);case"ivec2":return new Int32Array(2*t);case"ivec3":return new Int32Array(3*t);case"ivec4":return new Int32Array(4*t);case"uvec2":return new Uint32Array(2*t);case"uvec3":return new Uint32Array(3*t);case"uvec4":return new Uint32Array(4*t);case"bool":return!1;case"bvec2":return Dn(2*t);case"bvec3":return Dn(3*t);case"bvec4":return Dn(4*t);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}function Ln(e,t){const r=e.getShaderSource(t).split("\n").map(((e,t)=>`${t}: ${e}`)),n=e.getShaderInfoLog(t),i=n.split("\n"),o={},a=i.map((e=>parseFloat(e.replace(/^ERROR\: 0\:([\d]+)\:.*$/,"$1")))).filter((e=>!(!e||o[e])&&(o[e]=!0,!0))),s=[""];a.forEach((e=>{r[e-1]=`%c${r[e-1]}%c`,s.push("background: #FF0000; color:#FFFFFF; font-size: 10px","font-size: 10px")}));const u=r.join("\n");s[0]=u,console.error(n),console.groupCollapsed("click to view full shader code"),console.warn(...s),console.groupEnd()}function Bn(e,t){const r=Rn(e,e.VERTEX_SHADER,t.vertexSrc),n=Rn(e,e.FRAGMENT_SHADER,t.fragmentSrc),i=e.createProgram();e.attachShader(i,r),e.attachShader(i,n);const o=t.extra?.transformFeedbackVaryings;if(o&&("function"!=typeof e.transformFeedbackVaryings?console.warn("TransformFeedback is not supported but TransformFeedbackVaryings are given."):e.transformFeedbackVaryings(i,o.names,"separate"===o.bufferMode?e.SEPARATE_ATTRIBS:e.INTERLEAVED_ATTRIBS)),e.linkProgram(i),e.getProgramParameter(i,e.LINK_STATUS)||function(e,t,r,n){e.getProgramParameter(t,e.LINK_STATUS)||(e.getShaderParameter(r,e.COMPILE_STATUS)||Ln(e,r),e.getShaderParameter(n,e.COMPILE_STATUS)||Ln(e,n),console.error("PixiJS Error: Could not initialize shader."),""!==e.getProgramInfoLog(t)&&console.warn("PixiJS Warning: gl.getProgramInfoLog()",e.getProgramInfoLog(t)))}(e,i,r,n),t.attributeData=function(e,t){const r={},n=t.getProgramParameter(e,t.ACTIVE_ATTRIBUTES);for(let i=0;i<n;i++){const n=t.getActiveAttrib(e,i);if(n.name.startsWith("gl_"))continue;const o=Tr(t,n.type),a={type:o,name:n.name,size:xr(o),location:t.getAttribLocation(e,n.name)};r[n.name]=a}return r}(i,e),t.uniformData=function(e,t){const r={},n=t.getProgramParameter(e,t.ACTIVE_UNIFORMS);for(let i=0;i<n;i++){const n=t.getActiveUniform(e,i),o=n.name.replace(/\[.*?\]$/,""),a=!!n.name.match(/\[.*?\]$/),s=Tr(t,n.type);r[o]={name:o,index:i,type:s,size:n.size,isArray:a,value:Mn(s,n.size)}}return r}(i,e),!/^[ \t]*#[ \t]*version[ \t]+300[ \t]+es[ \t]*$/m.test(t.vertexSrc)){const r=Object.keys(t.attributeData);r.sort(((e,t)=>e>t?1:-1));for(let n=0;n<r.length;n++)t.attributeData[r[n]].location=n,e.bindAttribLocation(i,n,r[n]);e.linkProgram(i)}e.deleteShader(r),e.deleteShader(n);const a={};for(const r in t.uniformData){const n=t.uniformData[r];a[r]={location:e.getUniformLocation(i,r),value:Mn(n.type,n.size)}}return new $n(i,a)}function Nn(e,t,r,n,i){r.buffer.update(i)}const Fn={float:"\n        data[offset] = v;\n    ",vec2:"\n        data[offset] = v[0];\n        data[offset+1] = v[1];\n    ",vec3:"\n        data[offset] = v[0];\n        data[offset+1] = v[1];\n        data[offset+2] = v[2];\n\n    ",vec4:"\n        data[offset] = v[0];\n        data[offset+1] = v[1];\n        data[offset+2] = v[2];\n        data[offset+3] = v[3];\n    ",mat2:"\n        data[offset] = v[0];\n        data[offset+1] = v[1];\n\n        data[offset+4] = v[2];\n        data[offset+5] = v[3];\n    ",mat3:"\n        data[offset] = v[0];\n        data[offset+1] = v[1];\n        data[offset+2] = v[2];\n\n        data[offset + 4] = v[3];\n        data[offset + 5] = v[4];\n        data[offset + 6] = v[5];\n\n        data[offset + 8] = v[6];\n        data[offset + 9] = v[7];\n        data[offset + 10] = v[8];\n    ",mat4:"\n        for(var i = 0; i < 16; i++)\n        {\n            data[offset + i] = v[i];\n        }\n    "},Un={float:4,vec2:8,vec3:12,vec4:16,int:4,ivec2:8,ivec3:12,ivec4:16,uint:4,uvec2:8,uvec3:12,uvec4:16,bool:4,bvec2:8,bvec3:12,bvec4:16,mat2:32,mat3:48,mat4:64};function jn(e){const t=e.map((e=>({data:e,offset:0,dataLen:0,dirty:0})));let r=0,n=0,i=0;for(let e=0;e<t.length;e++){const o=t[e];if(r=Un[o.data.type],o.data.size>1&&(r=Math.max(r,16)*o.data.size),o.dataLen=r,n%r!=0&&n<16){const e=n%r%16;n+=e,i+=e}n+r>16?(i=16*Math.ceil(i/16),o.offset=i,i+=r,n=r):(o.offset=i,n+=r,i+=r)}return i=16*Math.ceil(i/16),{uboElements:t,size:i}}function zn(e,t){const r=[];for(const n in e)t[n]&&r.push(t[n]);return r.sort(((e,t)=>e.index-t.index)),r}function Gn(e,t){if(!e.autoManage)return{size:0,syncFunc:Nn};const r=zn(e.uniforms,t),{uboElements:n,size:i}=jn(r),o=["\n    var v = null;\n    var v2 = null;\n    var cv = null;\n    var t = 0;\n    var gl = renderer.gl\n    var index = 0;\n    var data = buffer.data;\n    "];for(let t=0;t<n.length;t++){const r=n[t],i=e.uniforms[r.data.name],a=r.data.name;let s=!1;for(let e=0;e<dr.length;e++){const t=dr[e];if(t.codeUbo&&t.test(r.data,i)){o.push(`offset = ${r.offset/4};`,dr[e].codeUbo(r.data.name,i)),s=!0;break}}if(!s)if(r.data.size>1){const e=xr(r.data.type),t=Math.max(Un[r.data.type]/16,1),n=e/t,i=(4-n%4)%4;o.push(`\n                cv = ud.${a}.value;\n                v = uv.${a};\n                offset = ${r.offset/4};\n\n                t = 0;\n\n                for(var i=0; i < ${r.data.size*t}; i++)\n                {\n                    for(var j = 0; j < ${n}; j++)\n                    {\n                        data[offset++] = v[t++];\n                    }\n                    offset += ${i};\n                }\n\n                `)}else{const e=Fn[r.data.type];o.push(`\n                cv = ud.${a}.value;\n                v = uv.${a};\n                offset = ${r.offset/4};\n                ${e};\n                `)}}return o.push("\n       renderer.buffer.update(buffer);\n    "),{size:i,syncFunc:new Function("ud","uv","renderer","syncData","buffer",o.join("\n"))}}let Vn;function Wn(){if("boolean"==typeof Vn)return Vn;try{Vn=!0===new Function("param1","param2","param3","return param1[param2] === param3;")({a:"b"},"a","b")}catch{Vn=!1}return Vn}let Hn=0;const qn={textureCount:0,uboCount:0};class Yn{constructor(e){this.destroyed=!1,this.renderer=e,this.systemCheck(),this.gl=null,this.shader=null,this.program=null,this.cache={},this._uboCache={},this.id=Hn++}systemCheck(){if(!Wn())throw new Error("Current environment does not allow unsafe-eval, please use @pixi/unsafe-eval module to enable support.")}contextChange(e){this.gl=e,this.reset()}bind(e,t){e.disposeRunner.add(this),e.uniforms.globals=this.renderer.globalUniforms;const r=e.program,n=r.glPrograms[this.renderer.CONTEXT_UID]||this.generateProgram(e);return this.shader=e,this.program!==r&&(this.program=r,this.gl.useProgram(n.program)),t||(qn.textureCount=0,qn.uboCount=0,this.syncUniformGroup(e.uniformGroup,qn)),n}setUniforms(e){const t=this.shader.program,r=t.glPrograms[this.renderer.CONTEXT_UID];t.syncUniforms(r.uniformData,e,this.renderer)}syncUniformGroup(e,t){const r=this.getGlProgram();(!e.static||e.dirtyId!==r.uniformDirtyGroups[e.id])&&(r.uniformDirtyGroups[e.id]=e.dirtyId,this.syncUniforms(e,r,t))}syncUniforms(e,t,r){(e.syncUniforms[this.shader.program.id]||this.createSyncGroups(e))(t.uniformData,e.uniforms,this.renderer,r)}createSyncGroups(e){const t=this.getSignature(e,this.shader.program.uniformData,"u");return this.cache[t]||(this.cache[t]=function(e,t){const r=["\n        var v = null;\n        var cv = null;\n        var cu = null;\n        var t = 0;\n        var gl = renderer.gl;\n    "];for(const n in e.uniforms){const i=t[n];if(!i){!0===e.uniforms[n]?.group&&(e.uniforms[n].ubo?r.push(`\n                        renderer.shader.syncUniformBufferGroup(uv.${n}, '${n}');\n                    `):r.push(`\n                        renderer.shader.syncUniformGroup(uv.${n}, syncData);\n                    `));continue}const o=e.uniforms[n];let a=!1;for(let e=0;e<dr.length;e++)if(dr[e].test(i,o)){r.push(dr[e].code(n,o)),a=!0;break}if(!a){const e=(1!==i.size||i.isArray?yr:pr)[i.type].replace("location",`ud["${n}"].location`);r.push(`\n            cu = ud["${n}"];\n            cv = cu.value;\n            v = uv["${n}"];\n            ${e};`)}}return new Function("ud","uv","renderer","syncData",r.join("\n"))}(e,this.shader.program.uniformData)),e.syncUniforms[this.shader.program.id]=this.cache[t],e.syncUniforms[this.shader.program.id]}syncUniformBufferGroup(e,t){const r=this.getGlProgram();if(!e.static||0!==e.dirtyId||!r.uniformGroups[e.id]){e.dirtyId=0;const n=r.uniformGroups[e.id]||this.createSyncBufferGroup(e,r,t);e.buffer.update(),n(r.uniformData,e.uniforms,this.renderer,qn,e.buffer)}this.renderer.buffer.bindBufferBase(e.buffer,r.uniformBufferBindings[t])}createSyncBufferGroup(e,t,r){const{gl:n}=this.renderer;this.renderer.buffer.bind(e.buffer);const i=this.gl.getUniformBlockIndex(t.program,r);t.uniformBufferBindings[r]=this.shader.uniformBindCount,n.uniformBlockBinding(t.program,i,this.shader.uniformBindCount),this.shader.uniformBindCount++;const o=this.getSignature(e,this.shader.program.uniformData,"ubo");let a=this._uboCache[o];if(a||(a=this._uboCache[o]=Gn(e,this.shader.program.uniformData)),e.autoManage){const t=new Float32Array(a.size/4);e.buffer.update(t)}return t.uniformGroups[e.id]=a.syncFunc,t.uniformGroups[e.id]}getSignature(e,t,r){const n=e.uniforms,i=[`${r}-`];for(const e in n)i.push(e),t[e]&&i.push(t[e].type);return i.join("-")}getGlProgram(){return this.shader?this.shader.program.glPrograms[this.renderer.CONTEXT_UID]:null}generateProgram(e){const t=this.gl,r=e.program,n=Bn(t,r);return r.glPrograms[this.renderer.CONTEXT_UID]=n,n}reset(){this.program=null,this.shader=null}disposeShader(e){this.shader===e&&(this.shader=null)}destroy(){this.renderer=null,this.destroyed=!0}}Yn.extension={type:gt.RendererSystem,name:"shader"},bt.add(Yn);class Xn{constructor(e){this.renderer=e}run(e){const{renderer:t}=this;t.runners.init.emit(t.options),e.hello&&console.log(`PixiJS 7.4.2 - ${t.rendererLogId} - https://pixijs.com`),t.resize(t.screen.width,t.screen.height)}destroy(){}}Xn.defaultOptions={hello:!1},Xn.extension={type:[gt.RendererSystem,gt.CanvasRendererSystem],name:"startup"},bt.add(Xn);const Kn=class e{constructor(){this.gl=null,this.stateId=0,this.polygonOffset=0,this.blendMode=s.NONE,this._blendEq=!1,this.map=[],this.map[0]=this.setBlend,this.map[1]=this.setOffset,this.map[2]=this.setCullFace,this.map[3]=this.setDepthTest,this.map[4]=this.setFrontFace,this.map[5]=this.setDepthMask,this.checks=[],this.defaultState=new Et,this.defaultState.blend=!0}contextChange(e){this.gl=e,this.blendModes=function(e,t=[]){return t[s.NORMAL]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[s.ADD]=[e.ONE,e.ONE],t[s.MULTIPLY]=[e.DST_COLOR,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA],t[s.SCREEN]=[e.ONE,e.ONE_MINUS_SRC_COLOR,e.ONE,e.ONE_MINUS_SRC_ALPHA],t[s.OVERLAY]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[s.DARKEN]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[s.LIGHTEN]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[s.COLOR_DODGE]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[s.COLOR_BURN]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[s.HARD_LIGHT]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[s.SOFT_LIGHT]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[s.DIFFERENCE]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[s.EXCLUSION]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[s.HUE]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[s.SATURATION]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[s.COLOR]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[s.LUMINOSITY]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[s.NONE]=[0,0],t[s.NORMAL_NPM]=[e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA],t[s.ADD_NPM]=[e.SRC_ALPHA,e.ONE,e.ONE,e.ONE],t[s.SCREEN_NPM]=[e.SRC_ALPHA,e.ONE_MINUS_SRC_COLOR,e.ONE,e.ONE_MINUS_SRC_ALPHA],t[s.SRC_IN]=[e.DST_ALPHA,e.ZERO],t[s.SRC_OUT]=[e.ONE_MINUS_DST_ALPHA,e.ZERO],t[s.SRC_ATOP]=[e.DST_ALPHA,e.ONE_MINUS_SRC_ALPHA],t[s.DST_OVER]=[e.ONE_MINUS_DST_ALPHA,e.ONE],t[s.DST_IN]=[e.ZERO,e.SRC_ALPHA],t[s.DST_OUT]=[e.ZERO,e.ONE_MINUS_SRC_ALPHA],t[s.DST_ATOP]=[e.ONE_MINUS_DST_ALPHA,e.SRC_ALPHA],t[s.XOR]=[e.ONE_MINUS_DST_ALPHA,e.ONE_MINUS_SRC_ALPHA],t[s.SUBTRACT]=[e.ONE,e.ONE,e.ONE,e.ONE,e.FUNC_REVERSE_SUBTRACT,e.FUNC_ADD],t}(e),this.set(this.defaultState),this.reset()}set(e){if(e=e||this.defaultState,this.stateId!==e.data){let t=this.stateId^e.data,r=0;for(;t;)1&t&&this.map[r].call(this,!!(e.data&1<<r)),t>>=1,r++;this.stateId=e.data}for(let t=0;t<this.checks.length;t++)this.checks[t](this,e)}forceState(e){e=e||this.defaultState;for(let t=0;t<this.map.length;t++)this.map[t].call(this,!!(e.data&1<<t));for(let t=0;t<this.checks.length;t++)this.checks[t](this,e);this.stateId=e.data}setBlend(t){this.updateCheck(e.checkBlendMode,t),this.gl[t?"enable":"disable"](this.gl.BLEND)}setOffset(t){this.updateCheck(e.checkPolygonOffset,t),this.gl[t?"enable":"disable"](this.gl.POLYGON_OFFSET_FILL)}setDepthTest(e){this.gl[e?"enable":"disable"](this.gl.DEPTH_TEST)}setDepthMask(e){this.gl.depthMask(e)}setCullFace(e){this.gl[e?"enable":"disable"](this.gl.CULL_FACE)}setFrontFace(e){this.gl.frontFace(this.gl[e?"CW":"CCW"])}setBlendMode(e){if(e===this.blendMode)return;this.blendMode=e;const t=this.blendModes[e],r=this.gl;2===t.length?r.blendFunc(t[0],t[1]):r.blendFuncSeparate(t[0],t[1],t[2],t[3]),6===t.length?(this._blendEq=!0,r.blendEquationSeparate(t[4],t[5])):this._blendEq&&(this._blendEq=!1,r.blendEquationSeparate(r.FUNC_ADD,r.FUNC_ADD))}setPolygonOffset(e,t){this.gl.polygonOffset(e,t)}reset(){this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.forceState(this.defaultState),this._blendEq=!0,this.blendMode=-1,this.setBlendMode(0)}updateCheck(e,t){const r=this.checks.indexOf(e);t&&-1===r?this.checks.push(e):!t&&-1!==r&&this.checks.splice(r,1)}static checkBlendMode(e,t){e.setBlendMode(t.blendMode)}static checkPolygonOffset(e,t){e.setPolygonOffset(1,t.polygonOffset)}destroy(){this.gl=null}};Kn.extension={type:gt.RendererSystem,name:"state"};let Zn=Kn;bt.add(Zn);class Jn extends V{constructor(){super(...arguments),this.runners={},this._systemsHash={}}setup(e){this.addRunners(...e.runners);const t=(e.priority??[]).filter((t=>e.systems[t])),r=[...t,...Object.keys(e.systems).filter((e=>!t.includes(e)))];for(const t of r)this.addSystem(e.systems[t],t)}addRunners(...e){e.forEach((e=>{this.runners[e]=new It(e)}))}addSystem(e,t){const r=new e(this);if(this[t])throw new Error(`Whoops! The name "${t}" is already in use`);this[t]=r,this._systemsHash[t]=r;for(const e in this.runners)this.runners[e].add(r);return this}emitWithCustomOptions(e,t){const r=Object.keys(this._systemsHash);e.items.forEach((n=>{const i=r.find((e=>this._systemsHash[e]===n));n[e.name](t[i])}))}destroy(){Object.values(this.runners).forEach((e=>{e.destroy()})),this._systemsHash={}}}const Qn=class e{constructor(t){this.renderer=t,this.count=0,this.checkCount=0,this.maxIdle=e.defaultMaxIdle,this.checkCountMax=e.defaultCheckCountMax,this.mode=e.defaultMode}postrender(){this.renderer.objectRenderer.renderingToScreen&&(this.count++,this.mode!==w.MANUAL&&(this.checkCount++,this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run())))}run(){const e=this.renderer.texture,t=e.managedTextures;let r=!1;for(let n=0;n<t.length;n++){const i=t[n];i.resource&&this.count-i.touched>this.maxIdle&&(e.destroyTexture(i,!0),t[n]=null,r=!0)}if(r){let e=0;for(let r=0;r<t.length;r++)null!==t[r]&&(t[e++]=t[r]);t.length=e}}unload(e){const t=this.renderer.texture,r=e._texture;r&&!r.framebuffer&&t.destroyTexture(r);for(let t=e.children.length-1;t>=0;t--)this.unload(e.children[t])}destroy(){this.renderer=null}};Qn.defaultMode=w.AUTO,Qn.defaultMaxIdle=3600,Qn.defaultCheckCountMax=600,Qn.extension={type:gt.RendererSystem,name:"textureGC"};let ei=Qn;bt.add(ei);class ti{constructor(e){this.texture=e,this.width=-1,this.height=-1,this.dirtyId=-1,this.dirtyStyleId=-1,this.mipmap=!1,this.wrapMode=33071,this.type=c.UNSIGNED_BYTE,this.internalFormat=l.RGBA,this.samplerType=0}}class ri{constructor(e){this.renderer=e,this.boundTextures=[],this.currentLocation=-1,this.managedTextures=[],this._unknownBoundTextures=!1,this.unknownTexture=new Rt,this.hasIntegerTextures=!1}contextChange(){const e=this.gl=this.renderer.gl;this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.webGLVersion=this.renderer.context.webGLVersion,this.internalFormats=function(e){let t;return t="WebGL2RenderingContext"in globalThis&&e instanceof globalThis.WebGL2RenderingContext?{[c.UNSIGNED_BYTE]:{[l.RGBA]:e.RGBA8,[l.RGB]:e.RGB8,[l.RG]:e.RG8,[l.RED]:e.R8,[l.RGBA_INTEGER]:e.RGBA8UI,[l.RGB_INTEGER]:e.RGB8UI,[l.RG_INTEGER]:e.RG8UI,[l.RED_INTEGER]:e.R8UI,[l.ALPHA]:e.ALPHA,[l.LUMINANCE]:e.LUMINANCE,[l.LUMINANCE_ALPHA]:e.LUMINANCE_ALPHA},[c.BYTE]:{[l.RGBA]:e.RGBA8_SNORM,[l.RGB]:e.RGB8_SNORM,[l.RG]:e.RG8_SNORM,[l.RED]:e.R8_SNORM,[l.RGBA_INTEGER]:e.RGBA8I,[l.RGB_INTEGER]:e.RGB8I,[l.RG_INTEGER]:e.RG8I,[l.RED_INTEGER]:e.R8I},[c.UNSIGNED_SHORT]:{[l.RGBA_INTEGER]:e.RGBA16UI,[l.RGB_INTEGER]:e.RGB16UI,[l.RG_INTEGER]:e.RG16UI,[l.RED_INTEGER]:e.R16UI,[l.DEPTH_COMPONENT]:e.DEPTH_COMPONENT16},[c.SHORT]:{[l.RGBA_INTEGER]:e.RGBA16I,[l.RGB_INTEGER]:e.RGB16I,[l.RG_INTEGER]:e.RG16I,[l.RED_INTEGER]:e.R16I},[c.UNSIGNED_INT]:{[l.RGBA_INTEGER]:e.RGBA32UI,[l.RGB_INTEGER]:e.RGB32UI,[l.RG_INTEGER]:e.RG32UI,[l.RED_INTEGER]:e.R32UI,[l.DEPTH_COMPONENT]:e.DEPTH_COMPONENT24},[c.INT]:{[l.RGBA_INTEGER]:e.RGBA32I,[l.RGB_INTEGER]:e.RGB32I,[l.RG_INTEGER]:e.RG32I,[l.RED_INTEGER]:e.R32I},[c.FLOAT]:{[l.RGBA]:e.RGBA32F,[l.RGB]:e.RGB32F,[l.RG]:e.RG32F,[l.RED]:e.R32F,[l.DEPTH_COMPONENT]:e.DEPTH_COMPONENT32F},[c.HALF_FLOAT]:{[l.RGBA]:e.RGBA16F,[l.RGB]:e.RGB16F,[l.RG]:e.RG16F,[l.RED]:e.R16F},[c.UNSIGNED_SHORT_5_6_5]:{[l.RGB]:e.RGB565},[c.UNSIGNED_SHORT_4_4_4_4]:{[l.RGBA]:e.RGBA4},[c.UNSIGNED_SHORT_5_5_5_1]:{[l.RGBA]:e.RGB5_A1},[c.UNSIGNED_INT_2_10_10_10_REV]:{[l.RGBA]:e.RGB10_A2,[l.RGBA_INTEGER]:e.RGB10_A2UI},[c.UNSIGNED_INT_10F_11F_11F_REV]:{[l.RGB]:e.R11F_G11F_B10F},[c.UNSIGNED_INT_5_9_9_9_REV]:{[l.RGB]:e.RGB9_E5},[c.UNSIGNED_INT_24_8]:{[l.DEPTH_STENCIL]:e.DEPTH24_STENCIL8},[c.FLOAT_32_UNSIGNED_INT_24_8_REV]:{[l.DEPTH_STENCIL]:e.DEPTH32F_STENCIL8}}:{[c.UNSIGNED_BYTE]:{[l.RGBA]:e.RGBA,[l.RGB]:e.RGB,[l.ALPHA]:e.ALPHA,[l.LUMINANCE]:e.LUMINANCE,[l.LUMINANCE_ALPHA]:e.LUMINANCE_ALPHA},[c.UNSIGNED_SHORT_5_6_5]:{[l.RGB]:e.RGB},[c.UNSIGNED_SHORT_4_4_4_4]:{[l.RGBA]:e.RGBA},[c.UNSIGNED_SHORT_5_5_5_1]:{[l.RGBA]:e.RGBA}},t}(e),this.samplerTypes=function(e){let t;return t="WebGL2RenderingContext"in globalThis&&e instanceof globalThis.WebGL2RenderingContext?{[e.RGB]:f.FLOAT,[e.RGBA]:f.FLOAT,[e.ALPHA]:f.FLOAT,[e.LUMINANCE]:f.FLOAT,[e.LUMINANCE_ALPHA]:f.FLOAT,[e.R8]:f.FLOAT,[e.R8_SNORM]:f.FLOAT,[e.RG8]:f.FLOAT,[e.RG8_SNORM]:f.FLOAT,[e.RGB8]:f.FLOAT,[e.RGB8_SNORM]:f.FLOAT,[e.RGB565]:f.FLOAT,[e.RGBA4]:f.FLOAT,[e.RGB5_A1]:f.FLOAT,[e.RGBA8]:f.FLOAT,[e.RGBA8_SNORM]:f.FLOAT,[e.RGB10_A2]:f.FLOAT,[e.RGB10_A2UI]:f.FLOAT,[e.SRGB8]:f.FLOAT,[e.SRGB8_ALPHA8]:f.FLOAT,[e.R16F]:f.FLOAT,[e.RG16F]:f.FLOAT,[e.RGB16F]:f.FLOAT,[e.RGBA16F]:f.FLOAT,[e.R32F]:f.FLOAT,[e.RG32F]:f.FLOAT,[e.RGB32F]:f.FLOAT,[e.RGBA32F]:f.FLOAT,[e.R11F_G11F_B10F]:f.FLOAT,[e.RGB9_E5]:f.FLOAT,[e.R8I]:f.INT,[e.R8UI]:f.UINT,[e.R16I]:f.INT,[e.R16UI]:f.UINT,[e.R32I]:f.INT,[e.R32UI]:f.UINT,[e.RG8I]:f.INT,[e.RG8UI]:f.UINT,[e.RG16I]:f.INT,[e.RG16UI]:f.UINT,[e.RG32I]:f.INT,[e.RG32UI]:f.UINT,[e.RGB8I]:f.INT,[e.RGB8UI]:f.UINT,[e.RGB16I]:f.INT,[e.RGB16UI]:f.UINT,[e.RGB32I]:f.INT,[e.RGB32UI]:f.UINT,[e.RGBA8I]:f.INT,[e.RGBA8UI]:f.UINT,[e.RGBA16I]:f.INT,[e.RGBA16UI]:f.UINT,[e.RGBA32I]:f.INT,[e.RGBA32UI]:f.UINT,[e.DEPTH_COMPONENT16]:f.FLOAT,[e.DEPTH_COMPONENT24]:f.FLOAT,[e.DEPTH_COMPONENT32F]:f.FLOAT,[e.DEPTH_STENCIL]:f.FLOAT,[e.DEPTH24_STENCIL8]:f.FLOAT,[e.DEPTH32F_STENCIL8]:f.FLOAT}:{[e.RGB]:f.FLOAT,[e.RGBA]:f.FLOAT,[e.ALPHA]:f.FLOAT,[e.LUMINANCE]:f.FLOAT,[e.LUMINANCE_ALPHA]:f.FLOAT,[e.DEPTH_STENCIL]:f.FLOAT},t}(e);const t=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS);this.boundTextures.length=t;for(let e=0;e<t;e++)this.boundTextures[e]=null;this.emptyTextures={};const r=new ti(e.createTexture());e.bindTexture(e.TEXTURE_2D,r.texture),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,new Uint8Array(4)),this.emptyTextures[e.TEXTURE_2D]=r,this.emptyTextures[e.TEXTURE_CUBE_MAP]=new ti(e.createTexture()),e.bindTexture(e.TEXTURE_CUBE_MAP,this.emptyTextures[e.TEXTURE_CUBE_MAP].texture);for(let t=0;t<6;t++)e.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,null);e.texParameteri(e.TEXTURE_CUBE_MAP,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_CUBE_MAP,e.TEXTURE_MIN_FILTER,e.LINEAR);for(let e=0;e<this.boundTextures.length;e++)this.bind(null,e)}bind(e,t=0){const{gl:r}=this;if(e=e?.castToBaseTexture(),e?.valid&&!e.parentTextureArray){e.touched=this.renderer.textureGC.count;const n=e._glTextures[this.CONTEXT_UID]||this.initTexture(e);this.boundTextures[t]!==e&&(this.currentLocation!==t&&(this.currentLocation=t,r.activeTexture(r.TEXTURE0+t)),r.bindTexture(e.target,n.texture)),n.dirtyId!==e.dirtyId?(this.currentLocation!==t&&(this.currentLocation=t,r.activeTexture(r.TEXTURE0+t)),this.updateTexture(e)):n.dirtyStyleId!==e.dirtyStyleId&&this.updateTextureStyle(e),this.boundTextures[t]=e}else this.currentLocation!==t&&(this.currentLocation=t,r.activeTexture(r.TEXTURE0+t)),r.bindTexture(r.TEXTURE_2D,this.emptyTextures[r.TEXTURE_2D].texture),this.boundTextures[t]=null}reset(){this._unknownBoundTextures=!0,this.hasIntegerTextures=!1,this.currentLocation=-1;for(let e=0;e<this.boundTextures.length;e++)this.boundTextures[e]=this.unknownTexture}unbind(e){const{gl:t,boundTextures:r}=this;if(this._unknownBoundTextures){this._unknownBoundTextures=!1;for(let e=0;e<r.length;e++)r[e]===this.unknownTexture&&this.bind(null,e)}for(let n=0;n<r.length;n++)r[n]===e&&(this.currentLocation!==n&&(t.activeTexture(t.TEXTURE0+n),this.currentLocation=n),t.bindTexture(e.target,this.emptyTextures[e.target].texture),r[n]=null)}ensureSamplerType(e){const{boundTextures:t,hasIntegerTextures:r,CONTEXT_UID:n}=this;if(r)for(let r=e-1;r>=0;--r){const e=t[r];e&&e._glTextures[n].samplerType!==f.FLOAT&&this.renderer.texture.unbind(e)}}initTexture(e){const t=new ti(this.gl.createTexture());return t.dirtyId=-1,e._glTextures[this.CONTEXT_UID]=t,this.managedTextures.push(e),e.on("dispose",this.destroyTexture,this),t}initTextureType(e,t){t.internalFormat=this.internalFormats[e.type]?.[e.format]??e.format,t.samplerType=this.samplerTypes[t.internalFormat]??f.FLOAT,2===this.webGLVersion&&e.type===c.HALF_FLOAT?t.type=this.gl.HALF_FLOAT:t.type=e.type}updateTexture(e){const t=e._glTextures[this.CONTEXT_UID];if(!t)return;const r=this.renderer;if(this.initTextureType(e,t),e.resource?.upload(r,e,t))t.samplerType!==f.FLOAT&&(this.hasIntegerTextures=!0);else{const n=e.realWidth,i=e.realHeight,o=r.gl;(t.width!==n||t.height!==i||t.dirtyId<0)&&(t.width=n,t.height=i,o.texImage2D(e.target,0,t.internalFormat,n,i,0,e.format,t.type,null))}e.dirtyStyleId!==t.dirtyStyleId&&this.updateTextureStyle(e),t.dirtyId=e.dirtyId}destroyTexture(e,t){const{gl:r}=this;if((e=e.castToBaseTexture())._glTextures[this.CONTEXT_UID]&&(this.unbind(e),r.deleteTexture(e._glTextures[this.CONTEXT_UID].texture),e.off("dispose",this.destroyTexture,this),delete e._glTextures[this.CONTEXT_UID],!t)){const t=this.managedTextures.indexOf(e);-1!==t&&Je(this.managedTextures,t,1)}}updateTextureStyle(e){const t=e._glTextures[this.CONTEXT_UID];t&&(e.mipmap!==y.POW2&&2===this.webGLVersion||e.isPowerOfTwo?t.mipmap=e.mipmap>=1:t.mipmap=!1,2===this.webGLVersion||e.isPowerOfTwo?t.wrapMode=e.wrapMode:t.wrapMode=p.CLAMP,e.resource?.style(this.renderer,e,t)||this.setStyle(e,t),t.dirtyStyleId=e.dirtyStyleId)}setStyle(e,t){const r=this.gl;if(t.mipmap&&e.mipmap!==y.ON_MANUAL&&r.generateMipmap(e.target),r.texParameteri(e.target,r.TEXTURE_WRAP_S,t.wrapMode),r.texParameteri(e.target,r.TEXTURE_WRAP_T,t.wrapMode),t.mipmap){r.texParameteri(e.target,r.TEXTURE_MIN_FILTER,e.scaleMode===d.LINEAR?r.LINEAR_MIPMAP_LINEAR:r.NEAREST_MIPMAP_NEAREST);const t=this.renderer.context.extensions.anisotropicFiltering;if(t&&e.anisotropicLevel>0&&e.scaleMode===d.LINEAR){const n=Math.min(e.anisotropicLevel,r.getParameter(t.MAX_TEXTURE_MAX_ANISOTROPY_EXT));r.texParameterf(e.target,t.TEXTURE_MAX_ANISOTROPY_EXT,n)}}else r.texParameteri(e.target,r.TEXTURE_MIN_FILTER,e.scaleMode===d.LINEAR?r.LINEAR:r.NEAREST);r.texParameteri(e.target,r.TEXTURE_MAG_FILTER,e.scaleMode===d.LINEAR?r.LINEAR:r.NEAREST)}destroy(){this.renderer=null}}ri.extension={type:gt.RendererSystem,name:"texture"},bt.add(ri);class ni{constructor(e){this.renderer=e}contextChange(){this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID}bind(e){const{gl:t,CONTEXT_UID:r}=this,n=e._glTransformFeedbacks[r]||this.createGLTransformFeedback(e);t.bindTransformFeedback(t.TRANSFORM_FEEDBACK,n)}unbind(){const{gl:e}=this;e.bindTransformFeedback(e.TRANSFORM_FEEDBACK,null)}beginTransformFeedback(e,t){const{gl:r,renderer:n}=this;t&&n.shader.bind(t),r.beginTransformFeedback(e)}endTransformFeedback(){const{gl:e}=this;e.endTransformFeedback()}createGLTransformFeedback(e){const{gl:t,renderer:r,CONTEXT_UID:n}=this,i=t.createTransformFeedback();e._glTransformFeedbacks[n]=i,t.bindTransformFeedback(t.TRANSFORM_FEEDBACK,i);for(let i=0;i<e.buffers.length;i++){const o=e.buffers[i];o&&(r.buffer.update(o),o._glBuffers[n].refCount++,t.bindBufferBase(t.TRANSFORM_FEEDBACK_BUFFER,i,o._glBuffers[n].buffer||null))}return t.bindTransformFeedback(t.TRANSFORM_FEEDBACK,null),e.disposeRunner.add(this),i}disposeTransformFeedback(e,t){const r=e._glTransformFeedbacks[this.CONTEXT_UID],n=this.gl;e.disposeRunner.remove(this);const i=this.renderer.buffer;if(i)for(let r=0;r<e.buffers.length;r++){const n=e.buffers[r];if(!n)continue;const o=n._glBuffers[this.CONTEXT_UID];o&&(o.refCount--,0===o.refCount&&!t&&i.dispose(n,t))}r&&(t||n.deleteTransformFeedback(r),delete e._glTransformFeedbacks[this.CONTEXT_UID])}destroy(){this.renderer=null}}ni.extension={type:gt.RendererSystem,name:"transformFeedback"},bt.add(ni);class ii{constructor(e){this.renderer=e}init(e){this.screen=new Kt(0,0,e.width,e.height),this.element=e.view||E.ADAPTER.createCanvas(),this.resolution=e.resolution||E.RESOLUTION,this.autoDensity=!!e.autoDensity}resizeView(e,t){this.element.width=Math.round(e*this.resolution),this.element.height=Math.round(t*this.resolution);const r=this.element.width/this.resolution,n=this.element.height/this.resolution;this.screen.width=r,this.screen.height=n,this.autoDensity&&(this.element.style.width=`${r}px`,this.element.style.height=`${n}px`),this.renderer.emit("resize",r,n),this.renderer.runners.resize.emit(this.screen.width,this.screen.height)}destroy(e){e&&this.element.parentNode?.removeChild(this.element),this.renderer=null,this.element=null,this.screen=null}}ii.defaultOptions={width:800,height:600,resolution:void 0,autoDensity:!1},ii.extension={type:[gt.RendererSystem,gt.CanvasRendererSystem],name:"_view"},bt.add(ii),E.PREFER_ENV=i.WEBGL2,E.STRICT_TEXTURE_CACHE=!1,E.RENDER_OPTIONS={...Gr.defaultOptions,...Ur.defaultOptions,...ii.defaultOptions,...Xn.defaultOptions},Object.defineProperties(E,{WRAP_MODE:{get:()=>Rt.defaultOptions.wrapMode,set(e){Y("7.1.0","settings.WRAP_MODE is deprecated, use BaseTexture.defaultOptions.wrapMode"),Rt.defaultOptions.wrapMode=e}},SCALE_MODE:{get:()=>Rt.defaultOptions.scaleMode,set(e){Y("7.1.0","settings.SCALE_MODE is deprecated, use BaseTexture.defaultOptions.scaleMode"),Rt.defaultOptions.scaleMode=e}},MIPMAP_TEXTURES:{get:()=>Rt.defaultOptions.mipmap,set(e){Y("7.1.0","settings.MIPMAP_TEXTURES is deprecated, use BaseTexture.defaultOptions.mipmap"),Rt.defaultOptions.mipmap=e}},ANISOTROPIC_LEVEL:{get:()=>Rt.defaultOptions.anisotropicLevel,set(e){Y("7.1.0","settings.ANISOTROPIC_LEVEL is deprecated, use BaseTexture.defaultOptions.anisotropicLevel"),Rt.defaultOptions.anisotropicLevel=e}},FILTER_RESOLUTION:{get:()=>(Y("7.1.0","settings.FILTER_RESOLUTION is deprecated, use Filter.defaultResolution"),Fr.defaultResolution),set(e){Fr.defaultResolution=e}},FILTER_MULTISAMPLE:{get:()=>(Y("7.1.0","settings.FILTER_MULTISAMPLE is deprecated, use Filter.defaultMultisample"),Fr.defaultMultisample),set(e){Fr.defaultMultisample=e}},SPRITE_MAX_TEXTURES:{get:()=>Br.defaultMaxTextures,set(e){Y("7.1.0","settings.SPRITE_MAX_TEXTURES is deprecated, use BatchRenderer.defaultMaxTextures"),Br.defaultMaxTextures=e}},SPRITE_BATCH_SIZE:{get:()=>Br.defaultBatchSize,set(e){Y("7.1.0","settings.SPRITE_BATCH_SIZE is deprecated, use BatchRenderer.defaultBatchSize"),Br.defaultBatchSize=e}},CAN_UPLOAD_SAME_BUFFER:{get:()=>Br.canUploadSameBuffer,set(e){Y("7.1.0","settings.CAN_UPLOAD_SAME_BUFFER is deprecated, use BatchRenderer.canUploadSameBuffer"),Br.canUploadSameBuffer=e}},GC_MODE:{get:()=>ei.defaultMode,set(e){Y("7.1.0","settings.GC_MODE is deprecated, use TextureGCSystem.defaultMode"),ei.defaultMode=e}},GC_MAX_IDLE:{get:()=>ei.defaultMaxIdle,set(e){Y("7.1.0","settings.GC_MAX_IDLE is deprecated, use TextureGCSystem.defaultMaxIdle"),ei.defaultMaxIdle=e}},GC_MAX_CHECK_COUNT:{get:()=>ei.defaultCheckCountMax,set(e){Y("7.1.0","settings.GC_MAX_CHECK_COUNT is deprecated, use TextureGCSystem.defaultCheckCountMax"),ei.defaultCheckCountMax=e}},PRECISION_VERTEX:{get:()=>Pr.defaultVertexPrecision,set(e){Y("7.1.0","settings.PRECISION_VERTEX is deprecated, use Program.defaultVertexPrecision"),Pr.defaultVertexPrecision=e}},PRECISION_FRAGMENT:{get:()=>Pr.defaultFragmentPrecision,set(e){Y("7.1.0","settings.PRECISION_FRAGMENT is deprecated, use Program.defaultFragmentPrecision"),Pr.defaultFragmentPrecision=e}}});var oi=(e=>(e[e.INTERACTION=50]="INTERACTION",e[e.HIGH=25]="HIGH",e[e.NORMAL=0]="NORMAL",e[e.LOW=-25]="LOW",e[e.UTILITY=-50]="UTILITY",e))(oi||{});class ai{constructor(e,t=null,r=0,n=!1){this.next=null,this.previous=null,this._destroyed=!1,this.fn=e,this.context=t,this.priority=r,this.once=n}match(e,t=null){return this.fn===e&&this.context===t}emit(e){this.fn&&(this.context?this.fn.call(this.context,e):this.fn(e));const t=this.next;return this.once&&this.destroy(!0),this._destroyed&&(this.next=null),t}connect(e){this.previous=e,e.next&&(e.next.previous=this),this.next=e.next,e.next=this}destroy(e=!1){this._destroyed=!0,this.fn=null,this.context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);const t=this.next;return this.next=e?null:t,this.previous=null,t}}const si=class e{constructor(){this.autoStart=!1,this.deltaTime=1,this.lastTime=-1,this.speed=1,this.started=!1,this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this._protected=!1,this._lastFrame=-1,this._head=new ai(null,null,1/0),this.deltaMS=1/e.targetFPMS,this.elapsedMS=1/e.targetFPMS,this._tick=e=>{this._requestId=null,this.started&&(this.update(e),this.started&&null===this._requestId&&this._head.next&&(this._requestId=requestAnimationFrame(this._tick)))}}_requestIfNeeded(){null===this._requestId&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))}_cancelIfNeeded(){null!==this._requestId&&(cancelAnimationFrame(this._requestId),this._requestId=null)}_startIfPossible(){this.started?this._requestIfNeeded():this.autoStart&&this.start()}add(e,t,r=oi.NORMAL){return this._addListener(new ai(e,t,r))}addOnce(e,t,r=oi.NORMAL){return this._addListener(new ai(e,t,r,!0))}_addListener(e){let t=this._head.next,r=this._head;if(t){for(;t;){if(e.priority>t.priority){e.connect(r);break}r=t,t=t.next}e.previous||e.connect(r)}else e.connect(r);return this._startIfPossible(),this}remove(e,t){let r=this._head.next;for(;r;)r=r.match(e,t)?r.destroy():r.next;return this._head.next||this._cancelIfNeeded(),this}get count(){if(!this._head)return 0;let e=0,t=this._head;for(;t=t.next;)e++;return e}start(){this.started||(this.started=!0,this._requestIfNeeded())}stop(){this.started&&(this.started=!1,this._cancelIfNeeded())}destroy(){if(!this._protected){this.stop();let e=this._head.next;for(;e;)e=e.destroy(!0);this._head.destroy(),this._head=null}}update(t=performance.now()){let r;if(t>this.lastTime){if(r=this.elapsedMS=t-this.lastTime,r>this._maxElapsedMS&&(r=this._maxElapsedMS),r*=this.speed,this._minElapsedMS){const e=t-this._lastFrame|0;if(e<this._minElapsedMS)return;this._lastFrame=t-e%this._minElapsedMS}this.deltaMS=r,this.deltaTime=this.deltaMS*e.targetFPMS;const n=this._head;let i=n.next;for(;i;)i=i.emit(this.deltaTime);n.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=t}get FPS(){return 1e3/this.elapsedMS}get minFPS(){return 1e3/this._maxElapsedMS}set minFPS(t){const r=Math.min(this.maxFPS,t),n=Math.min(Math.max(0,r)/1e3,e.targetFPMS);this._maxElapsedMS=1/n}get maxFPS(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0}set maxFPS(e){if(0===e)this._minElapsedMS=0;else{const t=Math.max(this.minFPS,e);this._minElapsedMS=1/(t/1e3)}}static get shared(){if(!e._shared){const t=e._shared=new e;t.autoStart=!0,t._protected=!0}return e._shared}static get system(){if(!e._system){const t=e._system=new e;t.autoStart=!0,t._protected=!0}return e._system}};si.targetFPMS=.06;let ui=si;Object.defineProperties(E,{TARGET_FPMS:{get:()=>ui.targetFPMS,set(e){Y("7.1.0","settings.TARGET_FPMS is deprecated, use Ticker.targetFPMS"),ui.targetFPMS=e}}});class li{static init(e){e=Object.assign({autoStart:!0,sharedTicker:!1},e),Object.defineProperty(this,"ticker",{set(e){this._ticker&&this._ticker.remove(this.render,this),this._ticker=e,e&&e.add(this.render,this,oi.LOW)},get(){return this._ticker}}),this.stop=()=>{this._ticker.stop()},this.start=()=>{this._ticker.start()},this._ticker=null,this.ticker=e.sharedTicker?ui.shared:new ui,e.autoStart&&this.start()}static destroy(){if(this._ticker){const e=this._ticker;this.ticker=null,e.destroy()}}}li.extension=gt.Application,bt.add(li);const hi=[];function ci(e){for(const t of hi)if(t.test(e))return new t(e);throw new Error("Unable to auto-detect a suitable renderer.")}bt.handleByList(gt.Renderer,hi);const fi="attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}",di="attribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord( void )\n{\n    return aVertexPosition * (outputFrame.zw * inputSize.zw);\n}\n\nvoid main(void)\n{\n    gl_Position = filterVertexPosition();\n    vTextureCoord = filterTextureCoord();\n}\n";class pi{constructor(e){this.renderer=e}contextChange(e){let t;if(1===this.renderer.context.webGLVersion){const r=e.getParameter(e.FRAMEBUFFER_BINDING);e.bindFramebuffer(e.FRAMEBUFFER,null),t=e.getParameter(e.SAMPLES),e.bindFramebuffer(e.FRAMEBUFFER,r)}else{const r=e.getParameter(e.DRAW_FRAMEBUFFER_BINDING);e.bindFramebuffer(e.DRAW_FRAMEBUFFER,null),t=e.getParameter(e.SAMPLES),e.bindFramebuffer(e.DRAW_FRAMEBUFFER,r)}t>=_.HIGH?this.multisample=_.HIGH:t>=_.MEDIUM?this.multisample=_.MEDIUM:t>=_.LOW?this.multisample=_.LOW:this.multisample=_.NONE}destroy(){}}pi.extension={type:gt.RendererSystem,name:"_multisample"},bt.add(pi);class yi{constructor(e){this.buffer=e||null,this.updateID=-1,this.byteLength=-1,this.refCount=0}}class mi{constructor(e){this.renderer=e,this.managedBuffers={},this.boundBufferBases={}}destroy(){this.renderer=null}contextChange(){this.disposeAll(!0),this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID}bind(e){const{gl:t,CONTEXT_UID:r}=this,n=e._glBuffers[r]||this.createGLBuffer(e);t.bindBuffer(e.type,n.buffer)}unbind(e){const{gl:t}=this;t.bindBuffer(e,null)}bindBufferBase(e,t){const{gl:r,CONTEXT_UID:n}=this;if(this.boundBufferBases[t]!==e){const i=e._glBuffers[n]||this.createGLBuffer(e);this.boundBufferBases[t]=e,r.bindBufferBase(r.UNIFORM_BUFFER,t,i.buffer)}}bindBufferRange(e,t,r){const{gl:n,CONTEXT_UID:i}=this;r=r||0;const o=e._glBuffers[i]||this.createGLBuffer(e);n.bindBufferRange(n.UNIFORM_BUFFER,t||0,o.buffer,256*r,256)}update(e){const{gl:t,CONTEXT_UID:r}=this,n=e._glBuffers[r]||this.createGLBuffer(e);if(e._updateID!==n.updateID)if(n.updateID=e._updateID,t.bindBuffer(e.type,n.buffer),n.byteLength>=e.data.byteLength)t.bufferSubData(e.type,0,e.data);else{const r=e.static?t.STATIC_DRAW:t.DYNAMIC_DRAW;n.byteLength=e.data.byteLength,t.bufferData(e.type,e.data,r)}}dispose(e,t){if(!this.managedBuffers[e.id])return;delete this.managedBuffers[e.id];const r=e._glBuffers[this.CONTEXT_UID],n=this.gl;e.disposeRunner.remove(this),r&&(t||n.deleteBuffer(r.buffer),delete e._glBuffers[this.CONTEXT_UID])}disposeAll(e){const t=Object.keys(this.managedBuffers);for(let r=0;r<t.length;r++)this.dispose(this.managedBuffers[t[r]],e)}createGLBuffer(e){const{CONTEXT_UID:t,gl:r}=this;return e._glBuffers[t]=new yi(r.createBuffer()),this.managedBuffers[e.id]=e,e.disposeRunner.add(this),e._glBuffers[t]}}mi.extension={type:gt.RendererSystem,name:"buffer"},bt.add(mi);class gi{constructor(e){this.renderer=e}render(e,t){const r=this.renderer;let n,i,o,a;if(t&&(n=t.renderTexture,i=t.clear,o=t.transform,a=t.skipUpdateTransform),this.renderingToScreen=!n,r.runners.prerender.emit(),r.emit("prerender"),r.projection.transform=o,!r.context.isLost){if(n||(this.lastObjectRendered=e),!a){const t=e.enableTempParent();e.updateTransform(),e.disableTempParent(t)}r.renderTexture.bind(n),r.batch.currentRenderer.start(),(i??r.background.clearBeforeRender)&&r.renderTexture.clear(),e.render(r),r.batch.currentRenderer.flush(),n&&(t.blit&&r.framebuffer.blit(),n.baseTexture.update()),r.runners.postrender.emit(),r.projection.transform=null,r.emit("postrender")}}destroy(){this.renderer=null,this.lastObjectRendered=null}}gi.extension={type:gt.RendererSystem,name:"objectRenderer"},bt.add(gi);const wi=class e extends Jn{constructor(t){super(),this.type=o.WEBGL,t=Object.assign({},E.RENDER_OPTIONS,t),this.gl=null,this.CONTEXT_UID=0,this.globalUniforms=new Cr({projectionMatrix:new tr},!0);const r={runners:["init","destroy","contextChange","resolutionChange","reset","update","postrender","prerender","resize"],systems:e.__systems,priority:["_view","textureGenerator","background","_plugin","startup","context","state","texture","buffer","geometry","framebuffer","transformFeedback","mask","scissor","stencil","projection","textureGC","filter","renderTexture","batch","objectRenderer","_multisample"]};this.setup(r),"useContextAlpha"in t&&(Y("7.0.0","options.useContextAlpha is deprecated, use options.premultipliedAlpha and options.backgroundAlpha instead"),t.premultipliedAlpha=t.useContextAlpha&&"notMultiplied"!==t.useContextAlpha,t.backgroundAlpha=!1===t.useContextAlpha?1:t.backgroundAlpha),this._plugin.rendererPlugins=e.__plugins,this.options=t,this.startup.run(this.options)}static test(e){return!e?.forceCanvas&&ie()}render(e,t){this.objectRenderer.render(e,t)}resize(e,t){this._view.resizeView(e,t)}reset(){return this.runners.reset.emit(),this}clear(){this.renderTexture.bind(),this.renderTexture.clear()}destroy(e=!1){this.runners.destroy.items.reverse(),this.emitWithCustomOptions(this.runners.destroy,{_view:e}),super.destroy()}get plugins(){return this._plugin.plugins}get multisample(){return this._multisample.multisample}get width(){return this._view.element.width}get height(){return this._view.element.height}get resolution(){return this._view.resolution}set resolution(e){this._view.resolution=e,this.runners.resolutionChange.emit(e)}get autoDensity(){return this._view.autoDensity}get view(){return this._view.element}get screen(){return this._view.screen}get lastObjectRendered(){return this.objectRenderer.lastObjectRendered}get renderingToScreen(){return this.objectRenderer.renderingToScreen}get rendererLogId(){return`WebGL ${this.context.webGLVersion}`}get clearBeforeRender(){return Y("7.0.0","renderer.clearBeforeRender has been deprecated, please use renderer.background.clearBeforeRender instead."),this.background.clearBeforeRender}get useContextAlpha(){return Y("7.0.0","renderer.useContextAlpha has been deprecated, please use renderer.context.premultipliedAlpha instead."),this.context.useContextAlpha}get preserveDrawingBuffer(){return Y("7.0.0","renderer.preserveDrawingBuffer has been deprecated, we cannot truly know this unless pixi created the context"),this.context.preserveDrawingBuffer}get backgroundColor(){return Y("7.0.0","renderer.backgroundColor has been deprecated, use renderer.background.color instead."),this.background.color}set backgroundColor(e){Y("7.0.0","renderer.backgroundColor has been deprecated, use renderer.background.color instead."),this.background.color=e}get backgroundAlpha(){return Y("7.0.0","renderer.backgroundAlpha has been deprecated, use renderer.background.alpha instead."),this.background.alpha}set backgroundAlpha(e){Y("7.0.0","renderer.backgroundAlpha has been deprecated, use renderer.background.alpha instead."),this.background.alpha=e}get powerPreference(){return Y("7.0.0","renderer.powerPreference has been deprecated, we can only know this if pixi creates the context"),this.context.powerPreference}generateTexture(e,t){return this.textureGenerator.generateTexture(e,t)}};wi.extension={type:gt.Renderer,priority:1},wi.__plugins={},wi.__systems={};let vi=wi;bt.handleByMap(gt.RendererPlugin,vi.__plugins),bt.handleByMap(gt.RendererSystem,vi.__systems),bt.add(vi);class bi extends Pt{constructor(e,t){const{width:r,height:n}=t||{};super(r,n),this.items=[],this.itemDirtyIds=[];for(let t=0;t<e;t++){const e=new Rt;this.items.push(e),this.itemDirtyIds.push(-2)}this.length=e,this._load=null,this.baseTexture=null}initFromArray(e,t){for(let r=0;r<this.length;r++)e[r]&&(e[r].castToBaseTexture?this.addBaseTextureAt(e[r].castToBaseTexture(),r):e[r]instanceof Pt?this.addResourceAt(e[r],r):this.addResourceAt(At(e[r],t),r))}dispose(){for(let e=0,t=this.length;e<t;e++)this.items[e].destroy();this.items=null,this.itemDirtyIds=null,this._load=null}addResourceAt(e,t){if(!this.items[t])throw new Error(`Index ${t} is out of bounds`);return e.valid&&!this.valid&&this.resize(e.width,e.height),this.items[t].setResource(e),this}bind(e){if(null!==this.baseTexture)throw new Error("Only one base texture per TextureArray is allowed");super.bind(e);for(let t=0;t<this.length;t++)this.items[t].parentTextureArray=e,this.items[t].on("update",e.update,e)}unbind(e){super.unbind(e);for(let t=0;t<this.length;t++)this.items[t].parentTextureArray=null,this.items[t].off("update",e.update,e)}load(){if(this._load)return this._load;const e=this.items.map((e=>e.resource)).filter((e=>e)).map((e=>e.load()));return this._load=Promise.all(e).then((()=>{const{realWidth:e,realHeight:t}=this.items[0];return this.resize(e,t),this.update(),Promise.resolve(this)})),this._load}}class xi extends bi{constructor(e,t){const{width:r,height:n}=t||{};let i,o;Array.isArray(e)?(i=e,o=e.length):o=e,super(o,{width:r,height:n}),i&&this.initFromArray(i,t)}addBaseTextureAt(e,t){if(!e.resource)throw new Error("ArrayResource does not support RenderTexture");return this.addResourceAt(e.resource,t),this}bind(e){super.bind(e),e.target=h.TEXTURE_2D_ARRAY}upload(e,t,r){const{length:n,itemDirtyIds:i,items:o}=this,{gl:a}=e;r.dirtyId<0&&a.texImage3D(a.TEXTURE_2D_ARRAY,0,r.internalFormat,this._width,this._height,n,0,t.format,r.type,null);for(let e=0;e<n;e++){const n=o[e];i[e]<n.dirtyId&&(i[e]=n.dirtyId,n.valid&&a.texSubImage3D(a.TEXTURE_2D_ARRAY,0,0,0,e,n.resource.width,n.resource.height,1,t.format,r.type,n.resource.source))}return!0}}class _i extends Hr{constructor(e){super(e)}static test(e){const{OffscreenCanvas:t}=globalThis;return!!(t&&e instanceof t)||globalThis.HTMLCanvasElement&&e instanceof HTMLCanvasElement}}const Si=class e extends bi{constructor(t,r){const{width:n,height:i,autoLoad:o,linkBaseTexture:a}=r||{};if(t&&t.length!==e.SIDES)throw new Error(`Invalid length. Got ${t.length}, expected 6`);super(6,{width:n,height:i});for(let t=0;t<e.SIDES;t++)this.items[t].target=h.TEXTURE_CUBE_MAP_POSITIVE_X+t;this.linkBaseTexture=!1!==a,t&&this.initFromArray(t,r),!1!==o&&this.load()}bind(e){super.bind(e),e.target=h.TEXTURE_CUBE_MAP}addBaseTextureAt(e,t,r){if(void 0===r&&(r=this.linkBaseTexture),!this.items[t])throw new Error(`Index ${t} is out of bounds`);if(!this.linkBaseTexture||e.parentTextureArray||Object.keys(e._glTextures).length>0){if(!e.resource)throw new Error("CubeResource does not support copying of renderTexture.");this.addResourceAt(e.resource,t)}else e.target=h.TEXTURE_CUBE_MAP_POSITIVE_X+t,e.parentTextureArray=this.baseTexture,this.items[t]=e;return e.valid&&!this.valid&&this.resize(e.realWidth,e.realHeight),this.items[t]=e,this}upload(t,r,n){const i=this.itemDirtyIds;for(let o=0;o<e.SIDES;o++){const e=this.items[o];(i[o]<e.dirtyId||n.dirtyId<r.dirtyId)&&(e.valid&&e.resource?(e.resource.upload(t,e,n),i[o]=e.dirtyId):i[o]<-1&&(t.gl.texImage2D(e.target,0,n.internalFormat,r.realWidth,r.realHeight,0,r.format,n.type,null),i[o]=-1))}return!0}static test(t){return Array.isArray(t)&&t.length===e.SIDES}};Si.SIDES=6;let Ti=Si;class Ei extends Hr{constructor(e,t){let r,n,i;t=t||{},"string"==typeof e?(r=Ei.EMPTY,n=e,i=!0):(r=e,n=null,i=!1),super(r),this.url=n,this.crossOrigin=t.crossOrigin??!0,this.alphaMode="number"==typeof t.alphaMode?t.alphaMode:null,this.ownsImageBitmap=t.ownsImageBitmap??i,this._load=null,!1!==t.autoLoad&&this.load()}load(){return this._load||(this._load=new Promise((async(e,t)=>{if(null!==this.url)try{const t=await E.ADAPTER.fetch(this.url,{mode:this.crossOrigin?"cors":"no-cors"});if(this.destroyed)return;const r=await t.blob();if(this.destroyed)return;const n=await createImageBitmap(r,{premultiplyAlpha:null===this.alphaMode||this.alphaMode===m.UNPACK?"premultiply":"none"});if(this.destroyed)return void n.close();this.source=n,this.update(),e(this)}catch(e){if(this.destroyed)return;t(e),this.onError.emit(e)}else e(this)}))),this._load}upload(e,t,r){return this.source instanceof ImageBitmap?("number"==typeof this.alphaMode&&(t.alphaMode=this.alphaMode),super.upload(e,t,r)):(this.load(),!1)}dispose(){this.ownsImageBitmap&&this.source instanceof ImageBitmap&&this.source.close(),super.dispose(),this._load=null}static test(e){return!!globalThis.createImageBitmap&&typeof ImageBitmap<"u"&&("string"==typeof e||e instanceof ImageBitmap)}static get EMPTY(){return Ei._EMPTY=Ei._EMPTY??E.ADAPTER.createCanvas(0,0),Ei._EMPTY}}const Oi=class e extends Hr{constructor(e,t){t=t||{},super(E.ADAPTER.createCanvas()),this._width=0,this._height=0,this.svg=e,this.scale=t.scale||1,this._overrideWidth=t.width,this._overrideHeight=t.height,this._resolve=null,this._crossorigin=t.crossorigin,this._load=null,!1!==t.autoLoad&&this.load()}load(){return this._load||(this._load=new Promise((t=>{if(this._resolve=()=>{this.update(),t(this)},e.SVG_XML.test(this.svg.trim())){if(!btoa)throw new Error("Your browser doesn't support base64 conversions.");this.svg=`data:image/svg+xml;base64,${btoa(unescape(encodeURIComponent(this.svg)))}`}this._loadSvg()}))),this._load}_loadSvg(){const e=new Image;Hr.crossOrigin(e,this.svg,this._crossorigin),e.src=this.svg,e.onerror=t=>{this._resolve&&(e.onerror=null,this.onError.emit(t))},e.onload=()=>{if(!this._resolve)return;const t=e.width,r=e.height;if(!t||!r)throw new Error("The SVG image must have width and height defined (in pixels), canvas API needs them.");let n=t*this.scale,i=r*this.scale;(this._overrideWidth||this._overrideHeight)&&(n=this._overrideWidth||this._overrideHeight/r*t,i=this._overrideHeight||this._overrideWidth/t*r),n=Math.round(n),i=Math.round(i);const o=this.source;o.width=n,o.height=i,o._pixiId=`canvas_${tt()}`,o.getContext("2d").drawImage(e,0,0,t,r,0,0,n,i),this._resolve(),this._resolve=null}}static getSize(t){const r=e.SVG_SIZE.exec(t),n={};return r&&(n[r[1]]=Math.round(parseFloat(r[3])),n[r[5]]=Math.round(parseFloat(r[7]))),n}dispose(){super.dispose(),this._resolve=null,this._crossorigin=null}static test(t,r){return"svg"===r||"string"==typeof t&&t.startsWith("data:image/svg+xml")||"string"==typeof t&&e.SVG_XML.test(t)}};Oi.SVG_XML=/^(<\?xml[^?]+\?>)?\s*(<!--[^(-->)]*-->)?\s*\<svg/m,Oi.SVG_SIZE=/<svg[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*>/i;let Ai=Oi;const Ii=class e extends Hr{constructor(t,r){if(r=r||{},!(t instanceof HTMLVideoElement)){const n=document.createElement("video");!1!==r.autoLoad&&n.setAttribute("preload","auto"),!1!==r.playsinline&&(n.setAttribute("webkit-playsinline",""),n.setAttribute("playsinline","")),!0===r.muted&&(n.setAttribute("muted",""),n.muted=!0),!0===r.loop&&n.setAttribute("loop",""),!1!==r.autoPlay&&n.setAttribute("autoplay",""),"string"==typeof t&&(t=[t]);const i=t[0].src||t[0];Hr.crossOrigin(n,i,r.crossorigin);for(let r=0;r<t.length;++r){const i=document.createElement("source");let{src:o,mime:a}=t[r];if(o=o||t[r],o.startsWith("data:"))a=o.slice(5,o.indexOf(";"));else if(!o.startsWith("blob:")){const t=o.split("?").shift().toLowerCase(),r=t.slice(t.lastIndexOf(".")+1);a=a||e.MIME_TYPES[r]||`video/${r}`}i.src=o,a&&(i.type=a),n.appendChild(i)}t=n}super(t),this.noSubImage=!0,this._autoUpdate=!0,this._isConnectedToTicker=!1,this._updateFPS=r.updateFPS||0,this._msToNextUpdate=0,this.autoPlay=!1!==r.autoPlay,this._videoFrameRequestCallback=this._videoFrameRequestCallback.bind(this),this._videoFrameRequestCallbackHandle=null,this._load=null,this._resolve=null,this._reject=null,this._onCanPlay=this._onCanPlay.bind(this),this._onError=this._onError.bind(this),this._onPlayStart=this._onPlayStart.bind(this),this._onPlayStop=this._onPlayStop.bind(this),this._onSeeked=this._onSeeked.bind(this),!1!==r.autoLoad&&this.load()}update(e=0){if(!this.destroyed){if(this._updateFPS){const e=ui.shared.elapsedMS*this.source.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-e)}(!this._updateFPS||this._msToNextUpdate<=0)&&(super.update(),this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0)}}_videoFrameRequestCallback(){this.update(),this.destroyed?this._videoFrameRequestCallbackHandle=null:this._videoFrameRequestCallbackHandle=this.source.requestVideoFrameCallback(this._videoFrameRequestCallback)}load(){if(this._load)return this._load;const e=this.source;return(e.readyState===e.HAVE_ENOUGH_DATA||e.readyState===e.HAVE_FUTURE_DATA)&&e.width&&e.height&&(e.complete=!0),e.addEventListener("play",this._onPlayStart),e.addEventListener("pause",this._onPlayStop),e.addEventListener("seeked",this._onSeeked),this._isSourceReady()?this._onCanPlay():(e.addEventListener("canplay",this._onCanPlay),e.addEventListener("canplaythrough",this._onCanPlay),e.addEventListener("error",this._onError,!0)),this._load=new Promise(((t,r)=>{this.valid?t(this):(this._resolve=t,this._reject=r,e.load())})),this._load}_onError(e){this.source.removeEventListener("error",this._onError,!0),this.onError.emit(e),this._reject&&(this._reject(e),this._reject=null,this._resolve=null)}_isSourcePlaying(){const e=this.source;return!e.paused&&!e.ended}_isSourceReady(){return this.source.readyState>2}_onPlayStart(){this.valid||this._onCanPlay(),this._configureAutoUpdate()}_onPlayStop(){this._configureAutoUpdate()}_onSeeked(){this._autoUpdate&&!this._isSourcePlaying()&&(this._msToNextUpdate=0,this.update(),this._msToNextUpdate=0)}_onCanPlay(){const e=this.source;e.removeEventListener("canplay",this._onCanPlay),e.removeEventListener("canplaythrough",this._onCanPlay);const t=this.valid;this._msToNextUpdate=0,this.update(),this._msToNextUpdate=0,!t&&this._resolve&&(this._resolve(this),this._resolve=null,this._reject=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&e.play()}dispose(){this._configureAutoUpdate();const e=this.source;e&&(e.removeEventListener("play",this._onPlayStart),e.removeEventListener("pause",this._onPlayStop),e.removeEventListener("seeked",this._onSeeked),e.removeEventListener("canplay",this._onCanPlay),e.removeEventListener("canplaythrough",this._onCanPlay),e.removeEventListener("error",this._onError,!0),e.pause(),e.src="",e.load()),super.dispose()}get autoUpdate(){return this._autoUpdate}set autoUpdate(e){e!==this._autoUpdate&&(this._autoUpdate=e,this._configureAutoUpdate())}get updateFPS(){return this._updateFPS}set updateFPS(e){e!==this._updateFPS&&(this._updateFPS=e,this._configureAutoUpdate())}_configureAutoUpdate(){this._autoUpdate&&this._isSourcePlaying()?!this._updateFPS&&this.source.requestVideoFrameCallback?(this._isConnectedToTicker&&(ui.shared.remove(this.update,this),this._isConnectedToTicker=!1,this._msToNextUpdate=0),null===this._videoFrameRequestCallbackHandle&&(this._videoFrameRequestCallbackHandle=this.source.requestVideoFrameCallback(this._videoFrameRequestCallback))):(null!==this._videoFrameRequestCallbackHandle&&(this.source.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),this._videoFrameRequestCallbackHandle=null),this._isConnectedToTicker||(ui.shared.add(this.update,this),this._isConnectedToTicker=!0,this._msToNextUpdate=0)):(null!==this._videoFrameRequestCallbackHandle&&(this.source.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),this._videoFrameRequestCallbackHandle=null),this._isConnectedToTicker&&(ui.shared.remove(this.update,this),this._isConnectedToTicker=!1,this._msToNextUpdate=0))}static test(t,r){return globalThis.HTMLVideoElement&&t instanceof HTMLVideoElement||e.TYPES.includes(r)}};Ii.TYPES=["mp4","m4v","webm","ogg","ogv","h264","avi","mov"],Ii.MIME_TYPES={ogv:"video/ogg",mov:"video/quicktime",m4v:"video/mp4"};let Pi=Ii;Ot.push(Ei,qr,_i,Pi,class extends Hr{constructor(e){super(e)}static test(e){return!!globalThis.VideoFrame&&e instanceof globalThis.VideoFrame}},Ai,kt,Ti,xi);class ki{constructor(){this._glTransformFeedbacks={},this.buffers=[],this.disposeRunner=new It("disposeTransformFeedback")}bindBuffer(e,t){this.buffers[e]=t}destroy(){this.disposeRunner.emit(this,!1)}}const Ci="7.4.2"},4486:(e,t,r)=>{r.d(t,{b:()=>n});var n=r(228)},7734:(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{_K:()=>ee,qY:()=>Ne,wV:()=>Md});var process=__webpack_require__(5606),Buffer=__webpack_require__(8287).hp,Bd=Object.create,kn=Object.defineProperty,$d=Object.getOwnPropertyDescriptor,kd=Object.getOwnPropertyNames,Nd=Object.getPrototypeOf,Rd=Object.prototype.hasOwnProperty,D=(e,t)=>()=>(e&&(t=e(e=0)),t),ye=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),pr=(e,t)=>{for(var r in t)kn(e,r,{get:t[r],enumerable:!0})},Qa=(e,t,r,n)=>{if(t&&"object"==typeof t||"function"==typeof t)for(let i of kd(t))!Rd.call(e,i)&&i!==r&&kn(e,i,{get:()=>t[i],enumerable:!(n=$d(t,i))||n.enumerable});return e},Nr=(e,t,r)=>(r=null!=e?Bd(Nd(e)):{},Qa(!t&&e&&e.__esModule?r:kn(r,"default",{value:e,enumerable:!0}),e)),jt=e=>Qa(kn({},"__esModule",{value:!0}),e),Nn,dr,hr,Rn,Mn=D((()=>{Nn=new Map,dr=[],hr=(e,t,r)=>{if(!t||"function"!=typeof t.init||"function"!=typeof t.createInferenceSessionHandler)throw new TypeError("not a valid backend");{let n=Nn.get(e);if(void 0===n)Nn.set(e,{backend:t,priority:r});else{if(n.priority>r)return;if(n.priority===r&&n.backend!==t)throw new Error(`cannot register backend "${e}" using priority ${r}`)}if(r>=0){let t=dr.indexOf(e);-1!==t&&dr.splice(t,1);for(let t=0;t<dr.length;t++)if(Nn.get(dr[t]).priority<=r)return void dr.splice(t,0,e);dr.push(e)}}},Rn=async e=>{let t=0===e.length?dr:e,r=[];for(let e of t){let t=Nn.get(e);if(t){if(t.initialized)return t.backend;if(t.aborted)continue;let n=!!t.initPromise;try{return n||(t.initPromise=t.backend.init(e)),await t.initPromise,t.initialized=!0,t.backend}catch(i){n||r.push({name:e,err:i}),t.aborted=!0}finally{delete t.initPromise}}}throw new Error(`no available backend found. ERR: ${r.map((e=>`[${e.name}] ${e.err}`)).join(", ")}`)}})),es=D((()=>{Mn()})),ts,rs=D((()=>{ts="1.17.0"})),ns,mr,Jo=D((()=>{rs(),ns="warning",mr={wasm:{},webgl:{},webgpu:{},versions:{common:ts},set logLevel(e){if(void 0!==e){if("string"!=typeof e||-1===["verbose","info","warning","error","fatal"].indexOf(e))throw new Error(`Unsupported logging level: ${e}`);ns=e}},get logLevel(){return ns}},Object.defineProperty(mr,"logLevel",{enumerable:!0})})),ee,os=D((()=>{Jo(),ee=mr})),is,as,ss=D((()=>{is=(e,t)=>{let r=typeof document<"u"?document.createElement("canvas"):new OffscreenCanvas(1,1);r.width=e.dims[3],r.height=e.dims[2];let n=r.getContext("2d");if(null!=n){let i,o;void 0!==t?.tensorLayout&&"NHWC"===t.tensorLayout?(i=e.dims[2],o=e.dims[3]):(i=e.dims[3],o=e.dims[2]);let a,s,u=void 0!==t?.format?t.format:"RGB",l=t?.norm;void 0===l||void 0===l.mean?a=[255,255,255,255]:"number"==typeof l.mean?a=[l.mean,l.mean,l.mean,l.mean]:(a=[l.mean[0],l.mean[1],l.mean[2],0],void 0!==l.mean[3]&&(a[3]=l.mean[3])),void 0===l||void 0===l.bias?s=[0,0,0,0]:"number"==typeof l.bias?s=[l.bias,l.bias,l.bias,l.bias]:(s=[l.bias[0],l.bias[1],l.bias[2],0],void 0!==l.bias[3]&&(s[3]=l.bias[3]));let h=o*i,c=0,f=h,d=2*h,p=-1;"RGBA"===u?(c=0,f=h,d=2*h,p=3*h):"RGB"===u?(c=0,f=h,d=2*h):"RBG"===u&&(c=0,d=h,f=2*h);for(let t=0;t<o;t++)for(let r=0;r<i;r++){let i=(e.data[c++]-s[0])*a[0],o=(e.data[f++]-s[1])*a[1],u=(e.data[d++]-s[2])*a[2],l=-1===p?255:(e.data[p++]-s[3])*a[3];n.fillStyle="rgba("+i+","+o+","+u+","+l+")",n.fillRect(r,t,1,1)}if("toDataURL"in r)return r.toDataURL();throw new Error("toDataURL is not supported")}throw new Error("Can not access image data")},as=(e,t)=>{let r,n=typeof document<"u"?document.createElement("canvas").getContext("2d"):new OffscreenCanvas(1,1).getContext("2d");if(null==n)throw new Error("Can not access image data");{let i,o,a;void 0!==t?.tensorLayout&&"NHWC"===t.tensorLayout?(i=e.dims[2],o=e.dims[1],a=e.dims[3]):(i=e.dims[3],o=e.dims[2],a=e.dims[1]);let s,u,l=void 0!==t&&void 0!==t.format?t.format:"RGB",h=t?.norm;void 0===h||void 0===h.mean?s=[255,255,255,255]:"number"==typeof h.mean?s=[h.mean,h.mean,h.mean,h.mean]:(s=[h.mean[0],h.mean[1],h.mean[2],255],void 0!==h.mean[3]&&(s[3]=h.mean[3])),void 0===h||void 0===h.bias?u=[0,0,0,0]:"number"==typeof h.bias?u=[h.bias,h.bias,h.bias,h.bias]:(u=[h.bias[0],h.bias[1],h.bias[2],0],void 0!==h.bias[3]&&(u[3]=h.bias[3]));let c=o*i;if(void 0!==t&&(void 0!==t.format&&4===a&&"RGBA"!==t.format||3===a&&"RGB"!==t.format&&"BGR"!==t.format))throw new Error("Tensor format doesn't match input tensor dims");let f=4,d=0,p=1,y=2,m=3,g=0,w=c,v=2*c,b=-1;"RGBA"===l?(g=0,w=c,v=2*c,b=3*c):"RGB"===l?(g=0,w=c,v=2*c):"RBG"===l&&(g=0,v=c,w=2*c),r=n.createImageData(i,o);for(let t=0;t<o*i;d+=f,p+=f,y+=f,m+=f,t++)r.data[d]=(e.data[g++]-u[0])*s[0],r.data[p]=(e.data[w++]-u[1])*s[1],r.data[y]=(e.data[v++]-u[2])*s[2],r.data[m]=-1===b?255:(e.data[b++]-u[3])*s[3]}return r}})),Zo,us,ls,fs,cs,ps=D((()=>{Gn(),Zo=(e,t)=>{if(void 0===e)throw new Error("Image buffer must be defined");if(void 0===t.height||void 0===t.width)throw new Error("Image height and width must be defined");if("NHWC"===t.tensorLayout)throw new Error("NHWC Tensor layout is not supported yet");let r,n,{height:i,width:o}=t,a=t.norm??{mean:255,bias:0};r="number"==typeof a.mean?[a.mean,a.mean,a.mean,a.mean]:[a.mean[0],a.mean[1],a.mean[2],a.mean[3]??255],n="number"==typeof a.bias?[a.bias,a.bias,a.bias,a.bias]:[a.bias[0],a.bias[1],a.bias[2],a.bias[3]??0];let s=void 0!==t.format?t.format:"RGBA",u=void 0!==t.tensorFormat&&void 0!==t.tensorFormat?t.tensorFormat:"RGB",l=i*o,h="RGBA"===u?new Float32Array(4*l):new Float32Array(3*l),c=4,f=0,d=1,p=2,y=3,m=0,g=l,w=2*l,v=-1;"RGB"===s&&(c=3,f=0,d=1,p=2,y=-1),"RGBA"===u?v=3*l:"RBG"===u?(m=0,w=l,g=2*l):"BGR"===u&&(w=0,g=l,m=2*l);for(let t=0;t<l;t++,f+=c,p+=c,d+=c,y+=c)h[m++]=(e[f]+n[0])/r[0],h[g++]=(e[d]+n[1])/r[1],h[w++]=(e[p]+n[2])/r[2],-1!==v&&-1!==y&&(h[v++]=(e[y]+n[3])/r[3]);return new Ye("float32",h,"RGBA"===u?[1,4,i,o]:[1,3,i,o])},us=async(e,t)=>{let r,n=typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement,i=typeof ImageData<"u"&&e instanceof ImageData,o=typeof ImageBitmap<"u"&&e instanceof ImageBitmap,a="string"==typeof e,s=t??{},u=()=>{if(typeof document<"u")return document.createElement("canvas");if(typeof OffscreenCanvas<"u")return new OffscreenCanvas(1,1);throw new Error("Canvas is not supported")},l=e=>e instanceof HTMLCanvasElement||e instanceof OffscreenCanvas?e.getContext("2d"):null;if(n){let n=u();n.width=e.width,n.height=e.height;let i=l(n);if(null==i)throw new Error("Can not access image data");{let n=e.height,o=e.width;if(void 0!==t&&void 0!==t.resizedHeight&&void 0!==t.resizedWidth&&(n=t.resizedHeight,o=t.resizedWidth),void 0!==t){if(s=t,void 0!==t.tensorFormat)throw new Error("Image input config format must be RGBA for HTMLImageElement");s.tensorFormat="RGBA",s.height=n,s.width=o}else s.tensorFormat="RGBA",s.height=n,s.width=o;i.drawImage(e,0,0),r=i.getImageData(0,0,o,n).data}}else{if(!i){if(o){if(void 0===t)throw new Error("Please provide image config with format for Imagebitmap");let n=u();n.width=e.width,n.height=e.height;let i=l(n);if(null!=i){let t=e.height,n=e.width;return i.drawImage(e,0,0,n,t),r=i.getImageData(0,0,n,t).data,s.height=t,s.width=n,Zo(r,s)}throw new Error("Can not access image data")}if(a)return new Promise(((t,r)=>{let n=u(),i=l(n);if(!e||!i)return r();let o=new Image;o.crossOrigin="Anonymous",o.src=e,o.onload=()=>{n.width=o.width,n.height=o.height,i.drawImage(o,0,0,n.width,n.height);let e=i.getImageData(0,0,n.width,n.height);s.height=n.height,s.width=n.width,t(Zo(e.data,s))}}));throw new Error("Input data provided is not supported - aborted tensor creation")}{let n,i;if(void 0!==t&&void 0!==t.resizedWidth&&void 0!==t.resizedHeight?(n=t.resizedHeight,i=t.resizedWidth):(n=e.height,i=e.width),void 0!==t&&(s=t),s.format="RGBA",s.height=n,s.width=i,void 0!==t){let t=u();t.width=i,t.height=n;let o=l(t);if(null==o)throw new Error("Can not access image data");o.putImageData(e,0,0),r=o.getImageData(0,0,i,n).data}else r=e.data}}if(void 0!==r)return Zo(r,s);throw new Error("Input data provided is not supported - aborted tensor creation")},ls=(e,t)=>{let{width:r,height:n,download:i,dispose:o}=t;return new Ye({location:"texture",type:"float32",texture:e,dims:[1,n,r,4],download:i,dispose:o})},fs=(e,t)=>{let{dataType:r,dims:n,download:i,dispose:o}=t;return new Ye({location:"gpu-buffer",type:r??"float32",gpuBuffer:e,dims:n,download:i,dispose:o})},cs=(e,t,r)=>new Ye({location:"cpu-pinned",type:e,data:t,dims:r??[t.length]})})),sn,Un,ds,hs,ms=D((()=>{sn=new Map([["float32",Float32Array],["uint8",Uint8Array],["int8",Int8Array],["uint16",Uint16Array],["float16",Uint16Array],["int16",Int16Array],["int32",Int32Array],["bool",Uint8Array],["float64",Float64Array],["uint32",Uint32Array]]),Un=new Map([[Float32Array,"float32"],[Uint8Array,"uint8"],[Int8Array,"int8"],[Uint16Array,"uint16"],[Int16Array,"int16"],[Int32Array,"int32"],[Float64Array,"float64"],[Uint32Array,"uint32"]]),ds=!1,hs=()=>{if(!ds){ds=!0;let e=typeof BigInt64Array<"u"&&"function"==typeof BigInt64Array.from,t=typeof BigUint64Array<"u"&&"function"==typeof BigUint64Array.from;e&&(sn.set("int64",BigInt64Array),Un.set(BigInt64Array,"int64")),t&&(sn.set("uint64",BigUint64Array),Un.set(BigUint64Array,"uint64"))}}})),bs,gs,ys=D((()=>{Gn(),bs=e=>{let t=1;for(let r=0;r<e.length;r++){let n=e[r];if("number"!=typeof n||!Number.isSafeInteger(n))throw new TypeError(`dims[${r}] must be an integer, got: ${n}`);if(n<0)throw new RangeError(`dims[${r}] must be a non-negative integer, got: ${n}`);t*=n}return t},gs=(e,t)=>{switch(e.location){case"cpu":return new Ye(e.type,e.data,t);case"cpu-pinned":return new Ye({location:"cpu-pinned",data:e.data,type:e.type,dims:t});case"texture":return new Ye({location:"texture",texture:e.texture,type:e.type,dims:t});case"gpu-buffer":return new Ye({location:"gpu-buffer",gpuBuffer:e.gpuBuffer,type:e.type,dims:t});default:throw new Error(`tensorReshape: tensor location ${e.location} is not supported`)}}})),Ye,Gn=D((()=>{ss(),ps(),ms(),ys(),Ye=class{constructor(e,t,r){let n,i;if(hs(),"object"==typeof e&&"location"in e)switch(this.dataLocation=e.location,n=e.type,i=e.dims,e.location){case"cpu-pinned":{let t=sn.get(n);if(!t)throw new TypeError(`unsupported type "${n}" to create tensor from pinned buffer`);if(!(e.data instanceof t))throw new TypeError(`buffer should be of type ${t.name}`);this.cpuData=e.data;break}case"texture":if("float32"!==n)throw new TypeError(`unsupported type "${n}" to create tensor from texture`);this.gpuTextureData=e.texture,this.downloader=e.download,this.disposer=e.dispose;break;case"gpu-buffer":if("float32"!==n&&"float16"!==n&&"int32"!==n&&"int64"!==n&&"uint32"!==n&&"bool"!==n)throw new TypeError(`unsupported type "${n}" to create tensor from gpu buffer`);this.gpuBufferData=e.gpuBuffer,this.downloader=e.download,this.disposer=e.dispose;break;default:throw new Error(`Tensor constructor: unsupported location '${this.dataLocation}'`)}else{let o,a;if("string"==typeof e)if(n=e,a=r,"string"===e){if(!Array.isArray(t))throw new TypeError("A string tensor's data must be a string array.");o=t}else{let r=sn.get(e);if(void 0===r)throw new TypeError(`Unsupported tensor type: ${e}.`);if(Array.isArray(t)){if("float16"===e)throw new TypeError("Creating a float16 tensor from number array is not supported. Please use Uint16Array as data.");o="uint64"===e||"int64"===e?r.from(t,BigInt):r.from(t)}else{if(!(t instanceof r))throw new TypeError(`A ${n} tensor's data must be type of ${r}`);o=t}}else if(a=t,Array.isArray(e)){if(0===e.length)throw new TypeError("Tensor type cannot be inferred from an empty array.");let t=typeof e[0];if("string"===t)n="string",o=e;else{if("boolean"!==t)throw new TypeError(`Invalid element type of data array: ${t}.`);n="bool",o=Uint8Array.from(e)}}else{let t=Un.get(e.constructor);if(void 0===t)throw new TypeError(`Unsupported type for tensor data: ${e.constructor}.`);n=t,o=e}if(void 0===a)a=[o.length];else if(!Array.isArray(a))throw new TypeError("A tensor's dims must be a number array");i=a,this.cpuData=o,this.dataLocation="cpu"}let o=bs(i);if(this.cpuData&&o!==this.cpuData.length)throw new Error(`Tensor's size(${o}) does not match data length(${this.cpuData.length}).`);this.type=n,this.dims=i,this.size=o}static async fromImage(e,t){return us(e,t)}static fromTexture(e,t){return ls(e,t)}static fromGpuBuffer(e,t){return fs(e,t)}static fromPinnedBuffer(e,t,r){return cs(e,t,r)}toDataURL(e){return is(this,e)}toImageData(e){return as(this,e)}get data(){if(this.ensureValid(),!this.cpuData)throw new Error("The data is not on CPU. Use `getData()` to download GPU data to CPU, or use `texture` or `gpuBuffer` property to access the GPU data directly.");return this.cpuData}get location(){return this.dataLocation}get texture(){if(this.ensureValid(),!this.gpuTextureData)throw new Error("The data is not stored as a WebGL texture.");return this.gpuTextureData}get gpuBuffer(){if(this.ensureValid(),!this.gpuBufferData)throw new Error("The data is not stored as a WebGPU buffer.");return this.gpuBufferData}async getData(e){switch(this.ensureValid(),this.dataLocation){case"cpu":case"cpu-pinned":return this.data;case"texture":case"gpu-buffer":if(!this.downloader)throw new Error("The current tensor is not created with a specified data downloader.");if(this.isDownloading)throw new Error("The current tensor is being downloaded.");try{this.isDownloading=!0;let t=await this.downloader();return this.downloader=void 0,this.dataLocation="cpu",this.cpuData=t,e&&this.disposer&&(this.disposer(),this.disposer=void 0),t}finally{this.isDownloading=!1}default:throw new Error(`cannot get data from location: ${this.dataLocation}`)}}dispose(){if(this.isDownloading)throw new Error("The current tensor is being downloaded.");this.disposer&&(this.disposer(),this.disposer=void 0),this.cpuData=void 0,this.gpuTextureData=void 0,this.gpuBufferData=void 0,this.downloader=void 0,this.isDownloading=void 0,this.dataLocation="none"}ensureValid(){if("none"===this.dataLocation)throw new Error("The tensor is disposed.")}reshape(e){if(this.ensureValid(),this.downloader||this.disposer)throw new Error("Cannot reshape a tensor that owns GPU resource.");return gs(this,e)}}})),Ne,zn=D((()=>{Gn(),Ne=Ye})),Ts,xs,br,gr,Qo=D((()=>{Jo(),Ts=(e,t)=>{mr.wasm.trace&&console.timeStamp(`${e}::ORT::${t}`)},xs=(e,t)=>{let r=(new Error).stack?.split(/\r\n|\r|\n/g)||[],n=!1;for(let i=0;i<r.length;i++){if(n&&!r[i].includes("TRACE_FUNC")){let n=`FUNC_${e}::${r[i].trim().split(" ")[1]}`;return t&&(n+=`::${t}`),void Ts("CPU",n)}r[i].includes("TRACE_FUNC")&&(n=!0)}},br=e=>{mr.wasm.trace&&xs("BEGIN",e)},gr=e=>{mr.wasm.trace&&xs("END",e)}})),Wn,ws=D((()=>{Mn(),zn(),Qo(),Wn=class e{constructor(e){this.handler=e}async run(e,t,r){br();let n={},i={};if("object"!=typeof e||null===e||e instanceof Ne||Array.isArray(e))throw new TypeError("'feeds' must be an object that use input names as keys and OnnxValue as corresponding values.");let o=!0;if("object"==typeof t){if(null===t)throw new TypeError("Unexpected argument[1]: cannot be null.");if(t instanceof Ne)throw new TypeError("'fetches' cannot be a Tensor");if(Array.isArray(t)){if(0===t.length)throw new TypeError("'fetches' cannot be an empty array.");o=!1;for(let e of t){if("string"!=typeof e)throw new TypeError("'fetches' must be a string array or an object.");if(-1===this.outputNames.indexOf(e))throw new RangeError(`'fetches' contains invalid output name: ${e}.`);n[e]=null}if("object"==typeof r&&null!==r)i=r;else if(typeof r<"u")throw new TypeError("'options' must be an object.")}else{let e=!1,a=Object.getOwnPropertyNames(t);for(let r of this.outputNames)if(-1!==a.indexOf(r)){let i=t[r];(null===i||i instanceof Ne)&&(e=!0,o=!1,n[r]=i)}if(e){if("object"==typeof r&&null!==r)i=r;else if(typeof r<"u")throw new TypeError("'options' must be an object.")}else i=t}}else if(typeof t<"u")throw new TypeError("Unexpected argument[1]: must be 'fetches' or 'options'.");for(let t of this.inputNames)if(typeof e[t]>"u")throw new Error(`input '${t}' is missing in 'feeds'.`);if(o)for(let e of this.outputNames)n[e]=null;let a=await this.handler.run(e,n,i),s={};for(let e in a)if(Object.hasOwnProperty.call(a,e)){let t=a[e];s[e]=t instanceof Ne?t:new Ne(t.type,t.data,t.dims)}return gr(),s}async release(){return this.handler.dispose()}async configure(e){return await this.handler.configure(e)}async auth(e){return await this.handler.auth(e)}static async create(t,r,n,i){br();let o,a={};if("string"==typeof t){if(o=t,"object"==typeof r&&null!==r)a=r;else if(typeof r<"u")throw new TypeError("'options' must be an object.")}else if(t instanceof Uint8Array){if(o=t,"object"==typeof r&&null!==r)a=r;else if(typeof r<"u")throw new TypeError("'options' must be an object.")}else{if(!(t instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&t instanceof SharedArrayBuffer))throw new TypeError("Unexpected argument[0]: must be 'path' or 'buffer'.");{let e=t,s=0,u=t.byteLength;if("object"==typeof r&&null!==r)a=r;else if("number"==typeof r){if(s=r,!Number.isSafeInteger(s))throw new RangeError("'byteOffset' must be an integer.");if(s<0||s>=e.byteLength)throw new RangeError(`'byteOffset' is out of range [0, ${e.byteLength}).`);if(u=t.byteLength-s,"number"==typeof n){if(u=n,!Number.isSafeInteger(u))throw new RangeError("'byteLength' must be an integer.");if(u<=0||s+u>e.byteLength)throw new RangeError(`'byteLength' is out of range (0, ${e.byteLength-s}].`);if("object"==typeof i&&null!==i)a=i;else if(typeof i<"u")throw new TypeError("'options' must be an object.")}else if(typeof n<"u")throw new TypeError("'byteLength' must be a number.")}else if(typeof r<"u")throw new TypeError("'options' must be an object.");o=new Uint8Array(e,s,u)}}let s=(a.executionProviders||[]).map((e=>"string"==typeof e?e:e.name)),u=await(await Rn(s)).createInferenceSessionHandler(o,a);return gr(),new e(u)}startProfiling(){this.handler.startProfiling()}endProfiling(){this.handler.endProfiling()}get inputNames(){return this.handler.inputNames}get outputNames(){return this.handler.outputNames}}})),Md,vs=D((()=>{ws(),Md=Wn})),_s=D((()=>{})),Gd,Vn,Os=D((()=>{Mn(),zn(),Gd="Training backend could not be resolved. Make sure you're using the correct configuration & WebAssembly files.",Vn=class e{constructor(e,t,r){this.handler=e,this.hasOptimizerModel=t,this.hasEvalModel=r}get trainingInputNames(){return this.handler.inputNames}get trainingOutputNames(){return this.handler.outputNames}get evalInputNames(){if(this.hasEvalModel)return this.handler.evalInputNames;throw new Error("This training session has no evalModel loaded.")}get evalOutputNames(){if(this.hasEvalModel)return this.handler.evalOutputNames;throw new Error("This training session has no evalModel loaded.")}static async create(t,r){let n=t.evalModel||"",i=t.optimizerModel||"",o=r||{},a=(o.executionProviders||[]).map((e=>"string"==typeof e?e:e.name)),s=await Rn(a);if(s.createTrainingSessionHandler){let r=await s.createTrainingSessionHandler(t.checkpointState,t.trainModel,n,i,o);return new e(r,!!t.optimizerModel,!!t.evalModel)}throw new Error(Gd)}typeNarrowingForRunStep(e,t,r,n,i){let o={},a={};if("object"!=typeof r||null===r||r instanceof Ne||Array.isArray(r))throw new TypeError("'feeds' must be an object that use input names as keys and OnnxValue as corresponding values.");let s=!0;if("object"==typeof n){if(null===n)throw new TypeError("Unexpected argument[1]: cannot be null.");if(n instanceof Ne)throw new TypeError("'fetches' cannot be a Tensor");if(Array.isArray(n)){if(0===n.length)throw new TypeError("'fetches' cannot be an empty array.");s=!1;for(let e of n){if("string"!=typeof e)throw new TypeError("'fetches' must be a string array or an object.");if(-1===t.indexOf(e))throw new RangeError(`'fetches' contains invalid output name: ${e}.`);o[e]=null}if("object"==typeof i&&null!==i)a=i;else if(typeof i<"u")throw new TypeError("'options' must be an object.")}else{let e=!1,r=Object.getOwnPropertyNames(n);for(let i of t)if(-1!==r.indexOf(i)){let t=n[i];(null===t||t instanceof Ne)&&(e=!0,s=!1,o[i]=t)}if(e){if("object"==typeof i&&null!==i)a=i;else if(typeof i<"u")throw new TypeError("'options' must be an object.")}else a=n}}else if(typeof n<"u")throw new TypeError("Unexpected argument[1]: must be 'fetches' or 'options'.");for(let t of e)if(typeof r[t]>"u")throw new Error(`input '${t}' is missing in 'feeds'.`);if(s)for(let e of t)o[e]=null;return[o,a]}convertHandlerReturnTypeToMapOfTensors(e){let t={};for(let r in e)if(Object.hasOwnProperty.call(e,r)){let n=e[r];t[r]=n instanceof Ne?n:new Ne(n.type,n.data,n.dims)}return t}async lazyResetGrad(){await this.handler.lazyResetGrad()}async runTrainStep(e,t,r){let[n,i]=this.typeNarrowingForRunStep(this.trainingInputNames,this.trainingOutputNames,e,t,r),o=await this.handler.runTrainStep(e,n,i);return this.convertHandlerReturnTypeToMapOfTensors(o)}async runOptimizerStep(e){if(!this.hasOptimizerModel)throw new Error("This TrainingSession has no OptimizerModel loaded.");await this.handler.runOptimizerStep(e||{})}async runEvalStep(e,t,r){if(this.hasEvalModel){let[n,i]=this.typeNarrowingForRunStep(this.evalInputNames,this.evalOutputNames,e,t,r),o=await this.handler.runEvalStep(e,n,i);return this.convertHandlerReturnTypeToMapOfTensors(o)}throw new Error("This TrainingSession has no EvalModel loaded.")}async getParametersSize(e=!0){return this.handler.getParametersSize(e)}async loadParametersBuffer(e,t=!0){let r=await this.getParametersSize(t);if(e.length!==4*r)throw new Error("Size of the buffer passed into loadParametersBuffer must match the number of parameters in the model. Please use getParametersSize method to check.");return this.handler.loadParametersBuffer(e,t)}async getContiguousParameters(e=!0){return this.handler.getContiguousParameters(e)}async release(){return this.handler.dispose()}}})),Ud,Ss=D((()=>{Os(),Ud=Vn})),ei={};pr(ei,{InferenceSession:()=>Md,TRACE:()=>Ts,TRACE_FUNC_BEGIN:()=>br,TRACE_FUNC_END:()=>gr,Tensor:()=>Ne,TrainingSession:()=>Ud,env:()=>ee,registerBackend:()=>hr});var _t=D((()=>{es(),os(),vs(),zn(),Qo(),_s(),Ss()}));function Zt(e,t,r,n){if(void 0===t)return Wd(e);if(void 0===r)Hn(e,t,1);else if("number"==typeof r&&void 0===n)Hn(e,t,r);else if("string"==typeof r&&void 0===n)Hn(e,r,1,t);else{if("string"!=typeof r||"number"!=typeof n)throw new TypeError("input is valid");Hn(e,r,n,t)}}function Wd(e){return{verbose:Zt.verbose.bind(null,e),info:Zt.info.bind(null,e),warning:Zt.warning.bind(null,e),error:Zt.error.bind(null,e),fatal:Zt.fatal.bind(null,e)}}function Hn(e,t,r,n){let i=un[n||""]||un[""];As[e]<As[i.minimalSeverity]||(i.logDateTime&&(t=`${(new Date).toISOString()}|${t}`),i.logSourceLocation,zd[i.provider].log(e,t,n))}var ti,ri,As,zd,Es,un,pe,qn,Yn,Xn,jn,pt=D((()=>{ti=class{log(e,t,r){}},ri=class{log(e,t,r){console.log(`${this.color(e)} ${r?"[35m"+r+"[0m ":""}${t}`)}color(e){switch(e){case"verbose":return"[34;40mv[0m";case"info":return"[32mi[0m";case"warning":return"[30;43mw[0m";case"error":return"[31;40me[0m";case"fatal":return"[101mf[0m";default:throw new Error(`unsupported severity: ${e}`)}}},As={verbose:1e3,info:2e3,warning:4e3,error:5e3,fatal:6e3},zd={none:new ti,console:new ri},un={"":Es={provider:"console",minimalSeverity:"warning",logDateTime:!0,logSourceLocation:!1}},(e=>{function t(e){un={},r("",e||{})}function r(e,r){if("*"===e)t(r);else{let t=un[e]||Es;un[e]={provider:r.provider||t.provider,minimalSeverity:r.minimalSeverity||t.minimalSeverity,logDateTime:void 0===r.logDateTime?t.logDateTime:r.logDateTime,logSourceLocation:void 0===r.logSourceLocation?t.logSourceLocation:r.logSourceLocation}}}e.verbose=function(t,r){e("verbose",t,r)},e.info=function(t,r){e("info",t,r)},e.warning=function(t,r){e("warning",t,r)},e.error=function(t,r){e("error",t,r)},e.fatal=function(t,r){e("fatal",t,r)},e.reset=t,e.set=r,e.setWithEnv=function(e){let t={};e.logLevel&&(t.minimalSeverity=e.logLevel),r("",t)}})(Zt||={}),pe=Zt,qn=class{constructor(e,t,r,n,i,o){this.category=e,this.name=t,this.startTime=r,this.endCallback=n,this.timer=i,this.ctx=o}async end(){return this.endCallback(this)}async checkTimer(){if(void 0===this.ctx||void 0===this.timer)throw new Error("No webgl timer found");return this.ctx.endTimer(),this.ctx.waitForQueryAndGetTime(this.timer)}},Yn=class{constructor(e,t,r,n){this.category=e,this.name=t,this.startTime=r,this.endTime=n}},Xn=class{constructor(e,t,r){this._started=!1,this._flushPointer=0,this._started=!1,this._maxNumberEvents=void 0===e?1e4:e,this._flushBatchSize=void 0===t?10:t,this._flushIntervalInMilliseconds=void 0===r?5e3:r}static create(e){return void 0===e?new this:new this(e.maxNumberEvents,e.flushBatchSize,e.flushIntervalInMilliseconds)}start(){this._started=!0,this._timingEvents=[],this._flushTime=jn(),this._flushPointer=0}stop(){for(this._started=!1;this._flushPointer<this._timingEvents.length;this._flushPointer++)this.logOneEvent(this._timingEvents[this._flushPointer])}event(e,t,r,n){let i=this._started?this.begin(e,t,n):void 0,o=!1,a=r();if(a&&"function"==typeof a.then)return o=!0,new Promise(((e,t)=>{a.then((async t=>{i&&await i.end(),e(t)}),(async e=>{i&&await i.end(),t(e)}))}));if(!o&&i){let e=i.end();if(e&&"function"==typeof e.then)return new Promise(((t,r)=>{e.then((()=>{t(a)}),(e=>{r(e)}))}))}return a}begin(e,t,r){if(!this._started)throw new Error("profiler is not started yet");if(void 0===r){let r=jn();return this.flush(r),new qn(e,t,r,(e=>this.endSync(e)))}{let n=r.beginTimer();return new qn(e,t,0,(async e=>this.end(e)),n,r)}}async end(e){let t=await e.checkTimer();this._timingEvents.length<this._maxNumberEvents&&(this._timingEvents.push(new Yn(e.category,e.name,e.startTime,t)),this.flush(t))}endSync(e){let t=jn();this._timingEvents.length<this._maxNumberEvents&&(this._timingEvents.push(new Yn(e.category,e.name,e.startTime,t)),this.flush(t))}logOneEvent(e){pe.verbose(`Profiler.${e.category}`,`${(e.endTime-e.startTime).toFixed(2)}ms on event '${e.name}' at ${e.endTime.toFixed(2)}`)}flush(e){if(this._timingEvents.length-this._flushPointer>=this._flushBatchSize||e-this._flushTime>=this._flushIntervalInMilliseconds){for(let e=this._flushPointer;this._flushPointer<e+this._flushBatchSize&&this._flushPointer<this._timingEvents.length;this._flushPointer++)this.logOneEvent(this._timingEvents[this._flushPointer]);this._flushTime=jn()}}get started(){return this._started}},jn=typeof performance<"u"&&performance.now?()=>performance.now():Date.now}));function Ps(e,t,r){for(let n of r){let r=n[0],i=n[1],o=n[2],a=n[3],s=n[4];if(e.opType===r)for(let e of t)if((e.domain===i||"ai.onnx"===e.domain&&""===i)&&Vd(e.version,o))return{opImpl:a,opInit:s}}throw new TypeError(`cannot resolve operator '${e.opType}' with opsets: ${t.map((e=>`${e.domain||"ai.onnx"} v${e.version}`)).join(", ")}`)}function Vd(e,t){if(t.endsWith("+")){let r=Number.parseInt(t.substring(0,t.length-1),10);return!isNaN(r)&&r<=e}if(2===t.split("-").length){let r=t.split("-"),n=Number.parseInt(r[0],10),i=Number.parseInt(r[1],10);return!isNaN(n)&&!isNaN(i)&&n<=e&&e<=i}return Number.parseInt(t,10)===e}var Ds=D((()=>{})),Ls=ye((e=>{e.__esModule=!0;var t=function(){function e(t){if(!t)throw new TypeError("Invalid argument; `value` has no value.");this.value=e.EMPTY,t&&e.isGuid(t)&&(this.value=t)}return e.isGuid=function(t){var r=t.toString();return t&&(t instanceof e||e.validator.test(r))},e.create=function(){return new e([e.gen(2),e.gen(1),e.gen(1),e.gen(1),e.gen(3)].join("-"))},e.createEmpty=function(){return new e("emptyguid")},e.parse=function(t){return new e(t)},e.raw=function(){return[e.gen(2),e.gen(1),e.gen(1),e.gen(1),e.gen(3)].join("-")},e.gen=function(e){for(var t="",r=0;r<e;r++)t+=(65536*(1+Math.random())|0).toString(16).substring(1);return t},e.prototype.equals=function(t){return e.isGuid(t)&&this.value===t.toString()},e.prototype.isEmpty=function(){return this.value===e.EMPTY},e.prototype.toString=function(){return this.value},e.prototype.toJSON=function(){return{value:this.value}},e.validator=new RegExp("^[a-z0-9]{8}-[a-z0-9]{4}-[a-z0-9]{4}-[a-z0-9]{4}-[a-z0-9]{12}$","i"),e.EMPTY="00000000-0000-0000-0000-000000000000",e}();e.Guid=t}));function Te(e,t,r){this.low=0|e,this.high=0|t,this.unsigned=!!r}function qe(e){return!0===(e&&e.__isLong__)}function Cs(e){var t=Math.clz32(e&-e);return e?31-t:t}function yr(e,t){var r,n,i;return t?(i=0<=(e>>>=0)&&e<256)&&(n=Bs[e])?n:(r=le(e,0,!0),i&&(Bs[e]=r),r):(i=-128<=(e|=0)&&e<128)&&(n=Fs[e])?n:(r=le(e,e<0?-1:0,!1),i&&(Fs[e]=r),r)}function ht(e,t){if(isNaN(e))return t?qt:Ot;if(t){if(e<0)return qt;if(e>=Rs)return Us}else{if(e<=-ks)return rt;if(e+1>=ks)return Gs}return e<0?ht(-e,t).neg():le(e%Mr|0,e/Mr|0,t)}function le(e,t,r){return new Te(e,t,r)}function ii(e,t,r){if(0===e.length)throw Error("empty string");if("number"==typeof t?(r=t,t=!1):t=!!t,"NaN"===e||"Infinity"===e||"+Infinity"===e||"-Infinity"===e)return t?qt:Ot;if((r=r||10)<2||36<r)throw RangeError("radix");var n;if((n=e.indexOf("-"))>0)throw Error("interior hyphen");if(0===n)return ii(e.substring(1),t,r).neg();for(var i=ht(Kn(r,8)),o=Ot,a=0;a<e.length;a+=8){var s=Math.min(8,e.length-a),u=parseInt(e.substring(a,a+s),r);if(s<8){var l=ht(Kn(r,s));o=o.mul(l).add(ht(u))}else o=(o=o.mul(i)).add(ht(u))}return o.unsigned=t,o}function St(e,t){return"number"==typeof e?ht(e,t):"string"==typeof e?ii(e,t):le(e.low,e.high,"boolean"==typeof t?t:e.unsigned)}var dt,Fs,Bs,Kn,$s,jd,Mr,Rs,ks,Ns,Ot,qt,Rr,Ms,oi,Gs,Us,rt,N,Yt,ai=D((()=>{dt=null;try{dt=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}Te.prototype.__isLong__,Object.defineProperty(Te.prototype,"__isLong__",{value:!0}),Te.isLong=qe,Fs={},Bs={},Te.fromInt=yr,Te.fromNumber=ht,Te.fromBits=le,Kn=Math.pow,Te.fromString=ii,Te.fromValue=St,ks=(Rs=(Mr=($s=65536)*$s)*Mr)/2,Ns=yr(jd=1<<24),Ot=yr(0),Te.ZERO=Ot,qt=yr(0,!0),Te.UZERO=qt,Rr=yr(1),Te.ONE=Rr,Ms=yr(1,!0),Te.UONE=Ms,oi=yr(-1),Te.NEG_ONE=oi,Gs=le(-1,2147483647,!1),Te.MAX_VALUE=Gs,Us=le(-1,-1,!0),Te.MAX_UNSIGNED_VALUE=Us,rt=le(0,-2147483648,!1),Te.MIN_VALUE=rt,(N=Te.prototype).toInt=function(){return this.unsigned?this.low>>>0:this.low},N.toNumber=function(){return this.unsigned?(this.high>>>0)*Mr+(this.low>>>0):this.high*Mr+(this.low>>>0)},N.toString=function(e){if((e=e||10)<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(this.eq(rt)){var t=ht(e),r=this.div(t),n=r.mul(t).sub(this);return r.toString(e)+n.toInt().toString(e)}return"-"+this.neg().toString(e)}for(var i=ht(Kn(e,6),this.unsigned),o=this,a="";;){var s=o.div(i),u=(o.sub(s.mul(i)).toInt()>>>0).toString(e);if((o=s).isZero())return u+a;for(;u.length<6;)u="0"+u;a=""+u+a}},N.getHighBits=function(){return this.high},N.getHighBitsUnsigned=function(){return this.high>>>0},N.getLowBits=function(){return this.low},N.getLowBitsUnsigned=function(){return this.low>>>0},N.getNumBitsAbs=function(){if(this.isNegative())return this.eq(rt)?64:this.neg().getNumBitsAbs();for(var e=0!=this.high?this.high:this.low,t=31;t>0&&!(e&1<<t);t--);return 0!=this.high?t+33:t+1},N.isZero=function(){return 0===this.high&&0===this.low},N.eqz=N.isZero,N.isNegative=function(){return!this.unsigned&&this.high<0},N.isPositive=function(){return this.unsigned||this.high>=0},N.isOdd=function(){return!(1&~this.low)},N.isEven=function(){return!(1&this.low)},N.equals=function(e){return qe(e)||(e=St(e)),(this.unsigned===e.unsigned||this.high>>>31!=1||e.high>>>31!=1)&&(this.high===e.high&&this.low===e.low)},N.eq=N.equals,N.notEquals=function(e){return!this.eq(e)},N.neq=N.notEquals,N.ne=N.notEquals,N.lessThan=function(e){return this.comp(e)<0},N.lt=N.lessThan,N.lessThanOrEqual=function(e){return this.comp(e)<=0},N.lte=N.lessThanOrEqual,N.le=N.lessThanOrEqual,N.greaterThan=function(e){return this.comp(e)>0},N.gt=N.greaterThan,N.greaterThanOrEqual=function(e){return this.comp(e)>=0},N.gte=N.greaterThanOrEqual,N.ge=N.greaterThanOrEqual,N.compare=function(e){if(qe(e)||(e=St(e)),this.eq(e))return 0;var t=this.isNegative(),r=e.isNegative();return t&&!r?-1:!t&&r?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1},N.comp=N.compare,N.negate=function(){return!this.unsigned&&this.eq(rt)?rt:this.not().add(Rr)},N.neg=N.negate,N.add=function(e){qe(e)||(e=St(e));var t=this.high>>>16,r=65535&this.high,n=this.low>>>16,i=65535&this.low,o=e.high>>>16,a=65535&e.high,s=e.low>>>16,u=0,l=0,h=0,c=0;return h+=(c+=i+(65535&e.low))>>>16,l+=(h+=n+s)>>>16,u+=(l+=r+a)>>>16,u+=t+o,le((h&=65535)<<16|(c&=65535),(u&=65535)<<16|(l&=65535),this.unsigned)},N.subtract=function(e){return qe(e)||(e=St(e)),this.add(e.neg())},N.sub=N.subtract,N.multiply=function(e){if(this.isZero())return this;if(qe(e)||(e=St(e)),dt)return le(dt.mul(this.low,this.high,e.low,e.high),dt.get_high(),this.unsigned);if(e.isZero())return this.unsigned?qt:Ot;if(this.eq(rt))return e.isOdd()?rt:Ot;if(e.eq(rt))return this.isOdd()?rt:Ot;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(Ns)&&e.lt(Ns))return ht(this.toNumber()*e.toNumber(),this.unsigned);var t=this.high>>>16,r=65535&this.high,n=this.low>>>16,i=65535&this.low,o=e.high>>>16,a=65535&e.high,s=e.low>>>16,u=65535&e.low,l=0,h=0,c=0,f=0;return c+=(f+=i*u)>>>16,h+=(c+=n*u)>>>16,c&=65535,h+=(c+=i*s)>>>16,l+=(h+=r*u)>>>16,h&=65535,l+=(h+=n*s)>>>16,h&=65535,l+=(h+=i*a)>>>16,l+=t*u+r*s+n*a+i*o,le((c&=65535)<<16|(f&=65535),(l&=65535)<<16|(h&=65535),this.unsigned)},N.mul=N.multiply,N.divide=function(e){if(qe(e)||(e=St(e)),e.isZero())throw Error("division by zero");var t,r,n;if(dt)return this.unsigned||-2147483648!==this.high||-1!==e.low||-1!==e.high?le((this.unsigned?dt.div_u:dt.div_s)(this.low,this.high,e.low,e.high),dt.get_high(),this.unsigned):this;if(this.isZero())return this.unsigned?qt:Ot;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return qt;if(e.gt(this.shru(1)))return Ms;n=qt}else{if(this.eq(rt))return e.eq(Rr)||e.eq(oi)?rt:e.eq(rt)?Rr:(t=this.shr(1).div(e).shl(1)).eq(Ot)?e.isNegative()?Rr:oi:(r=this.sub(e.mul(t)),n=t.add(r.div(e)));if(e.eq(rt))return this.unsigned?qt:Ot;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();n=Ot}for(r=this;r.gte(e);){t=Math.max(1,Math.floor(r.toNumber()/e.toNumber()));for(var i=Math.ceil(Math.log(t)/Math.LN2),o=i<=48?1:Kn(2,i-48),a=ht(t),s=a.mul(e);s.isNegative()||s.gt(r);)s=(a=ht(t-=o,this.unsigned)).mul(e);a.isZero()&&(a=Rr),n=n.add(a),r=r.sub(s)}return n},N.div=N.divide,N.modulo=function(e){return qe(e)||(e=St(e)),dt?le((this.unsigned?dt.rem_u:dt.rem_s)(this.low,this.high,e.low,e.high),dt.get_high(),this.unsigned):this.sub(this.div(e).mul(e))},N.mod=N.modulo,N.rem=N.modulo,N.not=function(){return le(~this.low,~this.high,this.unsigned)},N.countLeadingZeros=function(){return this.high?Math.clz32(this.high):Math.clz32(this.low)+32},N.clz=N.countLeadingZeros,N.countTrailingZeros=function(){return this.low?Cs(this.low):Cs(this.high)+32},N.ctz=N.countTrailingZeros,N.and=function(e){return qe(e)||(e=St(e)),le(this.low&e.low,this.high&e.high,this.unsigned)},N.or=function(e){return qe(e)||(e=St(e)),le(this.low|e.low,this.high|e.high,this.unsigned)},N.xor=function(e){return qe(e)||(e=St(e)),le(this.low^e.low,this.high^e.high,this.unsigned)},N.shiftLeft=function(e){return qe(e)&&(e=e.toInt()),0==(e&=63)?this:e<32?le(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):le(0,this.low<<e-32,this.unsigned)},N.shl=N.shiftLeft,N.shiftRight=function(e){return qe(e)&&(e=e.toInt()),0==(e&=63)?this:e<32?le(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):le(this.high>>e-32,this.high>=0?0:-1,this.unsigned)},N.shr=N.shiftRight,N.shiftRightUnsigned=function(e){return qe(e)&&(e=e.toInt()),0==(e&=63)?this:e<32?le(this.low>>>e|this.high<<32-e,this.high>>>e,this.unsigned):le(32===e?this.high:this.high>>>e-32,0,this.unsigned)},N.shru=N.shiftRightUnsigned,N.shr_u=N.shiftRightUnsigned,N.rotateLeft=function(e){var t;return qe(e)&&(e=e.toInt()),0==(e&=63)?this:32===e?le(this.high,this.low,this.unsigned):e<32?(t=32-e,le(this.low<<e|this.high>>>t,this.high<<e|this.low>>>t,this.unsigned)):(t=32-(e-=32),le(this.high<<e|this.low>>>t,this.low<<e|this.high>>>t,this.unsigned))},N.rotl=N.rotateLeft,N.rotateRight=function(e){var t;return qe(e)&&(e=e.toInt()),0==(e&=63)?this:32===e?le(this.high,this.low,this.unsigned):e<32?(t=32-e,le(this.high<<t|this.low>>>e,this.low<<t|this.high>>>e,this.unsigned)):(t=32-(e-=32),le(this.low<<t|this.high>>>e,this.high<<t|this.low>>>e,this.unsigned))},N.rotr=N.rotateRight,N.toSigned=function(){return this.unsigned?le(this.low,this.high,!1):this},N.toUnsigned=function(){return this.unsigned?this:le(this.low,this.high,!0)},N.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()},N.toBytesLE=function(){var e=this.high,t=this.low;return[255&t,t>>>8&255,t>>>16&255,t>>>24,255&e,e>>>8&255,e>>>16&255,e>>>24]},N.toBytesBE=function(){var e=this.high,t=this.low;return[e>>>24,e>>>16&255,e>>>8&255,255&e,t>>>24,t>>>16&255,t>>>8&255,255&t]},Te.fromBytes=function(e,t,r){return r?Te.fromBytesLE(e,t):Te.fromBytesBE(e,t)},Te.fromBytesLE=function(e,t){return new Te(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,t)},Te.fromBytesBE=function(e,t){return new Te(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],t)},Yt=Te})),S,Jn=D((()=>{S={},S.Table,S.SIZEOF_SHORT=2,S.SIZEOF_INT=4,S.FILE_IDENTIFIER_LENGTH=4,S.SIZE_PREFIX_LENGTH=4,S.Encoding={UTF8_BYTES:1,UTF16_STRING:2},S.int32=new Int32Array(2),S.float32=new Float32Array(S.int32.buffer),S.float64=new Float64Array(S.int32.buffer),S.isLittleEndian=1===new Uint16Array(new Uint8Array([1,0]).buffer)[0],S.Long=function(e,t){this.low=0|e,this.high=0|t},S.Long.create=function(e,t){return 0==e&&0==t?S.Long.ZERO:new S.Long(e,t)},S.Long.prototype.toFloat64=function(){return(this.low>>>0)+4294967296*this.high},S.Long.prototype.equals=function(e){return this.low==e.low&&this.high==e.high},S.Long.ZERO=new S.Long(0,0),S.Builder=function(e){if(e)var t=e;else t=1024;this.bb=S.ByteBuffer.allocate(t),this.space=t,this.minalign=1,this.vtable=null,this.vtable_in_use=0,this.isNested=!1,this.object_start=0,this.vtables=[],this.vector_num_elems=0,this.force_defaults=!1},S.Builder.prototype.clear=function(){this.bb.clear(),this.space=this.bb.capacity(),this.minalign=1,this.vtable=null,this.vtable_in_use=0,this.isNested=!1,this.object_start=0,this.vtables=[],this.vector_num_elems=0,this.force_defaults=!1},S.Builder.prototype.forceDefaults=function(e){this.force_defaults=e},S.Builder.prototype.dataBuffer=function(){return this.bb},S.Builder.prototype.asUint8Array=function(){return this.bb.bytes().subarray(this.bb.position(),this.bb.position()+this.offset())},S.Builder.prototype.prep=function(e,t){e>this.minalign&&(this.minalign=e);for(var r=1+~(this.bb.capacity()-this.space+t)&e-1;this.space<r+e+t;){var n=this.bb.capacity();this.bb=S.Builder.growByteBuffer(this.bb),this.space+=this.bb.capacity()-n}this.pad(r)},S.Builder.prototype.pad=function(e){for(var t=0;t<e;t++)this.bb.writeInt8(--this.space,0)},S.Builder.prototype.writeInt8=function(e){this.bb.writeInt8(this.space-=1,e)},S.Builder.prototype.writeInt16=function(e){this.bb.writeInt16(this.space-=2,e)},S.Builder.prototype.writeInt32=function(e){this.bb.writeInt32(this.space-=4,e)},S.Builder.prototype.writeInt64=function(e){this.bb.writeInt64(this.space-=8,e)},S.Builder.prototype.writeFloat32=function(e){this.bb.writeFloat32(this.space-=4,e)},S.Builder.prototype.writeFloat64=function(e){this.bb.writeFloat64(this.space-=8,e)},S.Builder.prototype.addInt8=function(e){this.prep(1,0),this.writeInt8(e)},S.Builder.prototype.addInt16=function(e){this.prep(2,0),this.writeInt16(e)},S.Builder.prototype.addInt32=function(e){this.prep(4,0),this.writeInt32(e)},S.Builder.prototype.addInt64=function(e){this.prep(8,0),this.writeInt64(e)},S.Builder.prototype.addFloat32=function(e){this.prep(4,0),this.writeFloat32(e)},S.Builder.prototype.addFloat64=function(e){this.prep(8,0),this.writeFloat64(e)},S.Builder.prototype.addFieldInt8=function(e,t,r){(this.force_defaults||t!=r)&&(this.addInt8(t),this.slot(e))},S.Builder.prototype.addFieldInt16=function(e,t,r){(this.force_defaults||t!=r)&&(this.addInt16(t),this.slot(e))},S.Builder.prototype.addFieldInt32=function(e,t,r){(this.force_defaults||t!=r)&&(this.addInt32(t),this.slot(e))},S.Builder.prototype.addFieldInt64=function(e,t,r){(this.force_defaults||!t.equals(r))&&(this.addInt64(t),this.slot(e))},S.Builder.prototype.addFieldFloat32=function(e,t,r){(this.force_defaults||t!=r)&&(this.addFloat32(t),this.slot(e))},S.Builder.prototype.addFieldFloat64=function(e,t,r){(this.force_defaults||t!=r)&&(this.addFloat64(t),this.slot(e))},S.Builder.prototype.addFieldOffset=function(e,t,r){(this.force_defaults||t!=r)&&(this.addOffset(t),this.slot(e))},S.Builder.prototype.addFieldStruct=function(e,t,r){t!=r&&(this.nested(t),this.slot(e))},S.Builder.prototype.nested=function(e){if(e!=this.offset())throw new Error("FlatBuffers: struct must be serialized inline.")},S.Builder.prototype.notNested=function(){if(this.isNested)throw new Error("FlatBuffers: object serialization must not be nested.")},S.Builder.prototype.slot=function(e){this.vtable[e]=this.offset()},S.Builder.prototype.offset=function(){return this.bb.capacity()-this.space},S.Builder.growByteBuffer=function(e){var t=e.capacity();if(3221225472&t)throw new Error("FlatBuffers: cannot grow buffer beyond 2 gigabytes.");var r=t<<1,n=S.ByteBuffer.allocate(r);return n.setPosition(r-t),n.bytes().set(e.bytes(),r-t),n},S.Builder.prototype.addOffset=function(e){this.prep(S.SIZEOF_INT,0),this.writeInt32(this.offset()-e+S.SIZEOF_INT)},S.Builder.prototype.startObject=function(e){this.notNested(),null==this.vtable&&(this.vtable=[]),this.vtable_in_use=e;for(var t=0;t<e;t++)this.vtable[t]=0;this.isNested=!0,this.object_start=this.offset()},S.Builder.prototype.endObject=function(){if(null==this.vtable||!this.isNested)throw new Error("FlatBuffers: endObject called without startObject");this.addInt32(0);for(var e=this.offset(),t=this.vtable_in_use-1;t>=0&&0==this.vtable[t];t--);for(var r=t+1;t>=0;t--)this.addInt16(0!=this.vtable[t]?e-this.vtable[t]:0);this.addInt16(e-this.object_start);var n=(r+2)*S.SIZEOF_SHORT;this.addInt16(n);var i=0,o=this.space;e:for(t=0;t<this.vtables.length;t++){var a=this.bb.capacity()-this.vtables[t];if(n==this.bb.readInt16(a)){for(var s=S.SIZEOF_SHORT;s<n;s+=S.SIZEOF_SHORT)if(this.bb.readInt16(o+s)!=this.bb.readInt16(a+s))continue e;i=this.vtables[t];break}}return i?(this.space=this.bb.capacity()-e,this.bb.writeInt32(this.space,i-e)):(this.vtables.push(this.offset()),this.bb.writeInt32(this.bb.capacity()-e,this.offset()-e)),this.isNested=!1,e},S.Builder.prototype.finish=function(e,t,r){var n=r?S.SIZE_PREFIX_LENGTH:0;if(t){var i=t;if(this.prep(this.minalign,S.SIZEOF_INT+S.FILE_IDENTIFIER_LENGTH+n),i.length!=S.FILE_IDENTIFIER_LENGTH)throw new Error("FlatBuffers: file identifier must be length "+S.FILE_IDENTIFIER_LENGTH);for(var o=S.FILE_IDENTIFIER_LENGTH-1;o>=0;o--)this.writeInt8(i.charCodeAt(o))}this.prep(this.minalign,S.SIZEOF_INT+n),this.addOffset(e),n&&this.addInt32(this.bb.capacity()-this.space),this.bb.setPosition(this.space)},S.Builder.prototype.finishSizePrefixed=function(e,t){this.finish(e,t,!0)},S.Builder.prototype.requiredField=function(e,t){var r=this.bb.capacity()-e,n=r-this.bb.readInt32(r);if(!(0!=this.bb.readInt16(n+t)))throw new Error("FlatBuffers: field "+t+" must be set")},S.Builder.prototype.startVector=function(e,t,r){this.notNested(),this.vector_num_elems=t,this.prep(S.SIZEOF_INT,e*t),this.prep(r,e*t)},S.Builder.prototype.endVector=function(){return this.writeInt32(this.vector_num_elems),this.offset()},S.Builder.prototype.createString=function(e){if(e instanceof Uint8Array)var t=e;else{t=[];for(var r=0;r<e.length;){var n,i=e.charCodeAt(r++);if(i<55296||i>=56320)n=i;else n=(i<<10)+e.charCodeAt(r++)+-56613888;n<128?t.push(n):(n<2048?t.push(n>>6&31|192):(n<65536?t.push(n>>12&15|224):t.push(n>>18&7|240,n>>12&63|128),t.push(n>>6&63|128)),t.push(63&n|128))}}this.addInt8(0),this.startVector(1,t.length,1),this.bb.setPosition(this.space-=t.length);r=0;for(var o=this.space,a=this.bb.bytes();r<t.length;r++)a[o++]=t[r];return this.endVector()},S.Builder.prototype.createLong=function(e,t){return S.Long.create(e,t)},S.ByteBuffer=function(e){this.bytes_=e,this.position_=0},S.ByteBuffer.allocate=function(e){return new S.ByteBuffer(new Uint8Array(e))},S.ByteBuffer.prototype.clear=function(){this.position_=0},S.ByteBuffer.prototype.bytes=function(){return this.bytes_},S.ByteBuffer.prototype.position=function(){return this.position_},S.ByteBuffer.prototype.setPosition=function(e){this.position_=e},S.ByteBuffer.prototype.capacity=function(){return this.bytes_.length},S.ByteBuffer.prototype.readInt8=function(e){return this.readUint8(e)<<24>>24},S.ByteBuffer.prototype.readUint8=function(e){return this.bytes_[e]},S.ByteBuffer.prototype.readInt16=function(e){return this.readUint16(e)<<16>>16},S.ByteBuffer.prototype.readUint16=function(e){return this.bytes_[e]|this.bytes_[e+1]<<8},S.ByteBuffer.prototype.readInt32=function(e){return this.bytes_[e]|this.bytes_[e+1]<<8|this.bytes_[e+2]<<16|this.bytes_[e+3]<<24},S.ByteBuffer.prototype.readUint32=function(e){return this.readInt32(e)>>>0},S.ByteBuffer.prototype.readInt64=function(e){return new S.Long(this.readInt32(e),this.readInt32(e+4))},S.ByteBuffer.prototype.readUint64=function(e){return new S.Long(this.readUint32(e),this.readUint32(e+4))},S.ByteBuffer.prototype.readFloat32=function(e){return S.int32[0]=this.readInt32(e),S.float32[0]},S.ByteBuffer.prototype.readFloat64=function(e){return S.int32[S.isLittleEndian?0:1]=this.readInt32(e),S.int32[S.isLittleEndian?1:0]=this.readInt32(e+4),S.float64[0]},S.ByteBuffer.prototype.writeInt8=function(e,t){this.bytes_[e]=t},S.ByteBuffer.prototype.writeUint8=function(e,t){this.bytes_[e]=t},S.ByteBuffer.prototype.writeInt16=function(e,t){this.bytes_[e]=t,this.bytes_[e+1]=t>>8},S.ByteBuffer.prototype.writeUint16=function(e,t){this.bytes_[e]=t,this.bytes_[e+1]=t>>8},S.ByteBuffer.prototype.writeInt32=function(e,t){this.bytes_[e]=t,this.bytes_[e+1]=t>>8,this.bytes_[e+2]=t>>16,this.bytes_[e+3]=t>>24},S.ByteBuffer.prototype.writeUint32=function(e,t){this.bytes_[e]=t,this.bytes_[e+1]=t>>8,this.bytes_[e+2]=t>>16,this.bytes_[e+3]=t>>24},S.ByteBuffer.prototype.writeInt64=function(e,t){this.writeInt32(e,t.low),this.writeInt32(e+4,t.high)},S.ByteBuffer.prototype.writeUint64=function(e,t){this.writeUint32(e,t.low),this.writeUint32(e+4,t.high)},S.ByteBuffer.prototype.writeFloat32=function(e,t){S.float32[0]=t,this.writeInt32(e,S.int32[0])},S.ByteBuffer.prototype.writeFloat64=function(e,t){S.float64[0]=t,this.writeInt32(e,S.int32[S.isLittleEndian?0:1]),this.writeInt32(e+4,S.int32[S.isLittleEndian?1:0])},S.ByteBuffer.prototype.getBufferIdentifier=function(){if(this.bytes_.length<this.position_+S.SIZEOF_INT+S.FILE_IDENTIFIER_LENGTH)throw new Error("FlatBuffers: ByteBuffer is too short to contain an identifier.");for(var e="",t=0;t<S.FILE_IDENTIFIER_LENGTH;t++)e+=String.fromCharCode(this.readInt8(this.position_+S.SIZEOF_INT+t));return e},S.ByteBuffer.prototype.__offset=function(e,t){var r=e-this.readInt32(e);return t<this.readInt16(r)?this.readInt16(r+t):0},S.ByteBuffer.prototype.__union=function(e,t){return e.bb_pos=t+this.readInt32(t),e.bb=this,e},S.ByteBuffer.prototype.__string=function(e,t){e+=this.readInt32(e);var r=this.readInt32(e),n="",i=0;if(e+=S.SIZEOF_INT,t===S.Encoding.UTF8_BYTES)return this.bytes_.subarray(e,e+r);for(;i<r;){var o,a=this.readUint8(e+i++);if(a<192)o=a;else{var s=this.readUint8(e+i++);if(a<224)o=(31&a)<<6|63&s;else{var u=this.readUint8(e+i++);if(a<240)o=(15&a)<<12|(63&s)<<6|63&u;else o=(7&a)<<18|(63&s)<<12|(63&u)<<6|63&this.readUint8(e+i++)}}o<65536?n+=String.fromCharCode(o):(o-=65536,n+=String.fromCharCode(55296+(o>>10),56320+(1023&o)))}return n},S.ByteBuffer.prototype.__indirect=function(e){return e+this.readInt32(e)},S.ByteBuffer.prototype.__vector=function(e){return e+this.readInt32(e)+S.SIZEOF_INT},S.ByteBuffer.prototype.__vector_len=function(e){return this.readInt32(e+this.readInt32(e))},S.ByteBuffer.prototype.__has_identifier=function(e){if(e.length!=S.FILE_IDENTIFIER_LENGTH)throw new Error("FlatBuffers: file identifier must be length "+S.FILE_IDENTIFIER_LENGTH);for(var t=0;t<S.FILE_IDENTIFIER_LENGTH;t++)if(e.charCodeAt(t)!=this.readInt8(this.position_+S.SIZEOF_INT+t))return!1;return!0},S.ByteBuffer.prototype.createLong=function(e,t){return S.Long.create(e,t)}})),H,ln=D((()=>{Jn(),(e=>{let t;(e=>{let t;(e=>{let t;var r;(r=t=e.AttributeType||={})[r.UNDEFINED=0]="UNDEFINED",r[r.FLOAT=1]="FLOAT",r[r.INT=2]="INT",r[r.STRING=3]="STRING",r[r.TENSOR=4]="TENSOR",r[r.GRAPH=5]="GRAPH",r[r.FLOATS=6]="FLOATS",r[r.INTS=7]="INTS",r[r.STRINGS=8]="STRINGS",r[r.TENSORS=9]="TENSORS",r[r.GRAPHS=10]="GRAPHS",r[r.SPARSE_TENSOR=11]="SPARSE_TENSOR",r[r.SPARSE_TENSORS=12]="SPARSE_TENSORS"})(t=e.fbs||={})})(t=e.experimental||={})})(H||={}),(e=>{let t;(e=>{let t;(e=>{let t;var r;(r=t=e.DimensionValueType||={})[r.UNKNOWN=0]="UNKNOWN",r[r.VALUE=1]="VALUE",r[r.PARAM=2]="PARAM"})(t=e.fbs||={})})(t=e.experimental||={})})(H||={}),(e=>{let t;(e=>{let t;(e=>{let t;var r;(r=t=e.TensorDataType||={})[r.UNDEFINED=0]="UNDEFINED",r[r.FLOAT=1]="FLOAT",r[r.UINT8=2]="UINT8",r[r.INT8=3]="INT8",r[r.UINT16=4]="UINT16",r[r.INT16=5]="INT16",r[r.INT32=6]="INT32",r[r.INT64=7]="INT64",r[r.STRING=8]="STRING",r[r.BOOL=9]="BOOL",r[r.FLOAT16=10]="FLOAT16",r[r.DOUBLE=11]="DOUBLE",r[r.UINT32=12]="UINT32",r[r.UINT64=13]="UINT64",r[r.COMPLEX64=14]="COMPLEX64",r[r.COMPLEX128=15]="COMPLEX128",r[r.BFLOAT16=16]="BFLOAT16",r[r.FLOAT8E4M3FN=17]="FLOAT8E4M3FN",r[r.FLOAT8E4M3FNUZ=18]="FLOAT8E4M3FNUZ",r[r.FLOAT8E5M2=19]="FLOAT8E5M2",r[r.FLOAT8E5M2FNUZ=20]="FLOAT8E5M2FNUZ"})(t=e.fbs||={})})(t=e.experimental||={})})(H||={}),(e=>{let t;(e=>{let t;(e=>{let t;var r;(r=t=e.NodeType||={})[r.Primitive=0]="Primitive",r[r.Fused=1]="Fused"})(t=e.fbs||={})})(t=e.experimental||={})})(H||={}),(e=>{let t;(e=>{let t;(e=>{let t;var r;(r=t=e.TypeInfoValue||={})[r.NONE=0]="NONE",r[r.tensor_type=1]="tensor_type",r[r.sequence_type=2]="sequence_type",r[r.map_type=3]="map_type"})(t=e.fbs||={})})(t=e.experimental||={})})(H||={}),(e=>{let t;(t=>{let r;(t=>{class r{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsShape(e,t){return(t||new r).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsShape(e,t){return e.setPosition(e.position()+S.SIZE_PREFIX_LENGTH),(t||new r).__init(e.readInt32(e.position())+e.position(),e)}dim(t,r){let n=this.bb.__offset(this.bb_pos,4);return n?(r||new e.experimental.fbs.Dimension).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+n)+4*t),this.bb):null}dimLength(){let e=this.bb.__offset(this.bb_pos,4);return e?this.bb.__vector_len(this.bb_pos+e):0}static startShape(e){e.startObject(1)}static addDim(e,t){e.addFieldOffset(0,t,0)}static createDimVector(e,t){e.startVector(4,t.length,4);for(let r=t.length-1;r>=0;r--)e.addOffset(t[r]);return e.endVector()}static startDimVector(e,t){e.startVector(4,t,4)}static endShape(e){return e.endObject()}static createShape(e,t){return r.startShape(e),r.addDim(e,t),r.endShape(e)}}t.Shape=r})(r=t.fbs||={})})(t=e.experimental||={})})(H||={}),(e=>{let t;(t=>{let r;(t=>{class r{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsDimension(e,t){return(t||new r).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsDimension(e,t){return e.setPosition(e.position()+S.SIZE_PREFIX_LENGTH),(t||new r).__init(e.readInt32(e.position())+e.position(),e)}value(t){let r=this.bb.__offset(this.bb_pos,4);return r?(t||new e.experimental.fbs.DimensionValue).__init(this.bb.__indirect(this.bb_pos+r),this.bb):null}denotation(e){let t=this.bb.__offset(this.bb_pos,6);return t?this.bb.__string(this.bb_pos+t,e):null}static startDimension(e){e.startObject(2)}static addValue(e,t){e.addFieldOffset(0,t,0)}static addDenotation(e,t){e.addFieldOffset(1,t,0)}static endDimension(e){return e.endObject()}static createDimension(e,t,n){return r.startDimension(e),r.addValue(e,t),r.addDenotation(e,n),r.endDimension(e)}}t.Dimension=r})(r=t.fbs||={})})(t=e.experimental||={})})(H||={}),(e=>{let t;(e=>{let t;(e=>{class t{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsDimensionValue(e,r){return(r||new t).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsDimensionValue(e,r){return e.setPosition(e.position()+S.SIZE_PREFIX_LENGTH),(r||new t).__init(e.readInt32(e.position())+e.position(),e)}dimType(){let e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readInt8(this.bb_pos+e):0}dimValue(){let e=this.bb.__offset(this.bb_pos,6);return e?this.bb.readInt64(this.bb_pos+e):this.bb.createLong(0,0)}dimParam(e){let t=this.bb.__offset(this.bb_pos,8);return t?this.bb.__string(this.bb_pos+t,e):null}static startDimensionValue(e){e.startObject(3)}static addDimType(e,t){e.addFieldInt8(0,t,0)}static addDimValue(e,t){e.addFieldInt64(1,t,e.createLong(0,0))}static addDimParam(e,t){e.addFieldOffset(2,t,0)}static endDimensionValue(e){return e.endObject()}static createDimensionValue(e,r,n,i){return t.startDimensionValue(e),t.addDimType(e,r),t.addDimValue(e,n),t.addDimParam(e,i),t.endDimensionValue(e)}}e.DimensionValue=t})(t=e.fbs||={})})(t=e.experimental||={})})(H||={}),(e=>{let t;(t=>{let r;(t=>{class r{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsTensorTypeAndShape(e,t){return(t||new r).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsTensorTypeAndShape(e,t){return e.setPosition(e.position()+S.SIZE_PREFIX_LENGTH),(t||new r).__init(e.readInt32(e.position())+e.position(),e)}elemType(){let e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readInt32(this.bb_pos+e):0}shape(t){let r=this.bb.__offset(this.bb_pos,6);return r?(t||new e.experimental.fbs.Shape).__init(this.bb.__indirect(this.bb_pos+r),this.bb):null}static startTensorTypeAndShape(e){e.startObject(2)}static addElemType(e,t){e.addFieldInt32(0,t,0)}static addShape(e,t){e.addFieldOffset(1,t,0)}static endTensorTypeAndShape(e){return e.endObject()}static createTensorTypeAndShape(e,t,n){return r.startTensorTypeAndShape(e),r.addElemType(e,t),r.addShape(e,n),r.endTensorTypeAndShape(e)}}t.TensorTypeAndShape=r})(r=t.fbs||={})})(t=e.experimental||={})})(H||={}),(e=>{let t;(t=>{let r;(t=>{class r{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsMapType(e,t){return(t||new r).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsMapType(e,t){return e.setPosition(e.position()+S.SIZE_PREFIX_LENGTH),(t||new r).__init(e.readInt32(e.position())+e.position(),e)}keyType(){let e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readInt32(this.bb_pos+e):0}valueType(t){let r=this.bb.__offset(this.bb_pos,6);return r?(t||new e.experimental.fbs.TypeInfo).__init(this.bb.__indirect(this.bb_pos+r),this.bb):null}static startMapType(e){e.startObject(2)}static addKeyType(e,t){e.addFieldInt32(0,t,0)}static addValueType(e,t){e.addFieldOffset(1,t,0)}static endMapType(e){return e.endObject()}static createMapType(e,t,n){return r.startMapType(e),r.addKeyType(e,t),r.addValueType(e,n),r.endMapType(e)}}t.MapType=r})(r=t.fbs||={})})(t=e.experimental||={})})(H||={}),(e=>{let t;(t=>{let r;(t=>{class r{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsSequenceType(e,t){return(t||new r).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsSequenceType(e,t){return e.setPosition(e.position()+S.SIZE_PREFIX_LENGTH),(t||new r).__init(e.readInt32(e.position())+e.position(),e)}elemType(t){let r=this.bb.__offset(this.bb_pos,4);return r?(t||new e.experimental.fbs.TypeInfo).__init(this.bb.__indirect(this.bb_pos+r),this.bb):null}static startSequenceType(e){e.startObject(1)}static addElemType(e,t){e.addFieldOffset(0,t,0)}static endSequenceType(e){return e.endObject()}static createSequenceType(e,t){return r.startSequenceType(e),r.addElemType(e,t),r.endSequenceType(e)}}t.SequenceType=r})(r=t.fbs||={})})(t=e.experimental||={})})(H||={}),(e=>{let t;(e=>{let t;(t=e.fbs||={}).EdgeEnd=class{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}nodeIndex(){return this.bb.readUint32(this.bb_pos)}srcArgIndex(){return this.bb.readInt32(this.bb_pos+4)}dstArgIndex(){return this.bb.readInt32(this.bb_pos+8)}static createEdgeEnd(e,t,r,n){return e.prep(4,12),e.writeInt32(n),e.writeInt32(r),e.writeInt32(t),e.offset()}}})(t=e.experimental||={})})(H||={}),(e=>{let t;(t=>{let r;(t=>{class r{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsNodeEdge(e,t){return(t||new r).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsNodeEdge(e,t){return e.setPosition(e.position()+S.SIZE_PREFIX_LENGTH),(t||new r).__init(e.readInt32(e.position())+e.position(),e)}nodeIndex(){let e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readUint32(this.bb_pos+e):0}inputEdges(t,r){let n=this.bb.__offset(this.bb_pos,6);return n?(r||new e.experimental.fbs.EdgeEnd).__init(this.bb.__vector(this.bb_pos+n)+12*t,this.bb):null}inputEdgesLength(){let e=this.bb.__offset(this.bb_pos,6);return e?this.bb.__vector_len(this.bb_pos+e):0}outputEdges(t,r){let n=this.bb.__offset(this.bb_pos,8);return n?(r||new e.experimental.fbs.EdgeEnd).__init(this.bb.__vector(this.bb_pos+n)+12*t,this.bb):null}outputEdgesLength(){let e=this.bb.__offset(this.bb_pos,8);return e?this.bb.__vector_len(this.bb_pos+e):0}static startNodeEdge(e){e.startObject(3)}static addNodeIndex(e,t){e.addFieldInt32(0,t,0)}static addInputEdges(e,t){e.addFieldOffset(1,t,0)}static startInputEdgesVector(e,t){e.startVector(12,t,4)}static addOutputEdges(e,t){e.addFieldOffset(2,t,0)}static startOutputEdgesVector(e,t){e.startVector(12,t,4)}static endNodeEdge(e){return e.endObject()}static createNodeEdge(e,t,n,i){return r.startNodeEdge(e),r.addNodeIndex(e,t),r.addInputEdges(e,n),r.addOutputEdges(e,i),r.endNodeEdge(e)}}t.NodeEdge=r})(r=t.fbs||={})})(t=e.experimental||={})})(H||={}),(e=>{let t;(t=>{let r;(t=>{class r{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsNode(e,t){return(t||new r).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsNode(e,t){return e.setPosition(e.position()+S.SIZE_PREFIX_LENGTH),(t||new r).__init(e.readInt32(e.position())+e.position(),e)}name(e){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.__string(this.bb_pos+t,e):null}docString(e){let t=this.bb.__offset(this.bb_pos,6);return t?this.bb.__string(this.bb_pos+t,e):null}domain(e){let t=this.bb.__offset(this.bb_pos,8);return t?this.bb.__string(this.bb_pos+t,e):null}sinceVersion(){let e=this.bb.__offset(this.bb_pos,10);return e?this.bb.readInt32(this.bb_pos+e):0}index(){let e=this.bb.__offset(this.bb_pos,12);return e?this.bb.readUint32(this.bb_pos+e):0}opType(e){let t=this.bb.__offset(this.bb_pos,14);return t?this.bb.__string(this.bb_pos+t,e):null}type(){let e=this.bb.__offset(this.bb_pos,16);return e?this.bb.readInt32(this.bb_pos+e):0}executionProviderType(e){let t=this.bb.__offset(this.bb_pos,18);return t?this.bb.__string(this.bb_pos+t,e):null}inputs(e,t){let r=this.bb.__offset(this.bb_pos,20);return r?this.bb.__string(this.bb.__vector(this.bb_pos+r)+4*e,t):null}inputsLength(){let e=this.bb.__offset(this.bb_pos,20);return e?this.bb.__vector_len(this.bb_pos+e):0}outputs(e,t){let r=this.bb.__offset(this.bb_pos,22);return r?this.bb.__string(this.bb.__vector(this.bb_pos+r)+4*e,t):null}outputsLength(){let e=this.bb.__offset(this.bb_pos,22);return e?this.bb.__vector_len(this.bb_pos+e):0}attributes(t,r){let n=this.bb.__offset(this.bb_pos,24);return n?(r||new e.experimental.fbs.Attribute).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+n)+4*t),this.bb):null}attributesLength(){let e=this.bb.__offset(this.bb_pos,24);return e?this.bb.__vector_len(this.bb_pos+e):0}inputArgCounts(e){let t=this.bb.__offset(this.bb_pos,26);return t?this.bb.readInt32(this.bb.__vector(this.bb_pos+t)+4*e):0}inputArgCountsLength(){let e=this.bb.__offset(this.bb_pos,26);return e?this.bb.__vector_len(this.bb_pos+e):0}inputArgCountsArray(){let e=this.bb.__offset(this.bb_pos,26);return e?new Int32Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+e),this.bb.__vector_len(this.bb_pos+e)):null}implicitInputs(e,t){let r=this.bb.__offset(this.bb_pos,28);return r?this.bb.__string(this.bb.__vector(this.bb_pos+r)+4*e,t):null}implicitInputsLength(){let e=this.bb.__offset(this.bb_pos,28);return e?this.bb.__vector_len(this.bb_pos+e):0}static startNode(e){e.startObject(13)}static addName(e,t){e.addFieldOffset(0,t,0)}static addDocString(e,t){e.addFieldOffset(1,t,0)}static addDomain(e,t){e.addFieldOffset(2,t,0)}static addSinceVersion(e,t){e.addFieldInt32(3,t,0)}static addIndex(e,t){e.addFieldInt32(4,t,0)}static addOpType(e,t){e.addFieldOffset(5,t,0)}static addType(e,t){e.addFieldInt32(6,t,0)}static addExecutionProviderType(e,t){e.addFieldOffset(7,t,0)}static addInputs(e,t){e.addFieldOffset(8,t,0)}static createInputsVector(e,t){e.startVector(4,t.length,4);for(let r=t.length-1;r>=0;r--)e.addOffset(t[r]);return e.endVector()}static startInputsVector(e,t){e.startVector(4,t,4)}static addOutputs(e,t){e.addFieldOffset(9,t,0)}static createOutputsVector(e,t){e.startVector(4,t.length,4);for(let r=t.length-1;r>=0;r--)e.addOffset(t[r]);return e.endVector()}static startOutputsVector(e,t){e.startVector(4,t,4)}static addAttributes(e,t){e.addFieldOffset(10,t,0)}static createAttributesVector(e,t){e.startVector(4,t.length,4);for(let r=t.length-1;r>=0;r--)e.addOffset(t[r]);return e.endVector()}static startAttributesVector(e,t){e.startVector(4,t,4)}static addInputArgCounts(e,t){e.addFieldOffset(11,t,0)}static createInputArgCountsVector(e,t){e.startVector(4,t.length,4);for(let r=t.length-1;r>=0;r--)e.addInt32(t[r]);return e.endVector()}static startInputArgCountsVector(e,t){e.startVector(4,t,4)}static addImplicitInputs(e,t){e.addFieldOffset(12,t,0)}static createImplicitInputsVector(e,t){e.startVector(4,t.length,4);for(let r=t.length-1;r>=0;r--)e.addOffset(t[r]);return e.endVector()}static startImplicitInputsVector(e,t){e.startVector(4,t,4)}static endNode(e){return e.endObject()}static createNode(e,t,n,i,o,a,s,u,l,h,c,f,d,p){return r.startNode(e),r.addName(e,t),r.addDocString(e,n),r.addDomain(e,i),r.addSinceVersion(e,o),r.addIndex(e,a),r.addOpType(e,s),r.addType(e,u),r.addExecutionProviderType(e,l),r.addInputs(e,h),r.addOutputs(e,c),r.addAttributes(e,f),r.addInputArgCounts(e,d),r.addImplicitInputs(e,p),r.endNode(e)}}t.Node=r})(r=t.fbs||={})})(t=e.experimental||={})})(H||={}),(e=>{let t;(t=>{let r;(t=>{class r{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsValueInfo(e,t){return(t||new r).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsValueInfo(e,t){return e.setPosition(e.position()+S.SIZE_PREFIX_LENGTH),(t||new r).__init(e.readInt32(e.position())+e.position(),e)}name(e){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.__string(this.bb_pos+t,e):null}docString(e){let t=this.bb.__offset(this.bb_pos,6);return t?this.bb.__string(this.bb_pos+t,e):null}type(t){let r=this.bb.__offset(this.bb_pos,8);return r?(t||new e.experimental.fbs.TypeInfo).__init(this.bb.__indirect(this.bb_pos+r),this.bb):null}static startValueInfo(e){e.startObject(3)}static addName(e,t){e.addFieldOffset(0,t,0)}static addDocString(e,t){e.addFieldOffset(1,t,0)}static addType(e,t){e.addFieldOffset(2,t,0)}static endValueInfo(e){return e.endObject()}static createValueInfo(e,t,n,i){return r.startValueInfo(e),r.addName(e,t),r.addDocString(e,n),r.addType(e,i),r.endValueInfo(e)}}t.ValueInfo=r})(r=t.fbs||={})})(t=e.experimental||={})})(H||={}),(e=>{let t;(e=>{let t;(e=>{class t{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsTypeInfo(e,r){return(r||new t).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsTypeInfo(e,r){return e.setPosition(e.position()+S.SIZE_PREFIX_LENGTH),(r||new t).__init(e.readInt32(e.position())+e.position(),e)}denotation(e){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.__string(this.bb_pos+t,e):null}valueType(){let e=this.bb.__offset(this.bb_pos,6);return e?this.bb.readUint8(this.bb_pos+e):0}value(e){let t=this.bb.__offset(this.bb_pos,8);return t?this.bb.__union(e,this.bb_pos+t):null}static startTypeInfo(e){e.startObject(3)}static addDenotation(e,t){e.addFieldOffset(0,t,0)}static addValueType(e,t){e.addFieldInt8(1,t,0)}static addValue(e,t){e.addFieldOffset(2,t,0)}static endTypeInfo(e){return e.endObject()}static createTypeInfo(e,r,n,i){return t.startTypeInfo(e),t.addDenotation(e,r),t.addValueType(e,n),t.addValue(e,i),t.endTypeInfo(e)}}e.TypeInfo=t})(t=e.fbs||={})})(t=e.experimental||={})})(H||={}),(e=>{let t;(e=>{let t;(e=>{class t{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsOperatorSetId(e,r){return(r||new t).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsOperatorSetId(e,r){return e.setPosition(e.position()+S.SIZE_PREFIX_LENGTH),(r||new t).__init(e.readInt32(e.position())+e.position(),e)}domain(e){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.__string(this.bb_pos+t,e):null}version(){let e=this.bb.__offset(this.bb_pos,6);return e?this.bb.readInt64(this.bb_pos+e):this.bb.createLong(0,0)}static startOperatorSetId(e){e.startObject(2)}static addDomain(e,t){e.addFieldOffset(0,t,0)}static addVersion(e,t){e.addFieldInt64(1,t,e.createLong(0,0))}static endOperatorSetId(e){return e.endObject()}static createOperatorSetId(e,r,n){return t.startOperatorSetId(e),t.addDomain(e,r),t.addVersion(e,n),t.endOperatorSetId(e)}}e.OperatorSetId=t})(t=e.fbs||={})})(t=e.experimental||={})})(H||={}),(e=>{let t;(e=>{let t;(e=>{class t{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsTensor(e,r){return(r||new t).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsTensor(e,r){return e.setPosition(e.position()+S.SIZE_PREFIX_LENGTH),(r||new t).__init(e.readInt32(e.position())+e.position(),e)}name(e){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.__string(this.bb_pos+t,e):null}docString(e){let t=this.bb.__offset(this.bb_pos,6);return t?this.bb.__string(this.bb_pos+t,e):null}dims(e){let t=this.bb.__offset(this.bb_pos,8);return t?this.bb.readInt64(this.bb.__vector(this.bb_pos+t)+8*e):this.bb.createLong(0,0)}dimsLength(){let e=this.bb.__offset(this.bb_pos,8);return e?this.bb.__vector_len(this.bb_pos+e):0}dataType(){let e=this.bb.__offset(this.bb_pos,10);return e?this.bb.readInt32(this.bb_pos+e):0}rawData(e){let t=this.bb.__offset(this.bb_pos,12);return t?this.bb.readUint8(this.bb.__vector(this.bb_pos+t)+e):0}rawDataLength(){let e=this.bb.__offset(this.bb_pos,12);return e?this.bb.__vector_len(this.bb_pos+e):0}rawDataArray(){let e=this.bb.__offset(this.bb_pos,12);return e?new Uint8Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+e),this.bb.__vector_len(this.bb_pos+e)):null}stringData(e,t){let r=this.bb.__offset(this.bb_pos,14);return r?this.bb.__string(this.bb.__vector(this.bb_pos+r)+4*e,t):null}stringDataLength(){let e=this.bb.__offset(this.bb_pos,14);return e?this.bb.__vector_len(this.bb_pos+e):0}static startTensor(e){e.startObject(6)}static addName(e,t){e.addFieldOffset(0,t,0)}static addDocString(e,t){e.addFieldOffset(1,t,0)}static addDims(e,t){e.addFieldOffset(2,t,0)}static createDimsVector(e,t){e.startVector(8,t.length,8);for(let r=t.length-1;r>=0;r--)e.addInt64(t[r]);return e.endVector()}static startDimsVector(e,t){e.startVector(8,t,8)}static addDataType(e,t){e.addFieldInt32(3,t,0)}static addRawData(e,t){e.addFieldOffset(4,t,0)}static createRawDataVector(e,t){e.startVector(1,t.length,1);for(let r=t.length-1;r>=0;r--)e.addInt8(t[r]);return e.endVector()}static startRawDataVector(e,t){e.startVector(1,t,1)}static addStringData(e,t){e.addFieldOffset(5,t,0)}static createStringDataVector(e,t){e.startVector(4,t.length,4);for(let r=t.length-1;r>=0;r--)e.addOffset(t[r]);return e.endVector()}static startStringDataVector(e,t){e.startVector(4,t,4)}static endTensor(e){return e.endObject()}static createTensor(e,r,n,i,o,a,s){return t.startTensor(e),t.addName(e,r),t.addDocString(e,n),t.addDims(e,i),t.addDataType(e,o),t.addRawData(e,a),t.addStringData(e,s),t.endTensor(e)}}e.Tensor=t})(t=e.fbs||={})})(t=e.experimental||={})})(H||={}),(e=>{let t;(t=>{let r;(t=>{class r{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsSparseTensor(e,t){return(t||new r).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsSparseTensor(e,t){return e.setPosition(e.position()+S.SIZE_PREFIX_LENGTH),(t||new r).__init(e.readInt32(e.position())+e.position(),e)}values(t){let r=this.bb.__offset(this.bb_pos,4);return r?(t||new e.experimental.fbs.Tensor).__init(this.bb.__indirect(this.bb_pos+r),this.bb):null}indices(t){let r=this.bb.__offset(this.bb_pos,6);return r?(t||new e.experimental.fbs.Tensor).__init(this.bb.__indirect(this.bb_pos+r),this.bb):null}dims(e){let t=this.bb.__offset(this.bb_pos,8);return t?this.bb.readInt64(this.bb.__vector(this.bb_pos+t)+8*e):this.bb.createLong(0,0)}dimsLength(){let e=this.bb.__offset(this.bb_pos,8);return e?this.bb.__vector_len(this.bb_pos+e):0}static startSparseTensor(e){e.startObject(3)}static addValues(e,t){e.addFieldOffset(0,t,0)}static addIndices(e,t){e.addFieldOffset(1,t,0)}static addDims(e,t){e.addFieldOffset(2,t,0)}static createDimsVector(e,t){e.startVector(8,t.length,8);for(let r=t.length-1;r>=0;r--)e.addInt64(t[r]);return e.endVector()}static startDimsVector(e,t){e.startVector(8,t,8)}static endSparseTensor(e){return e.endObject()}static createSparseTensor(e,t,n,i){return r.startSparseTensor(e),r.addValues(e,t),r.addIndices(e,n),r.addDims(e,i),r.endSparseTensor(e)}}t.SparseTensor=r})(r=t.fbs||={})})(t=e.experimental||={})})(H||={}),(e=>{let t;(t=>{let r;(t=>{class r{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsAttribute(e,t){return(t||new r).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsAttribute(e,t){return e.setPosition(e.position()+S.SIZE_PREFIX_LENGTH),(t||new r).__init(e.readInt32(e.position())+e.position(),e)}name(e){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.__string(this.bb_pos+t,e):null}docString(e){let t=this.bb.__offset(this.bb_pos,6);return t?this.bb.__string(this.bb_pos+t,e):null}type(){let e=this.bb.__offset(this.bb_pos,8);return e?this.bb.readInt32(this.bb_pos+e):0}f(){let e=this.bb.__offset(this.bb_pos,10);return e?this.bb.readFloat32(this.bb_pos+e):0}i(){let e=this.bb.__offset(this.bb_pos,12);return e?this.bb.readInt64(this.bb_pos+e):this.bb.createLong(0,0)}s(e){let t=this.bb.__offset(this.bb_pos,14);return t?this.bb.__string(this.bb_pos+t,e):null}t(t){let r=this.bb.__offset(this.bb_pos,16);return r?(t||new e.experimental.fbs.Tensor).__init(this.bb.__indirect(this.bb_pos+r),this.bb):null}g(t){let r=this.bb.__offset(this.bb_pos,18);return r?(t||new e.experimental.fbs.Graph).__init(this.bb.__indirect(this.bb_pos+r),this.bb):null}floats(e){let t=this.bb.__offset(this.bb_pos,20);return t?this.bb.readFloat32(this.bb.__vector(this.bb_pos+t)+4*e):0}floatsLength(){let e=this.bb.__offset(this.bb_pos,20);return e?this.bb.__vector_len(this.bb_pos+e):0}floatsArray(){let e=this.bb.__offset(this.bb_pos,20);return e?new Float32Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+e),this.bb.__vector_len(this.bb_pos+e)):null}ints(e){let t=this.bb.__offset(this.bb_pos,22);return t?this.bb.readInt64(this.bb.__vector(this.bb_pos+t)+8*e):this.bb.createLong(0,0)}intsLength(){let e=this.bb.__offset(this.bb_pos,22);return e?this.bb.__vector_len(this.bb_pos+e):0}strings(e,t){let r=this.bb.__offset(this.bb_pos,24);return r?this.bb.__string(this.bb.__vector(this.bb_pos+r)+4*e,t):null}stringsLength(){let e=this.bb.__offset(this.bb_pos,24);return e?this.bb.__vector_len(this.bb_pos+e):0}tensors(t,r){let n=this.bb.__offset(this.bb_pos,26);return n?(r||new e.experimental.fbs.Tensor).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+n)+4*t),this.bb):null}tensorsLength(){let e=this.bb.__offset(this.bb_pos,26);return e?this.bb.__vector_len(this.bb_pos+e):0}graphs(t,r){let n=this.bb.__offset(this.bb_pos,28);return n?(r||new e.experimental.fbs.Graph).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+n)+4*t),this.bb):null}graphsLength(){let e=this.bb.__offset(this.bb_pos,28);return e?this.bb.__vector_len(this.bb_pos+e):0}static startAttribute(e){e.startObject(13)}static addName(e,t){e.addFieldOffset(0,t,0)}static addDocString(e,t){e.addFieldOffset(1,t,0)}static addType(e,t){e.addFieldInt32(2,t,0)}static addF(e,t){e.addFieldFloat32(3,t,0)}static addI(e,t){e.addFieldInt64(4,t,e.createLong(0,0))}static addS(e,t){e.addFieldOffset(5,t,0)}static addT(e,t){e.addFieldOffset(6,t,0)}static addG(e,t){e.addFieldOffset(7,t,0)}static addFloats(e,t){e.addFieldOffset(8,t,0)}static createFloatsVector(e,t){e.startVector(4,t.length,4);for(let r=t.length-1;r>=0;r--)e.addFloat32(t[r]);return e.endVector()}static startFloatsVector(e,t){e.startVector(4,t,4)}static addInts(e,t){e.addFieldOffset(9,t,0)}static createIntsVector(e,t){e.startVector(8,t.length,8);for(let r=t.length-1;r>=0;r--)e.addInt64(t[r]);return e.endVector()}static startIntsVector(e,t){e.startVector(8,t,8)}static addStrings(e,t){e.addFieldOffset(10,t,0)}static createStringsVector(e,t){e.startVector(4,t.length,4);for(let r=t.length-1;r>=0;r--)e.addOffset(t[r]);return e.endVector()}static startStringsVector(e,t){e.startVector(4,t,4)}static addTensors(e,t){e.addFieldOffset(11,t,0)}static createTensorsVector(e,t){e.startVector(4,t.length,4);for(let r=t.length-1;r>=0;r--)e.addOffset(t[r]);return e.endVector()}static startTensorsVector(e,t){e.startVector(4,t,4)}static addGraphs(e,t){e.addFieldOffset(12,t,0)}static createGraphsVector(e,t){e.startVector(4,t.length,4);for(let r=t.length-1;r>=0;r--)e.addOffset(t[r]);return e.endVector()}static startGraphsVector(e,t){e.startVector(4,t,4)}static endAttribute(e){return e.endObject()}static createAttribute(e,t,n,i,o,a,s,u,l,h,c,f,d,p){return r.startAttribute(e),r.addName(e,t),r.addDocString(e,n),r.addType(e,i),r.addF(e,o),r.addI(e,a),r.addS(e,s),r.addT(e,u),r.addG(e,l),r.addFloats(e,h),r.addInts(e,c),r.addStrings(e,f),r.addTensors(e,d),r.addGraphs(e,p),r.endAttribute(e)}}t.Attribute=r})(r=t.fbs||={})})(t=e.experimental||={})})(H||={}),(e=>{let t;(t=>{let r;(t=>{class r{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsGraph(e,t){return(t||new r).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsGraph(e,t){return e.setPosition(e.position()+S.SIZE_PREFIX_LENGTH),(t||new r).__init(e.readInt32(e.position())+e.position(),e)}initializers(t,r){let n=this.bb.__offset(this.bb_pos,4);return n?(r||new e.experimental.fbs.Tensor).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+n)+4*t),this.bb):null}initializersLength(){let e=this.bb.__offset(this.bb_pos,4);return e?this.bb.__vector_len(this.bb_pos+e):0}nodeArgs(t,r){let n=this.bb.__offset(this.bb_pos,6);return n?(r||new e.experimental.fbs.ValueInfo).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+n)+4*t),this.bb):null}nodeArgsLength(){let e=this.bb.__offset(this.bb_pos,6);return e?this.bb.__vector_len(this.bb_pos+e):0}nodes(t,r){let n=this.bb.__offset(this.bb_pos,8);return n?(r||new e.experimental.fbs.Node).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+n)+4*t),this.bb):null}nodesLength(){let e=this.bb.__offset(this.bb_pos,8);return e?this.bb.__vector_len(this.bb_pos+e):0}maxNodeIndex(){let e=this.bb.__offset(this.bb_pos,10);return e?this.bb.readUint32(this.bb_pos+e):0}nodeEdges(t,r){let n=this.bb.__offset(this.bb_pos,12);return n?(r||new e.experimental.fbs.NodeEdge).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+n)+4*t),this.bb):null}nodeEdgesLength(){let e=this.bb.__offset(this.bb_pos,12);return e?this.bb.__vector_len(this.bb_pos+e):0}inputs(e,t){let r=this.bb.__offset(this.bb_pos,14);return r?this.bb.__string(this.bb.__vector(this.bb_pos+r)+4*e,t):null}inputsLength(){let e=this.bb.__offset(this.bb_pos,14);return e?this.bb.__vector_len(this.bb_pos+e):0}outputs(e,t){let r=this.bb.__offset(this.bb_pos,16);return r?this.bb.__string(this.bb.__vector(this.bb_pos+r)+4*e,t):null}outputsLength(){let e=this.bb.__offset(this.bb_pos,16);return e?this.bb.__vector_len(this.bb_pos+e):0}sparseInitializers(t,r){let n=this.bb.__offset(this.bb_pos,18);return n?(r||new e.experimental.fbs.SparseTensor).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+n)+4*t),this.bb):null}sparseInitializersLength(){let e=this.bb.__offset(this.bb_pos,18);return e?this.bb.__vector_len(this.bb_pos+e):0}static startGraph(e){e.startObject(8)}static addInitializers(e,t){e.addFieldOffset(0,t,0)}static createInitializersVector(e,t){e.startVector(4,t.length,4);for(let r=t.length-1;r>=0;r--)e.addOffset(t[r]);return e.endVector()}static startInitializersVector(e,t){e.startVector(4,t,4)}static addNodeArgs(e,t){e.addFieldOffset(1,t,0)}static createNodeArgsVector(e,t){e.startVector(4,t.length,4);for(let r=t.length-1;r>=0;r--)e.addOffset(t[r]);return e.endVector()}static startNodeArgsVector(e,t){e.startVector(4,t,4)}static addNodes(e,t){e.addFieldOffset(2,t,0)}static createNodesVector(e,t){e.startVector(4,t.length,4);for(let r=t.length-1;r>=0;r--)e.addOffset(t[r]);return e.endVector()}static startNodesVector(e,t){e.startVector(4,t,4)}static addMaxNodeIndex(e,t){e.addFieldInt32(3,t,0)}static addNodeEdges(e,t){e.addFieldOffset(4,t,0)}static createNodeEdgesVector(e,t){e.startVector(4,t.length,4);for(let r=t.length-1;r>=0;r--)e.addOffset(t[r]);return e.endVector()}static startNodeEdgesVector(e,t){e.startVector(4,t,4)}static addInputs(e,t){e.addFieldOffset(5,t,0)}static createInputsVector(e,t){e.startVector(4,t.length,4);for(let r=t.length-1;r>=0;r--)e.addOffset(t[r]);return e.endVector()}static startInputsVector(e,t){e.startVector(4,t,4)}static addOutputs(e,t){e.addFieldOffset(6,t,0)}static createOutputsVector(e,t){e.startVector(4,t.length,4);for(let r=t.length-1;r>=0;r--)e.addOffset(t[r]);return e.endVector()}static startOutputsVector(e,t){e.startVector(4,t,4)}static addSparseInitializers(e,t){e.addFieldOffset(7,t,0)}static createSparseInitializersVector(e,t){e.startVector(4,t.length,4);for(let r=t.length-1;r>=0;r--)e.addOffset(t[r]);return e.endVector()}static startSparseInitializersVector(e,t){e.startVector(4,t,4)}static endGraph(e){return e.endObject()}static createGraph(e,t,n,i,o,a,s,u,l){return r.startGraph(e),r.addInitializers(e,t),r.addNodeArgs(e,n),r.addNodes(e,i),r.addMaxNodeIndex(e,o),r.addNodeEdges(e,a),r.addInputs(e,s),r.addOutputs(e,u),r.addSparseInitializers(e,l),r.endGraph(e)}}t.Graph=r})(r=t.fbs||={})})(t=e.experimental||={})})(H||={}),(e=>{let t;(t=>{let r;(t=>{class r{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsModel(e,t){return(t||new r).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsModel(e,t){return e.setPosition(e.position()+S.SIZE_PREFIX_LENGTH),(t||new r).__init(e.readInt32(e.position())+e.position(),e)}irVersion(){let e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readInt64(this.bb_pos+e):this.bb.createLong(0,0)}opsetImport(t,r){let n=this.bb.__offset(this.bb_pos,6);return n?(r||new e.experimental.fbs.OperatorSetId).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+n)+4*t),this.bb):null}opsetImportLength(){let e=this.bb.__offset(this.bb_pos,6);return e?this.bb.__vector_len(this.bb_pos+e):0}producerName(e){let t=this.bb.__offset(this.bb_pos,8);return t?this.bb.__string(this.bb_pos+t,e):null}producerVersion(e){let t=this.bb.__offset(this.bb_pos,10);return t?this.bb.__string(this.bb_pos+t,e):null}domain(e){let t=this.bb.__offset(this.bb_pos,12);return t?this.bb.__string(this.bb_pos+t,e):null}modelVersion(){let e=this.bb.__offset(this.bb_pos,14);return e?this.bb.readInt64(this.bb_pos+e):this.bb.createLong(0,0)}docString(e){let t=this.bb.__offset(this.bb_pos,16);return t?this.bb.__string(this.bb_pos+t,e):null}graph(t){let r=this.bb.__offset(this.bb_pos,18);return r?(t||new e.experimental.fbs.Graph).__init(this.bb.__indirect(this.bb_pos+r),this.bb):null}graphDocString(e){let t=this.bb.__offset(this.bb_pos,20);return t?this.bb.__string(this.bb_pos+t,e):null}static startModel(e){e.startObject(9)}static addIrVersion(e,t){e.addFieldInt64(0,t,e.createLong(0,0))}static addOpsetImport(e,t){e.addFieldOffset(1,t,0)}static createOpsetImportVector(e,t){e.startVector(4,t.length,4);for(let r=t.length-1;r>=0;r--)e.addOffset(t[r]);return e.endVector()}static startOpsetImportVector(e,t){e.startVector(4,t,4)}static addProducerName(e,t){e.addFieldOffset(2,t,0)}static addProducerVersion(e,t){e.addFieldOffset(3,t,0)}static addDomain(e,t){e.addFieldOffset(4,t,0)}static addModelVersion(e,t){e.addFieldInt64(5,t,e.createLong(0,0))}static addDocString(e,t){e.addFieldOffset(6,t,0)}static addGraph(e,t){e.addFieldOffset(7,t,0)}static addGraphDocString(e,t){e.addFieldOffset(8,t,0)}static endModel(e){return e.endObject()}static createModel(e,t,n,i,o,a,s,u,l,h){return r.startModel(e),r.addIrVersion(e,t),r.addOpsetImport(e,n),r.addProducerName(e,i),r.addProducerVersion(e,o),r.addDomain(e,a),r.addModelVersion(e,s),r.addDocString(e,u),r.addGraph(e,l),r.addGraphDocString(e,h),r.endModel(e)}}t.Model=r})(r=t.fbs||={})})(t=e.experimental||={})})(H||={}),(e=>{let t;(e=>{let t;(e=>{class t{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsKernelCreateInfos(e,r){return(r||new t).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsKernelCreateInfos(e,r){return e.setPosition(e.position()+S.SIZE_PREFIX_LENGTH),(r||new t).__init(e.readInt32(e.position())+e.position(),e)}nodeIndices(e){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readUint32(this.bb.__vector(this.bb_pos+t)+4*e):0}nodeIndicesLength(){let e=this.bb.__offset(this.bb_pos,4);return e?this.bb.__vector_len(this.bb_pos+e):0}nodeIndicesArray(){let e=this.bb.__offset(this.bb_pos,4);return e?new Uint32Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+e),this.bb.__vector_len(this.bb_pos+e)):null}kernelDefHashes(e){let t=this.bb.__offset(this.bb_pos,6);return t?this.bb.readUint64(this.bb.__vector(this.bb_pos+t)+8*e):this.bb.createLong(0,0)}kernelDefHashesLength(){let e=this.bb.__offset(this.bb_pos,6);return e?this.bb.__vector_len(this.bb_pos+e):0}static startKernelCreateInfos(e){e.startObject(2)}static addNodeIndices(e,t){e.addFieldOffset(0,t,0)}static createNodeIndicesVector(e,t){e.startVector(4,t.length,4);for(let r=t.length-1;r>=0;r--)e.addInt32(t[r]);return e.endVector()}static startNodeIndicesVector(e,t){e.startVector(4,t,4)}static addKernelDefHashes(e,t){e.addFieldOffset(1,t,0)}static createKernelDefHashesVector(e,t){e.startVector(8,t.length,8);for(let r=t.length-1;r>=0;r--)e.addInt64(t[r]);return e.endVector()}static startKernelDefHashesVector(e,t){e.startVector(8,t,8)}static endKernelCreateInfos(e){return e.endObject()}static createKernelCreateInfos(e,r,n){return t.startKernelCreateInfos(e),t.addNodeIndices(e,r),t.addKernelDefHashes(e,n),t.endKernelCreateInfos(e)}}e.KernelCreateInfos=t})(t=e.fbs||={})})(t=e.experimental||={})})(H||={}),(e=>{let t;(t=>{let r;(t=>{class r{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsSubGraphSessionState(e,t){return(t||new r).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsSubGraphSessionState(e,t){return e.setPosition(e.position()+S.SIZE_PREFIX_LENGTH),(t||new r).__init(e.readInt32(e.position())+e.position(),e)}graphId(e){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.__string(this.bb_pos+t,e):null}sessionState(t){let r=this.bb.__offset(this.bb_pos,6);return r?(t||new e.experimental.fbs.SessionState).__init(this.bb.__indirect(this.bb_pos+r),this.bb):null}static startSubGraphSessionState(e){e.startObject(2)}static addGraphId(e,t){e.addFieldOffset(0,t,0)}static addSessionState(e,t){e.addFieldOffset(1,t,0)}static endSubGraphSessionState(e){let t=e.endObject();return e.requiredField(t,4),t}static createSubGraphSessionState(e,t,n){return r.startSubGraphSessionState(e),r.addGraphId(e,t),r.addSessionState(e,n),r.endSubGraphSessionState(e)}}t.SubGraphSessionState=r})(r=t.fbs||={})})(t=e.experimental||={})})(H||={}),(e=>{let t;(t=>{let r;(t=>{class r{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsSessionState(e,t){return(t||new r).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsSessionState(e,t){return e.setPosition(e.position()+S.SIZE_PREFIX_LENGTH),(t||new r).__init(e.readInt32(e.position())+e.position(),e)}kernels(t){let r=this.bb.__offset(this.bb_pos,4);return r?(t||new e.experimental.fbs.KernelCreateInfos).__init(this.bb.__indirect(this.bb_pos+r),this.bb):null}subGraphSessionStates(t,r){let n=this.bb.__offset(this.bb_pos,6);return n?(r||new e.experimental.fbs.SubGraphSessionState).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+n)+4*t),this.bb):null}subGraphSessionStatesLength(){let e=this.bb.__offset(this.bb_pos,6);return e?this.bb.__vector_len(this.bb_pos+e):0}static startSessionState(e){e.startObject(2)}static addKernels(e,t){e.addFieldOffset(0,t,0)}static addSubGraphSessionStates(e,t){e.addFieldOffset(1,t,0)}static createSubGraphSessionStatesVector(e,t){e.startVector(4,t.length,4);for(let r=t.length-1;r>=0;r--)e.addOffset(t[r]);return e.endVector()}static startSubGraphSessionStatesVector(e,t){e.startVector(4,t,4)}static endSessionState(e){return e.endObject()}static createSessionState(e,t,n){return r.startSessionState(e),r.addKernels(e,t),r.addSubGraphSessionStates(e,n),r.endSessionState(e)}}t.SessionState=r})(r=t.fbs||={})})(t=e.experimental||={})})(H||={}),(e=>{let t;(t=>{let r;(t=>{class r{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsInferenceSession(e,t){return(t||new r).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsInferenceSession(e,t){return e.setPosition(e.position()+S.SIZE_PREFIX_LENGTH),(t||new r).__init(e.readInt32(e.position())+e.position(),e)}static bufferHasIdentifier(e){return e.__has_identifier("ORTM")}ortVersion(e){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.__string(this.bb_pos+t,e):null}model(t){let r=this.bb.__offset(this.bb_pos,6);return r?(t||new e.experimental.fbs.Model).__init(this.bb.__indirect(this.bb_pos+r),this.bb):null}sessionState(t){let r=this.bb.__offset(this.bb_pos,8);return r?(t||new e.experimental.fbs.SessionState).__init(this.bb.__indirect(this.bb_pos+r),this.bb):null}static startInferenceSession(e){e.startObject(3)}static addOrtVersion(e,t){e.addFieldOffset(0,t,0)}static addModel(e,t){e.addFieldOffset(1,t,0)}static addSessionState(e,t){e.addFieldOffset(2,t,0)}static endInferenceSession(e){return e.endObject()}static finishInferenceSessionBuffer(e,t){e.finish(t,"ORTM")}static finishSizePrefixedInferenceSessionBuffer(e,t){e.finish(t,"ORTM",!0)}static createInferenceSession(e,t,n,i){return r.startInferenceSession(e),r.addOrtVersion(e,t),r.addModel(e,n),r.addSessionState(e,i),r.endInferenceSession(e)}}t.InferenceSession=r})(r=t.fbs||={})})(t=e.experimental||={})})(H||={})})),Ws=ye(((e,t)=>{t.exports=function(e,t){for(var r=new Array(arguments.length-1),n=0,i=2,o=!0;i<arguments.length;)r[n++]=arguments[i++];return new Promise((function(i,a){r[n]=function(e){if(o)if(o=!1,e)a(e);else{for(var t=new Array(arguments.length-1),r=0;r<t.length;)t[r++]=arguments[r];i.apply(null,t)}};try{e.apply(t||null,r)}catch(e){o&&(o=!1,a(e))}}))}})),qs=ye((e=>{var t=e;t.length=function(e){var t=e.length;if(!t)return 0;for(var r=0;--t%4>1&&"="===e.charAt(t);)++r;return Math.ceil(3*e.length)/4-r};var r,n=new Array(64),i=new Array(123);for(r=0;r<64;)i[n[r]=r<26?r+65:r<52?r+71:r<62?r-4:r-59|43]=r++;t.encode=function(e,t,r){for(var i,o=null,a=[],s=0,u=0;t<r;){var l=e[t++];switch(u){case 0:a[s++]=n[l>>2],i=(3&l)<<4,u=1;break;case 1:a[s++]=n[i|l>>4],i=(15&l)<<2,u=2;break;case 2:a[s++]=n[i|l>>6],a[s++]=n[63&l],u=0}s>8191&&((o||(o=[])).push(String.fromCharCode.apply(String,a)),s=0)}return u&&(a[s++]=n[i],a[s++]=61,1===u&&(a[s++]=61)),o?(s&&o.push(String.fromCharCode.apply(String,a.slice(0,s))),o.join("")):String.fromCharCode.apply(String,a.slice(0,s))};var o="invalid encoding";t.decode=function(e,t,r){for(var n,a=r,s=0,u=0;u<e.length;){var l=e.charCodeAt(u++);if(61===l&&s>1)break;if(void 0===(l=i[l]))throw Error(o);switch(s){case 0:n=l,s=1;break;case 1:t[r++]=n<<2|(48&l)>>4,n=l,s=2;break;case 2:t[r++]=(15&n)<<4|(60&l)>>2,n=l,s=3;break;case 3:t[r++]=(3&n)<<6|l,s=0}}if(1===s)throw Error(o);return r-a},t.test=function(e){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(e)}})),Xs=ye(((e,t)=>{function r(){this._listeners={}}t.exports=r,r.prototype.on=function(e,t,r){return(this._listeners[e]||(this._listeners[e]=[])).push({fn:t,ctx:r||this}),this},r.prototype.off=function(e,t){if(void 0===e)this._listeners={};else if(void 0===t)this._listeners[e]=[];else for(var r=this._listeners[e],n=0;n<r.length;)r[n].fn===t?r.splice(n,1):++n;return this},r.prototype.emit=function(e){var t=this._listeners[e];if(t){for(var r=[],n=1;n<arguments.length;)r.push(arguments[n++]);for(n=0;n<t.length;)t[n].fn.apply(t[n++].ctx,r)}return this}})),ru=ye(((e,t)=>{function r(e){return typeof Float32Array<"u"?function(){var t=new Float32Array([-0]),r=new Uint8Array(t.buffer),n=128===r[3];function i(e,n,i){t[0]=e,n[i]=r[0],n[i+1]=r[1],n[i+2]=r[2],n[i+3]=r[3]}function o(e,n,i){t[0]=e,n[i]=r[3],n[i+1]=r[2],n[i+2]=r[1],n[i+3]=r[0]}function a(e,n){return r[0]=e[n],r[1]=e[n+1],r[2]=e[n+2],r[3]=e[n+3],t[0]}function s(e,n){return r[3]=e[n],r[2]=e[n+1],r[1]=e[n+2],r[0]=e[n+3],t[0]}e.writeFloatLE=n?i:o,e.writeFloatBE=n?o:i,e.readFloatLE=n?a:s,e.readFloatBE=n?s:a}():function(){function t(e,t,r,n){var i=t<0?1:0;if(i&&(t=-t),0===t)e(1/t>0?0:2147483648,r,n);else if(isNaN(t))e(2143289344,r,n);else if(t>34028234663852886e22)e((i<<31|2139095040)>>>0,r,n);else if(t<11754943508222875e-54)e((i<<31|Math.round(t/1401298464324817e-60))>>>0,r,n);else{var o=Math.floor(Math.log(t)/Math.LN2);e((i<<31|o+127<<23|8388607&Math.round(t*Math.pow(2,-o)*8388608))>>>0,r,n)}}function r(e,t,r){var n=e(t,r),i=2*(n>>31)+1,o=n>>>23&255,a=8388607&n;return 255===o?a?NaN:i*(1/0):0===o?1401298464324817e-60*i*a:i*Math.pow(2,o-150)*(a+8388608)}e.writeFloatLE=t.bind(null,n),e.writeFloatBE=t.bind(null,i),e.readFloatLE=r.bind(null,o),e.readFloatBE=r.bind(null,a)}(),typeof Float64Array<"u"?function(){var t=new Float64Array([-0]),r=new Uint8Array(t.buffer),n=128===r[7];function i(e,n,i){t[0]=e,n[i]=r[0],n[i+1]=r[1],n[i+2]=r[2],n[i+3]=r[3],n[i+4]=r[4],n[i+5]=r[5],n[i+6]=r[6],n[i+7]=r[7]}function o(e,n,i){t[0]=e,n[i]=r[7],n[i+1]=r[6],n[i+2]=r[5],n[i+3]=r[4],n[i+4]=r[3],n[i+5]=r[2],n[i+6]=r[1],n[i+7]=r[0]}function a(e,n){return r[0]=e[n],r[1]=e[n+1],r[2]=e[n+2],r[3]=e[n+3],r[4]=e[n+4],r[5]=e[n+5],r[6]=e[n+6],r[7]=e[n+7],t[0]}function s(e,n){return r[7]=e[n],r[6]=e[n+1],r[5]=e[n+2],r[4]=e[n+3],r[3]=e[n+4],r[2]=e[n+5],r[1]=e[n+6],r[0]=e[n+7],t[0]}e.writeDoubleLE=n?i:o,e.writeDoubleBE=n?o:i,e.readDoubleLE=n?a:s,e.readDoubleBE=n?s:a}():function(){function t(e,t,r,n,i,o){var a=n<0?1:0;if(a&&(n=-n),0===n)e(0,i,o+t),e(1/n>0?0:2147483648,i,o+r);else if(isNaN(n))e(0,i,o+t),e(2146959360,i,o+r);else if(n>17976931348623157e292)e(0,i,o+t),e((a<<31|2146435072)>>>0,i,o+r);else{var s;if(n<22250738585072014e-324)e((s=n/5e-324)>>>0,i,o+t),e((a<<31|s/4294967296)>>>0,i,o+r);else{var u=Math.floor(Math.log(n)/Math.LN2);1024===u&&(u=1023),e(4503599627370496*(s=n*Math.pow(2,-u))>>>0,i,o+t),e((a<<31|u+1023<<20|1048576*s&1048575)>>>0,i,o+r)}}}function r(e,t,r,n,i){var o=e(n,i+t),a=e(n,i+r),s=2*(a>>31)+1,u=a>>>20&2047,l=4294967296*(1048575&a)+o;return 2047===u?l?NaN:s*(1/0):0===u?5e-324*s*l:s*Math.pow(2,u-1075)*(l+4503599627370496)}e.writeDoubleLE=t.bind(null,n,0,4),e.writeDoubleBE=t.bind(null,i,4,0),e.readDoubleLE=r.bind(null,o,0,4),e.readDoubleBE=r.bind(null,a,4,0)}(),e}function n(e,t,r){t[r]=255&e,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24}function i(e,t,r){t[r]=e>>>24,t[r+1]=e>>>16&255,t[r+2]=e>>>8&255,t[r+3]=255&e}function o(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24)>>>0}function a(e,t){return(e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3])>>>0}t.exports=r(r)})),nu=ye(((exports,module)=>{function inquire(moduleName){try{var mod=undefined;if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(e){}return null}module.exports=inquire})),iu=ye((e=>{var t=e;t.length=function(e){for(var t=0,r=0,n=0;n<e.length;++n)(r=e.charCodeAt(n))<128?t+=1:r<2048?t+=2:55296==(64512&r)&&56320==(64512&e.charCodeAt(n+1))?(++n,t+=4):t+=3;return t},t.read=function(e,t,r){if(r-t<1)return"";for(var n,i=null,o=[],a=0;t<r;)(n=e[t++])<128?o[a++]=n:n>191&&n<224?o[a++]=(31&n)<<6|63&e[t++]:n>239&&n<365?(n=((7&n)<<18|(63&e[t++])<<12|(63&e[t++])<<6|63&e[t++])-65536,o[a++]=55296+(n>>10),o[a++]=56320+(1023&n)):o[a++]=(15&n)<<12|(63&e[t++])<<6|63&e[t++],a>8191&&((i||(i=[])).push(String.fromCharCode.apply(String,o)),a=0);return i?(a&&i.push(String.fromCharCode.apply(String,o.slice(0,a))),i.join("")):String.fromCharCode.apply(String,o.slice(0,a))},t.write=function(e,t,r){for(var n,i,o=r,a=0;a<e.length;++a)(n=e.charCodeAt(a))<128?t[r++]=n:n<2048?(t[r++]=n>>6|192,t[r++]=63&n|128):55296==(64512&n)&&56320==(64512&(i=e.charCodeAt(a+1)))?(n=65536+((1023&n)<<10)+(1023&i),++a,t[r++]=n>>18|240,t[r++]=n>>12&63|128,t[r++]=n>>6&63|128,t[r++]=63&n|128):(t[r++]=n>>12|224,t[r++]=n>>6&63|128,t[r++]=63&n|128);return r-o}})),su=ye(((e,t)=>{t.exports=function(e,t,r){var n=r||8192,i=n>>>1,o=null,a=n;return function(r){if(r<1||r>i)return e(r);a+r>n&&(o=e(n),a=0);var s=t.call(o,a,a+=r);return 7&a&&(a=1+(7|a)),s}}})),lu=ye(((e,t)=>{t.exports=n;var r=er();function n(e,t){this.lo=e>>>0,this.hi=t>>>0}var i=n.zero=new n(0,0);i.toNumber=function(){return 0},i.zzEncode=i.zzDecode=function(){return this},i.length=function(){return 1};var o=n.zeroHash="\0\0\0\0\0\0\0\0";n.fromNumber=function(e){if(0===e)return i;var t=e<0;t&&(e=-e);var r=e>>>0,o=(e-r)/4294967296>>>0;return t&&(o=~o>>>0,r=~r>>>0,++r>4294967295&&(r=0,++o>4294967295&&(o=0))),new n(r,o)},n.from=function(e){if("number"==typeof e)return n.fromNumber(e);if(r.isString(e)){if(!r.Long)return n.fromNumber(parseInt(e,10));e=r.Long.fromString(e)}return e.low||e.high?new n(e.low>>>0,e.high>>>0):i},n.prototype.toNumber=function(e){if(!e&&this.hi>>>31){var t=1+~this.lo>>>0,r=~this.hi>>>0;return t||(r=r+1>>>0),-(t+4294967296*r)}return this.lo+4294967296*this.hi},n.prototype.toLong=function(e){return r.Long?new r.Long(0|this.lo,0|this.hi,!!e):{low:0|this.lo,high:0|this.hi,unsigned:!!e}};var a=String.prototype.charCodeAt;n.fromHash=function(e){return e===o?i:new n((a.call(e,0)|a.call(e,1)<<8|a.call(e,2)<<16|a.call(e,3)<<24)>>>0,(a.call(e,4)|a.call(e,5)<<8|a.call(e,6)<<16|a.call(e,7)<<24)>>>0)},n.prototype.toHash=function(){return String.fromCharCode(255&this.lo,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,255&this.hi,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},n.prototype.zzEncode=function(){var e=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^e)>>>0,this.lo=(this.lo<<1^e)>>>0,this},n.prototype.zzDecode=function(){var e=-(1&this.lo);return this.lo=((this.lo>>>1|this.hi<<31)^e)>>>0,this.hi=(this.hi>>>1^e)>>>0,this},n.prototype.length=function(){var e=this.lo,t=(this.lo>>>28|this.hi<<4)>>>0,r=this.hi>>>24;return 0===r?0===t?e<16384?e<128?1:2:e<2097152?3:4:t<16384?t<128?5:6:t<2097152?7:8:r<128?9:10}})),er=ye((e=>{var t=e;function r(e,t,r){for(var n=Object.keys(t),i=0;i<n.length;++i)(void 0===e[n[i]]||!r)&&(e[n[i]]=t[n[i]]);return e}function n(e){function t(e,n){if(!(this instanceof t))return new t(e,n);Object.defineProperty(this,"message",{get:function(){return e}}),Error.captureStackTrace?Error.captureStackTrace(this,t):Object.defineProperty(this,"stack",{value:(new Error).stack||""}),n&&r(this,n)}return t.prototype=Object.create(Error.prototype,{constructor:{value:t,writable:!0,enumerable:!1,configurable:!0},name:{get:function(){return e},set:void 0,enumerable:!1,configurable:!0},toString:{value:function(){return this.name+": "+this.message},writable:!0,enumerable:!1,configurable:!0}}),t}t.asPromise=Ws(),t.base64=qs(),t.EventEmitter=Xs(),t.float=ru(),t.inquire=nu(),t.utf8=iu(),t.pool=su(),t.LongBits=lu(),t.isNode=!!(typeof global<"u"&&global&&global.process&&global.process.versions&&global.process.versions.node),t.global=t.isNode&&global||typeof window<"u"&&window||typeof self<"u"&&self||e,t.emptyArray=Object.freeze?Object.freeze([]):[],t.emptyObject=Object.freeze?Object.freeze({}):{},t.isInteger=Number.isInteger||function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e},t.isString=function(e){return"string"==typeof e||e instanceof String},t.isObject=function(e){return e&&"object"==typeof e},t.isset=t.isSet=function(e,t){var r=e[t];return!(null==r||!e.hasOwnProperty(t))&&("object"!=typeof r||(Array.isArray(r)?r.length:Object.keys(r).length)>0)},t.Buffer=function(){try{var e=t.inquire("buffer").Buffer;return e.prototype.utf8Write?e:null}catch{return null}}(),t._Buffer_from=null,t._Buffer_allocUnsafe=null,t.newBuffer=function(e){return"number"==typeof e?t.Buffer?t._Buffer_allocUnsafe(e):new t.Array(e):t.Buffer?t._Buffer_from(e):typeof Uint8Array>"u"?e:new Uint8Array(e)},t.Array=typeof Uint8Array<"u"?Uint8Array:Array,t.Long=t.global.dcodeIO&&t.global.dcodeIO.Long||t.global.Long||t.inquire("long"),t.key2Re=/^true|false|0|1$/,t.key32Re=/^-?(?:0|[1-9][0-9]*)$/,t.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,t.longToHash=function(e){return e?t.LongBits.from(e).toHash():t.LongBits.zeroHash},t.longFromHash=function(e,r){var n=t.LongBits.fromHash(e);return t.Long?t.Long.fromBits(n.lo,n.hi,r):n.toNumber(!!r)},t.merge=r,t.lcFirst=function(e){return e.charAt(0).toLowerCase()+e.substring(1)},t.newError=n,t.ProtocolError=n("ProtocolError"),t.oneOfGetter=function(e){for(var t={},r=0;r<e.length;++r)t[e[r]]=1;return function(){for(var e=Object.keys(this),r=e.length-1;r>-1;--r)if(1===t[e[r]]&&void 0!==this[e[r]]&&null!==this[e[r]])return e[r]}},t.oneOfSetter=function(e){return function(t){for(var r=0;r<e.length;++r)e[r]!==t&&delete this[e[r]]}},t.toJSONOptions={longs:String,enums:String,bytes:String,json:!0},t._configure=function(){var e=t.Buffer;e?(t._Buffer_from=e.from!==Uint8Array.from&&e.from||function(t,r){return new e(t,r)},t._Buffer_allocUnsafe=e.allocUnsafe||function(t){return new e(t)}):t._Buffer_from=t._Buffer_allocUnsafe=null}})),mi=ye(((e,t)=>{t.exports=h;var r,n=er(),i=n.LongBits,o=n.base64,a=n.utf8;function s(e,t,r){this.fn=e,this.len=t,this.next=void 0,this.val=r}function u(){}function l(e){this.head=e.head,this.tail=e.tail,this.len=e.len,this.next=e.states}function h(){this.len=0,this.head=new s(u,0,0),this.tail=this.head,this.states=null}var c=function(){return n.Buffer?function(){return(h.create=function(){return new r})()}:function(){return new h}};function f(e,t,r){t[r]=255&e}function d(e,t){this.len=e,this.next=void 0,this.val=t}function p(e,t,r){for(;e.hi;)t[r++]=127&e.lo|128,e.lo=(e.lo>>>7|e.hi<<25)>>>0,e.hi>>>=7;for(;e.lo>127;)t[r++]=127&e.lo|128,e.lo=e.lo>>>7;t[r++]=e.lo}function y(e,t,r){t[r]=255&e,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24}h.create=c(),h.alloc=function(e){return new n.Array(e)},n.Array!==Array&&(h.alloc=n.pool(h.alloc,n.Array.prototype.subarray)),h.prototype._push=function(e,t,r){return this.tail=this.tail.next=new s(e,t,r),this.len+=t,this},d.prototype=Object.create(s.prototype),d.prototype.fn=function(e,t,r){for(;e>127;)t[r++]=127&e|128,e>>>=7;t[r]=e},h.prototype.uint32=function(e){return this.len+=(this.tail=this.tail.next=new d((e>>>=0)<128?1:e<16384?2:e<2097152?3:e<268435456?4:5,e)).len,this},h.prototype.int32=function(e){return e<0?this._push(p,10,i.fromNumber(e)):this.uint32(e)},h.prototype.sint32=function(e){return this.uint32((e<<1^e>>31)>>>0)},h.prototype.uint64=function(e){var t=i.from(e);return this._push(p,t.length(),t)},h.prototype.int64=h.prototype.uint64,h.prototype.sint64=function(e){var t=i.from(e).zzEncode();return this._push(p,t.length(),t)},h.prototype.bool=function(e){return this._push(f,1,e?1:0)},h.prototype.fixed32=function(e){return this._push(y,4,e>>>0)},h.prototype.sfixed32=h.prototype.fixed32,h.prototype.fixed64=function(e){var t=i.from(e);return this._push(y,4,t.lo)._push(y,4,t.hi)},h.prototype.sfixed64=h.prototype.fixed64,h.prototype.float=function(e){return this._push(n.float.writeFloatLE,4,e)},h.prototype.double=function(e){return this._push(n.float.writeDoubleLE,8,e)};var m=n.Array.prototype.set?function(e,t,r){t.set(e,r)}:function(e,t,r){for(var n=0;n<e.length;++n)t[r+n]=e[n]};h.prototype.bytes=function(e){var t=e.length>>>0;if(!t)return this._push(f,1,0);if(n.isString(e)){var r=h.alloc(t=o.length(e));o.decode(e,r,0),e=r}return this.uint32(t)._push(m,t,e)},h.prototype.string=function(e){var t=a.length(e);return t?this.uint32(t)._push(a.write,t,e):this._push(f,1,0)},h.prototype.fork=function(){return this.states=new l(this),this.head=this.tail=new s(u,0,0),this.len=0,this},h.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new s(u,0,0),this.len=0),this},h.prototype.ldelim=function(){var e=this.head,t=this.tail,r=this.len;return this.reset().uint32(r),r&&(this.tail.next=e.next,this.tail=t,this.len+=r),this},h.prototype.finish=function(){for(var e=this.head.next,t=this.constructor.alloc(this.len),r=0;e;)e.fn(e.val,t,r),r+=e.len,e=e.next;return t},h._configure=function(e){r=e,h.create=c(),r._configure()}})),yu=ye(((e,t)=>{t.exports=i;var r=mi();(i.prototype=Object.create(r.prototype)).constructor=i;var n=er();function i(){r.call(this)}function o(e,t,r){e.length<40?n.utf8.write(e,t,r):t.utf8Write?t.utf8Write(e,r):t.write(e,r)}i._configure=function(){i.alloc=n._Buffer_allocUnsafe,i.writeBytesBuffer=n.Buffer&&n.Buffer.prototype instanceof Uint8Array&&"set"===n.Buffer.prototype.set.name?function(e,t,r){t.set(e,r)}:function(e,t,r){if(e.copy)e.copy(t,r,0,e.length);else for(var n=0;n<e.length;)t[r++]=e[n++]}},i.prototype.bytes=function(e){n.isString(e)&&(e=n._Buffer_from(e,"base64"));var t=e.length>>>0;return this.uint32(t),t&&this._push(i.writeBytesBuffer,t,e),this},i.prototype.string=function(e){var t=n.Buffer.byteLength(e);return this.uint32(t),t&&this._push(o,t,e),this},i._configure()})),yi=ye(((e,t)=>{t.exports=s;var r,n=er(),i=n.LongBits,o=n.utf8;function a(e,t){return RangeError("index out of range: "+e.pos+" + "+(t||1)+" > "+e.len)}function s(e){this.buf=e,this.pos=0,this.len=e.length}var u,l=typeof Uint8Array<"u"?function(e){if(e instanceof Uint8Array||Array.isArray(e))return new s(e);throw Error("illegal buffer")}:function(e){if(Array.isArray(e))return new s(e);throw Error("illegal buffer")},h=function(){return n.Buffer?function(e){return(s.create=function(e){return n.Buffer.isBuffer(e)?new r(e):l(e)})(e)}:l};function c(){var e=new i(0,0),t=0;if(!(this.len-this.pos>4)){for(;t<3;++t){if(this.pos>=this.len)throw a(this);if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,this.buf[this.pos++]<128)return e}return e.lo=(e.lo|(127&this.buf[this.pos++])<<7*t)>>>0,e}for(;t<4;++t)if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,this.buf[this.pos++]<128)return e;if(e.lo=(e.lo|(127&this.buf[this.pos])<<28)>>>0,e.hi=(e.hi|(127&this.buf[this.pos])>>4)>>>0,this.buf[this.pos++]<128)return e;if(t=0,this.len-this.pos>4){for(;t<5;++t)if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,this.buf[this.pos++]<128)return e}else for(;t<5;++t){if(this.pos>=this.len)throw a(this);if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,this.buf[this.pos++]<128)return e}throw Error("invalid varint encoding")}function f(e,t){return(e[t-4]|e[t-3]<<8|e[t-2]<<16|e[t-1]<<24)>>>0}function d(){if(this.pos+8>this.len)throw a(this,8);return new i(f(this.buf,this.pos+=4),f(this.buf,this.pos+=4))}s.create=h(),s.prototype._slice=n.Array.prototype.subarray||n.Array.prototype.slice,s.prototype.uint32=(u=4294967295,function(){if(u=(127&this.buf[this.pos])>>>0,this.buf[this.pos++]<128||(u=(u|(127&this.buf[this.pos])<<7)>>>0,this.buf[this.pos++]<128)||(u=(u|(127&this.buf[this.pos])<<14)>>>0,this.buf[this.pos++]<128)||(u=(u|(127&this.buf[this.pos])<<21)>>>0,this.buf[this.pos++]<128)||(u=(u|(15&this.buf[this.pos])<<28)>>>0,this.buf[this.pos++]<128))return u;if((this.pos+=5)>this.len)throw this.pos=this.len,a(this,10);return u}),s.prototype.int32=function(){return 0|this.uint32()},s.prototype.sint32=function(){var e=this.uint32();return e>>>1^-(1&e)},s.prototype.bool=function(){return 0!==this.uint32()},s.prototype.fixed32=function(){if(this.pos+4>this.len)throw a(this,4);return f(this.buf,this.pos+=4)},s.prototype.sfixed32=function(){if(this.pos+4>this.len)throw a(this,4);return 0|f(this.buf,this.pos+=4)},s.prototype.float=function(){if(this.pos+4>this.len)throw a(this,4);var e=n.float.readFloatLE(this.buf,this.pos);return this.pos+=4,e},s.prototype.double=function(){if(this.pos+8>this.len)throw a(this,4);var e=n.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,e},s.prototype.bytes=function(){var e=this.uint32(),t=this.pos,r=this.pos+e;if(r>this.len)throw a(this,e);return this.pos+=e,Array.isArray(this.buf)?this.buf.slice(t,r):t===r?new this.buf.constructor(0):this._slice.call(this.buf,t,r)},s.prototype.string=function(){var e=this.bytes();return o.read(e,0,e.length)},s.prototype.skip=function(e){if("number"==typeof e){if(this.pos+e>this.len)throw a(this,e);this.pos+=e}else do{if(this.pos>=this.len)throw a(this)}while(128&this.buf[this.pos++]);return this},s.prototype.skipType=function(e){switch(e){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;4!=(e=7&this.uint32());)this.skipType(e);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+e+" at offset "+this.pos)}return this},s._configure=function(e){r=e,s.create=h(),r._configure();var t=n.Long?"toLong":"toNumber";n.merge(s.prototype,{int64:function(){return c.call(this)[t](!1)},uint64:function(){return c.call(this)[t](!0)},sint64:function(){return c.call(this).zzDecode()[t](!1)},fixed64:function(){return d.call(this)[t](!0)},sfixed64:function(){return d.call(this)[t](!1)}})}})),Au=ye(((e,t)=>{t.exports=i;var r=yi();(i.prototype=Object.create(r.prototype)).constructor=i;var n=er();function i(e){r.call(this,e)}i._configure=function(){n.Buffer&&(i.prototype._slice=n.Buffer.prototype.slice)},i.prototype.string=function(){var e=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+e,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+e,this.len))},i._configure()})),Pu=ye(((e,t)=>{t.exports=n;var r=er();function n(e,t,n){if("function"!=typeof e)throw TypeError("rpcImpl must be a function");r.EventEmitter.call(this),this.rpcImpl=e,this.requestDelimited=!!t,this.responseDelimited=!!n}(n.prototype=Object.create(r.EventEmitter.prototype)).constructor=n,n.prototype.rpcCall=function e(t,n,i,o,a){if(!o)throw TypeError("request must be specified");var s=this;if(!a)return r.asPromise(e,s,t,n,i,o);if(s.rpcImpl)try{return s.rpcImpl(t,n[s.requestDelimited?"encodeDelimited":"encode"](o).finish(),(function(e,r){if(e)return s.emit("error",e,t),a(e);if(null!==r){if(!(r instanceof i))try{r=i[s.responseDelimited?"decodeDelimited":"decode"](r)}catch(e){return s.emit("error",e,t),a(e)}return s.emit("data",r,t),a(null,r)}s.end(!0)}))}catch(e){return s.emit("error",e,t),void setTimeout((function(){a(e)}),0)}else setTimeout((function(){a(Error("already ended"))}),0)},n.prototype.end=function(e){return this.rpcImpl&&(e||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this}})),Lu=ye((e=>{e.Service=Pu()})),Fu=ye(((e,t)=>{t.exports={}})),ku=ye((e=>{var t=e;function r(){t.util._configure(),t.Writer._configure(t.BufferWriter),t.Reader._configure(t.BufferReader)}t.build="minimal",t.Writer=mi(),t.BufferWriter=yu(),t.Reader=yi(),t.BufferReader=Au(),t.util=er(),t.rpc=Lu(),t.roots=Fu(),t.configure=r,r()})),Ru=ye(((e,t)=>{t.exports=ku()})),Ur=ye(((e,t)=>{var r,n,i,o=Ru(),a=o.Reader,s=o.Writer,u=o.util,l=o.roots.default||(o.roots.default={});l.onnx=((i={}).Version=(r={},(n=Object.create(r))[r[0]="_START_VERSION"]=0,n[r[1]="IR_VERSION_2017_10_10"]=1,n[r[2]="IR_VERSION_2017_10_30"]=2,n[r[3]="IR_VERSION_2017_11_3"]=3,n[r[4]="IR_VERSION_2019_1_22"]=4,n[r[5]="IR_VERSION_2019_3_18"]=5,n[r[6]="IR_VERSION_2019_9_19"]=6,n[r[7]="IR_VERSION_2020_5_8"]=7,n[r[8]="IR_VERSION_2021_7_30"]=8,n[r[9]="IR_VERSION"]=9,n),i.AttributeProto=function(){function e(e){if(this.floats=[],this.ints=[],this.strings=[],this.tensors=[],this.graphs=[],this.sparseTensors=[],this.typeProtos=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.name="",e.prototype.refAttrName="",e.prototype.docString="",e.prototype.type=0,e.prototype.f=0,e.prototype.i=u.Long?u.Long.fromBits(0,0,!1):0,e.prototype.s=u.newBuffer([]),e.prototype.t=null,e.prototype.g=null,e.prototype.sparseTensor=null,e.prototype.tp=null,e.prototype.floats=u.emptyArray,e.prototype.ints=u.emptyArray,e.prototype.strings=u.emptyArray,e.prototype.tensors=u.emptyArray,e.prototype.graphs=u.emptyArray,e.prototype.sparseTensors=u.emptyArray,e.prototype.typeProtos=u.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=s.create()),null!=e.name&&Object.hasOwnProperty.call(e,"name")&&t.uint32(10).string(e.name),null!=e.f&&Object.hasOwnProperty.call(e,"f")&&t.uint32(21).float(e.f),null!=e.i&&Object.hasOwnProperty.call(e,"i")&&t.uint32(24).int64(e.i),null!=e.s&&Object.hasOwnProperty.call(e,"s")&&t.uint32(34).bytes(e.s),null!=e.t&&Object.hasOwnProperty.call(e,"t")&&l.onnx.TensorProto.encode(e.t,t.uint32(42).fork()).ldelim(),null!=e.g&&Object.hasOwnProperty.call(e,"g")&&l.onnx.GraphProto.encode(e.g,t.uint32(50).fork()).ldelim(),null!=e.floats&&e.floats.length){t.uint32(58).fork();for(var r=0;r<e.floats.length;++r)t.float(e.floats[r]);t.ldelim()}if(null!=e.ints&&e.ints.length){for(t.uint32(66).fork(),r=0;r<e.ints.length;++r)t.int64(e.ints[r]);t.ldelim()}if(null!=e.strings&&e.strings.length)for(r=0;r<e.strings.length;++r)t.uint32(74).bytes(e.strings[r]);if(null!=e.tensors&&e.tensors.length)for(r=0;r<e.tensors.length;++r)l.onnx.TensorProto.encode(e.tensors[r],t.uint32(82).fork()).ldelim();if(null!=e.graphs&&e.graphs.length)for(r=0;r<e.graphs.length;++r)l.onnx.GraphProto.encode(e.graphs[r],t.uint32(90).fork()).ldelim();if(null!=e.docString&&Object.hasOwnProperty.call(e,"docString")&&t.uint32(106).string(e.docString),null!=e.tp&&Object.hasOwnProperty.call(e,"tp")&&l.onnx.TypeProto.encode(e.tp,t.uint32(114).fork()).ldelim(),null!=e.typeProtos&&e.typeProtos.length)for(r=0;r<e.typeProtos.length;++r)l.onnx.TypeProto.encode(e.typeProtos[r],t.uint32(122).fork()).ldelim();if(null!=e.type&&Object.hasOwnProperty.call(e,"type")&&t.uint32(160).int32(e.type),null!=e.refAttrName&&Object.hasOwnProperty.call(e,"refAttrName")&&t.uint32(170).string(e.refAttrName),null!=e.sparseTensor&&Object.hasOwnProperty.call(e,"sparseTensor")&&l.onnx.SparseTensorProto.encode(e.sparseTensor,t.uint32(178).fork()).ldelim(),null!=e.sparseTensors&&e.sparseTensors.length)for(r=0;r<e.sparseTensors.length;++r)l.onnx.SparseTensorProto.encode(e.sparseTensors[r],t.uint32(186).fork()).ldelim();return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof a||(e=a.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new l.onnx.AttributeProto;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.name=e.string();break;case 21:n.refAttrName=e.string();break;case 13:n.docString=e.string();break;case 20:n.type=e.int32();break;case 2:n.f=e.float();break;case 3:n.i=e.int64();break;case 4:n.s=e.bytes();break;case 5:n.t=l.onnx.TensorProto.decode(e,e.uint32());break;case 6:n.g=l.onnx.GraphProto.decode(e,e.uint32());break;case 22:n.sparseTensor=l.onnx.SparseTensorProto.decode(e,e.uint32());break;case 14:n.tp=l.onnx.TypeProto.decode(e,e.uint32());break;case 7:if(n.floats&&n.floats.length||(n.floats=[]),2==(7&i))for(var o=e.uint32()+e.pos;e.pos<o;)n.floats.push(e.float());else n.floats.push(e.float());break;case 8:if(n.ints&&n.ints.length||(n.ints=[]),2==(7&i))for(o=e.uint32()+e.pos;e.pos<o;)n.ints.push(e.int64());else n.ints.push(e.int64());break;case 9:n.strings&&n.strings.length||(n.strings=[]),n.strings.push(e.bytes());break;case 10:n.tensors&&n.tensors.length||(n.tensors=[]),n.tensors.push(l.onnx.TensorProto.decode(e,e.uint32()));break;case 11:n.graphs&&n.graphs.length||(n.graphs=[]),n.graphs.push(l.onnx.GraphProto.decode(e,e.uint32()));break;case 23:n.sparseTensors&&n.sparseTensors.length||(n.sparseTensors=[]),n.sparseTensors.push(l.onnx.SparseTensorProto.decode(e,e.uint32()));break;case 15:n.typeProtos&&n.typeProtos.length||(n.typeProtos=[]),n.typeProtos.push(l.onnx.TypeProto.decode(e,e.uint32()));break;default:e.skipType(7&i)}}return n},e.decodeDelimited=function(e){return e instanceof a||(e=new a(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.name&&e.hasOwnProperty("name")&&!u.isString(e.name))return"name: string expected";if(null!=e.refAttrName&&e.hasOwnProperty("refAttrName")&&!u.isString(e.refAttrName))return"refAttrName: string expected";if(null!=e.docString&&e.hasOwnProperty("docString")&&!u.isString(e.docString))return"docString: string expected";if(null!=e.type&&e.hasOwnProperty("type"))switch(e.type){default:return"type: enum value expected";case 0:case 1:case 2:case 3:case 4:case 5:case 11:case 13:case 6:case 7:case 8:case 9:case 10:case 12:case 14:}if(null!=e.f&&e.hasOwnProperty("f")&&"number"!=typeof e.f)return"f: number expected";if(null!=e.i&&e.hasOwnProperty("i")&&!u.isInteger(e.i)&&!(e.i&&u.isInteger(e.i.low)&&u.isInteger(e.i.high)))return"i: integer|Long expected";if(null!=e.s&&e.hasOwnProperty("s")&&!(e.s&&"number"==typeof e.s.length||u.isString(e.s)))return"s: buffer expected";if(null!=e.t&&e.hasOwnProperty("t")&&(r=l.onnx.TensorProto.verify(e.t)))return"t."+r;if(null!=e.g&&e.hasOwnProperty("g")&&(r=l.onnx.GraphProto.verify(e.g)))return"g."+r;if(null!=e.sparseTensor&&e.hasOwnProperty("sparseTensor")&&(r=l.onnx.SparseTensorProto.verify(e.sparseTensor)))return"sparseTensor."+r;if(null!=e.tp&&e.hasOwnProperty("tp")&&(r=l.onnx.TypeProto.verify(e.tp)))return"tp."+r;if(null!=e.floats&&e.hasOwnProperty("floats")){if(!Array.isArray(e.floats))return"floats: array expected";for(var t=0;t<e.floats.length;++t)if("number"!=typeof e.floats[t])return"floats: number[] expected"}if(null!=e.ints&&e.hasOwnProperty("ints")){if(!Array.isArray(e.ints))return"ints: array expected";for(t=0;t<e.ints.length;++t)if(!(u.isInteger(e.ints[t])||e.ints[t]&&u.isInteger(e.ints[t].low)&&u.isInteger(e.ints[t].high)))return"ints: integer|Long[] expected"}if(null!=e.strings&&e.hasOwnProperty("strings")){if(!Array.isArray(e.strings))return"strings: array expected";for(t=0;t<e.strings.length;++t)if(!(e.strings[t]&&"number"==typeof e.strings[t].length||u.isString(e.strings[t])))return"strings: buffer[] expected"}if(null!=e.tensors&&e.hasOwnProperty("tensors")){if(!Array.isArray(e.tensors))return"tensors: array expected";for(t=0;t<e.tensors.length;++t)if(r=l.onnx.TensorProto.verify(e.tensors[t]))return"tensors."+r}if(null!=e.graphs&&e.hasOwnProperty("graphs")){if(!Array.isArray(e.graphs))return"graphs: array expected";for(t=0;t<e.graphs.length;++t)if(r=l.onnx.GraphProto.verify(e.graphs[t]))return"graphs."+r}if(null!=e.sparseTensors&&e.hasOwnProperty("sparseTensors")){if(!Array.isArray(e.sparseTensors))return"sparseTensors: array expected";for(t=0;t<e.sparseTensors.length;++t)if(r=l.onnx.SparseTensorProto.verify(e.sparseTensors[t]))return"sparseTensors."+r}if(null!=e.typeProtos&&e.hasOwnProperty("typeProtos")){if(!Array.isArray(e.typeProtos))return"typeProtos: array expected";for(t=0;t<e.typeProtos.length;++t){var r;if(r=l.onnx.TypeProto.verify(e.typeProtos[t]))return"typeProtos."+r}}return null},e.fromObject=function(e){if(e instanceof l.onnx.AttributeProto)return e;var t=new l.onnx.AttributeProto;switch(null!=e.name&&(t.name=String(e.name)),null!=e.refAttrName&&(t.refAttrName=String(e.refAttrName)),null!=e.docString&&(t.docString=String(e.docString)),e.type){default:if("number"==typeof e.type){t.type=e.type;break}break;case"UNDEFINED":case 0:t.type=0;break;case"FLOAT":case 1:t.type=1;break;case"INT":case 2:t.type=2;break;case"STRING":case 3:t.type=3;break;case"TENSOR":case 4:t.type=4;break;case"GRAPH":case 5:t.type=5;break;case"SPARSE_TENSOR":case 11:t.type=11;break;case"TYPE_PROTO":case 13:t.type=13;break;case"FLOATS":case 6:t.type=6;break;case"INTS":case 7:t.type=7;break;case"STRINGS":case 8:t.type=8;break;case"TENSORS":case 9:t.type=9;break;case"GRAPHS":case 10:t.type=10;break;case"SPARSE_TENSORS":case 12:t.type=12;break;case"TYPE_PROTOS":case 14:t.type=14}if(null!=e.f&&(t.f=Number(e.f)),null!=e.i&&(u.Long?(t.i=u.Long.fromValue(e.i)).unsigned=!1:"string"==typeof e.i?t.i=parseInt(e.i,10):"number"==typeof e.i?t.i=e.i:"object"==typeof e.i&&(t.i=new u.LongBits(e.i.low>>>0,e.i.high>>>0).toNumber())),null!=e.s&&("string"==typeof e.s?u.base64.decode(e.s,t.s=u.newBuffer(u.base64.length(e.s)),0):e.s.length>=0&&(t.s=e.s)),null!=e.t){if("object"!=typeof e.t)throw TypeError(".onnx.AttributeProto.t: object expected");t.t=l.onnx.TensorProto.fromObject(e.t)}if(null!=e.g){if("object"!=typeof e.g)throw TypeError(".onnx.AttributeProto.g: object expected");t.g=l.onnx.GraphProto.fromObject(e.g)}if(null!=e.sparseTensor){if("object"!=typeof e.sparseTensor)throw TypeError(".onnx.AttributeProto.sparseTensor: object expected");t.sparseTensor=l.onnx.SparseTensorProto.fromObject(e.sparseTensor)}if(null!=e.tp){if("object"!=typeof e.tp)throw TypeError(".onnx.AttributeProto.tp: object expected");t.tp=l.onnx.TypeProto.fromObject(e.tp)}if(e.floats){if(!Array.isArray(e.floats))throw TypeError(".onnx.AttributeProto.floats: array expected");t.floats=[];for(var r=0;r<e.floats.length;++r)t.floats[r]=Number(e.floats[r])}if(e.ints){if(!Array.isArray(e.ints))throw TypeError(".onnx.AttributeProto.ints: array expected");for(t.ints=[],r=0;r<e.ints.length;++r)u.Long?(t.ints[r]=u.Long.fromValue(e.ints[r])).unsigned=!1:"string"==typeof e.ints[r]?t.ints[r]=parseInt(e.ints[r],10):"number"==typeof e.ints[r]?t.ints[r]=e.ints[r]:"object"==typeof e.ints[r]&&(t.ints[r]=new u.LongBits(e.ints[r].low>>>0,e.ints[r].high>>>0).toNumber())}if(e.strings){if(!Array.isArray(e.strings))throw TypeError(".onnx.AttributeProto.strings: array expected");for(t.strings=[],r=0;r<e.strings.length;++r)"string"==typeof e.strings[r]?u.base64.decode(e.strings[r],t.strings[r]=u.newBuffer(u.base64.length(e.strings[r])),0):e.strings[r].length>=0&&(t.strings[r]=e.strings[r])}if(e.tensors){if(!Array.isArray(e.tensors))throw TypeError(".onnx.AttributeProto.tensors: array expected");for(t.tensors=[],r=0;r<e.tensors.length;++r){if("object"!=typeof e.tensors[r])throw TypeError(".onnx.AttributeProto.tensors: object expected");t.tensors[r]=l.onnx.TensorProto.fromObject(e.tensors[r])}}if(e.graphs){if(!Array.isArray(e.graphs))throw TypeError(".onnx.AttributeProto.graphs: array expected");for(t.graphs=[],r=0;r<e.graphs.length;++r){if("object"!=typeof e.graphs[r])throw TypeError(".onnx.AttributeProto.graphs: object expected");t.graphs[r]=l.onnx.GraphProto.fromObject(e.graphs[r])}}if(e.sparseTensors){if(!Array.isArray(e.sparseTensors))throw TypeError(".onnx.AttributeProto.sparseTensors: array expected");for(t.sparseTensors=[],r=0;r<e.sparseTensors.length;++r){if("object"!=typeof e.sparseTensors[r])throw TypeError(".onnx.AttributeProto.sparseTensors: object expected");t.sparseTensors[r]=l.onnx.SparseTensorProto.fromObject(e.sparseTensors[r])}}if(e.typeProtos){if(!Array.isArray(e.typeProtos))throw TypeError(".onnx.AttributeProto.typeProtos: array expected");for(t.typeProtos=[],r=0;r<e.typeProtos.length;++r){if("object"!=typeof e.typeProtos[r])throw TypeError(".onnx.AttributeProto.typeProtos: object expected");t.typeProtos[r]=l.onnx.TypeProto.fromObject(e.typeProtos[r])}}return t},e.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.floats=[],r.ints=[],r.strings=[],r.tensors=[],r.graphs=[],r.typeProtos=[],r.sparseTensors=[]),t.defaults){if(r.name="",r.f=0,u.Long){var n=new u.Long(0,0,!1);r.i=t.longs===String?n.toString():t.longs===Number?n.toNumber():n}else r.i=t.longs===String?"0":0;t.bytes===String?r.s="":(r.s=[],t.bytes!==Array&&(r.s=u.newBuffer(r.s))),r.t=null,r.g=null,r.docString="",r.tp=null,r.type=t.enums===String?"UNDEFINED":0,r.refAttrName="",r.sparseTensor=null}if(null!=e.name&&e.hasOwnProperty("name")&&(r.name=e.name),null!=e.f&&e.hasOwnProperty("f")&&(r.f=t.json&&!isFinite(e.f)?String(e.f):e.f),null!=e.i&&e.hasOwnProperty("i")&&("number"==typeof e.i?r.i=t.longs===String?String(e.i):e.i:r.i=t.longs===String?u.Long.prototype.toString.call(e.i):t.longs===Number?new u.LongBits(e.i.low>>>0,e.i.high>>>0).toNumber():e.i),null!=e.s&&e.hasOwnProperty("s")&&(r.s=t.bytes===String?u.base64.encode(e.s,0,e.s.length):t.bytes===Array?Array.prototype.slice.call(e.s):e.s),null!=e.t&&e.hasOwnProperty("t")&&(r.t=l.onnx.TensorProto.toObject(e.t,t)),null!=e.g&&e.hasOwnProperty("g")&&(r.g=l.onnx.GraphProto.toObject(e.g,t)),e.floats&&e.floats.length){r.floats=[];for(var i=0;i<e.floats.length;++i)r.floats[i]=t.json&&!isFinite(e.floats[i])?String(e.floats[i]):e.floats[i]}if(e.ints&&e.ints.length)for(r.ints=[],i=0;i<e.ints.length;++i)"number"==typeof e.ints[i]?r.ints[i]=t.longs===String?String(e.ints[i]):e.ints[i]:r.ints[i]=t.longs===String?u.Long.prototype.toString.call(e.ints[i]):t.longs===Number?new u.LongBits(e.ints[i].low>>>0,e.ints[i].high>>>0).toNumber():e.ints[i];if(e.strings&&e.strings.length)for(r.strings=[],i=0;i<e.strings.length;++i)r.strings[i]=t.bytes===String?u.base64.encode(e.strings[i],0,e.strings[i].length):t.bytes===Array?Array.prototype.slice.call(e.strings[i]):e.strings[i];if(e.tensors&&e.tensors.length)for(r.tensors=[],i=0;i<e.tensors.length;++i)r.tensors[i]=l.onnx.TensorProto.toObject(e.tensors[i],t);if(e.graphs&&e.graphs.length)for(r.graphs=[],i=0;i<e.graphs.length;++i)r.graphs[i]=l.onnx.GraphProto.toObject(e.graphs[i],t);if(null!=e.docString&&e.hasOwnProperty("docString")&&(r.docString=e.docString),null!=e.tp&&e.hasOwnProperty("tp")&&(r.tp=l.onnx.TypeProto.toObject(e.tp,t)),e.typeProtos&&e.typeProtos.length)for(r.typeProtos=[],i=0;i<e.typeProtos.length;++i)r.typeProtos[i]=l.onnx.TypeProto.toObject(e.typeProtos[i],t);if(null!=e.type&&e.hasOwnProperty("type")&&(r.type=t.enums===String?void 0===l.onnx.AttributeProto.AttributeType[e.type]?e.type:l.onnx.AttributeProto.AttributeType[e.type]:e.type),null!=e.refAttrName&&e.hasOwnProperty("refAttrName")&&(r.refAttrName=e.refAttrName),null!=e.sparseTensor&&e.hasOwnProperty("sparseTensor")&&(r.sparseTensor=l.onnx.SparseTensorProto.toObject(e.sparseTensor,t)),e.sparseTensors&&e.sparseTensors.length)for(r.sparseTensors=[],i=0;i<e.sparseTensors.length;++i)r.sparseTensors[i]=l.onnx.SparseTensorProto.toObject(e.sparseTensors[i],t);return r},e.prototype.toJSON=function(){return this.constructor.toObject(this,o.util.toJSONOptions)},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/onnx.AttributeProto"},e.AttributeType=function(){var e={},t=Object.create(e);return t[e[0]="UNDEFINED"]=0,t[e[1]="FLOAT"]=1,t[e[2]="INT"]=2,t[e[3]="STRING"]=3,t[e[4]="TENSOR"]=4,t[e[5]="GRAPH"]=5,t[e[11]="SPARSE_TENSOR"]=11,t[e[13]="TYPE_PROTO"]=13,t[e[6]="FLOATS"]=6,t[e[7]="INTS"]=7,t[e[8]="STRINGS"]=8,t[e[9]="TENSORS"]=9,t[e[10]="GRAPHS"]=10,t[e[12]="SPARSE_TENSORS"]=12,t[e[14]="TYPE_PROTOS"]=14,t}(),e}(),i.ValueInfoProto=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.name="",e.prototype.type=null,e.prototype.docString="",e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=s.create()),null!=e.name&&Object.hasOwnProperty.call(e,"name")&&t.uint32(10).string(e.name),null!=e.type&&Object.hasOwnProperty.call(e,"type")&&l.onnx.TypeProto.encode(e.type,t.uint32(18).fork()).ldelim(),null!=e.docString&&Object.hasOwnProperty.call(e,"docString")&&t.uint32(26).string(e.docString),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof a||(e=a.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new l.onnx.ValueInfoProto;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.name=e.string();break;case 2:n.type=l.onnx.TypeProto.decode(e,e.uint32());break;case 3:n.docString=e.string();break;default:e.skipType(7&i)}}return n},e.decodeDelimited=function(e){return e instanceof a||(e=new a(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.name&&e.hasOwnProperty("name")&&!u.isString(e.name))return"name: string expected";if(null!=e.type&&e.hasOwnProperty("type")){var t=l.onnx.TypeProto.verify(e.type);if(t)return"type."+t}return null!=e.docString&&e.hasOwnProperty("docString")&&!u.isString(e.docString)?"docString: string expected":null},e.fromObject=function(e){if(e instanceof l.onnx.ValueInfoProto)return e;var t=new l.onnx.ValueInfoProto;if(null!=e.name&&(t.name=String(e.name)),null!=e.type){if("object"!=typeof e.type)throw TypeError(".onnx.ValueInfoProto.type: object expected");t.type=l.onnx.TypeProto.fromObject(e.type)}return null!=e.docString&&(t.docString=String(e.docString)),t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.name="",r.type=null,r.docString=""),null!=e.name&&e.hasOwnProperty("name")&&(r.name=e.name),null!=e.type&&e.hasOwnProperty("type")&&(r.type=l.onnx.TypeProto.toObject(e.type,t)),null!=e.docString&&e.hasOwnProperty("docString")&&(r.docString=e.docString),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,o.util.toJSONOptions)},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/onnx.ValueInfoProto"},e}(),i.NodeProto=function(){function e(e){if(this.input=[],this.output=[],this.attribute=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.input=u.emptyArray,e.prototype.output=u.emptyArray,e.prototype.name="",e.prototype.opType="",e.prototype.domain="",e.prototype.attribute=u.emptyArray,e.prototype.docString="",e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=s.create()),null!=e.input&&e.input.length)for(var r=0;r<e.input.length;++r)t.uint32(10).string(e.input[r]);if(null!=e.output&&e.output.length)for(r=0;r<e.output.length;++r)t.uint32(18).string(e.output[r]);if(null!=e.name&&Object.hasOwnProperty.call(e,"name")&&t.uint32(26).string(e.name),null!=e.opType&&Object.hasOwnProperty.call(e,"opType")&&t.uint32(34).string(e.opType),null!=e.attribute&&e.attribute.length)for(r=0;r<e.attribute.length;++r)l.onnx.AttributeProto.encode(e.attribute[r],t.uint32(42).fork()).ldelim();return null!=e.docString&&Object.hasOwnProperty.call(e,"docString")&&t.uint32(50).string(e.docString),null!=e.domain&&Object.hasOwnProperty.call(e,"domain")&&t.uint32(58).string(e.domain),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof a||(e=a.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new l.onnx.NodeProto;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.input&&n.input.length||(n.input=[]),n.input.push(e.string());break;case 2:n.output&&n.output.length||(n.output=[]),n.output.push(e.string());break;case 3:n.name=e.string();break;case 4:n.opType=e.string();break;case 7:n.domain=e.string();break;case 5:n.attribute&&n.attribute.length||(n.attribute=[]),n.attribute.push(l.onnx.AttributeProto.decode(e,e.uint32()));break;case 6:n.docString=e.string();break;default:e.skipType(7&i)}}return n},e.decodeDelimited=function(e){return e instanceof a||(e=new a(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.input&&e.hasOwnProperty("input")){if(!Array.isArray(e.input))return"input: array expected";for(var t=0;t<e.input.length;++t)if(!u.isString(e.input[t]))return"input: string[] expected"}if(null!=e.output&&e.hasOwnProperty("output")){if(!Array.isArray(e.output))return"output: array expected";for(t=0;t<e.output.length;++t)if(!u.isString(e.output[t]))return"output: string[] expected"}if(null!=e.name&&e.hasOwnProperty("name")&&!u.isString(e.name))return"name: string expected";if(null!=e.opType&&e.hasOwnProperty("opType")&&!u.isString(e.opType))return"opType: string expected";if(null!=e.domain&&e.hasOwnProperty("domain")&&!u.isString(e.domain))return"domain: string expected";if(null!=e.attribute&&e.hasOwnProperty("attribute")){if(!Array.isArray(e.attribute))return"attribute: array expected";for(t=0;t<e.attribute.length;++t){var r=l.onnx.AttributeProto.verify(e.attribute[t]);if(r)return"attribute."+r}}return null!=e.docString&&e.hasOwnProperty("docString")&&!u.isString(e.docString)?"docString: string expected":null},e.fromObject=function(e){if(e instanceof l.onnx.NodeProto)return e;var t=new l.onnx.NodeProto;if(e.input){if(!Array.isArray(e.input))throw TypeError(".onnx.NodeProto.input: array expected");t.input=[];for(var r=0;r<e.input.length;++r)t.input[r]=String(e.input[r])}if(e.output){if(!Array.isArray(e.output))throw TypeError(".onnx.NodeProto.output: array expected");for(t.output=[],r=0;r<e.output.length;++r)t.output[r]=String(e.output[r])}if(null!=e.name&&(t.name=String(e.name)),null!=e.opType&&(t.opType=String(e.opType)),null!=e.domain&&(t.domain=String(e.domain)),e.attribute){if(!Array.isArray(e.attribute))throw TypeError(".onnx.NodeProto.attribute: array expected");for(t.attribute=[],r=0;r<e.attribute.length;++r){if("object"!=typeof e.attribute[r])throw TypeError(".onnx.NodeProto.attribute: object expected");t.attribute[r]=l.onnx.AttributeProto.fromObject(e.attribute[r])}}return null!=e.docString&&(t.docString=String(e.docString)),t},e.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.input=[],r.output=[],r.attribute=[]),t.defaults&&(r.name="",r.opType="",r.docString="",r.domain=""),e.input&&e.input.length){r.input=[];for(var n=0;n<e.input.length;++n)r.input[n]=e.input[n]}if(e.output&&e.output.length)for(r.output=[],n=0;n<e.output.length;++n)r.output[n]=e.output[n];if(null!=e.name&&e.hasOwnProperty("name")&&(r.name=e.name),null!=e.opType&&e.hasOwnProperty("opType")&&(r.opType=e.opType),e.attribute&&e.attribute.length)for(r.attribute=[],n=0;n<e.attribute.length;++n)r.attribute[n]=l.onnx.AttributeProto.toObject(e.attribute[n],t);return null!=e.docString&&e.hasOwnProperty("docString")&&(r.docString=e.docString),null!=e.domain&&e.hasOwnProperty("domain")&&(r.domain=e.domain),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,o.util.toJSONOptions)},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/onnx.NodeProto"},e}(),i.TrainingInfoProto=function(){function e(e){if(this.initializationBinding=[],this.updateBinding=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.initialization=null,e.prototype.algorithm=null,e.prototype.initializationBinding=u.emptyArray,e.prototype.updateBinding=u.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=s.create()),null!=e.initialization&&Object.hasOwnProperty.call(e,"initialization")&&l.onnx.GraphProto.encode(e.initialization,t.uint32(10).fork()).ldelim(),null!=e.algorithm&&Object.hasOwnProperty.call(e,"algorithm")&&l.onnx.GraphProto.encode(e.algorithm,t.uint32(18).fork()).ldelim(),null!=e.initializationBinding&&e.initializationBinding.length)for(var r=0;r<e.initializationBinding.length;++r)l.onnx.StringStringEntryProto.encode(e.initializationBinding[r],t.uint32(26).fork()).ldelim();if(null!=e.updateBinding&&e.updateBinding.length)for(r=0;r<e.updateBinding.length;++r)l.onnx.StringStringEntryProto.encode(e.updateBinding[r],t.uint32(34).fork()).ldelim();return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof a||(e=a.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new l.onnx.TrainingInfoProto;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.initialization=l.onnx.GraphProto.decode(e,e.uint32());break;case 2:n.algorithm=l.onnx.GraphProto.decode(e,e.uint32());break;case 3:n.initializationBinding&&n.initializationBinding.length||(n.initializationBinding=[]),n.initializationBinding.push(l.onnx.StringStringEntryProto.decode(e,e.uint32()));break;case 4:n.updateBinding&&n.updateBinding.length||(n.updateBinding=[]),n.updateBinding.push(l.onnx.StringStringEntryProto.decode(e,e.uint32()));break;default:e.skipType(7&i)}}return n},e.decodeDelimited=function(e){return e instanceof a||(e=new a(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.initialization&&e.hasOwnProperty("initialization")&&(r=l.onnx.GraphProto.verify(e.initialization)))return"initialization."+r;if(null!=e.algorithm&&e.hasOwnProperty("algorithm")&&(r=l.onnx.GraphProto.verify(e.algorithm)))return"algorithm."+r;if(null!=e.initializationBinding&&e.hasOwnProperty("initializationBinding")){if(!Array.isArray(e.initializationBinding))return"initializationBinding: array expected";for(var t=0;t<e.initializationBinding.length;++t)if(r=l.onnx.StringStringEntryProto.verify(e.initializationBinding[t]))return"initializationBinding."+r}if(null!=e.updateBinding&&e.hasOwnProperty("updateBinding")){if(!Array.isArray(e.updateBinding))return"updateBinding: array expected";for(t=0;t<e.updateBinding.length;++t){var r;if(r=l.onnx.StringStringEntryProto.verify(e.updateBinding[t]))return"updateBinding."+r}}return null},e.fromObject=function(e){if(e instanceof l.onnx.TrainingInfoProto)return e;var t=new l.onnx.TrainingInfoProto;if(null!=e.initialization){if("object"!=typeof e.initialization)throw TypeError(".onnx.TrainingInfoProto.initialization: object expected");t.initialization=l.onnx.GraphProto.fromObject(e.initialization)}if(null!=e.algorithm){if("object"!=typeof e.algorithm)throw TypeError(".onnx.TrainingInfoProto.algorithm: object expected");t.algorithm=l.onnx.GraphProto.fromObject(e.algorithm)}if(e.initializationBinding){if(!Array.isArray(e.initializationBinding))throw TypeError(".onnx.TrainingInfoProto.initializationBinding: array expected");t.initializationBinding=[];for(var r=0;r<e.initializationBinding.length;++r){if("object"!=typeof e.initializationBinding[r])throw TypeError(".onnx.TrainingInfoProto.initializationBinding: object expected");t.initializationBinding[r]=l.onnx.StringStringEntryProto.fromObject(e.initializationBinding[r])}}if(e.updateBinding){if(!Array.isArray(e.updateBinding))throw TypeError(".onnx.TrainingInfoProto.updateBinding: array expected");for(t.updateBinding=[],r=0;r<e.updateBinding.length;++r){if("object"!=typeof e.updateBinding[r])throw TypeError(".onnx.TrainingInfoProto.updateBinding: object expected");t.updateBinding[r]=l.onnx.StringStringEntryProto.fromObject(e.updateBinding[r])}}return t},e.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.initializationBinding=[],r.updateBinding=[]),t.defaults&&(r.initialization=null,r.algorithm=null),null!=e.initialization&&e.hasOwnProperty("initialization")&&(r.initialization=l.onnx.GraphProto.toObject(e.initialization,t)),null!=e.algorithm&&e.hasOwnProperty("algorithm")&&(r.algorithm=l.onnx.GraphProto.toObject(e.algorithm,t)),e.initializationBinding&&e.initializationBinding.length){r.initializationBinding=[];for(var n=0;n<e.initializationBinding.length;++n)r.initializationBinding[n]=l.onnx.StringStringEntryProto.toObject(e.initializationBinding[n],t)}if(e.updateBinding&&e.updateBinding.length)for(r.updateBinding=[],n=0;n<e.updateBinding.length;++n)r.updateBinding[n]=l.onnx.StringStringEntryProto.toObject(e.updateBinding[n],t);return r},e.prototype.toJSON=function(){return this.constructor.toObject(this,o.util.toJSONOptions)},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/onnx.TrainingInfoProto"},e}(),i.ModelProto=function(){function e(e){if(this.opsetImport=[],this.metadataProps=[],this.trainingInfo=[],this.functions=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.irVersion=u.Long?u.Long.fromBits(0,0,!1):0,e.prototype.opsetImport=u.emptyArray,e.prototype.producerName="",e.prototype.producerVersion="",e.prototype.domain="",e.prototype.modelVersion=u.Long?u.Long.fromBits(0,0,!1):0,e.prototype.docString="",e.prototype.graph=null,e.prototype.metadataProps=u.emptyArray,e.prototype.trainingInfo=u.emptyArray,e.prototype.functions=u.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=s.create()),null!=e.irVersion&&Object.hasOwnProperty.call(e,"irVersion")&&t.uint32(8).int64(e.irVersion),null!=e.producerName&&Object.hasOwnProperty.call(e,"producerName")&&t.uint32(18).string(e.producerName),null!=e.producerVersion&&Object.hasOwnProperty.call(e,"producerVersion")&&t.uint32(26).string(e.producerVersion),null!=e.domain&&Object.hasOwnProperty.call(e,"domain")&&t.uint32(34).string(e.domain),null!=e.modelVersion&&Object.hasOwnProperty.call(e,"modelVersion")&&t.uint32(40).int64(e.modelVersion),null!=e.docString&&Object.hasOwnProperty.call(e,"docString")&&t.uint32(50).string(e.docString),null!=e.graph&&Object.hasOwnProperty.call(e,"graph")&&l.onnx.GraphProto.encode(e.graph,t.uint32(58).fork()).ldelim(),null!=e.opsetImport&&e.opsetImport.length)for(var r=0;r<e.opsetImport.length;++r)l.onnx.OperatorSetIdProto.encode(e.opsetImport[r],t.uint32(66).fork()).ldelim();if(null!=e.metadataProps&&e.metadataProps.length)for(r=0;r<e.metadataProps.length;++r)l.onnx.StringStringEntryProto.encode(e.metadataProps[r],t.uint32(114).fork()).ldelim();if(null!=e.trainingInfo&&e.trainingInfo.length)for(r=0;r<e.trainingInfo.length;++r)l.onnx.TrainingInfoProto.encode(e.trainingInfo[r],t.uint32(162).fork()).ldelim();if(null!=e.functions&&e.functions.length)for(r=0;r<e.functions.length;++r)l.onnx.FunctionProto.encode(e.functions[r],t.uint32(202).fork()).ldelim();return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof a||(e=a.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new l.onnx.ModelProto;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.irVersion=e.int64();break;case 8:n.opsetImport&&n.opsetImport.length||(n.opsetImport=[]),n.opsetImport.push(l.onnx.OperatorSetIdProto.decode(e,e.uint32()));break;case 2:n.producerName=e.string();break;case 3:n.producerVersion=e.string();break;case 4:n.domain=e.string();break;case 5:n.modelVersion=e.int64();break;case 6:n.docString=e.string();break;case 7:n.graph=l.onnx.GraphProto.decode(e,e.uint32());break;case 14:n.metadataProps&&n.metadataProps.length||(n.metadataProps=[]),n.metadataProps.push(l.onnx.StringStringEntryProto.decode(e,e.uint32()));break;case 20:n.trainingInfo&&n.trainingInfo.length||(n.trainingInfo=[]),n.trainingInfo.push(l.onnx.TrainingInfoProto.decode(e,e.uint32()));break;case 25:n.functions&&n.functions.length||(n.functions=[]),n.functions.push(l.onnx.FunctionProto.decode(e,e.uint32()));break;default:e.skipType(7&i)}}return n},e.decodeDelimited=function(e){return e instanceof a||(e=new a(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.irVersion&&e.hasOwnProperty("irVersion")&&!u.isInteger(e.irVersion)&&!(e.irVersion&&u.isInteger(e.irVersion.low)&&u.isInteger(e.irVersion.high)))return"irVersion: integer|Long expected";if(null!=e.opsetImport&&e.hasOwnProperty("opsetImport")){if(!Array.isArray(e.opsetImport))return"opsetImport: array expected";for(var t=0;t<e.opsetImport.length;++t)if(r=l.onnx.OperatorSetIdProto.verify(e.opsetImport[t]))return"opsetImport."+r}if(null!=e.producerName&&e.hasOwnProperty("producerName")&&!u.isString(e.producerName))return"producerName: string expected";if(null!=e.producerVersion&&e.hasOwnProperty("producerVersion")&&!u.isString(e.producerVersion))return"producerVersion: string expected";if(null!=e.domain&&e.hasOwnProperty("domain")&&!u.isString(e.domain))return"domain: string expected";if(null!=e.modelVersion&&e.hasOwnProperty("modelVersion")&&!u.isInteger(e.modelVersion)&&!(e.modelVersion&&u.isInteger(e.modelVersion.low)&&u.isInteger(e.modelVersion.high)))return"modelVersion: integer|Long expected";if(null!=e.docString&&e.hasOwnProperty("docString")&&!u.isString(e.docString))return"docString: string expected";if(null!=e.graph&&e.hasOwnProperty("graph")&&(r=l.onnx.GraphProto.verify(e.graph)))return"graph."+r;if(null!=e.metadataProps&&e.hasOwnProperty("metadataProps")){if(!Array.isArray(e.metadataProps))return"metadataProps: array expected";for(t=0;t<e.metadataProps.length;++t)if(r=l.onnx.StringStringEntryProto.verify(e.metadataProps[t]))return"metadataProps."+r}if(null!=e.trainingInfo&&e.hasOwnProperty("trainingInfo")){if(!Array.isArray(e.trainingInfo))return"trainingInfo: array expected";for(t=0;t<e.trainingInfo.length;++t)if(r=l.onnx.TrainingInfoProto.verify(e.trainingInfo[t]))return"trainingInfo."+r}if(null!=e.functions&&e.hasOwnProperty("functions")){if(!Array.isArray(e.functions))return"functions: array expected";for(t=0;t<e.functions.length;++t){var r;if(r=l.onnx.FunctionProto.verify(e.functions[t]))return"functions."+r}}return null},e.fromObject=function(e){if(e instanceof l.onnx.ModelProto)return e;var t=new l.onnx.ModelProto;if(null!=e.irVersion&&(u.Long?(t.irVersion=u.Long.fromValue(e.irVersion)).unsigned=!1:"string"==typeof e.irVersion?t.irVersion=parseInt(e.irVersion,10):"number"==typeof e.irVersion?t.irVersion=e.irVersion:"object"==typeof e.irVersion&&(t.irVersion=new u.LongBits(e.irVersion.low>>>0,e.irVersion.high>>>0).toNumber())),e.opsetImport){if(!Array.isArray(e.opsetImport))throw TypeError(".onnx.ModelProto.opsetImport: array expected");t.opsetImport=[];for(var r=0;r<e.opsetImport.length;++r){if("object"!=typeof e.opsetImport[r])throw TypeError(".onnx.ModelProto.opsetImport: object expected");t.opsetImport[r]=l.onnx.OperatorSetIdProto.fromObject(e.opsetImport[r])}}if(null!=e.producerName&&(t.producerName=String(e.producerName)),null!=e.producerVersion&&(t.producerVersion=String(e.producerVersion)),null!=e.domain&&(t.domain=String(e.domain)),null!=e.modelVersion&&(u.Long?(t.modelVersion=u.Long.fromValue(e.modelVersion)).unsigned=!1:"string"==typeof e.modelVersion?t.modelVersion=parseInt(e.modelVersion,10):"number"==typeof e.modelVersion?t.modelVersion=e.modelVersion:"object"==typeof e.modelVersion&&(t.modelVersion=new u.LongBits(e.modelVersion.low>>>0,e.modelVersion.high>>>0).toNumber())),null!=e.docString&&(t.docString=String(e.docString)),null!=e.graph){if("object"!=typeof e.graph)throw TypeError(".onnx.ModelProto.graph: object expected");t.graph=l.onnx.GraphProto.fromObject(e.graph)}if(e.metadataProps){if(!Array.isArray(e.metadataProps))throw TypeError(".onnx.ModelProto.metadataProps: array expected");for(t.metadataProps=[],r=0;r<e.metadataProps.length;++r){if("object"!=typeof e.metadataProps[r])throw TypeError(".onnx.ModelProto.metadataProps: object expected");t.metadataProps[r]=l.onnx.StringStringEntryProto.fromObject(e.metadataProps[r])}}if(e.trainingInfo){if(!Array.isArray(e.trainingInfo))throw TypeError(".onnx.ModelProto.trainingInfo: array expected");for(t.trainingInfo=[],r=0;r<e.trainingInfo.length;++r){if("object"!=typeof e.trainingInfo[r])throw TypeError(".onnx.ModelProto.trainingInfo: object expected");t.trainingInfo[r]=l.onnx.TrainingInfoProto.fromObject(e.trainingInfo[r])}}if(e.functions){if(!Array.isArray(e.functions))throw TypeError(".onnx.ModelProto.functions: array expected");for(t.functions=[],r=0;r<e.functions.length;++r){if("object"!=typeof e.functions[r])throw TypeError(".onnx.ModelProto.functions: object expected");t.functions[r]=l.onnx.FunctionProto.fromObject(e.functions[r])}}return t},e.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.opsetImport=[],r.metadataProps=[],r.trainingInfo=[],r.functions=[]),t.defaults){if(u.Long){var n=new u.Long(0,0,!1);r.irVersion=t.longs===String?n.toString():t.longs===Number?n.toNumber():n}else r.irVersion=t.longs===String?"0":0;r.producerName="",r.producerVersion="",r.domain="",u.Long?(n=new u.Long(0,0,!1),r.modelVersion=t.longs===String?n.toString():t.longs===Number?n.toNumber():n):r.modelVersion=t.longs===String?"0":0,r.docString="",r.graph=null}if(null!=e.irVersion&&e.hasOwnProperty("irVersion")&&("number"==typeof e.irVersion?r.irVersion=t.longs===String?String(e.irVersion):e.irVersion:r.irVersion=t.longs===String?u.Long.prototype.toString.call(e.irVersion):t.longs===Number?new u.LongBits(e.irVersion.low>>>0,e.irVersion.high>>>0).toNumber():e.irVersion),null!=e.producerName&&e.hasOwnProperty("producerName")&&(r.producerName=e.producerName),null!=e.producerVersion&&e.hasOwnProperty("producerVersion")&&(r.producerVersion=e.producerVersion),null!=e.domain&&e.hasOwnProperty("domain")&&(r.domain=e.domain),null!=e.modelVersion&&e.hasOwnProperty("modelVersion")&&("number"==typeof e.modelVersion?r.modelVersion=t.longs===String?String(e.modelVersion):e.modelVersion:r.modelVersion=t.longs===String?u.Long.prototype.toString.call(e.modelVersion):t.longs===Number?new u.LongBits(e.modelVersion.low>>>0,e.modelVersion.high>>>0).toNumber():e.modelVersion),null!=e.docString&&e.hasOwnProperty("docString")&&(r.docString=e.docString),null!=e.graph&&e.hasOwnProperty("graph")&&(r.graph=l.onnx.GraphProto.toObject(e.graph,t)),e.opsetImport&&e.opsetImport.length){r.opsetImport=[];for(var i=0;i<e.opsetImport.length;++i)r.opsetImport[i]=l.onnx.OperatorSetIdProto.toObject(e.opsetImport[i],t)}if(e.metadataProps&&e.metadataProps.length)for(r.metadataProps=[],i=0;i<e.metadataProps.length;++i)r.metadataProps[i]=l.onnx.StringStringEntryProto.toObject(e.metadataProps[i],t);if(e.trainingInfo&&e.trainingInfo.length)for(r.trainingInfo=[],i=0;i<e.trainingInfo.length;++i)r.trainingInfo[i]=l.onnx.TrainingInfoProto.toObject(e.trainingInfo[i],t);if(e.functions&&e.functions.length)for(r.functions=[],i=0;i<e.functions.length;++i)r.functions[i]=l.onnx.FunctionProto.toObject(e.functions[i],t);return r},e.prototype.toJSON=function(){return this.constructor.toObject(this,o.util.toJSONOptions)},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/onnx.ModelProto"},e}(),i.StringStringEntryProto=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.key="",e.prototype.value="",e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=s.create()),null!=e.key&&Object.hasOwnProperty.call(e,"key")&&t.uint32(10).string(e.key),null!=e.value&&Object.hasOwnProperty.call(e,"value")&&t.uint32(18).string(e.value),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof a||(e=a.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new l.onnx.StringStringEntryProto;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.key=e.string();break;case 2:n.value=e.string();break;default:e.skipType(7&i)}}return n},e.decodeDelimited=function(e){return e instanceof a||(e=new a(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.key&&e.hasOwnProperty("key")&&!u.isString(e.key)?"key: string expected":null!=e.value&&e.hasOwnProperty("value")&&!u.isString(e.value)?"value: string expected":null},e.fromObject=function(e){if(e instanceof l.onnx.StringStringEntryProto)return e;var t=new l.onnx.StringStringEntryProto;return null!=e.key&&(t.key=String(e.key)),null!=e.value&&(t.value=String(e.value)),t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.key="",r.value=""),null!=e.key&&e.hasOwnProperty("key")&&(r.key=e.key),null!=e.value&&e.hasOwnProperty("value")&&(r.value=e.value),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,o.util.toJSONOptions)},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/onnx.StringStringEntryProto"},e}(),i.TensorAnnotation=function(){function e(e){if(this.quantParameterTensorNames=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.tensorName="",e.prototype.quantParameterTensorNames=u.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=s.create()),null!=e.tensorName&&Object.hasOwnProperty.call(e,"tensorName")&&t.uint32(10).string(e.tensorName),null!=e.quantParameterTensorNames&&e.quantParameterTensorNames.length)for(var r=0;r<e.quantParameterTensorNames.length;++r)l.onnx.StringStringEntryProto.encode(e.quantParameterTensorNames[r],t.uint32(18).fork()).ldelim();return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof a||(e=a.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new l.onnx.TensorAnnotation;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.tensorName=e.string();break;case 2:n.quantParameterTensorNames&&n.quantParameterTensorNames.length||(n.quantParameterTensorNames=[]),n.quantParameterTensorNames.push(l.onnx.StringStringEntryProto.decode(e,e.uint32()));break;default:e.skipType(7&i)}}return n},e.decodeDelimited=function(e){return e instanceof a||(e=new a(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.tensorName&&e.hasOwnProperty("tensorName")&&!u.isString(e.tensorName))return"tensorName: string expected";if(null!=e.quantParameterTensorNames&&e.hasOwnProperty("quantParameterTensorNames")){if(!Array.isArray(e.quantParameterTensorNames))return"quantParameterTensorNames: array expected";for(var t=0;t<e.quantParameterTensorNames.length;++t){var r=l.onnx.StringStringEntryProto.verify(e.quantParameterTensorNames[t]);if(r)return"quantParameterTensorNames."+r}}return null},e.fromObject=function(e){if(e instanceof l.onnx.TensorAnnotation)return e;var t=new l.onnx.TensorAnnotation;if(null!=e.tensorName&&(t.tensorName=String(e.tensorName)),e.quantParameterTensorNames){if(!Array.isArray(e.quantParameterTensorNames))throw TypeError(".onnx.TensorAnnotation.quantParameterTensorNames: array expected");t.quantParameterTensorNames=[];for(var r=0;r<e.quantParameterTensorNames.length;++r){if("object"!=typeof e.quantParameterTensorNames[r])throw TypeError(".onnx.TensorAnnotation.quantParameterTensorNames: object expected");t.quantParameterTensorNames[r]=l.onnx.StringStringEntryProto.fromObject(e.quantParameterTensorNames[r])}}return t},e.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.quantParameterTensorNames=[]),t.defaults&&(r.tensorName=""),null!=e.tensorName&&e.hasOwnProperty("tensorName")&&(r.tensorName=e.tensorName),e.quantParameterTensorNames&&e.quantParameterTensorNames.length){r.quantParameterTensorNames=[];for(var n=0;n<e.quantParameterTensorNames.length;++n)r.quantParameterTensorNames[n]=l.onnx.StringStringEntryProto.toObject(e.quantParameterTensorNames[n],t)}return r},e.prototype.toJSON=function(){return this.constructor.toObject(this,o.util.toJSONOptions)},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/onnx.TensorAnnotation"},e}(),i.GraphProto=function(){function e(e){if(this.node=[],this.initializer=[],this.sparseInitializer=[],this.input=[],this.output=[],this.valueInfo=[],this.quantizationAnnotation=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.node=u.emptyArray,e.prototype.name="",e.prototype.initializer=u.emptyArray,e.prototype.sparseInitializer=u.emptyArray,e.prototype.docString="",e.prototype.input=u.emptyArray,e.prototype.output=u.emptyArray,e.prototype.valueInfo=u.emptyArray,e.prototype.quantizationAnnotation=u.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=s.create()),null!=e.node&&e.node.length)for(var r=0;r<e.node.length;++r)l.onnx.NodeProto.encode(e.node[r],t.uint32(10).fork()).ldelim();if(null!=e.name&&Object.hasOwnProperty.call(e,"name")&&t.uint32(18).string(e.name),null!=e.initializer&&e.initializer.length)for(r=0;r<e.initializer.length;++r)l.onnx.TensorProto.encode(e.initializer[r],t.uint32(42).fork()).ldelim();if(null!=e.docString&&Object.hasOwnProperty.call(e,"docString")&&t.uint32(82).string(e.docString),null!=e.input&&e.input.length)for(r=0;r<e.input.length;++r)l.onnx.ValueInfoProto.encode(e.input[r],t.uint32(90).fork()).ldelim();if(null!=e.output&&e.output.length)for(r=0;r<e.output.length;++r)l.onnx.ValueInfoProto.encode(e.output[r],t.uint32(98).fork()).ldelim();if(null!=e.valueInfo&&e.valueInfo.length)for(r=0;r<e.valueInfo.length;++r)l.onnx.ValueInfoProto.encode(e.valueInfo[r],t.uint32(106).fork()).ldelim();if(null!=e.quantizationAnnotation&&e.quantizationAnnotation.length)for(r=0;r<e.quantizationAnnotation.length;++r)l.onnx.TensorAnnotation.encode(e.quantizationAnnotation[r],t.uint32(114).fork()).ldelim();if(null!=e.sparseInitializer&&e.sparseInitializer.length)for(r=0;r<e.sparseInitializer.length;++r)l.onnx.SparseTensorProto.encode(e.sparseInitializer[r],t.uint32(122).fork()).ldelim();return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof a||(e=a.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new l.onnx.GraphProto;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.node&&n.node.length||(n.node=[]),n.node.push(l.onnx.NodeProto.decode(e,e.uint32()));break;case 2:n.name=e.string();break;case 5:n.initializer&&n.initializer.length||(n.initializer=[]),n.initializer.push(l.onnx.TensorProto.decode(e,e.uint32()));break;case 15:n.sparseInitializer&&n.sparseInitializer.length||(n.sparseInitializer=[]),n.sparseInitializer.push(l.onnx.SparseTensorProto.decode(e,e.uint32()));break;case 10:n.docString=e.string();break;case 11:n.input&&n.input.length||(n.input=[]),n.input.push(l.onnx.ValueInfoProto.decode(e,e.uint32()));break;case 12:n.output&&n.output.length||(n.output=[]),n.output.push(l.onnx.ValueInfoProto.decode(e,e.uint32()));break;case 13:n.valueInfo&&n.valueInfo.length||(n.valueInfo=[]),n.valueInfo.push(l.onnx.ValueInfoProto.decode(e,e.uint32()));break;case 14:n.quantizationAnnotation&&n.quantizationAnnotation.length||(n.quantizationAnnotation=[]),n.quantizationAnnotation.push(l.onnx.TensorAnnotation.decode(e,e.uint32()));break;default:e.skipType(7&i)}}return n},e.decodeDelimited=function(e){return e instanceof a||(e=new a(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.node&&e.hasOwnProperty("node")){if(!Array.isArray(e.node))return"node: array expected";for(var t=0;t<e.node.length;++t)if(r=l.onnx.NodeProto.verify(e.node[t]))return"node."+r}if(null!=e.name&&e.hasOwnProperty("name")&&!u.isString(e.name))return"name: string expected";if(null!=e.initializer&&e.hasOwnProperty("initializer")){if(!Array.isArray(e.initializer))return"initializer: array expected";for(t=0;t<e.initializer.length;++t)if(r=l.onnx.TensorProto.verify(e.initializer[t]))return"initializer."+r}if(null!=e.sparseInitializer&&e.hasOwnProperty("sparseInitializer")){if(!Array.isArray(e.sparseInitializer))return"sparseInitializer: array expected";for(t=0;t<e.sparseInitializer.length;++t)if(r=l.onnx.SparseTensorProto.verify(e.sparseInitializer[t]))return"sparseInitializer."+r}if(null!=e.docString&&e.hasOwnProperty("docString")&&!u.isString(e.docString))return"docString: string expected";if(null!=e.input&&e.hasOwnProperty("input")){if(!Array.isArray(e.input))return"input: array expected";for(t=0;t<e.input.length;++t)if(r=l.onnx.ValueInfoProto.verify(e.input[t]))return"input."+r}if(null!=e.output&&e.hasOwnProperty("output")){if(!Array.isArray(e.output))return"output: array expected";for(t=0;t<e.output.length;++t)if(r=l.onnx.ValueInfoProto.verify(e.output[t]))return"output."+r}if(null!=e.valueInfo&&e.hasOwnProperty("valueInfo")){if(!Array.isArray(e.valueInfo))return"valueInfo: array expected";for(t=0;t<e.valueInfo.length;++t)if(r=l.onnx.ValueInfoProto.verify(e.valueInfo[t]))return"valueInfo."+r}if(null!=e.quantizationAnnotation&&e.hasOwnProperty("quantizationAnnotation")){if(!Array.isArray(e.quantizationAnnotation))return"quantizationAnnotation: array expected";for(t=0;t<e.quantizationAnnotation.length;++t){var r;if(r=l.onnx.TensorAnnotation.verify(e.quantizationAnnotation[t]))return"quantizationAnnotation."+r}}return null},e.fromObject=function(e){if(e instanceof l.onnx.GraphProto)return e;var t=new l.onnx.GraphProto;if(e.node){if(!Array.isArray(e.node))throw TypeError(".onnx.GraphProto.node: array expected");t.node=[];for(var r=0;r<e.node.length;++r){if("object"!=typeof e.node[r])throw TypeError(".onnx.GraphProto.node: object expected");t.node[r]=l.onnx.NodeProto.fromObject(e.node[r])}}if(null!=e.name&&(t.name=String(e.name)),e.initializer){if(!Array.isArray(e.initializer))throw TypeError(".onnx.GraphProto.initializer: array expected");for(t.initializer=[],r=0;r<e.initializer.length;++r){if("object"!=typeof e.initializer[r])throw TypeError(".onnx.GraphProto.initializer: object expected");t.initializer[r]=l.onnx.TensorProto.fromObject(e.initializer[r])}}if(e.sparseInitializer){if(!Array.isArray(e.sparseInitializer))throw TypeError(".onnx.GraphProto.sparseInitializer: array expected");for(t.sparseInitializer=[],r=0;r<e.sparseInitializer.length;++r){if("object"!=typeof e.sparseInitializer[r])throw TypeError(".onnx.GraphProto.sparseInitializer: object expected");t.sparseInitializer[r]=l.onnx.SparseTensorProto.fromObject(e.sparseInitializer[r])}}if(null!=e.docString&&(t.docString=String(e.docString)),e.input){if(!Array.isArray(e.input))throw TypeError(".onnx.GraphProto.input: array expected");for(t.input=[],r=0;r<e.input.length;++r){if("object"!=typeof e.input[r])throw TypeError(".onnx.GraphProto.input: object expected");t.input[r]=l.onnx.ValueInfoProto.fromObject(e.input[r])}}if(e.output){if(!Array.isArray(e.output))throw TypeError(".onnx.GraphProto.output: array expected");for(t.output=[],r=0;r<e.output.length;++r){if("object"!=typeof e.output[r])throw TypeError(".onnx.GraphProto.output: object expected");t.output[r]=l.onnx.ValueInfoProto.fromObject(e.output[r])}}if(e.valueInfo){if(!Array.isArray(e.valueInfo))throw TypeError(".onnx.GraphProto.valueInfo: array expected");for(t.valueInfo=[],r=0;r<e.valueInfo.length;++r){if("object"!=typeof e.valueInfo[r])throw TypeError(".onnx.GraphProto.valueInfo: object expected");t.valueInfo[r]=l.onnx.ValueInfoProto.fromObject(e.valueInfo[r])}}if(e.quantizationAnnotation){if(!Array.isArray(e.quantizationAnnotation))throw TypeError(".onnx.GraphProto.quantizationAnnotation: array expected");for(t.quantizationAnnotation=[],r=0;r<e.quantizationAnnotation.length;++r){if("object"!=typeof e.quantizationAnnotation[r])throw TypeError(".onnx.GraphProto.quantizationAnnotation: object expected");t.quantizationAnnotation[r]=l.onnx.TensorAnnotation.fromObject(e.quantizationAnnotation[r])}}return t},e.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.node=[],r.initializer=[],r.input=[],r.output=[],r.valueInfo=[],r.quantizationAnnotation=[],r.sparseInitializer=[]),t.defaults&&(r.name="",r.docString=""),e.node&&e.node.length){r.node=[];for(var n=0;n<e.node.length;++n)r.node[n]=l.onnx.NodeProto.toObject(e.node[n],t)}if(null!=e.name&&e.hasOwnProperty("name")&&(r.name=e.name),e.initializer&&e.initializer.length)for(r.initializer=[],n=0;n<e.initializer.length;++n)r.initializer[n]=l.onnx.TensorProto.toObject(e.initializer[n],t);if(null!=e.docString&&e.hasOwnProperty("docString")&&(r.docString=e.docString),e.input&&e.input.length)for(r.input=[],n=0;n<e.input.length;++n)r.input[n]=l.onnx.ValueInfoProto.toObject(e.input[n],t);if(e.output&&e.output.length)for(r.output=[],n=0;n<e.output.length;++n)r.output[n]=l.onnx.ValueInfoProto.toObject(e.output[n],t);if(e.valueInfo&&e.valueInfo.length)for(r.valueInfo=[],n=0;n<e.valueInfo.length;++n)r.valueInfo[n]=l.onnx.ValueInfoProto.toObject(e.valueInfo[n],t);if(e.quantizationAnnotation&&e.quantizationAnnotation.length)for(r.quantizationAnnotation=[],n=0;n<e.quantizationAnnotation.length;++n)r.quantizationAnnotation[n]=l.onnx.TensorAnnotation.toObject(e.quantizationAnnotation[n],t);if(e.sparseInitializer&&e.sparseInitializer.length)for(r.sparseInitializer=[],n=0;n<e.sparseInitializer.length;++n)r.sparseInitializer[n]=l.onnx.SparseTensorProto.toObject(e.sparseInitializer[n],t);return r},e.prototype.toJSON=function(){return this.constructor.toObject(this,o.util.toJSONOptions)},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/onnx.GraphProto"},e}(),i.TensorProto=function(){function e(e){if(this.dims=[],this.floatData=[],this.int32Data=[],this.stringData=[],this.int64Data=[],this.externalData=[],this.doubleData=[],this.uint64Data=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.dims=u.emptyArray,e.prototype.dataType=0,e.prototype.segment=null,e.prototype.floatData=u.emptyArray,e.prototype.int32Data=u.emptyArray,e.prototype.stringData=u.emptyArray,e.prototype.int64Data=u.emptyArray,e.prototype.name="",e.prototype.docString="",e.prototype.rawData=u.newBuffer([]),e.prototype.externalData=u.emptyArray,e.prototype.dataLocation=0,e.prototype.doubleData=u.emptyArray,e.prototype.uint64Data=u.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=s.create()),null!=e.dims&&e.dims.length){t.uint32(10).fork();for(var r=0;r<e.dims.length;++r)t.int64(e.dims[r]);t.ldelim()}if(null!=e.dataType&&Object.hasOwnProperty.call(e,"dataType")&&t.uint32(16).int32(e.dataType),null!=e.segment&&Object.hasOwnProperty.call(e,"segment")&&l.onnx.TensorProto.Segment.encode(e.segment,t.uint32(26).fork()).ldelim(),null!=e.floatData&&e.floatData.length){for(t.uint32(34).fork(),r=0;r<e.floatData.length;++r)t.float(e.floatData[r]);t.ldelim()}if(null!=e.int32Data&&e.int32Data.length){for(t.uint32(42).fork(),r=0;r<e.int32Data.length;++r)t.int32(e.int32Data[r]);t.ldelim()}if(null!=e.stringData&&e.stringData.length)for(r=0;r<e.stringData.length;++r)t.uint32(50).bytes(e.stringData[r]);if(null!=e.int64Data&&e.int64Data.length){for(t.uint32(58).fork(),r=0;r<e.int64Data.length;++r)t.int64(e.int64Data[r]);t.ldelim()}if(null!=e.name&&Object.hasOwnProperty.call(e,"name")&&t.uint32(66).string(e.name),null!=e.rawData&&Object.hasOwnProperty.call(e,"rawData")&&t.uint32(74).bytes(e.rawData),null!=e.doubleData&&e.doubleData.length){for(t.uint32(82).fork(),r=0;r<e.doubleData.length;++r)t.double(e.doubleData[r]);t.ldelim()}if(null!=e.uint64Data&&e.uint64Data.length){for(t.uint32(90).fork(),r=0;r<e.uint64Data.length;++r)t.uint64(e.uint64Data[r]);t.ldelim()}if(null!=e.docString&&Object.hasOwnProperty.call(e,"docString")&&t.uint32(98).string(e.docString),null!=e.externalData&&e.externalData.length)for(r=0;r<e.externalData.length;++r)l.onnx.StringStringEntryProto.encode(e.externalData[r],t.uint32(106).fork()).ldelim();return null!=e.dataLocation&&Object.hasOwnProperty.call(e,"dataLocation")&&t.uint32(112).int32(e.dataLocation),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof a||(e=a.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new l.onnx.TensorProto;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:if(n.dims&&n.dims.length||(n.dims=[]),2==(7&i))for(var o=e.uint32()+e.pos;e.pos<o;)n.dims.push(e.int64());else n.dims.push(e.int64());break;case 2:n.dataType=e.int32();break;case 3:n.segment=l.onnx.TensorProto.Segment.decode(e,e.uint32());break;case 4:if(n.floatData&&n.floatData.length||(n.floatData=[]),2==(7&i))for(o=e.uint32()+e.pos;e.pos<o;)n.floatData.push(e.float());else n.floatData.push(e.float());break;case 5:if(n.int32Data&&n.int32Data.length||(n.int32Data=[]),2==(7&i))for(o=e.uint32()+e.pos;e.pos<o;)n.int32Data.push(e.int32());else n.int32Data.push(e.int32());break;case 6:n.stringData&&n.stringData.length||(n.stringData=[]),n.stringData.push(e.bytes());break;case 7:if(n.int64Data&&n.int64Data.length||(n.int64Data=[]),2==(7&i))for(o=e.uint32()+e.pos;e.pos<o;)n.int64Data.push(e.int64());else n.int64Data.push(e.int64());break;case 8:n.name=e.string();break;case 12:n.docString=e.string();break;case 9:n.rawData=e.bytes();break;case 13:n.externalData&&n.externalData.length||(n.externalData=[]),n.externalData.push(l.onnx.StringStringEntryProto.decode(e,e.uint32()));break;case 14:n.dataLocation=e.int32();break;case 10:if(n.doubleData&&n.doubleData.length||(n.doubleData=[]),2==(7&i))for(o=e.uint32()+e.pos;e.pos<o;)n.doubleData.push(e.double());else n.doubleData.push(e.double());break;case 11:if(n.uint64Data&&n.uint64Data.length||(n.uint64Data=[]),2==(7&i))for(o=e.uint32()+e.pos;e.pos<o;)n.uint64Data.push(e.uint64());else n.uint64Data.push(e.uint64());break;default:e.skipType(7&i)}}return n},e.decodeDelimited=function(e){return e instanceof a||(e=new a(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.dims&&e.hasOwnProperty("dims")){if(!Array.isArray(e.dims))return"dims: array expected";for(var t=0;t<e.dims.length;++t)if(!(u.isInteger(e.dims[t])||e.dims[t]&&u.isInteger(e.dims[t].low)&&u.isInteger(e.dims[t].high)))return"dims: integer|Long[] expected"}if(null!=e.dataType&&e.hasOwnProperty("dataType")&&!u.isInteger(e.dataType))return"dataType: integer expected";if(null!=e.segment&&e.hasOwnProperty("segment")&&(r=l.onnx.TensorProto.Segment.verify(e.segment)))return"segment."+r;if(null!=e.floatData&&e.hasOwnProperty("floatData")){if(!Array.isArray(e.floatData))return"floatData: array expected";for(t=0;t<e.floatData.length;++t)if("number"!=typeof e.floatData[t])return"floatData: number[] expected"}if(null!=e.int32Data&&e.hasOwnProperty("int32Data")){if(!Array.isArray(e.int32Data))return"int32Data: array expected";for(t=0;t<e.int32Data.length;++t)if(!u.isInteger(e.int32Data[t]))return"int32Data: integer[] expected"}if(null!=e.stringData&&e.hasOwnProperty("stringData")){if(!Array.isArray(e.stringData))return"stringData: array expected";for(t=0;t<e.stringData.length;++t)if(!(e.stringData[t]&&"number"==typeof e.stringData[t].length||u.isString(e.stringData[t])))return"stringData: buffer[] expected"}if(null!=e.int64Data&&e.hasOwnProperty("int64Data")){if(!Array.isArray(e.int64Data))return"int64Data: array expected";for(t=0;t<e.int64Data.length;++t)if(!(u.isInteger(e.int64Data[t])||e.int64Data[t]&&u.isInteger(e.int64Data[t].low)&&u.isInteger(e.int64Data[t].high)))return"int64Data: integer|Long[] expected"}if(null!=e.name&&e.hasOwnProperty("name")&&!u.isString(e.name))return"name: string expected";if(null!=e.docString&&e.hasOwnProperty("docString")&&!u.isString(e.docString))return"docString: string expected";if(null!=e.rawData&&e.hasOwnProperty("rawData")&&!(e.rawData&&"number"==typeof e.rawData.length||u.isString(e.rawData)))return"rawData: buffer expected";if(null!=e.externalData&&e.hasOwnProperty("externalData")){if(!Array.isArray(e.externalData))return"externalData: array expected";for(t=0;t<e.externalData.length;++t){var r;if(r=l.onnx.StringStringEntryProto.verify(e.externalData[t]))return"externalData."+r}}if(null!=e.dataLocation&&e.hasOwnProperty("dataLocation"))switch(e.dataLocation){default:return"dataLocation: enum value expected";case 0:case 1:}if(null!=e.doubleData&&e.hasOwnProperty("doubleData")){if(!Array.isArray(e.doubleData))return"doubleData: array expected";for(t=0;t<e.doubleData.length;++t)if("number"!=typeof e.doubleData[t])return"doubleData: number[] expected"}if(null!=e.uint64Data&&e.hasOwnProperty("uint64Data")){if(!Array.isArray(e.uint64Data))return"uint64Data: array expected";for(t=0;t<e.uint64Data.length;++t)if(!(u.isInteger(e.uint64Data[t])||e.uint64Data[t]&&u.isInteger(e.uint64Data[t].low)&&u.isInteger(e.uint64Data[t].high)))return"uint64Data: integer|Long[] expected"}return null},e.fromObject=function(e){if(e instanceof l.onnx.TensorProto)return e;var t=new l.onnx.TensorProto;if(e.dims){if(!Array.isArray(e.dims))throw TypeError(".onnx.TensorProto.dims: array expected");t.dims=[];for(var r=0;r<e.dims.length;++r)u.Long?(t.dims[r]=u.Long.fromValue(e.dims[r])).unsigned=!1:"string"==typeof e.dims[r]?t.dims[r]=parseInt(e.dims[r],10):"number"==typeof e.dims[r]?t.dims[r]=e.dims[r]:"object"==typeof e.dims[r]&&(t.dims[r]=new u.LongBits(e.dims[r].low>>>0,e.dims[r].high>>>0).toNumber())}if(null!=e.dataType&&(t.dataType=0|e.dataType),null!=e.segment){if("object"!=typeof e.segment)throw TypeError(".onnx.TensorProto.segment: object expected");t.segment=l.onnx.TensorProto.Segment.fromObject(e.segment)}if(e.floatData){if(!Array.isArray(e.floatData))throw TypeError(".onnx.TensorProto.floatData: array expected");for(t.floatData=[],r=0;r<e.floatData.length;++r)t.floatData[r]=Number(e.floatData[r])}if(e.int32Data){if(!Array.isArray(e.int32Data))throw TypeError(".onnx.TensorProto.int32Data: array expected");for(t.int32Data=[],r=0;r<e.int32Data.length;++r)t.int32Data[r]=0|e.int32Data[r]}if(e.stringData){if(!Array.isArray(e.stringData))throw TypeError(".onnx.TensorProto.stringData: array expected");for(t.stringData=[],r=0;r<e.stringData.length;++r)"string"==typeof e.stringData[r]?u.base64.decode(e.stringData[r],t.stringData[r]=u.newBuffer(u.base64.length(e.stringData[r])),0):e.stringData[r].length>=0&&(t.stringData[r]=e.stringData[r])}if(e.int64Data){if(!Array.isArray(e.int64Data))throw TypeError(".onnx.TensorProto.int64Data: array expected");for(t.int64Data=[],r=0;r<e.int64Data.length;++r)u.Long?(t.int64Data[r]=u.Long.fromValue(e.int64Data[r])).unsigned=!1:"string"==typeof e.int64Data[r]?t.int64Data[r]=parseInt(e.int64Data[r],10):"number"==typeof e.int64Data[r]?t.int64Data[r]=e.int64Data[r]:"object"==typeof e.int64Data[r]&&(t.int64Data[r]=new u.LongBits(e.int64Data[r].low>>>0,e.int64Data[r].high>>>0).toNumber())}if(null!=e.name&&(t.name=String(e.name)),null!=e.docString&&(t.docString=String(e.docString)),null!=e.rawData&&("string"==typeof e.rawData?u.base64.decode(e.rawData,t.rawData=u.newBuffer(u.base64.length(e.rawData)),0):e.rawData.length>=0&&(t.rawData=e.rawData)),e.externalData){if(!Array.isArray(e.externalData))throw TypeError(".onnx.TensorProto.externalData: array expected");for(t.externalData=[],r=0;r<e.externalData.length;++r){if("object"!=typeof e.externalData[r])throw TypeError(".onnx.TensorProto.externalData: object expected");t.externalData[r]=l.onnx.StringStringEntryProto.fromObject(e.externalData[r])}}switch(e.dataLocation){default:if("number"==typeof e.dataLocation){t.dataLocation=e.dataLocation;break}break;case"DEFAULT":case 0:t.dataLocation=0;break;case"EXTERNAL":case 1:t.dataLocation=1}if(e.doubleData){if(!Array.isArray(e.doubleData))throw TypeError(".onnx.TensorProto.doubleData: array expected");for(t.doubleData=[],r=0;r<e.doubleData.length;++r)t.doubleData[r]=Number(e.doubleData[r])}if(e.uint64Data){if(!Array.isArray(e.uint64Data))throw TypeError(".onnx.TensorProto.uint64Data: array expected");for(t.uint64Data=[],r=0;r<e.uint64Data.length;++r)u.Long?(t.uint64Data[r]=u.Long.fromValue(e.uint64Data[r])).unsigned=!0:"string"==typeof e.uint64Data[r]?t.uint64Data[r]=parseInt(e.uint64Data[r],10):"number"==typeof e.uint64Data[r]?t.uint64Data[r]=e.uint64Data[r]:"object"==typeof e.uint64Data[r]&&(t.uint64Data[r]=new u.LongBits(e.uint64Data[r].low>>>0,e.uint64Data[r].high>>>0).toNumber(!0))}return t},e.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.dims=[],r.floatData=[],r.int32Data=[],r.stringData=[],r.int64Data=[],r.doubleData=[],r.uint64Data=[],r.externalData=[]),t.defaults&&(r.dataType=0,r.segment=null,r.name="",t.bytes===String?r.rawData="":(r.rawData=[],t.bytes!==Array&&(r.rawData=u.newBuffer(r.rawData))),r.docString="",r.dataLocation=t.enums===String?"DEFAULT":0),e.dims&&e.dims.length){r.dims=[];for(var n=0;n<e.dims.length;++n)"number"==typeof e.dims[n]?r.dims[n]=t.longs===String?String(e.dims[n]):e.dims[n]:r.dims[n]=t.longs===String?u.Long.prototype.toString.call(e.dims[n]):t.longs===Number?new u.LongBits(e.dims[n].low>>>0,e.dims[n].high>>>0).toNumber():e.dims[n]}if(null!=e.dataType&&e.hasOwnProperty("dataType")&&(r.dataType=e.dataType),null!=e.segment&&e.hasOwnProperty("segment")&&(r.segment=l.onnx.TensorProto.Segment.toObject(e.segment,t)),e.floatData&&e.floatData.length)for(r.floatData=[],n=0;n<e.floatData.length;++n)r.floatData[n]=t.json&&!isFinite(e.floatData[n])?String(e.floatData[n]):e.floatData[n];if(e.int32Data&&e.int32Data.length)for(r.int32Data=[],n=0;n<e.int32Data.length;++n)r.int32Data[n]=e.int32Data[n];if(e.stringData&&e.stringData.length)for(r.stringData=[],n=0;n<e.stringData.length;++n)r.stringData[n]=t.bytes===String?u.base64.encode(e.stringData[n],0,e.stringData[n].length):t.bytes===Array?Array.prototype.slice.call(e.stringData[n]):e.stringData[n];if(e.int64Data&&e.int64Data.length)for(r.int64Data=[],n=0;n<e.int64Data.length;++n)"number"==typeof e.int64Data[n]?r.int64Data[n]=t.longs===String?String(e.int64Data[n]):e.int64Data[n]:r.int64Data[n]=t.longs===String?u.Long.prototype.toString.call(e.int64Data[n]):t.longs===Number?new u.LongBits(e.int64Data[n].low>>>0,e.int64Data[n].high>>>0).toNumber():e.int64Data[n];if(null!=e.name&&e.hasOwnProperty("name")&&(r.name=e.name),null!=e.rawData&&e.hasOwnProperty("rawData")&&(r.rawData=t.bytes===String?u.base64.encode(e.rawData,0,e.rawData.length):t.bytes===Array?Array.prototype.slice.call(e.rawData):e.rawData),e.doubleData&&e.doubleData.length)for(r.doubleData=[],n=0;n<e.doubleData.length;++n)r.doubleData[n]=t.json&&!isFinite(e.doubleData[n])?String(e.doubleData[n]):e.doubleData[n];if(e.uint64Data&&e.uint64Data.length)for(r.uint64Data=[],n=0;n<e.uint64Data.length;++n)"number"==typeof e.uint64Data[n]?r.uint64Data[n]=t.longs===String?String(e.uint64Data[n]):e.uint64Data[n]:r.uint64Data[n]=t.longs===String?u.Long.prototype.toString.call(e.uint64Data[n]):t.longs===Number?new u.LongBits(e.uint64Data[n].low>>>0,e.uint64Data[n].high>>>0).toNumber(!0):e.uint64Data[n];if(null!=e.docString&&e.hasOwnProperty("docString")&&(r.docString=e.docString),e.externalData&&e.externalData.length)for(r.externalData=[],n=0;n<e.externalData.length;++n)r.externalData[n]=l.onnx.StringStringEntryProto.toObject(e.externalData[n],t);return null!=e.dataLocation&&e.hasOwnProperty("dataLocation")&&(r.dataLocation=t.enums===String?void 0===l.onnx.TensorProto.DataLocation[e.dataLocation]?e.dataLocation:l.onnx.TensorProto.DataLocation[e.dataLocation]:e.dataLocation),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,o.util.toJSONOptions)},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/onnx.TensorProto"},e.DataType=function(){var e={},t=Object.create(e);return t[e[0]="UNDEFINED"]=0,t[e[1]="FLOAT"]=1,t[e[2]="UINT8"]=2,t[e[3]="INT8"]=3,t[e[4]="UINT16"]=4,t[e[5]="INT16"]=5,t[e[6]="INT32"]=6,t[e[7]="INT64"]=7,t[e[8]="STRING"]=8,t[e[9]="BOOL"]=9,t[e[10]="FLOAT16"]=10,t[e[11]="DOUBLE"]=11,t[e[12]="UINT32"]=12,t[e[13]="UINT64"]=13,t[e[14]="COMPLEX64"]=14,t[e[15]="COMPLEX128"]=15,t[e[16]="BFLOAT16"]=16,t[e[17]="FLOAT8E4M3FN"]=17,t[e[18]="FLOAT8E4M3FNUZ"]=18,t[e[19]="FLOAT8E5M2"]=19,t[e[20]="FLOAT8E5M2FNUZ"]=20,t}(),e.Segment=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.begin=u.Long?u.Long.fromBits(0,0,!1):0,e.prototype.end=u.Long?u.Long.fromBits(0,0,!1):0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=s.create()),null!=e.begin&&Object.hasOwnProperty.call(e,"begin")&&t.uint32(8).int64(e.begin),null!=e.end&&Object.hasOwnProperty.call(e,"end")&&t.uint32(16).int64(e.end),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof a||(e=a.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new l.onnx.TensorProto.Segment;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.begin=e.int64();break;case 2:n.end=e.int64();break;default:e.skipType(7&i)}}return n},e.decodeDelimited=function(e){return e instanceof a||(e=new a(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!=typeof e||null===e?"object expected":null==e.begin||!e.hasOwnProperty("begin")||u.isInteger(e.begin)||e.begin&&u.isInteger(e.begin.low)&&u.isInteger(e.begin.high)?null==e.end||!e.hasOwnProperty("end")||u.isInteger(e.end)||e.end&&u.isInteger(e.end.low)&&u.isInteger(e.end.high)?null:"end: integer|Long expected":"begin: integer|Long expected"},e.fromObject=function(e){if(e instanceof l.onnx.TensorProto.Segment)return e;var t=new l.onnx.TensorProto.Segment;return null!=e.begin&&(u.Long?(t.begin=u.Long.fromValue(e.begin)).unsigned=!1:"string"==typeof e.begin?t.begin=parseInt(e.begin,10):"number"==typeof e.begin?t.begin=e.begin:"object"==typeof e.begin&&(t.begin=new u.LongBits(e.begin.low>>>0,e.begin.high>>>0).toNumber())),null!=e.end&&(u.Long?(t.end=u.Long.fromValue(e.end)).unsigned=!1:"string"==typeof e.end?t.end=parseInt(e.end,10):"number"==typeof e.end?t.end=e.end:"object"==typeof e.end&&(t.end=new u.LongBits(e.end.low>>>0,e.end.high>>>0).toNumber())),t},e.toObject=function(e,t){t||(t={});var r={};if(t.defaults){if(u.Long){var n=new u.Long(0,0,!1);r.begin=t.longs===String?n.toString():t.longs===Number?n.toNumber():n}else r.begin=t.longs===String?"0":0;u.Long?(n=new u.Long(0,0,!1),r.end=t.longs===String?n.toString():t.longs===Number?n.toNumber():n):r.end=t.longs===String?"0":0}return null!=e.begin&&e.hasOwnProperty("begin")&&("number"==typeof e.begin?r.begin=t.longs===String?String(e.begin):e.begin:r.begin=t.longs===String?u.Long.prototype.toString.call(e.begin):t.longs===Number?new u.LongBits(e.begin.low>>>0,e.begin.high>>>0).toNumber():e.begin),null!=e.end&&e.hasOwnProperty("end")&&("number"==typeof e.end?r.end=t.longs===String?String(e.end):e.end:r.end=t.longs===String?u.Long.prototype.toString.call(e.end):t.longs===Number?new u.LongBits(e.end.low>>>0,e.end.high>>>0).toNumber():e.end),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,o.util.toJSONOptions)},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/onnx.TensorProto.Segment"},e}(),e.DataLocation=function(){var e={},t=Object.create(e);return t[e[0]="DEFAULT"]=0,t[e[1]="EXTERNAL"]=1,t}(),e}(),i.SparseTensorProto=function(){function e(e){if(this.dims=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.values=null,e.prototype.indices=null,e.prototype.dims=u.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=s.create()),null!=e.values&&Object.hasOwnProperty.call(e,"values")&&l.onnx.TensorProto.encode(e.values,t.uint32(10).fork()).ldelim(),null!=e.indices&&Object.hasOwnProperty.call(e,"indices")&&l.onnx.TensorProto.encode(e.indices,t.uint32(18).fork()).ldelim(),null!=e.dims&&e.dims.length){t.uint32(26).fork();for(var r=0;r<e.dims.length;++r)t.int64(e.dims[r]);t.ldelim()}return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof a||(e=a.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new l.onnx.SparseTensorProto;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.values=l.onnx.TensorProto.decode(e,e.uint32());break;case 2:n.indices=l.onnx.TensorProto.decode(e,e.uint32());break;case 3:if(n.dims&&n.dims.length||(n.dims=[]),2==(7&i))for(var o=e.uint32()+e.pos;e.pos<o;)n.dims.push(e.int64());else n.dims.push(e.int64());break;default:e.skipType(7&i)}}return n},e.decodeDelimited=function(e){return e instanceof a||(e=new a(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";var t;if(null!=e.values&&e.hasOwnProperty("values")&&(t=l.onnx.TensorProto.verify(e.values)))return"values."+t;if(null!=e.indices&&e.hasOwnProperty("indices")&&(t=l.onnx.TensorProto.verify(e.indices)))return"indices."+t;if(null!=e.dims&&e.hasOwnProperty("dims")){if(!Array.isArray(e.dims))return"dims: array expected";for(var r=0;r<e.dims.length;++r)if(!(u.isInteger(e.dims[r])||e.dims[r]&&u.isInteger(e.dims[r].low)&&u.isInteger(e.dims[r].high)))return"dims: integer|Long[] expected"}return null},e.fromObject=function(e){if(e instanceof l.onnx.SparseTensorProto)return e;var t=new l.onnx.SparseTensorProto;if(null!=e.values){if("object"!=typeof e.values)throw TypeError(".onnx.SparseTensorProto.values: object expected");t.values=l.onnx.TensorProto.fromObject(e.values)}if(null!=e.indices){if("object"!=typeof e.indices)throw TypeError(".onnx.SparseTensorProto.indices: object expected");t.indices=l.onnx.TensorProto.fromObject(e.indices)}if(e.dims){if(!Array.isArray(e.dims))throw TypeError(".onnx.SparseTensorProto.dims: array expected");t.dims=[];for(var r=0;r<e.dims.length;++r)u.Long?(t.dims[r]=u.Long.fromValue(e.dims[r])).unsigned=!1:"string"==typeof e.dims[r]?t.dims[r]=parseInt(e.dims[r],10):"number"==typeof e.dims[r]?t.dims[r]=e.dims[r]:"object"==typeof e.dims[r]&&(t.dims[r]=new u.LongBits(e.dims[r].low>>>0,e.dims[r].high>>>0).toNumber())}return t},e.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.dims=[]),t.defaults&&(r.values=null,r.indices=null),null!=e.values&&e.hasOwnProperty("values")&&(r.values=l.onnx.TensorProto.toObject(e.values,t)),null!=e.indices&&e.hasOwnProperty("indices")&&(r.indices=l.onnx.TensorProto.toObject(e.indices,t)),e.dims&&e.dims.length){r.dims=[];for(var n=0;n<e.dims.length;++n)"number"==typeof e.dims[n]?r.dims[n]=t.longs===String?String(e.dims[n]):e.dims[n]:r.dims[n]=t.longs===String?u.Long.prototype.toString.call(e.dims[n]):t.longs===Number?new u.LongBits(e.dims[n].low>>>0,e.dims[n].high>>>0).toNumber():e.dims[n]}return r},e.prototype.toJSON=function(){return this.constructor.toObject(this,o.util.toJSONOptions)},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/onnx.SparseTensorProto"},e}(),i.TensorShapeProto=function(){function e(e){if(this.dim=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.dim=u.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=s.create()),null!=e.dim&&e.dim.length)for(var r=0;r<e.dim.length;++r)l.onnx.TensorShapeProto.Dimension.encode(e.dim[r],t.uint32(10).fork()).ldelim();return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof a||(e=a.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new l.onnx.TensorShapeProto;e.pos<r;){var i=e.uint32();i>>>3==1?(n.dim&&n.dim.length||(n.dim=[]),n.dim.push(l.onnx.TensorShapeProto.Dimension.decode(e,e.uint32()))):e.skipType(7&i)}return n},e.decodeDelimited=function(e){return e instanceof a||(e=new a(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.dim&&e.hasOwnProperty("dim")){if(!Array.isArray(e.dim))return"dim: array expected";for(var t=0;t<e.dim.length;++t){var r=l.onnx.TensorShapeProto.Dimension.verify(e.dim[t]);if(r)return"dim."+r}}return null},e.fromObject=function(e){if(e instanceof l.onnx.TensorShapeProto)return e;var t=new l.onnx.TensorShapeProto;if(e.dim){if(!Array.isArray(e.dim))throw TypeError(".onnx.TensorShapeProto.dim: array expected");t.dim=[];for(var r=0;r<e.dim.length;++r){if("object"!=typeof e.dim[r])throw TypeError(".onnx.TensorShapeProto.dim: object expected");t.dim[r]=l.onnx.TensorShapeProto.Dimension.fromObject(e.dim[r])}}return t},e.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.dim=[]),e.dim&&e.dim.length){r.dim=[];for(var n=0;n<e.dim.length;++n)r.dim[n]=l.onnx.TensorShapeProto.Dimension.toObject(e.dim[n],t)}return r},e.prototype.toJSON=function(){return this.constructor.toObject(this,o.util.toJSONOptions)},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/onnx.TensorShapeProto"},e.Dimension=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}var t;return e.prototype.dimValue=null,e.prototype.dimParam=null,e.prototype.denotation="",Object.defineProperty(e.prototype,"value",{get:u.oneOfGetter(t=["dimValue","dimParam"]),set:u.oneOfSetter(t)}),e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=s.create()),null!=e.dimValue&&Object.hasOwnProperty.call(e,"dimValue")&&t.uint32(8).int64(e.dimValue),null!=e.dimParam&&Object.hasOwnProperty.call(e,"dimParam")&&t.uint32(18).string(e.dimParam),null!=e.denotation&&Object.hasOwnProperty.call(e,"denotation")&&t.uint32(26).string(e.denotation),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof a||(e=a.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new l.onnx.TensorShapeProto.Dimension;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.dimValue=e.int64();break;case 2:n.dimParam=e.string();break;case 3:n.denotation=e.string();break;default:e.skipType(7&i)}}return n},e.decodeDelimited=function(e){return e instanceof a||(e=new a(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";var t={};if(null!=e.dimValue&&e.hasOwnProperty("dimValue")&&(t.value=1,!(u.isInteger(e.dimValue)||e.dimValue&&u.isInteger(e.dimValue.low)&&u.isInteger(e.dimValue.high))))return"dimValue: integer|Long expected";if(null!=e.dimParam&&e.hasOwnProperty("dimParam")){if(1===t.value)return"value: multiple values";if(t.value=1,!u.isString(e.dimParam))return"dimParam: string expected"}return null!=e.denotation&&e.hasOwnProperty("denotation")&&!u.isString(e.denotation)?"denotation: string expected":null},e.fromObject=function(e){if(e instanceof l.onnx.TensorShapeProto.Dimension)return e;var t=new l.onnx.TensorShapeProto.Dimension;return null!=e.dimValue&&(u.Long?(t.dimValue=u.Long.fromValue(e.dimValue)).unsigned=!1:"string"==typeof e.dimValue?t.dimValue=parseInt(e.dimValue,10):"number"==typeof e.dimValue?t.dimValue=e.dimValue:"object"==typeof e.dimValue&&(t.dimValue=new u.LongBits(e.dimValue.low>>>0,e.dimValue.high>>>0).toNumber())),null!=e.dimParam&&(t.dimParam=String(e.dimParam)),null!=e.denotation&&(t.denotation=String(e.denotation)),t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.denotation=""),null!=e.dimValue&&e.hasOwnProperty("dimValue")&&("number"==typeof e.dimValue?r.dimValue=t.longs===String?String(e.dimValue):e.dimValue:r.dimValue=t.longs===String?u.Long.prototype.toString.call(e.dimValue):t.longs===Number?new u.LongBits(e.dimValue.low>>>0,e.dimValue.high>>>0).toNumber():e.dimValue,t.oneofs&&(r.value="dimValue")),null!=e.dimParam&&e.hasOwnProperty("dimParam")&&(r.dimParam=e.dimParam,t.oneofs&&(r.value="dimParam")),null!=e.denotation&&e.hasOwnProperty("denotation")&&(r.denotation=e.denotation),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,o.util.toJSONOptions)},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/onnx.TensorShapeProto.Dimension"},e}(),e}(),i.TypeProto=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}var t;return e.prototype.tensorType=null,e.prototype.sequenceType=null,e.prototype.mapType=null,e.prototype.optionalType=null,e.prototype.sparseTensorType=null,e.prototype.denotation="",Object.defineProperty(e.prototype,"value",{get:u.oneOfGetter(t=["tensorType","sequenceType","mapType","optionalType","sparseTensorType"]),set:u.oneOfSetter(t)}),e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=s.create()),null!=e.tensorType&&Object.hasOwnProperty.call(e,"tensorType")&&l.onnx.TypeProto.Tensor.encode(e.tensorType,t.uint32(10).fork()).ldelim(),null!=e.sequenceType&&Object.hasOwnProperty.call(e,"sequenceType")&&l.onnx.TypeProto.Sequence.encode(e.sequenceType,t.uint32(34).fork()).ldelim(),null!=e.mapType&&Object.hasOwnProperty.call(e,"mapType")&&l.onnx.TypeProto.Map.encode(e.mapType,t.uint32(42).fork()).ldelim(),null!=e.denotation&&Object.hasOwnProperty.call(e,"denotation")&&t.uint32(50).string(e.denotation),null!=e.sparseTensorType&&Object.hasOwnProperty.call(e,"sparseTensorType")&&l.onnx.TypeProto.SparseTensor.encode(e.sparseTensorType,t.uint32(66).fork()).ldelim(),null!=e.optionalType&&Object.hasOwnProperty.call(e,"optionalType")&&l.onnx.TypeProto.Optional.encode(e.optionalType,t.uint32(74).fork()).ldelim(),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof a||(e=a.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new l.onnx.TypeProto;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.tensorType=l.onnx.TypeProto.Tensor.decode(e,e.uint32());break;case 4:n.sequenceType=l.onnx.TypeProto.Sequence.decode(e,e.uint32());break;case 5:n.mapType=l.onnx.TypeProto.Map.decode(e,e.uint32());break;case 9:n.optionalType=l.onnx.TypeProto.Optional.decode(e,e.uint32());break;case 8:n.sparseTensorType=l.onnx.TypeProto.SparseTensor.decode(e,e.uint32());break;case 6:n.denotation=e.string();break;default:e.skipType(7&i)}}return n},e.decodeDelimited=function(e){return e instanceof a||(e=new a(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";var t={};if(null!=e.tensorType&&e.hasOwnProperty("tensorType")&&(t.value=1,r=l.onnx.TypeProto.Tensor.verify(e.tensorType)))return"tensorType."+r;if(null!=e.sequenceType&&e.hasOwnProperty("sequenceType")){if(1===t.value)return"value: multiple values";if(t.value=1,r=l.onnx.TypeProto.Sequence.verify(e.sequenceType))return"sequenceType."+r}if(null!=e.mapType&&e.hasOwnProperty("mapType")){if(1===t.value)return"value: multiple values";if(t.value=1,r=l.onnx.TypeProto.Map.verify(e.mapType))return"mapType."+r}if(null!=e.optionalType&&e.hasOwnProperty("optionalType")){if(1===t.value)return"value: multiple values";if(t.value=1,r=l.onnx.TypeProto.Optional.verify(e.optionalType))return"optionalType."+r}if(null!=e.sparseTensorType&&e.hasOwnProperty("sparseTensorType")){if(1===t.value)return"value: multiple values";var r;if(t.value=1,r=l.onnx.TypeProto.SparseTensor.verify(e.sparseTensorType))return"sparseTensorType."+r}return null!=e.denotation&&e.hasOwnProperty("denotation")&&!u.isString(e.denotation)?"denotation: string expected":null},e.fromObject=function(e){if(e instanceof l.onnx.TypeProto)return e;var t=new l.onnx.TypeProto;if(null!=e.tensorType){if("object"!=typeof e.tensorType)throw TypeError(".onnx.TypeProto.tensorType: object expected");t.tensorType=l.onnx.TypeProto.Tensor.fromObject(e.tensorType)}if(null!=e.sequenceType){if("object"!=typeof e.sequenceType)throw TypeError(".onnx.TypeProto.sequenceType: object expected");t.sequenceType=l.onnx.TypeProto.Sequence.fromObject(e.sequenceType)}if(null!=e.mapType){if("object"!=typeof e.mapType)throw TypeError(".onnx.TypeProto.mapType: object expected");t.mapType=l.onnx.TypeProto.Map.fromObject(e.mapType)}if(null!=e.optionalType){if("object"!=typeof e.optionalType)throw TypeError(".onnx.TypeProto.optionalType: object expected");t.optionalType=l.onnx.TypeProto.Optional.fromObject(e.optionalType)}if(null!=e.sparseTensorType){if("object"!=typeof e.sparseTensorType)throw TypeError(".onnx.TypeProto.sparseTensorType: object expected");t.sparseTensorType=l.onnx.TypeProto.SparseTensor.fromObject(e.sparseTensorType)}return null!=e.denotation&&(t.denotation=String(e.denotation)),t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.denotation=""),null!=e.tensorType&&e.hasOwnProperty("tensorType")&&(r.tensorType=l.onnx.TypeProto.Tensor.toObject(e.tensorType,t),t.oneofs&&(r.value="tensorType")),null!=e.sequenceType&&e.hasOwnProperty("sequenceType")&&(r.sequenceType=l.onnx.TypeProto.Sequence.toObject(e.sequenceType,t),t.oneofs&&(r.value="sequenceType")),null!=e.mapType&&e.hasOwnProperty("mapType")&&(r.mapType=l.onnx.TypeProto.Map.toObject(e.mapType,t),t.oneofs&&(r.value="mapType")),null!=e.denotation&&e.hasOwnProperty("denotation")&&(r.denotation=e.denotation),null!=e.sparseTensorType&&e.hasOwnProperty("sparseTensorType")&&(r.sparseTensorType=l.onnx.TypeProto.SparseTensor.toObject(e.sparseTensorType,t),t.oneofs&&(r.value="sparseTensorType")),null!=e.optionalType&&e.hasOwnProperty("optionalType")&&(r.optionalType=l.onnx.TypeProto.Optional.toObject(e.optionalType,t),t.oneofs&&(r.value="optionalType")),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,o.util.toJSONOptions)},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/onnx.TypeProto"},e.Tensor=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.elemType=0,e.prototype.shape=null,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=s.create()),null!=e.elemType&&Object.hasOwnProperty.call(e,"elemType")&&t.uint32(8).int32(e.elemType),null!=e.shape&&Object.hasOwnProperty.call(e,"shape")&&l.onnx.TensorShapeProto.encode(e.shape,t.uint32(18).fork()).ldelim(),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof a||(e=a.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new l.onnx.TypeProto.Tensor;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.elemType=e.int32();break;case 2:n.shape=l.onnx.TensorShapeProto.decode(e,e.uint32());break;default:e.skipType(7&i)}}return n},e.decodeDelimited=function(e){return e instanceof a||(e=new a(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.elemType&&e.hasOwnProperty("elemType")&&!u.isInteger(e.elemType))return"elemType: integer expected";if(null!=e.shape&&e.hasOwnProperty("shape")){var t=l.onnx.TensorShapeProto.verify(e.shape);if(t)return"shape."+t}return null},e.fromObject=function(e){if(e instanceof l.onnx.TypeProto.Tensor)return e;var t=new l.onnx.TypeProto.Tensor;if(null!=e.elemType&&(t.elemType=0|e.elemType),null!=e.shape){if("object"!=typeof e.shape)throw TypeError(".onnx.TypeProto.Tensor.shape: object expected");t.shape=l.onnx.TensorShapeProto.fromObject(e.shape)}return t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.elemType=0,r.shape=null),null!=e.elemType&&e.hasOwnProperty("elemType")&&(r.elemType=e.elemType),null!=e.shape&&e.hasOwnProperty("shape")&&(r.shape=l.onnx.TensorShapeProto.toObject(e.shape,t)),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,o.util.toJSONOptions)},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/onnx.TypeProto.Tensor"},e}(),e.Sequence=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.elemType=null,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=s.create()),null!=e.elemType&&Object.hasOwnProperty.call(e,"elemType")&&l.onnx.TypeProto.encode(e.elemType,t.uint32(10).fork()).ldelim(),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof a||(e=a.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new l.onnx.TypeProto.Sequence;e.pos<r;){var i=e.uint32();i>>>3==1?n.elemType=l.onnx.TypeProto.decode(e,e.uint32()):e.skipType(7&i)}return n},e.decodeDelimited=function(e){return e instanceof a||(e=new a(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.elemType&&e.hasOwnProperty("elemType")){var t=l.onnx.TypeProto.verify(e.elemType);if(t)return"elemType."+t}return null},e.fromObject=function(e){if(e instanceof l.onnx.TypeProto.Sequence)return e;var t=new l.onnx.TypeProto.Sequence;if(null!=e.elemType){if("object"!=typeof e.elemType)throw TypeError(".onnx.TypeProto.Sequence.elemType: object expected");t.elemType=l.onnx.TypeProto.fromObject(e.elemType)}return t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.elemType=null),null!=e.elemType&&e.hasOwnProperty("elemType")&&(r.elemType=l.onnx.TypeProto.toObject(e.elemType,t)),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,o.util.toJSONOptions)},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/onnx.TypeProto.Sequence"},e}(),e.Map=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.keyType=0,e.prototype.valueType=null,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=s.create()),null!=e.keyType&&Object.hasOwnProperty.call(e,"keyType")&&t.uint32(8).int32(e.keyType),null!=e.valueType&&Object.hasOwnProperty.call(e,"valueType")&&l.onnx.TypeProto.encode(e.valueType,t.uint32(18).fork()).ldelim(),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof a||(e=a.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new l.onnx.TypeProto.Map;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.keyType=e.int32();break;case 2:n.valueType=l.onnx.TypeProto.decode(e,e.uint32());break;default:e.skipType(7&i)}}return n},e.decodeDelimited=function(e){return e instanceof a||(e=new a(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.keyType&&e.hasOwnProperty("keyType")&&!u.isInteger(e.keyType))return"keyType: integer expected";if(null!=e.valueType&&e.hasOwnProperty("valueType")){var t=l.onnx.TypeProto.verify(e.valueType);if(t)return"valueType."+t}return null},e.fromObject=function(e){if(e instanceof l.onnx.TypeProto.Map)return e;var t=new l.onnx.TypeProto.Map;if(null!=e.keyType&&(t.keyType=0|e.keyType),null!=e.valueType){if("object"!=typeof e.valueType)throw TypeError(".onnx.TypeProto.Map.valueType: object expected");t.valueType=l.onnx.TypeProto.fromObject(e.valueType)}return t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.keyType=0,r.valueType=null),null!=e.keyType&&e.hasOwnProperty("keyType")&&(r.keyType=e.keyType),null!=e.valueType&&e.hasOwnProperty("valueType")&&(r.valueType=l.onnx.TypeProto.toObject(e.valueType,t)),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,o.util.toJSONOptions)},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/onnx.TypeProto.Map"},e}(),e.Optional=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.elemType=null,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=s.create()),null!=e.elemType&&Object.hasOwnProperty.call(e,"elemType")&&l.onnx.TypeProto.encode(e.elemType,t.uint32(10).fork()).ldelim(),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof a||(e=a.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new l.onnx.TypeProto.Optional;e.pos<r;){var i=e.uint32();i>>>3==1?n.elemType=l.onnx.TypeProto.decode(e,e.uint32()):e.skipType(7&i)}return n},e.decodeDelimited=function(e){return e instanceof a||(e=new a(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.elemType&&e.hasOwnProperty("elemType")){var t=l.onnx.TypeProto.verify(e.elemType);if(t)return"elemType."+t}return null},e.fromObject=function(e){if(e instanceof l.onnx.TypeProto.Optional)return e;var t=new l.onnx.TypeProto.Optional;if(null!=e.elemType){if("object"!=typeof e.elemType)throw TypeError(".onnx.TypeProto.Optional.elemType: object expected");t.elemType=l.onnx.TypeProto.fromObject(e.elemType)}return t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.elemType=null),null!=e.elemType&&e.hasOwnProperty("elemType")&&(r.elemType=l.onnx.TypeProto.toObject(e.elemType,t)),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,o.util.toJSONOptions)},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/onnx.TypeProto.Optional"},e}(),e.SparseTensor=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.elemType=0,e.prototype.shape=null,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=s.create()),null!=e.elemType&&Object.hasOwnProperty.call(e,"elemType")&&t.uint32(8).int32(e.elemType),null!=e.shape&&Object.hasOwnProperty.call(e,"shape")&&l.onnx.TensorShapeProto.encode(e.shape,t.uint32(18).fork()).ldelim(),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof a||(e=a.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new l.onnx.TypeProto.SparseTensor;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.elemType=e.int32();break;case 2:n.shape=l.onnx.TensorShapeProto.decode(e,e.uint32());break;default:e.skipType(7&i)}}return n},e.decodeDelimited=function(e){return e instanceof a||(e=new a(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.elemType&&e.hasOwnProperty("elemType")&&!u.isInteger(e.elemType))return"elemType: integer expected";if(null!=e.shape&&e.hasOwnProperty("shape")){var t=l.onnx.TensorShapeProto.verify(e.shape);if(t)return"shape."+t}return null},e.fromObject=function(e){if(e instanceof l.onnx.TypeProto.SparseTensor)return e;var t=new l.onnx.TypeProto.SparseTensor;if(null!=e.elemType&&(t.elemType=0|e.elemType),null!=e.shape){if("object"!=typeof e.shape)throw TypeError(".onnx.TypeProto.SparseTensor.shape: object expected");t.shape=l.onnx.TensorShapeProto.fromObject(e.shape)}return t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.elemType=0,r.shape=null),null!=e.elemType&&e.hasOwnProperty("elemType")&&(r.elemType=e.elemType),null!=e.shape&&e.hasOwnProperty("shape")&&(r.shape=l.onnx.TensorShapeProto.toObject(e.shape,t)),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,o.util.toJSONOptions)},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/onnx.TypeProto.SparseTensor"},e}(),e}(),i.OperatorSetIdProto=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.domain="",e.prototype.version=u.Long?u.Long.fromBits(0,0,!1):0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=s.create()),null!=e.domain&&Object.hasOwnProperty.call(e,"domain")&&t.uint32(10).string(e.domain),null!=e.version&&Object.hasOwnProperty.call(e,"version")&&t.uint32(16).int64(e.version),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof a||(e=a.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new l.onnx.OperatorSetIdProto;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.domain=e.string();break;case 2:n.version=e.int64();break;default:e.skipType(7&i)}}return n},e.decodeDelimited=function(e){return e instanceof a||(e=new a(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.domain&&e.hasOwnProperty("domain")&&!u.isString(e.domain)?"domain: string expected":null==e.version||!e.hasOwnProperty("version")||u.isInteger(e.version)||e.version&&u.isInteger(e.version.low)&&u.isInteger(e.version.high)?null:"version: integer|Long expected"},e.fromObject=function(e){if(e instanceof l.onnx.OperatorSetIdProto)return e;var t=new l.onnx.OperatorSetIdProto;return null!=e.domain&&(t.domain=String(e.domain)),null!=e.version&&(u.Long?(t.version=u.Long.fromValue(e.version)).unsigned=!1:"string"==typeof e.version?t.version=parseInt(e.version,10):"number"==typeof e.version?t.version=e.version:"object"==typeof e.version&&(t.version=new u.LongBits(e.version.low>>>0,e.version.high>>>0).toNumber())),t},e.toObject=function(e,t){t||(t={});var r={};if(t.defaults)if(r.domain="",u.Long){var n=new u.Long(0,0,!1);r.version=t.longs===String?n.toString():t.longs===Number?n.toNumber():n}else r.version=t.longs===String?"0":0;return null!=e.domain&&e.hasOwnProperty("domain")&&(r.domain=e.domain),null!=e.version&&e.hasOwnProperty("version")&&("number"==typeof e.version?r.version=t.longs===String?String(e.version):e.version:r.version=t.longs===String?u.Long.prototype.toString.call(e.version):t.longs===Number?new u.LongBits(e.version.low>>>0,e.version.high>>>0).toNumber():e.version),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,o.util.toJSONOptions)},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/onnx.OperatorSetIdProto"},e}(),i.OperatorStatus=function(){var e={},t=Object.create(e);return t[e[0]="EXPERIMENTAL"]=0,t[e[1]="STABLE"]=1,t}(),i.FunctionProto=function(){function e(e){if(this.input=[],this.output=[],this.attribute=[],this.attributeProto=[],this.node=[],this.opsetImport=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.name="",e.prototype.input=u.emptyArray,e.prototype.output=u.emptyArray,e.prototype.attribute=u.emptyArray,e.prototype.attributeProto=u.emptyArray,e.prototype.node=u.emptyArray,e.prototype.docString="",e.prototype.opsetImport=u.emptyArray,e.prototype.domain="",e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=s.create()),null!=e.name&&Object.hasOwnProperty.call(e,"name")&&t.uint32(10).string(e.name),null!=e.input&&e.input.length)for(var r=0;r<e.input.length;++r)t.uint32(34).string(e.input[r]);if(null!=e.output&&e.output.length)for(r=0;r<e.output.length;++r)t.uint32(42).string(e.output[r]);if(null!=e.attribute&&e.attribute.length)for(r=0;r<e.attribute.length;++r)t.uint32(50).string(e.attribute[r]);if(null!=e.node&&e.node.length)for(r=0;r<e.node.length;++r)l.onnx.NodeProto.encode(e.node[r],t.uint32(58).fork()).ldelim();if(null!=e.docString&&Object.hasOwnProperty.call(e,"docString")&&t.uint32(66).string(e.docString),null!=e.opsetImport&&e.opsetImport.length)for(r=0;r<e.opsetImport.length;++r)l.onnx.OperatorSetIdProto.encode(e.opsetImport[r],t.uint32(74).fork()).ldelim();if(null!=e.domain&&Object.hasOwnProperty.call(e,"domain")&&t.uint32(82).string(e.domain),null!=e.attributeProto&&e.attributeProto.length)for(r=0;r<e.attributeProto.length;++r)l.onnx.AttributeProto.encode(e.attributeProto[r],t.uint32(90).fork()).ldelim();return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof a||(e=a.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new l.onnx.FunctionProto;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.name=e.string();break;case 4:n.input&&n.input.length||(n.input=[]),n.input.push(e.string());break;case 5:n.output&&n.output.length||(n.output=[]),n.output.push(e.string());break;case 6:n.attribute&&n.attribute.length||(n.attribute=[]),n.attribute.push(e.string());break;case 11:n.attributeProto&&n.attributeProto.length||(n.attributeProto=[]),n.attributeProto.push(l.onnx.AttributeProto.decode(e,e.uint32()));break;case 7:n.node&&n.node.length||(n.node=[]),n.node.push(l.onnx.NodeProto.decode(e,e.uint32()));break;case 8:n.docString=e.string();break;case 9:n.opsetImport&&n.opsetImport.length||(n.opsetImport=[]),n.opsetImport.push(l.onnx.OperatorSetIdProto.decode(e,e.uint32()));break;case 10:n.domain=e.string();break;default:e.skipType(7&i)}}return n},e.decodeDelimited=function(e){return e instanceof a||(e=new a(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.name&&e.hasOwnProperty("name")&&!u.isString(e.name))return"name: string expected";if(null!=e.input&&e.hasOwnProperty("input")){if(!Array.isArray(e.input))return"input: array expected";for(var t=0;t<e.input.length;++t)if(!u.isString(e.input[t]))return"input: string[] expected"}if(null!=e.output&&e.hasOwnProperty("output")){if(!Array.isArray(e.output))return"output: array expected";for(t=0;t<e.output.length;++t)if(!u.isString(e.output[t]))return"output: string[] expected"}if(null!=e.attribute&&e.hasOwnProperty("attribute")){if(!Array.isArray(e.attribute))return"attribute: array expected";for(t=0;t<e.attribute.length;++t)if(!u.isString(e.attribute[t]))return"attribute: string[] expected"}if(null!=e.attributeProto&&e.hasOwnProperty("attributeProto")){if(!Array.isArray(e.attributeProto))return"attributeProto: array expected";for(t=0;t<e.attributeProto.length;++t)if(r=l.onnx.AttributeProto.verify(e.attributeProto[t]))return"attributeProto."+r}if(null!=e.node&&e.hasOwnProperty("node")){if(!Array.isArray(e.node))return"node: array expected";for(t=0;t<e.node.length;++t)if(r=l.onnx.NodeProto.verify(e.node[t]))return"node."+r}if(null!=e.docString&&e.hasOwnProperty("docString")&&!u.isString(e.docString))return"docString: string expected";if(null!=e.opsetImport&&e.hasOwnProperty("opsetImport")){if(!Array.isArray(e.opsetImport))return"opsetImport: array expected";for(t=0;t<e.opsetImport.length;++t){var r;if(r=l.onnx.OperatorSetIdProto.verify(e.opsetImport[t]))return"opsetImport."+r}}return null!=e.domain&&e.hasOwnProperty("domain")&&!u.isString(e.domain)?"domain: string expected":null},e.fromObject=function(e){if(e instanceof l.onnx.FunctionProto)return e;var t=new l.onnx.FunctionProto;if(null!=e.name&&(t.name=String(e.name)),e.input){if(!Array.isArray(e.input))throw TypeError(".onnx.FunctionProto.input: array expected");t.input=[];for(var r=0;r<e.input.length;++r)t.input[r]=String(e.input[r])}if(e.output){if(!Array.isArray(e.output))throw TypeError(".onnx.FunctionProto.output: array expected");for(t.output=[],r=0;r<e.output.length;++r)t.output[r]=String(e.output[r])}if(e.attribute){if(!Array.isArray(e.attribute))throw TypeError(".onnx.FunctionProto.attribute: array expected");for(t.attribute=[],r=0;r<e.attribute.length;++r)t.attribute[r]=String(e.attribute[r])}if(e.attributeProto){if(!Array.isArray(e.attributeProto))throw TypeError(".onnx.FunctionProto.attributeProto: array expected");for(t.attributeProto=[],r=0;r<e.attributeProto.length;++r){if("object"!=typeof e.attributeProto[r])throw TypeError(".onnx.FunctionProto.attributeProto: object expected");t.attributeProto[r]=l.onnx.AttributeProto.fromObject(e.attributeProto[r])}}if(e.node){if(!Array.isArray(e.node))throw TypeError(".onnx.FunctionProto.node: array expected");for(t.node=[],r=0;r<e.node.length;++r){if("object"!=typeof e.node[r])throw TypeError(".onnx.FunctionProto.node: object expected");t.node[r]=l.onnx.NodeProto.fromObject(e.node[r])}}if(null!=e.docString&&(t.docString=String(e.docString)),e.opsetImport){if(!Array.isArray(e.opsetImport))throw TypeError(".onnx.FunctionProto.opsetImport: array expected");for(t.opsetImport=[],r=0;r<e.opsetImport.length;++r){if("object"!=typeof e.opsetImport[r])throw TypeError(".onnx.FunctionProto.opsetImport: object expected");t.opsetImport[r]=l.onnx.OperatorSetIdProto.fromObject(e.opsetImport[r])}}return null!=e.domain&&(t.domain=String(e.domain)),t},e.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.input=[],r.output=[],r.attribute=[],r.node=[],r.opsetImport=[],r.attributeProto=[]),t.defaults&&(r.name="",r.docString="",r.domain=""),null!=e.name&&e.hasOwnProperty("name")&&(r.name=e.name),e.input&&e.input.length){r.input=[];for(var n=0;n<e.input.length;++n)r.input[n]=e.input[n]}if(e.output&&e.output.length)for(r.output=[],n=0;n<e.output.length;++n)r.output[n]=e.output[n];if(e.attribute&&e.attribute.length)for(r.attribute=[],n=0;n<e.attribute.length;++n)r.attribute[n]=e.attribute[n];if(e.node&&e.node.length)for(r.node=[],n=0;n<e.node.length;++n)r.node[n]=l.onnx.NodeProto.toObject(e.node[n],t);if(null!=e.docString&&e.hasOwnProperty("docString")&&(r.docString=e.docString),e.opsetImport&&e.opsetImport.length)for(r.opsetImport=[],n=0;n<e.opsetImport.length;++n)r.opsetImport[n]=l.onnx.OperatorSetIdProto.toObject(e.opsetImport[n],t);if(null!=e.domain&&e.hasOwnProperty("domain")&&(r.domain=e.domain),e.attributeProto&&e.attributeProto.length)for(r.attributeProto=[],n=0;n<e.attributeProto.length;++n)r.attributeProto[n]=l.onnx.AttributeProto.toObject(e.attributeProto[n],t);return r},e.prototype.toJSON=function(){return this.constructor.toObject(this,o.util.toJSONOptions)},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/onnx.FunctionProto"},e}(),i),t.exports=l}));function zr(e,t){if(!e)throw new Error("string"==typeof t?t:t())}function hn(e){return(new TextDecoder).decode(e)}var we,wr,xi,Xe,ro,Ve,ot,z,dn,vr,_r,Or,fe=D((()=>{Jn(),ai(),we=Nr(Ur()),Sr(),wr=class{static arraysEqual(e,t){if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}},xi=class{static preprocessInputShapes(e,t){return[1===e.length?[1,e[0]]:e,1===t.length?[t[0],1]:t]}static postprocessOutputShape(e,t,r){1===t&&e.splice(e.length-2,1),1===r&&e.pop()}static calcMatMulShape(e,t){return e[1]!==t[0]?void 0:[e[0],t[1]]}},Xe=class e{static calcShape(e,t,r=!1){let n=e.length,i=t.length;if(0===n)return t;if(0===i)return e;let o=Math.max(e.length,t.length),a=new Array(o);if(r){if(n<2||i<2)return;let r=xi.calcMatMulShape([e[n-2],e[n-1]],[t[i-2],t[i-1]]);if(void 0===r)return;[a[o-2],a[o-1]]=r}for(let s=r?3:1;s<=o;s++){let r=n-s<0?1:e[n-s],u=i-s<0?1:t[i-s];if(r!==u&&r>1&&u>1)return;a[o-s]=Math.max(r,u)}return a}static index(t,r){let n=new Array(r.length);return e.fillIndex(t,r,n),n}static fillIndex(e,t,r){let n=e.length-t.length;for(let i=0;i<t.length;i++)r[i]=e[n+i]%t[i]}static calc(t,r,n,i,o){let a=e.calcShape(t.dims,r.dims);if(a){if(i&&!z.areEqual(a,t.dims))return;let s=z.size(a),u=i?t:new Be(a,o||t.type);if(0===a.length)u.set([],n(t.get([]),r.get([])));else{let i,o=new Array(a.length),l=new Array(t.dims.length),h=new Array(r.dims.length),c=0,f=0,d=!1,p=!1;0===t.dims.length&&(c=t.get([]),d=!0),0===r.dims.length&&(f=r.get([]),p=!0);for(let y=0;y<s;y++){i=y;for(let e=a.length-1;e>=0;e--)o[e]=i%a[e],i=Math.floor(i/a[e]);d||(e.fillIndex(o,t.dims,l),c=t.get(l)),p||(e.fillIndex(o,r.dims,h),f=r.get(h)),u.set(o,n(c,f))}}return u}}static isValidBroadcast(e,t){let r=e.length,n=t.length;if(r>n)return!1;for(let i=1;i<=r;i++)if(1!==e[r-i]&&e[r-i]!==t[n-i])return!1;return!0}static getBroadcastDims(e,t){let r=e.length,n=[];for(let i=0;i<r;i++){let o=r-1-i,a=e[o]||1;(t[t.length-1-i]||1)>1&&1===a&&n.unshift(o)}return n}},ro=class{static getShapeOfGemmResult(e,t,r,n,i){if(2!==e.length||2!==r.length)throw new Error("shape need to be of size 2");let o,a,s;t?(o=e[1],a=e[0]):(o=e[0],a=e[1]);let u=-1;if(n?(s=r[0],u=1):(s=r[1],u=0),r[u]!==a)throw new Error("dimension mismatch");if(o<=0||s<=0||a<=0)throw new Error("invalid shape specified");if(i&&!Xe.isValidBroadcast(i,[o,s]))throw new Error("gemm: invalid bias shape for broadcast");return[o,s,a]}},Ve=class e{static tensorDataTypeFromProto(e){switch(e){case we.onnx.TensorProto.DataType.INT8:return"int8";case we.onnx.TensorProto.DataType.UINT8:return"uint8";case we.onnx.TensorProto.DataType.BOOL:return"bool";case we.onnx.TensorProto.DataType.INT16:return"int16";case we.onnx.TensorProto.DataType.UINT16:return"uint16";case we.onnx.TensorProto.DataType.INT32:return"int32";case we.onnx.TensorProto.DataType.UINT32:return"uint32";case we.onnx.TensorProto.DataType.FLOAT:return"float32";case we.onnx.TensorProto.DataType.DOUBLE:return"float64";case we.onnx.TensorProto.DataType.STRING:return"string";case we.onnx.TensorProto.DataType.INT64:return"int32";case we.onnx.TensorProto.DataType.UINT64:return"uint32";default:throw new Error(`unsupported data type: ${we.onnx.TensorProto.DataType[e]}`)}}static tensorDataTypeStringToEnum(e){switch(e){case"int8":return we.onnx.TensorProto.DataType.INT8;case"uint8":return we.onnx.TensorProto.DataType.UINT8;case"bool":return we.onnx.TensorProto.DataType.BOOL;case"int16":return we.onnx.TensorProto.DataType.INT16;case"uint16":return we.onnx.TensorProto.DataType.UINT16;case"int32":return we.onnx.TensorProto.DataType.INT32;case"uint32":return we.onnx.TensorProto.DataType.UINT32;case"float32":return we.onnx.TensorProto.DataType.FLOAT;case"float64":return we.onnx.TensorProto.DataType.DOUBLE;case"string":return we.onnx.TensorProto.DataType.STRING;case"int64":return we.onnx.TensorProto.DataType.INT64;case"uint64":return we.onnx.TensorProto.DataType.UINT64;default:throw new Error(`unsupported data type: ${e}`)}}static tensorDimsFromProto(e){return e.map((e=>Yt.isLong(e)?e.toNumber():e))}static tensorValueTypeFromProto(t){return{tensorType:e.tensorDataTypeFromProto(t.elemType),shape:{dims:e.tensorDimsFromProto(t.shape.dim.map((e=>e.dimValue)))}}}static tensorDimsFromORTFormat(e){let t=[];for(let r=0;r<e.dimsLength();r++)t.push(ot.longToNumber(e.dims(r)));return t}static tensorAttributesFromORTFormat(e){let t=[];for(let r=0;r<e.attributesLength();r++)t.push(e.attributes(r));return t}},ot=class{static longToNumber(e,t){return Yt.isLong(e)?e.toNumber():e instanceof S.Long?Yt.fromValue({low:e.low,high:e.high,unsigned:t??!1}).toNumber():e}static isLong(e){return Yt.isLong(e)||e instanceof S.Long}},z=class e{static size(t){return e.getSizeFromDimensionRange(t,0,t.length)}static sizeFromDimension(t,r){if(r<0||r>t.length)throw new Error(`invalid dimension of ${r} for sizeFromDimension as Tensor has ${t.length} dimensions.`);return e.getSizeFromDimensionRange(t,r,t.length)}static sizeToDimension(t,r){if(r<0||r>t.length)throw new Error(`invalid dimension of ${r} for sizeToDimension as Tensor has ${t.length} dimensions.`);return e.getSizeFromDimensionRange(t,0,r)}static getSizeFromDimensionRange(e,t,r){let n=1;for(let i=t;i<r;i++){if(e[i]<=0)throw new Error("cannot get valid size from specified dimension range. Most likely the range contains 0 or negative values in them.");n*=e[i]}return n}static computeStrides(e){let t=e.length;if(0===t)return[];if(1===t)return[1];let r=new Array(t);r[t-1]=1,r[t-2]=e[t-1];for(let n=t-3;n>=0;--n)r[n]=r[n+1]*e[n+1];return r}static transpose(e){return e.slice().reverse()}static indicesToOffset(e,t,r){void 0===r&&(r=e.length);let n=0;for(let i=0;i<r;++i)n+=t[i]*e[i];return n}static offsetToIndices(e,t){let r=t.length;if(0===r)return[];if(1===r)return[e*t[0]];let n=new Array(t.length);for(let r=0;r<n.length-1;++r)n[r]=Math.floor(e/t[r]),e-=n[r]*t[r];return n[n.length-1]=e,n}static normalizeAxis(e,t){if(e<-t&&e>=t)throw new Error("unsupported axis for this operation.");return e<0?e+t:e}static normalizeAxes(e,t){return e.map((e=>this.normalizeAxis(e,t)))}static incrementIndex(e,t,r){if(0===t.length||0===e.length)throw new Error("Index incrementing unsupported for scalar Tensor");if(void 0===r)r=t.length;else if(r<=0||r>t.length)throw new Error("Incorrect axis to increment on");for(let n=r-1;n>=0&&(e[n]++,!(e[n]<t[n]));--n)e[n]=0}static calculateReshapedDims(t,r){if(0===r.length){if(0===t.length||1===e.size(t))return[];throw new Error("cannot reshape to a scalar Tensor")}let n=r.length,i=new Array(n),o=-1,a=1;for(let e=0;e<n;e++){if(r[e]<-1)throw new Error("a dimension in shape hints cannot be less than -1");if(-1===r[e]){if(-1!==o)throw new Error("at most one dimension in shape hints can be -1");o=e}else{if(0===r[e]){if(e>=t.length)throw new Error("the dimension with value zero exceeds the dimension size of the input tensor");i[e]=t[e]}else i[e]=r[e];a*=i[e]}}let s=e.size(t);if(-1!==o){if(s%a!=0)throw new Error(`the input tensor cannot be reshaped to the requested shape. Input shape: [${t}] Output shape: [${r}]`);i[o]=s/a}else if(a!==s)throw new Error("reshapedDims and originalDims don't have matching sizes");return i}static sortBasedOnPerm(e,t){return t?t.map((t=>e[t])):e.slice().reverse()}static padShape(e,t){let r=e.length;return e.map(((e,n)=>e+t[n]+t[n+r]))}static areEqual(e,t){return e.length===t.length&&e.every(((e,r)=>e===t[r]))}static validateDimsAndCalcSize(e){if(e.length>6)throw new TypeError("Only rank 0 to 6 is supported for tensor shape.");let t=1;for(let r of e){if(!Number.isInteger(r))throw new TypeError(`Invalid shape: ${r} is not an integer`);if(r<0||r>2147483647)throw new TypeError(`Invalid shape: length ${r} is not allowed`);t*=r}return t}static flattenShape(e,t){t<0&&(t+=e.length);let r=e.reduce(((e,t)=>e*t),1),n=e.slice(t).reduce(((e,t)=>e*t),1);return[r/n,n]}static squeezeShape(t,r){let n=new Array;r=e.normalizeAxes(r,t.length);for(let e=0;e<t.length;e++){let i=r.indexOf(e)>=0;if(i&&1!==t[e])throw new Error("squeeze an axis of size different than 1");(0===r.length&&t[e]>1||r.length>0&&!i)&&n.push(t[e])}return n}static unsqueezeShape(t,r){let n=new Array(t.length+r.length);n.fill(0);for(let t=0;t<r.length;t++){let i=e.normalizeAxis(r[t],n.length);if(i>=n.length)throw new Error("'axes' has an out of range axis");if(0!==n[i])throw new Error("'axes' has a duplicate axis");n[i]=1}let i=0;for(let e=0;e<n.length;e++)0===n[e]&&(n[e]=t[i++]);if(i!==t.length)throw new Error("the unsqueezed dimension could not be established");return n}},dn=class e{static splitShape(t,r,n,i){if(0===n.length){if(!i)throw new Error("need to know number of outputs when the 'split' attribute is not specified");e.determineSplit(t[r],i,n)}let o=[],a=[0];for(let e=0;e<n.length;++e){0!==e&&a.push(a[e-1]+n[e-1]);let i=t.slice();i[r]=n[e],o.push(i)}return[o,a]}static determineSplit(e,t,r){if(e%t!=0)throw new Error("cannot split tensor to equal sized parts");for(let n=0;n<t;++n)r.push(e/t)}},vr=class e{static adjustPoolAttributes(e,t,r,n,i,o){if(!e&&r.length!==t.length-2)throw new Error("length of specified kernel shapes should be 2 less than length of input dimensions");if(e)for(let e=0;e<t.length-2;e++)e>=r.length?r.push(t[e+2]):r[e]=t[e+2];for(let e=0;e<r.length;e++)if(e<n.length){if(n[e]<0)throw new Error("strides should be greater than or equal to 1")}else n.push(1);for(let e=0;e<r.length;e++)if(e<i.length){if(i[e]<0)throw new Error("dilations should be greater than or equal to 1")}else i.push(1);for(let e=0;e<2*r.length;e++)if(e<o.length){if(o[e]<0)throw new Error("pad should be greater than or equal to 1")}else o.push(0);for(let e=0;e<r.length;e++){if(r[e]<=0)throw new Error("kernel shapes need to be greater than 0");if(o[e]>=r[e]||o[e+r.length]>=r[e])throw new Error("pads should be smaller than kernel")}}static adjustPadsBasedOnAutoPad(t,r,n,i,o,a){if(a){if(o.length!==2*(t.length-2))throw new Error("length of pads should be twice the length of data dimensions");if(r.length!==t.length-2)throw new Error("length of strides should be the length of data dimensions");if(i.length!==t.length-2)throw new Error("length of kernel shapes should be the length of data dimensions");for(let s=0;s<t.length-2;s++)e.adjustPadAndReturnShape(t[s+2],r[s],n[s],i[s],o,s,s+t.length-2,a)}}static computePoolOutputShape(t,r,n,i,o,a,s){if(r.length<=0)throw new Error("input shape must be of size greater than 0");let u=[r[0],r[1]];return e.computeShapeHelper(t,r,u,n,i,o,a,s),u}static computeConvOutputShape(t,r,n,i,o,a,s){if(t.length<=0||r.length<=0)throw new Error("invalid input tensor dims or invalid filter tensor dims");let u=[t[0],r[0]];return e.computeShapeHelper(!1,t,u,n,i,o,a,s),u}static computeShapeHelper(t,r,n,i,o,a,s,u){if(t)for(let e=0;e<r.length-2;e++)n.push(1);else for(let t=0;t<r.length-2;t++)n.push(e.adjustPadAndReturnShape(r[t+2],i[t],o[t],a[t],s,t,t+r.length-2,u))}static adjustPadAndReturnShape(e,t,r,n,i,o,a,s){let u=r*(n-1)+1;if(!s||"NOTSET"===s)return Math.floor((e+i[o]+i[a]-u)/t+1);switch(s){case"VALID":return i[o]=0,i[a]=0,Math.floor((e-u)/t+1);case"SAME_LOWER":case"SAME_UPPER":if(1!==r)throw new Error("Dilation not supported for SAME_UPPER or SAME_LOWER");{let r=((e+t-1)/t-1)*t+n-e;return i[o]=Math.floor("SAME_LOWER"===s?(r+1)/2:r/2),i[a]=r-i[o],Math.floor((e+r-n)/t+1)}default:throw new Error("Unsupported AutoPad type")}}},_r=-34028234663852886e22,Or=34028234663852886e22}));function rh(e){switch(e){case"bool":case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;case"float64":return 8;default:throw new Error(`cannot calculate sizeof() on type ${e}`)}}function Gu(e){switch(e){case ne.onnx.TensorProto.DataType.UINT8:case ne.onnx.TensorProto.DataType.INT8:case ne.onnx.TensorProto.DataType.BOOL:return 1;case ne.onnx.TensorProto.DataType.UINT16:case ne.onnx.TensorProto.DataType.INT16:return 2;case ne.onnx.TensorProto.DataType.FLOAT:case ne.onnx.TensorProto.DataType.INT32:case ne.onnx.TensorProto.DataType.UINT32:return 4;case ne.onnx.TensorProto.DataType.INT64:case ne.onnx.TensorProto.DataType.DOUBLE:case ne.onnx.TensorProto.DataType.UINT64:return 8;default:throw new Error(`cannot calculate sizeof() on type ${ne.onnx.TensorProto.DataType[e]}`)}}function nh(e,t){return new(Wu(t))(e)}function Wu(e){switch(e){case"bool":case"uint8":return Uint8Array;case"int8":return Int8Array;case"int16":return Int16Array;case"uint16":return Uint16Array;case"int32":return Int32Array;case"uint32":return Uint32Array;case"int64":return BigInt64Array;case"float32":return Float32Array;case"float64":return Float64Array;default:throw new Error("unspecified error")}}function vi(e,t){if(t===ne.onnx.TensorProto.DataType.INT64||t===wi.TensorDataType.INT64){if(e.greaterThanOrEqual(2147483648)||e.lessThan(-2147483648))throw new TypeError("int64 is not supported")}else{if(t!==ne.onnx.TensorProto.DataType.UINT32&&t!==wi.TensorDataType.UINT32&&t!==ne.onnx.TensorProto.DataType.UINT64&&t!==wi.TensorDataType.UINT64)throw new TypeError(`not a LONG type: ${ne.onnx.TensorProto.DataType[t]}`);if(e.greaterThanOrEqual(4294967296)||e.lessThan(0))throw new TypeError("uint64 is not supported")}return e.toNumber()}function Uu(e,t,r){switch(t){case ne.onnx.TensorProto.DataType.BOOL:case ne.onnx.TensorProto.DataType.UINT8:return e.getUint8(r);case ne.onnx.TensorProto.DataType.INT8:return e.getInt8(r);case ne.onnx.TensorProto.DataType.UINT16:return e.getUint16(r,!0);case ne.onnx.TensorProto.DataType.INT16:return e.getInt16(r,!0);case ne.onnx.TensorProto.DataType.FLOAT:return e.getFloat32(r,!0);case ne.onnx.TensorProto.DataType.INT32:return e.getInt32(r,!0);case ne.onnx.TensorProto.DataType.UINT32:return e.getUint32(r,!0);case ne.onnx.TensorProto.DataType.INT64:return vi(Yt.fromBits(e.getUint32(r,!0),e.getUint32(r+4,!0),!1),t);case ne.onnx.TensorProto.DataType.DOUBLE:return e.getFloat64(r,!0);case ne.onnx.TensorProto.DataType.UINT64:return vi(Yt.fromBits(e.getUint32(r,!0),e.getUint32(r+4,!0),!0),t);default:throw new Error(`cannot read from DataView for type ${ne.onnx.TensorProto.DataType[t]}`)}}var zu,ne,wi,Be,Sr=D((()=>{zu=Nr(Ls()),ai(),ln(),ne=Nr(Ur()),fe(),wi=H.experimental.fbs,Be=class e{constructor(e,t,r,n,i,o=zu.Guid.create()){this.dims=e,this.type=t,this.dataProvider=r,this.asyncDataProvider=n,this.cache=i,this.dataId=o,this.size=z.validateDimsAndCalcSize(e);let a=this.size,s=void 0===r&&void 0===n&&void 0===i;if(void 0!==i&&i.length!==a)throw new RangeError("Input dims doesn't match data length.");if("string"===t){if(!(void 0===i||Array.isArray(i)&&i.every((e=>"string"==typeof e))))throw new TypeError("cache should be a string array");s&&(this.cache=new Array(a))}else{if(void 0!==i){let e=Wu(t);if(!(i instanceof e))throw new TypeError(`cache should be type ${e.name}`)}if(s){let e=new ArrayBuffer(a*rh(t));this.cache=nh(e,t)}}}get data(){if(void 0===this.cache){let e=this.dataProvider(this.dataId);if(e.length!==this.size)throw new Error("Length of data provided by the Data Provider is inconsistent with the dims of this Tensor.");this.cache=e}return this.cache}get stringData(){if("string"!==this.type)throw new TypeError("data type is not string");return this.data}get integerData(){switch(this.type){case"uint8":case"int8":case"uint16":case"int16":case"int32":case"uint32":case"bool":return this.data;default:throw new TypeError("data type is not integer (uint8, int8, uint16, int16, int32, uint32, bool)")}}get floatData(){switch(this.type){case"float32":case"float64":return this.data;default:throw new TypeError("data type is not float (float32, float64)")}}get numberData(){if("string"!==this.type)return this.data;throw new TypeError("type cannot be non-number (string)")}get(e){return this.data[z.indicesToOffset(e,this.strides)]}set(e,t){this.data[z.indicesToOffset(e,this.strides)]=t}async getData(){return void 0===this.cache&&(this.cache=await this.asyncDataProvider(this.dataId)),this.cache}get strides(){return this._strides||(this._strides=z.computeStrides(this.dims)),this._strides}static fromProto(t){if(!t)throw new Error("cannot construct Value from an empty tensor");let r=Ve.tensorDataTypeFromProto(t.dataType),n=Ve.tensorDimsFromProto(t.dims),i=new e(n,r);if("string"===r)t.stringData.forEach(((e,t)=>{i.data[t]=hn(e)}));else if(t.rawData&&"number"==typeof t.rawData.byteLength&&t.rawData.byteLength>0){let e=i.data,r=new DataView(t.rawData.buffer,t.rawData.byteOffset,t.rawData.byteLength),n=Gu(t.dataType),o=t.rawData.byteLength/n;if(t.rawData.byteLength%n!=0)throw new Error("invalid buffer length");if(e.length!==o)throw new Error("buffer length mismatch");for(let i=0;i<o;i++){let o=Uu(r,t.dataType,i*n);e[i]=o}}else{let e;switch(t.dataType){case ne.onnx.TensorProto.DataType.FLOAT:e=t.floatData;break;case ne.onnx.TensorProto.DataType.INT32:case ne.onnx.TensorProto.DataType.INT16:case ne.onnx.TensorProto.DataType.UINT16:case ne.onnx.TensorProto.DataType.INT8:case ne.onnx.TensorProto.DataType.UINT8:case ne.onnx.TensorProto.DataType.BOOL:e=t.int32Data;break;case ne.onnx.TensorProto.DataType.INT64:e=t.int64Data;break;case ne.onnx.TensorProto.DataType.DOUBLE:e=t.doubleData;break;case ne.onnx.TensorProto.DataType.UINT32:case ne.onnx.TensorProto.DataType.UINT64:e=t.uint64Data;break;default:throw new Error("unspecific error")}if(null==e)throw new Error("failed to populate data from a tensorproto value");let r=i.data;if(r.length!==e.length)throw new Error("array length mismatch");for(let n=0;n<e.length;n++){let i=e[n];Yt.isLong(i)?r[n]=vi(i,t.dataType):r[n]=i}}return i}static fromData(t,r,n){return new e(r,n,void 0,void 0,t)}static fromOrtTensor(t){if(!t)throw new Error("cannot construct Value from an empty tensor");let r=Ve.tensorDimsFromORTFormat(t),n=Ve.tensorDataTypeFromProto(t.dataType()),i=new e(r,n);if("string"===n)for(let e=0;e<t.stringDataLength();e++)i.data[e]=t.stringData(e);else if(t.rawDataArray()&&"number"==typeof t.rawDataLength()&&t.rawDataLength()>0){let e=i.data,r=new DataView(t.rawDataArray().buffer,t.rawDataArray().byteOffset,t.rawDataLength()),n=Gu(t.dataType()),o=t.rawDataLength()/n;if(t.rawDataLength()%n!=0)throw new Error("invalid buffer length");if(e.length!==o)throw new Error("buffer length mismatch");for(let i=0;i<o;i++){let o=Uu(r,t.dataType(),i*n);e[i]=o}}return i}}}));function Y(e){return 1===e?oh:ih}function Vu(e){let t=Y(e);return`${t.version}\n      precision highp float;\n      ${t.attribute} vec3 position;\n      ${t.attribute} vec2 textureCoord;\n\n      ${t.varyingVertex} vec2 TexCoords;\n\n      void main()\n      {\n          gl_Position = vec4(position, 1.0);\n          TexCoords = textureCoord;\n      }`}function Hu(e){let t=Y(e);return`${t.version}\n    precision highp float;\n    precision highp int;\n    precision highp sampler2D;\n    ${t.varyingFrag} vec2 TexCoords;\n    ${t.outputDeclaration}\n    const vec2 halfCR = vec2(0.5, 0.5);\n\n    // Custom vector types to handle higher dimenalities.\n    struct ivec5\n    {\n      int x;\n      int y;\n      int z;\n      int w;\n      int u;\n    };\n\n    struct ivec6\n    {\n      int x;\n      int y;\n      int z;\n      int w;\n      int u;\n      int v;\n    };\n\n    int imod(int x, int y) {\n      return x - y * (x / y);\n    }\n\n    `}function ju(e,t){return`\n  void main() {\n    int indices[${t}];\n    toVec(TexCoords, indices);\n    vec4 result = vec4(process(indices));\n    ${Y(e).output} = result;\n  }\n  `}var oh,ih,ve=D((()=>{oh={version:"",attribute:"attribute",varyingVertex:"varying",varyingFrag:"varying",texture2D:"texture2D",output:"gl_FragColor",outputDeclaration:""},ih={version:"#version 300 es",attribute:"in",varyingVertex:"out",varyingFrag:"in",texture2D:"texture",output:"outputColor",outputDeclaration:"out vec4 outputColor;"}})),ae=D((()=>{}));async function _i(e,t=e=>0,r){return new Promise(((n,i)=>{let o=0,a=()=>{if(e())return void n();o++;let s=t(o);null!=r&&o>=r?i():setTimeout(a,s)};a()}))}function no(e){return zr(typeof e<"u"&&0!==e.length,(()=>"empty string found for sampler name")),"get"+e.charAt(0).toUpperCase()+e.slice(1)}function qu(e){return zr(typeof e<"u"&&0!==e.length,(()=>"empty string found for sampler name")),"get"+e.charAt(0).toUpperCase()+e.slice(1)+"AtOutCoords"}function Wr(e,t){let r=JSON.parse(JSON.stringify(e));return r=t,r}function Vr(e,t){return t.map((t=>e[t])).join(", ")}function Ke(e){if(e<=1)return"int";if(2===e)return"ivec2";if(3===e)return"ivec3";if(4===e)return"ivec4";if(5===e)return"ivec5";if(6===e)return"ivec6";throw Error(`GPU for rank ${e} is not yet supported`)}function Et(e=6){return["x","y","z","w","u","v"].slice(0,e)}var Rt=D((()=>{fe()}));function ah(e,t){return Et(t).map((t=>`${e}.${t}`))}function Hr(e,t){return 1===t?[e]:ah(e,t)}function Mt(){return"\n    float getChannel(vec4 frag, int dim) {\n      int modCoord = imod(dim, 2);\n      return modCoord == 0 ? frag.r : frag.g;\n    }\n\n    float getChannel(vec4 frag, vec2 innerDims) {\n      vec2 modCoord = mod(innerDims, 2.);\n      return modCoord.x == 0. ?\n        (modCoord.y == 0. ? frag.r : frag.g) :\n        (modCoord.y == 0. ? frag.b : frag.a);\n    }\n  "}var Ir=D((()=>{Rt()}));function uh(e,t,r){if(0===e)return"false";if(1===e)return`rc > ${t[0]}`;let n="";for(let i=e-2;i<e;i++)n+=`${r[i]} >= ${t[i-e+2]}`,i<e-1&&(n+="||");return n}function lh(e,t){let r=e.length;if(0===r)return"getA(), 0, 0, 0";if(1===r)return`getA(rc),\n            rc + 1 >= ${e[0]} ? 0. : getA(rc + 1),\n            0, 0`;let n="";if(r>2)for(let e=0;e<r-2;++e)n+=`${t[e]},`;return`getA(${n}r, c),\n          rEdge ? 0. : getA(${n}rp1, c),\n          cEdge ? 0. : getA(${n}r, cp1),\n          rEdge || cEdge ? 0. : getA(${n}rp1, cp1)`}function fh(e,t,r,n){return 0===e||1===e?"":`\n    int r = ${t[e-2]};\n    int c = ${t[e-1]};\n    int rp1 = ${t[e-2]} + 1;\n    int cp1 = ${t[e-1]} + 1;\n    bool rEdge = rp1 >= ${n};\n    bool cEdge = cp1 >= ${r};\n    `}var Yu,sh,Xu,Ku=D((()=>{ve(),ae(),Rt(),Ir(),Yu={name:"pack",inputNames:["A"],inputTypes:[1]},sh=(e,t)=>{let r,n=Y(e.session.backend.glContext.version),i=t.dims,o=i.length,a=t.dims.length,s=Ke(a),u=Hr("rc",a),l=fh(a,u,i[i.length-2],i[i.length-1]);r=0===o?[1,1]:1===o?[i[0],1]:[i[a-1],i[a-2]];let h=uh(a,r,u),c=lh(i,u),f=`\n        void main() {\n          ${s} rc = getOutputCoords();\n\n          if(${h}) {\n            ${n.output} = vec4(0);\n          } else {\n            ${l}\n\n            ${n.output} = vec4(${c});\n          }\n        }\n      `;return{...Yu,hasMain:!0,output:{dims:t.dims,type:t.type,textureType:2},shaderSource:f}},Xu=(e,t)=>({...Yu,get:()=>sh(e,t)})}));function Oi(e){if(0===e.length)return[1,1,1];let t=1;for(let r=0;r<e.length-2;++r)t*=e[r];return[t,e.length>1?e[e.length-2]:1,e[e.length-1]]}function Zu(e,t){let r=!1;return r=0===e.length||0===t.length||(e.length<2||t.length<2?e[e.length-1]===t[t.length-1]:e[e.length-1]===t[t.length-1]&&e[e.length-2]===t[t.length-2]),r}function dh(e){let t=z.computeStrides(e),r=["b","r","c"],n="index";return`\n    ivec3 inputCoordsFromReshapedOutCoords(int index) {\n      ${t.map(((e,i)=>`${`int ${r[i]} = ${n} / ${e}`}; ${i===t.length-1?`int ${r[i+1]} = ${n} - ${r[i]} * ${e}`:`index -= ${r[i]} * ${e}`};`)).join("")}\n      return ivec3(b, r, c);\n    }\n  `}function hh(e){let t=z.computeStrides(e);return`\n  int getFlattenedIndex(ivec3 coords) {\n    // reverse y, z order\n    return coords.x * ${t[0]} + coords.z * ${t[1]} + coords.y;\n  }\n`}var ch,ph,Ju,Qu=D((()=>{fe(),ve(),ae(),Ir(),ch=e=>({name:"Reshape (packed)",inputTypes:[2],inputNames:["A"],cacheHint:`${e}`}),ph=(e,t,r,n)=>{let i=t.dims,o=n,a="";for(let e=0;e<4;e++){let t="";switch(e){case 0:t="outputCoords = rc;";break;case 1:t="outputCoords = ivec3(rc.x, rc.y+1, rc.z);";break;case 2:t="outputCoords = ivec3(rc.x, rc.y, rc.z+1);";break;case 3:t="outputCoords = ivec3(rc.x, rc.y+1, rc.z+1);";break;default:throw new Error}a+=`\n        ${t}\n        ${e>0?"if(outputCoords.y < rows && outputCoords.z < cols){":""}\n          int flattenedIndex = getFlattenedIndex(outputCoords);\n\n          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flattenedIndex);\n          vec2 innerDims = vec2(float(inputRC.y),float(inputRC.z));\n\n          result[${e}] = getChannel(getA(inputRC.x, inputRC.y, inputRC.z), innerDims);\n\n        ${e>0?"}":""}\n      `}let s=Y(e.session.backend.glContext.version),u=`\n      ${dh(i)}\n      ${hh(o)}\n      ${Mt()}\n\n      void main() {\n        ivec3 rc = getOutputCoords();\n\n        vec4 result = vec4(0.0);\n\n        ivec3 outputCoords;\n        int rows = ${o[2]};\n        int cols = ${o[1]};\n\n        ${a}\n        ${s.output} = result;\n      }\n    `;return{...r,output:{dims:o,type:t.type,textureType:2},shaderSource:u,hasMain:!0}},Ju=(e,t,r)=>{let n=ch(r);return{...n,get:()=>ph(e,t,n,r)}}})),Si,el=D((()=>{ve(),ae(),Si=(e,t)=>{let r=t.shape,n=Y(e.session.backend.glContext.version),i=`\n    const float FLOAT_MAX = 1.70141184e38;\n    const float FLOAT_MIN = 1.17549435e-38;\n\n    bool isNaN(float val) {\n      return (val < 1.0 || 0.0 < val || val == 0.0) ? false : true;\n    }\n\n    highp vec4 encodeAsUint8(highp float v) {\n      if (isNaN(v)) {\n        return vec4(255, 255, 255, 255);\n      }\n\n      highp float av = abs(v);\n\n      if(av < FLOAT_MIN) {\n        return vec4(0.0, 0.0, 0.0, 0.0);\n      } else if(v > FLOAT_MAX) {\n        return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;\n      } else if(v < -FLOAT_MAX) {\n        return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;\n      }\n\n      highp vec4 c = vec4(0,0,0,0);\n\n      highp float e = floor(log2(av));\n      highp float m = exp2(fract(log2(av))) - 1.0;\n\n      c[2] = floor(128.0 * m);\n      m -= c[2] / 128.0;\n      c[1] = floor(32768.0 * m);\n      m -= c[1] / 32768.0;\n      c[0] = floor(8388608.0 * m);\n\n      highp float ebias = e + 127.0;\n      c[3] = floor(ebias / 2.0);\n      ebias -= c[3] * 2.0;\n      c[2] += floor(ebias) * 128.0;\n\n      c[3] += 128.0 * step(0.0, -v);\n\n      return c / 255.0;\n    }\n\n    void main() {\n      float value = ${n.texture2D}(X,TexCoords).r;\n      ${n.output} = encodeAsUint8(value);\n    }`,o={name:"Uint8Encode",inputTypes:[0],inputNames:["X"],output:{dims:r,type:t.tensor.type,textureType:3},shaderSource:i,hasMain:!0};return e.executeProgram(o,[t.tensor])}}));function bh(e,t){if(1===e)return"rc";let r="";for(let n=0;n<e;n++)r+=t[n],n<e-1&&(r+=",");return r}var tl,mh,rl,nl=D((()=>{ve(),ae(),Rt(),Ir(),tl={name:"unpack",inputNames:["A"],inputTypes:[2]},mh=(e,t)=>{let r=t.dims.length,n=Hr("rc",r),i=n.slice(-2),o=Ke(r),a=Mt(),s=0===t.dims.length?"":bh(r,n),u=r<=1?"rc":`vec2(${i.join(",")})`,l=`\n    ${a}\n    void main() {\n      ${o} rc = getOutputCoords();\n\n       // Sample the texture with the coords to get the rgba channel value.\n       vec4 packedInput = getA(${s});\n\n       ${Y(e.session.backend.glContext.version).output} = vec4(getChannel(packedInput, ${u}), 0, 0, 0);\n     }\n   `;return{...tl,hasMain:!0,output:{dims:t.dims,type:t.type,textureType:0},shaderSource:l}},rl=(e,t)=>({...tl,get:()=>mh(e,t)})})),oo,mn,io,bn=D((()=>{pt(),oo=class{constructor(e,t=1){if(1===t)this.internalFormat=e.R32F,this.format=e.RED,this.textureType=e.FLOAT,this.channelSize=t;else{if(4!==t)throw new Error(`Invalid number of channels: ${t}`);this.internalFormat=e.RGBA32F,this.format=e.RGBA,this.textureType=e.FLOAT,this.channelSize=t}}encode(e,t){let r,n;return e.constructor!==Float32Array&&(pe.warning("Encoder","data was not of type Float32; creating new Float32Array"),n=new Float32Array(e)),t*this.channelSize>e.length?(pe.warning("Encoder","Source data too small. Allocating larger array"),n=e,r=this.allocate(t*this.channelSize),n.forEach(((e,t)=>r[t]=e))):(n=e,r=n),r}allocate(e){return new Float32Array(4*e)}decode(e,t){return 1===this.channelSize?e.filter(((e,t)=>t%4==0)).subarray(0,t):e.subarray(0,t)}},mn=class{constructor(e,t=1,r){if(1!==t&&4!==t)throw new Error(`Invalid number of channels: ${t}`);this.internalFormat=e.RGBA,this.format=e.RGBA,this.channelSize=t,this.textureType=r||e.FLOAT}encode(e,t){let r=e;return 1===this.channelSize&&(pe.verbose("Encoder","Exploding into a larger array"),r=this.allocate(t),e.forEach(((e,t)=>r[4*t]=e))),r}allocate(e){return new Float32Array(4*e)}decode(e,t){return 1===this.channelSize?e.filter(((e,t)=>t%4==0)).subarray(0,t):e.subarray(0,t)}},io=class{constructor(e,t=1){if(this.channelSize=4,1===t)this.internalFormat=e.ALPHA,this.format=e.ALPHA,this.textureType=e.UNSIGNED_BYTE,this.channelSize=t;else{if(4!==t)throw new Error(`Invalid number of channels: ${t}`);this.internalFormat=e.RGBA,this.format=e.RGBA,this.textureType=e.UNSIGNED_BYTE,this.channelSize=t}}encode(e,t){return new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}allocate(e){return new Uint8Array(e*this.channelSize)}decode(e,t){if(e instanceof Uint8Array)return e.subarray(0,t);throw new Error(`Invalid array type: ${e.constructor}`)}}})),gn,ol,Ii,il=D((()=>{fe(),ae(),gn=(e,t,r)=>{let n=0===r||1===r?1:4,i=2===r,o=1===r||2===r,a=4===r?t.length-1:void 0,s=4===r?t.map(((e,r)=>r===t.length-1?4*e:e)):void 0;return Ii(e,t,n,s,{isPacked:i,reverseWH:o,breakAxis:a})},ol=(e,t,r)=>{let n=gn(e,t,r);return[n.width,n.height]},Ii=(e,t,r=1,n,i)=>{let o=!(!i||!i.isPacked),[a,s]=e.computeTextureWH(o&&n||t,i),u=t.length,l=t.slice(0);if(0===u&&(l=[1]),1===r)n=t;else if(o){if(4!==r)throw new Error("a packed texture must be 4-channel");n=t,u>0&&(l[u-1]=Math.ceil(l[u-1]/2)),u>1&&(l[u-2]=Math.ceil(l[u-2]/2))}else if(!n)throw new Error("Unpacked shape is needed when using channels > 1");return{width:a,height:s,channels:r,isPacked:o,shape:l,strides:z.computeStrides(l),unpackedShape:n,reversedWH:i&&i.reverseWH}}})),yh,ao,sl=D((()=>{pt(),Sr(),fe(),Ku(),Qu(),el(),nl(),bn(),il(),ae(),yh=(e,t)=>{let r=t.map((e=>`${e.unpackedShape.join(",")};${e.width}x${e.height}`)).join("_"),n=e.name;return e.cacheHint&&(n+="["+e.cacheHint+"]"),n+=":"+r,n},ao=class{constructor(e){this.session=e,this.packedTextureDataCache=new Map,this.unpackedTextureDataCache=new Map}calculateTextureWidthAndHeight(e,t){return ol(this.session.layoutStrategy,e,t)}executeProgram(e,t){if(t.length<e.inputNames.length)throw new Error(`Input size mustn't be less than ${e.inputNames.length}.`);if(e.inputNames.length!==e.inputTypes.length)throw new Error("input names size does not match input types");let r=[];for(let n=0;n<e.inputNames.length;++n)r[n]=this.getOrCreateTextureData(t[n],e.inputTypes[n]);let n=yh(e,r),i=this.session.programManager.getArtifact(n),o=i?i.programInfo:"function"==typeof e.get?e.get():e,a=gn(this.session.layoutStrategy,o.output.dims,o.output.textureType),s=this.createTextureData(a,o.output.type);return i||(i=this.session.programManager.build(o,r,s),this.session.programManager.setArtifact(n,i)),this.runProgram(i,r,s),s}run(e,t){return this.executeProgram(e,t).tensor}runProgram(e,t,r){for(let r=0;r<t.length;++r)if(!!t[r].isPacked!=(2===e.programInfo.inputTypes[r]))throw new Error(`input[${r}] property packed inconsistent`);if(!!r.isPacked!=(2===e.programInfo.output.textureType))throw new Error("output property packed inconsistent");this.session.programManager.run(e,t,r)}getOrCreateTextureData(e,t){let r=this.getTextureData(e.dataId,2===t);if(!r&&(r=this.getTextureData(e.dataId,2!==t),r))return 2===t?this.pack(r):this.unpack(r);if(!r){let n=gn(this.session.layoutStrategy,e.dims,t);if(4===t){let r=e.dims;if(4===r.length){let n=[r[0],Math.ceil(r[1]*r[2]*r[3]/4)],i=gn(this.session.layoutStrategy,n,t),o=e.numberData;if(r[1]*r[2]*r[3]%4!=0){let t=r[0],n=r[1]*r[2]*r[3],i=4*Math.ceil(1*n/4);o=new Float32Array(t*i);for(let r=0;r<t;++r){let t=r*n,a=r*i+r%1*n;o.set(e.numberData.subarray(t,t+n),a)}}return this.createTextureData(i,e.type,o,e,1)}}if(2===t){let t=Ii(this.session.layoutStrategy,e.dims,1,[],{reverseWH:!0}),n=this.createTextureData(t,e.type,e.numberData,e,1);r=this.pack(n)}else r=this.createTextureData(n,e.type,e.numberData,e,1)}return r}createTextureDataFromLayoutBindTensor(e,t,r,n){return this.createTextureData(e,t,r,n,1)}createTextureData(e,t,r,n,i){pe.verbose("InferenceHandler",`Creating TextureData: layout:[${JSON.stringify(e)}]`);let o=this.session.textureManager.createTextureFromLayout(t,e,r,i);return this.createTextureDataFromTexture(e,t,o,n)}reshapeUnpacked(e,t){let r=this.getOrCreateTextureData(e,0),n={channels:r.channels,height:r.height,width:r.width,shape:0!==t.length?t:[1],strides:z.computeStrides(t),unpackedShape:t};return this.createTextureDataFromTexture(n,e.type,r.texture).tensor}reshapePacked(e,t){let r=this.getOrCreateTextureData(e,2);if(Zu(e.dims,t)){let n={channels:r.channels,height:r.height,width:r.width,shape:0!==t.length?t:[1],strides:z.computeStrides(t),unpackedShape:t,isPacked:!0};return this.createTextureDataFromTexture(n,e.type,r.texture).tensor}let n=Oi(e.dims),i=Oi(t),o=this.reshapePacked(e,n),a=this.run(Ju(this,o,i),[o]);return this.reshapePacked(a,t)}cast(e,t){let r=this.getOrCreateTextureData(e,0);return this.createTextureDataFromTexture(r,t,r.texture).tensor}createTextureDataFromTexture(e,t,r,n,i){let o={...e,tensor:n||new Be(e.unpackedShape,t,(e=>this.readTexture(o)),(async e=>this.readTextureAsync(o)),void 0,i),texture:r};return this.setTextureData(o.tensor.dataId,o,e.isPacked),o}getTextureData(e,t=!1){return this.session.isInitializer(e)?this.session.getTextureData(e,t):t?this.packedTextureDataCache.get(e):this.unpackedTextureDataCache.get(e)}setTextureData(e,t,r=!1){this.session.isInitializer(e)?this.session.setTextureData(e,t,r):(r?this.packedTextureDataCache:this.unpackedTextureDataCache).set(e,t)}isTextureLayoutCached(e,t=!1){return!!this.getTextureData(e.dataId,t)}dispose(){this.session.textureManager.clearActiveTextures(),this.packedTextureDataCache.forEach((e=>this.session.textureManager.releaseTexture(e))),this.packedTextureDataCache=new Map,this.unpackedTextureDataCache.forEach((e=>this.session.textureManager.releaseTexture(e))),this.unpackedTextureDataCache=new Map}readTexture(e){return e.isPacked?this.readTexture(this.unpack(e)):this.session.backend.glContext.isFloat32DownloadSupported?this.session.textureManager.readTexture(e,e.tensor.type,e.channels):this.session.textureManager.readUint8TextureAsFloat(Si(this,e))}async readTextureAsync(e){return e.isPacked?this.readTextureAsync(this.unpack(e)):this.session.backend.glContext.isFloat32DownloadSupported?this.session.textureManager.readTextureAsync(e,e.tensor.type,e.channels):this.session.textureManager.readUint8TextureAsFloat(Si(this,e))}pack(e){return this.executeProgram(Xu(this,e.tensor),[e.tensor])}unpack(e){return this.executeProgram(rl(this,e.tensor),[e.tensor])}}})),Ai,re,Me=D((()=>{Ai=class{constructor(e){Object.assign(this,e)}get cacheKey(){return this.key||(this.key=Object.getOwnPropertyNames(this).sort().map((e=>`${this[e]}`)).join(";")),this.key}},re=e=>new Ai(e)})),ul,ll,fl,Th,xh,cl=D((()=>{Me(),ve(),ae(),ul={name:"BatchNormalization",inputNames:["A","Scale","B","Mean","Variance"],inputTypes:[0,0,0,0,0]},ll=(e,t,r)=>(xh(t),[e.run({...ul,cacheHint:r.cacheKey,get:()=>Th(e,t,r)},t)]),fl=e=>{let t=e.attributes.getFloat("epsilon",1e-5),r=e.attributes.getFloat("momentum",.9),n=e.attributes.getInt("spatial",1);return re({epsilon:t,momentum:r,spatial:n})},Th=(e,t,r)=>{let n=Y(e.session.backend.glContext.version),i=t[0].dims.length,[o,a]=e.calculateTextureWidthAndHeight(t[1].dims,0),s=`\n  float process(int[${i}] indices) {\n    vec2 position = offsetToCoords(indices[1], ${o}, ${a});\n    float scale = getColorAsFloat(${n.texture2D}(Scale, position));\n    float mean = getColorAsFloat(${n.texture2D}(Mean, position));\n    float variance = getColorAsFloat(${n.texture2D}(Variance, position));\n    float b = getColorAsFloat(${n.texture2D}(B, position));\n\n    return scale * ( (_A(indices) - mean) / sqrt(variance + float(${r.epsilon})) ) + b;\n  }`;return{...ul,output:{dims:t[0].dims,type:t[0].type,textureType:0},shaderSource:s}},xh=e=>{if(!e||5!==e.length)throw new Error("BatchNormalization requires 5 inputs.");let t=e[0],r=e[1],n=e[2],i=e[3],o=e[4];if(t.dims.length<3||1!==r.dims.length||1!==n.dims.length||1!==i.dims.length||1!==o.dims.length)throw new Error("invalid input shape.");if(r.dims[0]!==t.dims[1]||n.dims[0]!==t.dims[1]||i.dims[0]!==t.dims[1]||o.dims[0]!==t.dims[1])throw new Error("invalid input shape.");if("float32"!==t.type&&"float64"!==t.type||"float32"!==r.type&&"float64"!==r.type||"float32"!==n.type&&"float64"!==n.type||"float32"!==i.type&&"float64"!==i.type||"float32"!==o.type&&"float64"!==o.type)throw new Error("invalid input tensor types.")}})),so,bt,G,yn,uo,Xt=D((()=>{so=class{constructor(e,t,r,n){this.glContext=e,this.programInfo=t,this.inputTextureLayouts=r,this.outputTextureLayout=n}},bt=class{constructor(e){this.context=e}},G=class{constructor(e,t){this.routineBody=e,this.dependencies=t}},yn=class{constructor(e,t,r){this.name=e,this.dependencies=r||[],t&&(this.routineBody=t)}addDependency(e){e&&this.dependencies.push(e)}},uo=class{static returnOrderedNodes(e){if(!e||0===e.length)return[];if(1===e.length)return e;let t=new Set,r=new Set,n=new Array;return this.createOrderedNodes(e,t,r,n),n}static createOrderedNodes(e,t,r,n){for(let i=0;i<e.length;++i)this.dfsTraverse(e[i],t,r,n)}static dfsTraverse(e,t,r,n){if(!e||r.has(e.name))return;if(t.has(e.name))throw new Error("Cyclic dependency detected. Can't topologically sort routines needed for shader.");t.add(e.name);let i=e.dependencies;if(i&&i.length>0)for(let e=0;e<i.length;++e)this.dfsTraverse(i[e],t,r,n);n.push(e),r.add(e.name),t.delete(e.name)}}}));function vh(){let e="add_";return{body:`\n  float ${e}(float a, float b) {\n    return a + b;\n  }\n  vec4 ${e}(vec4 v1, vec4 v2) {\n    return v1 + v2;\n  }\n  `,name:e,type:0}}function _h(){let e="div_";return{body:`\n  float ${e}(float a, float b) {\n    return a / b;\n  }\n  vec4 ${e}(vec4 v1, vec4 v2) {\n    return v1 / v2;\n  }\n  `,name:e,type:0}}function Oh(){let e="mul_";return{body:`\n  float ${e}(float a, float b) {\n    return a * b;\n  }\n  vec4 ${e}(vec4 v1, vec4 v2) {\n    return v1 * v2;\n  }\n  `,name:e,type:0}}function Sh(){let e="sub_";return{body:`\n  float ${e}(float a, float b) {\n    return a - b;\n  }\n  vec4 ${e}(vec4 v1, vec4 v2) {\n    return v1 - v2;\n  }\n  `,name:e,type:0}}function Ih(){let e="equal_";return{body:`\n  float ${e}(float a, float b) {\n    return float(a == b);\n  }\n  vec4 ${e}(vec4 v1, vec4 v2) {\n    return vec4(equal(v1, v2));\n  }\n  `,name:e,type:0}}function Ah(){let e="greater_";return{body:`\n  float ${e}(float a, float b) {\n    return float(a > b);\n  }\n  vec4 ${e}(vec4 v1, vec4 v2) {\n    return vec4( v1.r > v2.r ,\n      v1.g > v2.g,\n      v1.b > v2.b,\n      v1.a > v2.a );\n  }\n  `,name:e,type:0}}function Eh(){let e="less_";return{body:`\n  float ${e}(float a, float b) {\n    return float(a < b);\n  }\n  vec4 ${e}(vec4 v1, vec4 v2) {\n    return vec4( v1.r < v2.r ,\n                v1.g < v2.g,\n                v1.b < v2.b,\n                v1.a < v2.a );\n  }\n  `,name:e,type:0}}function Ph(){let e="and_";return{body:`\n  float ${e}(float a, float b) {\n    return float( bool(a) && bool(b) );\n  }\n  vec4 ${e}(vec4 v1, vec4 v2) {\n    bvec4 b1 = bvec4(v1);\n    bvec4 b2 = bvec4(v2);\n    return vec4( b1.r && b2.r ,\n                b1.g && b2.g,\n                b1.b && b2.b,\n                b1.a && b2.a );\n  }\n  `,name:e,type:0}}function Dh(){let e="or_";return{body:`\n  float ${e}(float a, float b) {\n    return float( bool(a) || bool(b) );\n  }\n  vec4 ${e}(vec4 v1, vec4 v2) {\n    bvec4 b1 = bvec4(v1);\n    bvec4 b2 = bvec4(v2);\n    return vec4( b1.r || b2.r ,\n                b1.g || b2.g,\n                b1.b || b2.b,\n                b1.a || b2.a );\n  }\n  `,name:e,type:0}}function Lh(){let e="xor_";return{body:`\n  float ${e}(float a, float b) {\n    return float( bool(a) ^^ bool(b) );\n  }\n  vec4 ${e}(vec4 v1, vec4 v2) {\n    bvec4 b1 = bvec4(v1);\n    bvec4 b2 = bvec4(v2);\n    return vec4( b1.r ^^ b2.r ,\n                b1.g ^^ b2.g,\n                b1.b ^^ b2.b,\n                b1.a ^^ b2.a );\n  }\n  `,name:e,type:0}}function Ch(){return Bh("pow")}function Fh(){let e="prelu_";return{body:`\n  float ${e}(float a, float b) {\n    return a < 0.0 ? a * b: a;\n  }\n  vec4 ${e}(vec4 v1, vec4 v2) {\n    return vec4(\n      v1.r < 0.0 ? v1.r * v2.r: v1.r,\n      v1.g < 0.0 ? v1.g * v2.g: v1.g,\n      v1.b < 0.0 ? v1.b * v2.b: v1.b,\n      v1.a < 0.0 ? v1.a * v2.a: v1.a\n      );\n  }\n  `,name:e,type:0}}function Bh(e){let t=`${e}_`;return{body:`\n  float ${t}(float a, float b) {\n    return ${e}(a, b);\n  }\n  vec4 ${t}(vec4 v1, vec4 v2) {\n    return ${e}(v1, v2);\n  }\n  `,name:t,type:0}}var gt,$h,pl,dl,hl,ml,bl,gl,yl,Tl,xl,wl,vl,_l,Ol=D((()=>{fe(),Xt(),ve(),ae(),gt=(e,t,r,n=t[0].type,i)=>{let o=e.session.pack?2:0;return{name:r.name,inputNames:["A","B"],inputTypes:[o,o],cacheHint:i,get:()=>$h(e,t,r,n)}},$h=(e,t,r,n=t[0].type)=>{let i=e.session.pack?2:0,o=!z.areEqual(t[0].dims,t[1].dims),a=t[0].dims,s=e.session.pack;if(o){let o=Xe.calcShape(t[0].dims,t[1].dims,!1);if(!o)throw new Error("Can't perform binary op on the given tensors");a=o;let u=a.length,l=0!==t[0].dims.length?t[0].dims.length:1,h=0!==t[1].dims.length?t[1].dims.length:1,c=0!==t[0].dims.length?"bcastIndices_A(indices, aindices);":"aindices[0] = 0;",f=0!==t[1].dims.length?"bcastIndices_B(indices, bindices);":"bindices[0] = 0;",d=Y(e.session.backend.glContext.version),p=s?`\n      ${r.body}\n      void main() {\n        vec4 a = getAAtOutCoords();\n        vec4 b = getBAtOutCoords();\n        vec4 result = ${r.name}(a, b);\n        ${d.output} = result;\n      }`:`\n      ${r.body}\n      float process(int indices[${u}]) {\n        int aindices[${l}];\n        int bindices[${h}];\n        ${c}\n        ${f}\n        return ${r.name}(_A(aindices), _B(bindices));\n      }`;return{name:r.name,inputNames:["A","B"],inputTypes:[i,i],output:{dims:a,type:n,textureType:i},shaderSource:p,hasMain:s}}let u=Y(e.session.backend.glContext.version),l=`\n    ${r.body}\n    void main() {\n      vec4 v1 = ${u.texture2D}(A, TexCoords);\n      vec4 v2 = ${u.texture2D}(B, TexCoords);\n      vec4 result = ${r.name}(v1, v2);\n      ${u.output} = result;\n    }\n    `;return{name:r.name,inputNames:["A","B"],inputTypes:[i,i],output:{dims:t[0].dims,type:n,textureType:i},shaderSource:l,hasMain:!0}},pl=(e,t)=>[e.run(gt(e,t,vh()),t)],dl=(e,t)=>[e.run(gt(e,t,Ph(),"bool"),t)],hl=(e,t)=>[e.run(gt(e,t,_h()),t)],ml=(e,t)=>[e.run(gt(e,t,Ih(),"bool"),t)],bl=(e,t)=>[e.run(gt(e,t,Ah(),"bool"),t)],gl=(e,t)=>[e.run(gt(e,t,Eh(),"bool"),t)],yl=(e,t)=>[e.run(gt(e,t,Oh()),t)],Tl=(e,t)=>[e.run(gt(e,t,Dh(),"bool"),t)],xl=(e,t)=>[e.run(gt(e,t,Ch()),t)],wl=(e,t)=>[e.run(gt(e,t,Fh()),t)],vl=(e,t)=>[e.run(gt(e,t,Sh()),t)],_l=(e,t)=>[e.run(gt(e,t,Lh(),"bool"),t)]})),Sl,Il,Nh,Al=D((()=>{fe(),Sl=(e,t,r)=>(Nh(t),[e.cast(t[0],r)]),Il=e=>Ve.tensorDataTypeFromProto(e.attributes.getInt("to")),Nh=e=>{if(!e||1!==e.length)throw new Error("Cast requires 1 input.");if("string"===e[0].type)throw new Error("Invalid input type.")}})),Rh,Mh,El,lo,Pl=D((()=>{ve(),ae(),Rt(),Ir(),Rh=(e,t)=>({name:"Concat (packed)",inputNames:Array.from({length:e},((e,t)=>`X${t}`)),inputTypes:Array(e).fill(2),cacheHint:t}),Mh=(e,t,r,n)=>{let i=r[0].dims.slice();if(n>=i.length||n<-1*i.length)throw new Error("axis specified for concat doesn't match input dimensionality");n<0&&(n=i.length+n);let o=i.slice(0);for(let e=1;e<r.length;e++){let t=r[e].dims.slice();for(let e=0;e<i.length;e++)if(e===n)o[n]+=t[e];else if(i[e]!==t[e])throw new Error("non concat dimensions must match")}let a=o.length,s=Hr("coords",a),u=Ke(a),l=Mt(),h=r.map((e=>e.dims)),c=Et(a),f=new Array(h.length-1);f[0]=h[0][n];for(let e=1;e<f.length;e++)f[e]=f[e-1]+h[e][n];let d=c[n],p=c.slice(-2),y=c.join(),m=`if (${d} < ${f[0]}) {\n        return getChannel(\n            getX0(${y}), vec2(${p.join()}));\n        }`;for(let e=1;e<f.length;e++){let t=f[e-1];m+=`\n            if (${d} < ${f[e]}  && ${d} >= ${f[e-1]}) {\n              return getChannel(\n                getX${e}(${lo(c,d,t)}),\n                vec2(${lo(p,d,t)}));\n            }`}let g=f.length,w=f[f.length-1];m+=`\n            return getChannel(\n              getX${g}(${lo(c,d,w)}),\n              vec2(${lo(p,d,w)}));`;let v=Y(e.session.backend.glContext.version),b=`\n          ${l}\n          float getValue(${c.map((e=>"int "+e))}) {\n            ${m}\n          }\n\n          void main() {\n            ${u} coords = getOutputCoords();\n            int lastDim = coords.${c[a-1]};\n            coords.${c[a-1]} = coords.${c[a-2]};\n            coords.${c[a-2]} = lastDim;\n\n            vec4 result = vec4(getValue(${s}), 0., 0., 0.);\n\n            ${s[a-1]} = ${s[a-1]} + 1;\n            if (${s[a-1]} < ${o[a-1]}) {\n              result.g = getValue(${s});\n            }\n\n            ${s[a-2]} = ${s[a-2]} + 1;\n            if (${s[a-2]} < ${o[a-2]}) {\n              result.a = getValue(${s});\n            }\n\n            ${s[a-1]} = ${s[a-1]} - 1;\n            if (${s[a-2]} < ${o[a-2]} &&\n                ${s[a-1]} < ${o[a-1]}) {\n              result.b = getValue(${s});\n            }\n            ${v.output} = result;\n          }\n        `;return{...t,output:{dims:o,type:r[0].type,textureType:2},shaderSource:b,hasMain:!0}},El=(e,t,r)=>{let n=Rh(t.length,r.cacheKey);return{...n,get:()=>Mh(e,n,t,r.axis)}},lo=(e,t,r)=>{let n=e.indexOf(t);return e.map(((e,t)=>t===n?`${e} - ${r}`:e)).join()}})),Dl,Gh,Uh,zh,Ll,Wh,Vh,Hh,Cl,jh,Fl=D((()=>{Me(),ae(),Pl(),Dl=(e,t,r)=>(jh(t),e.session.pack&&t[0].dims.length>1?[e.run(El(e,t,r),t)]:[e.run(zh(e,t,r),t)]),Gh=(e,t)=>({name:"Concat",inputNames:Array.from({length:e},((e,t)=>`X${t}`)),inputTypes:Array(e).fill(0),cacheHint:t}),Uh=(e,t,r,n)=>{let i=r[0].dims.slice();if(n>=i.length||n<-1*i.length)throw new Error("axis specified for concat doesn't match input dimensionality");n<0&&(n=i.length+n);let o=i.slice(0);for(let e=1;e<r.length;e++){let t=r[e].dims.slice();for(let e=0;e<i.length;e++)if(e===n)o[n]+=t[e];else if(i[e]!==t[e])throw new Error("non concat dimensions must match")}let a=o.length,s=new Array(r.length),u=0;for(let e=0;e<s.length;++e)u+=r[e].dims[n],s[e]=u;let l="";l=r.length<5?Ll(s):Wh(s);let h=`\n        ${Vh(r.length,a)}\n        ${Hh(s)}\n        ${l}\n        float process(int indices[${a}]) {\n          int textureIndex = getTextureWhereDataResides (indices[${n}]);\n\n          if(textureIndex != 0) {\n            indices[${n}] = indices[${n}] - int(getSizeInConcatAxisValueFromIndex(textureIndex-int(1)));\n          }\n\n          return fetchDataFromCorrectTexture(textureIndex, indices);\n        }`;return{...t,output:{dims:o,type:r[0].type,textureType:0},shaderSource:h}},zh=(e,t,r)=>{let n=Gh(t.length,r.cacheKey);return{...n,get:()=>Uh(e,n,t,r.axis)}},Ll=e=>`int getTextureWhereDataResides(int index) {\n      ${e.map(((e,t)=>`if(index<${e}) {return ${t};}\n`)).join("")}\n    }`,Wh=e=>Ll(e),Vh=(e,t)=>{let r=[`float fetchDataFromCorrectTexture(int textureIndex, int indices[${t}]) {`];for(let t=0;t<e;++t)0===t?r.push(`\tif (textureIndex == ${t}) { return _X${t}(indices); }`):t===e-1?r.push(`\telse { return _X${t}(indices); }`):r.push(`\telse if (textureIndex == ${t}) { return _X${t}(indices); }`);return r.push("\t}"),r.join("\n")},Hh=e=>{let t=["int getSizeInConcatAxisValueFromIndex(int index) {"];for(let r=0;r<e.length;++r)0===r?t.push(`\tif (index == ${r}) { return ${e[r]}; }`):r===e.length-1?t.push(`\telse { return ${e[r]}; }`):t.push(`\telse if (index == ${r}) { return ${e[r]}; }`);return t.push("\t}"),t.join("\n")},Cl=e=>re({axis:e.attributes.getInt("axis")}),jh=e=>{if(!e||e.length<1)throw new Error("too few inputs");let t=e[0].type,r=e[0].dims.length;if("string"===t)throw new Error("string tensor is not supported yet");for(let n of e){if(n.type!==t)throw new Error("input tensors should be one type");if(n.dims.length!==r)throw new Error("input tensors should have the same shape")}}}));function qh(){return yt("abs")}function Yh(){return yt("acos")}function Xh(){return yt("asin")}function Kh(){return yt("atan")}function Jh(){return yt("ceil")}function Zh(){return yt("cos")}function Qh(e){let t="elu";return{body:`\n  const float alpha = float(${e});\n\n  float ${t}_(float a) {\n    return a >= 0.0 ? a: (exp(a) - 1.0) * alpha;\n  }\n  vec4 ${t}_(vec4 v) {\n    return vec4(${t}_(v.x), ${t}_(v.y), ${t}_(v.z), ${t}_(v.w));\n  }\n  `,name:t,type:0}}function em(){return yt("exp")}function tm(){return yt("floor")}function Ei(e,t){let r="clip";return{body:`\n  const float min = float(${e});\n  const float max = float(${t});\n\n  float ${r}_(float a) {\n    return clamp(a, min, max);\n  }\n  vec4 ${r}_(vec4 v) {\n    return clamp(v, min, max);\n  }\n  `,name:r,type:0}}function rm(){let e="indentity";return{body:`\n  float ${e}_(float a) {\n    return a;\n  }\n  vec4 ${e}_(vec4 v) {\n    return v;\n  }\n  `,name:e,type:0}}function nm(e){let t="leakyRelu";return{body:`\n  const float alpha = float(${e});\n\n  float ${t}_(float a) {\n    return a < 0.0 ? a * alpha : a;\n  }\n  vec4 ${t}_(vec4 v) {\n    return vec4(${t}_(v.x), ${t}_(v.y), ${t}_(v.z), ${t}_(v.w));\n  }\n  `,name:t,type:0}}function om(){return yt("log")}function im(){let e="neg";return{body:`\n  float ${e}_(float a) {\n    return -a;\n  }\n  vec4 ${e}_(vec4 v) {\n    return -v;\n  }\n  `,name:e,type:0}}function am(){let e="not";return{body:`\n  float ${e}_(float a) {\n    return float( ! bool(a) );\n  }\n  bool ${e}_(bool a) {\n    return !a;\n  }\n  vec4 ${e}_(vec4 v) {\n    return vec4(!bool(v.x), !bool(v.y), !bool(v.z), !bool(v.w));\n  }\n  bvec4 ${e}_(bvec4 v) {\n    return bvec4(!v.x, !v.y, !v.z, !v.w);\n  }\n  `,name:e,type:0}}function sm(){return yt("sin")}function Pi(){let e="relu";return{body:`\n  float ${e}_(float a) {\n    return max( a, 0.0 );\n  }\n  vec4 ${e}_(vec4 v) {\n    return max( v, 0.0 );\n  }\n  `,name:e,type:0}}function Di(){let e="sigmoid";return{body:`\n  float ${e}_(float a) {\n    return 1.0 / (1.0 + exp(-a));\n  }\n  vec4 ${e}_(vec4 v) {\n    return 1.0 / (1.0 + exp(-v));\n  }\n  `,name:e,type:0}}function um(){return yt("sqrt")}function lm(){return yt("tan")}function fm(){let e="tanh";return{body:`\n  float ${e}_(float a) {\n    a = clamp(a, -10., 10.);\n    a = exp(2.*a);\n    return (a - 1.) / (a + 1.);\n  }\n  vec4 ${e}_(vec4 v) {\n    v = clamp(v, -10., 10.);\n    v = exp(2.*v);\n    return (v - 1.) / (v + 1.);\n  }\n  `,name:e,type:0}}function yt(e){return{body:`\n  float ${e}_(float a) {\n    return ${e}(a);\n  }\n  vec4 ${e}_(vec4 v) {\n    return ${e}(v);\n  }\n  `,name:e,type:0}}var cm,Ce,Bl,$l,kl,Nl,Li,Rl,Ml,pm,Gl,Ul,zl,Wl,Vl,Hl,Ci,jl,ql,Yl,Xl,Kl,Jl,Zl,Ql,ef,tf,rf,Fi=D((()=>{Me(),fe(),Xt(),ve(),ae(),cm=(e,t,r,n)=>{let i=e.session.pack?2:0,o=Y(e.session.backend.glContext.version);return{...t,output:{dims:r.dims,type:r.type,textureType:i},shaderSource:`\n     ${n.body}\n     void main() {\n       vec4 v = ${o.texture2D}(A, TexCoords);\n       v = ${n.name}_(v);\n       ${o.output} = v;\n     }\n     `,hasMain:!0}},Ce=(e,t,r,n)=>{let i=e.session.pack?2:0,o={name:r.name,inputTypes:[i],inputNames:["A"],cacheHint:n};return{...o,get:()=>cm(e,o,t,r)}},Bl=(e,t)=>[e.run(Ce(e,t[0],qh()),t)],$l=(e,t)=>[e.run(Ce(e,t[0],Yh()),t)],kl=(e,t)=>[e.run(Ce(e,t[0],Xh()),t)],Nl=(e,t)=>[e.run(Ce(e,t[0],Kh()),t)],Li=(e,t,r)=>[e.run(Ce(e,t[0],Ei(r.min,r.max),r.cacheKey),t)],Rl=e=>re({min:e.attributes.getFloat("min",_r),max:e.attributes.getFloat("max",Or)}),Ml=(e,t)=>{let r=pm(e,t);return Li(e,[t[0]],r)},pm=(e,t)=>{if(t.length>=3&&(!e.session.isInitializer(t[1].dataId)||!e.session.isInitializer(t[2].dataId)))throw new Error("dynamic clip attributes are not allowed");let r=t.length>=3?t[1].numberData[0]:_r,n=t.length>=3?t[2].numberData[0]:Or;return re({min:r,max:n})},Gl=(e,t)=>[e.run(Ce(e,t[0],Jh()),t)],Ul=(e,t)=>[e.run(Ce(e,t[0],Zh()),t)],zl=(e,t,r)=>[e.run(Ce(e,t[0],Qh(r.alpha),r.cacheKey),t)],Wl=e=>re({alpha:e.attributes.getFloat("alpha",1)}),Vl=(e,t)=>[e.run(Ce(e,t[0],em()),t)],Hl=(e,t)=>[e.run(Ce(e,t[0],tm()),t)],Ci=(e,t)=>[e.run(Ce(e,t[0],rm()),t)],jl=(e,t,r)=>[e.run(Ce(e,t[0],nm(r.alpha),r.cacheKey),t)],ql=e=>re({alpha:e.attributes.getFloat("alpha",.01)}),Yl=(e,t)=>[e.run(Ce(e,t[0],om()),t)],Xl=(e,t)=>[e.run(Ce(e,t[0],im()),t)],Kl=(e,t)=>[e.run(Ce(e,t[0],am()),t)],Jl=(e,t)=>[e.run(Ce(e,t[0],Pi()),t)],Zl=(e,t)=>[e.run(Ce(e,t[0],Di()),t)],Ql=(e,t)=>[e.run(Ce(e,t[0],sm()),t)],ef=(e,t)=>[e.run(Ce(e,t[0],um()),t)],tf=(e,t)=>[e.run(Ce(e,t[0],lm()),t)],rf=(e,t)=>[e.run(Ce(e,t[0],fm()),t)]}));function Gt(e){let t;switch(e.activation){case"Relu":t=Pi();break;case"Sigmoid":t=Di();break;case"Clip":t=Ei(e.clipMin,e.clipMax);break;default:return{activationFunction:"",applyActivation:""}}let r=t.name;return{activationFunction:t.body,applyActivation:`value = ${r}_(value);`}}var jr,Ar=D((()=>{fe(),Fi(),jr=e=>{let t=e.getString("activation","");if("Clip"===t){let[r,n]=e.getFloats("activation_params",[_r,Or]);return{activation:t,clipMax:n,clipMin:r,activationCacheKey:`${t}:${r},${n}`}}return{activation:t,activationCacheKey:t}}})),hm,mm,nf,of=D((()=>{pt(),ve(),ae(),fo(),Ar(),hm=(e,t)=>({name:"GroupedConv",inputNames:e?["X","W","Bias"]:["X","W"],inputTypes:e?[0,0,0]:[0,0],cacheHint:t}),mm=(e,t,r,n)=>{let i=t.length>2?"value += getBias(output_channel);":"",o=t[0].dims.slice(),a=t[1].dims.slice(),s=a[0]/n.group;pe.verbose("GroupedConv",`autpPad:${n.autoPad}, dilations:${n.dilations}, group:${n.group}, kernelShape:${n.kernelShape}, pads:${n.pads}, strides:${n.strides}`);let u=qr(o,a,n.dilations,n.pads,n.strides),l=Y(e.session.backend.glContext.version),{activationFunction:h,applyActivation:c}=Gt(n),f=`\n  const ivec2 strides = ivec2(${n.strides[0]}, ${n.strides[1]});\n  const ivec2 pads = ivec2(${n.pads[0]}, ${n.pads[1]});\n  ${h}\n  void main() {\n    ivec4 coords = getOutputCoords();\n    int batch = coords.x;\n    int output_channel = coords.y;\n    ivec2 xRCCorner = coords.zw * strides - pads;\n    int group_id = output_channel / ${s};\n\n    float value = 0.0;\n    for (int wInChannel = 0; wInChannel < ${a[1]}; wInChannel++) {\n      int input_channel = group_id * ${a[1]} + wInChannel;\n      for (int wHeight = 0; wHeight < ${a[2]}; wHeight++) {\n        int xHeight = xRCCorner.x + wHeight * ${n.dilations[0]};\n\n        if (xHeight < 0 || xHeight >= ${o[2]}) {\n          continue;\n        }\n\n        for (int wWidth = 0; wWidth < ${a[3]}; wWidth++) {\n          int xWidth = xRCCorner.y + wWidth * ${n.dilations[1]};\n          if (xWidth < 0 || xWidth >= ${o[3]}) {\n            continue;\n          }\n\n          float xVal = getX(batch, input_channel, xWidth, xHeight);\n          float wVal = getW(output_channel, wInChannel, wWidth, wHeight);\n          value += xVal*wVal;\n        }\n      }\n    }\n    ${i}\n    ${c}\n    ${l.output} = vec4(value, .0, .0, .0);\n  }\n`;return{...r,output:{dims:u,type:t[0].type,textureType:0},shaderSource:f,hasMain:!0}},nf=(e,t,r)=>{let n=hm(t.length>2,r.cacheKey);return{...n,get:()=>mm(e,t,n,r)}}})),bm,gm,af,sf=D((()=>{ve(),ae(),Ir(),bm=e=>({name:"Im2Col (packed)",inputNames:["A"],inputTypes:[2],cacheHint:e}),gm=(e,t,r,n,i,o)=>{let a=r.dims,s=n.dims,u=i.length,l=[s[1]*s[2]*s[3],i[2]*i[3]],h=s[2]*s[3],c=Mt(),f=Y(e.session.backend.glContext.version),d="";for(let e=0;e<=1;e++)for(let t=0;t<=1;t++)d+=`\n            blockIndex = rc.x + ${t};\n            pos = rc.y + ${e};\n\n            if(blockIndex < ${l[1]} && pos < ${l[0]}) {\n              offsetY = int(blockIndex / (${i[u-1]})) * ${o.strides[0]} -\n                ${o.pads[0]};\n              d0 = offsetY + ${o.dilations[0]} * (imod(pos, ${h}) / ${s[2]});\n\n              if(d0 < ${a[2]} && d0 >= 0) {\n                offsetX = imod(blockIndex, ${i[u-1]}) * ${o.strides[1]} -\n                  ${o.pads[1]};\n                d1 = offsetX + ${o.dilations[1]} * imod(imod(pos, ${h}), ${s[2]});\n\n                if(d1 < ${a[3]} && d1 >= 0) {\n\n                  ch = int(float(pos)/ ${h}.);\n                    innerDims = vec2(d0, d1);\n                    result[${2*e+t}] = getChannel(\n                      getA(0, ch, int(innerDims.x),\n                      int(innerDims.y)), innerDims);\n                }\n              }\n            }\n\n          `;let p=`\n      ${c}\n\n      void main() {\n        ivec2 rc = getOutputCoords();\n          vec4 result = vec4(0.0);\n          int blockIndex, pos, offsetY, d0, offsetX, d1, ch;\n          vec2 innerDims;\n          ${d}\n          ${f.output} = result;\n      }\n            `;return{...t,output:{dims:l,type:r.type,textureType:2},shaderSource:p,hasMain:!0}},af=(e,t,r,n,i)=>{let o=bm(i.cacheKey);return{...o,get:()=>gm(e,o,t,r,n,i)}}}));function Tm(e,t,r){let n=t[0].dims,i=t[1].dims,o=Xe.calcShape(n,i,!0);if(!o)throw new Error("Can't use matmul on the given tensors");let a=Ke(o.length),s=Et(),{activationFunction:u,applyActivation:l}=Gt(r),h=t.length>2,c=h?"value += getBiasForMatmul();":"",f=h?`${$i(a,s,t[2].dims,o,!1)}`:"",d=o.length,p=n.length,y=i.length,m=`\n    ${u}\n    ${f}\n    float process(int indices[${d}]) {\n        int a[${p}];\n        int b[${y}];\n        bcastMatmulIndices_A(indices, a);\n        bcastMatmulIndices_B(indices, b);\n\n        float value;\n        for (int k=0; k<${n[n.length-1]}; ++k) {\n            a[${p-1}] = k;\n            b[${y-2}] = k;\n            value += _A(a) * _B(b);\n        }\n        ${c}\n        ${l}\n        return value;\n    }`;return{...e,output:{dims:o,type:t[0].type,textureType:0},shaderSource:m}}function Bi(e,t){let r=ym(e.length>2,t.activationCacheKey);return{...r,get:()=>Tm(r,e,t)}}function $i(e,t,r,n,i){let o="",a=r.length,s=n.length,u=s-a;o=s<2&&a>0?"coords":r.map(((e,r)=>`coords.${t[r+u]}`)).join(", ");let l=Xe.getBroadcastDims(r,n).map((e=>`coords.${t[e+u]} = 0;`)).join("\n"),h="vec4(outputValue.xx, outputValue.yy)";return 1===z.size(r)&&(h="vec4(outputValue.x)"),i?`\nvec4 getBiasForMatmul() {\n  ${e} coords = getOutputCoords();\n  ${l}\n  vec4 outputValue = getBias(${o});\n  return ${h};\n}`:`\nfloat getBiasForMatmul() {\n  ${e} coords = getOutputCoords();\n  ${l}\n  return getBias(coords.x);\n}`}var uf,lf,ym,xm,co=D((()=>{fe(),ae(),Rt(),Ar(),ki(),uf=(e,t,r)=>(xm(t),e.session.pack?[e.run(po(e,t,r),t)]:[e.run(Bi(t,r),t)]),lf=e=>jr(e.attributes),ym=(e,t)=>({name:"MatMul",inputNames:e?["A","B","Bias"]:["A","B"],inputTypes:e?[0,0,0]:[0,0],cacheHint:t}),xm=e=>{if(!e||2!==e.length)throw new Error("MatMul requires 2 inputs.");if(e[0].dims[e[0].dims.length-1]!==e[1].dims[e[1].dims.length-2])throw new Error("shared dimension does not match.");if("float32"!==e[0].type&&"float64"!==e[0].type||"float32"!==e[1].type&&"float64"!==e[1].type)throw new Error("inputs should be float type");if(e[0].type!==e[1].type)throw new Error("inputs types should match")}}));function _m(e,t,r,n){let i=[],o=[],a=r[0].dims,s=r[1].dims,u=a.length,l=s.length,h=n.length,c=h-u,f=h-l;i=a.map(((e,r)=>`coords.${t[r+c]}`)),i[u-1]="i*2",i.join(", "),o=s.map(((e,r)=>`coords.${t[r+f]}`)),o[l-2]="i*2",o.join(", ");let d=Xe.getBroadcastDims(a,n),p=Xe.getBroadcastDims(s,n),y=d.map((e=>`coords.${t[e+c]} = 0;`)).join("\n"),m=p.map((e=>`coords.${t[e+f]} = 0;`)).join("\n"),g=`int lastDim = coords.${t[h-1]};\n  coords.${t[h-1]} = coords.${t[h-2]};\n  coords.${t[h-2]} = lastDim;`;return`\nvec4 getAAtOutCoordsMatmul(int i) {\n  ${e} coords = getOutputCoords();\n  ${g}\n  ${y}\n  vec4 outputValue = getA(${i});\n  return outputValue;\n}\n\nvec4 getBAtOutCoordsMatmul(int i) {\n  ${e} coords = getOutputCoords();\n  ${g}\n  ${m}\n  vec4 outputValue = getB(${o});\n  return outputValue;\n}`}function Om(e,t){let r="";for(let n=0;n<t-2;n++)r+=`rc.${e[n]}, `;return r+=`rc.${e[t-2]}, i*2`,r}function Sm(e,t){let r="";for(let n=0;n<t-2;n++)r+=`rc.${e[n]}, `;return r+=`i*2, rc.${e[t-1]}`,r}var wm,vm,po,ki=D((()=>{fe(),ve(),ae(),Rt(),Ar(),co(),wm=(e,t)=>({name:"MatMul (packed)",inputNames:e?["A","B","Bias"]:["A","B"],inputTypes:e?[2,2,2]:[2,2],cacheHint:t}),vm=(e,t,r,n)=>{let i=r.length>2,o=i?"value += getBiasForMatmul();":"",a=r[0].dims,s=r[1].dims,u=Xe.calcShape(a,s,!0),l=!z.areEqual(r[0].dims,r[1].dims);if(!u)throw new Error("Can't use matmul on the given tensors");let h=a[a.length-1],c=Math.ceil(h/2),f=a.length,d=s.length,p=Y(e.session.backend.glContext.version),y=Ke(u.length),m=u.length,g=Et(),{activationFunction:w,applyActivation:v}=Gt(n),b=i?`${$i(y,g,r[2].dims,u,!0)}`:"",x=l?`${_m(y,g,r,u)}`:"",_=l?"getAAtOutCoordsMatmul(i)":`getA(${Om(g,f)})`,S=l?"getBAtOutCoordsMatmul(i)":`getB(${Sm(g,d)})`,T=`\n            ${x}\n            ${b}\n            ${w}\n            void main() {\n              ${l?"":`${y} rc =\n          getOutputCoords(); int lastDim = rc.${g[m-1]}; rc.${g[m-1]} =\n          rc.${g[m-2]}; rc.${g[m-2]} = lastDim;\n      `}\n\n              vec4 value = vec4(0);\n              for (int i = 0; i < ${c}; i++) {\n                vec4 a = ${_};\n                vec4 b = ${S};\n\n                value += (a.rrbb * b.rgrg);\n                value += (a.ggaa * b.baba);\n              }\n              ${o}\n              ${v}\n              ${p.output} = value;\n            }`;return{...t,output:{dims:u,type:r[0].type,textureType:2},shaderSource:T,hasMain:!0}},po=(e,t,r)=>{let n=wm(t.length>2,r.activationCacheKey);return{...n,get:()=>vm(e,n,t,r)}}})),ff,cf=D((()=>{fo(),sf(),ki(),ff=(e,t,r)=>{let n=t[0].dims,i=t[1].dims,o=qr(n,i,r.dilations,r.pads,r.strides),a=e.run(af(e,t[0],t[1],o,r),[t[0]]),s=e.reshapePacked(t[1],[i[0],i[1]*i[2]*i[3]]),u=3===t.length?[s,a,t[2]]:[s,a],l=e.run(po(e,u,r),u);return e.reshapePacked(l,o)}})),Im,Am,pf,Ni,Ri=D((()=>{ae(),Im=e=>({name:"Im2Col",inputNames:["X"],inputTypes:[0],cacheHint:e}),Am=(e,t,r,n,i,o)=>{let a=r.dims,s=n.dims,u=i.length,l=Ni(a,s,i,4),h=`\n        const int XC = ${a[1]};\n        const int XH = ${a[2]};\n        const int XW = ${a[3]};\n        const int KH = ${o.kernelShape[0]};\n        const int KW = ${o.kernelShape[1]};\n        const int dilationH = ${o.dilations[0]};\n        const int dilationW = ${o.dilations[1]};\n        const int strideH = ${o.strides[0]};\n        const int strideW = ${o.strides[1]};\n        const int padH = ${o.pads[0]};\n        const int padW = ${o.pads[1]};\n        const int KHKW = KH*KW;\n        const int XCKHKW = XC * KHKW;\n        const int outputChannels = 4;\n        vec4 process(int indices[${u}]) {\n          int b  = indices[0]; // batch size\n          int oh = indices[1] * strideH - padH; //output height\n          int ow = indices[2] * strideW - padW; //output width\n          int p = indices[3] * outputChannels; //patch\n          vec4 value = vec4(0.0);\n          for(int i=0; i < outputChannels; ++i) {\n            if(p < XCKHKW) {\n              int patchC = p / KHKW;\n              int patchH = (p - patchC*KHKW) / KW;\n              int patchW = (p - patchC*KHKW) - patchH * KW;\n              int xh2 = oh + patchH * dilationH;\n              int xw2 = ow + patchW * dilationW;\n              int x[${a.length}];\n              x[0] = b;\n              x[1] = patchC;\n              x[2] = xh2;\n              x[3] = xw2;\n              if(xh2 >= 0 &&\n                  xh2 < XH &&\n                  xw2 >= 0 &&\n                  xw2 < XW) {\n                value[i] = _X(x);\n              }\n            }\n            ++p;\n          }\n          return value;\n        }\n        `;return{...t,output:{dims:l,type:r.type,textureType:4},shaderSource:h}},pf=(e,t,r,n,i)=>{let o=Im(i.cacheKey);return{...o,get:()=>Am(e,o,t,r,n,i)}},Ni=(e,t,r,n=4)=>[r[0],r[2],r[3],Math.ceil(e[1]*t[2]*t[3]/n)]})),Em,Pm,df,hf=D((()=>{fe(),ve(),ae(),Ar(),Ri(),Em=(e,t)=>({name:"ConvDotProduct",inputNames:e?["Im2Col","K","B"]:["Im2Col","K"],inputTypes:e?[0,4,0]:[0,4],cacheKey:t.activationCacheKey}),Pm=(e,t,r,n,i)=>{let o=r[0].dims,a=r[1].dims,s=[a[0],Math.ceil(o[1]*a[2]*a[3]/4)],u=Ni(o,a,n),[l,h]=e.calculateTextureWidthAndHeight(s,4),c=z.computeStrides(u),[f,d]=e.calculateTextureWidthAndHeight(u,4),p=n.length,y=r.length<3?"0.0":"_B(b)",m=Math.ceil(o[1]*a[2]*a[3]/4),{activationFunction:g,applyActivation:w}=Gt(i),v=Y(e.session.backend.glContext.version),b=`\n${g}\nfloat process(int indices[${p}]) {\n  int b[1];\n  b[0] = indices[1];\n  int im2col[4];\n  im2col[0] = indices[0];\n  im2col[1] = indices[2];\n  im2col[2] = indices[3];\n  int im2colOffset = im2col[0] * ${c[0]} + im2col[1] * ${c[1]} + im2col[2] * ${c[2]};\n  int kernelOffset = indices[1] * ${s[1]};\n  float value = ${y};\n  for (int i = 0; i < ${m}; ++i) {\n    vec2 im2colCoords = offsetToCoords(im2colOffset, ${f}, ${d});\n    vec2 kernelCoords = offsetToCoords(kernelOffset, ${l}, ${h});\n    value += dot(${v.texture2D}(Im2Col, im2colCoords), ${v.texture2D}(K, kernelCoords));\n    ++im2colOffset;\n    ++kernelOffset;\n  }\n  ${w}\n  return value;\n}`;return{...t,output:{dims:n,type:r[0].type,textureType:0},shaderSource:b}},df=(e,t,r,n)=>{let i=Em(t.length>2,n);return{...i,get:()=>Pm(e,i,t,r,n)}}})),qr,Mi,Dm,Lm,Cm,Fm,Gi,Bm,fo=D((()=>{Me(),fe(),of(),cf(),hf(),Ar(),Ri(),co(),qr=(e,t,r,n,i)=>{let o=e[0],a=e.slice(2),s=a.length,u=t[0],l=t.slice(2).map(((e,t)=>e+(e-1)*(r[t]-1))),h=a.map(((e,t)=>e+n[t]+n[t+s])).map(((e,t)=>Math.floor((e-l[t]+i[t])/i[t])));return[o,u].concat(...h)},Mi=(e,t,r)=>(Bm(t,r),Dm(e,t,r)),Dm=(e,t,r)=>{let n=Fm(r,t),i=e.session.pack,o=1===n.kernelShape[0]&&1===n.kernelShape[1];return n.group>1?[e.run(nf(e,t,n),t)]:o&&i?[Lm(e,t,n)]:i&&4===t[0].dims.length&&1===t[0].dims[0]&&!o?[ff(e,t,n)]:[Cm(e,t,n)]},Lm=(e,t,r)=>{let n=t[0].dims,i=t[1].dims,o=qr(n,i,r.dilations,r.pads,r.strides),a=e.reshapeUnpacked(t[0],[n[1],n[2]*n[3]]),s=e.reshapeUnpacked(t[1],[i[0],i[1]]),u=t.length>2?[s,a,t[2]]:[s,a],l=e.run(Bi(u,r),u);return e.reshapeUnpacked(l,o)},Cm=(e,t,r)=>{let n=t[0].dims,i=t[1].dims,o=qr(n,i,r.dilations,r.pads,r.strides),a=e.run(pf(e,t[0],t[1],o,r),[t[0]]),s=3===t.length?[a,t[1],t[2]]:[a,t[1]];return e.run(df(e,t,o,r),s)},Fm=(e,t)=>{let r=e.kernelShape.slice();if(0===e.kernelShape.length)for(let e=2;e<t[1].dims.length;++e)r.push(t[1].dims[e]);let n=e.pads.slice();vr.adjustPadsBasedOnAutoPad(t[0].dims,e.strides,e.dilations,r,n,e.autoPad);let i=Object.assign({},e);return Object.assign(i,{kernelShape:r,pads:n,cacheKey:e.cacheKey}),i},Gi=e=>{let t=e.attributes,r=jr(t),n=t.getString("auto_pad","NOTSET"),i=t.getInts("dilations",[1,1]),o=t.getInt("group",1),a=t.getInts("kernel_shape",[]),s=t.getInts("pads",[0,0,0,0]),u=t.getInts("strides",[1,1]);return re({autoPad:n,dilations:i,group:o,kernelShape:a,pads:s,strides:u,...r})},Bm=(e,t)=>{if(!e||2!==e.length&&3!==e.length)throw new Error("Conv requires 2 or 3 inputs");if(4!==e[0].dims.length||4!==e[1].dims.length)throw new Error("currently only support 2-dimensional conv");if(e[0].dims[1]!==e[1].dims[1]*t.group)throw new Error("FILTER_IN_CHANNEL should be equal to DATA_CHANNEL");if(3===e.length&&(1!==e[2].dims.length||e[1].dims[0]!==e[2].dims[0]))throw new Error("invalid bias");let r=e[0].dims.length-2;if(t.dilations.length!==r)throw new Error(`dilations should be ${r}D`);if(t.strides.length!==r)throw new Error(`strides should be ${r}D`);if(t.pads.length!==2*r)throw new Error(`pads should be ${2*r}D`);if(0!==t.kernelShape.length&&t.kernelShape.length!==e[1].dims.length-2)throw new Error("invalid kernel shape");if("float32"!==e[0].type||"float32"!==e[1].type)throw new Error("Conv input(X,W) should be float tensor");if(3===e.length&&"float32"!==e[2].type)throw new Error("Conv input(bias) should be float tensor")}})),$m,km,Nm,mf,Rm,Mm,Gm,Um,zm,Wm,bf,Vm,gf=D((()=>{Me(),ve(),ae(),Ar(),$m=(e,t,r,n,i,o)=>(e-1)*t+r+(n-1)*i+1-o,km=(e,t,r,n,i)=>{let o=Math.floor(e/2);"SAME_UPPER"===t?(r[n]=o,r[i]=e-o):"SAME_LOWER"===t&&(r[n]=e-o,r[i]=o)},Nm=(e,t,r,n,i,o,a,s)=>{let u=e.length-2,l=0===s.length;for(let h=0;h<u;++h){let c=l?e[h+2]*o[h]:s[h],f=$m(e[h+2],o[h],i[h],t[h],r[h],c);km(f,n,i,h,h+u),l&&s.push(o[h]*(e[h+2]-1)+a[h]+(t[h]-1)*r[h]+1-i[h]-i[h+u])}},mf=(e,t,r)=>(Vm(t,r),Rm(e,t,r)),Rm=(e,t,r)=>{let n=Wm(r,t);return[zm(e,t,n)]},Mm=(e,t)=>({name:"ConvTranspose",inputNames:e?["X","W","B"]:["X","W"],inputTypes:e?[0,0,0]:[0,0],cacheHint:t}),Gm=(e,t,r,n)=>{let i=t.length>2?"getB(output_channel)":"0.0",o=t[0].dims,a=t[1].dims,s=a[1],u=a[0]/n.group,l=[t[0].dims[0],t[1].dims[1]*n.group,...n.outputShape],h=Y(e.session.backend.glContext.version),{activationFunction:c,applyActivation:f}=Gt(n),d=`\n  const ivec2 strides = ivec2(${n.strides[0]}, ${n.strides[1]});\n  const ivec2 pads = ivec2(${n.pads[0]}, ${n.pads[1]});\n  ${c}\n  void main() {\n    ivec4 coords = getOutputCoords();\n    int batch = coords.x;\n    int output_channel = coords.y;\n\n    ivec2 loc = coords.zw + pads;\n\n    int group_id = output_channel / ${s};\n    int wOutChannel = output_channel - group_id * ${s};\n\n    float value = ${i};\n    for (int inChannelOffset = 0; inChannelOffset < ${u}; inChannelOffset++) {\n      int input_channel = group_id * ${u} + inChannelOffset;\n      for (int wWOff = 0; wWOff < ${a[2]}; wWOff++) {\n        for (int wHOff = 0; wHOff < ${a[3]}; wHOff++) {\n          ivec2 wOff = ivec2(wWOff * ${n.dilations[0]}, wHOff * ${n.dilations[1]});\n          ivec2 wLoc = loc - wOff;\n          ivec2 wLocIn = wLoc / strides;\n          if (\n            wLocIn * strides == wLoc &&\n            wLocIn.x >= 0 && wLocIn.x < ${o[2]} &&\n            wLocIn.y >= 0 && wLocIn.y < ${o[3]}\n          ) {\n            float xVal = getX(batch, input_channel, wLocIn.y, wLocIn.x);\n            float wVal = getW(input_channel, wOutChannel, wHOff, wWOff);\n            value += xVal * wVal;\n          }\n        }\n      }\n    }\n    ${f}\n    ${h.output} = vec4(value, .0, .0, .0);\n  }\n`;return{...r,output:{dims:l,type:t[0].type,textureType:0},shaderSource:d,hasMain:!0}},Um=(e,t,r)=>{let n=Mm(t.length>2,r.cacheKey);return{...n,get:()=>Gm(e,t,n,r)}},zm=(e,t,r)=>e.run(Um(e,t,r),t),Wm=(e,t)=>{let r=e.kernelShape.slice();if(0===e.kernelShape.length)for(let e=2;e<t[1].dims.length;++e)r.push(t[1].dims[e]);let n=e.pads.slice(),i=e.outputShape.slice(),o=t[0].dims;Nm(o,r,e.dilations,e.autoPad,n,e.strides,e.outputPadding,i);let a=Object.assign({},e);return Object.assign(a,{kernelShape:r,pads:n,outputShape:i,cacheKey:e.cacheKey}),a},bf=e=>{let t=e.attributes,r=jr(t),n=t.getString("auto_pad","NOTSET"),i=t.getInts("dilations",[1,1]),o=t.getInt("group",1),a=t.getInts("kernel_shape",[]),s=t.getInts("output_padding",[0,0]),u=t.getInts("output_shape",[]),l=t.getInts("pads",[0,0,0,0]),h=t.getInts("strides",[1,1]);return re({autoPad:n,dilations:i,group:o,kernelShape:a,outputPadding:s,outputShape:u,pads:l,strides:h,...r})},Vm=(e,t)=>{if(!e||2!==e.length&&3!==e.length)throw new Error("Conv requires 2 or 3 inputs");if(4!==e[0].dims.length||4!==e[1].dims.length)throw new Error("currently only support 2-dimensional conv");if(e[0].dims[1]!==e[1].dims[0])throw new Error("FILTER_IN_CHANNEL should be equal to DATA_CHANNEL");let r=e[1].dims[1]*t.group;if(3===e.length&&(1!==e[2].dims.length||e[2].dims[0]!==r))throw new Error("invalid bias");let n=e[0].dims.length-2;if(t.dilations.length!==n)throw new Error(`dilations should be ${n}D`);if(t.strides.length!==n)throw new Error(`strides should be ${n}D`);if(t.pads.length!==2*n)throw new Error(`pads should be ${2*n}D`);if(t.outputPadding.length!==n)throw new Error(`output_padding should be ${n}D`);if(0!==t.kernelShape.length&&t.kernelShape.length!==e[1].dims.length-2)throw new Error("invalid kernel shape");if(0!==t.outputShape.length&&t.outputShape.length!==e[0].dims.length-2)throw new Error("invalid output shape");if("float32"!==e[0].type||"float32"!==e[1].type)throw new Error("ConvTranspose input(X,W) should be float tensor");if(3===e.length&&"float32"!==e[2].type)throw new Error("ConvTranspose input(bias) should be float tensor")}})),yf,Er,Tf,Hm,xf,jm,qm,Ym,ho=D((()=>{Me(),fe(),ae(),yf={name:"Transpose",inputNames:["A"],inputTypes:[0]},Er=(e,t,r)=>(Ym(t),[e.run({...yf,cacheHint:r.cacheKey,get:()=>Hm(e,t[0],r.perm)},t)]),Tf=e=>re({perm:e.attributes.getInts("perm",[])}),Hm=(e,t,r)=>{let n=t.dims;r=xf(n,r);let i=jm(n,r),o=n.length,a=`\n      ${qm("perm",r,o)}\n      float process(int indices[${o}]) {\n        int a[${o}];\n        perm(a, indices);\n        return _A(a);\n      }`;return{...yf,output:{dims:i,type:t.type,textureType:0},shaderSource:a}},xf=(e,t)=>(t&&t.length!==e.length&&(t=[...e.keys()].reverse()),t),jm=(e,t)=>(t=xf(e,t),z.sortBasedOnPerm(e,t)),qm=(e,t,r)=>{let n=[];n.push(`void ${e}(out int a[${r}], int src[${r}]) {`);for(let e=0;e<r;++e)n.push(`\ta[${t[e]}]=src[${e}];`);return n.push("\t}"),n.join("\n")},Ym=e=>{if(!e||1!==e.length)throw new Error("Transpose requires 1 input.");if("float32"!==e[0].type&&"float64"!==e[0].type)throw new Error("input should be float tensor")}})),wf,vf,Xm,_f=D((()=>{ho(),wf=(e,t,r)=>{Xm(t);let n=r.blocksize,i=n*n,o="DCR"===r.mode?[0,3,4,1,5,2]:[0,1,4,2,5,3],a="DCR"===r.mode?[t[0].dims[0],n,n,t[0].dims[1]/i,t[0].dims[2],t[0].dims[3]]:[t[0].dims[0],t[0].dims[1]/i,n,n,t[0].dims[2],t[0].dims[3]],s=e.reshapeUnpacked(t[0],a),u={perm:o,cacheKey:`${o}`},[l]=Er(e,[s],u),h=[t[0].dims[0],t[0].dims[1]/i,t[0].dims[2]*n,t[0].dims[3]*n];return[e.reshapeUnpacked(l,h)]},vf=e=>{let t=e.attributes.getInt("blocksize");if(t<1)throw new Error(`blocksize must be >= 1, but got : ${t} for DepthToSpace`);let r=e.attributes.getString("mode","DCR");if("DCR"!==r&&"CRD"!==r)throw new Error(`unrecognized mode: ${r} for DepthToSpace`);return{mode:r,blocksize:t}},Xm=e=>{if(1!==e.length)throw new Error(`DepthToSpace expect 1 inputs, but got ${e.length}`);if("string"===e[0].type||4!==e[0].dims.length)throw new TypeError("DepthToSpace input should be a 4-D numeric tensor")}})),Of,Sf,Km,If=D((()=>{fe(),Of=(e,t,r)=>{Km(t,r);let n=z.flattenShape(t[0].dims,r);return[e.reshapeUnpacked(t[0],n)]},Sf=e=>e.attributes.getInt("axis",1),Km=(e,t)=>{if(!e||1!==e.length)throw new Error("Flatten requires 1 input.");let r=e[0].dims.length;if(0===r)throw new Error("scalar tensor is not supported.");if(t<-r||t>r)throw new Error("Invalid axis");if("string"===e[0].type)throw new Error("string tensor is not supported.")}})),rr,Tn=D((()=>{rr=["float32","float64","int32","int16","int8","uint16","uint32","uint8"]})),Af,Ef,Jm,Zm,Qm,eb,Pf=D((()=>{Me(),Tn(),fe(),ae(),Af=(e,t,r)=>(eb(t,r.axis),[e.run(Qm(e,t,r),t)]),Ef=e=>re({axis:e.attributes.getInt("axis",0)}),Jm={name:"Gather",inputNames:["A","B"],inputTypes:[0,0]},Zm=(e,t,r,n)=>{let i=r[0].dims.slice(),o=r[1].dims.slice(),a=new Array(i.length+o.length-1);n=z.normalizeAxis(n,i.length);let s=[];for(let e=0;e<a.length;e++)e<n?(a[e]=i[e],s.push(`inputIdx[${e}] = outputIdx[${e}];`)):e<n+o.length?(a[e]=o[e-n],s.push(`indexDataIdx[${e-n}] = outputIdx[${e}];`)):(a[e]=i[e-o.length+1],s.push(`inputIdx[${e-o.length+1}] = outputIdx[${e}];`));let u=`\n      float process(int outputIdx[${a.length||1}]) {\n        int inputIdx[${i.length}];\n        int indexDataIdx[${o.length||1}];\n        indexDataIdx[0] = 0;\n        ${s.join("\n        ")}\n        int idx = int(_B(indexDataIdx));\n        inputIdx[${n}] = idx < 0 ? idx + ${i[n]} : idx;\n        return _A(inputIdx);\n      }`;return{...t,output:{dims:a,type:r[0].type,textureType:0},shaderSource:u}},Qm=(e,t,r)=>{let n={...Jm,cacheHint:r.cacheKey};return{...n,get:()=>Zm(e,n,t,r.axis)}},eb=(e,t)=>{if(!e||2!==e.length)throw new Error("Gather requires 2 inputs.");let r=e[0].dims.length;if(r<1)throw new Error("Invalid input shape.");if(t<-r||t>r-1)throw new Error("Invalid axis.");if(-1===rr.indexOf(e[0].type))throw new Error("Invaid input type.");if("int32"!==e[1].type&&"int16"!==e[1].type)throw new Error("Invaid input type.")}})),Ui,Df,Lf,Cf,tb,rb,nb,Ff=D((()=>{Me(),fe(),ae(),Ui=(e,t,r)=>(nb(t,r),[e.run(tb(t,r),t)]),Df=(e,t)=>{let r=0!==e.attributes.getInt("transA",0),n=0!==e.attributes.getInt("transB",0),i=e.attributes.getFloat("alpha",1),o=e.attributes.getFloat("beta",1);return re({transA:r,transB:n,alpha:i,beta:o,isOptionalC:t})},Lf=e=>Df(e,!1),Cf=e=>Df(e,!0),tb=(e,t)=>{let r={name:"Gemm",inputNames:3===e.length?["A","B","C"]:["A","B"],inputTypes:3===e.length?[0,0,0]:[0,0],key:t.cacheKey};return{...r,get:()=>rb(r,e,t)}},rb=(e,t,r)=>{let n=t[0].dims.slice(),i=t[1].dims.slice(),[o,a]=ro.getShapeOfGemmResult(n,r.transA,i,r.transB,3===t.length?t[2].dims:void 0),s=[o,a];if(!s)throw new Error("Can't use gemm on the given tensors");let u=n[n.length-1],l="";r.transA&&(u=n[0]),r.transA&&r.transB?l="value += _A_T(a) * _B_T(b);":r.transA&&!r.transB?l="value += _A_T(a) * _B(b);":!r.transA&&r.transB?l="value += _A(a) * _B_T(b);":!r.transA&&!r.transB&&(l="value += _A(a) * _B(b);");let h=s.length,c=`\n      float process(int indices[${h}]) {\n          int a[${h}];\n          int b[${h}];\n          ${3===t.length?`int c[${t[2].dims.length}];`:""}\n\n          copyVec(indices, a);\n          copyVec(indices, b);\n          ${3===t.length?"bcastIndices_C(indices, c);":""}\n\n          float value = 0.0;\n          for (int k=0; k<${u}; ++k) {\n              a[${h-1}] = k;\n              b[${h-2}] = k;\n              ${l}\n          }\n\n          value = value * alpha;\n          ${3===t.length?"value += beta * _C(c);":""}\n          return value;\n      }`;return{...e,output:{dims:s,type:t[0].type,textureType:0},variables:[{name:"alpha",type:"float",data:r.alpha},{name:"beta",type:"float",data:r.beta}],shaderSource:c}},nb=(e,t)=>{if(!e)throw new Error("Input is missing");if(t.isOptionalC&&(e.length<2||e.length>3))throw new Error("Invaid input shape.");if(!t.isOptionalC&&3!==e.length)throw new Error("Gemm requires 3 inputs");if(3===e.length&&1!==e[2].dims.length&&2!==e[2].dims.length)throw new Error("Invalid input shape of C");if("float32"!==e[0].type&&"float64"!==e[0].type||"float32"!==e[1].type&&"float64"!==e[1].type||3===e.length&&"float32"!==e[2].type&&"float64"!==e[2].type)throw new Error("Invalid input type.");if(e[0].type!==e[1].type||3===e.length&&e[0].type!==e[2].type)throw new Error("Input types are mismatched")}})),Bf,$f,ob,ib,ab,sb,ub,kf=D((()=>{Me(),ae(),Bf=(e,t,r)=>(ub(t),[e.run(ab(e,t,r),t)]),$f=e=>{let t=e.attributes.getFloat("scale"),r=e.attributes.getFloats("bias");return re({scale:t,bias:r})},ob={name:"ImageScaler",inputNames:["X"],inputTypes:[0]},ib=(e,t,r,n)=>{let i=r[0].dims.slice(),o=i.length,a=`\n      ${sb(n.bias.length)}\n      float process(int indices[${o}]) {\n        return _X(indices) * scale + getBias(bias, indices[1]);\n      }`;return{...t,output:{dims:i,type:r[0].type,textureType:0},variables:[{name:"bias",type:"float",arrayLength:n.bias.length,data:n.bias},{name:"scale",type:"float",data:n.scale}],shaderSource:a}},ab=(e,t,r)=>{let n={...ob,cacheHint:r.cacheKey};return{...n,get:()=>ib(e,n,t,r)}},sb=e=>{let t=[`float getBias(float bias[${e}], int channel) {`];for(let r=0;r<e;++r)0===r?t.push(`\tif (channel == ${r}) { return bias[${r}]; }`):r===e-1?t.push(`\telse { return bias[${r}]; }`):t.push(`\telse if (channel == ${r}) { return bias[${r}]; }`);return t.push("\t}"),t.join("\n")},ub=e=>{if(!e||1!==e.length)throw new Error("ImageScaler requires 1 input.");if(4!==e[0].dims.length)throw new Error("Invalid input shape.");if("float32"!==e[0].type&&"float64"!==e[0].type)throw new Error("Invalid input type.")}})),Rf,Mf,Nf,lb,fb,cb,pb,db,hb,Gf=D((()=>{ve(),ae(),Rf=(e,t,r)=>{hb(t);let n=e.run(fb(t[0]),t);return[e.run(db(e,t[0],r,n.dims),[t[0],n,t[1],t[2]])]},Mf=e=>e.attributes.getFloat("epsilon",1e-5),Nf={name:"InstanceNormalization_MeanAndVariance",inputNames:["X"],inputTypes:[0]},lb=(e,t)=>{let r=t.dims.slice(),n=r[1],i=r[2]*r[3],o=[r[0],n],a=`\n      vec4 process(int[2] indices) {\n        vec4 v = vec4(0.0);\n        int a[4];\n        a[0] = indices[0];\n        a[1] = indices[1];\n        float temp = 0.0;\n        for(int a2=0; a2<${r[2]}; a2++) {\n          a[2] = a2;\n          for(int a3=0; a3<${r[3]}; a3++) {\n            a[3] = a3;\n            float x = _X(a);\n            temp += x;\n          }\n        }\n        float mean = temp / float(${i});\n        temp = 0.0;\n        for(int a2=0; a2<${r[2]}; a2++) {\n          a[2] = a2;\n          for(int a3=0; a3<${r[3]}; a3++) {\n            a[3] = a3;\n            float x = _X(a);\n            temp += (x - mean) * (x - mean);\n          }\n        }\n        v.r = mean;\n        v.g = temp / float(${i});\n\n        return v;\n      }`;return{...e,output:{dims:o,type:t.type,textureType:4},shaderSource:a}},fb=e=>({...Nf,get:()=>lb(Nf,e)}),cb={name:"InstanceNormalization_ComputeOutput",inputNames:["X","MeanAndVariance","Scale","B"],inputTypes:[0,4,0,0]},pb=(e,t,r,n,i)=>{let o=Y(e.session.backend.glContext.version),[a,s]=e.calculateTextureWidthAndHeight(i,4),[u,l]=[a/4,s],h=`\n      vec4 get_MeanAndVariance(int[2] mv) {\n        int offset = indicesToOffset_MeanAndVariance(mv);\n        vec2 coords = offsetToCoords(offset, ${u}, ${l});\n        return ${o.texture2D}(MeanAndVariance, coords);\n      }\n\n      float process(int[4] indices) {\n        int mv[2];\n        mv[0] = indices[0];\n        mv[1] = indices[1];\n        vec4 mean_and_variance = get_MeanAndVariance(mv);\n        float mean = mean_and_variance.r;\n        float variance = mean_and_variance.g;\n\n        int sb[1];\n        sb[0] = indices[1];\n        float scale = _Scale(sb);\n        float b = _B(sb);\n\n        return scale * (_X(indices) - mean) / sqrt(variance + epsilon) + b;\n      }`;return{...t,output:{dims:r.dims,type:r.type,textureType:0},variables:[{name:"epsilon",type:"float",data:n}],shaderSource:h}},db=(e,t,r,n)=>{let i={...cb,cacheHint:`${r}`};return{...i,get:()=>pb(e,i,t,r,n)}},hb=e=>{if(!e||3!==e.length)throw new Error("InstanceNormalization requires 3 inputs.");let t=e[0],r=e[1],n=e[2];if(t.dims.length<3||1!==r.dims.length||1!==n.dims.length)throw new Error("Invalid input shape.");if(r.dims[0]!==t.dims[1]||n.dims[0]!==t.dims[1])throw new Error("Input shapes are mismatched.");if("float32"!==t.type&&"float64"!==t.type||"float32"!==r.type&&"float64"!==r.type||"float32"!==n.type&&"float64"!==n.type)throw new Error("Invalid input type.");if(4!==e[0].dims.length)throw new Error("Only support 4-D input shape.")}}));function mb(e,t){let r=e[0].dims[1],n=e[0].dims.length,i=-Math.floor((t.size-1)/2),o=Math.ceil((t.size-1)/2),a=`float(${t.alpha}) / float(${t.size})`,s=`\n    float process(int indices[${n}]) {\n        int c = indices[1];\n        float x = _X(indices);\n        float square_sum = 0.0;\n\n        for (int i = ${i}; i <= ${o}; i++) {\n          int idx = c + i;\n          if (c >= 0 && c < ${r}) {\n            indices[1] = idx;\n            float j = _X(indices);\n            square_sum += j * j;\n          }\n        }\n        return x / pow(${`float(${t.bias})`} + ${a} * square_sum, ${`float(${t.beta})`});\n    }`;return{...Wf,cacheHint:t.cacheKey,output:{dims:e[0].dims,type:e[0].type,textureType:0},shaderSource:s}}function bb(e,t){return{...Wf,cacheHint:t.cacheKey,get:()=>mb(e,t)}}var Uf,zf,Wf,gb,Vf=D((()=>{Me(),ae(),Uf=(e,t,r)=>(gb(t),[e.run(bb(t,r),t)]),zf=e=>{let t=e.attributes.getFloat("alpha",1e-4),r=e.attributes.getFloat("beta",.75),n=e.attributes.getFloat("bias",1),i=e.attributes.getInt("size");return re({alpha:t,beta:r,bias:n,size:i})},Wf={name:"LRN",inputNames:["X"],inputTypes:[0]},gb=e=>{if(!e||1!==e.length)throw new Error("LRN requires 1 input.");if(4!==e[0].dims.length)throw new Error('currently only support LRN for input with "NCHW" format');if("float32"!==e[0].type)throw new Error("input should be float type")}})),yb,zi,Hf,jf,qf,Tb,xb,wb,vb,_b,Ob,Sb,Ib,Yf=D((()=>{Me(),fe(),ve(),ae(),yb={name:"Pad",inputNames:["A"],inputTypes:[0]},zi=(e,t,r)=>(wb(t),[e.run({...yb,cacheHint:r.cacheKey,get:()=>xb(e,t[0],r)},t)]),Hf=e=>{let t=e.attributes.getString("mode","constant"),r=e.attributes.getFloat("value",0),n=e.attributes.getInts("pads");return re({mode:t,value:r,pads:n})},jf=(e,t,r)=>{vb(t);let n=Tb(e,t,r);return zi(e,[t[0]],n)},qf=e=>e.attributes.getString("mode","constant"),Tb=(e,t,r)=>{if(!e.session.isInitializer(t[1].dataId)||t.length>=3&&!e.session.isInitializer(t[2].dataId))throw new Error("dynamic pad attributes are not allowed");let n=Array.from(t[1].integerData),i=t.length>=3?t[2].floatData[0]:0;return re({mode:r,pads:n,value:i})},xb=(e,t,r)=>{let n=z.padShape(t.dims.slice(),r.pads),i=n.length,o=`\n      ${_b(e,t,r)}\n      float process(int[${i}] indices) {\n          return padA(indices);\n      }`;return{name:"Pad",inputNames:["A"],inputTypes:[0],output:{dims:n,type:t.type,textureType:0},shaderSource:o}},wb=e=>{if(!e||1!==e.length)throw new Error("Pad requires 1 input");if("float32"!==e[0].type&&"float64"!==e[0].type)throw new Error("Invalid input type.")},vb=e=>{if(!e||2!==e.length&&3!==e.length)throw new Error("Pad requires 2 or 3 inputs");if("int32"!==e[1].type)throw new Error("Invalid input type.");if(e.length>=3&&"string"===e[2].type)throw new Error("Invalid input type.")},_b=(e,t,r)=>{let n=Y(e.session.backend.glContext.version),[i,o]=e.calculateTextureWidthAndHeight(t.dims,0),a=z.computeStrides(t.dims);switch(r.mode){case"constant":return Ob(n,t.dims,a,i,o,r.pads,r.value);case"reflect":return Sb(n,t.dims,a,i,o,r.pads);case"edge":return Ib(n,t.dims,a,i,o,r.pads);default:throw new Error("Invalid mode")}},Ob=(e,t,r,n,i,o,a)=>{let s=t.length,u="";for(let e=s-1;e>=0;--e)u+=`\n        k = m[${e}] - ${o[e]};\n        if (k < 0)  return constant;\n        if (k >= ${t[e]}) return constant;\n        offset += k * ${r[e]};\n        `;return`\n      float padA(int m[${s}]) {\n        const float constant = float(${a});\n        int offset = 0;\n        int k = 0;\n        ${u}\n        vec2 coords = offsetToCoords(offset, ${n}, ${i});\n        float value = getColorAsFloat(${e.texture2D}(A, coords));\n        return value;\n      }\n      `},Sb=(e,t,r,n,i,o)=>{let a=t.length,s="";for(let e=a-1;e>=0;--e)s+=`\n        k = m[${e}] - ${o[e]};\n        if (k < 0) { k = -k; }\n        {\n          const int _2n_1 = ${2*(t[e]-1)};\n          k = int( mod( float(k), float(_2n_1) ) ) ;\n          if(k >= ${t[e]}) { k = _2n_1 - k; }\n        }\n        offset += k * ${r[e]};\n        `;return`\n      float padA(int m[${a}]) {\n        int offset = 0;\n        int k = 0;\n        ${s}\n        vec2 coords = offsetToCoords(offset, ${n}, ${i});\n        float value = getColorAsFloat(${e.texture2D}(A, coords));\n        return value;\n      }\n      `},Ib=(e,t,r,n,i,o)=>{let a=t.length,s="";for(let e=a-1;e>=0;--e)s+=`\n        k = m[${e}] - ${o[e]};\n        if (k < 0)  k = 0;\n        if (k >= ${t[e]}) k = ${t[e]-1};\n        offset += k * ${r[e]};\n      `;return`\n      float padA(int m[${a}]) {\n        int offset = 0;\n        int k = 0;\n        ${s}\n        vec2 coords = offsetToCoords(offset, ${n}, ${i});\n        float value = getColorAsFloat(${e.texture2D}(A, coords));\n        return value;\n      }\n      `}})),Kf,Jf,Zf,Qf,ec,tc,rc,nc,oc,Ab,Xf,ic,bo,ac,mo,Eb,sc=D((()=>{Me(),fe(),ae(),Kf=(e,t,r)=>{bo(t);let n={name:"AveragePool",inputNames:["X"],inputTypes:[0],cacheHint:r.cacheKey};return[e.run({...n,get:()=>Zf(t,n,!1,r)},t)]},Jf=e=>{let t=e.attributes.getString("auto_pad","NOTSET"),r=e.attributes.getInt("ceil_mode",0),n=0!==e.attributes.getInt("count_include_pad",0),i=e.attributes.getInts("kernel_shape"),o=e.attributes.getInts("strides",[]),a=e.attributes.getInts("pads",[]);if(0!==r)throw new Error("using ceil() in shape computation is not yet supported for AveragePool");return re({autoPad:t,ceilMode:r,countIncludePad:n,kernelShape:i,strides:o,pads:a})},Zf=(e,t,r,n)=>{let[i,o]=oc(e,n,r),a=z.size(i.kernelShape),s="";i.countIncludePad?s+=`value /= float(${a});`:s+=`value /= float(${a} - pad);`;let u=`\n        ${ac(e[0].dims,i,"value += _X(x);",s,"0.0")}\n      `;return{...t,output:{dims:o,type:e[0].type,textureType:0},shaderSource:u}},Qf=(e,t,r)=>{bo(t);let n={name:"GlobalAveragePool",inputNames:["X"],inputTypes:[0],cacheHint:`${r.countIncludePad}`};return[e.run({...n,get:()=>Zf(t,n,!0,r)},t)]},ec=e=>{let t=0!==e.attributes.getInt("count_include_pad",0);return re({autoPad:"",ceilMode:0,countIncludePad:t,kernelShape:[],strides:[],pads:[]})},tc=(e,t,r)=>{bo(t);let n={name:"MaxPool",inputNames:["X"],inputTypes:[0],cacheHint:r.cacheKey};return[e.run({...n,get:()=>nc(t,n,!1,r)},t)]},rc=e=>{let t=e.attributes.getString("auto_pad","NOTSET"),r=e.attributes.getInt("ceil_mode",0),n=e.attributes.getInts("kernel_shape"),i=e.attributes.getInts("strides",[]),o=e.attributes.getInts("pads",[]),a=e.attributes.getInt("storage_order",0),s=e.attributes.getInts("dilations",[]);if(0!==a)throw new Error("column major storage order is not yet supported for MaxPool");if(0!==r)throw new Error("using ceil() in shape computation is not yet supported for MaxPool");return re({autoPad:t,ceilMode:r,countIncludePad:!1,kernelShape:n,strides:i,pads:o,storageOrder:a,dilations:s})},nc=(e,t,r,n)=>{let[i,o]=oc(e,n,r),a=`\n      ${ac(e[0].dims,i,"\n      value = max(_X(x), value);\n    ","","-1e5")}\n    `;return{...t,output:{dims:o,type:e[0].type,textureType:0},shaderSource:a}},oc=(e,t,r)=>{let n=e[0].dims.slice(),i=Object.hasOwnProperty.call(t,"dilations"),o=t.kernelShape.slice(),a=t.strides.slice(),s=i?t.dilations.slice():[],u=t.pads.slice();vr.adjustPoolAttributes(r,n,o,a,s,u);let l=vr.computePoolOutputShape(r,n,a,s,o,u,t.autoPad),h=Object.assign({},t);return i?Object.assign(h,{kernelShape:o,strides:a,pads:u,dilations:s,cacheKey:t.cacheKey}):Object.assign(h,{kernelShape:o,strides:a,pads:u,cacheKey:t.cacheKey}),[h,l]},Ab={autoPad:"",ceilMode:0,countIncludePad:!1,kernelShape:[],strides:[],pads:[],storageOrder:0,dilations:[],cacheKey:""},Xf={name:"GlobalMaxPool",inputNames:["X"],inputTypes:[0]},ic=(e,t)=>(bo(t),[e.run({...Xf,get:()=>nc(t,Xf,!0,Ab)},t)]),bo=e=>{if(!e||1!==e.length)throw new Error("Pool ops requires 1 input.");if("float32"!==e[0].type&&"float64"!==e[0].type)throw new Error("Invalid input type.")},ac=(e,t,r,n,i)=>{let o=e.length;if(t.kernelShape.length<=2){let a=t.kernelShape[t.kernelShape.length-1],s=t.strides[t.strides.length-1],u=t.pads[t.pads.length/2-1],l=t.pads[t.pads.length-1],h=e[o-1],c="",f="",d="";if(c=u+l!==0?`\n          for (int i = 0; i < ${a}; i++) {\n            x[${o} - 1] = indices[${o} - 1] * ${s} - ${u} + i;\n            if (x[${o} - 1] < 0 || x[${o} - 1] >= ${h}) {\n              pad++;\n              continue;\n            }\n            ${r}\n          }`:`\n          for (int i = 0; i < ${a}; i++) {\n            x[${o} - 1] = indices[${o} - 1] * ${s} - ${u} + i;\n            ${r}\n          }`,2===t.kernelShape.length){let r=t.kernelShape[t.kernelShape.length-2],n=t.strides[t.strides.length-2],i=t.pads[t.pads.length/2-2],s=t.pads[t.pads.length-2],u=e[o-2];f=i+s!==0?`\n            for (int j = 0; j < ${r}; j++) {\n              x[${o} - 2] = indices[${o} - 2] * ${n} - ${i} + j;\n              if (x[${o} - 2] < 0 || x[${o} - 2] >= ${u}) {\n                pad+= ${a};\n                continue;\n              }\n          `:`\n            for (int j = 0; j < ${r}; j++) {\n              x[${o} - 2] = indices[${o} - 2] * ${n} - ${i} + j;\n            `,d="\n          }\n        "}return`\n        float process(int indices[${o}]) {\n          int x[${o}];\n          copyVec(indices, x);\n\n          float value = ${i};\n          int pad = 0;\n          ${f}\n          ${c}\n          ${d}\n          ${n}\n          return value;\n        }\n      `}{let a=z.size(t.kernelShape),s=z.computeStrides(t.kernelShape),u=s.length,l=t.pads.length,h=Eb(u),c=mo(e,"inputDims"),f=mo(t.pads,"pads"),d=mo(s,"kernelStrides"),p=mo(t.strides,"strides"),y="";return y=t.pads.reduce(((e,t)=>e+t))?`\n            if (x[j] >= inputDims[j] || x[j] < 0) {\n              pad++;\n              isPad = true;\n              break;\n            }\n          }\n          if (!isPad) {\n            ${r}\n          }`:`\n          }\n          ${r}\n        `,`\n        ${h}\n        float process(int indices[${o}]) {\n          int x[${o}];\n          copyVec(indices, x);\n          int offset[${u}];\n          int pads[${l}];\n          int inputDims[${o}];\n          int kernelStrides[${u}];\n          int strides[${u}];\n          ${f}\n          ${c}\n          ${p}\n          ${d}\n\n          float value = ${i};\n          int pad = 0;\n          bool isPad = false;\n          for (int i = 0; i < ${a}; i++) {\n            offsetToIndices(i, kernelStrides, offset);\n            isPad = false;\n            for (int j = ${o} - ${u}; j < ${o}; j++) {\n              x[j] = indices[j] * strides[j - ${o} + ${u}]\n                + offset[j - ${o} + ${u}] - pads[j - 2];\n              ${y}\n          }\n          ${n}\n\n          return value;\n        }\n      `}},mo=(e,t)=>{let r="";for(let n=0;n<e.length;n++)r+=`\n      ${t}[${n}] = ${e[n]};\n    `;return r},Eb=e=>`\n  void offsetToIndices(int offset, int[${e}] strides, out int[${e}] indices) {\n    if (${e} == 0) {\n      return;\n    }\n    for (int i = 0; i < ${e} - 1; ++i) {\n      indices[i] = offset / strides[i];\n      offset -= indices[i] * strides[i];\n    }\n    indices[${e} - 1] = offset;\n  }`})),Pr,nr,Pb,Db,uc,lc,fc,cc,pc,dc,hc,mc=D((()=>{Me(),Tn(),fe(),ae(),Pr=(e,t,r,n,i)=>{Db(t);let o={name:n,inputNames:["A"],inputTypes:[0]};return[e.run({...o,cacheHint:r.cacheKey,get:()=>Pb(e,t,r,n,i,o)},t)]},nr=e=>{let t=e.attributes.getInts("axes",[]),r=1===e.attributes.getInt("keepdims",1);return re({axes:t,keepDims:r})},Pb=(e,t,r,n,i,o)=>{let a=[],s=t[0].dims.length||1,u=[],l=z.normalizeAxes(r.axes,t[0].dims.length),h=i(t,l),c=h[1];for(let e=0;e<t[0].dims.length;e++)l.indexOf(e)>=0||0===l.length?(r.keepDims&&a.push(1),c=`\n          for(int j${e} = 0; j${e} < ${t[0].dims[e]}; j${e}++) {\n            inputIdx[${e}] = j${e};\n            ${c}\n          }`):(u.push(`inputIdx[${e}] = outputIdx[${a.length}];`),a.push(t[0].dims[e]));let f=`\n      float process(int outputIdx[${a.length||1}]) {\n        float value;                 // final result\n        int inputIdx[${s}];      // addressing input data\n        ${u.join("\n")}\n        ${h[0]}       // init ops for reduce max/min\n        ${c}\n        ${h[2]}       // final computation for reduce mean\n        return value;\n      }`;return{...o,output:{dims:a,type:t[0].type,textureType:0},shaderSource:f}},Db=e=>{if(!e||1!==e.length)throw new Error("Reduce op requires 1 input.");if(-1===rr.indexOf(e[0].type))throw new Error("Invalid input type.")},uc=(e,t,r)=>Pr(e,t,r,"ReduceSum",(()=>["value = 0.0;","value += _A(inputIdx);",""])),lc=(e,t,r)=>Pr(e,t,r,"ReduceMean",((e,t)=>{let r=1;for(let n=0;n<e[0].dims.length;n++)(t.indexOf(n)>=0||0===t.length)&&(r*=e[0].dims[n]);return["value = 0.0;","value += _A(inputIdx);",`value /= ${r}.;`]})),fc=(e,t,r)=>Pr(e,t,r,"ReduceMax",((e,t)=>{let r=[];for(let n=0;n<e[0].dims.length;n++)(t.indexOf(n)>=0||0===t.length)&&r.push(`inputIdx[${n}] = 0;`);return[`${r.join("\n")}\nvalue = _A(inputIdx);`,"value = max(value, _A(inputIdx));",""]})),cc=(e,t,r)=>Pr(e,t,r,"ReduceMin",((e,t)=>{let r=[];for(let n=0;n<e[0].dims.length;n++)(t.indexOf(n)>=0||0===t.length)&&r.push(`inputIdx[${n}] = 0;`);return[`${r.join("\n")}\nvalue = _A(inputIdx);`,"value = min(value, _A(inputIdx));",""]})),pc=(e,t,r)=>Pr(e,t,r,"ReduceProd",(()=>["value = 1.0;","value *= _A(inputIdx);",""])),dc=(e,t,r)=>Pr(e,t,r,"ReduceLogSum",(()=>["value = 0.0;","value += _A(inputIdx);","value = log(value);"])),hc=(e,t,r)=>Pr(e,t,r,"ReduceLogSumSquare",(()=>["float t; value = 0.0;","t = _A(inputIdx); value += t * t;",""]))})),bc,gc=D((()=>{fe(),bc=(e,t)=>{let r=z.calculateReshapedDims(t[0].dims,t[1].integerData);return e.session.pack?[e.reshapePacked(t[0],r)]:[e.reshapeUnpacked(t[0],r)]}})),yc,Wi,Tc,xc,xn,Lb,Vi,go,Hi=D((()=>{Me(),ve(),ae(),yc={name:"Upsample",inputNames:["X"],inputTypes:[0]},Wi=(e,t,r)=>(Vi(t,r),[e.run({...yc,cacheHint:r.cacheKey,get:()=>Lb(e,t,r)},t)]),Tc=e=>xn(e,7),xc=e=>xn(e,9),xn=(e,t)=>{let r=t>=10,n=e.attributes.getString("mode","nearest");if("nearest"!==n&&"linear"!==n&&(t<11||"cubic"!==n))throw new Error(`unrecognized mode: ${n}`);let i=[];t<9&&(i=e.attributes.getFloats("scales"),go(i,n,r));let o=e.attributes.getFloat("extrapolation_value",0),a=t>10?e.attributes.getString("coordinate_transformation_mode","half_pixel"):"asymmetric";if(-1===["asymmetric","pytorch_half_pixel","tf_half_pixel_for_nn","align_corners","tf_crop_and_resize","half_pixel"].indexOf(a))throw new Error(`coordinate_transform_mode '${a}' is not supported`);let s="tf_crop_and_resize"===a,u=s,l="nearest"===n&&t>=11?e.attributes.getString("nearest_mode","round_prefer_floor"):"";if(-1===["round_prefer_floor","round_prefer_ceil","floor","ceil",""].indexOf(l))throw new Error(`nearest_mode '${l}' is not supported`);let h=e.attributes.getFloat("cubic_coeff_a",-.75),c=0!==e.attributes.getInt("exclude_outside",0);if(c&&"cubic"!==n)throw new Error("exclude_outside can be set to 1 only when mode is CUBIC.");let f=t<11||"nearest"===n&&"asymmetric"===a&&"floor"===l,d=0,p=0,y=0;return t>10?e.inputs.length>2?(d=1,p=2,y=3):(p=1,y=2):9===t&&(p=1),re({opset:t,isResize:r,mode:n,scales:i,extrapolationValue:o,coordinateTransformMode:a,useExtrapolation:u,needRoiInput:s,nearestMode:l,cubicCoefficientA:h,excludeOutside:c,useNearest2xOptimization:f,roiInputIdx:d,scalesInputIdx:p,sizesInputIdx:y})},Lb=(e,t,r)=>{let n=Y(e.session.backend.glContext.version),[i,o]=e.calculateTextureWidthAndHeight(t[0].dims,0),a=t[0].dims.map(((e,t)=>Math.floor(e*r.scales[t]))),[s,u]=e.calculateTextureWidthAndHeight(a,0),l=a.length,h=new Array(l),c=new Array(l),f=`\n      int output_pitches[${l}];\n      int input_pitches[${l}];\n      `;for(let e=l-1;e>=0;e--)h[e]=e===l-1?1:h[e+1]*a[e+1],c[e]=e===l-1?1:c[e+1]*t[0].dims[e+1],f+=`\n        output_pitches[${e}] = ${h[e]};\n        input_pitches[${e}] = ${c[e]};\n        `;let d=`\n      float getInputFloat(int index) {\n        vec2 coords = offsetToCoords(index, ${i}, ${o});\n        float value = getColorAsFloat(${n.texture2D}(X, coords));\n        return value;\n      }\n      `,p="nearest"===r.mode?`\n    ${d}\n    float process(int indices[${l}]) {\n      int input_index = 0;\n      int output_index = coordsToOffset(TexCoords, ${s}, ${u});\n\n      ${f}\n\n      int d, m;\n      for (int dim = 0; dim < ${l}; ++dim) {\n        d = output_index / output_pitches[dim];\n        m = output_index - d * output_pitches[dim];\n        output_index = m;\n\n        if (scales[dim] != 1 && d > 0) {\n          int d2 = d / scales[dim];\n          m = d - d2 * scales[dim];\n          d = d2;\n        }\n        input_index += input_pitches[dim] * d;\n      }\n\n      return getInputFloat(input_index);\n    }`:4===l?`\n    ${d}\n    float process(int indices[4]) {\n      int input_index = 0;\n      int output_index = coordsToOffset(TexCoords, ${s}, ${u});\n\n      ${f}\n\n      int m;\n      int index_of_dim0, index_of_dim1, index_of_dim2, index_of_dim3;\n      index_of_dim0 = output_index / output_pitches[0];\n      m = output_index - index_of_dim0 * output_pitches[0];\n      index_of_dim1 = m / output_pitches[1];\n      m = m - index_of_dim1 * output_pitches[1];\n      index_of_dim2 = m / output_pitches[2];\n      m = m - index_of_dim2 * output_pitches[2];\n      index_of_dim3 = m;\n\n      int index_of_input_dim2, index_of_input_dim3, x_offset, y_offset;\n      index_of_input_dim2 = index_of_dim2 / scales[2];\n      y_offset = index_of_dim2 - index_of_input_dim2 * scales[2];\n      index_of_input_dim3 = index_of_dim3 / scales[3];\n      x_offset = index_of_dim3 - index_of_input_dim3 * scales[3];\n\n      input_index = index_of_dim0 * input_pitches[0] +\n            index_of_dim1 * input_pitches[1] +\n            index_of_input_dim2 * input_pitches[2] +\n            index_of_input_dim3;\n\n      float x00 = getInputFloat(input_index);\n      float x10, x01, x11;\n\n      bool end_of_dim2 = false;\n      if (index_of_input_dim2 == (${t[0].dims[2]} - 1)) {\n        // It's the end in dimension 2\n        x01 = x00;\n        end_of_dim2 = true;\n      } else {\n        x01 = getInputFloat(input_index + input_pitches[2]);\n      }\n\n      if (index_of_input_dim3 == (input_pitches[2] - 1)) {\n        // It's the end in dimension 3\n        x10 = x00;\n        x11 = x01;\n      }\n      else {\n        x10 = getInputFloat(input_index + 1);\n        x11 = end_of_dim2 ? x10 : getInputFloat(input_index + input_pitches[2] + 1);\n      }\n\n      float y0 = x00 + float(y_offset) * (x01 - x00) / float(scales[2]);\n      float y1 = x10 + float(y_offset) * (x11 - x10) / float(scales[2]);\n      return y0 + float(x_offset) * (y1 - y0) / float(scales[3]);\n    }`:`\n    ${d}\n    float process(int indices[2]) {\n      int input_index = 0;\n      int output_index = coordsToOffset(TexCoords, ${s}, ${u});\n\n      ${f}\n\n      int m;\n      int index_of_dim0, index_of_dim1;\n      index_of_dim0 = output_index / output_pitches[0];\n      m = output_index - index_of_dim0 * output_pitches[0];\n      index_of_dim1 = m;\n\n      int index_of_input_dim0, index_of_input_dim1, x_offset, y_offset;\n      index_of_input_dim0 = index_of_dim0 / scales[0];\n      y_offset = index_of_dim0 - index_of_input_dim0 * scales[0];\n      index_of_input_dim1 = index_of_dim1 / scales[1];\n      x_offset = index_of_dim1 - index_of_input_dim1 * scales[1];\n\n      input_index = index_of_input_dim0 * input_pitches[0] + index_of_input_dim1;\n\n      float x00 = getInputFloat(input_index);\n      float x10, x01, x11;\n\n      bool end_of_dim0 = false;\n      if (index_of_input_dim0 == (${t[0].dims[0]} - 1)) {\n        // It's the end in dimension 0\n        x01 = x00;\n        end_of_dim0 = true;\n      } else {\n        x01 = getInputFloat(input_index + input_pitches[0]);\n      }\n\n      if (index_of_input_dim1 == (input_pitches[0] - 1)) {\n        // It's the end in dimension 1\n        x10 = x00;\n        x11 = x01;\n      }\n      else {\n        x10 = getInputFloat(input_index + 1);\n        x11 = end_of_dim0 ? x10 : getInputFloat(input_index + input_pitches[0] + 1);\n      }\n\n      float y0 = x00 + float(y_offset) * (x01 - x00) / float(scales[0]);\n      float y1 = x10 + float(y_offset) * (x11 - x10) / float(scales[0]);\n      return y0 + float(x_offset) * (y1 - y0) / float(scales[1]);\n    }`;return{...yc,output:{dims:a,type:t[0].type,textureType:0},shaderSource:p,variables:[{name:"scales",type:"int",arrayLength:r.scales.length,data:r.scales.map((e=>Math.ceil(e)))}]}},Vi=(e,t)=>{if(!e||t.opset<9&&1!==e.length||t.opset>=9&&t.opset<11&&2!==e.length||t.opset>=11&&e.length<2)throw new Error("invalid inputs.");if(t.scales.length>0&&e[0].dims.length!==t.scales.length)throw new Error("Invalid input shape.");if("string"===e[0].type)throw new Error("Invalid input tensor types.")},go=(e,t,r)=>{if(r){for(let t of e)if(t<=0)throw new Error("Scale value should be greater than 0.")}else for(let t of e)if(t<1)throw new Error("Scale value should be greater than or equal to 1.");if(!("linear"!==t&&"cubic"!==t||2===e.length||4===e.length&&1===e[0]&&1===e[1]))throw new Error(`'Linear' mode and 'Cubic' mode only support 2-D inputs ('Bilinear', 'Bicubic')         or 4-D inputs with the corresponding outermost 2 scale values being 1         in the ${r?"Resize":"Upsample"} opeartor.`)}})),ji,qi,wc,vc,Cb,Fb,Bb,$b,_c=D((()=>{ve(),ae(),Rt(),Ir(),Hi(),ji={name:"Resize",inputNames:["A"],inputTypes:[2]},qi=(e,t,r)=>(Vi(t,r),[e.run({...ji,cacheHint:r.cacheKey,get:()=>Cb(e,t,r)},t)]),wc=e=>xn(e,10),vc=e=>xn(e,11),Cb=(e,t,r)=>{let n=Y(e.session.backend.glContext.version),[i,o]=Fb(t,r);if(i.every((e=>1===e))&&"tf_crop_and_resize"!==r.coordinateTransformMode)return{...ji,output:{dims:o,type:t[0].type,textureType:2},hasMain:!0,shaderSource:`void main() {\n                    vec4 v = ${n.texture2D}(X, TexCoords);\n                    ${n.output} = v;\n                }`};let a=o.length;if(a<2)throw new Error(`output dimension should be at least 2, but got ${a}`);let s=o[a-2],u=o[a-1],l=t[0].dims;if(a!==l.length)throw new Error(`output dimension should match input ${l.length}, but got ${a}`);let h=l[a-2],c=l[a-1],f=i[a-2],d=i[a-1],p="";if("linear"!==r.mode)throw new Error(`resize (packed) does not support mode: '${r.mode}'`);switch(r.coordinateTransformMode){case"asymmetric":p="\n                    vec4 getSourceFracIndex(ivec4 coords) {\n                        return vec4(coords) / scaleWHWH;\n                    }\n                ";break;case"half_pixel":p="\n                    vec4 getSourceFracIndex(ivec4 coords) {\n                        return (vec4(coords) + 0.5) / scaleWHWH - 0.5;\n                    }\n                ";break;case"pytorch_half_pixel":p=`\n                    vec4 getSourceFracIndex(ivec4 coords) {\n                        vec4 fcoords = vec4(coords);\n                        return vec4(\n                            ${u}.0 > 1.0 ? (fcoords.x + 0.5) / scaleWHWH.x - 0.5 : 0.0,\n                            ${s}.0 > 1.0 ? (fcoords.y + 0.5) / scaleWHWH.y - 0.5 : 0.0,\n                            ${u}.0 > 1.0 ? (fcoords.z + 0.5) / scaleWHWH.z - 0.5 : 0.0,\n                            ${s}.0 > 1.0 ? (fcoords.w + 0.5) / scaleWHWH.w - 0.5 : 0.0\n                          );\n                    }\n                `;break;case"align_corners":p=`\n                    vec4 getSourceFracIndex(ivec4 coords) {\n                        vec4 resized = vec4(${u}.0 - 1.0, ${s}.0 - 1.0, ${u}.0 - 1.0,\n                            ${s}.0 - 1.0);\n                        vec4 original = vec4(${c}.0 - 1.0, ${h}.0 - 1.0, ${c}.0 - 1.0,\n                            ${h}.0 - 1.0);\n                        vec4 new_scale = original / resized;\n                        return vec4(coords) * new_scale;\n                    }\n                `;break;default:throw new Error(`resize (packed) does not support coordinateTransformMode:                                 '${r.coordinateTransformMode}'`)}let y=Ke(a),m=`\n            const vec2 inputWH = vec2(${h}.0, ${c}.0);\n            const vec4 scaleWHWH = vec4(float(${f}), float(${d}), float(${f}), float(${d}));\n            ${Mt()}\n            ${p}\n            float getAValue(int x10, int r, int c, int d) {\n                return getChannel(getA(x10, r, c, d), vec2(c, d));\n            }\n            void main() {\n                ${y} rc = getOutputCoords();\n\n                int batch = rc[0];\n                int depth = rc[1];\n\n                // retrieve the 4 coordinates that is used in the 4 packed output values.\n                ivec4 coords = ivec4(rc.wz, rc.w + 1, rc.z + 1);\n\n                // calculate the source index in fraction\n                vec4 sourceFrac = getSourceFracIndex(coords);\n\n                // get the lower and upper bound of the 4 values that will be packed into one texel.\n                ivec4 x00 = ivec4(max(sourceFrac.xy, vec2(0.0)), min(inputWH - 1.0, ceil(sourceFrac.xy)));\n                ivec4 x01 = ivec4(max(sourceFrac.xw, vec2(0.0)), min(inputWH - 1.0, ceil(sourceFrac.xw)));\n                ivec4 x10 = ivec4(max(sourceFrac.zy, vec2(0.0)), min(inputWH - 1.0, ceil(sourceFrac.zy)));\n                ivec4 x11 = ivec4(max(sourceFrac.zw, vec2(0.0)), min(inputWH - 1.0, ceil(sourceFrac.zw)));\n\n                bool hasNextRow = rc.w < ${s-1};\n                bool hasNextCol = rc.z < ${u-1};\n\n                // pack x00, x01, x10, x11's top-left corner into one vec4 structure\n                vec4 topLeft = vec4(\n                    getAValue(batch, depth, x00.x, x00.y),\n                    hasNextCol ? getAValue(batch, depth, x01.x, x01.y) : 0.0,\n                    hasNextRow ? getAValue(batch, depth, x10.x, x10.y) : 0.0,\n                    (hasNextRow && hasNextCol) ? getAValue(batch, depth, x11.x, x11.y) : 0.0);\n\n                // pack x00, x01, x10, x11's top-right corner into one vec4 structure\n                vec4 topRight = vec4(\n                    getAValue(batch, depth, x00.x, x00.w),\n                    hasNextCol ? getAValue(batch, depth, x01.x, x01.w) : 0.0,\n                    hasNextRow ? getAValue(batch, depth, x10.x, x10.w) : 0.0,\n                    (hasNextRow && hasNextCol) ? getAValue(batch, depth, x11.x, x11.w) : 0.0);\n\n                // pack x00, x01, x10, x11's bottom-left corner into one vec4 structure\n                vec4 bottomLeft = vec4(\n                    getAValue(batch, depth, x00.z, x00.y),\n                    hasNextCol ? getAValue(batch, depth, x01.z, x01.y) : 0.0,\n                    hasNextRow ? getAValue(batch, depth, x10.z, x10.y) : 0.0,\n                    (hasNextRow && hasNextCol) ? getAValue(batch, depth, x11.z, x11.y) : 0.0);\n\n                // pack x00, x01, x10, x11's bottom-right corner into one vec4 structure\n                vec4 bottomRight = vec4(\n                    getAValue(batch, depth, x00.z, x00.w),\n                    hasNextCol ? getAValue(batch, depth, x01.z, x01.w) : 0.0,\n                    hasNextRow ? getAValue(batch, depth, x10.z, x10.w) : 0.0,\n                    (hasNextRow && hasNextCol) ? getAValue(batch, depth, x11.z, x11.w) : 0.0);\n\n                // calculate the interpolation fraction on u and v direction\n                vec4 frac = vec4(sourceFrac) - floor(sourceFrac);\n                vec4 clampFrac = clamp(frac, vec4(0.0), vec4(1.0));\n\n                vec4 top = mix(topLeft, topRight, clampFrac.ywyw);\n                vec4 bottom = mix(bottomLeft, bottomRight, clampFrac.ywyw);\n                vec4 newValue = mix(top, bottom, clampFrac.xxzz);\n\n                ${n.output} = vec4(newValue);\n            }\n        `;return{...ji,output:{dims:o,type:t[0].type,textureType:2},hasMain:!0,shaderSource:m}},Fb=(e,t)=>{let r,n=e[0].dims,i=t.scales;if(0===i.length){let o=e[t.scalesInputIdx];if(o&&0!==o.size){if(e[t.sizesInputIdx])throw new Error("Only one of scales or sizes must be provided as input.");i=Bb(o,t.mode,t.isResize)}else{let o=e[t.sizesInputIdx];if(!o||0===o.size)throw new Error("Either scales or sizes MUST be provided as input.");r=Array.from(o.integerData),i=$b(r,n,t.mode,t.isResize)}}else if(e[t.sizesInputIdx])throw new Error("Only one of scales or sizes must be provided as input.");let o=r||n.map(((e,t)=>Math.floor(e*i[t])));return[i,o]},Bb=(e,t,r)=>{let n=Array.from(e.floatData);return go(n,t,r),n},$b=(e,t,r,n)=>{let i=t.length,o=new Array(i);for(let r=0,n=i;r<n;r++)if(0===t[r]){if(0!==e[r])throw new Error("Input dim is zero but required output dim is non-zero.");o[r]=1}else o[r]=e[r]/t[r];return go(o,r,n),o}})),Oc,kb,Sc=D((()=>{Sr(),Oc=(e,t)=>(kb(t),[new Be([t[0].dims.length],"int32",void 0,void 0,new Int32Array(t[0].dims))]),kb=e=>{if(!e||1!==e.length)throw new Error("Shape requires 1 input.")}})),Yi,Ic,Ac,Ec,Nb,Pc,Rb,Mb,Dc=D((()=>{Me(),Tn(),fe(),ae(),Yi={name:"Slice",inputNames:["A"],inputTypes:[0]},Ic=(e,t,r)=>(Nb(t),[e.run({...Yi,cacheHint:r.cacheKey,get:()=>Ec(e,t[0],r)},t)]),Ac=e=>{let t=e.attributes.getInts("starts"),r=e.attributes.getInts("ends"),n=e.attributes.getInts("axes",[]);return re({starts:t,ends:r,axes:n})},Ec=(e,t,r)=>{let n=0===r.axes.length?t.dims.slice(0).map(((e,t)=>t)):r.axes,i=z.normalizeAxes(n,t.dims.length),o=r.starts.map(((e,r)=>e>t.dims[i[r]]-1?t.dims[i[r]]:z.normalizeAxis(e,t.dims[i[r]]))),a=r.ends.map(((e,r)=>e>t.dims[i[r]]-1?t.dims[i[r]]:z.normalizeAxis(e,t.dims[i[r]]))),s=t.dims.slice(),u=[];for(let e=0;e<i.length;e++)s[i[e]]=a[e]-o[e],o[e]>0&&u.push(`outputIdx[${i[e]}] += ${o[e]};`);let l=`\n      float process(int outputIdx[${s.length}]) {\n        ${u.join("\n      ")}\n        return _A(outputIdx);\n      }`;return{...Yi,output:{dims:s,type:t.type,textureType:0},shaderSource:l}},Nb=e=>{if(!e||1!==e.length)throw new Error("Slice requires 1 input.");if(-1===rr.indexOf(e[0].type))throw new Error("Invalid input type.")},Pc=(e,t)=>{Mb(t);let r=Rb(e,t);return[e.run({...Yi,cacheHint:r.cacheKey,get:()=>Ec(e,t[0],r)},[t[0]])]},Rb=(e,t)=>{if(!e.session.isInitializer(t[1].dataId)||!e.session.isInitializer(t[2].dataId)||t.length>=4&&!e.session.isInitializer(t[3].dataId)||t.length>=5&&!e.session.isInitializer(t[4].dataId))throw new Error("dynamic slice attributes are not allowed");if(t.length>=5&&t[4].integerData.some((e=>1!==e)))throw new Error("currently non-1 steps is not supported for Slice");let r=Array.from(t[1].integerData),n=Array.from(t[2].integerData),i=t.length>=4?Array.from(t[3].integerData):[];return{starts:r,ends:n,axes:i,cacheKey:`${i};${r};${n}`}},Mb=e=>{if(!e||e.length<3||e.length>5)throw new Error("Invalid input number.");if("int32"!==e[1].type||1!==e[1].dims.length)throw new Error("Invalid input type.");if("int32"!==e[2].type||1!==e[2].dims.length)throw new Error("Invalid input type.");if(e.length>=4&&("int32"!==e[3].type||1!==e[3].dims.length))throw new Error("Invalid input type.");if(e.length>=5&&("int32"!==e[4].type||1!==e[4].dims.length))throw new Error("Invalid input type.")}})),Lc,Cc,Fc,Bc,$c,kc,Nc,Rc,Gb,Ub,zb,Mc,Gc=D((()=>{Me(),fe(),ve(),ae(),ho(),Lc={name:"SoftmaxComputeMax",inputNames:["A"],inputTypes:[0]},Cc={name:"SoftmaxComputeScale",inputNames:["A","Max"],inputTypes:[0,0]},Fc={name:"SoftMax",inputNames:["A","Max","Norm"],inputTypes:[0,0,0]},Bc=(e,t,r)=>{Mc(t);let n=t[0].dims.slice(),i=z.normalizeAxis(r.axis,n.length),o=z.sizeToDimension(n,i),a=z.sizeFromDimension(n,i);return Rc(e,t,r,o,a)},$c=e=>re({axis:e.attributes.getInt("axis",1)}),kc=e=>re({axis:e.attributes.getInt("axis",-1)}),Nc=(e,t,r)=>{Mc(t);let n,i=t[0].dims.slice(),o=z.normalizeAxis(r.axis,i.length),a=i.length,s=o!==a-1,u=[],l=[],h=[];s&&(l=Array.from({length:a}).map(((e,t)=>t)),l[o]=a-1,l[a-1]=o,l.map((e=>u.push(i[e]))),n=re({perm:l}),h=Er(e,t,n));let c=s?z.sizeToDimension(u,a-1):z.sizeToDimension(i,a-1),f=s?z.sizeFromDimension(u,a-1):z.sizeFromDimension(i,a-1),d=Rc(e,s?h:t,r,c,f);return s?Er(e,d,n):d},Rc=(e,t,r,n,i)=>{let o=Gb(e,t[0],n,i,[n]),a=e.run({...Lc,cacheHint:r.cacheKey,get:()=>o},t),s=Ub(e,t[0],n,i,o.output.dims,[n]),u=e.run({...Cc,cacheHint:r.cacheKey,get:()=>s},[t[0],a]),l=zb(e,t[0],n,i,o.output.dims,s.output.dims);return[e.run({...Fc,cacheHint:r.cacheKey,get:()=>l},[t[0],a,u])]},Gb=(e,t,r,n,i)=>{let[o,a]=e.calculateTextureWidthAndHeight(t.dims,0),s=i.length;if(r<1||n<1)throw new Error("Logical row count N and feature count D must be greater than or equal to 1");if(1!==i.length)throw new Error("Dimensionality of the output should be 1");if(i[0]!==r)throw new Error("Shape of the output should be equal to logical row count");let u=Y(e.session.backend.glContext.version),l=`\n      float process(int[${s}] indices) {\n        int logical_row_start_offset = indices[0] * ${n};\n\n        float max = getColorAsFloat(${u.texture2D}(A, offsetToCoords(logical_row_start_offset, ${o},\n        ${a} )));\n        for(int i=1; i<${n}; ++i)\n        {\n          float current = getColorAsFloat(${u.texture2D}(A, offsetToCoords(logical_row_start_offset + i,\n            ${o}, ${a})));\n          if(current > max)\n          max = current;\n        }\n\n        return max;\n      }`;return{...Lc,output:{dims:i,type:t.type,textureType:0},shaderSource:l}},Ub=(e,t,r,n,i,o)=>{let[a,s]=e.calculateTextureWidthAndHeight(t.dims,0),u=o.length;if(r<1||n<1)throw new Error("Logical row count N and feature count D must be greater than or equal to 1");if(1!==o.length)throw new Error("Dimensionality of the output should be 1");if(o[0]!==r)throw new Error("Shape of the output should be equal to logical row count");if(1!==i.length)throw new Error("Dimensionality of the intermediate results should be 1");if(i[0]!==r)throw new Error("Shape of the intermediate results should be equal to logical row count");let l=`\n      float process(int[${u}] indices) {\n        int logical_row_start_offset = indices[0] * ${n};\n\n        float norm_factor = 0.0;\n        float max = _Max(indices);\n        for(int i=0; i<${n}; ++i)\n        {\n          norm_factor += exp(getColorAsFloat(${Y(e.session.backend.glContext.version).texture2D}(A, offsetToCoords(logical_row_start_offset + i,\n            ${a}, ${s}))) - max);\n        }\n\n        return norm_factor;\n      }`;return{...Cc,output:{dims:o,type:t.type,textureType:0},shaderSource:l}},zb=(e,t,r,n,i,o)=>{let[a,s]=e.calculateTextureWidthAndHeight(t.dims,0),u=t.dims.length;if(r<1||n<1)throw new Error("Logical row count N and feature count D must be greater than or equal to 1");if(1!==i.length||1!==o.length)throw new Error("Dimensionality of the intermediate results should be 1");if(i[0]!==r||o[0]!==r)throw new Error("Shape of the intermediate results should be equal to logical row count");let l=`\n      float process(int[${u}] indices) {\n\n      // get offset of current logical tensor index from the 2-D texture coordinates (TexCoords)\n      int offset = coordsToOffset(TexCoords, ${a}, ${s});\n\n      //determine the logical row for this index\n      int logical_row_index[1];\n      logical_row_index[0] = offset / ${n};\n\n      float norm_factor = _Norm(logical_row_index);\n\n      // avoid possible division by 0\n      // if norm_facor is 0, all elements are zero\n      // if so, return 0\n      if(norm_factor == 0.0)\n        return 0.0;\n\n      return exp(_A(indices) - _Max(logical_row_index)) / norm_factor;\n    }`;return{...Fc,output:{dims:t.dims,type:t.type,textureType:0},shaderSource:l}},Mc=e=>{if(!e||1!==e.length)throw new Error("Softmax requires 1 input.");if("float32"!==e[0].type&&"float64"!==e[0].type)throw new Error("Invalid input type")}})),Uc,zc,Wc,Wb,Vb,Hb,Vc=D((()=>{Me(),fe(),ae(),Uc={name:"Split",inputNames:["A"],inputTypes:[0]},zc=(e,t,r)=>{Hb(t);let n=z.normalizeAxis(r.axis,t[0].dims.length),i=Wb(e,t,n,r),o=[];for(let a=0;a<i;++a)o.push(e.run({...Uc,cacheHint:`${r.cacheKey};${a}`,get:()=>Vb(e,t[0],r,n,a)},t));return o},Wc=e=>{let t=e.attributes.getInt("axis",0),r=e.attributes.getInts("split",[]),n=e.outputs.length;return re({axis:t,split:r,numOutputs:n})},Wb=(e,t,r,n)=>{let[,i]=dn.splitShape(t[0].dims,r,n.split,n.numOutputs);return i.length},Vb=(e,t,r,n,i)=>{let[o,a]=dn.splitShape(t.dims,n,r.split,r.numOutputs),s=a[i],u=o[i],l=`\n      float process(int indices[${u.length}]) {\n        indices[${n}] += ${s};\n        return _A(indices);\n      }\n    `;return{...Uc,cacheHint:`${r.cacheKey}:${i}`,output:{dims:u,type:t.type,textureType:0},shaderSource:l}},Hb=e=>{if(!e||1!==e.length)throw new Error("Split requires one input.");if("int8"!==e[0].type&&"uint8"!==e[0].type&&"int16"!==e[0].type&&"uint16"!==e[0].type&&"int32"!==e[0].type&&"uint32"!==e[0].type&&"float32"!==e[0].type&&"float64"!==e[0].type&&"bool"!==e[0].type)throw new Error("Invalid input type.")}})),Xi,Hc,jc,jb,qb,qc=D((()=>{fe(),Xi=(e,t,r)=>{jb(t);let n=z.squeezeShape(t[0].dims,r);return[e.reshapeUnpacked(t[0],n)]},Hc=(e,t)=>(qb(t),Xi(e,[t[0]],Array.from(t[1].integerData))),jc=e=>e.attributes.getInts("axes"),jb=e=>{if(!e||1!==e.length)throw new Error("Squeeze requires 1 input.");if("string"===e[0].type)throw new Error("invalid input tensor types.")},qb=e=>{if(!e||2!==e.length)throw new Error("Squeeze requires 2 inputs.");if("int32"!==e[1].type)throw new Error("Invalid input type.")}})),Yc,Yb,Xb,Xc=D((()=>{ve(),ae(),Yc=(e,t)=>{Xb(t);let r={name:"Sum",inputNames:t.map(((e,t)=>`X${t}`)),inputTypes:new Array(t.length).fill(0)};return[e.run({...r,get:()=>Yb(e,t,r)},t)]},Yb=(e,t,r)=>{let n=Y(e.session.backend.glContext.version),i=t[0].dims.slice(),o=`\n      void main() {\n        vec4 result = ${t.map(((e,t)=>`${n.texture2D}(X${t},TexCoords)`)).join(" + ")};\n        ${n.output} = result;\n      }\n    `;return{...r,output:{dims:i,type:t[0].type,textureType:0},hasMain:!0,shaderSource:o}},Xb=e=>{if(!e||0===e.length)throw new Error("Sum requires inputs.");let t=e[0].dims.length;for(let r=1;r<e.length;r++){if(t!==e[r].dims.length)throw new Error("Input shapes are mismatched.");for(let n=0;n<t;n++)if(e[0].dims[n]!==e[r].dims[n])throw new Error("Input shapes are not matched.")}if("float32"!==e[0].type&&"float64"!==e[0].type)throw new Error("Invalid input type.");for(let t=1;t<e.length;t++)if(e[0].type!==e[t].type)throw new Error("Input types are not matched.")}})),Kc,Kb,Jb,Jc=D((()=>{Tn(),ae(),Kc=(e,t)=>{Jb(t);let r={name:"Tile",inputNames:["A"],inputTypes:[0]};return[e.run({...r,get:()=>Kb(e,t,r)},t)]},Kb=(e,t,r)=>{let n=t[0].dims.slice(),i=new Array(n.length),o=[];for(let e=0;e<n.length;e++)i[e]=n[e]*t[1].numberData[e],o.push(`inputIdx[${e}] = int(mod(float(outputIdx[${e}]), ${n[e]}.));`);let a=i.length,s=`\n      float process(int outputIdx[${a}]) {\n        int inputIdx[${a}];\n        ${o.join("\n")}\n        return _A(inputIdx);\n      }\n    `;return{...r,output:{dims:i,type:t[0].type,textureType:0},shaderSource:s}},Jb=e=>{if(!e||2!==e.length)throw new Error("Tile requires 2 input.");if(1!==e[1].dims.length)throw new Error("The second input shape must 1 dimension.");if(e[1].dims[0]!==e[0].dims.length)throw new Error("Invalid input shape.");if(-1===rr.indexOf(e[0].type))throw new Error("Invalid input type.");if("int32"!==e[1].type&&"int16"!==e[1].type)throw new Error("Invalid repeat type.")}})),Ki,Zc,Qc,Zb,Qb,ep=D((()=>{fe(),Ki=(e,t,r)=>{Zb(t);let n=z.unsqueezeShape(t[0].dims,r);return[e.reshapeUnpacked(t[0],n)]},Zc=(e,t)=>(Qb(t),Ki(e,[t[0]],Array.from(t[1].integerData))),Qc=e=>e.attributes.getInts("axes"),Zb=e=>{if(!e||1!==e.length)throw new Error("Unsqueeze requires 1 input.");if("string"===e[0].type)throw new Error("invalid input tensor types.")},Qb=e=>{if(!e||2!==e.length)throw new Error("Unsqueeze requires 2 inputs.");if("int32"!==e[1].type)throw new Error("Invalid input type.")}})),tp,rp=D((()=>{cl(),Ol(),Al(),Fl(),fo(),gf(),_f(),If(),Pf(),Ff(),kf(),Gf(),Vf(),co(),Yf(),sc(),mc(),gc(),_c(),Sc(),Dc(),Gc(),Vc(),qc(),Xc(),Jc(),ho(),Fi(),ep(),Hi(),tp=[["Abs","","6+",Bl],["Acos","","7+",$l],["Add","","7+",pl],["And","","7+",dl],["Asin","","7+",kl],["Atan","","7+",Nl],["AveragePool","","7+",Kf,Jf],["BatchNormalization","","7+",ll,fl],["Cast","","6+",Sl,Il],["Ceil","","6+",Gl],["Clip","","6-10",Li,Rl],["Clip","","11+",Ml],["Concat","","4+",Dl,Cl],["Conv","","1+",Mi,Gi],["ConvTranspose","","1+",mf,bf],["Cos","","7+",Ul],["Div","","7+",hl],["Dropout","","7+",Ci],["DepthToSpace","","1+",wf,vf],["Equal","","7+",ml],["Elu","","6+",zl,Wl],["Exp","","6+",Vl],["Flatten","","1+",Of,Sf],["Floor","","6+",Hl],["FusedConv","com.microsoft","1+",Mi,Gi],["Gather","","1+",Af,Ef],["Gemm","","7-10",Ui,Lf],["Gemm","","11+",Ui,Cf],["GlobalAveragePool","","1+",Qf,ec],["GlobalMaxPool","","1+",ic],["Greater","","7+",bl],["Identity","","1+",Ci],["ImageScaler","","1+",Bf,$f],["InstanceNormalization","","6+",Rf,Mf],["LeakyRelu","","6+",jl,ql],["Less","","7+",gl],["LRN","","1+",Uf,zf],["Log","","6+",Yl],["MatMul","","1+",uf,lf],["MaxPool","","1+",tc,rc],["Mul","","7+",yl],["Neg","","6+",Xl],["Not","","1+",Kl],["Or","","7+",Tl],["Pad","","2-10",zi,Hf],["Pad","","11+",jf,qf],["Pow","","7+",xl],["PRelu","","7+",wl],["ReduceLogSum","","1+",dc,nr],["ReduceMax","","1+",fc,nr],["ReduceMean","","1+",lc,nr],["ReduceMin","","1+",cc,nr],["ReduceProd","","1+",pc,nr],["ReduceSum","","1-12",uc,nr],["ReduceSumSquare","","1+",hc,nr],["Relu","","6+",Jl],["Reshape","","5+",bc],["Resize","","10",qi,wc],["Resize","","11+",qi,vc],["Shape","","1+",Oc],["Sigmoid","","6+",Zl],["Sin","","7+",Ql],["Slice","","10+",Pc],["Slice","","1-9",Ic,Ac],["Softmax","","1-12",Bc,$c],["Softmax","","13+",Nc,kc],["Split","","2-12",zc,Wc],["Sqrt","","6+",ef],["Squeeze","","1-12",Xi,jc],["Squeeze","","13+",Hc],["Sub","","7+",vl],["Sum","","6+",Yc],["Tan","","7+",tf],["Tanh","","6+",rf],["Tile","","6+",Kc],["Transpose","","1+",Er,Tf],["Upsample","","7-8",Wi,Tc],["Upsample","","9",Wi,xc],["Unsqueeze","","1-12",Ki,Qc],["Unsqueeze","","13+",Zc],["Xor","","7+",_l]]}));function op(e){let t,r={};for(;null!==(t=np.exec(e));){let e=t[3].split(",").map((e=>{let t=e.trim().split(" ");return t&&2===t.length?{type:t[0],name:t[1]}:null})).filter((e=>null!==e));r[t[2]]={params:e,body:t[4]}}for(let n in r){let i=eg.replace("__FUNC__",n),o=new RegExp(i,"gm");for(;null!==(t=o.exec(e));){let i=t[1],o=t[2],a=t[3].split(","),s=i?`${i} ${o};`:"",u=r[n].body,l="";r[n].params.forEach(((e,t)=>{e&&(l+=`${e.type} ${e.name} = ${a[t]};\n`)})),u=`${l}\n ${u}`,u=u.replace("return",`${o} = `);let h=`\n      ${s}\n      {\n        ${u}\n      }\n      `;e=e.replace(t[0],h)}}return e=e.replace(np,"")}var np,eg,ip=D((()=>{np=/@inline[\s\n\r]+(\w+)[\s\n\r]+([0-9a-zA-Z_]+)\s*\(([^)]*)\)\s*{(([^}]|[\n\r])*)}/gm,eg="(\\w+)?\\s+([_0-9a-zA-Z]+)\\s+=\\s+__FUNC__\\((.*)\\)\\s*;"}));function Yr(e,t){let r=[],n=[],i=null!=t&&Array.isArray(t)&&0===t.length,o=null==t||i?null:tg(t,e).sort(),a=0;for(let t=0;t<e.length;++t){if(null!=o){if(o[a]===t&&1!==e[t])throw new Error(`Can't squeeze axis ${t} since its dim '${e[t]}' is not 1`);(null==o[a]||o[a]>t)&&1===e[t]&&(r.push(e[t]),n.push(t)),o[a]<=t&&a++}1!==e[t]&&(r.push(e[t]),n.push(t))}return{newShape:r,keptDims:n}}function tg(e,t){let r=t.length;return zr((e=null==e?t.map(((e,t)=>t)):[].concat(e)).every((e=>e>=-r&&e<r)),(()=>`All values in axis param must be in range [-${r}, ${r}) but got axis ${e}`)),zr(e.every(rg),(()=>`All values in axis param must be integers but got axis ${e}`)),e.map((e=>e<0?r+e:e))}function rg(e){return e%1==0}function ng(e){if(0===e.length)return 1;let t=e[0];for(let r=1;r<e.length;r++)t*=e[r];return t}function ap(e){let t=Math.ceil(Math.sqrt(e));return[t,Math.ceil(e/t)]}var yo,Ji=D((()=>{pt(),fe(),yo=class{constructor(e){this.maxTextureSize=e}computeTextureWH(e,t){let r=this.computeTexture(e,t);return t&&t.isPacked&&(r[0]/=2,r[1]/=2),t&&t.reverseWH?[r[1],r[0]]:r}computeTexture(e,t){let r=t&&t.isPacked;if(0===e.length)return r?[2,2]:[1,1];let n=this.maxTextureSize;if(t&&void 0!==t.breakAxis){let r=t.breakAxis>=e.length?1:e.slice(t.breakAxis).reduce(((e,t)=>e*t)),i=t.breakAxis<=0?1:e.slice(0,t.breakAxis).reduce(((e,t)=>e*t));if(!(r>n||i>n))return[r,i];pe.verbose("TextureLayout",`Given width/height preferences were unattainable: shape:${e}, breakAxis:${t.breakAxis}`)}let i=e.slice(0);r&&(n*=2,i=i.map(((e,t)=>t>=i.length-2?i[t]%2==0?i[t]:i[t]+1:i[t])),1===i.length&&(i=[2,i[0]])),2!==i.length&&(i=Yr(i).newShape);let o=ng(i);return i.length<=1&&o<=n?[1,o]:2===i.length&&i[0]<=n&&i[1]<=n?i:3===i.length&&i[0]*i[1]<=n&&i[2]<=n?[i[0]*i[1],i[2]]:3===i.length&&i[0]<=n&&i[1]*i[2]<=n?[i[0],i[1]*i[2]]:4===i.length&&i[0]*i[1]*i[2]<=n&&i[3]<=n?[i[0]*i[1]*i[2],i[3]]:4===i.length&&i[0]<=n&&i[1]*i[2]*i[3]<=n?[i[0],i[1]*i[2]*i[3]]:r?ap(o/4).map((e=>2*e)):ap(o)}}})),To,sp=D((()=>{fe(),Xt(),ve(),Ji(),Rt(),To=class extends bt{constructor(e){super(e)}getFunctions(){return{...this.offsetToCoords(),...this.coordsToOffset(),...this.toVec(),...this.valueFrom(),...this.getCommonUtilFuncs(),...this.getInputsSamplingSnippets(),...this.getOutputSamplingSnippet()}}getCustomTypes(){return{}}offsetToCoords(){return{offsetToCoords:new G("\n      vec2 offsetToCoords(int offset, int width, int height) {\n        int t = offset / width;\n        int s = offset - t*width;\n        vec2 coords = (vec2(s,t) + vec2(0.5,0.5)) / vec2(width, height);\n        return coords;\n      }\n      ")}}coordsToOffset(){return{coordsToOffset:new G("\n      int coordsToOffset(vec2 coords, int width, int height) {\n        float s = coords.s * float(width);\n        float t = coords.t * float(height);\n        int offset = int(t) * width + int(s);\n        return offset;\n      }\n      ")}}getOutputSamplingSnippet(){let e=this.context.outputTextureLayout;return e.isPacked?this.getPackedOutputSamplingSnippet(e):this.getUnpackedOutputSamplingSnippet(e)}getPackedOutputSamplingSnippet(e){let t=e.unpackedShape,r=[e.width,e.height],n={},i="getOutputCoords";switch(t.length){case 0:n[i]=this.getOutputScalarCoords();break;case 1:n[i]=this.getOutputPacked1DCoords(t,r);break;case 2:n[i]=this.getOutputPacked2DCoords(t,r);break;case 3:n[i]=this.getOutputPacked3DCoords(t,r);break;default:n[i]=this.getOutputPackedNDCoords(t,r)}let o=`\n      void setOutput(vec4 val) {\n        ${Y(this.context.glContext.version).output} = val;\n      }\n    `;return n.floatTextureSetRGBA=new G(o),n}getUnpackedOutputSamplingSnippet(e){let t=e.unpackedShape,r=[e.width,e.height],n={},i="getOutputCoords";switch(t.length){case 0:n[i]=this.getOutputScalarCoords();break;case 1:n[i]=this.getOutputUnpacked1DCoords(t,r);break;case 2:n[i]=this.getOutputUnpacked2DCoords(t,r);break;case 3:n[i]=this.getOutputUnpacked3DCoords(t,r);break;case 4:n[i]=this.getOutputUnpacked4DCoords(t,r);break;case 5:n[i]=this.getOutputUnpacked5DCoords(t,r);break;case 6:n[i]=this.getOutputUnpacked6DCoords(t,r);break;default:throw new Error(`Unsupported output dimensionality: ${t.length}`)}let o=`\n        void setOutput(float val) {\n          ${Y(this.context.glContext.version).output} = vec4(val, 0, 0, 0);\n        }\n    `;return n.floatTextureSetR=new G(o),n}getOutputScalarCoords(){return new G("\n      int getOutputCoords() {\n        return 0;\n      }\n    ")}getOutputPacked1DCoords(e,t){let r=t,n="";return 1===r[0]?(n=`\n          int getOutputCoords() {\n            return 2 * int(TexCoords.y * ${r[1]}.0);\n          }\n        `,new G(n)):1===r[1]?(n=`\n          int getOutputCoords() {\n            return 2 * int(TexCoords.x * ${r[0]}.0);\n          }\n        `,new G(n)):(n=`\n        int getOutputCoords() {\n          ivec2 resTexRC = ivec2(TexCoords.xy *\n                                 vec2(${r[0]}, ${r[1]}));\n          return 2 * (resTexRC.y * ${r[0]} + resTexRC.x);\n        }\n      `,new G(n))}getOutputPacked2DCoords(e,t){let r="";if(wr.arraysEqual(e,t))return r=`\n        ivec2 getOutputCoords() {\n          return 2 * ivec2(TexCoords.xy * vec2(${t[0]}, ${t[1]}));\n        }\n      `,new G(r);let n=t,i=Math.ceil(e[1]/2);return r=`\n        ivec2 getOutputCoords() {\n          ivec2 resTexRC = ivec2(TexCoords.xy *\n                                vec2(${n[0]}, ${n[1]}));\n\n          int index = resTexRC.y * ${n[0]} + resTexRC.x;\n\n          // reverse r and c order for packed texture\n          int r = imod(index, ${i}) * 2;\n          int c = 2 * (index / ${i});\n\n          return ivec2(r, c);\n        }\n      `,new G(r)}getOutputPacked3DCoords(e,t){let r=[t[0],t[1]],n=Math.ceil(e[2]/2),i=n*Math.ceil(e[1]/2);return new G(`\n        ivec3 getOutputCoords() {\n          ivec2 resTexRC = ivec2(TexCoords.xy *\n                                vec2(${r[0]}, ${r[1]}));\n          int index = resTexRC.y * ${r[0]} + resTexRC.x;\n\n          int b = index / ${i};\n          index -= b * ${i};\n\n          // reverse r and c order for packed texture\n          int r = imod(index, ${n}) * 2;\n          int c = 2 * (index / ${n});\n\n          return ivec3(b, r, c);\n        }\n      `)}getOutputPackedNDCoords(e,t){let r=[t[0],t[1]],n=Math.ceil(e[e.length-1]/2),i=n*Math.ceil(e[e.length-2]/2),o=i,a="",s="b, r, c";for(let t=2;t<e.length-1;t++)o*=e[e.length-t-1],a=`\n      int b${t} = index / ${o};\n      index -= b${t} * ${o};\n    `+a,s=`b${t}, `+s;let u=`\n      ivec${e.length} getOutputCoords() {\n        ivec2 resTexRC = ivec2(TexCoords.xy *\n                              vec2(${r[0]}, ${r[1]}));\n        int index = resTexRC.y * ${r[0]} + resTexRC.x;\n\n        ${a}\n\n        int b = index / ${i};\n        index -= b * ${i};\n\n        // reverse r and c order for packed texture\n        int r = imod(index, ${n}) * 2;\n        int c = 2 * (index / ${n});\n\n        return ivec${e.length}(${s});\n      }\n    `;return new G(u)}getOutputUnpacked1DCoords(e,t){let r=`\n        int getOutputCoords() {\n          ivec2 resTexRC = ivec2(TexCoords.xy *\n                                vec2(${t[0]}, ${t[1]}));\n          return resTexRC.y * ${t[0]} + resTexRC.x;\n        }\n      `;return new G(r)}getOutputUnpacked2DCoords(e,t){let r=`\n        ivec2 getOutputCoords() {\n          ivec2 resTexRC = ivec2(TexCoords.xy *\n                                vec2(${t[0]}, ${t[1]}));\n          int index = resTexRC.y * ${t[0]} + resTexRC.x;\n          int r = index / ${e[1]};\n          int c = index - r * ${e[1]};\n          return ivec2(r, c);\n        }\n      `;return new G(r)}getOutputUnpacked3DCoords(e,t){let r="",n=e.length,i=null;n<2&&(i=[]),i=new Array(n-1),i[n-2]=e[n-1];for(let t=n-3;t>=0;--t)i[t]=i[t+1]*e[t+1];let o=["r","c","d"],a=i.map(((e,t)=>`${`int ${o[t]} = index / ${e}`}; ${t===i.length-1?`int ${o[t+1]} = index - ${o[t]} * ${e}`:`index -= ${o[t]} * ${e}`};`)).join("");return r=`\n        ivec3 getOutputCoords() {\n          ivec2 resTexRC = ivec2(TexCoords.xy *\n                                vec2(${t[0]}, ${t[1]}));\n          int index = resTexRC.y * ${t[0]} + resTexRC.x;\n          ${a}\n          return ivec3(r, c, d);\n        }\n      `,new G(r)}getOutputUnpacked4DCoords(e,t){let r="",n=e.length,i=null;n<2&&(i=[]),i=new Array(n-1),i[n-2]=e[n-1];for(let t=n-3;t>=0;--t)i[t]=i[t+1]*e[t+1];let o=["r","c","d","d2"],a=i.map(((e,t)=>`${`int ${o[t]} = index / ${e}`}; ${t===i.length-1?`int ${o[t+1]} = index - ${o[t]} * ${e}`:`index -= ${o[t]} * ${e}`};`)).join("");return r=`\n      ivec4 getOutputCoords() {\n          ivec2 resTexRC = ivec2(TexCoords.xy *\n                                vec2(${t[0]}, ${t[1]}));\n          int index = resTexRC.y * ${t[0]} + resTexRC.x;\n          ${a}\n          return ivec4(r, c, d, d2);\n        }\n      `,new G(r)}getOutputUnpacked5DCoords(e,t){let r="",n=e.length,i=null;n<2&&(i=[]),i=new Array(n-1),i[n-2]=e[n-1];for(let t=n-3;t>=0;--t)i[t]=i[t+1]*e[t+1];let o=["r","c","d","d2","d3"],a=i.map(((e,t)=>`${`int ${o[t]} = index / ${e}`}; ${t===i.length-1?`int ${o[t+1]} = index - ${o[t]} * ${e}`:`index -= ${o[t]} * ${e}`};`)).join("");return r=`\n      ivec5 getOutputCoords() {\n          ivec2 resTexRC = ivec2(TexCoords.xy *\n                                vec2(${t[0]}, ${t[1]}));\n          int index = resTexRC.y * ${t[0]} + resTexRC.x;\n          ${a}\n          return ivec5(r, c, d, d2, d3);\n        }\n      `,new G(r)}getOutputUnpacked6DCoords(e,t){let r="",n=e.length,i=null;n<2&&(i=[]),i=new Array(n-1),i[n-2]=e[n-1];for(let t=n-3;t>=0;--t)i[t]=i[t+1]*e[t+1];let o=["r","c","d","d2","d3","d4"],a=i.map(((e,t)=>`${`int ${o[t]} = index / ${e}`}; ${t===i.length-1?`int ${o[t+1]} = index - ${o[t]} * ${e}`:`index -= ${o[t]} * ${e}`};`)).join("");return r=`\n     ivec6 getOutputCoords() {\n         ivec2 resTexRC = ivec2(TexCoords.xy *\n                               vec2(${t[0]}, ${t[1]}));\n         int index = resTexRC.y * ${t[0]} + resTexRC.x;\n         ${a}\n         return ivec6(r, c, d, d2, d3, d4);\n       }\n     `,new G(r)}getCommonUtilFuncs(){let e={},t="uvFromFlat";e[t]=new G("\n    vec2 uvFromFlat(int texNumR, int texNumC, int index) {\n      int texC = index / texNumR;\n      int texR = index - texC * texNumR;\n      // TODO: swap texR, texC order in following function so row is corresponding to u and column is corresponding to\n      //       v.\n      return (vec2(texR, texC) + halfCR) / vec2(texNumR, texNumC);\n    }\n    "),t="packedUVfrom1D",e[t]=new G("\n      vec2 packedUVfrom1D(int texNumR, int texNumC, int index) {\n        int texelIndex = index / 2;\n        int texR = texelIndex / texNumC;\n        int texC = texelIndex - texR * texNumC;\n        return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n      }\n      "),t="packedUVfrom2D",e[t]=new G("\n      vec2 packedUVfrom2D(int texNumR, int texNumC, int texelsInLogicalRow, int row, int col) {\n        int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);\n        int texR = texelIndex / texNumC;\n        int texC = texelIndex - texR * texNumC;\n        return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n      }\n      "),t="packedUVfrom3D",e[t]=new G("\n      vec2 packedUVfrom3D(int texNumR, int texNumC,\n          int texelsInBatch, int texelsInLogicalRow, int b,\n          int row, int col) {\n        int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);\n        int texR = index / texNumC;\n        int texC = index - texR * texNumC;\n        return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n      }\n      "),t="sampleTexture";let r=Y(this.context.glContext.version);return e[t]=new G(`\n        float sampleTexture(sampler2D textureSampler, vec2 uv) {\n            return ${r.texture2D}(textureSampler, uv).r;\n        }`),e}getInputsSamplingSnippets(){let e={},t=this.context.outputTextureLayout;return this.context.programInfo.inputNames.forEach(((r,n)=>{let i=this.context.inputTextureLayouts[n],o=no(r);i.isPacked?e[o]=this.getPackedSamplerFromInput(o,r,i):e[o]=this.getUnpackedSamplerFromInput(o,r,i);let a=qu(r);i.unpackedShape.length<=t.unpackedShape.length&&(i.isPacked?e[a]=this.getPackedSamplerAtOutputCoords(a,i,t,r):e[a]=this.getUnpackedSamplerAtOutputCoords(a,i,t,r))})),e}getPackedSamplerAtOutputCoords(e,t,r,n){let i,o=t.unpackedShape,a=r.unpackedShape,s=no(n),u=o.length,l=a.length,h=Xe.getBroadcastDims(o,a),c=Ke(l),f=l-u,d=Et();i=0===u?"":l<2&&h.length>=1?"coords = 0;":h.map((e=>`coords.${d[e+f]} = 0;`)).join("\n");let p="";p=l<2&&u>0?"coords":o.map(((e,t)=>`coords.${d[t+f]}`)).join(", ");let y="return outputValue;",m=1===z.size(o),g=1===z.size(a);if(1!==u||m||g){if(m&&!g)y=1===l?"\n          return vec4(outputValue.x, outputValue.x, 0., 0.);\n        ":"\n          return vec4(outputValue.x);\n        ";else if(h.length){let e=u-2,t=u-1;h.indexOf(e)>-1&&h.indexOf(t)>-1?y="return vec4(outputValue.x);":h.indexOf(e)>-1?y="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":h.indexOf(t)>-1&&(y="return vec4(outputValue.xx, outputValue.zz);")}}else y="\n        return vec4(outputValue.xy, outputValue.xy);\n      ";let w=`\n        int lastDim = coords.${d[l-1]};\n        coords.${d[l-1]} = coords.${d[l-2]};\n        coords.${d[l-2]} = lastDim;\n      `;return new G(`\n      vec4 ${e}() {\n        ${c} coords = getOutputCoords();\n        ${w}\n        ${i}\n        vec4 outputValue = ${s}(${p});\n        ${y}\n      }\n    `,["coordinates.getOutputCoords"])}getUnpackedSamplerAtOutputCoords(e,t,r,n){let i=[r.width,r.height],o=[t.width,t.height],a=t.unpackedShape.length,s=r.unpackedShape.length,u=t.unpackedShape,l=r.unpackedShape,h=no(n);if(a===s&&wr.arraysEqual(o,i)){return new G(`\n          float ${e}() {\n            return sampleTexture(${n}, TexCoords);\n          }\n        `,["coordinates.sampleTexture"])}let c,f=Ke(s),d=Xe.getBroadcastDims(u,l),p=s-a,y=Et();c=0===a?"":s<2&&d.length>=1?"coords = 0;":d.map((e=>`coords.${y[e+p]} = 0;`)).join("\n");let m="";return m=s<2&&a>0?"coords":t.unpackedShape.map(((e,t)=>`coords.${y[t+p]}`)).join(", "),new G(`\n        float ${e}() {\n          ${f} coords = getOutputCoords();\n          ${c}\n          return ${h}(${m});\n        }\n      `,["coordinates.getOutputCoords"])}getPackedSamplerFromInput(e,t,r){switch(r.unpackedShape.length){case 0:return this.getPackedSamplerScalar(e,t);case 1:return this.getPackedSampler1D(e,t,r);case 2:return this.getPackedSampler2D(e,t,r);case 3:return this.getPackedSampler3D(e,t,r);default:return this.getPackedSamplerND(e,t,r)}}getUnpackedSamplerFromInput(e,t,r){let n=r.unpackedShape;switch(n.length){case 0:return this.getUnpackedSamplerScalar(e,t,r);case 1:return this.getUnpackedSampler1D(e,t,r);case 2:return this.getUnpackedSampler2D(e,t,r);case 3:return this.getUnpackedSampler3D(e,t,r);case 4:return this.getUnpackedSampler4D(e,t,r);case 5:return this.getUnpackedSampler5D(e,t,r);case 6:return this.getUnpackedSampler6D(e,t,r);default:throw new Error(`Unsupported dimension ${n.length}-D`)}}getPackedSamplerScalar(e,t){let r=`\n          vec4 ${e}() {\n            return ${Y(this.context.glContext.version).texture2D}(${t}, halfCR);\n          }\n        `;return new G(r)}getPackedSampler1D(e,t,r){let n=[r.width,r.height],i=[n[1],n[0]],o=Y(this.context.glContext.version),a=`vec4 ${e}(int index) {\n      vec2 uv = packedUVfrom1D(\n      ${i[0]}, ${i[1]}, index);\n      return ${o.texture2D}(${t}, uv);\n    }`;return new G(a,["coordinates.packedUVfrom1D"])}getPackedSampler2D(e,t,r){let n=r.unpackedShape,i=[r.width,r.height],o=Y(this.context.glContext.version),a=i[0],s=i[1];if(null!=i&&wr.arraysEqual(n,i)){let r=`vec4 ${e}(int row, int col) {\n        vec2 uv = (vec2(col, row) + halfCR) / vec2(${s}.0, ${a}.0);\n        return ${o.texture2D}(${t}, uv);\n      }`;return new G(r)}let u=i,l=Math.ceil(n[1]/2),h=`vec4 ${e}(int row, int col) {\n      vec2 uv = packedUVfrom2D(${u[1]}, ${u[0]}, ${l}, row, col);\n      return ${o.texture2D}(${t}, uv);\n    }`;return new G(h,["coordinates.packedUVfrom2D"])}getPackedSampler3D(e,t,r){let n=r.unpackedShape,i=[r.width,r.height],o=[i[0],i[1]],a=Y(this.context.glContext.version);if(1===n[0]){let i=n.slice(1),o=[1,2],a=Wr(n,i),s=["b","row","col"],u=JSON.parse(JSON.stringify(r));u.unpackedShape=a;let l=this.getPackedSamplerFromInput(e,t,u),h=`${l.routineBody}\n      vec4 ${e}(int b, int row, int col) {\n        return ${e}(${Vr(s,o)});\n      } `;return new G(h,l.dependencies)}let s=o[0],u=o[1],l=Math.ceil(n[2]/2),h=`vec4 ${e}(int b, int row, int col) {\n      vec2 uv = packedUVfrom3D(\n        ${u}, ${s}, ${l*Math.ceil(n[1]/2)}, ${l}, b, row, col);\n      return ${a.texture2D}(${t}, uv);}`;return new G(h,["coordinates.packedUVfrom3D"])}getPackedSamplerND(e,t,r){let n=r.unpackedShape,i=n.length,o=[r.width,r.height],a=Y(this.context.glContext.version),s=[o[0],o[1]],u=s[1],l=s[0],h=Math.ceil(n[i-1]/2),c=h*Math.ceil(n[i-2]/2),f="int b, int row, int col",d=`b * ${c} + (row / 2) * ${h} + (col / 2)`;for(let e=2;e<i-1;e++)f=`int b${e}, `+f,c*=n[i-e-1],d=`b${e} * ${c} + `+d;let p=`vec4 ${e}(${f}) {\n      int index = ${d};\n      int texR = index / ${l};\n      int texC = index - texR * ${l};\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${l}, ${u});\n      return ${a.texture2D}(${t}, uv);\n    }`;return new G(p)}getUnpackedSamplerScalar(e,t,r){let[n,i]=[r.width,r.height];if(1===n&&1===i){return new G(`\n          float ${e}() {\n            return sampleTexture(${t}, halfCR);\n          }\n        `,["coordinates.sampleTexture"])}return new G(`\n        float ${e}() {\n          int offset_${t} = coordsToOffset(TexCoords, ${n}, ${i});\n          vec2 uv = uvFromFlat(${n}, ${i}, offset_${t});\n          return sampleTexture(${t}, uv);\n        }\n      `,["coordinates.uvFromFlat","coordinates.sampleTexture","coordinates.coordsToOffset"])}getUnpackedSampler1D(e,t,r){let n=r.width,i=r.height;if(1===i&&1===n){return new G(`\n        float ${e}(int index) {\n          return sampleTexture(${t}, halfCR);\n        }\n      `,["coordinates.sampleTexture"])}if(1===i){return new G(`\n          float ${e}(int index) {\n            vec2 uv = vec2((float(index) + 0.5) / ${n}.0, 0.5);\n            return sampleTexture(${t}, uv);\n          }\n        `,["coordinates.sampleTexture"])}if(1===n){return new G(`\n          float ${e}(int index) {\n            vec2 uv = vec2(0.5, (float(index) + 0.5) / ${i}.0);\n            return sampleTexture(${t}, uv);\n          }\n        `,["coordinates.sampleTexture"])}return new G(`\n        float ${e}(int index) {\n          vec2 uv = uvFromFlat(${n}, ${i}, index);\n          return sampleTexture(${t}, uv);\n        }\n      `,["coordinates.uvFromFlat","coordinates.sampleTexture"])}getUnpackedSampler2D(e,t,r){let n=r.unpackedShape,i=[r.height,r.width];if(null!=i&&wr.arraysEqual(n,i)){return new G(`\n          float ${e}(int row, int col) {\n            vec2 uv = (vec2(row, col) + halfCR) / vec2(${i[1]}.0, ${i[0]}.0);\n            return sampleTexture(${t}, uv);\n          }\n        `,["coordinates.sampleTexture"])}let{newShape:o,keptDims:a}=Yr(n),s=o;if(s.length<n.length){let i=Wr(n,s),o=JSON.parse(JSON.stringify(r));o.unpackedShape=i;let u=["col","row"],l=`\n          ${this.getUnpackedSamplerFromInput(e,t,o).routineBody}\n          float ${e}(int row, int col) {\n            return ${e}(${Vr(u,a)});\n          }\n        `;return new G(l,["coordinates.sampleTexture"])}let u=i[1],l=i[0];if(1===l){let r=`\n          float ${e}(int row, int col) {\n            int offset_${t} = coordsToOffset(TexCoords, ${u}, ${l});\n            float index = dot(vec3(row, col, offset_${t}), vec3(${n[1]}, 1, 1));\n            vec2 uv = vec2(0.5, (index + 0.5) / ${u}.0);\n            return sampleTexture(${t}, uv);\n          }\n        `;return new G(r,["coordinates.sampleTexture","coordinates.coordsToOffset"])}if(1===u){let r=`\n          float ${e}(int row, int col) {\n            int offset_${t} = coordsToOffset(TexCoords, ${u}, ${l});\n            float index = dot(vec3(row, col, offset_${t}), vec3(${n[1]}, 1, 1));\n            vec2 uv = vec2((index + 0.5) / ${l}.0, 0.5);\n            return sampleTexture(${t}, uv);\n          }\n        `;return new G(r,["coordinates.sampleTexture","coordinates.coordsToOffset"])}let h=`\n        float ${e}(int row, int col) {\n          int index = col * ${n[1]} + row;\n          vec2 uv = uvFromFlat(${u}, ${l}, index);\n          return sampleTexture(${t}, uv);\n        }\n      `;return new G(h,["coordinates.uvFromFlat","coordinates.sampleTexture","coordinates.coordsToOffset"])}getUnpackedSampler3D(e,t,r){let n=r.unpackedShape,i=n[1]*n[2],o=n[2],{newShape:a,keptDims:s}=Yr(n),u=a;if(u.length<n.length){let i=Wr(n,u),o=["batch","col","row"],a=JSON.parse(JSON.stringify(r));a.unpackedShape=i;let l=this.getUnpackedSamplerFromInput(e,t,a),h=s.reverse(),c=`\n          ${l.routineBody}\n          float ${e}(int batch, int row, int col) {\n            return ${e}(${Vr(o,h)});\n          }\n        `;return new G(c,l.dependencies)}let l=r.width,h=r.height;return new G(`\n          float ${e}(int depth, int row, int col) {\n            // Explicitly use integer operations as dot() only works on floats.\n            int index = depth * ${i} + col * ${o} + row;\n            vec2 uv = uvFromFlat(${l}, ${h}, index);\n            return sampleTexture(${t}, uv);\n          }\n      `,["coordinates.uvFromFlat","coordinates.sampleTexture","coordinates.coordsToOffset"])}getUnpackedSampler4D(e,t,r){let n=r.unpackedShape,i=n[3],o=n[2]*i,a=n[1]*o,s=r.width,u=r.height;return new G(`\n        float ${e}(int row, int col, int depth, int depth2) {\n          int index = row * ${a} + col * ${o} +\n              depth2 * ${i} + depth;\n          vec2 uv = uvFromFlat(${s}, ${u}, index);\n          return sampleTexture(${t}, uv);\n        }\n      `,["coordinates.uvFromFlat","coordinates.sampleTexture"])}getUnpackedSampler5D(e,t,r){let n=r.unpackedShape,i=n[4],o=n[3]*i,a=n[2]*o,s=n[1]*a,{newShape:u,keptDims:l}=Yr(n);if(u.length<n.length){let i=Wr(n,u),o=["row","col","depth","depth2","depth3"],a=JSON.parse(JSON.stringify(r));a.unpackedShape=i;let s=`\n          ${this.getUnpackedSamplerFromInput(e,t,a).routineBody}\n          float ${e}(int row, int col, int depth, int depth2, int depth3) {\n            return ${e}(${Vr(o,l)});\n          }\n        `;return new G(s,["coordinates.sampleTexture","coordinates.uvFromFlat"])}let h=r.width,c=r.height;return new G(`\n        float ${e}(int row, int col, int depth, int depth2, int depth3) {\n          int index = row * ${s} + col * ${a} + depth * ${o} +\n          depth3 * ${i} + depth2;\n          vec2 uv = uvFromFlat(${h}, ${c}, index);\n          return sampleTexture(${t}, uv);\n        }\n      `,["coordinates.sampleTexture","coordinates.uvFromFlat"])}getUnpackedSampler6D(e,t,r){let n=r.unpackedShape,i=n[5],o=n[4]*i,a=n[3]*o,s=n[2]*a,u=n[1]*s,{newShape:l,keptDims:h}=Yr(n);if(l.length<n.length){let i=Wr(n,l),o=["row","col","depth","depth2","depth3","depth4"],a=JSON.parse(JSON.stringify(r));a.unpackedShape=i;let s=`\n            ${this.getUnpackedSamplerFromInput(e,t,a).routineBody}\n            float ${e}(int row, int col, int depth,\n              int depth2, int depth3, int depth4) {\n              return ${e}(${Vr(o,h)});\n            }\n          `;return new G(s,["coordinates.sampleTexture","coordinates.uvFromFlat"])}let c=r.width,f=r.height;return new G(`\n          float ${e}(int row, int col, int depth,\n            int depth2, int depth3, int depth4) {\n            int index = row * ${u} + col * ${s} + depth * ${a} +\n            depth2 * ${o} + depth3 * ${i} + depth4;\n            vec2 uv = uvFromFlat(${c}, ${f}, index);\n            return sampleTexture(${t}, uv);\n          }\n        `,["coordinates.uvFromFlat","coordinates.sampleTexture","coordinates.coordsToOffset"])}toVec(){let e=this.context.outputTextureLayout,t=e.shape.length,r=e.strides,n=e.width,i=e.height,o=[];for(let e=0;e<t-1;++e)o.push(`\n        c[${e}] = offset / ${r[e]};`),o.push(`\n        offset -= c[${e}] * ${r[e]};`);o.push(`\n        c[${t-1}] = offset;`);let a=`\n      void toVec(vec2 texCoords, out int c[${t}]) {\n        int offset = coordsToOffset(texCoords, ${n}, ${i});\n        ${o.join("")}\n      }\n      void toVec(int offset, out int c[${t}]) {\n        ${o.join("")}\n      }\n    `;return{toVec:new G(a,["coordinates.coordsToOffset"])}}valueFrom(){let e={};return this.context.programInfo.inputNames.forEach(((t,r)=>{let n=this.context.inputTextureLayouts[r],i=(n.unpackedShape.length>0?n.unpackedShape:n.shape).length,o=`_${t}`;e[o]=new G(this.getValueFromSingle(t,i,n.width,n.height,!1),[`shapeUtils.indicesToOffset${o}`,"coordinates.offsetToCoords","fragcolor.getColorAsFloat"]),o+="_T",e[o]=new G(this.getValueFromSingle(t,i,n.width,n.height,!0),[`shapeUtils.indicesToOffset${o}`,"coordinates.offsetToCoords","fragcolor.getColorAsFloat"])})),e}getValueFromSingle(e,t,r,n,i){let o=`_${e}`;return i&&(o+="_T"),`\n        float ${o}(int m[${t}]) {\n          int offset = indicesToOffset${o}(m);\n          vec2 coords = offsetToCoords(offset, ${r}, ${n});\n          float value = getColorAsFloat(${Y(this.context.glContext.version).texture2D}(${e}, coords));\n          return value;\n        }\n        `}getPackedValueFrom(e,t,r,n,i){let o=`_${e}_Pack`;return i&&(o+="_T"),`\n        vec4 ${o}(int m[${t}]) {\n          int offset = indicesToOffset_${e}(m);\n          vec2 coords = offsetToCoords(offset, ${r}, ${n});\n          return ${Y(this.context.glContext.version).texture2D}(${e}, coords);\n        }\n        `}}})),xo,up=D((()=>{Xt(),xo=class e extends bt{constructor(e){super(e)}getFunctions(){return{...this.encodeFloat32(),...this.decodeFloat32()}}getCustomTypes(){return{}}encodeFloat32(){return{encode:new G("highp vec4 encode(highp float f) {\n        return vec4(f, 0.0, 0.0, 0.0);\n      }\n        ")}}decodeFloat32(){return{decode:new G("highp float decode(highp vec4 rgba) {\n        return rgba.r;\n      }\n        ")}}encodeUint8(){let t=e.isLittleEndian()?"rgba.rgba=rgba.abgr;":"";return{encode:new G(`\n      highp vec4 encode(highp float f) {\n        highp float F = abs(f);\n        highp float Sign = step(0.0,-f);\n        highp float Exponent = floor(log2(F));\n        highp float Mantissa = (exp2(- Exponent) * F);\n        Exponent = floor(log2(F) + 127.0) + floor(log2(Mantissa));\n        highp vec4 rgba;\n        rgba[0] = 128.0 * Sign  + floor(Exponent*exp2(-1.0));\n        rgba[1] = 128.0 * mod(Exponent,2.0) + mod(floor(Mantissa*128.0),128.0);\n        rgba[2] = floor(mod(floor(Mantissa*exp2(23.0 -8.0)),exp2(8.0)));\n        rgba[3] = floor(exp2(23.0)*mod(Mantissa,exp2(-15.0)));\n        ${t}\n        rgba = rgba / 255.0; // values need to be normalized to [0,1]\n        return rgba;\n    }\n        `)}}decodeUint8(){let t=e.isLittleEndian()?"rgba.rgba=rgba.abgr;":"";return{decode:new G(`\n        highp float decode(highp vec4 rgba) {\n          rgba = rgba * 255.0; // values need to be de-normalized from [0,1] to [0,255]\n          ${t}\n          highp float Sign = 1.0 - step(128.0,rgba[0])*2.0;\n          highp float Exponent = 2.0 * mod(rgba[0],128.0) + step(128.0,rgba[1]) - 127.0;\n          highp float Mantissa = mod(rgba[1],128.0)*65536.0 + rgba[2]*256.0 +rgba[3] + float(0x800000);\n          highp float Result =  Sign * exp2(Exponent) * (Mantissa * exp2(-23.0 ));\n          return Result;\n      }\n        `)}}static isLittleEndian(){let e=new ArrayBuffer(4),t=new Uint32Array(e),r=new Uint8Array(e);if(t[0]=3735928559,239===r[0])return!0;if(222===r[0])return!1;throw new Error("unknown endianness")}}})),wo,lp=D((()=>{Xt(),ve(),wo=class extends bt{constructor(e){super(e)}getFunctions(){return{...this.setFragColor(),...this.getColorAsFloat()}}getCustomTypes(){return{}}setFragColor(){let e=Y(this.context.glContext.version);return{setFragColor:new G(`\n        void setFragColor(float value) {\n            ${e.output} = encode(value);\n        }\n        `,["encoding.encode"])}}getColorAsFloat(){return{getColorAsFloat:new G("\n        float getColorAsFloat(vec4 color) {\n            return decode(color);\n        }\n        ",["encoding.decode"])}}}})),vo,fp=D((()=>{Xt(),vo=class e extends bt{constructor(e){super(e)}getFunctions(){return{...this.bcastIndex(),...this.bcastMatmulIndex(),...this.offsetToIndices(),...this.indicesToOffset(),...this.incrementIndices()}}getCustomTypes(){return{}}bcastIndex(){let e=this.context.outputTextureLayout.shape.length,t={};return this.context.programInfo.inputNames.forEach(((r,n)=>{let i=this.context.inputTextureLayouts[n].unpackedShape;if(i.length<=e){let n=i.length,o=e-n,a=`bcastIndices_${r}`,s="";for(let e=0;e<n;++e)s+=`\n          realIndices[${e}] = int( mod(float(bcastedIndices[${o+e}]), ${i[e]}.0) );\n          `;let u=`\n        void ${a} (int bcastedIndices[${e}], out int realIndices[${n}]) {\n          ${s}\n        }\n        `;t[a]=new G(u)}})),t}bcastMatmulIndex(){let e=this.context.outputTextureLayout.shape.length,t={};return this.context.programInfo.inputNames.forEach(((r,n)=>{let i=this.context.inputTextureLayouts[n].shape;if(!(i.length<2||i.length>e)){let n=i.length,o=e-n,a=`bcastMatmulIndices_${r}`,s="";for(let e=0;e<n-2;++e)s+=`\n          realIndices[${e}] = int( mod(float(bcastedIndices[${o+e}]), ${i[e]}.0) );\n          `;let u=`\n        void ${a}(int bcastedIndices[${e}], out int realIndices[${n}]) {\n          ${s}\n          realIndices[${n-1}] = bcastedIndices[${e-1}];\n          realIndices[${n-2}] = bcastedIndices[${e-2}];\n        }\n        `;t[a]=new G(u)}})),t}indicesToOffset(){let t={};return this.context.programInfo.inputNames.forEach(((r,n)=>{let i=this.context.inputTextureLayouts[n].shape,o=this.context.inputTextureLayouts[n].strides,a=i.length,s=`indicesToOffset_${r}`;t[s]=new G(e.indexToOffsetSingle(s,a,o)),s=`indicesToOffset_${r}_T`,t[s]=new G(e.indexToOffsetSingle(s,a,o.slice().reverse()))})),t}static indexToOffsetSingle(e,t,r){let n="";for(let e=t-1;e>=0;--e)n+=`\n        offset += indices[${e}] * ${r[e]};\n        `;return`\n      int ${e}(int indices[${t}]) {\n        int offset = 0;\n        ${n}\n        return offset;\n      }\n      `}offsetToIndices(){let t={};return this.context.programInfo.inputNames.forEach(((r,n)=>{let i=this.context.inputTextureLayouts[n].shape,o=this.context.inputTextureLayouts[n].strides,a=i.length,s=`offsetToIndices_${r}`;t[s]=new G(e.offsetToIndicesSingle(s,a,o)),s=`offsetToIndices_${r}_T`,t[s]=new G(e.offsetToIndicesSingle(s,a,o.slice().reverse()))})),t}static offsetToIndicesSingle(e,t,r){let n=[];for(let e=0;e<t-1;++e)n.push(`\n      indices[${e}] = offset / ${r[e]};`),n.push(`\n        offset -= indices[${e}] * ${r[e]};`);return n.push(`\n      indices[${t-1}] = offset;`),`\n      void ${e}(int offset, out int indices[${t}]) {\n        ${n.join("")}\n      }\n      `}incrementIndices(){let e={};return this.context.programInfo.inputNames.forEach(((t,r)=>{let n=this.context.inputTextureLayouts[r].shape,i=n.length,o=`incrementIndices_${t}`,a="";for(let e=0;e<i;++e)a+=`\n        shape[${e}] = ${n[e]};`;let s=`\n        void ${o}(int axis, out int indices[${i}]) {\n          int shape[${i}];\n          ${a};\n          for(int i = ${i} -1 ; i >= 0; --i) {\n            if(i > axis) continue;\n            indices[i] += 1;\n            if(indices[i] < shape[i]) {\n              break;\n            }\n            indices[i] = 0;\n          }\n        }\n        `;e[o]=new G(s)})),e}}})),_o,cp=D((()=>{Xt(),_o=class extends bt{constructor(e){super(e)}getCustomTypes(){return{}}getFunctions(){return{...this.binaryVecFunctions(),...this.copyVec(),...this.setVecItem(),...this.getVecItem()}}binaryVecFunctions(){let e=this.context.outputTextureLayout.shape.length,t={add:"+=",sub:"-=",mul:"*=",div:"/="},r={};for(let n in t){let i=`${n}Vec`,o="";for(let r=0;r<e;++r)o+=`\n          dest[${r}] ${t[n]} src[${r}];\n          `;let a=`\n        void ${i}(int src[${e}], out int dest[${e}]) {\n          ${o}\n        }\n        `;r[i]=new G(a)}return r}copyVec(){let e=this.context.outputTextureLayout.shape.length,t="";for(let r=0;r<e;++r)t+=`\n        dest[${r}] = src[${r}];\n        `;return{copyVec:new G(`\n      void copyVec(int src[${e}], out int dest[${e}]) {\n        ${t}\n      }\n      `)}}setVecItem(){let e=this.context.outputTextureLayout.shape.length,t=`\n        if(index < 0)\n            index =${e} + index;\n        if (index == 0)\n            m[0] = value;\n        `;for(let r=1;r<e-1;++r)t+=`\n        else if (index == ${r})\n            m[${r}] = value;\n            `;return t+=`\n        else\n            m[${e-1}] = value;\n        `,{setVecItem:new G(`\n      void setVecItem(out int m[${e}], int index, int value) {\n        ${t}\n      }\n        `)}}getVecItem(){let e=this.context.outputTextureLayout.shape.length,t=`\n        if(index < 0)\n            index = ${e} + index;\n        if (index == 0)\n            return m[0];\n      `;for(let r=1;r<e-1;++r)t+=`\n        else if (index == ${r})\n            return m[${r}];\n      `;return t+=`\n        else\n            return m[${e-1}];\n        `,{getVecItem:new G(`\n      int getVecItem(int m[${e}], int index) {\n        ${t}\n      }\n    `)}}}})),Zi,pp=D((()=>{sp(),up(),lp(),fp(),cp(),Zi={encoding:xo,fragcolor:wo,vec:_o,shapeUtils:vo,coordinates:To}})),Oo,dp=D((()=>{Xt(),ip(),pp(),ve(),Oo=class{constructor(e,t,r,n){this.libs={},this.glslLibRoutineDependencyGraph={},this.context=new so(e,t,r,n),Object.keys(Zi).forEach((e=>{let t=new Zi[e](this.context);this.libs[e]=t}));let i=this.glslLibRoutineDependencyGraph;for(let e in this.libs){let t=this.libs[e].getFunctions();for(let r in t){let n,o=e+"."+r;i[o]?(n=i[o],n.routineBody=t[r].routineBody):(n=new yn(o,t[r].routineBody),i[o]=n);let a=t[r].dependencies;if(a)for(let e=0;e<a.length;++e)if(i[a[e]])n.addDependency(i[a[e]]);else{let t=new yn(a[e]);i[a[e]]=t,n.addDependency(t)}}}}preprocess(){let e=this.context.programInfo,t=e.shaderSource;return this.context.programInfo.hasMain||(t=`${t}\n      ${ju(this.context.glContext.version,this.context.outputTextureLayout.shape.length)}`),t=op(t),`${Hu(this.context.glContext.version)}\n    ${this.getUniforms(e.inputNames,e.variables)}\n    ${this.getImports(t)}\n    ${t}`}getImports(e){let t=this.selectGlslLibRoutinesToBeIncluded(e);if(0===t.length)return"";let r="";for(let e=0;e<t.length;++e){if(!t[e].routineBody)throw new Error(`Missing body for the Glsl Library routine: ${t[e].name}`);r+=t[e].routineBody+"\n"}return r}selectGlslLibRoutinesToBeIncluded(e){let t=[];return Object.keys(this.glslLibRoutineDependencyGraph).forEach((r=>{let n=r.split(".")[1];-1!==e.indexOf(n)&&t.push(this.glslLibRoutineDependencyGraph[r])})),uo.returnOrderedNodes(t)}getUniforms(e,t){let r=[];if(e)for(let t of e)r.push(`uniform sampler2D ${t};`);if(t)for(let e of t)r.push(`uniform ${e.type} ${e.name}${e.arrayLength?`[${e.arrayLength}]`:""};`);return r.join("\n")}}})),So,hp=D((()=>{_t(),pt(),dp(),ve(),So=class{constructor(e,t,r){this.profiler=e,this.glContext=t,this.textureLayoutStrategy=r,this.repo=new Map,this.attributesBound=!1}getArtifact(e){return this.repo.get(e)}setArtifact(e,t){this.repo.set(e,t)}run(e,t,r){this.profiler.event("op",`ProgramManager.run ${e.programInfo.name??"unknown kernel"}`,(()=>{let n=this.glContext.gl,i=e.program;n.useProgram(i);try{this.bindOutput(r),this.attributesBound||this.bindAttributes(e.attribLocations),this.bindUniforms(e.uniformLocations,e.programInfo.variables??[],t)}catch(t){throw pe.error("ProgramManager",e.programInfo.shaderSource),t}this.profiler.event("backend","GlContext.draw()",(()=>{this.glContext.draw()}))}),this.glContext)}dispose(){this.vertexShader&&this.glContext.deleteShader(this.vertexShader),this.repo.forEach((e=>this.glContext.deleteProgram(e.program)))}build(e,t,r){return this.profiler.event("backend","ProgramManager.build",(()=>{let n=new Oo(this.glContext,e,t,r),i=n.preprocess(),o=this.compile(i);return{programInfo:e,program:o,uniformLocations:this.getUniformLocations(o,n.context.programInfo.inputNames,n.context.programInfo.variables),attribLocations:this.getAttribLocations(o)}}))}compile(e){if(!this.vertexShader){pe.verbose("ProrgramManager","Compiling and caching Vertex shader for the first time");let e=Vu(this.glContext.version);this.vertexShader=this.glContext.compileShader(e,this.glContext.gl.VERTEX_SHADER)}ee.debug&&pe.verbose("ProrgramManager",`FragShader:\n${e}\n`);let t=this.glContext.compileShader(e,this.glContext.gl.FRAGMENT_SHADER),r=this.glContext.createProgram(this.vertexShader,t);return this.glContext.deleteShader(t),r}bindOutput(e){let t=e.width,r=e.height;pe.verbose("ProrgramManager",`Binding output texture to Framebuffer: w/h=${t}/${r}, shape=${e.shape}, type=${e.tensor.type}`),this.glContext.attachFramebuffer(e.texture,t,r)}bindAttributes(e){let t=e.position,r=e.textureCoord;this.glContext.setVertexAttributes(t,r),this.attributesBound=!0}bindUniforms(e,t,r){let n=this.glContext.gl,i=0;for(let{name:o,type:a,location:s,arrayLength:u}of e){let e=t.find((e=>e.name===o))?.data;if("sampler2D"!==a&&!e)throw new Error(`variable '${o}' does not have data defined in program info`);switch(a){case"sampler2D":this.bindTexture(r[i],s,i),i++;break;case"float":u?n.uniform1fv(s,e):n.uniform1f(s,e);break;case"int":u?n.uniform1iv(s,e):n.uniform1i(s,e);break;default:throw new Error(`Uniform not implemented: ${a}`)}}}bindTexture(e,t,r){this.glContext.bindTextureToUniform(e.texture,r,t)}getAttribLocations(e){return{position:this.getAttribLocation(e,"position"),textureCoord:this.getAttribLocation(e,"textureCoord")}}getUniformLocations(e,t,r){let n=[];if(t)for(let r of t)n.push({name:r,type:"sampler2D",location:this.getUniformLocation(e,r)});if(r)for(let t of r)n.push({...t,location:this.getUniformLocation(e,t.name)});return n}getUniformLocation(e,t){let r=this.glContext.gl.getUniformLocation(e,t);if(null===r)throw new Error(`Uniform ${t} not found.`);return r}getAttribLocation(e,t){return this.glContext.gl.getAttribLocation(e,t)}}})),Io,mp=D((()=>{pt(),bn(),Io=class{constructor(e,t,r,n){this.glContext=e,this.layoutStrategy=t,this.profiler=r,this.config=n,this.pendingRead=new Map,n.reuseTextures&&(this.inUseTextures=new Map,this.idleTextures=new Map,this.textureLookup=new Map)}createTextureFromLayout(e,t,r,n){let i=this.toEncoderType(e),o=this.glContext.getEncoder(i,t.channels||1,n);if(t.isPacked&&1===n)throw new Error("not implemented");let a,s,u=t.width,l=t.height;if(this.config.reuseTextures){a=`${u}x${l}_${o.format}_${o.internalFormat}_${o.textureType}`,s=this.inUseTextures.get(a),s||(s=[],this.inUseTextures.set(a,s));let t=this.idleTextures.get(a);if(t&&t.length>0){let i=t.pop();return s.push(i),1===n&&this.glContext.updateTexture(i,u,l,o,this.toTextureData(e,r)),i}}pe.verbose("TextureManager",`Creating new texture of size ${t.width}x${t.height}`);let h=this.glContext.allocateTexture(u,l,o,this.toTextureData(e,r));return this.config.reuseTextures&&(s.push(h),this.textureLookup.set(h,a)),h}readTexture(e,t,r){return r||(r=1),this.profiler.event("backend","TextureManager.readTexture",(()=>{let n=e.shape.reduce(((e,t)=>e*t))*r,i=this.glContext.readTexture(e.texture,e.width,e.height,n,this.toEncoderType(t),r);return this.toTensorData(t,i)}))}async readTextureAsync(e,t,r){let n=e.tensor.dataId;if(r||(r=1),this.pendingRead.has(n)){let e=this.pendingRead.get(n);return new Promise((t=>e?.push(t)))}return this.profiler.event("backend","TextureManager.readTextureAsync",(async()=>{this.pendingRead.set(n,[]);let i=e.shape.reduce(((e,t)=>e*t))*r;await this.glContext.createAndWaitForFence();let o=this.glContext.readTexture(e.texture,e.width,e.height,i,this.toEncoderType(t),r),a=this.toTensorData(t,o),s=this.pendingRead.get(n);return this.pendingRead.delete(n),s?.forEach((e=>e(a))),a}))}readUint8TextureAsFloat(e){return this.profiler.event("backend","TextureManager.readUint8TextureAsFloat",(()=>{let t=e.shape.reduce(((e,t)=>e*t)),r=this.glContext.readTexture(e.texture,e.width,e.height,4*t,"byte",4);return new Float32Array(r.buffer,r.byteOffset,t)}))}releaseTexture(e,t){let r;if(this.config.reuseTextures&&(r=this.textureLookup.get(e.texture),r)){t&&this.textureLookup.delete(r);let n=this.inUseTextures.get(r);if(n){let t=n.indexOf(e.texture);if(-1!==t){n.splice(t,1);let i=this.idleTextures.get(r);i||(i=[],this.idleTextures.set(r,i)),i.push(e.texture)}}}(!r||t)&&(pe.verbose("TextureManager",`Deleting texture of size ${e.width}x${e.height}`),this.glContext.deleteTexture(e.texture))}toTensorData(e,t){switch(e){case"int16":return t instanceof Int16Array?t:Int16Array.from(t);case"int32":return t instanceof Int32Array?t:Int32Array.from(t);case"int8":return t instanceof Int8Array?t:Int8Array.from(t);case"uint16":return t instanceof Uint16Array?t:Uint16Array.from(t);case"uint32":return t instanceof Uint32Array?t:Uint32Array.from(t);case"uint8":case"bool":return t instanceof Uint8Array?t:Uint8Array.from(t);case"float32":return t instanceof Float32Array?t:Float32Array.from(t);case"float64":return t instanceof Float64Array?t:Float64Array.from(t);default:throw new Error(`TensorData type ${e} is not supported`)}}toTextureData(e,t){if(t)return t instanceof Float32Array?t:new Float32Array(t)}toEncoderType(e){return"float"}clearActiveTextures(){this.glContext.clearActiveTextures()}}})),Ao,bp=D((()=>{pt(),Ds(),sl(),rp(),hp(),Ji(),mp(),Ao=class{constructor(e,t){this.backend=e,this.context=t,this.layoutStrategy=new yo(e.glContext.maxTextureSize),this.programManager=new So(this.context.profiler,e.glContext,this.layoutStrategy),this.textureManager=new Io(e.glContext,this.layoutStrategy,this.context.profiler,{reuseTextures:"full"===e.textureCacheMode}),this.packedTextureDataCache=new Map,this.unpackedTextureDataCache=new Map,this.pack=e.pack,this.pack2unpackMap=new Map,this.unpack2packMap=new Map}createInferenceHandler(){return new ao(this)}onGraphInitialized(e){let t=e.getValues().filter((e=>-1===e.from&&e.tensor)).map((e=>e.tensor.dataId));this.initializers=new Set(t)}isInitializer(e){return!!this.initializers&&this.initializers.has(e)}addInitializer(e){this.initializers.add(e)}getTextureData(e,t){return t?this.packedTextureDataCache.get(e):this.unpackedTextureDataCache.get(e)}setTextureData(e,t,r=!1){pe.verbose("WebGLSessionHandler","Storing Texture data in cache"),r?this.packedTextureDataCache.set(e,t):this.unpackedTextureDataCache.set(e,t)}dispose(){this.programManager.dispose(),this.textureManager.clearActiveTextures(),this.packedTextureDataCache.forEach((e=>this.textureManager.releaseTexture(e,!0))),this.packedTextureDataCache=new Map,this.unpackedTextureDataCache.forEach((e=>this.textureManager.releaseTexture(e,!0))),this.unpackedTextureDataCache=new Map}resolve(e,t,r){let n=Ps(e,t,tp);return{impl:n.opImpl,context:n.opInit?n.opInit(e,r):e}}}}));function og(e){let t=0;for(;t<e.length&&e[t]();++t);return t-1}var wn,gp=D((()=>{_t(),bn(),bn(),Rt(),wn=class{constructor(e,t){this.frameBufferBound=!1,this.itemsToPoll=[],this.gl=e,this.version=t,this.getExtensions(),this.vertexbuffer=this.createVertexbuffer(),this.framebuffer=this.createFramebuffer(),this.queryVitalParameters()}allocateTexture(e,t,r,n){let i=this.gl,o=i.createTexture();i.bindTexture(i.TEXTURE_2D,o),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,i.NEAREST),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,i.NEAREST),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,i.CLAMP_TO_EDGE);let a=n?r.encode(n,e*t):null;return i.texImage2D(i.TEXTURE_2D,0,r.internalFormat,e,t,0,r.format,r.textureType,a),this.checkError(),o}updateTexture(e,t,r,n,i){let o=this.gl;o.bindTexture(o.TEXTURE_2D,e);let a=n.encode(i,t*r);o.texSubImage2D(o.TEXTURE_2D,0,0,0,t,r,n.format,n.textureType,a),this.checkError()}attachFramebuffer(e,t,r){let n=this.gl;n.bindTexture(n.TEXTURE_2D,e),n.bindFramebuffer(n.FRAMEBUFFER,this.framebuffer),n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,e,0),this.checkError(),n.viewport(0,0,t,r),n.scissor(0,0,t,r)}readTexture(e,t,r,n,i,o){let a=this.gl;o||(o=1),this.frameBufferBound||this.attachFramebuffer(e,t,r);let s=this.getEncoder(i,o),u=s.allocate(t*r);return a.bindTexture(a.TEXTURE_2D,e),a.framebufferTexture2D(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.TEXTURE_2D,e,0),a.readPixels(0,0,t,r,a.RGBA,s.textureType,u),this.checkError(),s.decode(u,n)}isFramebufferReady(){return!0}getActiveTexture(){let e=this.gl;return"TEXTURE"+(e.getParameter(this.gl.ACTIVE_TEXTURE)-e.TEXTURE0)}getTextureBinding(){return this.gl.getParameter(this.gl.TEXTURE_BINDING_2D)}getFramebufferBinding(){return this.gl.getParameter(this.gl.FRAMEBUFFER_BINDING)}setVertexAttributes(e,t){let r=this.gl;r.vertexAttribPointer(e,3,r.FLOAT,!1,20,0),r.enableVertexAttribArray(e),-1!==t&&(r.vertexAttribPointer(t,2,r.FLOAT,!1,20,12),r.enableVertexAttribArray(t)),this.checkError()}createProgram(e,t){let r=this.gl,n=r.createProgram();return r.attachShader(n,e),r.attachShader(n,t),r.linkProgram(n),n}compileShader(e,t){let r=this.gl,n=r.createShader(t);if(!n)throw new Error(`createShader() returned null with type ${t}`);if(r.shaderSource(n,e),r.compileShader(n),!1===r.getShaderParameter(n,r.COMPILE_STATUS))throw new Error(`Failed to compile shader: ${r.getShaderInfoLog(n)}\nShader source:\n${e}`);return n}deleteShader(e){this.gl.deleteShader(e)}bindTextureToUniform(e,t,r){let n=this.gl;n.activeTexture(n.TEXTURE0+t),this.checkError(),n.bindTexture(n.TEXTURE_2D,e),this.checkError(),n.uniform1i(r,t),this.checkError()}draw(){this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4),this.checkError()}checkError(){if(ee.debug){let e=this.gl,t=e.getError(),r="";switch(t){case e.NO_ERROR:return;case e.INVALID_ENUM:r="INVALID_ENUM";break;case e.INVALID_VALUE:r="INVALID_VALUE";break;case e.INVALID_OPERATION:r="INVALID_OPERATION";break;case e.INVALID_FRAMEBUFFER_OPERATION:r="INVALID_FRAMEBUFFER_OPERATION";break;case e.OUT_OF_MEMORY:r="OUT_OF_MEMORY";break;case e.CONTEXT_LOST_WEBGL:r="CONTEXT_LOST_WEBGL";break;default:r=`Unknown WebGL Error: ${t.toString(16)}`}throw new Error(r)}}deleteTexture(e){this.gl.deleteTexture(e)}deleteProgram(e){this.gl.deleteProgram(e)}getEncoder(e,t,r=0){if(2===this.version)return new oo(this.gl,t);switch(e){case"float":return 1===r||this.isRenderFloat32Supported?new mn(this.gl,t):new mn(this.gl,t,this.textureHalfFloatExtension.HALF_FLOAT_OES);case"int":throw new Error("not implemented");case"byte":return new io(this.gl,t);default:throw new Error(`Invalid dataType: ${e}`)}}clearActiveTextures(){let e=this.gl;for(let t=0;t<this.maxTextureImageUnits;++t)e.activeTexture(e.TEXTURE0+t),e.bindTexture(e.TEXTURE_2D,null)}dispose(){if(this.disposed)return;let e=this.gl;e.bindFramebuffer(e.FRAMEBUFFER,null),e.deleteFramebuffer(this.framebuffer),e.bindBuffer(e.ARRAY_BUFFER,null),e.deleteBuffer(this.vertexbuffer),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null),e.finish(),this.disposed=!0}createDefaultGeometry(){return new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0])}createVertexbuffer(){let e=this.gl,t=e.createBuffer();if(!t)throw new Error("createBuffer() returned null");let r=this.createDefaultGeometry();return e.bindBuffer(e.ARRAY_BUFFER,t),e.bufferData(e.ARRAY_BUFFER,r,e.STATIC_DRAW),this.checkError(),t}createFramebuffer(){let e=this.gl.createFramebuffer();if(!e)throw new Error("createFramebuffer returned null");return e}queryVitalParameters(){let e=this.gl;if(this.isFloatTextureAttachableToFrameBuffer=this.checkFloatTextureAttachableToFrameBuffer(),this.isRenderFloat32Supported=this.checkRenderFloat32(),this.isFloat32DownloadSupported=this.checkFloat32Download(),1===this.version&&!this.textureHalfFloatExtension&&!this.isRenderFloat32Supported)throw new Error("both float32 and float16 TextureType are not supported");this.isBlendSupported=!this.isRenderFloat32Supported||this.checkFloat32Blend(),this.maxTextureSize=e.getParameter(e.MAX_TEXTURE_SIZE),this.maxTextureImageUnits=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS),this.version}getExtensions(){2===this.version?(this.colorBufferFloatExtension=this.gl.getExtension("EXT_color_buffer_float"),this.disjointTimerQueryWebgl2Extension=this.gl.getExtension("EXT_disjoint_timer_query_webgl2")):(this.textureFloatExtension=this.gl.getExtension("OES_texture_float"),this.textureHalfFloatExtension=this.gl.getExtension("OES_texture_half_float"))}checkFloatTextureAttachableToFrameBuffer(){let e=this.gl,t=e.createTexture();e.bindTexture(e.TEXTURE_2D,t);let r=2===this.version?e.RGBA32F:e.RGBA;e.texImage2D(e.TEXTURE_2D,0,r,1,1,0,e.RGBA,e.FLOAT,null);let n=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,n),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,t,0);let i=e.checkFramebufferStatus(e.FRAMEBUFFER)===e.FRAMEBUFFER_COMPLETE;return e.bindTexture(e.TEXTURE_2D,null),e.bindFramebuffer(e.FRAMEBUFFER,null),e.deleteTexture(t),e.deleteFramebuffer(n),i}checkRenderFloat32(){if(2===this.version){if(!this.colorBufferFloatExtension)return!1}else if(!this.textureFloatExtension)return!1;return this.isFloatTextureAttachableToFrameBuffer}checkFloat32Download(){if(2===this.version){if(!this.colorBufferFloatExtension)return!1}else if(!this.textureFloatExtension||!this.gl.getExtension("WEBGL_color_buffer_float"))return!1;return this.isFloatTextureAttachableToFrameBuffer}checkFloat32Blend(){let e,t,r,n,i,o=this.gl;try{e=o.createTexture(),t=o.createFramebuffer(),o.bindTexture(o.TEXTURE_2D,e);let a=2===this.version?o.RGBA32F:o.RGBA;return o.texImage2D(o.TEXTURE_2D,0,a,1,1,0,o.RGBA,o.FLOAT,null),o.bindFramebuffer(o.FRAMEBUFFER,t),o.framebufferTexture2D(o.FRAMEBUFFER,o.COLOR_ATTACHMENT0,o.TEXTURE_2D,e,0),o.enable(o.BLEND),r=o.createShader(o.VERTEX_SHADER),!!(r&&(o.shaderSource(r,"void main(){}"),o.compileShader(r),n=o.createShader(o.FRAGMENT_SHADER),n)&&(o.shaderSource(n,"precision highp float;void main(){gl_FragColor=vec4(0.5);}"),o.compileShader(n),i=o.createProgram(),i))&&(o.attachShader(i,r),o.attachShader(i,n),o.linkProgram(i),o.useProgram(i),o.drawArrays(o.POINTS,0,1),o.getError()===o.NO_ERROR)}finally{o.disable(o.BLEND),i&&o.deleteProgram(i),r&&o.deleteShader(r),n&&o.deleteShader(n),t&&(o.bindFramebuffer(o.FRAMEBUFFER,null),o.deleteFramebuffer(t)),e&&(o.bindTexture(o.TEXTURE_2D,null),o.deleteTexture(e))}}beginTimer(){if(2===this.version&&this.disjointTimerQueryWebgl2Extension){let e=this.gl,t=this.disjointTimerQueryWebgl2Extension,r=e.createQuery();return e.beginQuery(t.TIME_ELAPSED_EXT,r),r}throw new Error("WebGL1 profiling currently not supported.")}endTimer(){if(2!==this.version||!this.disjointTimerQueryWebgl2Extension)throw new Error("WebGL1 profiling currently not supported");{let e=this.gl,t=this.disjointTimerQueryWebgl2Extension;e.endQuery(t.TIME_ELAPSED_EXT)}}isTimerResultAvailable(e){let t=!1,r=!1;if(2!==this.version||!this.disjointTimerQueryWebgl2Extension)throw new Error("WebGL1 profiling currently not supported");{let n=this.gl,i=this.disjointTimerQueryWebgl2Extension;t=n.getQueryParameter(e,n.QUERY_RESULT_AVAILABLE),r=n.getParameter(i.GPU_DISJOINT_EXT)}return t&&!r}getTimerResult(e){let t=0;if(2!==this.version)throw new Error("WebGL1 profiling currently not supported");{let r=this.gl;t=r.getQueryParameter(e,r.QUERY_RESULT),r.deleteQuery(e)}return t/1e6}async waitForQueryAndGetTime(e){return await _i((()=>this.isTimerResultAvailable(e))),this.getTimerResult(e)}async createAndWaitForFence(){let e=this.createFence(this.gl);return this.pollFence(e)}createFence(e){let t,r=e,n=r.fenceSync(r.SYNC_GPU_COMMANDS_COMPLETE,0);return e.flush(),t=null===n?()=>!0:()=>{let e=r.clientWaitSync(n,0,0);return e===r.ALREADY_SIGNALED||e===r.CONDITION_SATISFIED},{query:n,isFencePassed:t}}async pollFence(e){return new Promise((t=>{this.addItemToPoll((()=>e.isFencePassed()),(()=>t()))}))}pollItems(){let e=og(this.itemsToPoll.map((e=>e.isDoneFn)));for(let t=0;t<=e;++t){let{resolveFn:e}=this.itemsToPoll[t];e()}this.itemsToPoll=this.itemsToPoll.slice(e+1)}async addItemToPoll(e,t){this.itemsToPoll.push({isDoneFn:e,resolveFn:t}),!(this.itemsToPoll.length>1)&&await _i((()=>(this.pollItems(),0===this.itemsToPoll.length)))}}}));function Qi(e){let t;if(e&&"webgl2"!==e||!("webgl2"in Xr)?(!e||"webgl"===e)&&"webgl"in Xr&&(t=Xr.webgl):t=Xr.webgl2,!t)try{t=yp(ag(),e)}catch{t=yp(ig(),e)}e=e||1===t.version?"webgl":"webgl2";let r=t.gl;return Xr[e]=t,r.isContextLost()?(delete Xr[e],Qi(e)):(r.disable(r.DEPTH_TEST),r.disable(r.STENCIL_TEST),r.disable(r.BLEND),r.disable(r.DITHER),r.disable(r.POLYGON_OFFSET_FILL),r.disable(r.SAMPLE_COVERAGE),r.enable(r.SCISSOR_TEST),r.enable(r.CULL_FACE),r.cullFace(r.BACK),t)}function yp(e,t){let r,n={alpha:!1,depth:!1,antialias:!1,stencil:!1,preserveDrawingBuffer:!1,premultipliedAlpha:!1,failIfMajorPerformanceCaveat:!1};if((!t||"webgl2"===t)&&(r=e.getContext("webgl2",n),r))try{return new wn(r,2)}catch(e){pe.warning("GlContextFactory",`failed to create WebGLContext using contextId 'webgl2'. Error: ${e}`)}if((!t||"webgl"===t)&&(r=e.getContext("webgl",n)||e.getContext("experimental-webgl",n),r))try{return new wn(r,1)}catch(e){pe.warning("GlContextFactory",`failed to create WebGLContext using contextId 'webgl' or 'experimental-webgl'. Error: ${e}`)}throw new Error("WebGL is not supported")}function ig(){if(typeof document>"u")throw new TypeError("failed to create canvas: document is not supported");let e=document.createElement("canvas");return e.width=1,e.height=1,e}function ag(){if(typeof OffscreenCanvas>"u")throw new TypeError("failed to create offscreen canvas: OffscreenCanvas is not supported");return new OffscreenCanvas(1,1)}var Xr,Tp=D((()=>{pt(),gp(),Xr={}})),Eo,xp=D((()=>{_t(),pt(),bp(),Tp(),Eo=class{get contextId(){return ee.webgl.contextId}set contextId(e){ee.webgl.contextId=e}get matmulMaxBatchSize(){return ee.webgl.matmulMaxBatchSize}set matmulMaxBatchSize(e){ee.webgl.matmulMaxBatchSize=e}get textureCacheMode(){return ee.webgl.textureCacheMode}set textureCacheMode(e){ee.webgl.textureCacheMode=e}get pack(){return ee.webgl.pack}set pack(e){ee.webgl.pack=e}get async(){return ee.webgl.async}set async(e){ee.webgl.async=e}initialize(){try{return this.glContext=Qi(this.contextId),"number"!=typeof this.matmulMaxBatchSize&&(this.matmulMaxBatchSize=16),"string"!=typeof this.textureCacheMode&&(this.textureCacheMode="full"),"boolean"!=typeof this.pack&&(this.pack=!1),"boolean"!=typeof this.async&&(this.async=!1),pe.setWithEnv(ee),ee.webgl.context||Object.defineProperty(ee.webgl,"context",{value:this.glContext.gl}),pe.verbose("WebGLBackend",`Created WebGLContext: ${typeof this.glContext} with matmulMaxBatchSize: ${this.matmulMaxBatchSize}; textureCacheMode: ${this.textureCacheMode}; pack: ${this.pack}; async: ${this.async}.`),!0}catch(e){return pe.warning("WebGLBackend",`Unable to initialize WebGLBackend. ${e}`),!1}}createSessionHandler(e){return new Ao(this,e)}dispose(){this.glContext.dispose()}}}));async function ea(e){if(!e)return ea(["webgl"]);{let t="string"==typeof e?[e]:e;for(let e of t){let t=wp.get(e);if(t)return t;let r=await ug(e);if(r)return r}}throw new Error("no available backend to use")}async function ug(e){let t=sg;if(typeof t[e]<"u"&&lg(t[e])){let r=t[e],n=r.initialize();if("object"==typeof n&&"then"in n&&(n=await n),n)return wp.set(e,r),r}}function lg(e){let t=e;return"initialize"in t&&"function"==typeof t.initialize&&"createSessionHandler"in t&&"function"==typeof t.createSessionHandler&&"dispose"in t&&"function"==typeof t.dispose}var wp,sg,vp=D((()=>{xp(),wp=new Map,sg={webgl:new Eo}})),ta,Po,_p=D((()=>{pt(),ta=class{constructor(e,t){this.op=e,this.node=t}},Po=class{constructor(e,t,r){this.graph=e,this.profiler=r,this.initialize(t)}initialize(e){this.profiler.event("session","ExecutionPlan.initialize",(()=>{let t=this.graph.getNodes();if(t.length!==e.length)throw new Error("The size of nodes and OPs do not match.");this._ops=e.map(((e,r)=>new ta(e,t[r]))),this.reset(),this._starter=[],this._ops.forEach(((e,t)=>{let r=!0;for(let t of e.node.inputs)if(!this._values[t]&&-1===this.graph.getInputIndices().indexOf(t)){r=!1;break}r&&this._starter.push(t)}))}))}reset(){this._values=this.graph.getValues().map((e=>e.tensor))}async execute(e,t){return this.profiler.event("session","ExecutionPlan.execute",(async()=>{this.reset();let r=e.createInferenceHandler(),n=this.graph.getInputIndices();if(t.length!==n.length)throw new Error(`number of input tensors don't match the number of inputs to the model: actual: ${t.length} expected: ${n.length}`);t.forEach(((e,t)=>{let r=n[t];this._values[r]=e}));let i=this._starter.slice(0),o=this.graph.getValues(),a=this.graph.getNodes(),s=0;for(;s<i.length;){let e=i[s++],t=this._ops[e],n=t.node.inputs.map((e=>this._values[e]));if(-1!==n.indexOf(void 0))throw new Error(`unresolved input detected: op: ${t.node}`);let u=n;pe.verbose("ExecPlan",`Runing op:${t.node.name} (${u.map(((e,r)=>`'${t.node.inputs[r]}': ${e.type}[${e.dims.join(",")}]`)).join(", ")})`);let l=await this.profiler.event("node",t.node.name,(async()=>t.op.impl(r,u,t.op.context)));if(l.length!==t.node.outputs.length)throw new Error("the size of output does not match model definition.");l.forEach(((e,r)=>{let n=t.node.outputs[r];if(this._values[n])throw new Error(`output [${n}] already has value: op:${t.node.name}`);this._values[n]=e}));let h=new Set;l.forEach(((e,r)=>{let n=t.node.outputs[r];for(let e of o[n].to){let t=a[e],r=!0;for(let e of t.inputs)if(!this._values[e]){r=!1;break}r&&h.add(e)}})),i.push(...h)}let u=[];for(let e=0;e<this.graph.getOutputIndices().length;e++){let t=this.graph.getOutputIndices()[e],r=this._values[t];if(void 0===r)throw new Error(`required output [${t}] does not have value`);0===t?await r.getData():r.data,u.push(r)}return pe.verbose("ExecPlan","disposing of inferenceHandler"),r.dispose(),u}))}}})),oe,Tt,vn,Op=D((()=>{ln(),oe=Nr(Ur()),Sr(),fe(),Tt=H.experimental.fbs,vn=class e{constructor(t){if(this._attributes=new Map,null!=t){for(let r of t)r instanceof oe.onnx.AttributeProto?this._attributes.set(r.name,[e.getValue(r),e.getType(r)]):r instanceof Tt.Attribute&&this._attributes.set(r.name(),[e.getValue(r),e.getType(r)]);if(this._attributes.size<t.length)throw new Error("duplicated attribute names")}}set(e,t,r){this._attributes.set(e,[r,t])}delete(e){this._attributes.delete(e)}getFloat(e,t){return this.get(e,"float",t)}getInt(e,t){return this.get(e,"int",t)}getString(e,t){return this.get(e,"string",t)}getTensor(e,t){return this.get(e,"tensor",t)}getFloats(e,t){return this.get(e,"floats",t)}getInts(e,t){return this.get(e,"ints",t)}getStrings(e,t){return this.get(e,"strings",t)}getTensors(e,t){return this.get(e,"tensors",t)}get(e,t,r){let n=this._attributes.get(e);if(void 0===n){if(void 0!==r)return r;throw new Error(`required attribute not found: ${e}`)}if(n[1]!==t)throw new Error(`type mismatch: expected ${t} but got ${n[1]}`);return n[0]}static getType(e){let t=e instanceof oe.onnx.AttributeProto?e.type:e.type();switch(t){case oe.onnx.AttributeProto.AttributeType.FLOAT:return"float";case oe.onnx.AttributeProto.AttributeType.INT:return"int";case oe.onnx.AttributeProto.AttributeType.STRING:return"string";case oe.onnx.AttributeProto.AttributeType.TENSOR:return"tensor";case oe.onnx.AttributeProto.AttributeType.FLOATS:return"floats";case oe.onnx.AttributeProto.AttributeType.INTS:return"ints";case oe.onnx.AttributeProto.AttributeType.STRINGS:return"strings";case oe.onnx.AttributeProto.AttributeType.TENSORS:return"tensors";default:throw new Error(`attribute type is not supported yet: ${oe.onnx.AttributeProto.AttributeType[t]}`)}}static getValue(e){let t=e instanceof oe.onnx.AttributeProto?e.type:e.type();if(t===oe.onnx.AttributeProto.AttributeType.GRAPH||t===oe.onnx.AttributeProto.AttributeType.GRAPHS)throw new Error("graph attribute is not supported yet");let r=this.getValueNoCheck(e);if(t===oe.onnx.AttributeProto.AttributeType.INT&&ot.isLong(r))return ot.longToNumber(r);if(t===oe.onnx.AttributeProto.AttributeType.INTS){let e=r,t=new Array(e.length);for(let r=0;r<e.length;r++){let n=e[r];t[r]=ot.longToNumber(n)}return t}if(t===oe.onnx.AttributeProto.AttributeType.TENSOR)return e instanceof oe.onnx.AttributeProto?Be.fromProto(r):Be.fromOrtTensor(r);if(t===oe.onnx.AttributeProto.AttributeType.TENSORS){if(e instanceof oe.onnx.AttributeProto)return r.map((e=>Be.fromProto(e)));if(e instanceof Tt.Attribute)return r.map((e=>Be.fromOrtTensor(e)))}return t===oe.onnx.AttributeProto.AttributeType.STRING&&e instanceof oe.onnx.AttributeProto?hn(r):t===oe.onnx.AttributeProto.AttributeType.STRINGS&&e instanceof oe.onnx.AttributeProto?r.map(hn):r}static getValueNoCheck(e){return e instanceof oe.onnx.AttributeProto?this.getValueNoCheckFromOnnxFormat(e):this.getValueNoCheckFromOrtFormat(e)}static getValueNoCheckFromOnnxFormat(e){switch(e.type){case oe.onnx.AttributeProto.AttributeType.FLOAT:return e.f;case oe.onnx.AttributeProto.AttributeType.INT:return e.i;case oe.onnx.AttributeProto.AttributeType.STRING:return e.s;case oe.onnx.AttributeProto.AttributeType.TENSOR:return e.t;case oe.onnx.AttributeProto.AttributeType.GRAPH:return e.g;case oe.onnx.AttributeProto.AttributeType.FLOATS:return e.floats;case oe.onnx.AttributeProto.AttributeType.INTS:return e.ints;case oe.onnx.AttributeProto.AttributeType.STRINGS:return e.strings;case oe.onnx.AttributeProto.AttributeType.TENSORS:return e.tensors;case oe.onnx.AttributeProto.AttributeType.GRAPHS:return e.graphs;default:throw new Error(`unsupported attribute type: ${oe.onnx.AttributeProto.AttributeType[e.type]}`)}}static getValueNoCheckFromOrtFormat(e){switch(e.type()){case Tt.AttributeType.FLOAT:return e.f();case Tt.AttributeType.INT:return e.i();case Tt.AttributeType.STRING:return e.s();case Tt.AttributeType.TENSOR:return e.t();case Tt.AttributeType.GRAPH:return e.g();case Tt.AttributeType.FLOATS:return e.floatsArray();case Tt.AttributeType.INTS:{let t=[];for(let r=0;r<e.intsLength();r++)t.push(e.ints(r));return t}case Tt.AttributeType.STRINGS:{let t=[];for(let r=0;r<e.stringsLength();r++)t.push(e.strings(r));return t}case Tt.AttributeType.TENSORS:{let t=[];for(let r=0;r<e.tensorsLength();r++)t.push(e.tensors(r));return t}default:throw new Error(`unsupported attribute type: ${Tt.AttributeType[e.type()]}`)}}}})),na,Do,oa,Ut,Lo,ra,Sp=D((()=>{Op(),ln(),na=Nr(Ur()),Sr(),fe(),Do=H.experimental.fbs,oa={from:(e,t)=>new ra(e,t)},Ut=class{constructor(e){this._from=void 0,this._to=[],this.tensor=void 0,this.type=void 0,e&&(this.type=Ve.tensorValueTypeFromProto(e.type.tensorType))}get from(){return this._from}get to(){return this._to}},Lo=class{constructor(e,t){e instanceof na.onnx.NodeProto?(this.name=e.name,this.opType=e.opType,this.attributes=new vn(e.attribute)):e instanceof Do.Node&&(this.name=t??e.name(),this.opType=e.opType(),this.attributes=new vn(Ve.tensorAttributesFromORTFormat(e))),this.inputs=[],this.outputs=[],this.executeNode=!0}},ra=class{constructor(e,t){if(!e)throw new TypeError("graph is empty");this.buildGraph(e),this.transformGraph(t),this.checkIsAcyclic()}getInputIndices(){return this._allInputIndices}getInputNames(){return this._allInputNames}getOutputIndices(){return this._allOutputIndices}getOutputNames(){return this._allOutputNames}getValues(){return this._allData}getNodes(){return this._nodes}buildGraph(e){if(e instanceof na.onnx.GraphProto)this.buildGraphFromOnnxFormat(e);else{if(!(e instanceof Do.Graph))throw new TypeError("Graph type is not supported.");this.buildGraphFromOrtFormat(e)}}buildGraphFromOnnxFormat(e){let t=new Map;this._allData=[],this._allInputIndices=[],this._allInputNames=[],this._allOutputIndices=[],this._allOutputNames=[],this._nodes=[];let r=new Map;if(!e.input)throw new Error("missing information in graph: input");let n=[];for(let r of e.input){if(t.has(r.name))throw new Error(`duplicated input name: ${r.name}`);let e=this._allData.push(new Ut(r))-1;t.set(r.name,e),n.push(r.name)}if(!e.initializer)throw new Error("missing information in graph: initializer");for(let r of e.initializer){let e=t.get(r.name);if(void 0===e){let n=new Ut;n.type={shape:{dims:Ve.tensorDimsFromProto(r.dims)},tensorType:Ve.tensorDataTypeFromProto(r.dataType)},e=this._allData.push(n)-1,t.set(r.name,e)}this._allData[e]._from=-1,this._allData[e].tensor=Be.fromProto(r)}for(let e=0;e<this._allData.length;e++)this._allData[e].tensor||(this._allInputIndices.push(e),this._allInputNames.push(n[e]));if(!e.output)throw new Error("missing information in graph: output");for(let r of e.output){if(t.has(r.name))throw new Error(`duplicated output name: ${r.name}`);let e=this._allData.push(new Ut(r))-1;t.set(r.name,e),this._allOutputIndices.push(e),this._allOutputNames.push(r.name)}if(!e.node)throw new Error("missing information in graph: node");for(let t of e.node){if(!t.name)for(let e=0;;e++){let n=`unnamed_${t.opType}_${e}`;if(!r.has(n)){t.name=n;break}}if(r.has(t.name))throw new Error(`duplicated node name: ${t.name}`);let e=this._nodes.push(new Lo(t))-1;r.set(t.name,e)}for(let r=0;r<this._nodes.length;r++){let n=this._nodes[r],i=e.node[r];if(!i.output)throw new Error(`missing output for node: ${i.name}`);for(let e of i.output){let o=t.get(e);if(typeof o>"u"&&(o=this._allData.push(new Ut)-1,t.set(e,o)),n.outputs.push(o),void 0!==this._allData[o]._from)throw new Error(`multiple nodes output to one data value: ${o}`);if(this._allData[o]._from=r,"Constant"===i.opType){if(!i.attribute||1!==i.attribute.length||!i.attribute[0].t)throw new Error("missing attributes or missing tensor value in attributes for this Constant operator");if(!i.output||1!==i.output.length)throw new Error("missing output or incorrect number of outputs for this Constant operator");n.outputs.pop(),n.executeNode=!1,this._allData[o]._from=-1,this._allData[o].tensor=Be.fromProto(i.attribute[0].t)}}}for(let r=0;r<this._nodes.length;r++){let n=this._nodes[r],i=e.node[r];if(!i.input)throw new Error(`missing input for node: ${i.name}`);for(let e of i.input){let o=t.get(e);if(typeof o>"u"){if(""===e&&(3===i.input.length||4===i.input.length)&&"Resize"===i.opType)continue;throw new Error(`unrecognized input '${e}' for node: ${i.name}`)}n.inputs.push(o),this._allData[o]._to.push(r)}}return!0}buildGraphFromOrtFormat(e){let t=new Map;this._allData=[],this._allInputIndices=[],this._allInputNames=[],this._allOutputIndices=[],this._allOutputNames=[],this._nodes=[];let r=new Map,n=[];for(let r=0;r<e.inputsLength();r++){let i=e.inputs(r);if(t.has(i))throw new Error(`duplicated input name: ${i}`);for(let r=0;r<e.nodeArgsLength();r++)if(e.nodeArgs(r)?.name()===i){let o=new Ut;if(e.nodeArgs(r)?.type()?.valueType()!==Do.TypeInfoValue.tensor_type)throw new Error("Unexpected value type for the nodeArg.");let a=e.nodeArgs(r).type().value(new Do.TensorTypeAndShape),s=Ve.tensorDataTypeFromProto(a.elemType()),u=a.shape(),l=[];for(let e=0;e<u.dimLength();e++)l.push(ot.longToNumber(u.dim(e).value().dimValue()));o.type={shape:{dims:l},tensorType:s};let h=this._allData.push(o)-1;t.set(i,h),n.push(i)}}for(let r=0;r<e.initializersLength();r++){let n=e.initializers(r),i=t.get(n.name());if(void 0===i){let e=new Ut,r=Ve.tensorDimsFromORTFormat(n),o=Ve.tensorDataTypeFromProto(n.dataType());e.type={shape:{dims:r},tensorType:o},i=this._allData.push(e)-1,t.set(n.name(),i)}this._allData[i]._from=-1,this._allData[i].tensor=Be.fromOrtTensor(n)}for(let e=0;e<this._allData.length;e++)this._allData[e].tensor||(this._allInputIndices.push(e),this._allInputNames.push(n[e]));for(let r=0;r<e.outputsLength();r++){let n=e.outputs(r);if(t.has(n))throw new Error(`duplicated output name: ${n}`);let i=this._allData.push(new Ut)-1;t.set(n,i),this._allOutputIndices.push(i),this._allOutputNames.push(n)}if(!e.nodes)throw new Error("missing information in graph: node");for(let t=0;t<e.nodesLength();t++){let n=e.nodes(t),i=n.name();if(!i)for(let e=0;i=`unnamed_${n.opType()}_${e}`,r.has(i);e++);if(r.has(i))throw new Error(`duplicated node name: ${i}`);let o=this._nodes.push(new Lo(n,i))-1;r.set(i,o)}for(let r=0;r<this._nodes.length;r++){let n=this._nodes[r],i=e.nodes(r);if(null==i)throw new Error(`No node exists at index ${r}`);if(0===i?.outputsLength())throw new Error(`missing output for node: ${i.name}`);for(let e=0;e<i?.outputsLength();e++){let o=i?.outputs(e),a=t.get(o);if(typeof a>"u"&&(a=this._allData.push(new Ut)-1,t.set(o,a)),n.outputs.push(a),void 0!==this._allData[a]._from)throw new Error(`multiple nodes output to one data value: ${a}`);if(this._allData[a]._from=r,"Constant"===i.opType()){if(1!==i.attributesLength()||!i.attributes(0).t())throw new Error("missing attributes or missing tensor value in attributes for this Constant operator");if(1!==i.outputsLength())throw new Error("missing output or incorrect number of outputs for this Constant operator");n.outputs.pop(),n.executeNode=!1,this._allData[a]._from=-1,this._allData[a].tensor=Be.fromOrtTensor(i.attributes(0).t())}}}for(let r=0;r<this._nodes.length;r++){let n=this._nodes[r],i=e.nodes(r);if(0===i.inputsLength())throw new Error(`missing input for node: ${i.name}`);for(let e=0;e<i.inputsLength();e++){let o=i.inputs(e),a=t.get(o);if(typeof a>"u")throw new Error(`unrecognized input '${o}' for node: ${i.name()}`);n.inputs.push(a),this._allData[a]._to.push(r)}}}checkIsAcyclic(){let e=new Set;this._allInputIndices.forEach((t=>{this._allData[t]._to.forEach((t=>{e.add(t)}))}));let t=Array.from(e),r=new Array(this._nodes.length).fill("white");for(;t.length>0;){let e=t.pop();"gray"===r[e]?r[e]="black":(t.push(e),r[e]="gray",this._nodes[e].outputs.forEach((n=>{let i=this._allData[n];if(typeof i.tensor<"u")throw new Error("node outputs should not be initialized");if(i._from!==e)throw new Error("from property of the Value object doesn't match index of Node being processed");i._to.forEach((e=>{if("gray"===r[e])throw new Error("model graph is cyclic");"white"===r[e]&&t.push(e)}))})))}}transformGraph(e){this.removeAllIdentityNodes(),this.removeAllDropoutNodes(),this.fuseConvActivationNodes(),e&&e.transformGraph(this),this.finalizeGraph()}finalizeGraph(){let e=0,t=new Array(this._nodes.length,0),r=0;for(let e=0;e<this._nodes.length;e++)t[e]=r,this._nodes[e].executeNode?(r!==e&&(this._nodes[r]=this._nodes[e]),r++):this._nodes[e].outputs.forEach((e=>{this._allData[e]._from=-2}));this._nodes.splice(r,this._nodes.length-r);for(let e=0;e<this._allData.length;e++){let r=this._allData[e];void 0!==r._from&&-1!==r._from&&-2!==r._from&&(r._from=t[r._from]);for(let e=0;e<r._to.length;e++){if(!(r._to[e]>=0))throw new Error("Trying to update a removed node");r._to[e]=t[r._to[e]]}}e=0;for(let t=0;t<this._allData.length;t++)if(-2!==this._allData[t].from||-1!==this._allOutputIndices.indexOf(t+e)){if(e>0){let r=-1;void 0!==this._allData[t].from&&-1!==this._allData[t].from?(r=this._nodes[this._allData[t].from].outputs.indexOf(t+e),-1!==r&&(this._nodes[this._allData[t].from].outputs[r]=t)):(r=this._allInputIndices.indexOf(t+e),-1!==r&&(this._allInputIndices[r]=t)),this._allData[t].to.forEach((n=>{r=this._nodes[n].inputs.indexOf(t+e),-1!==r&&(this._nodes[n].inputs[r]=t)})),0===this._allData[t].to.length&&(r=this._allOutputIndices.indexOf(t+e),-1!==r&&(this._allOutputIndices[r]=t))}}else e++,this._allData.splice(t,1),t--}deleteNode(e){let t=this._nodes[e];if(t.outputs.length>1)for(let e=1;e<t.outputs.length;e++)if(this._allData[t.outputs[e]].to.length>0)throw new Error("Node deletion with more than one output connected to other nodes is not supported. ");t.executeNode=!1;let r=t.inputs[0],n=t.outputs[0],i=this._allData[n].to;for(let r=0;r<t.inputs.length;r++){let n=this._allData[t.inputs[r]].to.indexOf(e);if(-1===n)throw new Error("The Value object doesn't have the current Node in it's 'to' property ");this._allData[t.inputs[r]].to.splice(n,1)}this._allData[n]._to=[];let o=this._allOutputIndices.indexOf(n);if(-1!==o&&(this._allOutputIndices[o]=r),i&&i.length>0)for(let e of i){let t=this._nodes[e].inputs.indexOf(n);if(-1===t)throw new Error("The Node object doesn't have the output Value in it's 'inputs' property ");this._nodes[e].inputs[t]=r,this._allData[r].to.push(e)}}removeAllDropoutNodes(){let e=0;for(let t of this._nodes){if("Dropout"===t.opType){if(1!==t.inputs.length)throw new Error("Dropout nodes should only contain one input. ");if(1!==t.outputs.length&&2!==t.outputs.length)throw new Error("Dropout nodes should contain either 1 or 2 output(s)");if(2===t.outputs.length&&0!==this._allData[t.outputs[1]]._to.length)throw new Error("Dropout nodes's second output should not be referenced by other nodes");this.deleteNode(e)}e++}}removeAllIdentityNodes(){let e=0;for(let t of this._nodes)"Identity"===t.opType&&this.deleteNode(e),e++}isActivation(e){switch(e.opType){case"Relu":case"Sigmoid":case"Clip":return!0;default:return!1}}fuseConvActivationNodes(){for(let e of this._nodes)if("Conv"===e.opType){let t=this._allData[e.outputs[0]]._to;if(1===t.length&&this.isActivation(this._nodes[t[0]])){let r=this._nodes[t[0]];if("Clip"===r.opType)if(1===r.inputs.length)try{e.attributes.set("activation_params","floats",[r.attributes.getFloat("min"),r.attributes.getFloat("max")])}catch{e.attributes.set("activation_params","floats",[_r,Or])}else{if(!(r.inputs.length>=3&&void 0!==this._allData[r.inputs[1]].tensor&&void 0!==this._allData[r.inputs[2]].tensor))continue;e.attributes.set("activation_params","floats",[this._allData[r.inputs[1]].tensor.floatData[0],this._allData[r.inputs[2]].tensor.floatData[0]])}e.attributes.set("activation","string",r.opType),this.deleteNode(t[0])}}}}})),Ip,fg,Co,Ap=D((()=>{Jn(),Sp(),ln(),Ip=Nr(Ur()),fe(),fg=H.experimental.fbs,Co=class{constructor(){}load(e,t,r){if(!r)try{return void this.loadFromOnnxFormat(e,t)}catch(e){if(void 0!==r)throw e}this.loadFromOrtFormat(e,t)}loadFromOnnxFormat(e,t){let r=Ip.onnx.ModelProto.decode(e);if(ot.longToNumber(r.irVersion)<3)throw new Error("only support ONNX model with IR_VERSION>=3");this._opsets=r.opsetImport.map((e=>({domain:e.domain,version:ot.longToNumber(e.version)}))),this._graph=oa.from(r.graph,t)}loadFromOrtFormat(e,t){let r=new S.ByteBuffer(e),n=fg.InferenceSession.getRootAsInferenceSession(r).model();if(ot.longToNumber(n.irVersion())<3)throw new Error("only support ONNX model with IR_VERSION>=3");this._opsets=[];for(let e=0;e<n.opsetImportLength();e++){let t=n.opsetImport(e);this._opsets.push({domain:t?.domain(),version:ot.longToNumber(t.version())})}this._graph=oa.from(n.graph(),t)}get graph(){return this._graph}get opsets(){return this._opsets}}})),Fo,Ep=D((()=>{vp(),_p(),pt(),Ap(),Fo=class{constructor(e={}){this._initialized=!1,this.backendHint=e.backendHint,this.profiler=Xn.create(e.profiler),this.context={profiler:this.profiler,graphInputTypes:[],graphInputDims:[]}}get inputNames(){return this._model.graph.getInputNames()}get outputNames(){return this._model.graph.getOutputNames()}startProfiling(){this.profiler.start()}endProfiling(){this.profiler.stop()}async loadModel(e,t,r){await this.profiler.event("session","Session.loadModel",(async()=>{let n=await ea(this.backendHint);if(this.sessionHandler=n.createSessionHandler(this.context),this._model=new Co,"string"==typeof e){let t=e.endsWith(".ort");if(typeof process<"u"&&process.versions&&process.versions.node){let r=await(void 0)(e);this.initialize(r,t)}else{let r=await(await fetch(e)).arrayBuffer();this.initialize(new Uint8Array(r),t)}}else if(ArrayBuffer.isView(e))this.initialize(e);else{let n=new Uint8Array(e,t||0,r||e.byteLength);this.initialize(n)}}))}initialize(e,t){if(this._initialized)throw new Error("already initialized");this.profiler.event("session","Session.initialize",(()=>{let r=this.sessionHandler.transformGraph?this.sessionHandler:void 0;this._model.load(e,r,t),this.sessionHandler.onGraphInitialized&&this.sessionHandler.onGraphInitialized(this._model.graph),this.initializeOps(this._model.graph),this._executionPlan=new Po(this._model.graph,this._ops,this.profiler)})),this._initialized=!0}async run(e){if(!this._initialized)throw new Error("session not initialized yet");return this.profiler.event("session","Session.run",(async()=>{let t=this.normalizeAndValidateInputs(e),r=await this._executionPlan.execute(this.sessionHandler,t);return this.createOutput(r)}))}normalizeAndValidateInputs(e){let t=this._model.graph.getInputNames();if(Array.isArray(e)){if(e.length!==t.length)throw new Error(`incorrect input array length: expected ${t.length} but got ${e.length}`)}else{if(e.size!==t.length)throw new Error(`incorrect input map size: expected ${t.length} but got ${e.size}`);let r=new Array(e.size),n=0;for(let i=0;i<t.length;++i){let o=e.get(t[i]);if(!o)throw new Error(`missing input tensor for: '${name}'`);r[n++]=o}e=r}if(this.context.graphInputTypes&&0!==this.context.graphInputTypes.length&&this.context.graphInputDims&&0!==this.context.graphInputDims.length)this.validateInputTensorDims(this.context.graphInputDims,e,!1);else{let t=this._model.graph.getInputIndices(),r=this._model.graph.getValues(),n=new Array(t.length);for(let i=0;i<t.length;++i){let o=r[t[i]];n[i]=o.type.shape.dims,this.context.graphInputTypes.push(o.type.tensorType),this.context.graphInputDims.push(e[i].dims)}this.validateInputTensorDims(n,e,!0)}return this.validateInputTensorTypes(this.context.graphInputTypes,e),e}validateInputTensorTypes(e,t){for(let r=0;r<t.length;r++){let n=e[r],i=t[r].type;if(n!==i)throw new Error(`input tensor[${r}] check failed: expected type '${n}' but got ${i}`)}}validateInputTensorDims(e,t,r){for(let n=0;n<t.length;n++){let i=e[n],o=t[n].dims;if(!this.compareTensorDims(i,o,r))throw new Error(`input tensor[${n}] check failed: expected shape '[${i.join(",")}]' but got [${o.join(",")}]`)}}compareTensorDims(e,t,r){if(e.length!==t.length)return!1;for(let n=0;n<e.length;++n)if(e[n]!==t[n]&&(!r||0!==e[n]))return!1;return!0}createOutput(e){let t=this._model.graph.getOutputNames();if(e.length!==t.length)throw new Error("expected number of outputs do not match number of generated outputs");let r=new Map;for(let n=0;n<t.length;++n)r.set(t[n],e[n]);return r}initializeOps(e){let t=e.getNodes();this._ops=new Array(t.length);for(let r=0;r<t.length;r++)this._ops[r]=this.sessionHandler.resolve(t[r],this._model.opsets,e)}}})),Bo,Pp=D((()=>{_t(),Sr(),Bo=class{constructor(e){this.session=e,this.inputNames=this.session.inputNames,this.outputNames=this.session.outputNames}async dispose(){}async run(e,t,r){let n=new Map;for(let t in e)if(Object.hasOwnProperty.call(e,t)){let r=e[t];n.set(t,new Be(r.dims,r.type,void 0,void 0,r.data))}let i=await this.session.run(n),o={};return i.forEach(((e,t)=>{o[t]=new Ne(e.type,e.data,e.dims)})),o}async configure(e){return""}async auth(e){return""}startProfiling(){this.session.startProfiling()}endProfiling(){this.session.endProfiling()}}})),Dp={};pr(Dp,{onnxjsBackend:()=>pg});var ia,pg,Lp=D((()=>{Ep(),Pp(),pg=new(ia=class{async init(){}async createInferenceSessionHandler(e,t){let r=new Fo(t);return await r.loadModel(e),new Bo(r)}})})),aa={};pr(aa,{createReadStream:()=>Cp,readFile:()=>dg,readFileSync:()=>hg});var dg,hg,Cp,sa=D((()=>{dg=void 0,hg=void 0,Cp=void 0})),ua={};pr(ua,{join:()=>mg});var mg,la=D((()=>{mg=void 0})),fa={};pr(fa,{crypto:()=>bg});var bg,ca=D((()=>{bg=void 0})),$p=ye(((e,t)=>{var r,n=(r=typeof document<"u"&&document.currentScript?document.currentScript.src:void 0,typeof __filename<"u"&&(r=r||__filename),function(e={}){var t,n,i=e;i.ready=new Promise(((e,r)=>{t=e,n=r}));var o,a,s,u=Object.assign({},i),l="./this.program",h="object"==typeof window,c="function"==typeof importScripts,f="object"==typeof process&&"object"==typeof process.versions&&"string"==typeof process.versions.node,d="";if(f){var p=(sa(),jt(aa)),y=(la(),jt(ua));d=c?y.dirname(d)+"/":__dirname+"/",o=(e,t)=>(e=M(e)?new URL(e):y.normalize(e),p.readFileSync(e,t?void 0:"utf8")),s=e=>((e=o(e,!0)).buffer||(e=new Uint8Array(e)),e),a=(e,t,r,n=!0)=>{e=M(e)?new URL(e):y.normalize(e),p.readFile(e,n?void 0:"utf8",((e,i)=>{e?r(e):t(n?i.buffer:i)}))},!i.thisProgram&&1<process.argv.length&&(l=process.argv[1].replace(/\\/g,"/")),process.argv.slice(2),i.inspect=()=>"[Emscripten Module object]"}else(h||c)&&(c?d=self.location.href:typeof document<"u"&&document.currentScript&&(d=document.currentScript.src),r&&(d=r),d=0!==d.indexOf("blob:")?d.substr(0,d.replace(/[?#].*/,"").lastIndexOf("/")+1):"",o=e=>{var t=new XMLHttpRequest;return t.open("GET",e,!1),t.send(null),t.responseText},c&&(s=e=>{var t=new XMLHttpRequest;return t.open("GET",e,!1),t.responseType="arraybuffer",t.send(null),new Uint8Array(t.response)}),a=(e,t,r)=>{var n=new XMLHttpRequest;n.open("GET",e,!0),n.responseType="arraybuffer",n.onload=()=>{200==n.status||0==n.status&&n.response?t(n.response):r()},n.onerror=r,n.send(null)});var m=console.log.bind(console),g=console.error.bind(console);Object.assign(i,u),u=null,"object"!=typeof WebAssembly&&$("no native wasm support detected");var w,v,b,x,_,S,T=!1;function E(){var e=w.buffer;i.HEAP8=v=new Int8Array(e),i.HEAP16=new Int16Array(e),i.HEAPU8=b=new Uint8Array(e),i.HEAPU16=new Uint16Array(e),i.HEAP32=x=new Int32Array(e),i.HEAPU32=_=new Uint32Array(e),i.HEAPF32=new Float32Array(e),i.HEAPF64=S=new Float64Array(e)}var O=[],A=[],I=[],P=0,k=null,C=null;function $(e){throw g(e="Aborted("+e+")"),T=!0,e=new WebAssembly.RuntimeError(e+". Build with -sASSERTIONS for more info."),n(e),e}var R,D=e=>e.startsWith("data:application/octet-stream;base64,"),M=e=>e.startsWith("file://");if(!D(R="ort-wasm.wasm")){var L=R;R=i.locateFile?i.locateFile(L,d):d+L}function B(e){if(s)return s(e);throw"both async and sync fetching of the wasm failed"}function N(e,t,r){return function(e){if(h||c){if("function"==typeof fetch&&!M(e))return fetch(e,{credentials:"same-origin"}).then((t=>{if(!t.ok)throw"failed to load wasm binary file at '"+e+"'";return t.arrayBuffer()})).catch((()=>B(e)));if(a)return new Promise(((t,r)=>{a(e,(e=>t(new Uint8Array(e))),r)}))}return Promise.resolve().then((()=>B(e)))}(e).then((e=>WebAssembly.instantiate(e,t))).then((e=>e)).then(r,(e=>{g(`failed to asynchronously prepare wasm: ${e}`),$(e)}))}var F,U={882208:(e,t,r,n)=>{if(typeof i>"u"||!i.Ga)return 1;if((e=W(e>>>0)).startsWith("./")&&(e=e.substring(2)),!(e=i.Ga.get(e)))return 2;if((t>>>=0)+(r>>>=0)>e.byteLength)return 3;try{return b.set(e.subarray(t,t+r),n>>>0>>>0),0}catch{return 4}}};function j(e){this.Da=e-24,this.Fa=function(e){_[this.Da+4>>>2>>>0]=e},this.Ea=function(e){_[this.Da+8>>>2>>>0]=e},this.La=function(e,t){this.Ma(),this.Fa(e),this.Ea(t)},this.Ma=function(){_[this.Da+16>>>2>>>0]=0}}var z,G=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0,V=(e,t,r)=>{var n=(t>>>=0)+r;for(r=t;e[r]&&!(r>=n);)++r;if(16<r-t&&e.buffer&&G)return G.decode(e.subarray(t,r));for(n="";t<r;){var i=e[t++];if(128&i){var o=63&e[t++];if(192==(224&i))n+=String.fromCharCode((31&i)<<6|o);else{var a=63&e[t++];65536>(i=224==(240&i)?(15&i)<<12|o<<6|a:(7&i)<<18|o<<12|a<<6|63&e[t++])?n+=String.fromCharCode(i):(i-=65536,n+=String.fromCharCode(55296|i>>10,56320|1023&i))}}else n+=String.fromCharCode(i)}return n},W=(e,t)=>(e>>>=0)?V(b,e,t):"",H=e=>{for(var t=0,r=0;r<e.length;++r){var n=e.charCodeAt(r);127>=n?t++:2047>=n?t+=2:55296<=n&&57343>=n?(t+=4,++r):t+=3}return t},q=(e,t,r,n)=>{if(!(0<n))return 0;var i=r>>>=0;n=r+n-1;for(var o=0;o<e.length;++o){var a=e.charCodeAt(o);if(55296<=a&&57343>=a&&(a=65536+((1023&a)<<10)|1023&e.charCodeAt(++o)),127>=a){if(r>=n)break;t[r++>>>0]=a}else{if(2047>=a){if(r+1>=n)break;t[r++>>>0]=192|a>>6}else{if(65535>=a){if(r+2>=n)break;t[r++>>>0]=224|a>>12}else{if(r+3>=n)break;t[r++>>>0]=240|a>>18,t[r++>>>0]=128|a>>12&63}t[r++>>>0]=128|a>>6&63}t[r++>>>0]=128|63&a}}return t[r>>>0]=0,r-i},Y=e=>e%4==0&&(e%100!=0||e%400==0),X=[0,31,60,91,121,152,182,213,244,274,305,335],K=[0,31,59,90,120,151,181,212,243,273,304,334],Z=e=>{var t=H(e)+1,r=pe(t);return r&&q(e,b,r,t),r},J=[],Q={},ee=()=>{if(!z){var e,t={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:("object"==typeof navigator&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",_:l||"./this.program"};for(e in Q)void 0===Q[e]?delete t[e]:t[e]=Q[e];var r=[];for(e in t)r.push(`${e}=${t[e]}`);z=r}return z},te=[null,[],[]],re=e=>(re=(()=>{if("object"==typeof crypto&&"function"==typeof crypto.getRandomValues)return e=>crypto.getRandomValues(e);if(f)try{var e=(ca(),jt(fa));if(e.randomFillSync)return t=>e.randomFillSync(t);var t=e.randomBytes;return e=>(e.set(t(e.byteLength)),e)}catch{}$("initRandomDevice")})())(e),ne=[31,29,31,30,31,30,31,31,30,31,30,31],ie=[31,28,31,30,31,30,31,31,30,31,30,31];function oe(e,t,r,n){function i(e,t,r){for(e="number"==typeof e?e.toString():e||"";e.length<t;)e=r[0]+e;return e}function o(e,t){return i(e,t,"0")}function a(e,t){function r(e){return 0>e?-1:0<e?1:0}var n;return 0===(n=r(e.getFullYear()-t.getFullYear()))&&0===(n=r(e.getMonth()-t.getMonth()))&&(n=r(e.getDate()-t.getDate())),n}function s(e){switch(e.getDay()){case 0:return new Date(e.getFullYear()-1,11,29);case 1:return e;case 2:return new Date(e.getFullYear(),0,3);case 3:return new Date(e.getFullYear(),0,2);case 4:return new Date(e.getFullYear(),0,1);case 5:return new Date(e.getFullYear()-1,11,31);case 6:return new Date(e.getFullYear()-1,11,30)}}function u(e){var t=e.ya;for(e=new Date(new Date(e.za+1900,0,1).getTime());0<t;){var r=e.getMonth(),n=(Y(e.getFullYear())?ne:ie)[r];if(!(t>n-e.getDate())){e.setDate(e.getDate()+t);break}t-=n-e.getDate()+1,e.setDate(1),11>r?e.setMonth(r+1):(e.setMonth(0),e.setFullYear(e.getFullYear()+1))}return r=new Date(e.getFullYear()+1,0,4),t=s(new Date(e.getFullYear(),0,4)),r=s(r),0>=a(t,e)?0>=a(r,e)?e.getFullYear()+1:e.getFullYear():e.getFullYear()-1}e>>>=0,t>>>=0,r>>>=0;var l=_[40+(n>>>=0)>>>2>>>0];for(var h in n={Ja:x[n>>>2>>>0],Ia:x[n+4>>>2>>>0],Aa:x[n+8>>>2>>>0],Ca:x[n+12>>>2>>>0],Ba:x[n+16>>>2>>>0],za:x[n+20>>>2>>>0],xa:x[n+24>>>2>>>0],ya:x[n+28>>>2>>>0],Na:x[n+32>>>2>>>0],Ha:x[n+36>>>2>>>0],Ka:l?W(l):""},r=W(r),l={"%c":"%a %b %d %H:%M:%S %Y","%D":"%m/%d/%y","%F":"%Y-%m-%d","%h":"%b","%r":"%I:%M:%S %p","%R":"%H:%M","%T":"%H:%M:%S","%x":"%m/%d/%y","%X":"%H:%M:%S","%Ec":"%c","%EC":"%C","%Ex":"%m/%d/%y","%EX":"%H:%M:%S","%Ey":"%y","%EY":"%Y","%Od":"%d","%Oe":"%e","%OH":"%H","%OI":"%I","%Om":"%m","%OM":"%M","%OS":"%S","%Ou":"%u","%OU":"%U","%OV":"%V","%Ow":"%w","%OW":"%W","%Oy":"%y"})r=r.replace(new RegExp(h,"g"),l[h]);var c="Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),f="January February March April May June July August September October November December".split(" ");for(h in l={"%a":e=>c[e.xa].substring(0,3),"%A":e=>c[e.xa],"%b":e=>f[e.Ba].substring(0,3),"%B":e=>f[e.Ba],"%C":e=>o((e.za+1900)/100|0,2),"%d":e=>o(e.Ca,2),"%e":e=>i(e.Ca,2," "),"%g":e=>u(e).toString().substring(2),"%G":e=>u(e),"%H":e=>o(e.Aa,2),"%I":e=>(0==(e=e.Aa)?e=12:12<e&&(e-=12),o(e,2)),"%j":e=>{for(var t=0,r=0;r<=e.Ba-1;t+=(Y(e.za+1900)?ne:ie)[r++]);return o(e.Ca+t,3)},"%m":e=>o(e.Ba+1,2),"%M":e=>o(e.Ia,2),"%n":()=>"\n","%p":e=>0<=e.Aa&&12>e.Aa?"AM":"PM","%S":e=>o(e.Ja,2),"%t":()=>"\t","%u":e=>e.xa||7,"%U":e=>o(Math.floor((e.ya+7-e.xa)/7),2),"%V":e=>{var t=Math.floor((e.ya+7-(e.xa+6)%7)/7);if(2>=(e.xa+371-e.ya-2)%7&&t++,t)53==t&&(4==(r=(e.xa+371-e.ya)%7)||3==r&&Y(e.za)||(t=1));else{t=52;var r=(e.xa+7-e.ya-1)%7;(4==r||5==r&&Y(e.za%400-1))&&t++}return o(t,2)},"%w":e=>e.xa,"%W":e=>o(Math.floor((e.ya+7-(e.xa+6)%7)/7),2),"%y":e=>(e.za+1900).toString().substring(2),"%Y":e=>e.za+1900,"%z":e=>(0<=(e=e.Ha)?"+":"-")+("0000"+((e=Math.abs(e)/60)/60*100+e%60)).slice(-4),"%Z":e=>e.Ka,"%%":()=>"%"},r=r.replace(/%%/g,"\0\0"),l)r.includes(h)&&(r=r.replace(new RegExp(h,"g"),l[h](n)));return h=function(e){var t=Array(H(e)+1);return q(e,t,0,t.length),t}(r=r.replace(/\0\0/g,"%")),h.length>t?0:(v.set(h,e>>>0),h.length-1)}var ae,se,ue=[],le=[],he=(e,t)=>{if(!se){se=new WeakMap;var r=ae.length;if(se)for(var n=0;n<0+r;n++){var i=n,o=ue[i];o||(i>=ue.length&&(ue.length=i+1),ue[i]=o=ae.get(i)),(i=o)&&se.set(i,n)}}if(r=se.get(e)||0)return r;if(le.length)r=le.pop();else{try{ae.grow(1)}catch(e){throw e instanceof RangeError?"Unable to grow wasm table. Set ALLOW_TABLE_GROWTH.":e}r=ae.length-1}try{n=r,ae.set(n,e),ue[n]=ae.get(n)}catch(s){if(!(s instanceof TypeError))throw s;if("function"==typeof WebAssembly.Function){n=WebAssembly.Function,i={i:"i32",j:"i64",f:"f32",d:"f64",e:"externref",p:"i32"},o={parameters:[],results:"v"==t[0]?[]:[i[t[0]]]};for(var a=1;a<t.length;++a)o.parameters.push(i[t[a]]);t=new n(o,e)}else{for(n=[1],i=t.slice(0,1),t=t.slice(1),o={i:127,p:127,j:126,f:125,d:124,e:111},n.push(96),128>(a=t.length)?n.push(a):n.push(a%128|128,a>>7),a=0;a<t.length;++a)n.push(o[t[a]]);"v"==i?n.push(0):n.push(1,o[i]),t=[0,97,115,109,1,0,0,0,1],128>(i=n.length)?t.push(i):t.push(i%128|128,i>>7),t.push.apply(t,n),t.push(2,7,1,1,101,1,102,0,0,7,5,1,1,102,0,0),t=new WebAssembly.Module(new Uint8Array(t)),t=new WebAssembly.Instance(t,{e:{f:e}}).exports.f}n=r,ae.set(n,t),ue[n]=ae.get(n)}return se.set(e,r),r},ce={a:function(e,t,r){throw new j(e>>>=0).La(t>>>0,r>>>0),e},e:function(){return 0},L:function(){},A:function(){},C:function(){},u:function(){return 0},J:function(){},E:function(){},I:function(){},k:function(){},B:function(){},y:function(){},K:function(){},z:function(){},l:()=>1,o:function(e,t,r){e=t+2097152>>>0<4194305-!!e?(e>>>0)+4294967296*t:NaN,r>>>=0,e=new Date(1e3*e),x[r>>>2>>>0]=e.getUTCSeconds(),x[r+4>>>2>>>0]=e.getUTCMinutes(),x[r+8>>>2>>>0]=e.getUTCHours(),x[r+12>>>2>>>0]=e.getUTCDate(),x[r+16>>>2>>>0]=e.getUTCMonth(),x[r+20>>>2>>>0]=e.getUTCFullYear()-1900,x[r+24>>>2>>>0]=e.getUTCDay(),x[r+28>>>2>>>0]=(e.getTime()-Date.UTC(e.getUTCFullYear(),0,1,0,0,0,0))/864e5|0},p:function(e,t,r){e=t+2097152>>>0<4194305-!!e?(e>>>0)+4294967296*t:NaN,r>>>=0,e=new Date(1e3*e),x[r>>>2>>>0]=e.getSeconds(),x[r+4>>>2>>>0]=e.getMinutes(),x[r+8>>>2>>>0]=e.getHours(),x[r+12>>>2>>>0]=e.getDate(),x[r+16>>>2>>>0]=e.getMonth(),x[r+20>>>2>>>0]=e.getFullYear()-1900,x[r+24>>>2>>>0]=e.getDay(),x[r+28>>>2>>>0]=(Y(e.getFullYear())?X:K)[e.getMonth()]+e.getDate()-1|0,x[r+36>>>2>>>0]=-60*e.getTimezoneOffset(),t=new Date(e.getFullYear(),6,1).getTimezoneOffset();var n=new Date(e.getFullYear(),0,1).getTimezoneOffset();x[r+32>>>2>>>0]=0|(t!=n&&e.getTimezoneOffset()==Math.min(n,t))},q:function(e){e>>>=0;var t=new Date(x[e+20>>>2>>>0]+1900,x[e+16>>>2>>>0],x[e+12>>>2>>>0],x[e+8>>>2>>>0],x[e+4>>>2>>>0],x[e>>>2>>>0],0),r=x[e+32>>>2>>>0],n=t.getTimezoneOffset(),i=new Date(t.getFullYear(),6,1).getTimezoneOffset(),o=new Date(t.getFullYear(),0,1).getTimezoneOffset(),a=Math.min(o,i);return 0>r?x[e+32>>>2>>>0]=+(i!=o&&a==n):0<r!=(a==n)&&(i=Math.max(o,i),t.setTime(t.getTime()+6e4*((0<r?a:i)-n))),x[e+24>>>2>>>0]=t.getDay(),x[e+28>>>2>>>0]=(Y(t.getFullYear())?X:K)[t.getMonth()]+t.getDate()-1|0,x[e>>>2>>>0]=t.getSeconds(),x[e+4>>>2>>>0]=t.getMinutes(),x[e+8>>>2>>>0]=t.getHours(),x[e+12>>>2>>>0]=t.getDate(),x[e+16>>>2>>>0]=t.getMonth(),x[e+20>>>2>>>0]=t.getYear(),e=t.getTime(),isNaN(e)?(x[de()>>>2>>>0]=61,e=-1):e/=1e3,me((F=e,1<=+Math.abs(F)?0<F?+Math.floor(F/4294967296)>>>0:~~+Math.ceil((F-+(~~F>>>0))/4294967296)>>>0:0)),e>>>0},m:function(){return-52},n:function(){},w:function(e,t,r){function n(e){return(e=e.toTimeString().match(/\(([A-Za-z ]+)\)$/))?e[1]:"GMT"}r>>>=0;var i=(new Date).getFullYear(),o=new Date(i,0,1),a=new Date(i,6,1);i=o.getTimezoneOffset();var s=a.getTimezoneOffset();_[e>>>0>>>2>>>0]=60*Math.max(i,s),x[t>>>0>>>2>>>0]=+(i!=s),e=n(o),t=n(a),e=Z(e),t=Z(t),s<i?(_[r>>>2>>>0]=e,_[r+4>>>2>>>0]=t):(_[r>>>2>>>0]=t,_[r+4>>>2>>>0]=e)},d:()=>{$("")},D:function(e,t,r){e>>>=0,t>>>=0,r>>>=0,J.length=0;for(var n;n=b[t++>>>0];){var i=105!=n;r+=(i&=112!=n)&&r%8?4:0,J.push(112==n?_[r>>>2>>>0]:105==n?x[r>>>2>>>0]:S[r>>>3>>>0]),r+=i?8:4}return U[e].apply(null,J)},g:()=>Date.now(),x:function(){return 4294901760},b:()=>performance.now(),H:function(e,t,r){return t>>>=0,b.copyWithin(e>>>0>>>0,t>>>0,t+(r>>>0)>>>0)},v:function(e){e>>>=0;var t=b.length;if(4294901760<e)return!1;for(var r=1;4>=r;r*=2){var n=t*(1+.2/r);n=Math.min(n,e+100663296);var i=Math;n=Math.max(e,n);e:{i=(i.min.call(i,4294901760,n+(65536-n%65536)%65536)-w.buffer.byteLength+65535)/65536;try{w.grow(i),E();var o=1;break e}catch{}o=void 0}if(o)return!0}return!1},F:function(e,t){e>>>=0,t>>>=0;var r=0;return ee().forEach(((n,i)=>{var o=t+r;for(i=_[e+4*i>>>2>>>0]=o,o=0;o<n.length;++o)v[i++>>>0>>>0]=n.charCodeAt(o);v[i>>>0>>>0]=0,r+=n.length+1})),0},G:function(e,t){e>>>=0,t>>>=0;var r=ee();_[e>>>2>>>0]=r.length;var n=0;return r.forEach((e=>n+=e.length+1)),_[t>>>2>>>0]=n,0},f:()=>52,j:function(){return 52},r:function(){return 70},i:function(e,t,r,n){t>>>=0,r>>>=0,n>>>=0;for(var i=0,o=0;o<r;o++){var a=_[t>>>2>>>0],s=_[t+4>>>2>>>0];t+=8;for(var u=0;u<s;u++){var l=b[a+u>>>0],h=te[e];0===l||10===l?((1===e?m:g)(V(h,0)),h.length=0):h.push(l)}i+=s}return _[n>>>2>>>0]=i,0},s:function(e,t){return e>>>=0,re(b.subarray(e>>>0,e+(t>>>0)>>>0)),0},t:oe,c:function(e,t,r,n){return oe(e>>>0,t>>>0,r>>>0,n>>>0)},h:function(e,t,r,n){let i=ae.length;e=new Uint8Array(b.slice(e+t,e+r));try{var o,a=new WebAssembly.Module(e),s=new WebAssembly.Instance(a,{env:{memory:w}});for(o in s.exports)he(s.exports[o]);return i<ae.length?i:n}catch(e){return console.log(e),n}}},fe=function(){function e(e){return fe=e.exports,fe=function(){var e=fe;e=Object.assign({},e);var t=e=>()=>e()>>>0,r=e=>t=>e(t)>>>0;return e.pa=t(e.pa),e.qa=r(e.qa),e.ua=t(e.ua),e.wa=r(e.wa),e}(),w=fe.M,E(),ae=fe.sa,A.unshift(fe.N),0==--P&&(null!==k&&(clearInterval(k),k=null),C&&(e=C,C=null,e())),fe}var t={a:ce};if(P++,i.instantiateWasm)try{return i.instantiateWasm(t,e)}catch(e){g(`Module.instantiateWasm callback failed with error: ${e}`),n(e)}return function(e,t){var r=R;return"function"!=typeof WebAssembly.instantiateStreaming||D(r)||M(r)||f||"function"!=typeof fetch?N(r,e,t):fetch(r,{credentials:"same-origin"}).then((n=>WebAssembly.instantiateStreaming(n,e).then(t,(function(n){return g(`wasm streaming compile failed: ${n}`),g("falling back to ArrayBuffer instantiation"),N(r,e,t)}))))}(t,(function(t){e(t.instance)})).catch(n),{}}();i._OrtInit=(e,t)=>(i._OrtInit=fe.O)(e,t),i._OrtGetLastError=(e,t)=>(i._OrtGetLastError=fe.P)(e,t),i._OrtCreateSessionOptions=(e,t,r,n,o,a,s,u,l,h)=>(i._OrtCreateSessionOptions=fe.Q)(e,t,r,n,o,a,s,u,l,h),i._OrtAppendExecutionProvider=(e,t)=>(i._OrtAppendExecutionProvider=fe.R)(e,t),i._OrtAddFreeDimensionOverride=(e,t,r)=>(i._OrtAddFreeDimensionOverride=fe.S)(e,t,r),i._OrtAddSessionConfigEntry=(e,t,r)=>(i._OrtAddSessionConfigEntry=fe.T)(e,t,r),i._OrtReleaseSessionOptions=e=>(i._OrtReleaseSessionOptions=fe.U)(e),i._OrtCreateSession=(e,t,r)=>(i._OrtCreateSession=fe.V)(e,t,r),i._OrtReleaseSession=e=>(i._OrtReleaseSession=fe.W)(e),i._OrtGetInputOutputCount=(e,t,r)=>(i._OrtGetInputOutputCount=fe.X)(e,t,r),i._OrtGetInputName=(e,t)=>(i._OrtGetInputName=fe.Y)(e,t),i._OrtGetOutputName=(e,t)=>(i._OrtGetOutputName=fe.Z)(e,t),i._OrtFree=e=>(i._OrtFree=fe._)(e),i._OrtCreateTensor=(e,t,r,n,o,a)=>(i._OrtCreateTensor=fe.$)(e,t,r,n,o,a),i._OrtGetTensorData=(e,t,r,n,o)=>(i._OrtGetTensorData=fe.aa)(e,t,r,n,o),i._OrtReleaseTensor=e=>(i._OrtReleaseTensor=fe.ba)(e),i._OrtCreateRunOptions=(e,t,r,n)=>(i._OrtCreateRunOptions=fe.ca)(e,t,r,n),i._OrtAddRunConfigEntry=(e,t,r)=>(i._OrtAddRunConfigEntry=fe.da)(e,t,r),i._OrtReleaseRunOptions=e=>(i._OrtReleaseRunOptions=fe.ea)(e),i._OrtCreateBinding=e=>(i._OrtCreateBinding=fe.fa)(e),i._OrtBindInput=(e,t,r)=>(i._OrtBindInput=fe.ga)(e,t,r),i._OrtBindOutput=(e,t,r,n)=>(i._OrtBindOutput=fe.ha)(e,t,r,n),i._OrtClearBoundOutputs=e=>(i._OrtClearBoundOutputs=fe.ia)(e),i._OrtReleaseBinding=e=>(i._OrtReleaseBinding=fe.ja)(e),i._OrtRunWithBinding=(e,t,r,n,o)=>(i._OrtRunWithBinding=fe.ka)(e,t,r,n,o),i._OrtRun=(e,t,r,n,o,a,s,u)=>(i._OrtRun=fe.la)(e,t,r,n,o,a,s,u),i._OrtEndProfiling=e=>(i._OrtEndProfiling=fe.ma)(e),i._OrtConfigure=(e,t)=>(i._OrtConfigure=fe.na)(e,t),i._OrtAuth=(e,t)=>(i._OrtAuth=fe.oa)(e,t);var de=()=>(de=fe.pa)(),pe=i._malloc=e=>(pe=i._malloc=fe.qa)(e);i._free=e=>(i._free=fe.ra)(e);var ye,me=e=>(me=fe.ta)(e),ge=()=>(ge=fe.ua)(),we=e=>(we=fe.va)(e),ve=e=>(ve=fe.wa)(e);function be(){if(!(0<P)){if(i.preRun)for("function"==typeof i.preRun&&(i.preRun=[i.preRun]);i.preRun.length;){var e=i.preRun.shift();O.unshift(e)}for(;0<O.length;)O.shift()(i);if(!(0<P||ye||(ye=!0,i.calledRun=!0,T))){for(;0<A.length;)A.shift()(i);for(t(i);0<I.length;)I.shift()(i)}}}return i.___start_em_js=882709,i.___stop_em_js=883321,i.stackAlloc=ve,i.stackSave=ge,i.stackRestore=we,i.addFunction=he,i.UTF8ToString=W,i.stringToUTF8=(e,t,r)=>q(e,b,t,r),i.lengthBytesUTF8=H,C=function e(){ye||be(),ye||(C=e)},be(),e.ready});"object"==typeof e&&"object"==typeof t?t.exports=n:"function"==typeof define&&define.amd&&define([],(()=>n))})),kp=ye((()=>{})),Np=ye((()=>{})),Rp={};pr(Rp,{cpus:()=>gg});var gg,Mp=D((()=>{gg=void 0})),zp=ye(((e,t)=>{var r,n=(r=typeof document<"u"&&document.currentScript?document.currentScript.src:void 0,typeof __filename<"u"&&(r=r||__filename),function(e={}){function t(){return I.buffer!=C.buffer&&B(),C}function n(){return I.buffer!=C.buffer&&B(),$}function i(){return I.buffer!=C.buffer&&B(),R}function o(){return I.buffer!=C.buffer&&B(),D}function a(){return I.buffer!=C.buffer&&B(),M}var s,u,l=e;l.ready=new Promise(((e,t)=>{s=e,u=t}));var h,c,f,d=Object.assign({},l),p="./this.program",y=(e,t)=>{throw t},m="object"==typeof window,g="function"==typeof importScripts,w="object"==typeof process&&"object"==typeof process.versions&&"string"==typeof process.versions.node,v=l.ENVIRONMENT_IS_PTHREAD||!1,b="";function x(e){return l.locateFile?l.locateFile(e,b):b+e}if(w){var _=(sa(),jt(aa)),S=(la(),jt(ua));let e;b=g?S.dirname(b)+"/":__dirname+"/",h=(e,t)=>(e=X(e)?new URL(e):S.normalize(e),_.readFileSync(e,t?void 0:"utf8")),f=e=>((e=h(e,!0)).buffer||(e=new Uint8Array(e)),e),c=(e,t,r,n=!0)=>{e=X(e)?new URL(e):S.normalize(e),_.readFile(e,n?void 0:"utf8",((e,i)=>{e?r(e):t(n?i.buffer:i)}))},!l.thisProgram&&1<process.argv.length&&(p=process.argv[1].replace(/\\/g,"/")),process.argv.slice(2),y=(e,t)=>{throw process.exitCode=e,t},l.inspect=()=>"[Emscripten Module object]";try{e=kp()}catch(e){throw console.error('The "worker_threads" module is not supported in this node.js build - perhaps a newer version is needed?'),e}global.Worker=e.Worker}else(m||g)&&(g?b=self.location.href:typeof document<"u"&&document.currentScript&&(b=document.currentScript.src),typeof r<"u"&&r&&(b=r),b=0!==b.indexOf("blob:")?b.substr(0,b.replace(/[?#].*/,"").lastIndexOf("/")+1):"",w||(h=e=>{var t=new XMLHttpRequest;return t.open("GET",e,!1),t.send(null),t.responseText},g&&(f=e=>{var t=new XMLHttpRequest;return t.open("GET",e,!1),t.responseType="arraybuffer",t.send(null),new Uint8Array(t.response)}),c=(e,t,r)=>{var n=new XMLHttpRequest;n.open("GET",e,!0),n.responseType="arraybuffer",n.onload=()=>{200==n.status||0==n.status&&n.response?t(n.response):r()},n.onerror=r,n.send(null)}));w&&typeof performance>"u"&&(global.performance=Np().performance);var T=console.log.bind(console),E=console.error.bind(console);w&&(T=(...e)=>_.writeSync(1,e.join(" ")+"\n"),E=(...e)=>_.writeSync(2,e.join(" ")+"\n"));var O=T,A=E;Object.assign(l,d),d=null,"object"!=typeof WebAssembly&&H("no native wasm support detected");var I,P,k,C,$,R,D,M,L=!1;function B(){var e=I.buffer;l.HEAP8=C=new Int8Array(e),l.HEAP16=new Int16Array(e),l.HEAPU8=$=new Uint8Array(e),l.HEAPU16=new Uint16Array(e),l.HEAP32=R=new Int32Array(e),l.HEAPU32=D=new Uint32Array(e),l.HEAPF32=new Float32Array(e),l.HEAPF64=M=new Float64Array(e)}var N=16777216;if(v)I=l.wasmMemory;else if(l.wasmMemory)I=l.wasmMemory;else if(!((I=new WebAssembly.Memory({initial:N/65536,maximum:65536,shared:!0})).buffer instanceof SharedArrayBuffer))throw A("requested a shared WebAssembly.Memory but the returned buffer is not a SharedArrayBuffer, indicating that while the browser has SharedArrayBuffer it does not have WebAssembly threads support - you may need to set a flag"),w&&A("(on node you may need: --experimental-wasm-threads --experimental-wasm-bulk-memory and/or recent version)"),Error("bad memory");B(),N=I.buffer.byteLength;var F=[],U=[],j=[],z=0,G=null,V=null;function W(){if(0==--z&&(null!==G&&(clearInterval(G),G=null),V)){var e=V;V=null,e()}}function H(e){throw A(e="Aborted("+e+")"),L=!0,k=1,e=new WebAssembly.RuntimeError(e+". Build with -sASSERTIONS for more info."),u(e),e}var q,Y=e=>e.startsWith("data:application/octet-stream;base64,"),X=e=>e.startsWith("file://");function K(e){if(f)return f(e);throw"both async and sync fetching of the wasm failed"}function Z(e,t,r){return function(e){if(m||g){if("function"==typeof fetch&&!X(e))return fetch(e,{credentials:"same-origin"}).then((t=>{if(!t.ok)throw"failed to load wasm binary file at '"+e+"'";return t.arrayBuffer()})).catch((()=>K(e)));if(c)return new Promise(((t,r)=>{c(e,(e=>t(new Uint8Array(e))),r)}))}return Promise.resolve().then((()=>K(e)))}(e).then((e=>WebAssembly.instantiate(e,t))).then((e=>e)).then(r,(e=>{A(`failed to asynchronously prepare wasm: ${e}`),H(e)}))}Y(q="ort-wasm-threaded.wasm")||(q=x(q));var J,Q={886596:(e,t,r,i)=>{if(typeof l>"u"||!l.hb)return 1;if((e=ae(e>>>0)).startsWith("./")&&(e=e.substring(2)),!(e=l.hb.get(e)))return 2;if(i>>>=0,(t>>>=0)+(r>>>=0)>e.byteLength)return 3;try{return n().set(e.subarray(t,t+r),i>>>0),0}catch{return 4}}};function ee(e){this.name="ExitStatus",this.message=`Program terminated with exit(${e})`,this.status=e}var te=e=>{e.terminate(),e.onmessage=()=>{}},re=e=>{0==fe.Ta.length&&(ce(),fe.bb(fe.Ta[0]));var t=fe.Ta.pop();if(!t)return 6;fe.Ua.push(t),fe.Qa[e.Sa]=t,t.Sa=e.Sa;var r={cmd:"run",start_routine:e.ob,arg:e.lb,pthread_ptr:e.Sa};return w&&t.unref(),t.postMessage(r,e.ub),0},ne=0,ie=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0,oe=(e,t,r)=>{var n=(t>>>=0)+r;for(r=t;e[r]&&!(r>=n);)++r;if(16<r-t&&e.buffer&&ie)return ie.decode(e.buffer instanceof SharedArrayBuffer?e.slice(t,r):e.subarray(t,r));for(n="";t<r;){var i=e[t++];if(128&i){var o=63&e[t++];if(192==(224&i))n+=String.fromCharCode((31&i)<<6|o);else{var a=63&e[t++];65536>(i=224==(240&i)?(15&i)<<12|o<<6|a:(7&i)<<18|o<<12|a<<6|63&e[t++])?n+=String.fromCharCode(i):(i-=65536,n+=String.fromCharCode(55296|i>>10,56320|1023&i))}}else n+=String.fromCharCode(i)}return n},ae=(e,t)=>(e>>>=0)?oe(n(),e,t):"";function se(e,t){var r=arguments.length-2,n=arguments;return(e=>{var t=Tt();return e=e(),Et(t),e})((()=>{for(var i=Ot(8*r),o=i>>>3,s=0;s<r;s++){var u=n[2+s];a()[o+s>>>0]=u}return wt(e,r,i,t)}))}function ue(e){if(v)return se(0,1,e);k=e,0<ne||(fe.pb(),l.onExit?.(e),L=!0),y(e,new ee(e))}var le=e=>{if(k=e,v)throw pe(e),"unwind";ue(e)};function he(){for(var e=l.numThreads;e--;)ce();F.unshift((()=>{z++,function(e){v?e():Promise.all(fe.Ta.map(fe.bb)).then(e)}((()=>W()))}))}function ce(){var e=x("ort-wasm-threaded.worker.js");e=new Worker(e),fe.Ta.push(e)}var fe={Ta:[],Ua:[],gb:[],Qa:{},$a(){v?(fe.receiveObjectTransfer=fe.nb,fe.threadInitTLS=fe.fb,fe.setExitStatus=fe.eb):he()},eb:e=>k=e,xb:["$terminateWorker"],pb:()=>{for(var e of fe.Ua)te(e);for(e of fe.Ta)te(e);fe.Ta=[],fe.Ua=[],fe.Qa=[]},cb:e=>{var t=e.Sa;delete fe.Qa[t],fe.Ta.push(e),fe.Ua.splice(fe.Ua.indexOf(e),1),e.Sa=0,vt(t)},nb(){},fb(){fe.gb.forEach((e=>e()))},bb:e=>new Promise((t=>{e.onmessage=r=>{var n=(r=r.data).cmd;if(r.targetThread&&r.targetThread!=pt()){var i=fe.Qa[r.targetThread];i?i.postMessage(r,r.transferList):A(`Internal error! Worker sent a message "${n}" to target pthread ${r.targetThread}, but that thread no longer exists!`)}else"checkMailbox"===n?Ne():"spawnThread"===n?re(r):"cleanupThread"===n?fe.cb(fe.Qa[r.thread]):"killThread"===n?(r=r.thread,n=fe.Qa[r],delete fe.Qa[r],te(n),vt(r),fe.Ua.splice(fe.Ua.indexOf(n),1),n.Sa=0):"cancelThread"===n?fe.Qa[r.thread].postMessage({cmd:"cancel"}):"loaded"===n?(e.loaded=!0,w&&!e.Sa&&e.unref(),t(e)):"alert"===n?alert(`Thread ${r.threadId}: ${r.text}`):"setimmediate"===r.target?e.postMessage(r):"callHandler"===n?l[r.handler](...r.args):n&&A(`worker sent an unknown command ${n}`)},e.onerror=e=>{throw A(`worker sent an error! ${e.filename}:${e.lineno}: ${e.message}`),e},w&&(e.on("message",(t=>e.onmessage({data:t}))),e.on("error",(t=>e.onerror(t))));var n,i=[];for(n of["onExit"])l.hasOwnProperty(n)&&i.push(n);e.postMessage({cmd:"load",handlers:i,urlOrBlob:l.mainScriptUrlOrBlob||r,wasmMemory:I,wasmModule:P})}))};l.PThread=fe;var de=e=>{for(;0<e.length;)e.shift()(l)};function pe(e){if(v)return se(1,0,e);le(e)}l.establishStackSpace=()=>{var e=pt(),t=o()[e+52>>>2>>>0];e=o()[e+56>>>2>>>0],St(t,t-e),Et(t)};var ye,me=[],ge=e=>{var t=me[e];return t||(e>=me.length&&(me.length=e+1),me[e]=t=ye.get(e)),t};function we(e){this.Za=e-24,this.kb=function(e){o()[this.Za+4>>>2>>>0]=e},this.jb=function(e){o()[this.Za+8>>>2>>>0]=e},this.$a=function(e,t){this.ib(),this.kb(e),this.jb(t)},this.ib=function(){o()[this.Za+16>>>2>>>0]=0}}function ve(e,t,r,n){return v?se(2,1,e,t,r,n):be(e,t,r,n)}function be(e,t,r,n){if(e>>>=0,t>>>=0,r>>>=0,n>>>=0,typeof SharedArrayBuffer>"u")return A("Current environment does not support SharedArrayBuffer, pthreads are not available!"),6;var i=[];return v&&0===i.length?ve(e,t,r,n):(e={ob:r,Sa:e,lb:n,ub:i},v?(e.wb="spawnThread",postMessage(e,i),0):re(e))}function xe(e,t,r){return v?se(3,1,e,t,r):0}function _e(e,t){if(v)return se(4,1,e,t)}l.invokeEntryPoint=(e,t)=>{e=ge(e)(t),0<ne?fe.eb(e):bt(e)};var Se=e=>{for(var t=0,r=0;r<e.length;++r){var n=e.charCodeAt(r);127>=n?t++:2047>=n?t+=2:55296<=n&&57343>=n?(t+=4,++r):t+=3}return t},Te=(e,t,r,n)=>{if(!(0<n))return 0;var i=r>>>=0;n=r+n-1;for(var o=0;o<e.length;++o){var a=e.charCodeAt(o);if(55296<=a&&57343>=a&&(a=65536+((1023&a)<<10)|1023&e.charCodeAt(++o)),127>=a){if(r>=n)break;t[r++>>>0]=a}else{if(2047>=a){if(r+1>=n)break;t[r++>>>0]=192|a>>6}else{if(65535>=a){if(r+2>=n)break;t[r++>>>0]=224|a>>12}else{if(r+3>=n)break;t[r++>>>0]=240|a>>18,t[r++>>>0]=128|a>>12&63}t[r++>>>0]=128|a>>6&63}t[r++>>>0]=128|63&a}}return t[r>>>0]=0,r-i},Ee=(e,t,r)=>Te(e,n(),t,r);function Oe(e,t){if(v)return se(5,1,e,t)}function Ae(e,t,r){if(v)return se(6,1,e,t,r)}function Ie(e,t,r){return v?se(7,1,e,t,r):0}function Pe(e,t){if(v)return se(8,1,e,t)}function ke(e,t,r){if(v)return se(9,1,e,t,r)}function Ce(e,t,r,n){if(v)return se(10,1,e,t,r,n)}function $e(e,t,r,n){if(v)return se(11,1,e,t,r,n)}function Re(e,t,r,n){if(v)return se(12,1,e,t,r,n)}function De(e){if(v)return se(13,1,e)}function Me(e,t){if(v)return se(14,1,e,t)}function Le(e,t,r){if(v)return se(15,1,e,t,r)}function Be(e){e>>>=0,"function"==typeof Atomics.vb&&(Atomics.vb(i(),e>>>2,e).value.then(Ne),e+=128,Atomics.store(i(),e>>>2,1))}l.__emscripten_thread_mailbox_await=Be;var Ne=()=>{var e=pt();if(e&&(Be(e),e=xt,!L))try{if(e(),!(0<ne))try{v?bt(k):le(k)}catch(e){e instanceof ee||"unwind"==e||y(1,e)}}catch(e){e instanceof ee||"unwind"==e||y(1,e)}};l.checkMailbox=Ne;var Fe=[],Ue=e=>e%4==0&&(e%100!=0||e%400==0),je=[0,31,60,91,121,152,182,213,244,274,305,335],ze=[0,31,59,90,120,151,181,212,243,273,304,334];function Ge(e,t,r,n,i,o,a,s){return v?se(16,1,e,t,r,n,i,o,a,s):-52}function Ve(e,t,r,n,i,o,a){if(v)return se(17,1,e,t,r,n,i,o,a)}var We,He=e=>{var t=Se(e)+1,r=yt(t);return r&&Ee(e,r,t),r},qe=[],Ye={},Xe=()=>{if(!We){var e,t={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:("object"==typeof navigator&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",_:p||"./this.program"};for(e in Ye)void 0===Ye[e]?delete t[e]:t[e]=Ye[e];var r=[];for(e in t)r.push(`${e}=${t[e]}`);We=r}return We};function Ke(e,r){if(v)return se(18,1,e,r);e>>>=0,r>>>=0;var n=0;return Xe().forEach(((i,a)=>{var s=r+n;for(a=o()[e+4*a>>>2>>>0]=s,s=0;s<i.length;++s)t()[a++>>>0>>>0]=i.charCodeAt(s);t()[a>>>0>>>0]=0,n+=i.length+1})),0}function Ze(e,t){if(v)return se(19,1,e,t);e>>>=0,t>>>=0;var r=Xe();o()[e>>>2>>>0]=r.length;var n=0;return r.forEach((e=>n+=e.length+1)),o()[t>>>2>>>0]=n,0}function Je(e){return v?se(20,1,e):52}function Qe(e,t,r,n){return v?se(21,1,e,t,r,n):52}function et(e,t,r,n,i){return v?se(22,1,e,t,r,n,i):70}var tt=[null,[],[]];function rt(e,t,r,i){if(v)return se(23,1,e,t,r,i);t>>>=0,r>>>=0,i>>>=0;for(var a=0,s=0;s<r;s++){var u=o()[t>>>2>>>0],l=o()[t+4>>>2>>>0];t+=8;for(var h=0;h<l;h++){var c=n()[u+h>>>0],f=tt[e];0===c||10===c?((1===e?O:A)(oe(f,0)),f.length=0):f.push(c)}a+=l}return o()[i>>>2>>>0]=a,0}var nt=e=>(nt=(()=>{if("object"==typeof crypto&&"function"==typeof crypto.getRandomValues)return e=>(e.set(crypto.getRandomValues(new Uint8Array(e.byteLength))),e);if(w)try{var e=(ca(),jt(fa));if(e.randomFillSync)return t=>e.randomFillSync(t);var t=e.randomBytes;return e=>(e.set(t(e.byteLength)),e)}catch{}H("initRandomDevice")})())(e),it=[31,29,31,30,31,30,31,31,30,31,30,31],ot=[31,28,31,30,31,30,31,31,30,31,30,31];function at(e,r,n,a){function s(e,t,r){for(e="number"==typeof e?e.toString():e||"";e.length<t;)e=r[0]+e;return e}function u(e,t){return s(e,t,"0")}function l(e,t){function r(e){return 0>e?-1:0<e?1:0}var n;return 0===(n=r(e.getFullYear()-t.getFullYear()))&&0===(n=r(e.getMonth()-t.getMonth()))&&(n=r(e.getDate()-t.getDate())),n}function h(e){switch(e.getDay()){case 0:return new Date(e.getFullYear()-1,11,29);case 1:return e;case 2:return new Date(e.getFullYear(),0,3);case 3:return new Date(e.getFullYear(),0,2);case 4:return new Date(e.getFullYear(),0,1);case 5:return new Date(e.getFullYear()-1,11,31);case 6:return new Date(e.getFullYear()-1,11,30)}}function c(e){var t=e.Va;for(e=new Date(new Date(e.Wa+1900,0,1).getTime());0<t;){var r=e.getMonth(),n=(Ue(e.getFullYear())?it:ot)[r];if(!(t>n-e.getDate())){e.setDate(e.getDate()+t);break}t-=n-e.getDate()+1,e.setDate(1),11>r?e.setMonth(r+1):(e.setMonth(0),e.setFullYear(e.getFullYear()+1))}return r=new Date(e.getFullYear()+1,0,4),t=h(new Date(e.getFullYear(),0,4)),r=h(r),0>=l(t,e)?0>=l(r,e)?e.getFullYear()+1:e.getFullYear():e.getFullYear()-1}e>>>=0,r>>>=0,n>>>=0,a>>>=0;var f=o()[a+40>>>2>>>0];for(var d in a={sb:i()[a>>>2>>>0],rb:i()[a+4>>>2>>>0],Xa:i()[a+8>>>2>>>0],ab:i()[a+12>>>2>>>0],Ya:i()[a+16>>>2>>>0],Wa:i()[a+20>>>2>>>0],Ra:i()[a+24>>>2>>>0],Va:i()[a+28>>>2>>>0],yb:i()[a+32>>>2>>>0],qb:i()[a+36>>>2>>>0],tb:f?ae(f):""},n=ae(n),f={"%c":"%a %b %d %H:%M:%S %Y","%D":"%m/%d/%y","%F":"%Y-%m-%d","%h":"%b","%r":"%I:%M:%S %p","%R":"%H:%M","%T":"%H:%M:%S","%x":"%m/%d/%y","%X":"%H:%M:%S","%Ec":"%c","%EC":"%C","%Ex":"%m/%d/%y","%EX":"%H:%M:%S","%Ey":"%y","%EY":"%Y","%Od":"%d","%Oe":"%e","%OH":"%H","%OI":"%I","%Om":"%m","%OM":"%M","%OS":"%S","%Ou":"%u","%OU":"%U","%OV":"%V","%Ow":"%w","%OW":"%W","%Oy":"%y"})n=n.replace(new RegExp(d,"g"),f[d]);var p="Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),y="January February March April May June July August September October November December".split(" ");for(d in f={"%a":e=>p[e.Ra].substring(0,3),"%A":e=>p[e.Ra],"%b":e=>y[e.Ya].substring(0,3),"%B":e=>y[e.Ya],"%C":e=>u((e.Wa+1900)/100|0,2),"%d":e=>u(e.ab,2),"%e":e=>s(e.ab,2," "),"%g":e=>c(e).toString().substring(2),"%G":e=>c(e),"%H":e=>u(e.Xa,2),"%I":e=>(0==(e=e.Xa)?e=12:12<e&&(e-=12),u(e,2)),"%j":e=>{for(var t=0,r=0;r<=e.Ya-1;t+=(Ue(e.Wa+1900)?it:ot)[r++]);return u(e.ab+t,3)},"%m":e=>u(e.Ya+1,2),"%M":e=>u(e.rb,2),"%n":()=>"\n","%p":e=>0<=e.Xa&&12>e.Xa?"AM":"PM","%S":e=>u(e.sb,2),"%t":()=>"\t","%u":e=>e.Ra||7,"%U":e=>u(Math.floor((e.Va+7-e.Ra)/7),2),"%V":e=>{var t=Math.floor((e.Va+7-(e.Ra+6)%7)/7);if(2>=(e.Ra+371-e.Va-2)%7&&t++,t)53==t&&(4==(r=(e.Ra+371-e.Va)%7)||3==r&&Ue(e.Wa)||(t=1));else{t=52;var r=(e.Ra+7-e.Va-1)%7;(4==r||5==r&&Ue(e.Wa%400-1))&&t++}return u(t,2)},"%w":e=>e.Ra,"%W":e=>u(Math.floor((e.Va+7-(e.Ra+6)%7)/7),2),"%y":e=>(e.Wa+1900).toString().substring(2),"%Y":e=>e.Wa+1900,"%z":e=>(0<=(e=e.qb)?"+":"-")+("0000"+((e=Math.abs(e)/60)/60*100+e%60)).slice(-4),"%Z":e=>e.tb,"%%":()=>"%"},n=n.replace(/%%/g,"\0\0"),f)n.includes(d)&&(n=n.replace(new RegExp(d,"g"),f[d](a)));return d=function(e){var t=Array(Se(e)+1);return Te(e,t,0,t.length),t}(n=n.replace(/\0\0/g,"%")),d.length>r?0:(((e,r)=>{t().set(e,r>>>0)})(d,e),d.length-1)}var st,ut=[],lt=(e,t)=>{if(!st){st=new WeakMap;var r=ye.length;if(st)for(var n=0;n<0+r;n++){var i=ge(n);i&&st.set(i,n)}}if(r=st.get(e)||0)return r;if(ut.length)r=ut.pop();else{try{ye.grow(1)}catch(e){throw e instanceof RangeError?"Unable to grow wasm table. Set ALLOW_TABLE_GROWTH.":e}r=ye.length-1}try{n=r,ye.set(n,e),me[n]=ye.get(n)}catch(s){if(!(s instanceof TypeError))throw s;if("function"==typeof WebAssembly.Function){n=WebAssembly.Function,i={i:"i32",j:"i64",f:"f32",d:"f64",e:"externref",p:"i32"};for(var o={parameters:[],results:"v"==t[0]?[]:[i[t[0]]]},a=1;a<t.length;++a)o.parameters.push(i[t[a]]);t=new n(o,e)}else{for(n=[1],i=t.slice(0,1),t=t.slice(1),o={i:127,p:127,j:126,f:125,d:124,e:111},n.push(96),128>(a=t.length)?n.push(a):n.push(a%128|128,a>>7),a=0;a<t.length;++a)n.push(o[t[a]]);"v"==i?n.push(0):n.push(1,o[i]),t=[0,97,115,109,1,0,0,0,1],128>(i=n.length)?t.push(i):t.push(i%128|128,i>>7),t.push.apply(t,n),t.push(2,7,1,1,101,1,102,0,0,7,5,1,1,102,0,0),t=new WebAssembly.Module(new Uint8Array(t)),t=new WebAssembly.Instance(t,{e:{f:e}}).exports.f}n=r,ye.set(n,t),me[n]=ye.get(n)}return st.set(e,r),r};fe.$a();var ht=[ue,pe,ve,xe,_e,Oe,Ae,Ie,Pe,ke,Ce,$e,Re,De,Me,Le,Ge,Ve,Ke,Ze,Je,Qe,et,rt],ct={b:function(e,t,r){throw new we(e>>>=0).$a(t>>>0,r>>>0),e},O:function(e){mt(e>>>0,!g,1,!m,131072,!1),fe.fb()},m:function(e){e>>>=0,v?postMessage({cmd:"cleanupThread",thread:e}):fe.cb(fe.Qa[e])},J:be,h:xe,U:_e,F:Oe,H:Ae,y:Ie,S:Pe,L:ke,R:Ce,o:$e,G:Re,D:De,T:Me,E:Le,p:()=>1,B:function(e,t){(e>>>=0)==t>>>0?setTimeout((()=>Ne())):v?postMessage({targetThread:e,cmd:"checkMailbox"}):(e=fe.Qa[e])&&e.postMessage({cmd:"checkMailbox"})},K:function(e,t,r,n){t>>>=0,Fe.length=r,n=n>>>0>>>3;for(var i=0;i<r;i++)Fe[i]=a()[n+i>>>0];return e=0>e?Q[-e-1]:ht[e],fe.mb=t,t=e.apply(null,Fe),fe.mb=0,t},M:Be,W:function(e){w&&fe.Qa[e>>>0].ref()},s:function(e,t,r){e=t+2097152>>>0<4194305-!!e?(e>>>0)+4294967296*t:NaN,r>>>=0,e=new Date(1e3*e),i()[r>>>2>>>0]=e.getUTCSeconds(),i()[r+4>>>2>>>0]=e.getUTCMinutes(),i()[r+8>>>2>>>0]=e.getUTCHours(),i()[r+12>>>2>>>0]=e.getUTCDate(),i()[r+16>>>2>>>0]=e.getUTCMonth(),i()[r+20>>>2>>>0]=e.getUTCFullYear()-1900,i()[r+24>>>2>>>0]=e.getUTCDay(),e=(e.getTime()-Date.UTC(e.getUTCFullYear(),0,1,0,0,0,0))/864e5|0,i()[r+28>>>2>>>0]=e},t:function(e,t,r){e=t+2097152>>>0<4194305-!!e?(e>>>0)+4294967296*t:NaN,r>>>=0,e=new Date(1e3*e),i()[r>>>2>>>0]=e.getSeconds(),i()[r+4>>>2>>>0]=e.getMinutes(),i()[r+8>>>2>>>0]=e.getHours(),i()[r+12>>>2>>>0]=e.getDate(),i()[r+16>>>2>>>0]=e.getMonth(),i()[r+20>>>2>>>0]=e.getFullYear()-1900,i()[r+24>>>2>>>0]=e.getDay(),t=(Ue(e.getFullYear())?je:ze)[e.getMonth()]+e.getDate()-1|0,i()[r+28>>>2>>>0]=t,i()[r+36>>>2>>>0]=-60*e.getTimezoneOffset(),t=new Date(e.getFullYear(),6,1).getTimezoneOffset();var n=new Date(e.getFullYear(),0,1).getTimezoneOffset();e=0|(t!=n&&e.getTimezoneOffset()==Math.min(n,t)),i()[r+32>>>2>>>0]=e},u:function(e){e>>>=0;var t=new Date(i()[e+20>>>2>>>0]+1900,i()[e+16>>>2>>>0],i()[e+12>>>2>>>0],i()[e+8>>>2>>>0],i()[e+4>>>2>>>0],i()[e>>>2>>>0],0),r=i()[e+32>>>2>>>0],n=t.getTimezoneOffset(),o=new Date(t.getFullYear(),6,1).getTimezoneOffset(),a=new Date(t.getFullYear(),0,1).getTimezoneOffset(),s=Math.min(a,o);return 0>r?i()[e+32>>>2>>>0]=+(o!=a&&s==n):0<r!=(s==n)&&(o=Math.max(a,o),t.setTime(t.getTime()+6e4*((0<r?s:o)-n))),i()[e+24>>>2>>>0]=t.getDay(),r=(Ue(t.getFullYear())?je:ze)[t.getMonth()]+t.getDate()-1|0,i()[e+28>>>2>>>0]=r,i()[e>>>2>>>0]=t.getSeconds(),i()[e+4>>>2>>>0]=t.getMinutes(),i()[e+8>>>2>>>0]=t.getHours(),i()[e+12>>>2>>>0]=t.getDate(),i()[e+16>>>2>>>0]=t.getMonth(),i()[e+20>>>2>>>0]=t.getYear(),e=t.getTime(),isNaN(e)?(i()[dt()>>>2>>>0]=61,e=-1):e/=1e3,_t((J=e,1<=+Math.abs(J)?0<J?+Math.floor(J/4294967296)>>>0:~~+Math.ceil((J-+(~~J>>>0))/4294967296)>>>0:0)),e>>>0},q:Ge,r:Ve,A:function(e,t,r){function n(e){return(e=e.toTimeString().match(/\(([A-Za-z ]+)\)$/))?e[1]:"GMT"}e>>>=0,t>>>=0,r>>>=0;var a=(new Date).getFullYear(),s=new Date(a,0,1),u=new Date(a,6,1);a=s.getTimezoneOffset();var l=u.getTimezoneOffset(),h=Math.max(a,l);o()[e>>>2>>>0]=60*h,i()[t>>>2>>>0]=+(a!=l),e=n(s),t=n(u),e=He(e),t=He(t),l<a?(o()[r>>>2>>>0]=e,o()[r+4>>>2>>>0]=t):(o()[r>>>2>>>0]=t,o()[r+4>>>2>>>0]=e)},c:()=>{H("")},N:function(e,t,r){e>>>=0,t>>>=0,r>>>=0,qe.length=0;for(var s;s=n()[t++>>>0];){var u=105!=s;r+=(u&=112!=s)&&r%8?4:0,qe.push(112==s?o()[r>>>2>>>0]:105==s?i()[r>>>2>>>0]:a()[r>>>3>>>0]),r+=u?8:4}return Q[e].apply(null,qe)},n:()=>{},i:()=>Date.now(),V:()=>{throw ne+=1,"unwind"},C:function(){return 4294901760},e:()=>performance.timeOrigin+performance.now(),f:()=>w?(Mp(),jt(Rp)).cpus().length:navigator.hardwareConcurrency,z:function(e){e>>>=0;var t=n().length;if(e<=t||4294901760<e)return!1;for(var r=1;4>=r;r*=2){var i=t*(1+.2/r);i=Math.min(i,e+100663296);var o=Math;i=Math.max(e,i);e:{o=(o.min.call(o,4294901760,i+(65536-i%65536)%65536)-I.buffer.byteLength+65535)/65536;try{I.grow(o),B();var a=1;break e}catch{}a=void 0}if(a)return!0}return!1},P:Ke,Q:Ze,I:le,g:Je,l:Qe,v:et,k:rt,w:function(e,t){return e>>>=0,t>>>=0,nt(n().subarray(e>>>0,e+t>>>0)),0},a:I||l.wasmMemory,x:at,d:function(e,t,r,n){return at(e>>>0,t>>>0,r>>>0,n>>>0)},j:function(e,t,r,i){let o=ye.length;e=new Uint8Array(n().slice(e+t,e+r));try{var a,s=new WebAssembly.Module(e),u=new WebAssembly.Instance(s,{env:{memory:I}});for(a in u.exports)lt(u.exports[a]);return o<ye.length?o:i}catch(e){return console.log(e),i}}},ft=function(){function e(e,t){return ft=e.exports,ft=function(){var e=ft;e=Object.assign({},e);var t=e=>()=>e()>>>0,r=e=>t=>e(t)>>>0;return e.za=t(e.za),e.Aa=t(e.Aa),e.Ba=r(e.Ba),e.emscripten_main_runtime_thread_id=t(e.emscripten_main_runtime_thread_id),e.Na=t(e.Na),e.Pa=r(e.Pa),e}(),fe.gb.push(ft.Da),ye=ft.Ea,U.unshift(ft.X),P=t,W(),ft}var t={a:ct};if(z++,l.instantiateWasm)try{return l.instantiateWasm(t,e)}catch(e){A(`Module.instantiateWasm callback failed with error: ${e}`),u(e)}return function(e,t){var r=q;return"function"!=typeof WebAssembly.instantiateStreaming||Y(r)||X(r)||w||"function"!=typeof fetch?Z(r,e,t):fetch(r,{credentials:"same-origin"}).then((n=>WebAssembly.instantiateStreaming(n,e).then(t,(function(n){return A(`wasm streaming compile failed: ${n}`),A("falling back to ArrayBuffer instantiation"),Z(r,e,t)}))))}(t,(function(t){e(t.instance,t.module)})).catch(u),{}}();l._OrtInit=(e,t)=>(l._OrtInit=ft.Y)(e,t),l._OrtGetLastError=(e,t)=>(l._OrtGetLastError=ft.Z)(e,t),l._OrtCreateSessionOptions=(e,t,r,n,i,o,a,s,u,h)=>(l._OrtCreateSessionOptions=ft._)(e,t,r,n,i,o,a,s,u,h),l._OrtAppendExecutionProvider=(e,t)=>(l._OrtAppendExecutionProvider=ft.$)(e,t),l._OrtAddFreeDimensionOverride=(e,t,r)=>(l._OrtAddFreeDimensionOverride=ft.aa)(e,t,r),l._OrtAddSessionConfigEntry=(e,t,r)=>(l._OrtAddSessionConfigEntry=ft.ba)(e,t,r),l._OrtReleaseSessionOptions=e=>(l._OrtReleaseSessionOptions=ft.ca)(e),l._OrtCreateSession=(e,t,r)=>(l._OrtCreateSession=ft.da)(e,t,r),l._OrtReleaseSession=e=>(l._OrtReleaseSession=ft.ea)(e),l._OrtGetInputOutputCount=(e,t,r)=>(l._OrtGetInputOutputCount=ft.fa)(e,t,r),l._OrtGetInputName=(e,t)=>(l._OrtGetInputName=ft.ga)(e,t),l._OrtGetOutputName=(e,t)=>(l._OrtGetOutputName=ft.ha)(e,t),l._OrtFree=e=>(l._OrtFree=ft.ia)(e),l._OrtCreateTensor=(e,t,r,n,i,o)=>(l._OrtCreateTensor=ft.ja)(e,t,r,n,i,o),l._OrtGetTensorData=(e,t,r,n,i)=>(l._OrtGetTensorData=ft.ka)(e,t,r,n,i),l._OrtReleaseTensor=e=>(l._OrtReleaseTensor=ft.la)(e),l._OrtCreateRunOptions=(e,t,r,n)=>(l._OrtCreateRunOptions=ft.ma)(e,t,r,n),l._OrtAddRunConfigEntry=(e,t,r)=>(l._OrtAddRunConfigEntry=ft.na)(e,t,r),l._OrtReleaseRunOptions=e=>(l._OrtReleaseRunOptions=ft.oa)(e),l._OrtCreateBinding=e=>(l._OrtCreateBinding=ft.pa)(e),l._OrtBindInput=(e,t,r)=>(l._OrtBindInput=ft.qa)(e,t,r),l._OrtBindOutput=(e,t,r,n)=>(l._OrtBindOutput=ft.ra)(e,t,r,n),l._OrtClearBoundOutputs=e=>(l._OrtClearBoundOutputs=ft.sa)(e),l._OrtReleaseBinding=e=>(l._OrtReleaseBinding=ft.ta)(e),l._OrtRunWithBinding=(e,t,r,n,i)=>(l._OrtRunWithBinding=ft.ua)(e,t,r,n,i),l._OrtRun=(e,t,r,n,i,o,a,s)=>(l._OrtRun=ft.va)(e,t,r,n,i,o,a,s),l._OrtEndProfiling=e=>(l._OrtEndProfiling=ft.wa)(e),l._OrtConfigure=(e,t)=>(l._OrtConfigure=ft.xa)(e,t),l._OrtAuth=(e,t)=>(l._OrtAuth=ft.ya)(e,t);var dt=()=>(dt=ft.za)(),pt=l._pthread_self=()=>(pt=l._pthread_self=ft.Aa)(),yt=l._malloc=e=>(yt=l._malloc=ft.Ba)(e);l._free=e=>(l._free=ft.Ca)(e),l.__emscripten_tls_init=()=>(l.__emscripten_tls_init=ft.Da)();var mt=l.__emscripten_thread_init=(e,t,r,n,i,o)=>(mt=l.__emscripten_thread_init=ft.Fa)(e,t,r,n,i,o);l.__emscripten_thread_crashed=()=>(l.__emscripten_thread_crashed=ft.Ga)();var gt,wt=(e,t,r,n)=>(wt=ft.Ha)(e,t,r,n),vt=e=>(vt=ft.Ia)(e),bt=l.__emscripten_thread_exit=e=>(bt=l.__emscripten_thread_exit=ft.Ja)(e),xt=()=>(xt=ft.Ka)(),_t=e=>(_t=ft.La)(e),St=(e,t)=>(St=ft.Ma)(e,t),Tt=()=>(Tt=ft.Na)(),Et=e=>(Et=ft.Oa)(e),Ot=e=>(Ot=ft.Pa)(e);function At(){if(!(0<z))if(v)s(l),v||de(U),startWorker(l);else{if(l.preRun)for("function"==typeof l.preRun&&(l.preRun=[l.preRun]);l.preRun.length;)F.unshift(l.preRun.shift());de(F),0<z||gt||(gt=!0,l.calledRun=!0,L||(v||de(U),s(l),v||de(j)))}}return l.___start_em_js=887097,l.___stop_em_js=887709,l.wasmMemory=I,l.stackAlloc=Ot,l.stackSave=Tt,l.stackRestore=Et,l.keepRuntimeAlive=()=>0<ne,l.addFunction=lt,l.UTF8ToString=ae,l.stringToUTF8=Ee,l.lengthBytesUTF8=Se,l.ExitStatus=ee,l.PThread=fe,V=function e(){gt||At(),gt||(V=e)},At(),e.ready});"object"==typeof e&&"object"==typeof t?t.exports=n:"function"==typeof define&&define.amd&&define([],(()=>n))})),Wp=ye(((e,t)=>{t.exports='"use strict";var Module={},ENVIRONMENT_IS_NODE=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string";if(ENVIRONMENT_IS_NODE){var nodeWorkerThreads=require("worker_threads"),parentPort=nodeWorkerThreads.parentPort;parentPort.on("message",e=>onmessage({data:e}));var fs=require("fs"),vm=require("vm");Object.assign(global,{self:global,require,Module,location:{href:__filename},Worker:nodeWorkerThreads.Worker,importScripts:e=>vm.runInThisContext(fs.readFileSync(e,"utf8"),{filename:e}),postMessage:e=>parentPort.postMessage(e),performance:global.performance||{now:Date.now}})}var initializedJS=!1;function threadPrintErr(){var e=Array.prototype.slice.call(arguments).join(" ");if(ENVIRONMENT_IS_NODE){fs.writeSync(2,e+`\n`);return}console.error(e)}function threadAlert(){var e=Array.prototype.slice.call(arguments).join(" ");postMessage({cmd:"alert",text:e,threadId:Module._pthread_self()})}var err=threadPrintErr;self.alert=threadAlert,Module.instantiateWasm=(e,t)=>{var a=Module.wasmModule;Module.wasmModule=null;var r=new WebAssembly.Instance(a,e);return t(r)},self.onunhandledrejection=e=>{throw e.reason||e};function handleMessage(e){try{if(e.data.cmd==="load"){let a=[];self.onmessage=r=>a.push(r),self.startWorker=r=>{Module=r,postMessage({cmd:"loaded"});for(let s of a)handleMessage(s);self.onmessage=handleMessage},Module.wasmModule=e.data.wasmModule;for(const r of e.data.handlers)Module[r]=(...s)=>{postMessage({cmd:"callHandler",handler:r,args:s})};if(Module.wasmMemory=e.data.wasmMemory,Module.buffer=Module.wasmMemory.buffer,Module.ENVIRONMENT_IS_PTHREAD=!0,typeof e.data.urlOrBlob=="string")importScripts(e.data.urlOrBlob);else{var t=URL.createObjectURL(e.data.urlOrBlob);importScripts(t),URL.revokeObjectURL(t)}ortWasmThreaded(Module)}else if(e.data.cmd==="run"){Module.__emscripten_thread_init(e.data.pthread_ptr,0,0,1),Module.__emscripten_thread_mailbox_await(e.data.pthread_ptr),Module.establishStackSpace(),Module.PThread.receiveObjectTransfer(e.data),Module.PThread.threadInitTLS(),initializedJS||(initializedJS=!0);try{Module.invokeEntryPoint(e.data.start_routine,e.data.arg)}catch(a){if(a!="unwind")throw a}}else e.data.cmd==="cancel"?Module._pthread_self()&&Module.__emscripten_thread_exit(-1):e.data.target==="setimmediate"||(e.data.cmd==="checkMailbox"?initializedJS&&Module.checkMailbox():e.data.cmd&&(err(`worker.js received unknown command ${e.data.cmd}`),err(e.data)))}catch(a){throw Module.__emscripten_thread_crashed?.(),a}}self.onmessage=handleMessage;\n'})),Hp,Tg,ha,ma,$o,Vp,xg,wg,vg,jp,Se,Kr=D((()=>{Hp=$p(),Tg=zp(),ma=!1,$o=!1,Vp=!1,xg=e=>{if(1===e)return!1;if(typeof SharedArrayBuffer>"u")return typeof self<"u"&&!self.crossOriginIsolated&&console.warn("env.wasm.numThreads is set to "+e+", but this will not work unless you enable crossOriginIsolated mode. See https://web.dev/cross-origin-isolation-guide/ for more info."),!1;typeof process<"u"&&process.versions&&process.versions.node&&console.warn("env.wasm.numThreads is set to "+e+", however, currently onnxruntime-web does not support multi-threads in Node.js. Please consider using onnxruntime-node for performance critical scenarios.");try{return typeof MessageChannel<"u"&&(new MessageChannel).port1.postMessage(new SharedArrayBuffer(1)),WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,5,4,1,3,1,1,10,11,1,9,0,65,0,254,16,2,0,26,11]))}catch{return!1}},wg=()=>{try{return WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,10,30,1,28,0,65,0,253,15,253,12,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,253,186,1,26,11]))}catch{return!1}},vg=(e,t)=>e?t?"ort-wasm-simd-threaded.wasm":"ort-wasm-simd.wasm":t?"ort-wasm-threaded.wasm":"ort-wasm.wasm",jp=async e=>{if(ma)return Promise.resolve();if($o)throw new Error("multiple calls to 'initializeWebAssembly()' detected.");if(Vp)throw new Error("previous call to 'initializeWebAssembly()' failed.");$o=!0;let t=e.initTimeout,r=e.numThreads,n=e.simd,i=xg(r),o=n&&wg(),a=e.wasmPaths,s="string"==typeof a?a:void 0,u=vg(o,i),l="object"==typeof a?a[u]:void 0,h=!1,c=[];if(t>0&&c.push(new Promise((e=>{setTimeout((()=>{h=!0,e()}),t)}))),c.push(new Promise(((e,t)=>{let n=i?Tg:Hp,o={locateFile:(e,t)=>i&&e.endsWith(".worker.js")&&typeof Blob<"u"?URL.createObjectURL(new Blob([Wp()],{type:"text/javascript"})):e.endsWith(".wasm")?l||(s??t)+u:t+e};if(i)if(o.numThreads=r,typeof Blob>"u")o.mainScriptUrlOrBlob=(void 0)(__dirname,"ort-wasm-threaded.js");else{let e=`var ortWasmThreaded=${n.toString()};`;o.mainScriptUrlOrBlob=new Blob([e],{type:"text/javascript"})}n(o).then((t=>{$o=!1,ma=!0,ha=t,e()}),(e=>{$o=!1,Vp=!0,t(e)}))}))),await Promise.race(c),h)throw new Error(`WebAssembly backend initializing failed due to timeout: ${t}ms`)},Se=()=>{if(ma&&ha)return ha;throw new Error("WebAssembly is not initialized yet.")}})),Ie,_n,Ae,ko=D((()=>{Kr(),Ie=(e,t)=>{let r=Se(),n=r.lengthBytesUTF8(e)+1,i=r._malloc(n);return r.stringToUTF8(e,i,n),t.push(i),i},_n=(e,t,r,n)=>{if("object"==typeof e&&null!==e){if(r.has(e))throw new Error("Circular reference in options");r.add(e)}Object.entries(e).forEach((([e,i])=>{let o=t?t+e:e;if("object"==typeof i)_n(i,o+".",r,n);else if("string"==typeof i||"number"==typeof i)n(o,i.toString());else{if("boolean"!=typeof i)throw new Error("Can't handle extra config type: "+typeof i);n(o,i?"1":"0")}}))},Ae=e=>{let t=Se(),r=t.stackSave();try{let r=t.stackAlloc(8);t._OrtGetLastError(r,r+4);let n=t.HEAP32[r/4],i=t.HEAPU32[r/4+1],o=i?t.UTF8ToString(i):"";throw new Error(`${e} ERROR_CODE: ${n}, ERROR_MESSAGE: ${o}`)}finally{t.stackRestore(r)}}})),qp,Yp=D((()=>{Kr(),ko(),qp=e=>{let t=Se(),r=0,n=[],i=e||{};try{if(void 0===e?.logSeverityLevel)i.logSeverityLevel=2;else if("number"!=typeof e.logSeverityLevel||!Number.isInteger(e.logSeverityLevel)||e.logSeverityLevel<0||e.logSeverityLevel>4)throw new Error(`log serverity level is not valid: ${e.logSeverityLevel}`);if(void 0===e?.logVerbosityLevel)i.logVerbosityLevel=0;else if("number"!=typeof e.logVerbosityLevel||!Number.isInteger(e.logVerbosityLevel))throw new Error(`log verbosity level is not valid: ${e.logVerbosityLevel}`);void 0===e?.terminate&&(i.terminate=!1);let o=0;return void 0!==e?.tag&&(o=Ie(e.tag,n)),r=t._OrtCreateRunOptions(i.logSeverityLevel,i.logVerbosityLevel,!!i.terminate,o),0===r&&Ae("Can't create run options."),void 0!==e?.extra&&_n(e.extra,"",new WeakSet,((e,i)=>{let o=Ie(e,n),a=Ie(i,n);0!==t._OrtAddRunConfigEntry(r,o,a)&&Ae(`Can't set a run config entry: ${e} - ${i}.`)})),[r,n]}catch(e){throw 0!==r&&t._OrtReleaseRunOptions(r),n.forEach((e=>t._free(e))),e}}})),_g,Og,Sg,Ig,Xp,Kp=D((()=>{Kr(),ko(),_g=e=>{switch(e){case"disabled":return 0;case"basic":return 1;case"extended":return 2;case"all":return 99;default:throw new Error(`unsupported graph optimization level: ${e}`)}},Og=e=>{switch(e){case"sequential":return 0;case"parallel":return 1;default:throw new Error(`unsupported execution mode: ${e}`)}},Sg=e=>{e.extra||(e.extra={}),e.extra.session||(e.extra.session={});let t=e.extra.session;t.use_ort_model_bytes_directly||(t.use_ort_model_bytes_directly="1"),e.executionProviders&&e.executionProviders.some((e=>"webgpu"===("string"==typeof e?e:e.name)))&&(e.enableMemPattern=!1)},Ig=(e,t,r)=>{for(let n of t){let t="string"==typeof n?n:n.name;switch(t){case"webnn":if(t="WEBNN","string"!=typeof n){let t=n;if(t?.deviceType){let n=Ie("deviceType",r),i=Ie(t.deviceType,r);0!==Se()._OrtAddSessionConfigEntry(e,n,i)&&Ae(`Can't set a session config entry: 'deviceType' - ${t.deviceType}.`)}if(t?.numThreads){let n=t.numThreads;("number"!=typeof n||!Number.isInteger(n)||n<0)&&(n=0);let i=Ie("numThreads",r),o=Ie(n.toString(),r);0!==Se()._OrtAddSessionConfigEntry(e,i,o)&&Ae(`Can't set a session config entry: 'numThreads' - ${t.numThreads}.`)}if(t?.powerPreference){let n=Ie("powerPreference",r),i=Ie(t.powerPreference,r);0!==Se()._OrtAddSessionConfigEntry(e,n,i)&&Ae(`Can't set a session config entry: 'powerPreference' - ${t.powerPreference}.`)}}break;case"webgpu":if(t="JS","string"!=typeof n){let t=n;if(t?.preferredLayout){if("NCHW"!==t.preferredLayout&&"NHWC"!==t.preferredLayout)throw new Error(`preferredLayout must be either 'NCHW' or 'NHWC': ${t.preferredLayout}`);let n=Ie("preferredLayout",r),i=Ie(t.preferredLayout,r);0!==Se()._OrtAddSessionConfigEntry(e,n,i)&&Ae(`Can't set a session config entry: 'preferredLayout' - ${t.preferredLayout}.`)}}break;case"wasm":case"cpu":continue;default:throw new Error(`not supported execution provider: ${t}`)}let i=Ie(t,r);0!==Se()._OrtAppendExecutionProvider(e,i)&&Ae(`Can't append execution provider: ${t}.`)}},Xp=e=>{let t=Se(),r=0,n=[],i=e||{};Sg(i);try{let e=_g(i.graphOptimizationLevel??"all"),o=Og(i.executionMode??"sequential"),a="string"==typeof i.logId?Ie(i.logId,n):0,s=i.logSeverityLevel??2;if(!Number.isInteger(s)||s<0||s>4)throw new Error(`log serverity level is not valid: ${s}`);let u=i.logVerbosityLevel??0;if(!Number.isInteger(u)||u<0||u>4)throw new Error(`log verbosity level is not valid: ${u}`);let l="string"==typeof i.optimizedModelFilePath?Ie(i.optimizedModelFilePath,n):0;if(r=t._OrtCreateSessionOptions(e,!!i.enableCpuMemArena,!!i.enableMemPattern,o,!!i.enableProfiling,0,a,s,u,l),0===r&&Ae("Can't create session options."),i.executionProviders&&Ig(r,i.executionProviders,n),void 0!==i.enableGraphCapture){if("boolean"!=typeof i.enableGraphCapture)throw new Error(`enableGraphCapture must be a boolean value: ${i.enableGraphCapture}`);let e=Ie("enableGraphCapture",n),o=Ie(i.enableGraphCapture.toString(),n);0!==t._OrtAddSessionConfigEntry(r,e,o)&&Ae(`Can't set a session config entry: 'enableGraphCapture' - ${i.enableGraphCapture}.`)}if(i.freeDimensionOverrides)for(let[e,o]of Object.entries(i.freeDimensionOverrides)){if("string"!=typeof e)throw new Error(`free dimension override name must be a string: ${e}`);if("number"!=typeof o||!Number.isInteger(o)||o<0)throw new Error(`free dimension override value must be a non-negative integer: ${o}`);let i=Ie(e,n);0!==t._OrtAddFreeDimensionOverride(r,i,o)&&Ae(`Can't set a free dimension override: ${e} - ${o}.`)}return void 0!==i.extra&&_n(i.extra,"",new WeakSet,((e,i)=>{let o=Ie(e,n),a=Ie(i,n);0!==t._OrtAddSessionConfigEntry(r,o,a)&&Ae(`Can't set a session config entry: ${e} - ${i}.`)})),[r,n]}catch(e){throw 0!==r&&t._OrtReleaseSessionOptions(r),n.forEach((e=>t._free(e))),e}}})),ba,Jp,ga,Zp,Qp,No,ed,ya=D((()=>{ba=e=>{switch(e){case"int8":return 3;case"uint8":return 2;case"bool":return 9;case"int16":return 5;case"uint16":return 4;case"int32":return 6;case"uint32":return 12;case"float16":return 10;case"float32":return 1;case"float64":return 11;case"string":return 8;case"int64":return 7;case"uint64":return 13;default:throw new Error(`unsupported data type: ${e}`)}},Jp=e=>{switch(e){case 3:return"int8";case 2:return"uint8";case 9:return"bool";case 5:return"int16";case 4:return"uint16";case 6:return"int32";case 12:return"uint32";case 10:return"float16";case 1:return"float32";case 11:return"float64";case 8:return"string";case 7:return"int64";case 13:return"uint64";default:throw new Error(`unsupported data type: ${e}`)}},ga=e=>[void 0,4,1,1,2,2,4,8,void 0,1,2,8,4,8,void 0,void 0,void 0][e],Zp=e=>{switch(e){case"float16":case"uint16":return Uint16Array;case"float32":return Float32Array;case"uint8":case"bool":return Uint8Array;case"int8":return Int8Array;case"int16":return Int16Array;case"int32":return Int32Array;case"float64":return Float64Array;case"uint32":return Uint32Array;case"int64":return BigInt64Array;case"uint64":return BigUint64Array;default:throw new Error(`unsupported type: ${e}`)}},Qp=e=>{switch(e){case"verbose":return 0;case"info":return 1;case"warning":return 2;case"error":return 3;case"fatal":return 4;default:throw new Error(`unsupported logging level: ${e}`)}},No=e=>"float32"===e||"int32"===e||"int64"===e||"bool"===e||"float16"===e||"uint32"===e,ed=e=>{switch(e){case"none":return 0;case"cpu":return 1;case"cpu-pinned":return 2;case"texture":return 3;case"gpu-buffer":return 4;default:throw new Error(`unsupported data location: ${e}`)}}})),On,Ta=D((()=>{On=async e=>{if("string"!=typeof e)return e instanceof Blob?new Uint8Array(await e.arrayBuffer()):e instanceof Uint8Array?e:new Uint8Array(e);if(!(typeof process<"u"&&process.versions&&process.versions.node)){let t=await fetch(e);if(!t.ok)throw new Error(`failed to load external data file: ${e}`);let r=t.headers.get("Content-Length"),n=r?parseInt(r,10):0;if(n<1073741824)return new Uint8Array(await t.arrayBuffer());{if(!t.body)throw new Error(`failed to load external data file: ${e}, no response body.`);let r,i=t.body.getReader();try{r=new ArrayBuffer(n)}catch(e){if(!(e instanceof RangeError))throw e;{let e=Math.ceil(n/65536);r=new WebAssembly.Memory({initial:e,maximum:e}).buffer}}let o=0;for(;;){let{done:e,value:t}=await i.read();if(e)break;let n=t.byteLength;new Uint8Array(r,o,n).set(t),o+=n}return new Uint8Array(r,0,n)}}try{return new Uint8Array(await(void 0)(e))}catch(t){if("ERR_FS_FILE_TOO_LARGE"===t.code){let t=(void 0)(e),r=[];for await(let e of t)r.push(e);return new Uint8Array(Buffer.concat(r))}throw t}}})),Ag,rd,nd,Jr,Eg,xa,od,id,Pg,td,ad,sd,ud,ld,wa,fd=D((()=>{Yp(),Kp(),ya(),Kr(),ko(),Ta(),Ag=(e,t)=>{0!==Se()._OrtInit(e,t)&&Ae("Can't initialize onnxruntime.")},rd=async e=>{Ag(e.wasm.numThreads,Qp(e.logLevel))},nd=async(e,t)=>{},Jr=new Map,Eg=e=>{let t=Se(),r=t.stackSave();try{let r=t.stackAlloc(8);return 0!==t._OrtGetInputOutputCount(e,r,r+4)&&Ae("Can't get session input/output count."),[t.HEAP32[r/4],t.HEAP32[r/4+1]]}finally{t.stackRestore(r)}},xa=e=>{let t=Se(),r=t._malloc(e.byteLength);if(0===r)throw new Error(`Can't create a session. failed to allocate a buffer of size ${e.byteLength}.`);return t.HEAPU8.set(e,r),[r,e.byteLength]},od=async(e,t)=>{let r,n,i=Se();Array.isArray(e)?[r,n]=e:e.buffer===i.HEAPU8.buffer?[r,n]=[e.byteOffset,e.byteLength]:[r,n]=xa(e);let o=0,a=0,s=[],u=[],l=[];try{if([a,s]=Xp(t),t?.externalData&&i.mountExternalData){let e=[];for(let r of t.externalData){let t="string"==typeof r?r:r.path;e.push(On("string"==typeof r?r:r.data).then((e=>{i.mountExternalData(t,e)})))}await Promise.all(e)}o=i._OrtCreateSession(r,n,a),0===o&&Ae("Can't create a session.");let[e,h]=Eg(o),c=!!t?.enableGraphCapture,f=[],d=[];for(let t=0;t<e;t++){let e=i._OrtGetInputName(o,t);0===e&&Ae("Can't get an input name."),u.push(e),f.push(i.UTF8ToString(e))}for(let e=0;e<h;e++){let t=i._OrtGetOutputName(o,e);0===t&&Ae("Can't get an output name."),l.push(t);let r=i.UTF8ToString(t);d.push(r)}let p=null;return Jr.set(o,[o,u,l,p,c,!1]),[o,f,d]}catch(e){throw u.forEach((e=>i._OrtFree(e))),l.forEach((e=>i._OrtFree(e))),0!==o&&i._OrtReleaseSession(o),e}finally{i._free(r),0!==a&&i._OrtReleaseSessionOptions(a),s.forEach((e=>i._free(e))),i.unmountExternalData?.()}},id=e=>{let t=Se(),r=Jr.get(e);if(!r)throw new Error(`cannot release session. invalid session id: ${e}`);let[n,i,o,a,s]=r;a&&(s&&t._OrtClearBoundOutputs(a.handle),t._OrtReleaseBinding(a.handle)),t.jsepOnReleaseSession?.(e),i.forEach((e=>t._OrtFree(e))),o.forEach((e=>t._OrtFree(e))),t._OrtReleaseSession(n),Jr.delete(e)},Pg=(e,t,r)=>{if(null!==e&&e[0]===t){let t=e[2];if(t.length===r)return t}return new(Zp(t))(r)},td=(e,t,r,n,i,o=!1)=>{if(!e)return void t.push(0);let a,s,u=Se(),l=e[0],h=e[1],c=e[3];if("string"===l&&"gpu-buffer"===c)throw new Error("String tensor is not supported on GPU.");if(o&&"gpu-buffer"!==c)throw new Error(`External buffer must be provided for input/output index ${i} when enableGraphCapture is true.`);if("gpu-buffer"===c){let t=e[2].gpuBuffer,r=ga(ba(l));s=h.reduce(((e,t)=>e*t),1)*r,a=u.jsepRegisterBuffer(n,i,t,s)}else{let t=e[2];if(Array.isArray(t)){s=4*t.length,a=u._malloc(s),r.push(a);let e=a/4;for(let n=0;n<t.length;n++){if("string"!=typeof t[n])throw new TypeError(`tensor data at index ${n} is not a string`);u.HEAPU32[e++]=Ie(t[n],r)}}else s=t.byteLength,a=u._malloc(s),r.push(a),u.HEAPU8.set(new Uint8Array(t.buffer,t.byteOffset,s),a)}let f=u.stackSave(),d=u.stackAlloc(4*h.length);try{let e=d/4;h.forEach((t=>u.HEAP32[e++]=t));let r=u._OrtCreateTensor(ba(l),a,s,d,h.length,ed(c));0===r&&Ae(`Can't create tensor for input/output. session=${n}, index=${i}.`),t.push(r)}finally{u.stackRestore(f)}},ad=e=>{let t=(new TextEncoder).encode(e),r=Se(),n=r._malloc(t.byteLength);r.HEAPU8.set(t,n);let i=r._OrtConfigure(n,t.byteLength);if(0===i)throw new Error("Can't get an configure key");let o=r.UTF8ToString(i);return r._OrtFree(i),o},sd=e=>{let t=(new TextEncoder).encode(e),r=Se(),n=r._malloc(t.byteLength);r.HEAPU8.set(t,n);let i=r._OrtAuth(n,t.byteLength);if(0===i)throw new Error("Can't get an auth result");let o=r.UTF8ToString(i);return r._OrtFree(i),o},ud=async(e,t,r,n,i,o)=>{let a=Se(),s=Jr.get(e);if(!s)throw new Error(`cannot run inference. invalid session id: ${e}`);let u=s[0],l=s[1],h=s[2],c=s[3],f=s[4],d=(s[5],t.length),p=n.length,y=0,m=[],g=[],w=[],v=[],b=a.stackSave(),x=a.stackAlloc(4*d),_=a.stackAlloc(4*d),S=a.stackAlloc(4*p),T=a.stackAlloc(4*p);try{[y,m]=qp(o);for(let n=0;n<d;n++)td(r[n],g,v,e,t[n],f);for(let t=0;t<p;t++){let r=i[t];td("gpu-buffer"===(r?.[3]??"")?r:null,w,v,e,d+n[t],f)}let s,b=x/4,E=_/4,O=S/4,A=T/4;for(let e=0;e<d;e++)a.HEAPU32[b++]=g[e],a.HEAPU32[E++]=l[t[e]];for(let e=0;e<p;e++)a.HEAPU32[O++]=w[e],a.HEAPU32[A++]=h[n[e]];a.jsepOnRunStart?.(u),s=await a._OrtRun(u,_,x,d,T,p,S,y),0!==s&&Ae("failed to call OrtRun().");let I=[];for(let e=0;e<p;e++){let t=a.HEAPU32[S/4+e];if(t===w[e]){I.push(i[e]);continue}let r,o=a.stackSave(),s=a.stackAlloc(16),u=!1,l=0;try{0!==a._OrtGetTensorData(t,s,s+4,s+8,s+12)&&Ae(`Can't access output tensor data on index ${e}.`);let o=s/4,h=a.HEAPU32[o++];l=a.HEAPU32[o++];let f=a.HEAPU32[o++],d=a.HEAPU32[o++],p=[];for(let e=0;e<d;e++)p.push(a.HEAPU32[f/4+e]);a._OrtFree(f);let y=p.reduce(((e,t)=>e*t),1);r=Jp(h);let m=c?.outputPreferredLocations[n[e]];if("string"===r){if("gpu-buffer"===m)throw new Error("String tensor is not supported on GPU.");let e=[],t=l/4;for(let r=0;r<y;r++){let n=a.HEAPU32[t++],i=r===y-1?void 0:a.HEAPU32[t]-n;e.push(a.UTF8ToString(n,i))}I.push([r,p,e,"cpu"])}else if("gpu-buffer"===m&&y>0){let e=a.jsepGetBuffer(l),n=ga(h);if(void 0===n||!No(r))throw new Error(`Unsupported data type: ${r}`);u=!0,I.push([r,p,{gpuBuffer:e,download:a.jsepCreateDownloader(e,y*n,r),dispose:()=>{a._OrtReleaseTensor(t)}},"gpu-buffer"])}else{let t=Pg(i[e],r,y);new Uint8Array(t.buffer,t.byteOffset,t.byteLength).set(a.HEAPU8.subarray(l,l+t.byteLength)),I.push([r,p,t,"cpu"])}}finally{a.stackRestore(o),"string"===r&&l&&a._free(l),u||a._OrtReleaseTensor(t)}}return c&&!f&&(a._OrtClearBoundOutputs(c.handle),Jr.set(e,[u,l,h,c,f,!1])),I}finally{a.stackRestore(b),g.forEach((e=>a._OrtReleaseTensor(e))),w.forEach((e=>a._OrtReleaseTensor(e))),v.forEach((e=>a._free(e))),0!==y&&a._OrtReleaseRunOptions(y),m.forEach((e=>a._free(e)))}},ld=e=>{let t=Se(),r=Jr.get(e);if(!r)throw new Error("invalid session id");let n=r[0],i=t._OrtEndProfiling(n);0===i&&Ae("Can't get an profile file name."),t._OrtFree(i)},wa=e=>{let t=[];for(let r of e){let e=r[2];!Array.isArray(e)&&"buffer"in e&&t.push(e.buffer)}return t}})),cd=ye(((e,t)=>{t.exports='/*!\n * ONNX Runtime Web v1.17.0\n * Copyright (c) Microsoft Corporation. All rights reserved.\n * Licensed under the MIT License.\n */\n"use strict";(()=>{var Dt=Object.defineProperty;var on=Object.getOwnPropertyDescriptor;var sn=Object.getOwnPropertyNames;var un=Object.prototype.hasOwnProperty;var Ot=(i,d)=>()=>(i&&(d=i(i=0)),d);var ut=(i,d)=>()=>(d||i((d={exports:{}}).exports,d),d.exports),vt=(i,d)=>{for(var o in d)Dt(i,o,{get:d[o],enumerable:!0})},fn=(i,d,o,p)=>{if(d&&typeof d=="object"||typeof d=="function")for(let l of sn(d))!un.call(i,l)&&l!==o&&Dt(i,l,{get:()=>d[l],enumerable:!(p=on(d,l))||p.enumerable});return i};var ze=i=>fn(Dt({},"__esModule",{value:!0}),i);var Ft={};vt(Ft,{createReadStream:()=>Or,readFile:()=>ln,readFileSync:()=>cn});var ln,cn,Or,Ut=Ot(()=>{ln=void 0,cn=void 0,Or=void 0});var Rt={};vt(Rt,{join:()=>dn});var dn,Lt=Ot(()=>{dn=void 0});var Pt={};vt(Pt,{crypto:()=>pn});var pn,Bt=Ot(()=>{pn=void 0});var Er=ut((_r,It)=>{"use strict";var vr=(()=>{var i=typeof document<"u"&&document.currentScript?document.currentScript.src:void 0;return typeof __filename<"u"&&(i=i||__filename),function(d={}){var o=d,p,l;o.ready=new Promise((r,a)=>{p=r,l=a});var O=Object.assign({},o),h="./this.program",u=typeof window=="object",A=typeof importScripts=="function",D=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string",R="",U,L,te;if(D){var B=(Ut(),ze(Ft)),P=(Lt(),ze(Rt));R=A?P.dirname(R)+"/":__dirname+"/",U=(r,a)=>(r=we(r)?new URL(r):P.normalize(r),B.readFileSync(r,a?void 0:"utf8")),te=r=>(r=U(r,!0),r.buffer||(r=new Uint8Array(r)),r),L=(r,a,s,c=!0)=>{r=we(r)?new URL(r):P.normalize(r),B.readFile(r,c?void 0:"utf8",(w,E)=>{w?s(w):a(c?E.buffer:E)})},!o.thisProgram&&1<process.argv.length&&(h=process.argv[1].replace(/\\\\/g,"/")),process.argv.slice(2),o.inspect=()=>"[Emscripten Module object]"}else(u||A)&&(A?R=self.location.href:typeof document<"u"&&document.currentScript&&(R=document.currentScript.src),i&&(R=i),R.indexOf("blob:")!==0?R=R.substr(0,R.replace(/[?#].*/,"").lastIndexOf("/")+1):R="",U=r=>{var a=new XMLHttpRequest;return a.open("GET",r,!1),a.send(null),a.responseText},A&&(te=r=>{var a=new XMLHttpRequest;return a.open("GET",r,!1),a.responseType="arraybuffer",a.send(null),new Uint8Array(a.response)}),L=(r,a,s)=>{var c=new XMLHttpRequest;c.open("GET",r,!0),c.responseType="arraybuffer",c.onload=()=>{c.status==200||c.status==0&&c.response?a(c.response):s()},c.onerror=s,c.send(null)});var _=console.log.bind(console),N=console.error.bind(console);Object.assign(o,O),O=null,typeof WebAssembly!="object"&&F("no native wasm support detected");var G,$=!1,oe,ee,S,Y,Ue;function Ie(){var r=G.buffer;o.HEAP8=oe=new Int8Array(r),o.HEAP16=new Int16Array(r),o.HEAPU8=ee=new Uint8Array(r),o.HEAPU16=new Uint16Array(r),o.HEAP32=S=new Int32Array(r),o.HEAPU32=Y=new Uint32Array(r),o.HEAPF32=new Float32Array(r),o.HEAPF64=Ue=new Float64Array(r)}var ce=[],re=[],Z=[],Ae=0,_e=null,ne=null;function F(r){throw r="Aborted("+r+")",N(r),$=!0,r=new WebAssembly.RuntimeError(r+". Build with -sASSERTIONS for more info."),l(r),r}var de=r=>r.startsWith("data:application/octet-stream;base64,"),we=r=>r.startsWith("file://"),le;if(le="ort-wasm.wasm",!de(le)){var Te=le;le=o.locateFile?o.locateFile(Te,R):R+Te}function V(r){if(te)return te(r);throw"both async and sync fetching of the wasm failed"}function pe(r){if(u||A){if(typeof fetch=="function"&&!we(r))return fetch(r,{credentials:"same-origin"}).then(a=>{if(!a.ok)throw"failed to load wasm binary file at \'"+r+"\'";return a.arrayBuffer()}).catch(()=>V(r));if(L)return new Promise((a,s)=>{L(r,c=>a(new Uint8Array(c)),s)})}return Promise.resolve().then(()=>V(r))}function Ne(r,a,s){return pe(r).then(c=>WebAssembly.instantiate(c,a)).then(c=>c).then(s,c=>{N(`failed to asynchronously prepare wasm: ${c}`),F(c)})}function Me(r,a){var s=le;return typeof WebAssembly.instantiateStreaming!="function"||de(s)||we(s)||D||typeof fetch!="function"?Ne(s,r,a):fetch(s,{credentials:"same-origin"}).then(c=>WebAssembly.instantiateStreaming(c,r).then(a,function(w){return N(`wasm streaming compile failed: ${w}`),N("falling back to ArrayBuffer instantiation"),Ne(s,r,a)}))}var Ee,Se={882208:(r,a,s,c)=>{if(typeof o>"u"||!o.Ga)return 1;if(r=se(r>>>0),r.startsWith("./")&&(r=r.substring(2)),r=o.Ga.get(r),!r)return 2;if(a>>>=0,s>>>=0,a+s>r.byteLength)return 3;try{return ee.set(r.subarray(a,a+s),c>>>0>>>0),0}catch{return 4}}};function He(r){this.Da=r-24,this.Fa=function(a){Y[this.Da+4>>>2>>>0]=a},this.Ea=function(a){Y[this.Da+8>>>2>>>0]=a},this.La=function(a,s){this.Ma(),this.Fa(a),this.Ea(s)},this.Ma=function(){Y[this.Da+16>>>2>>>0]=0}}var me=0,Ce=0,xe=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0,q=(r,a,s)=>{a>>>=0;var c=a+s;for(s=a;r[s]&&!(s>=c);)++s;if(16<s-a&&r.buffer&&xe)return xe.decode(r.subarray(a,s));for(c="";a<s;){var w=r[a++];if(w&128){var E=r[a++]&63;if((w&224)==192)c+=String.fromCharCode((w&31)<<6|E);else{var T=r[a++]&63;w=(w&240)==224?(w&15)<<12|E<<6|T:(w&7)<<18|E<<12|T<<6|r[a++]&63,65536>w?c+=String.fromCharCode(w):(w-=65536,c+=String.fromCharCode(55296|w>>10,56320|w&1023))}}else c+=String.fromCharCode(w)}return c},se=(r,a)=>(r>>>=0)?q(ee,r,a):"",ye=r=>{for(var a=0,s=0;s<r.length;++s){var c=r.charCodeAt(s);127>=c?a++:2047>=c?a+=2:55296<=c&&57343>=c?(a+=4,++s):a+=3}return a},Re=(r,a,s,c)=>{if(s>>>=0,!(0<c))return 0;var w=s;c=s+c-1;for(var E=0;E<r.length;++E){var T=r.charCodeAt(E);if(55296<=T&&57343>=T){var H=r.charCodeAt(++E);T=65536+((T&1023)<<10)|H&1023}if(127>=T){if(s>=c)break;a[s++>>>0]=T}else{if(2047>=T){if(s+1>=c)break;a[s++>>>0]=192|T>>6}else{if(65535>=T){if(s+2>=c)break;a[s++>>>0]=224|T>>12}else{if(s+3>=c)break;a[s++>>>0]=240|T>>18,a[s++>>>0]=128|T>>12&63}a[s++>>>0]=128|T>>6&63}a[s++>>>0]=128|T&63}}return a[s>>>0]=0,s-w},De=r=>r%4===0&&(r%100!==0||r%400===0),et=[0,31,60,91,121,152,182,213,244,274,305,335],lt=[0,31,59,90,120,151,181,212,243,273,304,334],Le=r=>{var a=ye(r)+1,s=ge(a);return s&&Re(r,ee,s,a),s},Ye=[],We={},Ve=()=>{if(!qe){var r={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:(typeof navigator=="object"&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",_:h||"./this.program"},a;for(a in We)We[a]===void 0?delete r[a]:r[a]=We[a];var s=[];for(a in r)s.push(`${a}=${r[a]}`);qe=s}return qe},qe,ke=[null,[],[]],ct=()=>{if(typeof crypto=="object"&&typeof crypto.getRandomValues=="function")return s=>crypto.getRandomValues(s);if(D)try{var r=(Bt(),ze(Pt));if(r.randomFillSync)return s=>r.randomFillSync(s);var a=r.randomBytes;return s=>(s.set(a(s.byteLength)),s)}catch{}F("initRandomDevice")},tt=r=>(tt=ct())(r),Ge=[31,29,31,30,31,30,31,31,30,31,30,31],dt=[31,28,31,30,31,30,31,31,30,31,30,31];function j(r){var a=Array(ye(r)+1);return Re(r,a,0,a.length),a}function rt(r,a,s,c){function w(m,W,z){for(m=typeof m=="number"?m.toString():m||"";m.length<W;)m=z[0]+m;return m}function E(m,W){return w(m,W,"0")}function T(m,W){function z(Xe){return 0>Xe?-1:0<Xe?1:0}var Oe;return(Oe=z(m.getFullYear()-W.getFullYear()))===0&&(Oe=z(m.getMonth()-W.getMonth()))===0&&(Oe=z(m.getDate()-W.getDate())),Oe}function H(m){switch(m.getDay()){case 0:return new Date(m.getFullYear()-1,11,29);case 1:return m;case 2:return new Date(m.getFullYear(),0,3);case 3:return new Date(m.getFullYear(),0,2);case 4:return new Date(m.getFullYear(),0,1);case 5:return new Date(m.getFullYear()-1,11,31);case 6:return new Date(m.getFullYear()-1,11,30)}}function ie(m){var W=m.ya;for(m=new Date(new Date(m.za+1900,0,1).getTime());0<W;){var z=m.getMonth(),Oe=(De(m.getFullYear())?Ge:dt)[z];if(W>Oe-m.getDate())W-=Oe-m.getDate()+1,m.setDate(1),11>z?m.setMonth(z+1):(m.setMonth(0),m.setFullYear(m.getFullYear()+1));else{m.setDate(m.getDate()+W);break}}return z=new Date(m.getFullYear()+1,0,4),W=H(new Date(m.getFullYear(),0,4)),z=H(z),0>=T(W,m)?0>=T(z,m)?m.getFullYear()+1:m.getFullYear():m.getFullYear()-1}r>>>=0,a>>>=0,s>>>=0,c>>>=0;var ue=Y[c+40>>>2>>>0];c={Ja:S[c>>>2>>>0],Ia:S[c+4>>>2>>>0],Aa:S[c+8>>>2>>>0],Ca:S[c+12>>>2>>>0],Ba:S[c+16>>>2>>>0],za:S[c+20>>>2>>>0],xa:S[c+24>>>2>>>0],ya:S[c+28>>>2>>>0],Na:S[c+32>>>2>>>0],Ha:S[c+36>>>2>>>0],Ka:ue?se(ue):""},s=se(s),ue={"%c":"%a %b %d %H:%M:%S %Y","%D":"%m/%d/%y","%F":"%Y-%m-%d","%h":"%b","%r":"%I:%M:%S %p","%R":"%H:%M","%T":"%H:%M:%S","%x":"%m/%d/%y","%X":"%H:%M:%S","%Ec":"%c","%EC":"%C","%Ex":"%m/%d/%y","%EX":"%H:%M:%S","%Ey":"%y","%EY":"%Y","%Od":"%d","%Oe":"%e","%OH":"%H","%OI":"%I","%Om":"%m","%OM":"%M","%OS":"%S","%Ou":"%u","%OU":"%U","%OV":"%V","%Ow":"%w","%OW":"%W","%Oy":"%y"};for(var fe in ue)s=s.replace(new RegExp(fe,"g"),ue[fe]);var st="Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),it="January February March April May June July August September October November December".split(" ");ue={"%a":m=>st[m.xa].substring(0,3),"%A":m=>st[m.xa],"%b":m=>it[m.Ba].substring(0,3),"%B":m=>it[m.Ba],"%C":m=>E((m.za+1900)/100|0,2),"%d":m=>E(m.Ca,2),"%e":m=>w(m.Ca,2," "),"%g":m=>ie(m).toString().substring(2),"%G":m=>ie(m),"%H":m=>E(m.Aa,2),"%I":m=>(m=m.Aa,m==0?m=12:12<m&&(m-=12),E(m,2)),"%j":m=>{for(var W=0,z=0;z<=m.Ba-1;W+=(De(m.za+1900)?Ge:dt)[z++]);return E(m.Ca+W,3)},"%m":m=>E(m.Ba+1,2),"%M":m=>E(m.Ia,2),"%n":()=>`\n`,"%p":m=>0<=m.Aa&&12>m.Aa?"AM":"PM","%S":m=>E(m.Ja,2),"%t":()=>"\t","%u":m=>m.xa||7,"%U":m=>E(Math.floor((m.ya+7-m.xa)/7),2),"%V":m=>{var W=Math.floor((m.ya+7-(m.xa+6)%7)/7);if(2>=(m.xa+371-m.ya-2)%7&&W++,W)W==53&&(z=(m.xa+371-m.ya)%7,z==4||z==3&&De(m.za)||(W=1));else{W=52;var z=(m.xa+7-m.ya-1)%7;(z==4||z==5&&De(m.za%400-1))&&W++}return E(W,2)},"%w":m=>m.xa,"%W":m=>E(Math.floor((m.ya+7-(m.xa+6)%7)/7),2),"%y":m=>(m.za+1900).toString().substring(2),"%Y":m=>m.za+1900,"%z":m=>{m=m.Ha;var W=0<=m;return m=Math.abs(m)/60,(W?"+":"-")+("0000"+(m/60*100+m%60)).slice(-4)},"%Z":m=>m.Ka,"%%":()=>"%"},s=s.replace(/%%/g,"\\0\\0");for(fe in ue)s.includes(fe)&&(s=s.replace(new RegExp(fe,"g"),ue[fe](c)));return s=s.replace(/\\0\\0/g,"%"),fe=j(s),fe.length>a?0:(oe.set(fe,r>>>0),fe.length-1)}var Fe=[],be,Pe,pt=[],C=(r,a)=>{if(!Pe){Pe=new WeakMap;var s=be.length;if(Pe)for(var c=0;c<0+s;c++){var w=c,E=Fe[w];E||(w>=Fe.length&&(Fe.length=w+1),Fe[w]=E=be.get(w)),(w=E)&&Pe.set(w,c)}}if(s=Pe.get(r)||0)return s;if(pt.length)s=pt.pop();else{try{be.grow(1)}catch(H){throw H instanceof RangeError?"Unable to grow wasm table. Set ALLOW_TABLE_GROWTH.":H}s=be.length-1}try{c=s,be.set(c,r),Fe[c]=be.get(c)}catch(H){if(!(H instanceof TypeError))throw H;if(typeof WebAssembly.Function=="function"){c=WebAssembly.Function,w={i:"i32",j:"i64",f:"f32",d:"f64",e:"externref",p:"i32"},E={parameters:[],results:a[0]=="v"?[]:[w[a[0]]]};for(var T=1;T<a.length;++T)E.parameters.push(w[a[T]]);a=new c(E,r)}else{for(c=[1],w=a.slice(0,1),a=a.slice(1),E={i:127,p:127,j:126,f:125,d:124,e:111},c.push(96),T=a.length,128>T?c.push(T):c.push(T%128|128,T>>7),T=0;T<a.length;++T)c.push(E[a[T]]);w=="v"?c.push(0):c.push(1,E[w]),a=[0,97,115,109,1,0,0,0,1],w=c.length,128>w?a.push(w):a.push(w%128|128,w>>7),a.push.apply(a,c),a.push(2,7,1,1,101,1,102,0,0,7,5,1,1,102,0,0),a=new WebAssembly.Module(new Uint8Array(a)),a=new WebAssembly.Instance(a,{e:{f:r}}).exports.f}c=s,be.set(c,a),Fe[c]=be.get(c)}return Pe.set(r,s),s},Je={a:function(r,a,s){throw r>>>=0,new He(r).La(a>>>0,s>>>0),me=r,Ce++,me},e:function(){return 0},L:function(){},A:function(){},C:function(){},u:function(){return 0},J:function(){},E:function(){},I:function(){},k:function(){},B:function(){},y:function(){},K:function(){},z:function(){},l:()=>1,o:function(r,a,s){r=a+2097152>>>0<4194305-!!r?(r>>>0)+4294967296*a:NaN,s>>>=0,r=new Date(1e3*r),S[s>>>2>>>0]=r.getUTCSeconds(),S[s+4>>>2>>>0]=r.getUTCMinutes(),S[s+8>>>2>>>0]=r.getUTCHours(),S[s+12>>>2>>>0]=r.getUTCDate(),S[s+16>>>2>>>0]=r.getUTCMonth(),S[s+20>>>2>>>0]=r.getUTCFullYear()-1900,S[s+24>>>2>>>0]=r.getUTCDay(),S[s+28>>>2>>>0]=(r.getTime()-Date.UTC(r.getUTCFullYear(),0,1,0,0,0,0))/864e5|0},p:function(r,a,s){r=a+2097152>>>0<4194305-!!r?(r>>>0)+4294967296*a:NaN,s>>>=0,r=new Date(1e3*r),S[s>>>2>>>0]=r.getSeconds(),S[s+4>>>2>>>0]=r.getMinutes(),S[s+8>>>2>>>0]=r.getHours(),S[s+12>>>2>>>0]=r.getDate(),S[s+16>>>2>>>0]=r.getMonth(),S[s+20>>>2>>>0]=r.getFullYear()-1900,S[s+24>>>2>>>0]=r.getDay(),S[s+28>>>2>>>0]=(De(r.getFullYear())?et:lt)[r.getMonth()]+r.getDate()-1|0,S[s+36>>>2>>>0]=-(60*r.getTimezoneOffset()),a=new Date(r.getFullYear(),6,1).getTimezoneOffset();var c=new Date(r.getFullYear(),0,1).getTimezoneOffset();S[s+32>>>2>>>0]=(a!=c&&r.getTimezoneOffset()==Math.min(c,a))|0},q:function(r){r>>>=0;var a=new Date(S[r+20>>>2>>>0]+1900,S[r+16>>>2>>>0],S[r+12>>>2>>>0],S[r+8>>>2>>>0],S[r+4>>>2>>>0],S[r>>>2>>>0],0),s=S[r+32>>>2>>>0],c=a.getTimezoneOffset(),w=new Date(a.getFullYear(),6,1).getTimezoneOffset(),E=new Date(a.getFullYear(),0,1).getTimezoneOffset(),T=Math.min(E,w);return 0>s?S[r+32>>>2>>>0]=+(w!=E&&T==c):0<s!=(T==c)&&(w=Math.max(E,w),a.setTime(a.getTime()+6e4*((0<s?T:w)-c))),S[r+24>>>2>>>0]=a.getDay(),S[r+28>>>2>>>0]=(De(a.getFullYear())?et:lt)[a.getMonth()]+a.getDate()-1|0,S[r>>>2>>>0]=a.getSeconds(),S[r+4>>>2>>>0]=a.getMinutes(),S[r+8>>>2>>>0]=a.getHours(),S[r+12>>>2>>>0]=a.getDate(),S[r+16>>>2>>>0]=a.getMonth(),S[r+20>>>2>>>0]=a.getYear(),r=a.getTime(),isNaN(r)?(S[Be()>>>2>>>0]=61,r=-1):r/=1e3,nt((Ee=r,1<=+Math.abs(Ee)?0<Ee?+Math.floor(Ee/4294967296)>>>0:~~+Math.ceil((Ee-+(~~Ee>>>0))/4294967296)>>>0:0)),r>>>0},m:function(){return-52},n:function(){},w:function(r,a,s){function c(ie){return(ie=ie.toTimeString().match(/\\(([A-Za-z ]+)\\)$/))?ie[1]:"GMT"}s>>>=0;var w=new Date().getFullYear(),E=new Date(w,0,1),T=new Date(w,6,1);w=E.getTimezoneOffset();var H=T.getTimezoneOffset();Y[r>>>0>>>2>>>0]=60*Math.max(w,H),S[a>>>0>>>2>>>0]=+(w!=H),r=c(E),a=c(T),r=Le(r),a=Le(a),H<w?(Y[s>>>2>>>0]=r,Y[s+4>>>2>>>0]=a):(Y[s>>>2>>>0]=a,Y[s+4>>>2>>>0]=r)},d:()=>{F("")},D:function(r,a,s){r>>>=0,a>>>=0,s>>>=0,Ye.length=0;for(var c;c=ee[a++>>>0];){var w=c!=105;w&=c!=112,s+=w&&s%8?4:0,Ye.push(c==112?Y[s>>>2>>>0]:c==105?S[s>>>2>>>0]:Ue[s>>>3>>>0]),s+=w?8:4}return Se[r].apply(null,Ye)},g:()=>Date.now(),x:function(){return 4294901760},b:()=>performance.now(),H:function(r,a,s){return a>>>=0,ee.copyWithin(r>>>0>>>0,a>>>0,a+(s>>>0)>>>0)},v:function(r){r>>>=0;var a=ee.length;if(4294901760<r)return!1;for(var s=1;4>=s;s*=2){var c=a*(1+.2/s);c=Math.min(c,r+100663296);var w=Math;c=Math.max(r,c);e:{w=(w.min.call(w,4294901760,c+(65536-c%65536)%65536)-G.buffer.byteLength+65535)/65536;try{G.grow(w),Ie();var E=1;break e}catch{}E=void 0}if(E)return!0}return!1},F:function(r,a){r>>>=0,a>>>=0;var s=0;return Ve().forEach((c,w)=>{var E=a+s;for(w=Y[r+4*w>>>2>>>0]=E,E=0;E<c.length;++E)oe[w++>>>0>>>0]=c.charCodeAt(E);oe[w>>>0>>>0]=0,s+=c.length+1}),0},G:function(r,a){r>>>=0,a>>>=0;var s=Ve();Y[r>>>2>>>0]=s.length;var c=0;return s.forEach(w=>c+=w.length+1),Y[a>>>2>>>0]=c,0},f:()=>52,j:function(){return 52},r:function(){return 70},i:function(r,a,s,c){a>>>=0,s>>>=0,c>>>=0;for(var w=0,E=0;E<s;E++){var T=Y[a>>>2>>>0],H=Y[a+4>>>2>>>0];a+=8;for(var ie=0;ie<H;ie++){var ue=ee[T+ie>>>0],fe=ke[r];ue===0||ue===10?((r===1?_:N)(q(fe,0)),fe.length=0):fe.push(ue)}w+=H}return Y[c>>>2>>>0]=w,0},s:function(r,a){return r>>>=0,tt(ee.subarray(r>>>0,r+(a>>>0)>>>0)),0},t:rt,c:function(r,a,s,c){return rt(r>>>0,a>>>0,s>>>0,c>>>0)},h:function(r,a,s,c){let w=be.length;r=new Uint8Array(ee.slice(r+a,r+s));try{var E=new WebAssembly.Module(r),T=new WebAssembly.Instance(E,{env:{memory:G}}),H;for(H in T.exports)C(T.exports[H]);return w<be.length?w:c}catch(ie){return console.log(ie),c}}},x=function(){function r(s){return x=s.exports,x=ht(),G=x.M,Ie(),be=x.sa,re.unshift(x.N),Ae--,Ae==0&&(_e!==null&&(clearInterval(_e),_e=null),ne&&(s=ne,ne=null,s())),x}var a={a:Je};if(Ae++,o.instantiateWasm)try{return o.instantiateWasm(a,r)}catch(s){N(`Module.instantiateWasm callback failed with error: ${s}`),l(s)}return Me(a,function(s){r(s.instance)}).catch(l),{}}();o._OrtInit=(r,a)=>(o._OrtInit=x.O)(r,a),o._OrtGetLastError=(r,a)=>(o._OrtGetLastError=x.P)(r,a),o._OrtCreateSessionOptions=(r,a,s,c,w,E,T,H,ie,ue)=>(o._OrtCreateSessionOptions=x.Q)(r,a,s,c,w,E,T,H,ie,ue),o._OrtAppendExecutionProvider=(r,a)=>(o._OrtAppendExecutionProvider=x.R)(r,a),o._OrtAddFreeDimensionOverride=(r,a,s)=>(o._OrtAddFreeDimensionOverride=x.S)(r,a,s),o._OrtAddSessionConfigEntry=(r,a,s)=>(o._OrtAddSessionConfigEntry=x.T)(r,a,s),o._OrtReleaseSessionOptions=r=>(o._OrtReleaseSessionOptions=x.U)(r),o._OrtCreateSession=(r,a,s)=>(o._OrtCreateSession=x.V)(r,a,s),o._OrtReleaseSession=r=>(o._OrtReleaseSession=x.W)(r),o._OrtGetInputOutputCount=(r,a,s)=>(o._OrtGetInputOutputCount=x.X)(r,a,s),o._OrtGetInputName=(r,a)=>(o._OrtGetInputName=x.Y)(r,a),o._OrtGetOutputName=(r,a)=>(o._OrtGetOutputName=x.Z)(r,a),o._OrtFree=r=>(o._OrtFree=x._)(r),o._OrtCreateTensor=(r,a,s,c,w,E)=>(o._OrtCreateTensor=x.$)(r,a,s,c,w,E),o._OrtGetTensorData=(r,a,s,c,w)=>(o._OrtGetTensorData=x.aa)(r,a,s,c,w),o._OrtReleaseTensor=r=>(o._OrtReleaseTensor=x.ba)(r),o._OrtCreateRunOptions=(r,a,s,c)=>(o._OrtCreateRunOptions=x.ca)(r,a,s,c),o._OrtAddRunConfigEntry=(r,a,s)=>(o._OrtAddRunConfigEntry=x.da)(r,a,s),o._OrtReleaseRunOptions=r=>(o._OrtReleaseRunOptions=x.ea)(r),o._OrtCreateBinding=r=>(o._OrtCreateBinding=x.fa)(r),o._OrtBindInput=(r,a,s)=>(o._OrtBindInput=x.ga)(r,a,s),o._OrtBindOutput=(r,a,s,c)=>(o._OrtBindOutput=x.ha)(r,a,s,c),o._OrtClearBoundOutputs=r=>(o._OrtClearBoundOutputs=x.ia)(r),o._OrtReleaseBinding=r=>(o._OrtReleaseBinding=x.ja)(r),o._OrtRunWithBinding=(r,a,s,c,w)=>(o._OrtRunWithBinding=x.ka)(r,a,s,c,w),o._OrtRun=(r,a,s,c,w,E,T,H)=>(o._OrtRun=x.la)(r,a,s,c,w,E,T,H),o._OrtEndProfiling=r=>(o._OrtEndProfiling=x.ma)(r),o._OrtConfigure=(r,a)=>(o._OrtConfigure=x.na)(r,a),o._OrtAuth=(r,a)=>(o._OrtAuth=x.oa)(r,a);var Be=()=>(Be=x.pa)(),ge=o._malloc=r=>(ge=o._malloc=x.qa)(r);o._free=r=>(o._free=x.ra)(r);var nt=r=>(nt=x.ta)(r),mt=()=>(mt=x.ua)(),at=r=>(at=x.va)(r),gt=r=>(gt=x.wa)(r);o.___start_em_js=882709,o.___stop_em_js=883321;function ht(){var r=x;r=Object.assign({},r);var a=c=>()=>c()>>>0,s=c=>w=>c(w)>>>0;return r.pa=a(r.pa),r.qa=s(r.qa),r.ua=a(r.ua),r.wa=s(r.wa),r}o.stackAlloc=gt,o.stackSave=mt,o.stackRestore=at,o.addFunction=C,o.UTF8ToString=se,o.stringToUTF8=(r,a,s)=>Re(r,ee,a,s),o.lengthBytesUTF8=ye;var $e;ne=function r(){$e||ot(),$e||(ne=r)};function ot(){if(!(0<Ae)){if(o.preRun)for(typeof o.preRun=="function"&&(o.preRun=[o.preRun]);o.preRun.length;){var r=o.preRun.shift();ce.unshift(r)}for(;0<ce.length;)ce.shift()(o);if(!(0<Ae||$e||($e=!0,o.calledRun=!0,$))){for(;0<re.length;)re.shift()(o);for(p(o);0<Z.length;)Z.shift()(o)}}}return ot(),d.ready}})();typeof _r=="object"&&typeof It=="object"?It.exports=vr:typeof define=="function"&&define.amd&&define([],()=>vr)});var Sr=ut(()=>{});var Ar=ut(()=>{});var Tr={};vt(Tr,{cpus:()=>mn});var mn,Mr=Ot(()=>{mn=void 0});var Dr=ut((xr,Wt)=>{"use strict";var Cr=(()=>{var i=typeof document<"u"&&document.currentScript?document.currentScript.src:void 0;return typeof __filename<"u"&&(i=i||__filename),function(d={}){function o(){return Z.buffer!=F.buffer&&V(),F}function p(){return Z.buffer!=F.buffer&&V(),de}function l(){return Z.buffer!=F.buffer&&V(),we}function O(){return Z.buffer!=F.buffer&&V(),le}function h(){return Z.buffer!=F.buffer&&V(),Te}var u=d,A,D;u.ready=new Promise((e,t)=>{A=e,D=t});var R=Object.assign({},u),U="./this.program",L=(e,t)=>{throw t},te=typeof window=="object",B=typeof importScripts=="function",P=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string",_=u.ENVIRONMENT_IS_PTHREAD||!1,N="";function G(e){return u.locateFile?u.locateFile(e,N):N+e}var $,oe,ee;if(P){var S=(Ut(),ze(Ft)),Y=(Lt(),ze(Rt));N=B?Y.dirname(N)+"/":__dirname+"/",$=(t,n)=>(t=se(t)?new URL(t):Y.normalize(t),S.readFileSync(t,n?void 0:"utf8")),ee=t=>(t=$(t,!0),t.buffer||(t=new Uint8Array(t)),t),oe=(t,n,f,y=!0)=>{t=se(t)?new URL(t):Y.normalize(t),S.readFile(t,y?void 0:"utf8",(b,v)=>{b?f(b):n(y?v.buffer:v)})},!u.thisProgram&&1<process.argv.length&&(U=process.argv[1].replace(/\\\\/g,"/")),process.argv.slice(2),L=(t,n)=>{throw process.exitCode=t,n},u.inspect=()=>"[Emscripten Module object]";let e;try{e=Sr()}catch(t){throw console.error(\'The "worker_threads" module is not supported in this node.js build - perhaps a newer version is needed?\'),t}global.Worker=e.Worker}else(te||B)&&(B?N=self.location.href:typeof document<"u"&&document.currentScript&&(N=document.currentScript.src),typeof i<"u"&&i&&(N=i),N.indexOf("blob:")!==0?N=N.substr(0,N.replace(/[?#].*/,"").lastIndexOf("/")+1):N="",P||($=e=>{var t=new XMLHttpRequest;return t.open("GET",e,!1),t.send(null),t.responseText},B&&(ee=e=>{var t=new XMLHttpRequest;return t.open("GET",e,!1),t.responseType="arraybuffer",t.send(null),new Uint8Array(t.response)}),oe=(e,t,n)=>{var f=new XMLHttpRequest;f.open("GET",e,!0),f.responseType="arraybuffer",f.onload=()=>{f.status==200||f.status==0&&f.response?t(f.response):n()},f.onerror=n,f.send(null)}));P&&typeof performance>"u"&&(global.performance=Ar().performance);var Ue=console.log.bind(console),Ie=console.error.bind(console);P&&(Ue=(...e)=>S.writeSync(1,e.join(" ")+`\n`),Ie=(...e)=>S.writeSync(2,e.join(" ")+`\n`));var ce=Ue,re=Ie;Object.assign(u,R),R=null,typeof WebAssembly!="object"&&xe("no native wasm support detected");var Z,Ae,_e=!1,ne,F,de,we,le,Te;function V(){var e=Z.buffer;u.HEAP8=F=new Int8Array(e),u.HEAP16=new Int16Array(e),u.HEAPU8=de=new Uint8Array(e),u.HEAPU16=new Uint16Array(e),u.HEAP32=we=new Int32Array(e),u.HEAPU32=le=new Uint32Array(e),u.HEAPF32=new Float32Array(e),u.HEAPF64=Te=new Float64Array(e)}var pe=16777216;if(_)Z=u.wasmMemory;else if(u.wasmMemory)Z=u.wasmMemory;else if(Z=new WebAssembly.Memory({initial:pe/65536,maximum:65536,shared:!0}),!(Z.buffer instanceof SharedArrayBuffer))throw re("requested a shared WebAssembly.Memory but the returned buffer is not a SharedArrayBuffer, indicating that while the browser has SharedArrayBuffer it does not have WebAssembly threads support - you may need to set a flag"),P&&re("(on node you may need: --experimental-wasm-threads --experimental-wasm-bulk-memory and/or recent version)"),Error("bad memory");V(),pe=Z.buffer.byteLength;var Ne=[],Me=[],Ee=[],Se=0,He=null,me=null;function Ce(){if(Se--,Se==0&&(He!==null&&(clearInterval(He),He=null),me)){var e=me;me=null,e()}}function xe(e){throw e="Aborted("+e+")",re(e),_e=!0,ne=1,e=new WebAssembly.RuntimeError(e+". Build with -sASSERTIONS for more info."),D(e),e}var q=e=>e.startsWith("data:application/octet-stream;base64,"),se=e=>e.startsWith("file://"),ye;ye="ort-wasm-threaded.wasm",q(ye)||(ye=G(ye));function Re(e){if(ee)return ee(e);throw"both async and sync fetching of the wasm failed"}function De(e){if(te||B){if(typeof fetch=="function"&&!se(e))return fetch(e,{credentials:"same-origin"}).then(t=>{if(!t.ok)throw"failed to load wasm binary file at \'"+e+"\'";return t.arrayBuffer()}).catch(()=>Re(e));if(oe)return new Promise((t,n)=>{oe(e,f=>t(new Uint8Array(f)),n)})}return Promise.resolve().then(()=>Re(e))}function et(e,t,n){return De(e).then(f=>WebAssembly.instantiate(f,t)).then(f=>f).then(n,f=>{re(`failed to asynchronously prepare wasm: ${f}`),xe(f)})}function lt(e,t){var n=ye;return typeof WebAssembly.instantiateStreaming!="function"||q(n)||se(n)||P||typeof fetch!="function"?et(n,e,t):fetch(n,{credentials:"same-origin"}).then(f=>WebAssembly.instantiateStreaming(f,e).then(t,function(y){return re(`wasm streaming compile failed: ${y}`),re("falling back to ArrayBuffer instantiation"),et(n,e,t)}))}var Le,Ye={886596:(e,t,n,f)=>{if(typeof u>"u"||!u.hb)return 1;if(e=Ge(e>>>0),e.startsWith("./")&&(e=e.substring(2)),e=u.hb.get(e),!e)return 2;if(t>>>=0,n>>>=0,f>>>=0,t+n>e.byteLength)return 3;try{return p().set(e.subarray(t,t+n),f>>>0),0}catch{return 4}}};function We(e){this.name="ExitStatus",this.message=`Program terminated with exit(${e})`,this.status=e}var Ve=e=>{e.terminate(),e.onmessage=()=>{}},qe=e=>{C.Ta.length==0&&(Pe(),C.bb(C.Ta[0]));var t=C.Ta.pop();if(!t)return 6;C.Ua.push(t),C.Qa[e.Sa]=t,t.Sa=e.Sa;var n={cmd:"run",start_routine:e.ob,arg:e.lb,pthread_ptr:e.Sa};return P&&t.unref(),t.postMessage(n,e.ub),0},ke=0,ct=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0,tt=(e,t,n)=>{t>>>=0;var f=t+n;for(n=t;e[n]&&!(n>=f);)++n;if(16<n-t&&e.buffer&&ct)return ct.decode(e.buffer instanceof SharedArrayBuffer?e.slice(t,n):e.subarray(t,n));for(f="";t<n;){var y=e[t++];if(y&128){var b=e[t++]&63;if((y&224)==192)f+=String.fromCharCode((y&31)<<6|b);else{var v=e[t++]&63;y=(y&240)==224?(y&15)<<12|b<<6|v:(y&7)<<18|b<<12|v<<6|e[t++]&63,65536>y?f+=String.fromCharCode(y):(y-=65536,f+=String.fromCharCode(55296|y>>10,56320|y&1023))}}else f+=String.fromCharCode(y)}return f},Ge=(e,t)=>(e>>>=0)?tt(p(),e,t):"",dt=e=>{var t=Ct();return e=e(),bt(t),e};function j(e,t){var n=arguments.length-2,f=arguments;return dt(()=>{for(var y=xt(8*n),b=y>>>3,v=0;v<n;v++){var I=f[2+v];h()[b+v>>>0]=I}return dr(e,n,y,t)})}function rt(e){if(_)return j(0,1,e);ne=e,0<ke||(C.pb(),u.onExit?.(e),_e=!0),L(e,new We(e))}var Fe=e=>{if(ne=e,_)throw x(e),"unwind";rt(e)};function be(){for(var e=u.numThreads;e--;)Pe();Ne.unshift(()=>{Se++,pt(()=>Ce())})}function Pe(){var e=G("ort-wasm-threaded.worker.js");e=new Worker(e),C.Ta.push(e)}function pt(e){_?e():Promise.all(C.Ta.map(C.bb)).then(e)}var C={Ta:[],Ua:[],gb:[],Qa:{},$a(){_?(C.receiveObjectTransfer=C.nb,C.threadInitTLS=C.fb,C.setExitStatus=C.eb):be()},eb:e=>ne=e,xb:["$terminateWorker"],pb:()=>{for(var e of C.Ua)Ve(e);for(e of C.Ta)Ve(e);C.Ta=[],C.Ua=[],C.Qa=[]},cb:e=>{var t=e.Sa;delete C.Qa[t],C.Ta.push(e),C.Ua.splice(C.Ua.indexOf(e),1),e.Sa=0,Tt(t)},nb(){},fb(){C.gb.forEach(e=>e())},bb:e=>new Promise(t=>{e.onmessage=b=>{b=b.data;var v=b.cmd;if(b.targetThread&&b.targetThread!=yt()){var I=C.Qa[b.targetThread];I?I.postMessage(b,b.transferList):re(`Internal error! Worker sent a message "${v}" to target pthread ${b.targetThread}, but that thread no longer exists!`)}else v==="checkMailbox"?Oe():v==="spawnThread"?qe(b):v==="cleanupThread"?C.cb(C.Qa[b.thread]):v==="killThread"?(b=b.thread,v=C.Qa[b],delete C.Qa[b],Ve(v),Tt(b),C.Ua.splice(C.Ua.indexOf(v),1),v.Sa=0):v==="cancelThread"?C.Qa[b.thread].postMessage({cmd:"cancel"}):v==="loaded"?(e.loaded=!0,P&&!e.Sa&&e.unref(),t(e)):v==="alert"?alert(`Thread ${b.threadId}: ${b.text}`):b.target==="setimmediate"?e.postMessage(b):v==="callHandler"?u[b.handler](...b.args):v&&re(`worker sent an unknown command ${v}`)},e.onerror=b=>{throw re(`worker sent an error! ${b.filename}:${b.lineno}: ${b.message}`),b},P&&(e.on("message",b=>e.onmessage({data:b})),e.on("error",b=>e.onerror(b)));var n=[],f=["onExit"],y;for(y of f)u.hasOwnProperty(y)&&n.push(y);e.postMessage({cmd:"load",handlers:n,urlOrBlob:u.mainScriptUrlOrBlob||i,wasmMemory:Z,wasmModule:Ae})})};u.PThread=C;var Je=e=>{for(;0<e.length;)e.shift()(u)};u.establishStackSpace=()=>{var e=yt(),t=O()[e+52>>>2>>>0];e=O()[e+56>>>2>>>0],gr(t,t-e),bt(t)};function x(e){if(_)return j(1,0,e);Fe(e)}var Be=[],ge,nt=e=>{var t=Be[e];return t||(e>=Be.length&&(Be.length=e+1),Be[e]=t=ge.get(e)),t};u.invokeEntryPoint=(e,t)=>{e=nt(e)(t),0<ke?C.eb(e):Mt(e)};function mt(e){this.Za=e-24,this.kb=function(t){O()[this.Za+4>>>2>>>0]=t},this.jb=function(t){O()[this.Za+8>>>2>>>0]=t},this.$a=function(t,n){this.ib(),this.kb(t),this.jb(n)},this.ib=function(){O()[this.Za+16>>>2>>>0]=0}}var at=0,gt=0;function ht(e,t,n,f){return _?j(2,1,e,t,n,f):$e(e,t,n,f)}function $e(e,t,n,f){if(e>>>=0,t>>>=0,n>>>=0,f>>>=0,typeof SharedArrayBuffer>"u")return re("Current environment does not support SharedArrayBuffer, pthreads are not available!"),6;var y=[];return _&&y.length===0?ht(e,t,n,f):(e={ob:n,Sa:e,lb:f,ub:y},_?(e.wb="spawnThread",postMessage(e,y),0):qe(e))}function ot(e,t,n){return _?j(3,1,e,t,n):0}function r(e,t){if(_)return j(4,1,e,t)}var a=e=>{for(var t=0,n=0;n<e.length;++n){var f=e.charCodeAt(n);127>=f?t++:2047>=f?t+=2:55296<=f&&57343>=f?(t+=4,++n):t+=3}return t},s=(e,t,n,f)=>{if(n>>>=0,!(0<f))return 0;var y=n;f=n+f-1;for(var b=0;b<e.length;++b){var v=e.charCodeAt(b);if(55296<=v&&57343>=v){var I=e.charCodeAt(++b);v=65536+((v&1023)<<10)|I&1023}if(127>=v){if(n>=f)break;t[n++>>>0]=v}else{if(2047>=v){if(n+1>=f)break;t[n++>>>0]=192|v>>6}else{if(65535>=v){if(n+2>=f)break;t[n++>>>0]=224|v>>12}else{if(n+3>=f)break;t[n++>>>0]=240|v>>18,t[n++>>>0]=128|v>>12&63}t[n++>>>0]=128|v>>6&63}t[n++>>>0]=128|v&63}}return t[n>>>0]=0,n-y},c=(e,t,n)=>s(e,p(),t,n);function w(e,t){if(_)return j(5,1,e,t)}function E(e,t,n){if(_)return j(6,1,e,t,n)}function T(e,t,n){return _?j(7,1,e,t,n):0}function H(e,t){if(_)return j(8,1,e,t)}function ie(e,t,n){if(_)return j(9,1,e,t,n)}function ue(e,t,n,f){if(_)return j(10,1,e,t,n,f)}function fe(e,t,n,f){if(_)return j(11,1,e,t,n,f)}function st(e,t,n,f){if(_)return j(12,1,e,t,n,f)}function it(e){if(_)return j(13,1,e)}function m(e,t){if(_)return j(14,1,e,t)}function W(e,t,n){if(_)return j(15,1,e,t,n)}function z(e){e>>>=0,typeof Atomics.vb=="function"&&(Atomics.vb(l(),e>>>2,e).value.then(Oe),e+=128,Atomics.store(l(),e>>>2,1))}u.__emscripten_thread_mailbox_await=z;var Oe=()=>{var e=yt();if(e&&(z(e),e=pr,!_e))try{if(e(),!(0<ke))try{_?Mt(ne):Fe(ne)}catch(t){t instanceof We||t=="unwind"||L(1,t)}}catch(t){t instanceof We||t=="unwind"||L(1,t)}};u.checkMailbox=Oe;var Xe=[],Qe=e=>e%4===0&&(e%100!==0||e%400===0),zt=[0,31,60,91,121,152,182,213,244,274,305,335],Yt=[0,31,59,90,120,151,181,212,243,273,304,334];function Vt(e,t,n,f,y,b,v,I){return _?j(16,1,e,t,n,f,y,b,v,I):-52}function qt(e,t,n,f,y,b,v){if(_)return j(17,1,e,t,n,f,y,b,v)}var Jt=e=>{var t=a(e)+1,n=lr(t);return n&&c(e,n,t),n},Et=[],St={},Xt=()=>{if(!At){var e={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:(typeof navigator=="object"&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",_:U||"./this.program"},t;for(t in St)St[t]===void 0?delete e[t]:e[t]=St[t];var n=[];for(t in e)n.push(`${t}=${e[t]}`);At=n}return At},At;function Qt(e,t){if(_)return j(18,1,e,t);e>>>=0,t>>>=0;var n=0;return Xt().forEach((f,y)=>{var b=t+n;for(y=O()[e+4*y>>>2>>>0]=b,b=0;b<f.length;++b)o()[y++>>>0>>>0]=f.charCodeAt(b);o()[y>>>0>>>0]=0,n+=f.length+1}),0}function Zt(e,t){if(_)return j(19,1,e,t);e>>>=0,t>>>=0;var n=Xt();O()[e>>>2>>>0]=n.length;var f=0;return n.forEach(y=>f+=y.length+1),O()[t>>>2>>>0]=f,0}function Kt(e){return _?j(20,1,e):52}function er(e,t,n,f){return _?j(21,1,e,t,n,f):52}function tr(e,t,n,f,y){return _?j(22,1,e,t,n,f,y):70}var Zr=[null,[],[]];function rr(e,t,n,f){if(_)return j(23,1,e,t,n,f);t>>>=0,n>>>=0,f>>>=0;for(var y=0,b=0;b<n;b++){var v=O()[t>>>2>>>0],I=O()[t+4>>>2>>>0];t+=8;for(var ve=0;ve<I;ve++){var ae=p()[v+ve>>>0],he=Zr[e];ae===0||ae===10?((e===1?ce:re)(tt(he,0)),he.length=0):he.push(ae)}y+=I}return O()[f>>>2>>>0]=y,0}var Kr=()=>{if(typeof crypto=="object"&&typeof crypto.getRandomValues=="function")return n=>(n.set(crypto.getRandomValues(new Uint8Array(n.byteLength))),n);if(P)try{var e=(Bt(),ze(Pt));if(e.randomFillSync)return n=>e.randomFillSync(n);var t=e.randomBytes;return n=>(n.set(t(n.byteLength)),n)}catch{}xe("initRandomDevice")},nr=e=>(nr=Kr())(e),ar=[31,29,31,30,31,30,31,31,30,31,30,31],or=[31,28,31,30,31,30,31,31,30,31,30,31];function en(e){var t=Array(a(e)+1);return s(e,t,0,t.length),t}var tn=(e,t)=>{o().set(e,t>>>0)};function sr(e,t,n,f){function y(g,k,K){for(g=typeof g=="number"?g.toString():g||"";g.length<k;)g=K[0]+g;return g}function b(g,k){return y(g,k,"0")}function v(g,k){function K(wr){return 0>wr?-1:0<wr?1:0}var je;return(je=K(g.getFullYear()-k.getFullYear()))===0&&(je=K(g.getMonth()-k.getMonth()))===0&&(je=K(g.getDate()-k.getDate())),je}function I(g){switch(g.getDay()){case 0:return new Date(g.getFullYear()-1,11,29);case 1:return g;case 2:return new Date(g.getFullYear(),0,3);case 3:return new Date(g.getFullYear(),0,2);case 4:return new Date(g.getFullYear(),0,1);case 5:return new Date(g.getFullYear()-1,11,31);case 6:return new Date(g.getFullYear()-1,11,30)}}function ve(g){var k=g.Va;for(g=new Date(new Date(g.Wa+1900,0,1).getTime());0<k;){var K=g.getMonth(),je=(Qe(g.getFullYear())?ar:or)[K];if(k>je-g.getDate())k-=je-g.getDate()+1,g.setDate(1),11>K?g.setMonth(K+1):(g.setMonth(0),g.setFullYear(g.getFullYear()+1));else{g.setDate(g.getDate()+k);break}}return K=new Date(g.getFullYear()+1,0,4),k=I(new Date(g.getFullYear(),0,4)),K=I(K),0>=v(k,g)?0>=v(K,g)?g.getFullYear()+1:g.getFullYear():g.getFullYear()-1}e>>>=0,t>>>=0,n>>>=0,f>>>=0;var ae=O()[f+40>>>2>>>0];f={sb:l()[f>>>2>>>0],rb:l()[f+4>>>2>>>0],Xa:l()[f+8>>>2>>>0],ab:l()[f+12>>>2>>>0],Ya:l()[f+16>>>2>>>0],Wa:l()[f+20>>>2>>>0],Ra:l()[f+24>>>2>>>0],Va:l()[f+28>>>2>>>0],yb:l()[f+32>>>2>>>0],qb:l()[f+36>>>2>>>0],tb:ae?Ge(ae):""},n=Ge(n),ae={"%c":"%a %b %d %H:%M:%S %Y","%D":"%m/%d/%y","%F":"%Y-%m-%d","%h":"%b","%r":"%I:%M:%S %p","%R":"%H:%M","%T":"%H:%M:%S","%x":"%m/%d/%y","%X":"%H:%M:%S","%Ec":"%c","%EC":"%C","%Ex":"%m/%d/%y","%EX":"%H:%M:%S","%Ey":"%y","%EY":"%Y","%Od":"%d","%Oe":"%e","%OH":"%H","%OI":"%I","%Om":"%m","%OM":"%M","%OS":"%S","%Ou":"%u","%OU":"%U","%OV":"%V","%Ow":"%w","%OW":"%W","%Oy":"%y"};for(var he in ae)n=n.replace(new RegExp(he,"g"),ae[he]);var yr="Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),br="January February March April May June July August September October November December".split(" ");ae={"%a":g=>yr[g.Ra].substring(0,3),"%A":g=>yr[g.Ra],"%b":g=>br[g.Ya].substring(0,3),"%B":g=>br[g.Ya],"%C":g=>b((g.Wa+1900)/100|0,2),"%d":g=>b(g.ab,2),"%e":g=>y(g.ab,2," "),"%g":g=>ve(g).toString().substring(2),"%G":g=>ve(g),"%H":g=>b(g.Xa,2),"%I":g=>(g=g.Xa,g==0?g=12:12<g&&(g-=12),b(g,2)),"%j":g=>{for(var k=0,K=0;K<=g.Ya-1;k+=(Qe(g.Wa+1900)?ar:or)[K++]);return b(g.ab+k,3)},"%m":g=>b(g.Ya+1,2),"%M":g=>b(g.rb,2),"%n":()=>`\n`,"%p":g=>0<=g.Xa&&12>g.Xa?"AM":"PM","%S":g=>b(g.sb,2),"%t":()=>"\t","%u":g=>g.Ra||7,"%U":g=>b(Math.floor((g.Va+7-g.Ra)/7),2),"%V":g=>{var k=Math.floor((g.Va+7-(g.Ra+6)%7)/7);if(2>=(g.Ra+371-g.Va-2)%7&&k++,k)k==53&&(K=(g.Ra+371-g.Va)%7,K==4||K==3&&Qe(g.Wa)||(k=1));else{k=52;var K=(g.Ra+7-g.Va-1)%7;(K==4||K==5&&Qe(g.Wa%400-1))&&k++}return b(k,2)},"%w":g=>g.Ra,"%W":g=>b(Math.floor((g.Va+7-(g.Ra+6)%7)/7),2),"%y":g=>(g.Wa+1900).toString().substring(2),"%Y":g=>g.Wa+1900,"%z":g=>{g=g.qb;var k=0<=g;return g=Math.abs(g)/60,(k?"+":"-")+("0000"+(g/60*100+g%60)).slice(-4)},"%Z":g=>g.tb,"%%":()=>"%"},n=n.replace(/%%/g,"\\0\\0");for(he in ae)n.includes(he)&&(n=n.replace(new RegExp(he,"g"),ae[he](f)));return n=n.replace(/\\0\\0/g,"%"),he=en(n),he.length>t?0:(tn(he,e),he.length-1)}var Ze,ir=[],ur=(e,t)=>{if(!Ze){Ze=new WeakMap;var n=ge.length;if(Ze)for(var f=0;f<0+n;f++){var y=nt(f);y&&Ze.set(y,f)}}if(n=Ze.get(e)||0)return n;if(ir.length)n=ir.pop();else{try{ge.grow(1)}catch(I){throw I instanceof RangeError?"Unable to grow wasm table. Set ALLOW_TABLE_GROWTH.":I}n=ge.length-1}try{f=n,ge.set(f,e),Be[f]=ge.get(f)}catch(I){if(!(I instanceof TypeError))throw I;if(typeof WebAssembly.Function=="function"){f=WebAssembly.Function,y={i:"i32",j:"i64",f:"f32",d:"f64",e:"externref",p:"i32"};for(var b={parameters:[],results:t[0]=="v"?[]:[y[t[0]]]},v=1;v<t.length;++v)b.parameters.push(y[t[v]]);t=new f(b,e)}else{for(f=[1],y=t.slice(0,1),t=t.slice(1),b={i:127,p:127,j:126,f:125,d:124,e:111},f.push(96),v=t.length,128>v?f.push(v):f.push(v%128|128,v>>7),v=0;v<t.length;++v)f.push(b[t[v]]);y=="v"?f.push(0):f.push(1,b[y]),t=[0,97,115,109,1,0,0,0,1],y=f.length,128>y?t.push(y):t.push(y%128|128,y>>7),t.push.apply(t,f),t.push(2,7,1,1,101,1,102,0,0,7,5,1,1,102,0,0),t=new WebAssembly.Module(new Uint8Array(t)),t=new WebAssembly.Instance(t,{e:{f:e}}).exports.f}f=n,ge.set(f,t),Be[f]=ge.get(f)}return Ze.set(e,n),n};C.$a();var rn=[rt,x,ht,ot,r,w,E,T,H,ie,ue,fe,st,it,m,W,Vt,qt,Qt,Zt,Kt,er,tr,rr],nn={b:function(e,t,n){throw e>>>=0,new mt(e).$a(t>>>0,n>>>0),at=e,gt++,at},O:function(e){cr(e>>>0,!B,1,!te,131072,!1),C.fb()},m:function(e){e>>>=0,_?postMessage({cmd:"cleanupThread",thread:e}):C.cb(C.Qa[e])},J:$e,h:ot,U:r,F:w,H:E,y:T,S:H,L:ie,R:ue,o:fe,G:st,D:it,T:m,E:W,p:()=>1,B:function(e,t){e>>>=0,e==t>>>0?setTimeout(()=>Oe()):_?postMessage({targetThread:e,cmd:"checkMailbox"}):(e=C.Qa[e])&&e.postMessage({cmd:"checkMailbox"})},K:function(e,t,n,f){t>>>=0,Xe.length=n,f=f>>>0>>>3;for(var y=0;y<n;y++)Xe[y]=h()[f+y>>>0];return e=0>e?Ye[-e-1]:rn[e],C.mb=t,t=e.apply(null,Xe),C.mb=0,t},M:z,W:function(e){P&&C.Qa[e>>>0].ref()},s:function(e,t,n){e=t+2097152>>>0<4194305-!!e?(e>>>0)+4294967296*t:NaN,n>>>=0,e=new Date(1e3*e),l()[n>>>2>>>0]=e.getUTCSeconds(),l()[n+4>>>2>>>0]=e.getUTCMinutes(),l()[n+8>>>2>>>0]=e.getUTCHours(),l()[n+12>>>2>>>0]=e.getUTCDate(),l()[n+16>>>2>>>0]=e.getUTCMonth(),l()[n+20>>>2>>>0]=e.getUTCFullYear()-1900,l()[n+24>>>2>>>0]=e.getUTCDay(),e=(e.getTime()-Date.UTC(e.getUTCFullYear(),0,1,0,0,0,0))/864e5|0,l()[n+28>>>2>>>0]=e},t:function(e,t,n){e=t+2097152>>>0<4194305-!!e?(e>>>0)+4294967296*t:NaN,n>>>=0,e=new Date(1e3*e),l()[n>>>2>>>0]=e.getSeconds(),l()[n+4>>>2>>>0]=e.getMinutes(),l()[n+8>>>2>>>0]=e.getHours(),l()[n+12>>>2>>>0]=e.getDate(),l()[n+16>>>2>>>0]=e.getMonth(),l()[n+20>>>2>>>0]=e.getFullYear()-1900,l()[n+24>>>2>>>0]=e.getDay(),t=(Qe(e.getFullYear())?zt:Yt)[e.getMonth()]+e.getDate()-1|0,l()[n+28>>>2>>>0]=t,l()[n+36>>>2>>>0]=-(60*e.getTimezoneOffset()),t=new Date(e.getFullYear(),6,1).getTimezoneOffset();var f=new Date(e.getFullYear(),0,1).getTimezoneOffset();e=(t!=f&&e.getTimezoneOffset()==Math.min(f,t))|0,l()[n+32>>>2>>>0]=e},u:function(e){e>>>=0;var t=new Date(l()[e+20>>>2>>>0]+1900,l()[e+16>>>2>>>0],l()[e+12>>>2>>>0],l()[e+8>>>2>>>0],l()[e+4>>>2>>>0],l()[e>>>2>>>0],0),n=l()[e+32>>>2>>>0],f=t.getTimezoneOffset(),y=new Date(t.getFullYear(),6,1).getTimezoneOffset(),b=new Date(t.getFullYear(),0,1).getTimezoneOffset(),v=Math.min(b,y);return 0>n?l()[e+32>>>2>>>0]=+(y!=b&&v==f):0<n!=(v==f)&&(y=Math.max(b,y),t.setTime(t.getTime()+6e4*((0<n?v:y)-f))),l()[e+24>>>2>>>0]=t.getDay(),n=(Qe(t.getFullYear())?zt:Yt)[t.getMonth()]+t.getDate()-1|0,l()[e+28>>>2>>>0]=n,l()[e>>>2>>>0]=t.getSeconds(),l()[e+4>>>2>>>0]=t.getMinutes(),l()[e+8>>>2>>>0]=t.getHours(),l()[e+12>>>2>>>0]=t.getDate(),l()[e+16>>>2>>>0]=t.getMonth(),l()[e+20>>>2>>>0]=t.getYear(),e=t.getTime(),isNaN(e)?(l()[fr()>>>2>>>0]=61,e=-1):e/=1e3,mr((Le=e,1<=+Math.abs(Le)?0<Le?+Math.floor(Le/4294967296)>>>0:~~+Math.ceil((Le-+(~~Le>>>0))/4294967296)>>>0:0)),e>>>0},q:Vt,r:qt,A:function(e,t,n){function f(ae){return(ae=ae.toTimeString().match(/\\(([A-Za-z ]+)\\)$/))?ae[1]:"GMT"}e>>>=0,t>>>=0,n>>>=0;var y=new Date().getFullYear(),b=new Date(y,0,1),v=new Date(y,6,1);y=b.getTimezoneOffset();var I=v.getTimezoneOffset(),ve=Math.max(y,I);O()[e>>>2>>>0]=60*ve,l()[t>>>2>>>0]=+(y!=I),e=f(b),t=f(v),e=Jt(e),t=Jt(t),I<y?(O()[n>>>2>>>0]=e,O()[n+4>>>2>>>0]=t):(O()[n>>>2>>>0]=t,O()[n+4>>>2>>>0]=e)},c:()=>{xe("")},N:function(e,t,n){e>>>=0,t>>>=0,n>>>=0,Et.length=0;for(var f;f=p()[t++>>>0];){var y=f!=105;y&=f!=112,n+=y&&n%8?4:0,Et.push(f==112?O()[n>>>2>>>0]:f==105?l()[n>>>2>>>0]:h()[n>>>3>>>0]),n+=y?8:4}return Ye[e].apply(null,Et)},n:()=>{},i:()=>Date.now(),V:()=>{throw ke+=1,"unwind"},C:function(){return 4294901760},e:()=>performance.timeOrigin+performance.now(),f:()=>P?(Mr(),ze(Tr)).cpus().length:navigator.hardwareConcurrency,z:function(e){e>>>=0;var t=p().length;if(e<=t||4294901760<e)return!1;for(var n=1;4>=n;n*=2){var f=t*(1+.2/n);f=Math.min(f,e+100663296);var y=Math;f=Math.max(e,f);e:{y=(y.min.call(y,4294901760,f+(65536-f%65536)%65536)-Z.buffer.byteLength+65535)/65536;try{Z.grow(y),V();var b=1;break e}catch{}b=void 0}if(b)return!0}return!1},P:Qt,Q:Zt,I:Fe,g:Kt,l:er,v:tr,k:rr,w:function(e,t){return e>>>=0,t>>>=0,nr(p().subarray(e>>>0,e+t>>>0)),0},a:Z||u.wasmMemory,x:sr,d:function(e,t,n,f){return sr(e>>>0,t>>>0,n>>>0,f>>>0)},j:function(e,t,n,f){let y=ge.length;e=new Uint8Array(p().slice(e+t,e+n));try{var b=new WebAssembly.Module(e),v=new WebAssembly.Instance(b,{env:{memory:Z}}),I;for(I in v.exports)ur(v.exports[I]);return y<ge.length?y:f}catch(ve){return console.log(ve),f}}},M=function(){function e(n,f){return M=n.exports,M=an(),C.gb.push(M.Da),ge=M.Ea,Me.unshift(M.X),Ae=f,Ce(),M}var t={a:nn};if(Se++,u.instantiateWasm)try{return u.instantiateWasm(t,e)}catch(n){re(`Module.instantiateWasm callback failed with error: ${n}`),D(n)}return lt(t,function(n){e(n.instance,n.module)}).catch(D),{}}();u._OrtInit=(e,t)=>(u._OrtInit=M.Y)(e,t),u._OrtGetLastError=(e,t)=>(u._OrtGetLastError=M.Z)(e,t),u._OrtCreateSessionOptions=(e,t,n,f,y,b,v,I,ve,ae)=>(u._OrtCreateSessionOptions=M._)(e,t,n,f,y,b,v,I,ve,ae),u._OrtAppendExecutionProvider=(e,t)=>(u._OrtAppendExecutionProvider=M.$)(e,t),u._OrtAddFreeDimensionOverride=(e,t,n)=>(u._OrtAddFreeDimensionOverride=M.aa)(e,t,n),u._OrtAddSessionConfigEntry=(e,t,n)=>(u._OrtAddSessionConfigEntry=M.ba)(e,t,n),u._OrtReleaseSessionOptions=e=>(u._OrtReleaseSessionOptions=M.ca)(e),u._OrtCreateSession=(e,t,n)=>(u._OrtCreateSession=M.da)(e,t,n),u._OrtReleaseSession=e=>(u._OrtReleaseSession=M.ea)(e),u._OrtGetInputOutputCount=(e,t,n)=>(u._OrtGetInputOutputCount=M.fa)(e,t,n),u._OrtGetInputName=(e,t)=>(u._OrtGetInputName=M.ga)(e,t),u._OrtGetOutputName=(e,t)=>(u._OrtGetOutputName=M.ha)(e,t),u._OrtFree=e=>(u._OrtFree=M.ia)(e),u._OrtCreateTensor=(e,t,n,f,y,b)=>(u._OrtCreateTensor=M.ja)(e,t,n,f,y,b),u._OrtGetTensorData=(e,t,n,f,y)=>(u._OrtGetTensorData=M.ka)(e,t,n,f,y),u._OrtReleaseTensor=e=>(u._OrtReleaseTensor=M.la)(e),u._OrtCreateRunOptions=(e,t,n,f)=>(u._OrtCreateRunOptions=M.ma)(e,t,n,f),u._OrtAddRunConfigEntry=(e,t,n)=>(u._OrtAddRunConfigEntry=M.na)(e,t,n),u._OrtReleaseRunOptions=e=>(u._OrtReleaseRunOptions=M.oa)(e),u._OrtCreateBinding=e=>(u._OrtCreateBinding=M.pa)(e),u._OrtBindInput=(e,t,n)=>(u._OrtBindInput=M.qa)(e,t,n),u._OrtBindOutput=(e,t,n,f)=>(u._OrtBindOutput=M.ra)(e,t,n,f),u._OrtClearBoundOutputs=e=>(u._OrtClearBoundOutputs=M.sa)(e),u._OrtReleaseBinding=e=>(u._OrtReleaseBinding=M.ta)(e),u._OrtRunWithBinding=(e,t,n,f,y)=>(u._OrtRunWithBinding=M.ua)(e,t,n,f,y),u._OrtRun=(e,t,n,f,y,b,v,I)=>(u._OrtRun=M.va)(e,t,n,f,y,b,v,I),u._OrtEndProfiling=e=>(u._OrtEndProfiling=M.wa)(e),u._OrtConfigure=(e,t)=>(u._OrtConfigure=M.xa)(e,t),u._OrtAuth=(e,t)=>(u._OrtAuth=M.ya)(e,t);var fr=()=>(fr=M.za)(),yt=u._pthread_self=()=>(yt=u._pthread_self=M.Aa)(),lr=u._malloc=e=>(lr=u._malloc=M.Ba)(e);u._free=e=>(u._free=M.Ca)(e),u.__emscripten_tls_init=()=>(u.__emscripten_tls_init=M.Da)();var cr=u.__emscripten_thread_init=(e,t,n,f,y,b)=>(cr=u.__emscripten_thread_init=M.Fa)(e,t,n,f,y,b);u.__emscripten_thread_crashed=()=>(u.__emscripten_thread_crashed=M.Ga)();var dr=(e,t,n,f)=>(dr=M.Ha)(e,t,n,f),Tt=e=>(Tt=M.Ia)(e),Mt=u.__emscripten_thread_exit=e=>(Mt=u.__emscripten_thread_exit=M.Ja)(e),pr=()=>(pr=M.Ka)(),mr=e=>(mr=M.La)(e),gr=(e,t)=>(gr=M.Ma)(e,t),Ct=()=>(Ct=M.Na)(),bt=e=>(bt=M.Oa)(e),xt=e=>(xt=M.Pa)(e);u.___start_em_js=887097,u.___stop_em_js=887709;function an(){var e=M;e=Object.assign({},e);var t=f=>()=>f()>>>0,n=f=>y=>f(y)>>>0;return e.za=t(e.za),e.Aa=t(e.Aa),e.Ba=n(e.Ba),e.emscripten_main_runtime_thread_id=t(e.emscripten_main_runtime_thread_id),e.Na=t(e.Na),e.Pa=n(e.Pa),e}u.wasmMemory=Z,u.stackAlloc=xt,u.stackSave=Ct,u.stackRestore=bt,u.keepRuntimeAlive=()=>0<ke,u.addFunction=ur,u.UTF8ToString=Ge,u.stringToUTF8=c,u.lengthBytesUTF8=a,u.ExitStatus=We,u.PThread=C;var wt;me=function e(){wt||hr(),wt||(me=e)};function hr(){if(!(0<Se))if(_)A(u),_||Je(Me),startWorker(u);else{if(u.preRun)for(typeof u.preRun=="function"&&(u.preRun=[u.preRun]);u.preRun.length;)Ne.unshift(u.preRun.shift());Je(Ne),0<Se||wt||(wt=!0,u.calledRun=!0,_e||(_||Je(Me),A(u),_||Je(Ee)))}}return hr(),d.ready}})();typeof xr=="object"&&typeof Wt=="object"?Wt.exports=Cr:typeof define=="function"&&define.amd&&define([],()=>Cr)});var Fr=ut((Un,gn)=>{gn.exports=\'"use strict";var Module={},ENVIRONMENT_IS_NODE=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string";if(ENVIRONMENT_IS_NODE){var nodeWorkerThreads=require("worker_threads"),parentPort=nodeWorkerThreads.parentPort;parentPort.on("message",e=>onmessage({data:e}));var fs=require("fs"),vm=require("vm");Object.assign(global,{self:global,require,Module,location:{href:__filename},Worker:nodeWorkerThreads.Worker,importScripts:e=>vm.runInThisContext(fs.readFileSync(e,"utf8"),{filename:e}),postMessage:e=>parentPort.postMessage(e),performance:global.performance||{now:Date.now}})}var initializedJS=!1;function threadPrintErr(){var e=Array.prototype.slice.call(arguments).join(" ");if(ENVIRONMENT_IS_NODE){fs.writeSync(2,e+`\\n`);return}console.error(e)}function threadAlert(){var e=Array.prototype.slice.call(arguments).join(" ");postMessage({cmd:"alert",text:e,threadId:Module._pthread_self()})}var err=threadPrintErr;self.alert=threadAlert,Module.instantiateWasm=(e,t)=>{var a=Module.wasmModule;Module.wasmModule=null;var r=new WebAssembly.Instance(a,e);return t(r)},self.onunhandledrejection=e=>{throw e.reason||e};function handleMessage(e){try{if(e.data.cmd==="load"){let a=[];self.onmessage=r=>a.push(r),self.startWorker=r=>{Module=r,postMessage({cmd:"loaded"});for(let s of a)handleMessage(s);self.onmessage=handleMessage},Module.wasmModule=e.data.wasmModule;for(const r of e.data.handlers)Module[r]=(...s)=>{postMessage({cmd:"callHandler",handler:r,args:s})};if(Module.wasmMemory=e.data.wasmMemory,Module.buffer=Module.wasmMemory.buffer,Module.ENVIRONMENT_IS_PTHREAD=!0,typeof e.data.urlOrBlob=="string")importScripts(e.data.urlOrBlob);else{var t=URL.createObjectURL(e.data.urlOrBlob);importScripts(t),URL.revokeObjectURL(t)}ortWasmThreaded(Module)}else if(e.data.cmd==="run"){Module.__emscripten_thread_init(e.data.pthread_ptr,0,0,1),Module.__emscripten_thread_mailbox_await(e.data.pthread_ptr),Module.establishStackSpace(),Module.PThread.receiveObjectTransfer(e.data),Module.PThread.threadInitTLS(),initializedJS||(initializedJS=!0);try{Module.invokeEntryPoint(e.data.start_routine,e.data.arg)}catch(a){if(a!="unwind")throw a}}else e.data.cmd==="cancel"?Module._pthread_self()&&Module.__emscripten_thread_exit(-1):e.data.target==="setimmediate"||(e.data.cmd==="checkMailbox"?initializedJS&&Module.checkMailbox():e.data.cmd&&(err(`worker.js received unknown command ${e.data.cmd}`),err(e.data)))}catch(a){throw Module.__emscripten_thread_crashed?.(),a}}self.onmessage=handleMessage;\\n\'});var Rr;Rr=Er();var hn=Dr(),Nt,Ht=!1,_t=!1,Ur=!1,yn=i=>{if(i===1)return!1;if(typeof SharedArrayBuffer>"u")return typeof self<"u"&&!self.crossOriginIsolated&&console.warn("env.wasm.numThreads is set to "+i+", but this will not work unless you enable crossOriginIsolated mode. See https://web.dev/cross-origin-isolation-guide/ for more info."),!1;typeof process<"u"&&process.versions&&process.versions.node&&console.warn("env.wasm.numThreads is set to "+i+", however, currently onnxruntime-web does not support multi-threads in Node.js. Please consider using onnxruntime-node for performance critical scenarios.");try{return typeof MessageChannel<"u"&&new MessageChannel().port1.postMessage(new SharedArrayBuffer(1)),WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,5,4,1,3,1,1,10,11,1,9,0,65,0,254,16,2,0,26,11]))}catch{return!1}},bn=()=>{try{return WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,10,30,1,28,0,65,0,253,15,253,12,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,253,186,1,26,11]))}catch{return!1}},wn=(i,d)=>i?d?"ort-wasm-simd-threaded.wasm":"ort-wasm-simd.wasm":d?"ort-wasm-threaded.wasm":"ort-wasm.wasm",Lr=async i=>{if(Ht)return Promise.resolve();if(_t)throw new Error("multiple calls to \'initializeWebAssembly()\' detected.");if(Ur)throw new Error("previous call to \'initializeWebAssembly()\' failed.");_t=!0;let d=i.initTimeout,o=i.numThreads,p=i.simd,l=yn(o),O=p&&bn(),h=i.wasmPaths,u=typeof h=="string"?h:void 0,A=wn(O,l),D=typeof h=="object"?h[A]:void 0,R=!1,U=[];if(d>0&&U.push(new Promise(L=>{setTimeout(()=>{R=!0,L()},d)})),U.push(new Promise((L,te)=>{let B=l?hn:Rr,P={locateFile:(_,N)=>l&&_.endsWith(".worker.js")&&typeof Blob<"u"?URL.createObjectURL(new Blob([Fr()],{type:"text/javascript"})):_.endsWith(".wasm")?D||(u??N)+A:N+_};if(l)if(P.numThreads=o,typeof Blob>"u")P.mainScriptUrlOrBlob=(void 0)(__dirname,"ort-wasm-threaded.js");else{let _=`var ortWasmThreaded=${B.toString()};`;P.mainScriptUrlOrBlob=new Blob([_],{type:"text/javascript"})}B(P).then(_=>{_t=!1,Ht=!0,Nt=_,L()},_=>{_t=!1,Ur=!0,te(_)})})),await Promise.race(U),R)throw new Error(`WebAssembly backend initializing failed due to timeout: ${d}ms`)},J=()=>{if(Ht&&Nt)return Nt;throw new Error("WebAssembly is not initialized yet.")};var X=(i,d)=>{let o=J(),p=o.lengthBytesUTF8(i)+1,l=o._malloc(p);return o.stringToUTF8(i,l,p),d.push(l),l},ft=(i,d,o,p)=>{if(typeof i=="object"&&i!==null){if(o.has(i))throw new Error("Circular reference in options");o.add(i)}Object.entries(i).forEach(([l,O])=>{let h=d?d+l:l;if(typeof O=="object")ft(O,h+".",o,p);else if(typeof O=="string"||typeof O=="number")p(h,O.toString());else if(typeof O=="boolean")p(h,O?"1":"0");else throw new Error(`Can\'t handle extra config type: ${typeof O}`)})},Q=i=>{let d=J(),o=d.stackSave();try{let p=d.stackAlloc(8);d._OrtGetLastError(p,p+4);let l=d.HEAP32[p/4],O=d.HEAPU32[p/4+1],h=O?d.UTF8ToString(O):"";throw new Error(`${i} ERROR_CODE: ${l}, ERROR_MESSAGE: ${h}`)}finally{d.stackRestore(o)}};var Pr=i=>{let d=J(),o=0,p=[],l=i||{};try{if(i?.logSeverityLevel===void 0)l.logSeverityLevel=2;else if(typeof i.logSeverityLevel!="number"||!Number.isInteger(i.logSeverityLevel)||i.logSeverityLevel<0||i.logSeverityLevel>4)throw new Error(`log serverity level is not valid: ${i.logSeverityLevel}`);if(i?.logVerbosityLevel===void 0)l.logVerbosityLevel=0;else if(typeof i.logVerbosityLevel!="number"||!Number.isInteger(i.logVerbosityLevel))throw new Error(`log verbosity level is not valid: ${i.logVerbosityLevel}`);i?.terminate===void 0&&(l.terminate=!1);let O=0;return i?.tag!==void 0&&(O=X(i.tag,p)),o=d._OrtCreateRunOptions(l.logSeverityLevel,l.logVerbosityLevel,!!l.terminate,O),o===0&&Q("Can\'t create run options."),i?.extra!==void 0&&ft(i.extra,"",new WeakSet,(h,u)=>{let A=X(h,p),D=X(u,p);d._OrtAddRunConfigEntry(o,A,D)!==0&&Q(`Can\'t set a run config entry: ${h} - ${u}.`)}),[o,p]}catch(O){throw o!==0&&d._OrtReleaseRunOptions(o),p.forEach(h=>d._free(h)),O}};var On=i=>{switch(i){case"disabled":return 0;case"basic":return 1;case"extended":return 2;case"all":return 99;default:throw new Error(`unsupported graph optimization level: ${i}`)}},vn=i=>{switch(i){case"sequential":return 0;case"parallel":return 1;default:throw new Error(`unsupported execution mode: ${i}`)}},_n=i=>{i.extra||(i.extra={}),i.extra.session||(i.extra.session={});let d=i.extra.session;d.use_ort_model_bytes_directly||(d.use_ort_model_bytes_directly="1"),i.executionProviders&&i.executionProviders.some(o=>(typeof o=="string"?o:o.name)==="webgpu")&&(i.enableMemPattern=!1)},En=(i,d,o)=>{for(let p of d){let l=typeof p=="string"?p:p.name;switch(l){case"webnn":if(l="WEBNN",typeof p!="string"){let h=p;if(h?.deviceType){let u=X("deviceType",o),A=X(h.deviceType,o);J()._OrtAddSessionConfigEntry(i,u,A)!==0&&Q(`Can\'t set a session config entry: \'deviceType\' - ${h.deviceType}.`)}if(h?.numThreads){let u=h.numThreads;(typeof u!="number"||!Number.isInteger(u)||u<0)&&(u=0);let A=X("numThreads",o),D=X(u.toString(),o);J()._OrtAddSessionConfigEntry(i,A,D)!==0&&Q(`Can\'t set a session config entry: \'numThreads\' - ${h.numThreads}.`)}if(h?.powerPreference){let u=X("powerPreference",o),A=X(h.powerPreference,o);J()._OrtAddSessionConfigEntry(i,u,A)!==0&&Q(`Can\'t set a session config entry: \'powerPreference\' - ${h.powerPreference}.`)}}break;case"webgpu":if(l="JS",typeof p!="string"){let h=p;if(h?.preferredLayout){if(h.preferredLayout!=="NCHW"&&h.preferredLayout!=="NHWC")throw new Error(`preferredLayout must be either \'NCHW\' or \'NHWC\': ${h.preferredLayout}`);let u=X("preferredLayout",o),A=X(h.preferredLayout,o);J()._OrtAddSessionConfigEntry(i,u,A)!==0&&Q(`Can\'t set a session config entry: \'preferredLayout\' - ${h.preferredLayout}.`)}}break;case"wasm":case"cpu":continue;default:throw new Error(`not supported execution provider: ${l}`)}let O=X(l,o);J()._OrtAppendExecutionProvider(i,O)!==0&&Q(`Can\'t append execution provider: ${l}.`)}},Br=i=>{let d=J(),o=0,p=[],l=i||{};_n(l);try{let O=On(l.graphOptimizationLevel??"all"),h=vn(l.executionMode??"sequential"),u=typeof l.logId=="string"?X(l.logId,p):0,A=l.logSeverityLevel??2;if(!Number.isInteger(A)||A<0||A>4)throw new Error(`log serverity level is not valid: ${A}`);let D=l.logVerbosityLevel??0;if(!Number.isInteger(D)||D<0||D>4)throw new Error(`log verbosity level is not valid: ${D}`);let R=typeof l.optimizedModelFilePath=="string"?X(l.optimizedModelFilePath,p):0;if(o=d._OrtCreateSessionOptions(O,!!l.enableCpuMemArena,!!l.enableMemPattern,h,!!l.enableProfiling,0,u,A,D,R),o===0&&Q("Can\'t create session options."),l.executionProviders&&En(o,l.executionProviders,p),l.enableGraphCapture!==void 0){if(typeof l.enableGraphCapture!="boolean")throw new Error(`enableGraphCapture must be a boolean value: ${l.enableGraphCapture}`);let U=X("enableGraphCapture",p),L=X(l.enableGraphCapture.toString(),p);d._OrtAddSessionConfigEntry(o,U,L)!==0&&Q(`Can\'t set a session config entry: \'enableGraphCapture\' - ${l.enableGraphCapture}.`)}if(l.freeDimensionOverrides)for(let[U,L]of Object.entries(l.freeDimensionOverrides)){if(typeof U!="string")throw new Error(`free dimension override name must be a string: ${U}`);if(typeof L!="number"||!Number.isInteger(L)||L<0)throw new Error(`free dimension override value must be a non-negative integer: ${L}`);let te=X(U,p);d._OrtAddFreeDimensionOverride(o,te,L)!==0&&Q(`Can\'t set a free dimension override: ${U} - ${L}.`)}return l.extra!==void 0&&ft(l.extra,"",new WeakSet,(U,L)=>{let te=X(U,p),B=X(L,p);d._OrtAddSessionConfigEntry(o,te,B)!==0&&Q(`Can\'t set a session config entry: ${U} - ${L}.`)}),[o,p]}catch(O){throw o!==0&&d._OrtReleaseSessionOptions(o),p.forEach(h=>d._free(h)),O}};var kt=i=>{switch(i){case"int8":return 3;case"uint8":return 2;case"bool":return 9;case"int16":return 5;case"uint16":return 4;case"int32":return 6;case"uint32":return 12;case"float16":return 10;case"float32":return 1;case"float64":return 11;case"string":return 8;case"int64":return 7;case"uint64":return 13;default:throw new Error(`unsupported data type: ${i}`)}},Ir=i=>{switch(i){case 3:return"int8";case 2:return"uint8";case 9:return"bool";case 5:return"int16";case 4:return"uint16";case 6:return"int32";case 12:return"uint32";case 10:return"float16";case 1:return"float32";case 11:return"float64";case 8:return"string";case 7:return"int64";case 13:return"uint64";default:throw new Error(`unsupported data type: ${i}`)}},Gt=i=>[void 0,4,1,1,2,2,4,8,void 0,1,2,8,4,8,void 0,void 0,void 0][i],Wr=i=>{switch(i){case"float16":return Uint16Array;case"float32":return Float32Array;case"uint8":return Uint8Array;case"int8":return Int8Array;case"uint16":return Uint16Array;case"int16":return Int16Array;case"int32":return Int32Array;case"bool":return Uint8Array;case"float64":return Float64Array;case"uint32":return Uint32Array;case"int64":return BigInt64Array;case"uint64":return BigUint64Array;default:throw new Error(`unsupported type: ${i}`)}},Nr=i=>{switch(i){case"verbose":return 0;case"info":return 1;case"warning":return 2;case"error":return 3;case"fatal":return 4;default:throw new Error(`unsupported logging level: ${i}`)}},Hr=i=>i==="float32"||i==="int32"||i==="int64"||i==="bool"||i==="float16"||i==="uint32",kr=i=>{switch(i){case"none":return 0;case"cpu":return 1;case"cpu-pinned":return 2;case"texture":return 3;case"gpu-buffer":return 4;default:throw new Error(`unsupported data location: ${i}`)}};var Gr=async i=>{if(typeof i=="string")if(typeof process<"u"&&process.versions&&process.versions.node)try{return new Uint8Array(await(void 0)(i))}catch(d){if(d.code==="ERR_FS_FILE_TOO_LARGE"){let o=(void 0)(i),p=[];for await(let l of o)p.push(l);return new Uint8Array(Buffer.concat(p))}throw d}else{let d=await fetch(i);if(!d.ok)throw new Error(`failed to load external data file: ${i}`);let o=d.headers.get("Content-Length"),p=o?parseInt(o,10):0;if(p<1073741824)return new Uint8Array(await d.arrayBuffer());{if(!d.body)throw new Error(`failed to load external data file: ${i}, no response body.`);let l=d.body.getReader(),O;try{O=new ArrayBuffer(p)}catch(u){if(u instanceof RangeError){let A=Math.ceil(p/65536);O=new WebAssembly.Memory({initial:A,maximum:A}).buffer}else throw u}let h=0;for(;;){let{done:u,value:A}=await l.read();if(u)break;let D=A.byteLength;new Uint8Array(O,h,D).set(A),h+=D}return new Uint8Array(O,0,p)}}else return i instanceof Blob?new Uint8Array(await i.arrayBuffer()):i instanceof Uint8Array?i:new Uint8Array(i)};var Sn=(i,d)=>{J()._OrtInit(i,d)!==0&&Q("Can\'t initialize onnxruntime.")},jr=async i=>{Sn(i.wasm.numThreads,Nr(i.logLevel))},zr=async(i,d)=>{},Ke=new Map,An=i=>{let d=J(),o=d.stackSave();try{let p=d.stackAlloc(8);return d._OrtGetInputOutputCount(i,p,p+4)!==0&&Q("Can\'t get session input/output count."),[d.HEAP32[p/4],d.HEAP32[p/4+1]]}finally{d.stackRestore(o)}},$t=i=>{let d=J(),o=d._malloc(i.byteLength);if(o===0)throw new Error(`Can\'t create a session. failed to allocate a buffer of size ${i.byteLength}.`);return d.HEAPU8.set(i,o),[o,i.byteLength]},Yr=async(i,d)=>{let o,p,l=J();Array.isArray(i)?[o,p]=i:i.buffer===l.HEAPU8.buffer?[o,p]=[i.byteOffset,i.byteLength]:[o,p]=$t(i);let O=0,h=0,u=0,A=[],D=[],R=[];try{if([h,A]=Br(d),d?.externalData&&l.mountExternalData){let G=[];for(let $ of d.externalData){let oe=typeof $=="string"?$:$.path;G.push(Gr(typeof $=="string"?$:$.data).then(ee=>{l.mountExternalData(oe,ee)}))}await Promise.all(G)}O=l._OrtCreateSession(o,p,h),O===0&&Q("Can\'t create a session.");let[U,L]=An(O),te=!!d?.enableGraphCapture,B=[],P=[],_=[];for(let G=0;G<U;G++){let $=l._OrtGetInputName(O,G);$===0&&Q("Can\'t get an input name."),D.push($),B.push(l.UTF8ToString($))}for(let G=0;G<L;G++){let $=l._OrtGetOutputName(O,G);$===0&&Q("Can\'t get an output name."),R.push($);let oe=l.UTF8ToString($);P.push(oe)}let N=null;return Ke.set(O,[O,D,R,N,te,!1]),[O,B,P]}catch(U){throw D.forEach(L=>l._OrtFree(L)),R.forEach(L=>l._OrtFree(L)),u!==0&&l._OrtReleaseBinding(u),O!==0&&l._OrtReleaseSession(O),U}finally{l._free(o),h!==0&&l._OrtReleaseSessionOptions(h),A.forEach(U=>l._free(U)),l.unmountExternalData?.()}},Vr=i=>{let d=J(),o=Ke.get(i);if(!o)throw new Error(`cannot release session. invalid session id: ${i}`);let[p,l,O,h,u]=o;h&&(u&&d._OrtClearBoundOutputs(h.handle),d._OrtReleaseBinding(h.handle)),d.jsepOnReleaseSession?.(i),l.forEach(A=>d._OrtFree(A)),O.forEach(A=>d._OrtFree(A)),d._OrtReleaseSession(p),Ke.delete(i)},Tn=(i,d,o)=>{if(i!==null&&i[0]===d){let l=i[2];if(l.length===o)return l}let p=Wr(d);return new p(o)},$r=(i,d,o,p,l,O=!1)=>{if(!i){d.push(0);return}let h=J(),u=i[0],A=i[1],D=i[3],R,U;if(u==="string"&&D==="gpu-buffer")throw new Error("String tensor is not supported on GPU.");if(O&&D!=="gpu-buffer")throw new Error(`External buffer must be provided for input/output index ${l} when enableGraphCapture is true.`);if(D==="gpu-buffer"){let B=i[2].gpuBuffer,P=Gt(kt(u));U=A.reduce((_,N)=>_*N,1)*P,R=h.jsepRegisterBuffer(p,l,B,U)}else{let B=i[2];if(Array.isArray(B)){U=4*B.length,R=h._malloc(U),o.push(R);let P=R/4;for(let _=0;_<B.length;_++){if(typeof B[_]!="string")throw new TypeError(`tensor data at index ${_} is not a string`);h.HEAPU32[P++]=X(B[_],o)}}else U=B.byteLength,R=h._malloc(U),o.push(R),h.HEAPU8.set(new Uint8Array(B.buffer,B.byteOffset,U),R)}let L=h.stackSave(),te=h.stackAlloc(4*A.length);try{let B=te/4;A.forEach(_=>h.HEAP32[B++]=_);let P=h._OrtCreateTensor(kt(u),R,U,te,A.length,kr(D));P===0&&Q(`Can\'t create tensor for input/output. session=${p}, index=${l}.`),d.push(P)}finally{h.stackRestore(L)}},qr=i=>{let o=new TextEncoder().encode(i),p=J(),l=p._malloc(o.byteLength);p.HEAPU8.set(o,l);let O=p._OrtConfigure(l,o.byteLength);if(O===0)throw new Error("Can\'t get an configure key");let h=p.UTF8ToString(O);return p._OrtFree(O),h},Jr=i=>{let o=new TextEncoder().encode(i),p=J(),l=p._malloc(o.byteLength);p.HEAPU8.set(o,l);let O=p._OrtAuth(l,o.byteLength);if(O===0)throw new Error("Can\'t get an auth result");let h=p.UTF8ToString(O);return p._OrtFree(O),h},Xr=async(i,d,o,p,l,O)=>{let h=J(),u=Ke.get(i);if(!u)throw new Error(`cannot run inference. invalid session id: ${i}`);let A=u[0],D=u[1],R=u[2],U=u[3],L=u[4],te=u[5],B=d.length,P=p.length,_=0,N=[],G=[],$=[],oe=[],ee=h.stackSave(),S=h.stackAlloc(B*4),Y=h.stackAlloc(B*4),Ue=h.stackAlloc(P*4),Ie=h.stackAlloc(P*4);try{[_,N]=Pr(O);for(let F=0;F<B;F++)$r(o[F],G,oe,i,d[F],L);for(let F=0;F<P;F++){let de=l[F],we=de?.[3]??"";$r(we==="gpu-buffer"?de:null,$,oe,i,B+p[F],L)}let ce=S/4,re=Y/4,Z=Ue/4,Ae=Ie/4;for(let F=0;F<B;F++)h.HEAPU32[ce++]=G[F],h.HEAPU32[re++]=D[d[F]];for(let F=0;F<P;F++)h.HEAPU32[Z++]=$[F],h.HEAPU32[Ae++]=R[p[F]];let _e;h.jsepOnRunStart?.(A),_e=await h._OrtRun(A,Y,S,B,Ie,P,Ue,_),_e!==0&&Q("failed to call OrtRun().");let ne=[];for(let F=0;F<P;F++){let de=h.HEAPU32[Ue/4+F];if(de===$[F]){ne.push(l[F]);continue}let we=h.stackSave(),le=h.stackAlloc(4*4),Te=!1,V,pe=0;try{h._OrtGetTensorData(de,le,le+4,le+8,le+12)!==0&&Q(`Can\'t access output tensor data on index ${F}.`);let Me=le/4,Ee=h.HEAPU32[Me++];pe=h.HEAPU32[Me++];let Se=h.HEAPU32[Me++],He=h.HEAPU32[Me++],me=[];for(let q=0;q<He;q++)me.push(h.HEAPU32[Se/4+q]);h._OrtFree(Se);let Ce=me.reduce((q,se)=>q*se,1);V=Ir(Ee);let xe=U?.outputPreferredLocations[p[F]];if(V==="string"){if(xe==="gpu-buffer")throw new Error("String tensor is not supported on GPU.");let q=[],se=pe/4;for(let ye=0;ye<Ce;ye++){let Re=h.HEAPU32[se++],De=ye===Ce-1?void 0:h.HEAPU32[se]-Re;q.push(h.UTF8ToString(Re,De))}ne.push([V,me,q,"cpu"])}else if(xe==="gpu-buffer"&&Ce>0){let q=h.jsepGetBuffer(pe),se=Gt(Ee);if(se===void 0||!Hr(V))throw new Error(`Unsupported data type: ${V}`);Te=!0,ne.push([V,me,{gpuBuffer:q,download:h.jsepCreateDownloader(q,Ce*se,V),dispose:()=>{h._OrtReleaseTensor(de)}},"gpu-buffer"])}else{let q=Tn(l[F],V,Ce);new Uint8Array(q.buffer,q.byteOffset,q.byteLength).set(h.HEAPU8.subarray(pe,pe+q.byteLength)),ne.push([V,me,q,"cpu"])}}finally{h.stackRestore(we),V==="string"&&pe&&h._free(pe),Te||h._OrtReleaseTensor(de)}}return U&&!L&&(h._OrtClearBoundOutputs(U.handle),Ke.set(i,[A,D,R,U,L,!1])),ne}finally{h.stackRestore(ee),G.forEach(ce=>h._OrtReleaseTensor(ce)),$.forEach(ce=>h._OrtReleaseTensor(ce)),oe.forEach(ce=>h._free(ce)),_!==0&&h._OrtReleaseRunOptions(_),N.forEach(ce=>h._free(ce))}},Qr=i=>{let d=J(),o=Ke.get(i);if(!o)throw new Error("invalid session id");let p=o[0],l=d._OrtEndProfiling(p);l===0&&Q("Can\'t get an profile file name."),d._OrtFree(l)},jt=i=>{let d=[];for(let o of i){let p=o[2];!Array.isArray(p)&&"buffer"in p&&d.push(p.buffer)}return d};self.onmessage=i=>{let{type:d,in:o}=i.data;try{switch(d){case"init-wasm":Lr(o.wasm).then(()=>{jr(o).then(()=>{postMessage({type:d})},p=>{postMessage({type:d,err:p})})},p=>{postMessage({type:d,err:p})});break;case"init-ep":{let{epName:p,env:l}=o;zr(l,p).then(()=>{postMessage({type:d})},O=>{postMessage({type:d,err:O})});break}case"copy-from":{let{buffer:p}=o,l=$t(p);postMessage({type:d,out:l});break}case"create":{let{model:p,options:l}=o;Yr(p,l).then(O=>{postMessage({type:d,out:O})},O=>{postMessage({type:d,err:O})});break}case"release":Vr(o),postMessage({type:d});break;case"run":{let{sessionId:p,inputIndices:l,inputs:O,outputIndices:h,options:u}=o,A=i.data.prealloc??[];for(;A.length<h.length;)A.push(null);Xr(p,l,O,h,A,u).then(D=>{D.some(R=>R[3]!=="cpu")?postMessage({type:d,err:"Proxy does not support non-cpu tensor location."}):postMessage({type:d,out:D,inputsBack:O},jt(D).concat(jt(O)))},D=>{postMessage({type:d,err:D})});break}case"configure":try{let p=qr(i.data.in);postMessage({type:"configure",out:p})}catch(p){postMessage({type:"configure",err:p})}break;case"auth":try{let p=Jr(i.data.in);postMessage({type:"auth",out:p})}catch(p){postMessage({type:"auth",err:p})}break;case"end-profiling":Qr(o),postMessage({type:d});break;default:}}catch(p){postMessage({type:d,err:p})}};})();\n'})),Kt,it,Sn,Mo,Go,va,Uo,or,ir,Cg,Ro,Fg,pd,dd,hd,md,bd,gd,yd,Td,xd,_a=D((()=>{_t(),fd(),Kr(),Kt=()=>!!ee.wasm.proxy&&typeof document<"u",Sn=!1,Mo=!1,Go=!1,Uo=new Map,or=(e,t)=>{let r=Uo.get(e);r?r.push(t):Uo.set(e,[t])},ir=()=>{if(Sn||!Mo||Go||!it)throw new Error("worker not ready")},Cg=e=>{switch(e.data.type){case"init-wasm":Sn=!1,e.data.err?(Go=!0,va[1](e.data.err)):(Mo=!0,va[0]());break;case"init-ep":case"copy-from":case"create":case"configure":case"auth":case"release":case"end-profiling":{let t=Uo.get(e.data.type);e.data.err?t.shift()[1](e.data.err):t.shift()[0](e.data.out);break}case"run":{let t=Uo.get(e.data.type);e.data.err?t.shift()[1](e.data.err):t.shift()[0](e.data.out.concat(e.data.inputsBack));break}}},Ro=typeof document<"u"?document?.currentScript?.src:void 0,Fg=e=>{let t=[];for(var r=0;r<e.length;++r){let n=e[r];null!==n&&t.push(n)}return t},pd=async()=>{if(!Mo){if(Sn)throw new Error("multiple calls to 'initWasm()' detected.");if(Go)throw new Error("previous call to 'initWasm()' failed.");if(Sn=!0,Kt())return void 0===ee.wasm.wasmPaths&&Ro&&0!==Ro.indexOf("blob:")&&(ee.wasm.wasmPaths=Ro.substr(0,+Ro.lastIndexOf("/")+1)),new Promise(((e,t)=>{it?.terminate();let r=URL.createObjectURL(new Blob([cd()],{type:"text/javascript"}));(it=new Worker(r,{name:"ort-wasm-proxy-worker"})).onerror=e=>t(e),it.onmessage=Cg,URL.revokeObjectURL(r),va=[e,t];let n={type:"init-wasm",in:ee};it.postMessage(n)}));try{await jp(ee.wasm),await rd(ee),Mo=!0}catch(e){throw Go=!0,e}finally{Sn=!1}}},dd=async e=>{if(Kt())return ir(),new Promise(((t,r)=>{or("init-ep",[t,r]);let n={type:"init-ep",in:{epName:e,env:ee}};it.postMessage(n)}));await nd(ee,e)},hd=async e=>Kt()?(ir(),new Promise(((t,r)=>{or("copy-from",[t,r]);let n={type:"copy-from",in:{buffer:e}};it.postMessage(n,[e.buffer])}))):xa(e),md=async(e,t)=>{if(Kt()){if(t?.preferredOutputLocation)throw new Error('session option "preferredOutputLocation" is not supported for proxy.');return ir(),new Promise(((r,n)=>{or("create",[r,n]);let i={type:"create",in:{model:e,options:t}},o=[];e instanceof Uint8Array&&o.push(e.buffer),it.postMessage(i,o)}))}return od(e,t)},bd=async e=>{if(Kt())return ir(),new Promise(((t,r)=>{or("release",[t,r]);let n={type:"release",in:e};it.postMessage(n)}));id(e)},gd=async e=>Kt()?(ir(),new Promise(((t,r)=>{or("configure",[t,r]);let n={type:"configure",in:e};it.postMessage(n)}))):ad(e),yd=async e=>Kt()?(ir(),new Promise(((t,r)=>{or("auth",[t,r]);let n={type:"auth",in:e};it.postMessage(n)}))):sd(e),Td=async(e,t,r,n,i,o)=>{if(Kt()){if(r.some((e=>"cpu"!==e[3])))throw new Error("input tensor on GPU is not supported for proxy.");return ir(),new Promise(((a,s)=>{or("run",[a,s]);let u=r,l={type:"run",in:{sessionId:e,inputIndices:t,inputs:u,outputIndices:n,options:o},prealloc:i};it.postMessage(l,wa(u).concat(wa(Fg(i))))}))}return ud(e,t,r,n,i,o).then((e=>e.concat(r)))},xd=async e=>{if(Kt())return ir(),new Promise(((t,r)=>{or("end-profiling",[t,r]);let n={type:"end-profiling",in:e};it.postMessage(n)}));ld(e)}})),wd,vd,zo,_d=D((()=>{_t(),_a(),ya(),Ta(),wd=(e,t)=>{switch(e.location){case"cpu":return[e.type,e.dims,e.data,"cpu"];case"gpu-buffer":return[e.type,e.dims,{gpuBuffer:e.gpuBuffer},"gpu-buffer"];default:throw new Error(`invalid data location: ${e.location} for ${t()}`)}},vd=e=>{switch(e[3]){case"cpu":return new Ne(e[0],e[2],e[1]);case"gpu-buffer":{let t=e[0];if(!No(t))throw new Error(`not supported data type: ${t} for deserializing GPU tensor`);let{gpuBuffer:r,download:n,dispose:i}=e[2];return Ne.fromGpuBuffer(r,{dataType:t,dims:e[1],download:n,dispose:i})}default:throw new Error(`invalid data location: ${e[3]}`)}},zo=class{async fetchModelAndCopyToWasmMemory(e){return hd(await On(e))}async loadModel(e,t){let r;br(),r="string"==typeof e?typeof process<"u"&&process.versions&&process.versions.node?await On(e):await this.fetchModelAndCopyToWasmMemory(e):e,[this.sessionId,this.inputNames,this.outputNames]=await md(r,t),gr()}async dispose(){return bd(this.sessionId)}async configure(e){return gd(e)}async auth(e){return yd(e)}async run(e,t,r){br();let n=[],i=[];Object.entries(e).forEach((e=>{let t=e[0],r=e[1],o=this.inputNames.indexOf(t);if(-1===o)throw new Error(`invalid input '${t}'`);n.push(r),i.push(o)}));let o=[],a=[],s=e=>null!==e&&"gpu-buffer"===e.location?e:null;Object.entries(t).forEach((e=>{let t=e[0],r=e[1],n=this.outputNames.indexOf(t);if(-1===n)throw new Error(`invalid output '${t}'`);o.push(r),a.push(n)}));let u=n.map(((e,t)=>wd(e,(()=>`input "${this.inputNames[i[t]]}"`)))),l=o.map(((e,t)=>e?wd(e,(()=>`output "${this.outputNames[a[t]]}"`)):null)),h=await Td(this.sessionId,i,u,a,l,r),c={},f=[];for(let e=0;e<h.length;e++)e>=a.length?f.push(vd(h[e])):c[this.outputNames[a[e]]]=s(o[e])??vd(h[e]);return f.length>0&&(c.inputBack=f[0]),gr(),c}startProfiling(){}endProfiling(){xd(this.sessionId)}}})),Bg,Wo,Od=D((()=>{_t(),_a(),_d(),Bg=()=>{if(("number"!=typeof ee.wasm.initTimeout||ee.wasm.initTimeout<0)&&(ee.wasm.initTimeout=0),"boolean"!=typeof ee.wasm.simd&&(ee.wasm.simd=!0),"boolean"!=typeof ee.wasm.proxy&&(ee.wasm.proxy=!1),"boolean"!=typeof ee.wasm.trace&&(ee.wasm.trace=!1),"number"!=typeof ee.wasm.numThreads||!Number.isInteger(ee.wasm.numThreads)||ee.wasm.numThreads<=0){(typeof self<"u"&&!self.crossOriginIsolated||typeof process<"u"&&process.versions&&process.versions.node)&&(ee.wasm.numThreads=1);let e=typeof navigator>"u"?(void 0)().length:navigator.hardwareConcurrency;ee.wasm.numThreads=Math.min(4,Math.ceil((e||1)/2))}},Wo=class{async init(e){Bg(),await pd(),await dd(e)}async createInferenceSessionHandler(e,t){let r=new zo;return await r.loadModel(e,t),Promise.resolve(r)}}})),Sd={};pr(Sd,{wasmBackend:()=>$g});var $g,Id=D((()=>{Od(),$g=new Wo}));_t(),_t(),_t();var Is="1.17.0",nS=ei;{let e=(Lp(),jt(Dp)).onnxjsBackend;hr("webgl",e,-10)}{let e=(Id(),jt(Sd)).wasmBackend;hr("cpu",e,10),hr("wasm",e,10),hr("webnn",e,9)}Object.defineProperty(ee.versions,"web",{value:Is,enumerable:!0})},5034:(e,t,r)=>{r.r(t),r.d(t,{ALPHA_MODES:()=>n.Gk,AbstractMultiResource:()=>n.CI,AccessibilityManager:()=>U,AlphaFilter:()=>m,AnimatedSprite:()=>Jr,Application:()=>z,ArrayResource:()=>n.aV,Assets:()=>Ie,AssetsClass:()=>Ae,Attribute:()=>n.nW,BLEND_MODES:()=>n.B9,BUFFER_BITS:()=>n.wn,BUFFER_TYPE:()=>n.yw,BackgroundSystem:()=>n.sN,BaseImageResource:()=>n.jH,BasePrepare:()=>Hr,BaseRenderTexture:()=>n.LE,BaseTexture:()=>n.t5,BatchDrawCall:()=>n.hq,BatchGeometry:()=>n.JH,BatchRenderer:()=>n.ch,BatchShaderGenerator:()=>n.LQ,BatchSystem:()=>n.A6,BatchTextureArray:()=>n.cc,BitmapFont:()=>bn,BitmapFontData:()=>hn,BitmapText:()=>En,BlobResource:()=>Ye,BlurFilter:()=>b,BlurFilterPass:()=>v,Bounds:()=>i,BrowserAdapter:()=>n.OF,Buffer:()=>n.hp,BufferResource:()=>n.dZ,BufferSystem:()=>n.yn,CLEAR_MODES:()=>n.fr,COLOR_MASK_BITS:()=>n.Eq,Cache:()=>Y,CanvasResource:()=>n.Bu,Circle:()=>n.jl,Color:()=>n.Q1,ColorMatrixFilter:()=>x,CompressedTextureResource:()=>Xe,Container:()=>h,ContextSystem:()=>n.bD,CountLimiter:()=>Br,CubeResource:()=>n.WQ,DEG_TO_RAD:()=>n.Td,DRAW_MODES:()=>n._4,DisplacementFilter:()=>_,DisplayObject:()=>o,ENV:()=>n.Km,Ellipse:()=>n.Pp,EventBoundary:()=>R,EventSystem:()=>L,ExtensionType:()=>n.Ag,Extract:()=>Rt,FORMATS:()=>n.hR,FORMATS_TO_COMPONENTS:()=>St,FXAAFilter:()=>S,FederatedDisplayObject:()=>N,FederatedEvent:()=>A,FederatedMouseEvent:()=>I,FederatedPointerEvent:()=>P,FederatedWheelEvent:()=>k,FillStyle:()=>nr,Filter:()=>n.dJ,FilterState:()=>n.OO,FilterSystem:()=>n.u9,Framebuffer:()=>n.GW,FramebufferSystem:()=>n.nj,GC_MODES:()=>n.OS,GLFramebuffer:()=>n.pq,GLProgram:()=>n._H,GLTexture:()=>n.Ru,GRAPHICS_CURVES:()=>zt,GenerateTextureSystem:()=>n.yI,Geometry:()=>n.V2,GeometrySystem:()=>n.kb,Graphics:()=>sr,GraphicsData:()=>Jt,GraphicsGeometry:()=>rr,HTMLText:()=>Cn,HTMLTextStyle:()=>Pn,IGLUniformData:()=>n.n1,INSTALLED:()=>n.Ln,INTERNAL_FORMATS:()=>ze,INTERNAL_FORMAT_TO_BYTES_PER_PIXEL:()=>Ge,ImageBitmapResource:()=>n.di,ImageResource:()=>n.Gj,LINE_CAP:()=>Ut,LINE_JOIN:()=>Ft,LineStyle:()=>ir,LoaderParserPriority:()=>Z,MASK_TYPES:()=>n.vg,MIPMAP_MODES:()=>n.E8,MSAA_QUALITY:()=>n.he,MaskData:()=>n.XN,MaskSystem:()=>n.iW,Matrix:()=>n.uq,Mesh:()=>dr,MeshBatchUvs:()=>lr,MeshGeometry:()=>pr,MeshMaterial:()=>yr,MultisampleSystem:()=>n.DT,NineSlicePlane:()=>vr,NoiseFilter:()=>T,ObjectRenderer:()=>n.Pt,ObjectRendererSystem:()=>n.IH,ObservablePoint:()=>n.oA,PI_2:()=>n.TO,PRECISION:()=>n.Pk,ParticleContainer:()=>_r,ParticleRenderer:()=>Tr,PlaneGeometry:()=>mr,PluginSystem:()=>n.$o,Point:()=>n.bR,Polygon:()=>n.tS,Prepare:()=>Kr,Program:()=>n.BP,ProjectionSystem:()=>n.hk,Quad:()=>n.kO,QuadUv:()=>n.X1,RAD_TO_DEG:()=>n.bO,RENDERER_TYPE:()=>n.h3,Rectangle:()=>n.M_,RenderTexture:()=>n.Y7,RenderTexturePool:()=>n.O1,RenderTextureSystem:()=>n.Bw,Renderer:()=>n.A4,ResizePlugin:()=>G,Resource:()=>n.FW,RopeGeometry:()=>gr,RoundedRectangle:()=>n.TE,Runner:()=>n.by,SAMPLER_TYPES:()=>n.XZ,SCALE_MODES:()=>n.M6,SHAPES:()=>n.HY,SVGResource:()=>n.$f,ScissorSystem:()=>n.s9,Shader:()=>n.Mt,ShaderSystem:()=>n.$P,SimpleMesh:()=>br,SimplePlane:()=>wr,SimpleRope:()=>xr,Sprite:()=>d,SpriteMaskFilter:()=>n.ah,Spritesheet:()=>an,StartupSystem:()=>n.fE,State:()=>n.Uw,StateSystem:()=>n.D8,StencilSystem:()=>n.iH,SystemManager:()=>n.zi,TARGETS:()=>n.dW,TEXT_GRADIENT:()=>Er,TYPES:()=>n.QE,TYPES_TO_BYTES_PER_COMPONENT:()=>_t,TYPES_TO_BYTES_PER_PIXEL:()=>Tt,TemporaryDisplayObject:()=>a,Text:()=>Lr,TextFormat:()=>cn,TextMetrics:()=>Ir,TextStyle:()=>Cr,Texture:()=>n.gP,TextureGCSystem:()=>n.lB,TextureMatrix:()=>n.NW,TextureSystem:()=>n.vB,TextureUvs:()=>n.OE,Ticker:()=>n.Rv,TickerPlugin:()=>n.y,TilingSprite:()=>en,TilingSpriteRenderer:()=>nn,TimeLimiter:()=>Zr,Transform:()=>n.dL,TransformFeedback:()=>n.wF,TransformFeedbackSystem:()=>n.vT,UPDATE_PRIORITY:()=>n.dQ,UniformGroup:()=>n.k2,VERSION:()=>n.xv,VideoResource:()=>n.A5,ViewSystem:()=>n.vr,ViewableBuffer:()=>n.u3,WRAP_MODES:()=>n.uR,XMLFormat:()=>fn,XMLStringFormat:()=>dn,accessibleTarget:()=>F,autoDetectFormat:()=>yn,autoDetectRenderer:()=>n.q5,autoDetectResource:()=>n.Nc,cacheTextureArray:()=>Pe,checkDataUrl:()=>J,checkExtension:()=>H,checkMaxIfStatementsInShader:()=>n.uC,convertToList:()=>q,copySearchParams:()=>je,createStringVariations:()=>Ee,createTexture:()=>ye,createUBOElements:()=>n._J,curves:()=>jt,defaultFilterVertex:()=>n.Eo,defaultVertex:()=>n.MT,detectAvif:()=>Ce,detectCompressedTextures:()=>qe,detectDefaults:()=>De,detectMp4:()=>Ne,detectOgv:()=>Fe,detectWebm:()=>Be,detectWebp:()=>$e,extensions:()=>n.XO,filters:()=>E,generateProgram:()=>n.CF,generateUniformBufferSync:()=>n.He,getFontFamilyName:()=>oe,getTestContext:()=>n.WD,getUBOData:()=>n.RO,graphicsUtils:()=>ur,groupD8:()=>n.ER,isMobile:()=>n.Fr,isSingleItem:()=>X,loadBitmapFont:()=>An,loadDDS:()=>At,loadImageBitmap:()=>we,loadJson:()=>Q,loadKTX:()=>It,loadSVG:()=>be,loadTextures:()=>ve,loadTxt:()=>ee,loadVideo:()=>Se,loadWebFont:()=>se,parseDDS:()=>gt,parseKTX:()=>Et,resolveCompressedTextureUrl:()=>kt,resolveTextureUrl:()=>Ue,settings:()=>n.W0,spritesheetAsset:()=>ln,uniformParsers:()=>n.$Z,unsafeEvalSupported:()=>n.ff,utils:()=>n.Wp});var n=r(9203);class i{constructor(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.rect=null,this.updateID=-1}isEmpty(){return this.minX>this.maxX||this.minY>this.maxY}clear(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0}getRectangle(e){return this.minX>this.maxX||this.minY>this.maxY?n.M_.EMPTY:((e=e||new n.M_(0,0,1,1)).x=this.minX,e.y=this.minY,e.width=this.maxX-this.minX,e.height=this.maxY-this.minY,e)}addPoint(e){this.minX=Math.min(this.minX,e.x),this.maxX=Math.max(this.maxX,e.x),this.minY=Math.min(this.minY,e.y),this.maxY=Math.max(this.maxY,e.y)}addPointMatrix(e,t){const{a:r,b:n,c:i,d:o,tx:a,ty:s}=e,u=r*t.x+i*t.y+a,l=n*t.x+o*t.y+s;this.minX=Math.min(this.minX,u),this.maxX=Math.max(this.maxX,u),this.minY=Math.min(this.minY,l),this.maxY=Math.max(this.maxY,l)}addQuad(e){let t=this.minX,r=this.minY,n=this.maxX,i=this.maxY,o=e[0],a=e[1];t=o<t?o:t,r=a<r?a:r,n=o>n?o:n,i=a>i?a:i,o=e[2],a=e[3],t=o<t?o:t,r=a<r?a:r,n=o>n?o:n,i=a>i?a:i,o=e[4],a=e[5],t=o<t?o:t,r=a<r?a:r,n=o>n?o:n,i=a>i?a:i,o=e[6],a=e[7],t=o<t?o:t,r=a<r?a:r,n=o>n?o:n,i=a>i?a:i,this.minX=t,this.minY=r,this.maxX=n,this.maxY=i}addFrame(e,t,r,n,i){this.addFrameMatrix(e.worldTransform,t,r,n,i)}addFrameMatrix(e,t,r,n,i){const o=e.a,a=e.b,s=e.c,u=e.d,l=e.tx,h=e.ty;let c=this.minX,f=this.minY,d=this.maxX,p=this.maxY,y=o*t+s*r+l,m=a*t+u*r+h;c=y<c?y:c,f=m<f?m:f,d=y>d?y:d,p=m>p?m:p,y=o*n+s*r+l,m=a*n+u*r+h,c=y<c?y:c,f=m<f?m:f,d=y>d?y:d,p=m>p?m:p,y=o*t+s*i+l,m=a*t+u*i+h,c=y<c?y:c,f=m<f?m:f,d=y>d?y:d,p=m>p?m:p,y=o*n+s*i+l,m=a*n+u*i+h,c=y<c?y:c,f=m<f?m:f,d=y>d?y:d,p=m>p?m:p,this.minX=c,this.minY=f,this.maxX=d,this.maxY=p}addVertexData(e,t,r){let n=this.minX,i=this.minY,o=this.maxX,a=this.maxY;for(let s=t;s<r;s+=2){const t=e[s],r=e[s+1];n=t<n?t:n,i=r<i?r:i,o=t>o?t:o,a=r>a?r:a}this.minX=n,this.minY=i,this.maxX=o,this.maxY=a}addVertices(e,t,r,n){this.addVerticesMatrix(e.worldTransform,t,r,n)}addVerticesMatrix(e,t,r,n,i=0,o=i){const a=e.a,s=e.b,u=e.c,l=e.d,h=e.tx,c=e.ty;let f=this.minX,d=this.minY,p=this.maxX,y=this.maxY;for(let e=r;e<n;e+=2){const r=t[e],n=t[e+1],m=a*r+u*n+h,g=l*n+s*r+c;f=Math.min(f,m-i),p=Math.max(p,m+i),d=Math.min(d,g-o),y=Math.max(y,g+o)}this.minX=f,this.minY=d,this.maxX=p,this.maxY=y}addBounds(e){const t=this.minX,r=this.minY,n=this.maxX,i=this.maxY;this.minX=e.minX<t?e.minX:t,this.minY=e.minY<r?e.minY:r,this.maxX=e.maxX>n?e.maxX:n,this.maxY=e.maxY>i?e.maxY:i}addBoundsMask(e,t){const r=e.minX>t.minX?e.minX:t.minX,n=e.minY>t.minY?e.minY:t.minY,i=e.maxX<t.maxX?e.maxX:t.maxX,o=e.maxY<t.maxY?e.maxY:t.maxY;if(r<=i&&n<=o){const e=this.minX,t=this.minY,a=this.maxX,s=this.maxY;this.minX=r<e?r:e,this.minY=n<t?n:t,this.maxX=i>a?i:a,this.maxY=o>s?o:s}}addBoundsMatrix(e,t){this.addFrameMatrix(t,e.minX,e.minY,e.maxX,e.maxY)}addBoundsArea(e,t){const r=e.minX>t.x?e.minX:t.x,n=e.minY>t.y?e.minY:t.y,i=e.maxX<t.x+t.width?e.maxX:t.x+t.width,o=e.maxY<t.y+t.height?e.maxY:t.y+t.height;if(r<=i&&n<=o){const e=this.minX,t=this.minY,a=this.maxX,s=this.maxY;this.minX=r<e?r:e,this.minY=n<t?n:t,this.maxX=i>a?i:a,this.maxY=o>s?o:s}}pad(e=0,t=e){this.isEmpty()||(this.minX-=e,this.maxX+=e,this.minY-=t,this.maxY+=t)}addFramePad(e,t,r,n,i,o){e-=i,t-=o,r+=i,n+=o,this.minX=this.minX<e?this.minX:e,this.maxX=this.maxX>r?this.maxX:r,this.minY=this.minY<t?this.minY:t,this.maxY=this.maxY>n?this.maxY:n}}class o extends n.Wp.EventEmitter{constructor(){super(),this.tempDisplayObjectParent=null,this.transform=new n.dL,this.alpha=1,this.visible=!0,this.renderable=!0,this.cullable=!1,this.cullArea=null,this.parent=null,this.worldAlpha=1,this._lastSortedIndex=0,this._zIndex=0,this.filterArea=null,this.filters=null,this._enabledFilters=null,this._bounds=new i,this._localBounds=null,this._boundsID=0,this._boundsRect=null,this._localBoundsRect=null,this._mask=null,this._maskRefCount=0,this._destroyed=!1,this.isSprite=!1,this.isMask=!1}static mixin(e){const t=Object.keys(e);for(let r=0;r<t.length;++r){const n=t[r];Object.defineProperty(o.prototype,n,Object.getOwnPropertyDescriptor(e,n))}}get destroyed(){return this._destroyed}_recursivePostUpdateTransform(){this.parent?(this.parent._recursivePostUpdateTransform(),this.transform.updateTransform(this.parent.transform)):this.transform.updateTransform(this._tempDisplayObjectParent.transform)}updateTransform(){this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha}getBounds(e,t){return e||(this.parent?(this._recursivePostUpdateTransform(),this.updateTransform()):(this.parent=this._tempDisplayObjectParent,this.updateTransform(),this.parent=null)),this._bounds.updateID!==this._boundsID&&(this.calculateBounds(),this._bounds.updateID=this._boundsID),t||(this._boundsRect||(this._boundsRect=new n.M_),t=this._boundsRect),this._bounds.getRectangle(t)}getLocalBounds(e){e||(this._localBoundsRect||(this._localBoundsRect=new n.M_),e=this._localBoundsRect),this._localBounds||(this._localBounds=new i);const t=this.transform,r=this.parent;this.parent=null,this._tempDisplayObjectParent.worldAlpha=r?.worldAlpha??1,this.transform=this._tempDisplayObjectParent.transform;const o=this._bounds,a=this._boundsID;this._bounds=this._localBounds;const s=this.getBounds(!1,e);return this.parent=r,this.transform=t,this._bounds=o,this._bounds.updateID+=this._boundsID-a,s}toGlobal(e,t,r=!1){return r||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.apply(e,t)}toLocal(e,t,r,n){return t&&(e=t.toGlobal(e,r,n)),n||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.applyInverse(e,r)}setParent(e){if(!e||!e.addChild)throw new Error("setParent: Argument must be a Container");return e.addChild(this),e}removeFromParent(){this.parent?.removeChild(this)}setTransform(e=0,t=0,r=1,n=1,i=0,o=0,a=0,s=0,u=0){return this.position.x=e,this.position.y=t,this.scale.x=r||1,this.scale.y=n||1,this.rotation=i,this.skew.x=o,this.skew.y=a,this.pivot.x=s,this.pivot.y=u,this}destroy(e){this.removeFromParent(),this._destroyed=!0,this.transform=null,this.parent=null,this._bounds=null,this.mask=null,this.cullArea=null,this.filters=null,this.filterArea=null,this.hitArea=null,this.eventMode="auto",this.interactiveChildren=!1,this.emit("destroyed"),this.removeAllListeners()}get _tempDisplayObjectParent(){return null===this.tempDisplayObjectParent&&(this.tempDisplayObjectParent=new a),this.tempDisplayObjectParent}enableTempParent(){const e=this.parent;return this.parent=this._tempDisplayObjectParent,e}disableTempParent(e){this.parent=e}get x(){return this.position.x}set x(e){this.transform.position.x=e}get y(){return this.position.y}set y(e){this.transform.position.y=e}get worldTransform(){return this.transform.worldTransform}get localTransform(){return this.transform.localTransform}get position(){return this.transform.position}set position(e){this.transform.position.copyFrom(e)}get scale(){return this.transform.scale}set scale(e){this.transform.scale.copyFrom(e)}get pivot(){return this.transform.pivot}set pivot(e){this.transform.pivot.copyFrom(e)}get skew(){return this.transform.skew}set skew(e){this.transform.skew.copyFrom(e)}get rotation(){return this.transform.rotation}set rotation(e){this.transform.rotation=e}get angle(){return this.transform.rotation*n.bO}set angle(e){this.transform.rotation=e*n.Td}get zIndex(){return this._zIndex}set zIndex(e){this._zIndex!==e&&(this._zIndex=e,this.parent&&(this.parent.sortDirty=!0))}get worldVisible(){let e=this;do{if(!e.visible)return!1;e=e.parent}while(e);return!0}get mask(){return this._mask}set mask(e){if(this._mask!==e){if(this._mask){const e=this._mask.isMaskData?this._mask.maskObject:this._mask;e&&(e._maskRefCount--,0===e._maskRefCount&&(e.renderable=!0,e.isMask=!1))}if(this._mask=e,this._mask){const e=this._mask.isMaskData?this._mask.maskObject:this._mask;e&&(0===e._maskRefCount&&(e.renderable=!1,e.isMask=!0),e._maskRefCount++)}}}}class a extends o{constructor(){super(...arguments),this.sortDirty=null}}o.prototype.displayObjectUpdateTransform=o.prototype.updateTransform;const s=new n.uq;function u(e,t){return e.zIndex===t.zIndex?e._lastSortedIndex-t._lastSortedIndex:e.zIndex-t.zIndex}const l=class e extends o{constructor(){super(),this.children=[],this.sortableChildren=e.defaultSortableChildren,this.sortDirty=!1}onChildrenChange(e){}addChild(...e){if(e.length>1)for(let t=0;t<e.length;t++)this.addChild(e[t]);else{const t=e[0];t.parent&&t.parent.removeChild(t),t.parent=this,this.sortDirty=!0,t.transform._parentID=-1,this.children.push(t),this._boundsID++,this.onChildrenChange(this.children.length-1),this.emit("childAdded",t,this,this.children.length-1),t.emit("added",this)}return e[0]}addChildAt(e,t){if(t<0||t>this.children.length)throw new Error(`${e}addChildAt: The index ${t} supplied is out of bounds ${this.children.length}`);return e.parent&&e.parent.removeChild(e),e.parent=this,this.sortDirty=!0,e.transform._parentID=-1,this.children.splice(t,0,e),this._boundsID++,this.onChildrenChange(t),e.emit("added",this),this.emit("childAdded",e,this,t),e}swapChildren(e,t){if(e===t)return;const r=this.getChildIndex(e),n=this.getChildIndex(t);this.children[r]=t,this.children[n]=e,this.onChildrenChange(r<n?r:n)}getChildIndex(e){const t=this.children.indexOf(e);if(-1===t)throw new Error("The supplied DisplayObject must be a child of the caller");return t}setChildIndex(e,t){if(t<0||t>=this.children.length)throw new Error(`The index ${t} supplied is out of bounds ${this.children.length}`);const r=this.getChildIndex(e);n.Wp.removeItems(this.children,r,1),this.children.splice(t,0,e),this.onChildrenChange(t)}getChildAt(e){if(e<0||e>=this.children.length)throw new Error(`getChildAt: Index (${e}) does not exist.`);return this.children[e]}removeChild(...e){if(e.length>1)for(let t=0;t<e.length;t++)this.removeChild(e[t]);else{const t=e[0],r=this.children.indexOf(t);if(-1===r)return null;t.parent=null,t.transform._parentID=-1,n.Wp.removeItems(this.children,r,1),this._boundsID++,this.onChildrenChange(r),t.emit("removed",this),this.emit("childRemoved",t,this,r)}return e[0]}removeChildAt(e){const t=this.getChildAt(e);return t.parent=null,t.transform._parentID=-1,n.Wp.removeItems(this.children,e,1),this._boundsID++,this.onChildrenChange(e),t.emit("removed",this),this.emit("childRemoved",t,this,e),t}removeChildren(e=0,t=this.children.length){const r=e,n=t-r;let i;if(n>0&&n<=t){i=this.children.splice(r,n);for(let e=0;e<i.length;++e)i[e].parent=null,i[e].transform&&(i[e].transform._parentID=-1);this._boundsID++,this.onChildrenChange(e);for(let e=0;e<i.length;++e)i[e].emit("removed",this),this.emit("childRemoved",i[e],this,e);return i}if(0===n&&0===this.children.length)return[];throw new RangeError("removeChildren: numeric values are outside the acceptable range.")}sortChildren(){let e=!1;for(let t=0,r=this.children.length;t<r;++t){const r=this.children[t];r._lastSortedIndex=t,!e&&0!==r.zIndex&&(e=!0)}e&&this.children.length>1&&this.children.sort(u),this.sortDirty=!1}updateTransform(){this.sortableChildren&&this.sortDirty&&this.sortChildren(),this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha;for(let e=0,t=this.children.length;e<t;++e){const t=this.children[e];t.visible&&t.updateTransform()}}calculateBounds(){this._bounds.clear(),this._calculateBounds();for(let e=0;e<this.children.length;e++){const t=this.children[e];if(t.visible&&t.renderable)if(t.calculateBounds(),t._mask){const e=t._mask.isMaskData?t._mask.maskObject:t._mask;e?(e.calculateBounds(),this._bounds.addBoundsMask(t._bounds,e._bounds)):this._bounds.addBounds(t._bounds)}else t.filterArea?this._bounds.addBoundsArea(t._bounds,t.filterArea):this._bounds.addBounds(t._bounds)}this._bounds.updateID=this._boundsID}getLocalBounds(e,t=!1){const r=super.getLocalBounds(e);if(!t)for(let e=0,t=this.children.length;e<t;++e){const t=this.children[e];t.visible&&t.updateTransform()}return r}_calculateBounds(){}_renderWithCulling(t){const r=t.renderTexture.sourceFrame;if(!(r.width>0&&r.height>0))return;let n,i;this.cullArea?(n=this.cullArea,i=this.worldTransform):this._render!==e.prototype._render&&(n=this.getBounds(!0));const o=t.projection.transform;if(o&&(i?(i=s.copyFrom(i),i.prepend(o)):i=o),n&&r.intersects(n,i))this._render(t);else if(this.cullArea)return;for(let e=0,r=this.children.length;e<r;++e){const r=this.children[e],n=r.cullable;r.cullable=n||!this.cullArea,r.render(t),r.cullable=n}}render(e){if(this.visible&&!(this.worldAlpha<=0)&&this.renderable)if(this._mask||this.filters?.length)this.renderAdvanced(e);else if(this.cullable)this._renderWithCulling(e);else{this._render(e);for(let t=0,r=this.children.length;t<r;++t)this.children[t].render(e)}}renderAdvanced(e){const t=this.filters,r=this._mask;if(t){this._enabledFilters||(this._enabledFilters=[]),this._enabledFilters.length=0;for(let e=0;e<t.length;e++)t[e].enabled&&this._enabledFilters.push(t[e])}const i=t&&this._enabledFilters?.length||r&&(!r.isMaskData||r.enabled&&(r.autoDetect||r.type!==n.vg.NONE));if(i&&e.batch.flush(),t&&this._enabledFilters?.length&&e.filter.push(this,this._enabledFilters),r&&e.mask.push(this,this._mask),this.cullable)this._renderWithCulling(e);else{this._render(e);for(let t=0,r=this.children.length;t<r;++t)this.children[t].render(e)}i&&e.batch.flush(),r&&e.mask.pop(this),t&&this._enabledFilters?.length&&e.filter.pop()}_render(e){}destroy(e){super.destroy(),this.sortDirty=!1;const t="boolean"==typeof e?e:e?.children,r=this.removeChildren(0,this.children.length);if(t)for(let t=0;t<r.length;++t)r[t].destroy(e)}get width(){return this.scale.x*this.getLocalBounds().width}set width(e){const t=this.getLocalBounds().width;this.scale.x=0!==t?e/t:1,this._width=e}get height(){return this.scale.y*this.getLocalBounds().height}set height(e){const t=this.getLocalBounds().height;this.scale.y=0!==t?e/t:1,this._height=e}};l.defaultSortableChildren=!1;let h=l;h.prototype.containerUpdateTransform=h.prototype.updateTransform,Object.defineProperties(n.W0,{SORTABLE_CHILDREN:{get:()=>h.defaultSortableChildren,set(e){n.Wp.deprecation("7.1.0","settings.SORTABLE_CHILDREN is deprecated, use Container.defaultSortableChildren"),h.defaultSortableChildren=e}}});const c=new n.bR,f=new Uint16Array([0,1,2,0,2,3]);class d extends h{constructor(e){super(),this._anchor=new n.oA(this._onAnchorUpdate,this,e?e.defaultAnchor.x:0,e?e.defaultAnchor.y:0),this._texture=null,this._width=0,this._height=0,this._tintColor=new n.Q1(16777215),this._tintRGB=null,this.tint=16777215,this.blendMode=n.B9.NORMAL,this._cachedTint=16777215,this.uvs=null,this.texture=e||n.gP.EMPTY,this.vertexData=new Float32Array(8),this.vertexTrimmedData=null,this._transformID=-1,this._textureID=-1,this._transformTrimmedID=-1,this._textureTrimmedID=-1,this.indices=f,this.pluginName="batch",this.isSprite=!0,this._roundPixels=n.W0.ROUND_PIXELS}_onTextureUpdate(){this._textureID=-1,this._textureTrimmedID=-1,this._cachedTint=16777215,this._width&&(this.scale.x=n.Wp.sign(this.scale.x)*this._width/this._texture.orig.width),this._height&&(this.scale.y=n.Wp.sign(this.scale.y)*this._height/this._texture.orig.height)}_onAnchorUpdate(){this._transformID=-1,this._transformTrimmedID=-1}calculateVertices(){const e=this._texture;if(this._transformID===this.transform._worldID&&this._textureID===e._updateID)return;this._textureID!==e._updateID&&(this.uvs=this._texture._uvs.uvsFloat32),this._transformID=this.transform._worldID,this._textureID=e._updateID;const t=this.transform.worldTransform,r=t.a,i=t.b,o=t.c,a=t.d,s=t.tx,u=t.ty,l=this.vertexData,h=e.trim,c=e.orig,f=this._anchor;let d=0,p=0,y=0,m=0;if(h?(p=h.x-f._x*c.width,d=p+h.width,m=h.y-f._y*c.height,y=m+h.height):(p=-f._x*c.width,d=p+c.width,m=-f._y*c.height,y=m+c.height),l[0]=r*p+o*m+s,l[1]=a*m+i*p+u,l[2]=r*d+o*m+s,l[3]=a*m+i*d+u,l[4]=r*d+o*y+s,l[5]=a*y+i*d+u,l[6]=r*p+o*y+s,l[7]=a*y+i*p+u,this._roundPixels){const e=n.W0.RESOLUTION;for(let t=0;t<l.length;++t)l[t]=Math.round(l[t]*e)/e}}calculateTrimmedVertices(){if(this.vertexTrimmedData){if(this._transformTrimmedID===this.transform._worldID&&this._textureTrimmedID===this._texture._updateID)return}else this.vertexTrimmedData=new Float32Array(8);this._transformTrimmedID=this.transform._worldID,this._textureTrimmedID=this._texture._updateID;const e=this._texture,t=this.vertexTrimmedData,r=e.orig,i=this._anchor,o=this.transform.worldTransform,a=o.a,s=o.b,u=o.c,l=o.d,h=o.tx,c=o.ty,f=-i._x*r.width,d=f+r.width,p=-i._y*r.height,y=p+r.height;if(t[0]=a*f+u*p+h,t[1]=l*p+s*f+c,t[2]=a*d+u*p+h,t[3]=l*p+s*d+c,t[4]=a*d+u*y+h,t[5]=l*y+s*d+c,t[6]=a*f+u*y+h,t[7]=l*y+s*f+c,this._roundPixels){const e=n.W0.RESOLUTION;for(let r=0;r<t.length;++r)t[r]=Math.round(t[r]*e)/e}}_render(e){this.calculateVertices(),e.batch.setObjectRenderer(e.plugins[this.pluginName]),e.plugins[this.pluginName].render(this)}_calculateBounds(){const e=this._texture.trim,t=this._texture.orig;!e||e.width===t.width&&e.height===t.height?(this.calculateVertices(),this._bounds.addQuad(this.vertexData)):(this.calculateTrimmedVertices(),this._bounds.addQuad(this.vertexTrimmedData))}getLocalBounds(e){return 0===this.children.length?(this._localBounds||(this._localBounds=new i),this._localBounds.minX=this._texture.orig.width*-this._anchor._x,this._localBounds.minY=this._texture.orig.height*-this._anchor._y,this._localBounds.maxX=this._texture.orig.width*(1-this._anchor._x),this._localBounds.maxY=this._texture.orig.height*(1-this._anchor._y),e||(this._localBoundsRect||(this._localBoundsRect=new n.M_),e=this._localBoundsRect),this._localBounds.getRectangle(e)):super.getLocalBounds.call(this,e)}containsPoint(e){this.worldTransform.applyInverse(e,c);const t=this._texture.orig.width,r=this._texture.orig.height,n=-t*this.anchor.x;let i=0;return c.x>=n&&c.x<n+t&&(i=-r*this.anchor.y,c.y>=i&&c.y<i+r)}destroy(e){if(super.destroy(e),this._texture.off("update",this._onTextureUpdate,this),this._anchor=null,"boolean"==typeof e?e:e?.texture){const t="boolean"==typeof e?e:e?.baseTexture;this._texture.destroy(!!t)}this._texture=null}static from(e,t){const r=e instanceof n.gP?e:n.gP.from(e,t);return new d(r)}set roundPixels(e){this._roundPixels!==e&&(this._transformID=-1,this._transformTrimmedID=-1),this._roundPixels=e}get roundPixels(){return this._roundPixels}get width(){return Math.abs(this.scale.x)*this._texture.orig.width}set width(e){const t=n.Wp.sign(this.scale.x)||1;this.scale.x=t*e/this._texture.orig.width,this._width=e}get height(){return Math.abs(this.scale.y)*this._texture.orig.height}set height(e){const t=n.Wp.sign(this.scale.y)||1;this.scale.y=t*e/this._texture.orig.height,this._height=e}get anchor(){return this._anchor}set anchor(e){this._anchor.copyFrom(e)}get tint(){return this._tintColor.value}set tint(e){this._tintColor.setValue(e),this._tintRGB=this._tintColor.toLittleEndianNumber()}get tintValue(){return this._tintColor.toNumber()}get texture(){return this._texture}set texture(e){this._texture!==e&&(this._texture&&this._texture.off("update",this._onTextureUpdate,this),this._texture=e||n.gP.EMPTY,this._cachedTint=16777215,this._textureID=-1,this._textureTrimmedID=-1,e&&(e.baseTexture.valid?this._onTextureUpdate():e.once("update",this._onTextureUpdate,this)))}}const p=new n.uq;o.prototype._cacheAsBitmap=!1,o.prototype._cacheData=null,o.prototype._cacheAsBitmapResolution=null,o.prototype._cacheAsBitmapMultisample=null;class y{constructor(){this.textureCacheId=null,this.originalRender=null,this.originalRenderCanvas=null,this.originalCalculateBounds=null,this.originalGetLocalBounds=null,this.originalUpdateTransform=null,this.originalDestroy=null,this.originalMask=null,this.originalFilterArea=null,this.originalContainsPoint=null,this.sprite=null}}Object.defineProperties(o.prototype,{cacheAsBitmapResolution:{get(){return this._cacheAsBitmapResolution},set(e){e!==this._cacheAsBitmapResolution&&(this._cacheAsBitmapResolution=e,this.cacheAsBitmap&&(this.cacheAsBitmap=!1,this.cacheAsBitmap=!0))}},cacheAsBitmapMultisample:{get(){return this._cacheAsBitmapMultisample},set(e){e!==this._cacheAsBitmapMultisample&&(this._cacheAsBitmapMultisample=e,this.cacheAsBitmap&&(this.cacheAsBitmap=!1,this.cacheAsBitmap=!0))}},cacheAsBitmap:{get(){return this._cacheAsBitmap},set(e){if(this._cacheAsBitmap===e)return;let t;this._cacheAsBitmap=e,e?(this._cacheData||(this._cacheData=new y),t=this._cacheData,t.originalRender=this.render,t.originalRenderCanvas=this.renderCanvas,t.originalUpdateTransform=this.updateTransform,t.originalCalculateBounds=this.calculateBounds,t.originalGetLocalBounds=this.getLocalBounds,t.originalDestroy=this.destroy,t.originalContainsPoint=this.containsPoint,t.originalMask=this._mask,t.originalFilterArea=this.filterArea,this.render=this._renderCached,this.renderCanvas=this._renderCachedCanvas,this.destroy=this._cacheAsBitmapDestroy):(t=this._cacheData,t.sprite&&this._destroyCachedDisplayObject(),this.render=t.originalRender,this.renderCanvas=t.originalRenderCanvas,this.calculateBounds=t.originalCalculateBounds,this.getLocalBounds=t.originalGetLocalBounds,this.destroy=t.originalDestroy,this.updateTransform=t.originalUpdateTransform,this.containsPoint=t.originalContainsPoint,this._mask=t.originalMask,this.filterArea=t.originalFilterArea)}}}),o.prototype._renderCached=function(e){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObject(e),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._render(e))},o.prototype._initCachedDisplayObject=function(e){if(this._cacheData?.sprite)return;const t=this.alpha;this.alpha=1,e.batch.flush();const r=this.getLocalBounds(new n.M_,!0);if(this.filters?.length){const e=this.filters[0].padding;r.pad(e)}const i=this.cacheAsBitmapResolution||e.resolution;r.ceil(i),r.width=Math.max(r.width,1/i),r.height=Math.max(r.height,1/i);const o=e.renderTexture.current,a=e.renderTexture.sourceFrame.clone(),s=e.renderTexture.destinationFrame.clone(),u=e.projection.transform,l=n.Y7.create({width:r.width,height:r.height,resolution:i,multisample:this.cacheAsBitmapMultisample??e.multisample}),h=`cacheAsBitmap_${n.Wp.uid()}`;this._cacheData.textureCacheId=h,n.t5.addToCache(l.baseTexture,h),n.gP.addToCache(l,h);const c=this.transform.localTransform.copyTo(p).invert().translate(-r.x,-r.y);this.render=this._cacheData.originalRender,e.render(this,{renderTexture:l,clear:!0,transform:c,skipUpdateTransform:!1}),e.framebuffer.blit(),e.projection.transform=u,e.renderTexture.bind(o,a,s),this.render=this._renderCached,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null,this.alpha=t;const f=new d(l);f.transform.worldTransform=this.transform.worldTransform,f.anchor.x=-r.x/r.width,f.anchor.y=-r.y/r.height,f.alpha=t,f._bounds=this._bounds,this._cacheData.sprite=f,this.transform._parentID=-1,this.parent?this.updateTransform():(this.enableTempParent(),this.updateTransform(),this.disableTempParent(null)),this.containsPoint=f.containsPoint.bind(f)},o.prototype._renderCachedCanvas=function(e){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObjectCanvas(e),this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._renderCanvas(e))},o.prototype._initCachedDisplayObjectCanvas=function(e){if(this._cacheData?.sprite)return;const t=this.getLocalBounds(new n.M_,!0),r=this.alpha;this.alpha=1;const i=e.canvasContext.activeContext,o=e._projTransform,a=this.cacheAsBitmapResolution||e.resolution;t.ceil(a),t.width=Math.max(t.width,1/a),t.height=Math.max(t.height,1/a);const s=n.Y7.create({width:t.width,height:t.height,resolution:a}),u=`cacheAsBitmap_${n.Wp.uid()}`;this._cacheData.textureCacheId=u,n.t5.addToCache(s.baseTexture,u),n.gP.addToCache(s,u);const l=p;this.transform.localTransform.copyTo(l),l.invert(),l.tx-=t.x,l.ty-=t.y,this.renderCanvas=this._cacheData.originalRenderCanvas,e.render(this,{renderTexture:s,clear:!0,transform:l,skipUpdateTransform:!1}),e.canvasContext.activeContext=i,e._projTransform=o,this.renderCanvas=this._renderCachedCanvas,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null,this.alpha=r;const h=new d(s);h.transform.worldTransform=this.transform.worldTransform,h.anchor.x=-t.x/t.width,h.anchor.y=-t.y/t.height,h.alpha=r,h._bounds=this._bounds,this._cacheData.sprite=h,this.transform._parentID=-1,this.parent?this.updateTransform():(this.parent=e._tempDisplayObjectParent,this.updateTransform(),this.parent=null),this.containsPoint=h.containsPoint.bind(h)},o.prototype._calculateCachedBounds=function(){this._bounds.clear(),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite._calculateBounds(),this._bounds.updateID=this._boundsID},o.prototype._getCachedLocalBounds=function(){return this._cacheData.sprite.getLocalBounds(null)},o.prototype._destroyCachedDisplayObject=function(){this._cacheData.sprite._texture.destroy(!0),this._cacheData.sprite=null,n.t5.removeFromCache(this._cacheData.textureCacheId),n.gP.removeFromCache(this._cacheData.textureCacheId),this._cacheData.textureCacheId=null},o.prototype._cacheAsBitmapDestroy=function(e){this.cacheAsBitmap=!1,this.destroy(e)},o.prototype.name=null,h.prototype.getChildByName=function(e,t){for(let t=0,r=this.children.length;t<r;t++)if(this.children[t].name===e)return this.children[t];if(t)for(let t=0,r=this.children.length;t<r;t++){const r=this.children[t];if(!r.getChildByName)continue;const n=r.getChildByName(e,!0);if(n)return n}return null},o.prototype.getGlobalPosition=function(e=new n.bR,t=!1){return this.parent?this.parent.toGlobal(this.position,e,t):(e.x=this.position.x,e.y=this.position.y),e};class m extends n.dJ{constructor(e=1){super(n.MT,"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform float uAlpha;\n\nvoid main(void)\n{\n   gl_FragColor = texture2D(uSampler, vTextureCoord) * uAlpha;\n}\n",{uAlpha:1}),this.alpha=e}get alpha(){return this.uniforms.uAlpha}set alpha(e){this.uniforms.uAlpha=e}}const g={5:[.153388,.221461,.250301],7:[.071303,.131514,.189879,.214607],9:[.028532,.067234,.124009,.179044,.20236],11:[.0093,.028002,.065984,.121703,.175713,.198596],13:[.002406,.009255,.027867,.065666,.121117,.174868,.197641],15:[489e-6,.002403,.009246,.02784,.065602,.120999,.174697,.197448]},w=["varying vec2 vBlurTexCoords[%size%];","uniform sampler2D uSampler;","void main(void)","{","    gl_FragColor = vec4(0.0);","    %blur%","}"].join("\n");class v extends n.dJ{constructor(e,t=8,r=4,i=n.dJ.defaultResolution,o=5){const a=function(e,t){const r=Math.ceil(e/2);let n,i="\n    attribute vec2 aVertexPosition;\n\n    uniform mat3 projectionMatrix;\n\n    uniform float strength;\n\n    varying vec2 vBlurTexCoords[%size%];\n\n    uniform vec4 inputSize;\n    uniform vec4 outputFrame;\n\n    vec4 filterVertexPosition( void )\n    {\n        vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n        return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n    }\n\n    vec2 filterTextureCoord( void )\n    {\n        return aVertexPosition * (outputFrame.zw * inputSize.zw);\n    }\n\n    void main(void)\n    {\n        gl_Position = filterVertexPosition();\n\n        vec2 textureCoord = filterTextureCoord();\n        %blur%\n    }",o="";n=t?"vBlurTexCoords[%index%] =  textureCoord + vec2(%sampleIndex% * strength, 0.0);":"vBlurTexCoords[%index%] =  textureCoord + vec2(0.0, %sampleIndex% * strength);";for(let t=0;t<e;t++){let e=n.replace("%index%",t.toString());e=e.replace("%sampleIndex%",t-(r-1)+".0"),o+=e,o+="\n"}return i=i.replace("%blur%",o),i=i.replace("%size%",e.toString()),i}(o,e),s=function(e){const t=g[e],r=t.length;let n,i=w,o="";for(let i=0;i<e;i++){let a="gl_FragColor += texture2D(uSampler, vBlurTexCoords[%index%]) * %value%;".replace("%index%",i.toString());n=i,i>=r&&(n=e-i-1),a=a.replace("%value%",t[n].toString()),o+=a,o+="\n"}return i=i.replace("%blur%",o),i=i.replace("%size%",e.toString()),i}(o);super(a,s),this.horizontal=e,this.resolution=i,this._quality=0,this.quality=r,this.blur=t}apply(e,t,r,i){if(r?this.horizontal?this.uniforms.strength=1/r.width*(r.width/t.width):this.uniforms.strength=1/r.height*(r.height/t.height):this.horizontal?this.uniforms.strength=1/e.renderer.width*(e.renderer.width/t.width):this.uniforms.strength=1/e.renderer.height*(e.renderer.height/t.height),this.uniforms.strength*=this.strength,this.uniforms.strength/=this.passes,1===this.passes)e.applyFilter(this,t,r,i);else{const o=e.getFilterTexture(),a=e.renderer;let s=t,u=o;this.state.blend=!1,e.applyFilter(this,s,u,n.fr.CLEAR);for(let t=1;t<this.passes-1;t++){e.bindAndClear(s,n.fr.BLIT),this.uniforms.uSampler=u;const t=u;u=s,s=t,a.shader.bind(this),a.geometry.draw(5)}this.state.blend=!0,e.applyFilter(this,u,r,i),e.returnFilterTexture(o)}}get blur(){return this.strength}set blur(e){this.padding=1+2*Math.abs(e),this.strength=e}get quality(){return this._quality}set quality(e){this._quality=e,this.passes=e}}class b extends n.dJ{constructor(e=8,t=4,r=n.dJ.defaultResolution,i=5){super(),this._repeatEdgePixels=!1,this.blurXFilter=new v(!0,e,t,r,i),this.blurYFilter=new v(!1,e,t,r,i),this.resolution=r,this.quality=t,this.blur=e,this.repeatEdgePixels=!1}apply(e,t,r,i){const o=Math.abs(this.blurXFilter.strength),a=Math.abs(this.blurYFilter.strength);if(o&&a){const o=e.getFilterTexture();this.blurXFilter.apply(e,t,o,n.fr.CLEAR),this.blurYFilter.apply(e,o,r,i),e.returnFilterTexture(o)}else a?this.blurYFilter.apply(e,t,r,i):this.blurXFilter.apply(e,t,r,i)}updatePadding(){this._repeatEdgePixels?this.padding=0:this.padding=2*Math.max(Math.abs(this.blurXFilter.strength),Math.abs(this.blurYFilter.strength))}get blur(){return this.blurXFilter.blur}set blur(e){this.blurXFilter.blur=this.blurYFilter.blur=e,this.updatePadding()}get quality(){return this.blurXFilter.quality}set quality(e){this.blurXFilter.quality=this.blurYFilter.quality=e}get blurX(){return this.blurXFilter.blur}set blurX(e){this.blurXFilter.blur=e,this.updatePadding()}get blurY(){return this.blurYFilter.blur}set blurY(e){this.blurYFilter.blur=e,this.updatePadding()}get blendMode(){return this.blurYFilter.blendMode}set blendMode(e){this.blurYFilter.blendMode=e}get repeatEdgePixels(){return this._repeatEdgePixels}set repeatEdgePixels(e){this._repeatEdgePixels=e,this.updatePadding()}}class x extends n.dJ{constructor(){const e={m:new Float32Array([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0]),uAlpha:1};super(n.Eo,"varying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform float m[20];\nuniform float uAlpha;\n\nvoid main(void)\n{\n    vec4 c = texture2D(uSampler, vTextureCoord);\n\n    if (uAlpha == 0.0) {\n        gl_FragColor = c;\n        return;\n    }\n\n    // Un-premultiply alpha before applying the color matrix. See issue #3539.\n    if (c.a > 0.0) {\n      c.rgb /= c.a;\n    }\n\n    vec4 result;\n\n    result.r = (m[0] * c.r);\n        result.r += (m[1] * c.g);\n        result.r += (m[2] * c.b);\n        result.r += (m[3] * c.a);\n        result.r += m[4];\n\n    result.g = (m[5] * c.r);\n        result.g += (m[6] * c.g);\n        result.g += (m[7] * c.b);\n        result.g += (m[8] * c.a);\n        result.g += m[9];\n\n    result.b = (m[10] * c.r);\n       result.b += (m[11] * c.g);\n       result.b += (m[12] * c.b);\n       result.b += (m[13] * c.a);\n       result.b += m[14];\n\n    result.a = (m[15] * c.r);\n       result.a += (m[16] * c.g);\n       result.a += (m[17] * c.b);\n       result.a += (m[18] * c.a);\n       result.a += m[19];\n\n    vec3 rgb = mix(c.rgb, result.rgb, uAlpha);\n\n    // Premultiply alpha again.\n    rgb *= result.a;\n\n    gl_FragColor = vec4(rgb, result.a);\n}\n",e),this.alpha=1}_loadMatrix(e,t=!1){let r=e;t&&(this._multiply(r,this.uniforms.m,e),r=this._colorMatrix(r)),this.uniforms.m=r}_multiply(e,t,r){return e[0]=t[0]*r[0]+t[1]*r[5]+t[2]*r[10]+t[3]*r[15],e[1]=t[0]*r[1]+t[1]*r[6]+t[2]*r[11]+t[3]*r[16],e[2]=t[0]*r[2]+t[1]*r[7]+t[2]*r[12]+t[3]*r[17],e[3]=t[0]*r[3]+t[1]*r[8]+t[2]*r[13]+t[3]*r[18],e[4]=t[0]*r[4]+t[1]*r[9]+t[2]*r[14]+t[3]*r[19]+t[4],e[5]=t[5]*r[0]+t[6]*r[5]+t[7]*r[10]+t[8]*r[15],e[6]=t[5]*r[1]+t[6]*r[6]+t[7]*r[11]+t[8]*r[16],e[7]=t[5]*r[2]+t[6]*r[7]+t[7]*r[12]+t[8]*r[17],e[8]=t[5]*r[3]+t[6]*r[8]+t[7]*r[13]+t[8]*r[18],e[9]=t[5]*r[4]+t[6]*r[9]+t[7]*r[14]+t[8]*r[19]+t[9],e[10]=t[10]*r[0]+t[11]*r[5]+t[12]*r[10]+t[13]*r[15],e[11]=t[10]*r[1]+t[11]*r[6]+t[12]*r[11]+t[13]*r[16],e[12]=t[10]*r[2]+t[11]*r[7]+t[12]*r[12]+t[13]*r[17],e[13]=t[10]*r[3]+t[11]*r[8]+t[12]*r[13]+t[13]*r[18],e[14]=t[10]*r[4]+t[11]*r[9]+t[12]*r[14]+t[13]*r[19]+t[14],e[15]=t[15]*r[0]+t[16]*r[5]+t[17]*r[10]+t[18]*r[15],e[16]=t[15]*r[1]+t[16]*r[6]+t[17]*r[11]+t[18]*r[16],e[17]=t[15]*r[2]+t[16]*r[7]+t[17]*r[12]+t[18]*r[17],e[18]=t[15]*r[3]+t[16]*r[8]+t[17]*r[13]+t[18]*r[18],e[19]=t[15]*r[4]+t[16]*r[9]+t[17]*r[14]+t[18]*r[19]+t[19],e}_colorMatrix(e){const t=new Float32Array(e);return t[4]/=255,t[9]/=255,t[14]/=255,t[19]/=255,t}brightness(e,t){const r=[e,0,0,0,0,0,e,0,0,0,0,0,e,0,0,0,0,0,1,0];this._loadMatrix(r,t)}tint(e,t){const[r,i,o]=n.Q1.shared.setValue(e).toArray(),a=[r,0,0,0,0,0,i,0,0,0,0,0,o,0,0,0,0,0,1,0];this._loadMatrix(a,t)}greyscale(e,t){const r=[e,e,e,0,0,e,e,e,0,0,e,e,e,0,0,0,0,0,1,0];this._loadMatrix(r,t)}blackAndWhite(e){this._loadMatrix([.3,.6,.1,0,0,.3,.6,.1,0,0,.3,.6,.1,0,0,0,0,0,1,0],e)}hue(e,t){e=(e||0)/180*Math.PI;const r=Math.cos(e),n=Math.sin(e),i=1/3,o=(0,Math.sqrt)(i),a=[r+(1-r)*i,i*(1-r)-o*n,i*(1-r)+o*n,0,0,i*(1-r)+o*n,r+i*(1-r),i*(1-r)-o*n,0,0,i*(1-r)-o*n,i*(1-r)+o*n,r+i*(1-r),0,0,0,0,0,1,0];this._loadMatrix(a,t)}contrast(e,t){const r=(e||0)+1,n=-.5*(r-1),i=[r,0,0,0,n,0,r,0,0,n,0,0,r,0,n,0,0,0,1,0];this._loadMatrix(i,t)}saturate(e=0,t){const r=2*e/3+1,n=-.5*(r-1),i=[r,n,n,0,0,n,r,n,0,0,n,n,r,0,0,0,0,0,1,0];this._loadMatrix(i,t)}desaturate(){this.saturate(-1)}negative(e){this._loadMatrix([-1,0,0,1,0,0,-1,0,1,0,0,0,-1,1,0,0,0,0,1,0],e)}sepia(e){this._loadMatrix([.393,.7689999,.18899999,0,0,.349,.6859999,.16799999,0,0,.272,.5339999,.13099999,0,0,0,0,0,1,0],e)}technicolor(e){this._loadMatrix([1.9125277891456083,-.8545344976951645,-.09155508482755585,0,11.793603434377337,-.3087833385928097,1.7658908555458428,-.10601743074722245,0,-70.35205161461398,-.231103377548616,-.7501899197440212,1.847597816108189,0,30.950940869491138,0,0,0,1,0],e)}polaroid(e){this._loadMatrix([1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0],e)}toBGR(e){this._loadMatrix([0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,0],e)}kodachrome(e){this._loadMatrix([1.1285582396593525,-.3967382283601348,-.03992559172921793,0,63.72958762196502,-.16404339962244616,1.0835251566291304,-.05498805115633132,0,24.732407896706203,-.16786010706155763,-.5603416277695248,1.6014850761964943,0,35.62982807460946,0,0,0,1,0],e)}browni(e){this._loadMatrix([.5997023498159715,.34553243048391263,-.2708298674538042,0,47.43192855600873,-.037703249837783157,.8609577587992641,.15059552388459913,0,-36.96841498319127,.24113635128153335,-.07441037908422492,.44972182064877153,0,-7.562075277591283,0,0,0,1,0],e)}vintage(e){this._loadMatrix([.6279345635605994,.3202183420819367,-.03965408211312453,0,9.651285835294123,.02578397704808868,.6441188644374771,.03259127616149294,0,7.462829176470591,.0466055556782719,-.0851232987247891,.5241648018700465,0,5.159190588235296,0,0,0,1,0],e)}colorTone(e,t,r,i,o){e=e||.2,t=t||.15,r=r||16770432,i=i||3375104;const a=n.Q1.shared,[s,u,l]=a.setValue(r).toArray(),[h,c,f]=a.setValue(i).toArray(),d=[.3,.59,.11,0,0,s,u,l,e,0,h,c,f,t,0,s-h,u-c,l-f,0,0];this._loadMatrix(d,o)}night(e,t){const r=[-2*(e=e||.1),-e,0,0,0,-e,0,e,0,0,0,e,2*e,0,0,0,0,0,1,0];this._loadMatrix(r,t)}predator(e,t){const r=[11.224130630493164*e,-4.794486999511719*e,-2.8746118545532227*e,0*e,.40342438220977783*e,-3.6330697536468506*e,9.193157196044922*e,-2.951810836791992*e,0*e,-1.316135048866272*e,-3.2184197902679443*e,-4.2375030517578125*e,7.476448059082031*e,0*e,.8044459223747253*e,0,0,0,1,0];this._loadMatrix(r,t)}lsd(e){this._loadMatrix([2,-.4,.5,0,0,-.5,2,-.4,0,0,-.4,-.5,3,0,0,0,0,0,1,0],e)}reset(){this._loadMatrix([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],!1)}get matrix(){return this.uniforms.m}set matrix(e){this.uniforms.m=e}get alpha(){return this.uniforms.uAlpha}set alpha(e){this.uniforms.uAlpha=e}}x.prototype.grayscale=x.prototype.greyscale;class _ extends n.dJ{constructor(e,t){const r=new n.uq;e.renderable=!1,super("attribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\nuniform mat3 filterMatrix;\n\nvarying vec2 vTextureCoord;\nvarying vec2 vFilterCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord( void )\n{\n    return aVertexPosition * (outputFrame.zw * inputSize.zw);\n}\n\nvoid main(void)\n{\n\tgl_Position = filterVertexPosition();\n\tvTextureCoord = filterTextureCoord();\n\tvFilterCoord = ( filterMatrix * vec3( vTextureCoord, 1.0)  ).xy;\n}\n","varying vec2 vFilterCoord;\nvarying vec2 vTextureCoord;\n\nuniform vec2 scale;\nuniform mat2 rotation;\nuniform sampler2D uSampler;\nuniform sampler2D mapSampler;\n\nuniform highp vec4 inputSize;\nuniform vec4 inputClamp;\n\nvoid main(void)\n{\n  vec4 map =  texture2D(mapSampler, vFilterCoord);\n\n  map -= 0.5;\n  map.xy = scale * inputSize.zw * (rotation * map.xy);\n\n  gl_FragColor = texture2D(uSampler, clamp(vec2(vTextureCoord.x + map.x, vTextureCoord.y + map.y), inputClamp.xy, inputClamp.zw));\n}\n",{mapSampler:e._texture,filterMatrix:r,scale:{x:1,y:1},rotation:new Float32Array([1,0,0,1])}),this.maskSprite=e,this.maskMatrix=r,null==t&&(t=20),this.scale=new n.bR(t,t)}apply(e,t,r,n){this.uniforms.filterMatrix=e.calculateSpriteMatrix(this.maskMatrix,this.maskSprite),this.uniforms.scale.x=this.scale.x,this.uniforms.scale.y=this.scale.y;const i=this.maskSprite.worldTransform,o=Math.sqrt(i.a*i.a+i.b*i.b),a=Math.sqrt(i.c*i.c+i.d*i.d);0!==o&&0!==a&&(this.uniforms.rotation[0]=i.a/o,this.uniforms.rotation[1]=i.b/o,this.uniforms.rotation[2]=i.c/a,this.uniforms.rotation[3]=i.d/a),e.applyFilter(this,t,r,n)}get map(){return this.uniforms.mapSampler}set map(e){this.uniforms.mapSampler=e}}class S extends n.dJ{constructor(){super("\nattribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 v_rgbNW;\nvarying vec2 v_rgbNE;\nvarying vec2 v_rgbSW;\nvarying vec2 v_rgbSE;\nvarying vec2 v_rgbM;\n\nvarying vec2 vFragCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvoid texcoords(vec2 fragCoord, vec2 inverseVP,\n               out vec2 v_rgbNW, out vec2 v_rgbNE,\n               out vec2 v_rgbSW, out vec2 v_rgbSE,\n               out vec2 v_rgbM) {\n    v_rgbNW = (fragCoord + vec2(-1.0, -1.0)) * inverseVP;\n    v_rgbNE = (fragCoord + vec2(1.0, -1.0)) * inverseVP;\n    v_rgbSW = (fragCoord + vec2(-1.0, 1.0)) * inverseVP;\n    v_rgbSE = (fragCoord + vec2(1.0, 1.0)) * inverseVP;\n    v_rgbM = vec2(fragCoord * inverseVP);\n}\n\nvoid main(void) {\n\n   gl_Position = filterVertexPosition();\n\n   vFragCoord = aVertexPosition * outputFrame.zw;\n\n   texcoords(vFragCoord, inputSize.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);\n}\n",'varying vec2 v_rgbNW;\nvarying vec2 v_rgbNE;\nvarying vec2 v_rgbSW;\nvarying vec2 v_rgbSE;\nvarying vec2 v_rgbM;\n\nvarying vec2 vFragCoord;\nuniform sampler2D uSampler;\nuniform highp vec4 inputSize;\n\n\n/**\n Basic FXAA implementation based on the code on geeks3d.com with the\n modification that the texture2DLod stuff was removed since it\'s\n unsupported by WebGL.\n\n --\n\n From:\n https://github.com/mitsuhiko/webgl-meincraft\n\n Copyright (c) 2011 by Armin Ronacher.\n\n Some rights reserved.\n\n Redistribution and use in source and binary forms, with or without\n modification, are permitted provided that the following conditions are\n met:\n\n * Redistributions of source code must retain the above copyright\n notice, this list of conditions and the following disclaimer.\n\n * Redistributions in binary form must reproduce the above\n copyright notice, this list of conditions and the following\n disclaimer in the documentation and/or other materials provided\n with the distribution.\n\n * The names of the contributors may not be used to endorse or\n promote products derived from this software without specific\n prior written permission.\n\n THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS\n "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT\n LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR\n A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT\n OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,\n SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT\n LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY\n THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\n OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n */\n\n#ifndef FXAA_REDUCE_MIN\n#define FXAA_REDUCE_MIN   (1.0/ 128.0)\n#endif\n#ifndef FXAA_REDUCE_MUL\n#define FXAA_REDUCE_MUL   (1.0 / 8.0)\n#endif\n#ifndef FXAA_SPAN_MAX\n#define FXAA_SPAN_MAX     8.0\n#endif\n\n//optimized version for mobile, where dependent\n//texture reads can be a bottleneck\nvec4 fxaa(sampler2D tex, vec2 fragCoord, vec2 inverseVP,\n          vec2 v_rgbNW, vec2 v_rgbNE,\n          vec2 v_rgbSW, vec2 v_rgbSE,\n          vec2 v_rgbM) {\n    vec4 color;\n    vec3 rgbNW = texture2D(tex, v_rgbNW).xyz;\n    vec3 rgbNE = texture2D(tex, v_rgbNE).xyz;\n    vec3 rgbSW = texture2D(tex, v_rgbSW).xyz;\n    vec3 rgbSE = texture2D(tex, v_rgbSE).xyz;\n    vec4 texColor = texture2D(tex, v_rgbM);\n    vec3 rgbM  = texColor.xyz;\n    vec3 luma = vec3(0.299, 0.587, 0.114);\n    float lumaNW = dot(rgbNW, luma);\n    float lumaNE = dot(rgbNE, luma);\n    float lumaSW = dot(rgbSW, luma);\n    float lumaSE = dot(rgbSE, luma);\n    float lumaM  = dot(rgbM,  luma);\n    float lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));\n    float lumaMax = max(lumaM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));\n\n    mediump vec2 dir;\n    dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));\n    dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));\n\n    float dirReduce = max((lumaNW + lumaNE + lumaSW + lumaSE) *\n                          (0.25 * FXAA_REDUCE_MUL), FXAA_REDUCE_MIN);\n\n    float rcpDirMin = 1.0 / (min(abs(dir.x), abs(dir.y)) + dirReduce);\n    dir = min(vec2(FXAA_SPAN_MAX, FXAA_SPAN_MAX),\n              max(vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),\n                  dir * rcpDirMin)) * inverseVP;\n\n    vec3 rgbA = 0.5 * (\n                       texture2D(tex, fragCoord * inverseVP + dir * (1.0 / 3.0 - 0.5)).xyz +\n                       texture2D(tex, fragCoord * inverseVP + dir * (2.0 / 3.0 - 0.5)).xyz);\n    vec3 rgbB = rgbA * 0.5 + 0.25 * (\n                                     texture2D(tex, fragCoord * inverseVP + dir * -0.5).xyz +\n                                     texture2D(tex, fragCoord * inverseVP + dir * 0.5).xyz);\n\n    float lumaB = dot(rgbB, luma);\n    if ((lumaB < lumaMin) || (lumaB > lumaMax))\n        color = vec4(rgbA, texColor.a);\n    else\n        color = vec4(rgbB, texColor.a);\n    return color;\n}\n\nvoid main() {\n\n      vec4 color;\n\n      color = fxaa(uSampler, vFragCoord, inputSize.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);\n\n      gl_FragColor = color;\n}\n')}}class T extends n.dJ{constructor(e=.5,t=Math.random()){super(n.Eo,"precision highp float;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nuniform float uNoise;\nuniform float uSeed;\nuniform sampler2D uSampler;\n\nfloat rand(vec2 co)\n{\n    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);\n}\n\nvoid main()\n{\n    vec4 color = texture2D(uSampler, vTextureCoord);\n    float randomValue = rand(gl_FragCoord.xy * uSeed);\n    float diff = (randomValue - 0.5) * uNoise;\n\n    // Un-premultiply alpha before applying the color matrix. See issue #3539.\n    if (color.a > 0.0) {\n        color.rgb /= color.a;\n    }\n\n    color.r += diff;\n    color.g += diff;\n    color.b += diff;\n\n    // Premultiply alpha again.\n    color.rgb *= color.a;\n\n    gl_FragColor = color;\n}\n",{uNoise:0,uSeed:0}),this.noise=e,this.seed=t}get noise(){return this.uniforms.uNoise}set noise(e){this.uniforms.uNoise=e}get seed(){return this.uniforms.uSeed}set seed(e){this.uniforms.uSeed=e}}const E={AlphaFilter:m,BlurFilter:b,BlurFilterPass:v,ColorMatrixFilter:x,DisplacementFilter:_,FXAAFilter:S,NoiseFilter:T};Object.entries(E).forEach((([e,t])=>{Object.defineProperty(E,e,{get:()=>(n.Wp.deprecation("7.1.0",`filters.${e} has moved to ${e}`),t)})}));const O=new class{constructor(){this.interactionFrequency=10,this._deltaTime=0,this._didMove=!1,this.tickerAdded=!1,this._pauseUpdate=!0}init(e){this.removeTickerListener(),this.events=e,this.interactionFrequency=10,this._deltaTime=0,this._didMove=!1,this.tickerAdded=!1,this._pauseUpdate=!0}get pauseUpdate(){return this._pauseUpdate}set pauseUpdate(e){this._pauseUpdate=e}addTickerListener(){this.tickerAdded||!this.domElement||(n.Rv.system.add(this.tickerUpdate,this,n.dQ.INTERACTION),this.tickerAdded=!0)}removeTickerListener(){this.tickerAdded&&(n.Rv.system.remove(this.tickerUpdate,this),this.tickerAdded=!1)}pointerMoved(){this._didMove=!0}update(){if(!this.domElement||this._pauseUpdate)return;if(this._didMove)return void(this._didMove=!1);const e=this.events.rootPointerEvent;this.events.supportsTouchEvents&&"touch"===e.pointerType||globalThis.document.dispatchEvent(new PointerEvent("pointermove",{clientX:e.clientX,clientY:e.clientY}))}tickerUpdate(e){this._deltaTime+=e,!(this._deltaTime<this.interactionFrequency)&&(this._deltaTime=0,this.update())}};class A{constructor(e){this.bubbles=!0,this.cancelBubble=!0,this.cancelable=!1,this.composed=!1,this.defaultPrevented=!1,this.eventPhase=A.prototype.NONE,this.propagationStopped=!1,this.propagationImmediatelyStopped=!1,this.layer=new n.bR,this.page=new n.bR,this.NONE=0,this.CAPTURING_PHASE=1,this.AT_TARGET=2,this.BUBBLING_PHASE=3,this.manager=e}get layerX(){return this.layer.x}get layerY(){return this.layer.y}get pageX(){return this.page.x}get pageY(){return this.page.y}get data(){return this}composedPath(){return this.manager&&(!this.path||this.path[this.path.length-1]!==this.target)&&(this.path=this.target?this.manager.propagationPath(this.target):[]),this.path}initEvent(e,t,r){throw new Error("initEvent() is a legacy DOM API. It is not implemented in the Federated Events API.")}initUIEvent(e,t,r,n,i){throw new Error("initUIEvent() is a legacy DOM API. It is not implemented in the Federated Events API.")}preventDefault(){this.nativeEvent instanceof Event&&this.nativeEvent.cancelable&&this.nativeEvent.preventDefault(),this.defaultPrevented=!0}stopImmediatePropagation(){this.propagationImmediatelyStopped=!0}stopPropagation(){this.propagationStopped=!0}}class I extends A{constructor(){super(...arguments),this.client=new n.bR,this.movement=new n.bR,this.offset=new n.bR,this.global=new n.bR,this.screen=new n.bR}get clientX(){return this.client.x}get clientY(){return this.client.y}get x(){return this.clientX}get y(){return this.clientY}get movementX(){return this.movement.x}get movementY(){return this.movement.y}get offsetX(){return this.offset.x}get offsetY(){return this.offset.y}get globalX(){return this.global.x}get globalY(){return this.global.y}get screenX(){return this.screen.x}get screenY(){return this.screen.y}getLocalPosition(e,t,r){return e.worldTransform.applyInverse(r||this.global,t)}getModifierState(e){return"getModifierState"in this.nativeEvent&&this.nativeEvent.getModifierState(e)}initMouseEvent(e,t,r,n,i,o,a,s,u,l,h,c,f,d,p){throw new Error("Method not implemented.")}}class P extends I{constructor(){super(...arguments),this.width=0,this.height=0,this.isPrimary=!1}getCoalescedEvents(){return"pointermove"===this.type||"mousemove"===this.type||"touchmove"===this.type?[this]:[]}getPredictedEvents(){throw new Error("getPredictedEvents is not supported!")}}class k extends I{constructor(){super(...arguments),this.DOM_DELTA_PIXEL=0,this.DOM_DELTA_LINE=1,this.DOM_DELTA_PAGE=2}}k.DOM_DELTA_PIXEL=0,k.DOM_DELTA_LINE=1,k.DOM_DELTA_PAGE=2;const C=new n.bR,$=new n.bR;class R{constructor(e){this.dispatch=new n.Wp.EventEmitter,this.moveOnAll=!1,this.enableGlobalMoveEvents=!0,this.mappingState={trackingData:{}},this.eventPool=new Map,this._allInteractiveElements=[],this._hitElements=[],this._isPointerMoveEvent=!1,this.rootTarget=e,this.hitPruneFn=this.hitPruneFn.bind(this),this.hitTestFn=this.hitTestFn.bind(this),this.mapPointerDown=this.mapPointerDown.bind(this),this.mapPointerMove=this.mapPointerMove.bind(this),this.mapPointerOut=this.mapPointerOut.bind(this),this.mapPointerOver=this.mapPointerOver.bind(this),this.mapPointerUp=this.mapPointerUp.bind(this),this.mapPointerUpOutside=this.mapPointerUpOutside.bind(this),this.mapWheel=this.mapWheel.bind(this),this.mappingTable={},this.addEventMapping("pointerdown",this.mapPointerDown),this.addEventMapping("pointermove",this.mapPointerMove),this.addEventMapping("pointerout",this.mapPointerOut),this.addEventMapping("pointerleave",this.mapPointerOut),this.addEventMapping("pointerover",this.mapPointerOver),this.addEventMapping("pointerup",this.mapPointerUp),this.addEventMapping("pointerupoutside",this.mapPointerUpOutside),this.addEventMapping("wheel",this.mapWheel)}addEventMapping(e,t){this.mappingTable[e]||(this.mappingTable[e]=[]),this.mappingTable[e].push({fn:t,priority:0}),this.mappingTable[e].sort(((e,t)=>e.priority-t.priority))}dispatchEvent(e,t){e.propagationStopped=!1,e.propagationImmediatelyStopped=!1,this.propagate(e,t),this.dispatch.emit(t||e.type,e)}mapEvent(e){if(!this.rootTarget)return;const t=this.mappingTable[e.type];if(t)for(let r=0,n=t.length;r<n;r++)t[r].fn(e);else console.warn(`[EventBoundary]: Event mapping not defined for ${e.type}`)}hitTest(e,t){O.pauseUpdate=!0;const r=this[this._isPointerMoveEvent&&this.enableGlobalMoveEvents?"hitTestMoveRecursive":"hitTestRecursive"](this.rootTarget,this.rootTarget.eventMode,C.set(e,t),this.hitTestFn,this.hitPruneFn);return r&&r[0]}propagate(e,t){if(!e.target)return;const r=e.composedPath();e.eventPhase=e.CAPTURING_PHASE;for(let n=0,i=r.length-1;n<i;n++)if(e.currentTarget=r[n],this.notifyTarget(e,t),e.propagationStopped||e.propagationImmediatelyStopped)return;if(e.eventPhase=e.AT_TARGET,e.currentTarget=e.target,this.notifyTarget(e,t),!e.propagationStopped&&!e.propagationImmediatelyStopped){e.eventPhase=e.BUBBLING_PHASE;for(let n=r.length-2;n>=0;n--)if(e.currentTarget=r[n],this.notifyTarget(e,t),e.propagationStopped||e.propagationImmediatelyStopped)return}}all(e,t,r=this._allInteractiveElements){if(0===r.length)return;e.eventPhase=e.BUBBLING_PHASE;const n=Array.isArray(t)?t:[t];for(let t=r.length-1;t>=0;t--)n.forEach((n=>{e.currentTarget=r[t],this.notifyTarget(e,n)}))}propagationPath(e){const t=[e];for(let r=0;r<2048&&e!==this.rootTarget;r++){if(!e.parent)throw new Error("Cannot find propagation path to disconnected target");t.push(e.parent),e=e.parent}return t.reverse(),t}hitTestMoveRecursive(e,t,r,n,i,o=!1){let a=!1;if(this._interactivePrune(e))return null;if(("dynamic"===e.eventMode||"dynamic"===t)&&(O.pauseUpdate=!1),e.interactiveChildren&&e.children){const s=e.children;for(let u=s.length-1;u>=0;u--){const l=s[u],h=this.hitTestMoveRecursive(l,this._isInteractive(t)?t:l.eventMode,r,n,i,o||i(e,r));if(h){if(h.length>0&&!h[h.length-1].parent)continue;const t=e.isInteractive();(h.length>0||t)&&(t&&this._allInteractiveElements.push(e),h.push(e)),0===this._hitElements.length&&(this._hitElements=h),a=!0}}}const s=this._isInteractive(t),u=e.isInteractive();return s&&u&&this._allInteractiveElements.push(e),o||this._hitElements.length>0?null:a?this._hitElements:s&&!i(e,r)&&n(e,r)?u?[e]:[]:null}hitTestRecursive(e,t,r,n,i){if(this._interactivePrune(e)||i(e,r))return null;if(("dynamic"===e.eventMode||"dynamic"===t)&&(O.pauseUpdate=!1),e.interactiveChildren&&e.children){const o=e.children;for(let a=o.length-1;a>=0;a--){const s=o[a],u=this.hitTestRecursive(s,this._isInteractive(t)?t:s.eventMode,r,n,i);if(u){if(u.length>0&&!u[u.length-1].parent)continue;const t=e.isInteractive();return(u.length>0||t)&&u.push(e),u}}}const o=this._isInteractive(t),a=e.isInteractive();return o&&n(e,r)?a?[e]:[]:null}_isInteractive(e){return"static"===e||"dynamic"===e}_interactivePrune(e){return!(e&&!e.isMask&&e.visible&&e.renderable&&"none"!==e.eventMode&&("passive"!==e.eventMode||e.interactiveChildren)&&!e.isMask)}hitPruneFn(e,t){if(e.hitArea&&(e.worldTransform.applyInverse(t,$),!e.hitArea.contains($.x,$.y)))return!0;if(e._mask){const r=e._mask.isMaskData?e._mask.maskObject:e._mask;if(r&&!r.containsPoint?.(t))return!0}return!1}hitTestFn(e,t){return"passive"!==e.eventMode&&(!!e.hitArea||!!e.containsPoint&&e.containsPoint(t))}notifyTarget(e,t){const r=`on${t=t??e.type}`;e.currentTarget[r]?.(e);const n=e.eventPhase===e.CAPTURING_PHASE||e.eventPhase===e.AT_TARGET?`${t}capture`:t;this.notifyListeners(e,n),e.eventPhase===e.AT_TARGET&&this.notifyListeners(e,t)}mapPointerDown(e){if(!(e instanceof P))return void console.warn("EventBoundary cannot map a non-pointer event as a pointer event");const t=this.createPointerEvent(e);if(this.dispatchEvent(t,"pointerdown"),"touch"===t.pointerType)this.dispatchEvent(t,"touchstart");else if("mouse"===t.pointerType||"pen"===t.pointerType){const e=2===t.button;this.dispatchEvent(t,e?"rightdown":"mousedown")}this.trackingData(e.pointerId).pressTargetsByButton[e.button]=t.composedPath(),this.freeEvent(t)}mapPointerMove(e){if(!(e instanceof P))return void console.warn("EventBoundary cannot map a non-pointer event as a pointer event");this._allInteractiveElements.length=0,this._hitElements.length=0,this._isPointerMoveEvent=!0;const t=this.createPointerEvent(e);this._isPointerMoveEvent=!1;const r="mouse"===t.pointerType||"pen"===t.pointerType,n=this.trackingData(e.pointerId),i=this.findMountedTarget(n.overTargets);if(n.overTargets?.length>0&&i!==t.target){const n="mousemove"===e.type?"mouseout":"pointerout",o=this.createPointerEvent(e,n,i);if(this.dispatchEvent(o,"pointerout"),r&&this.dispatchEvent(o,"mouseout"),!t.composedPath().includes(i)){const n=this.createPointerEvent(e,"pointerleave",i);for(n.eventPhase=n.AT_TARGET;n.target&&!t.composedPath().includes(n.target);)n.currentTarget=n.target,this.notifyTarget(n),r&&this.notifyTarget(n,"mouseleave"),n.target=n.target.parent;this.freeEvent(n)}this.freeEvent(o)}if(i!==t.target){const n="mousemove"===e.type?"mouseover":"pointerover",o=this.clonePointerEvent(t,n);this.dispatchEvent(o,"pointerover"),r&&this.dispatchEvent(o,"mouseover");let a=i?.parent;for(;a&&a!==this.rootTarget.parent&&a!==t.target;)a=a.parent;if(!a||a===this.rootTarget.parent){const e=this.clonePointerEvent(t,"pointerenter");for(e.eventPhase=e.AT_TARGET;e.target&&e.target!==i&&e.target!==this.rootTarget.parent;)e.currentTarget=e.target,this.notifyTarget(e),r&&this.notifyTarget(e,"mouseenter"),e.target=e.target.parent;this.freeEvent(e)}this.freeEvent(o)}const o=[],a=this.enableGlobalMoveEvents??!0;this.moveOnAll?o.push("pointermove"):this.dispatchEvent(t,"pointermove"),a&&o.push("globalpointermove"),"touch"===t.pointerType&&(this.moveOnAll?o.splice(1,0,"touchmove"):this.dispatchEvent(t,"touchmove"),a&&o.push("globaltouchmove")),r&&(this.moveOnAll?o.splice(1,0,"mousemove"):this.dispatchEvent(t,"mousemove"),a&&o.push("globalmousemove"),this.cursor=t.target?.cursor),o.length>0&&this.all(t,o),this._allInteractiveElements.length=0,this._hitElements.length=0,n.overTargets=t.composedPath(),this.freeEvent(t)}mapPointerOver(e){if(!(e instanceof P))return void console.warn("EventBoundary cannot map a non-pointer event as a pointer event");const t=this.trackingData(e.pointerId),r=this.createPointerEvent(e),n="mouse"===r.pointerType||"pen"===r.pointerType;this.dispatchEvent(r,"pointerover"),n&&this.dispatchEvent(r,"mouseover"),"mouse"===r.pointerType&&(this.cursor=r.target?.cursor);const i=this.clonePointerEvent(r,"pointerenter");for(i.eventPhase=i.AT_TARGET;i.target&&i.target!==this.rootTarget.parent;)i.currentTarget=i.target,this.notifyTarget(i),n&&this.notifyTarget(i,"mouseenter"),i.target=i.target.parent;t.overTargets=r.composedPath(),this.freeEvent(r),this.freeEvent(i)}mapPointerOut(e){if(!(e instanceof P))return void console.warn("EventBoundary cannot map a non-pointer event as a pointer event");const t=this.trackingData(e.pointerId);if(t.overTargets){const r="mouse"===e.pointerType||"pen"===e.pointerType,n=this.findMountedTarget(t.overTargets),i=this.createPointerEvent(e,"pointerout",n);this.dispatchEvent(i),r&&this.dispatchEvent(i,"mouseout");const o=this.createPointerEvent(e,"pointerleave",n);for(o.eventPhase=o.AT_TARGET;o.target&&o.target!==this.rootTarget.parent;)o.currentTarget=o.target,this.notifyTarget(o),r&&this.notifyTarget(o,"mouseleave"),o.target=o.target.parent;t.overTargets=null,this.freeEvent(i),this.freeEvent(o)}this.cursor=null}mapPointerUp(e){if(!(e instanceof P))return void console.warn("EventBoundary cannot map a non-pointer event as a pointer event");const t=performance.now(),r=this.createPointerEvent(e);if(this.dispatchEvent(r,"pointerup"),"touch"===r.pointerType)this.dispatchEvent(r,"touchend");else if("mouse"===r.pointerType||"pen"===r.pointerType){const e=2===r.button;this.dispatchEvent(r,e?"rightup":"mouseup")}const n=this.trackingData(e.pointerId),i=this.findMountedTarget(n.pressTargetsByButton[e.button]);let o=i;if(i&&!r.composedPath().includes(i)){let t=i;for(;t&&!r.composedPath().includes(t);){if(r.currentTarget=t,this.notifyTarget(r,"pointerupoutside"),"touch"===r.pointerType)this.notifyTarget(r,"touchendoutside");else if("mouse"===r.pointerType||"pen"===r.pointerType){const e=2===r.button;this.notifyTarget(r,e?"rightupoutside":"mouseupoutside")}t=t.parent}delete n.pressTargetsByButton[e.button],o=t}if(o){const i=this.clonePointerEvent(r,"click");i.target=o,i.path=null,n.clicksByButton[e.button]||(n.clicksByButton[e.button]={clickCount:0,target:i.target,timeStamp:t});const a=n.clicksByButton[e.button];if(a.target===i.target&&t-a.timeStamp<200?++a.clickCount:a.clickCount=1,a.target=i.target,a.timeStamp=t,i.detail=a.clickCount,"mouse"===i.pointerType){const e=2===i.button;this.dispatchEvent(i,e?"rightclick":"click")}else"touch"===i.pointerType&&this.dispatchEvent(i,"tap");this.dispatchEvent(i,"pointertap"),this.freeEvent(i)}this.freeEvent(r)}mapPointerUpOutside(e){if(!(e instanceof P))return void console.warn("EventBoundary cannot map a non-pointer event as a pointer event");const t=this.trackingData(e.pointerId),r=this.findMountedTarget(t.pressTargetsByButton[e.button]),n=this.createPointerEvent(e);if(r){let i=r;for(;i;)n.currentTarget=i,this.notifyTarget(n,"pointerupoutside"),"touch"===n.pointerType?this.notifyTarget(n,"touchendoutside"):("mouse"===n.pointerType||"pen"===n.pointerType)&&this.notifyTarget(n,2===n.button?"rightupoutside":"mouseupoutside"),i=i.parent;delete t.pressTargetsByButton[e.button]}this.freeEvent(n)}mapWheel(e){if(!(e instanceof k))return void console.warn("EventBoundary cannot map a non-wheel event as a wheel event");const t=this.createWheelEvent(e);this.dispatchEvent(t),this.freeEvent(t)}findMountedTarget(e){if(!e)return null;let t=e[0];for(let r=1;r<e.length&&e[r].parent===t;r++)t=e[r];return t}createPointerEvent(e,t,r){const n=this.allocateEvent(P);return this.copyPointerData(e,n),this.copyMouseData(e,n),this.copyData(e,n),n.nativeEvent=e.nativeEvent,n.originalEvent=e,n.target=r??this.hitTest(n.global.x,n.global.y)??this._hitElements[0],"string"==typeof t&&(n.type=t),n}createWheelEvent(e){const t=this.allocateEvent(k);return this.copyWheelData(e,t),this.copyMouseData(e,t),this.copyData(e,t),t.nativeEvent=e.nativeEvent,t.originalEvent=e,t.target=this.hitTest(t.global.x,t.global.y),t}clonePointerEvent(e,t){const r=this.allocateEvent(P);return r.nativeEvent=e.nativeEvent,r.originalEvent=e.originalEvent,this.copyPointerData(e,r),this.copyMouseData(e,r),this.copyData(e,r),r.target=e.target,r.path=e.composedPath().slice(),r.type=t??r.type,r}copyWheelData(e,t){t.deltaMode=e.deltaMode,t.deltaX=e.deltaX,t.deltaY=e.deltaY,t.deltaZ=e.deltaZ}copyPointerData(e,t){e instanceof P&&t instanceof P&&(t.pointerId=e.pointerId,t.width=e.width,t.height=e.height,t.isPrimary=e.isPrimary,t.pointerType=e.pointerType,t.pressure=e.pressure,t.tangentialPressure=e.tangentialPressure,t.tiltX=e.tiltX,t.tiltY=e.tiltY,t.twist=e.twist)}copyMouseData(e,t){e instanceof I&&t instanceof I&&(t.altKey=e.altKey,t.button=e.button,t.buttons=e.buttons,t.client.copyFrom(e.client),t.ctrlKey=e.ctrlKey,t.metaKey=e.metaKey,t.movement.copyFrom(e.movement),t.screen.copyFrom(e.screen),t.shiftKey=e.shiftKey,t.global.copyFrom(e.global))}copyData(e,t){t.isTrusted=e.isTrusted,t.srcElement=e.srcElement,t.timeStamp=performance.now(),t.type=e.type,t.detail=e.detail,t.view=e.view,t.which=e.which,t.layer.copyFrom(e.layer),t.page.copyFrom(e.page)}trackingData(e){return this.mappingState.trackingData[e]||(this.mappingState.trackingData[e]={pressTargetsByButton:{},clicksByButton:{},overTarget:null}),this.mappingState.trackingData[e]}allocateEvent(e){this.eventPool.has(e)||this.eventPool.set(e,[]);const t=this.eventPool.get(e).pop()||new e(this);return t.eventPhase=t.NONE,t.currentTarget=null,t.path=null,t.target=null,t}freeEvent(e){if(e.manager!==this)throw new Error("It is illegal to free an event not managed by this EventBoundary!");const t=e.constructor;this.eventPool.has(t)||this.eventPool.set(t,[]),this.eventPool.get(t).push(e)}notifyListeners(e,t){const r=e.currentTarget._events[t];if(r&&e.currentTarget.isInteractive())if("fn"in r)r.once&&e.currentTarget.removeListener(t,r.fn,void 0,!0),r.fn.call(r.context,e);else for(let n=0,i=r.length;n<i&&!e.propagationImmediatelyStopped;n++)r[n].once&&e.currentTarget.removeListener(t,r[n].fn,void 0,!0),r[n].fn.call(r[n].context,e)}}const D={touchstart:"pointerdown",touchend:"pointerup",touchendoutside:"pointerupoutside",touchmove:"pointermove",touchcancel:"pointercancel"},M=class e{constructor(t){this.supportsTouchEvents="ontouchstart"in globalThis,this.supportsPointerEvents=!!globalThis.PointerEvent,this.domElement=null,this.resolution=1,this.renderer=t,this.rootBoundary=new R(null),O.init(this),this.autoPreventDefault=!0,this.eventsAdded=!1,this.rootPointerEvent=new P(null),this.rootWheelEvent=new k(null),this.cursorStyles={default:"inherit",pointer:"pointer"},this.features=new Proxy({...e.defaultEventFeatures},{set:(e,t,r)=>("globalMove"===t&&(this.rootBoundary.enableGlobalMoveEvents=r),e[t]=r,!0)}),this.onPointerDown=this.onPointerDown.bind(this),this.onPointerMove=this.onPointerMove.bind(this),this.onPointerUp=this.onPointerUp.bind(this),this.onPointerOverOut=this.onPointerOverOut.bind(this),this.onWheel=this.onWheel.bind(this)}static get defaultEventMode(){return this._defaultEventMode}init(t){const{view:r,resolution:n}=this.renderer;this.setTargetElement(r),this.resolution=n,e._defaultEventMode=t.eventMode??"auto",Object.assign(this.features,t.eventFeatures??{}),this.rootBoundary.enableGlobalMoveEvents=this.features.globalMove}resolutionChange(e){this.resolution=e}destroy(){this.setTargetElement(null),this.renderer=null}setCursor(e){e=e||"default";let t=!0;if(globalThis.OffscreenCanvas&&this.domElement instanceof OffscreenCanvas&&(t=!1),this.currentCursor===e)return;this.currentCursor=e;const r=this.cursorStyles[e];if(r)switch(typeof r){case"string":t&&(this.domElement.style.cursor=r);break;case"function":r(e);break;case"object":t&&Object.assign(this.domElement.style,r)}else t&&"string"==typeof e&&!Object.prototype.hasOwnProperty.call(this.cursorStyles,e)&&(this.domElement.style.cursor=e)}get pointer(){return this.rootPointerEvent}onPointerDown(e){if(!this.features.click)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered;const t=this.normalizeToPointerData(e);this.autoPreventDefault&&t[0].isNormalized&&(e.cancelable||!("cancelable"in e))&&e.preventDefault();for(let e=0,r=t.length;e<r;e++){const r=t[e],n=this.bootstrapEvent(this.rootPointerEvent,r);this.rootBoundary.mapEvent(n)}this.setCursor(this.rootBoundary.cursor)}onPointerMove(e){if(!this.features.move)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,O.pointerMoved();const t=this.normalizeToPointerData(e);for(let e=0,r=t.length;e<r;e++){const r=this.bootstrapEvent(this.rootPointerEvent,t[e]);this.rootBoundary.mapEvent(r)}this.setCursor(this.rootBoundary.cursor)}onPointerUp(e){if(!this.features.click)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered;let t=e.target;e.composedPath&&e.composedPath().length>0&&(t=e.composedPath()[0]);const r=t!==this.domElement?"outside":"",n=this.normalizeToPointerData(e);for(let e=0,t=n.length;e<t;e++){const t=this.bootstrapEvent(this.rootPointerEvent,n[e]);t.type+=r,this.rootBoundary.mapEvent(t)}this.setCursor(this.rootBoundary.cursor)}onPointerOverOut(e){if(!this.features.click)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered;const t=this.normalizeToPointerData(e);for(let e=0,r=t.length;e<r;e++){const r=this.bootstrapEvent(this.rootPointerEvent,t[e]);this.rootBoundary.mapEvent(r)}this.setCursor(this.rootBoundary.cursor)}onWheel(e){if(!this.features.wheel)return;const t=this.normalizeWheelEvent(e);this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.rootBoundary.mapEvent(t)}setTargetElement(e){this.removeEvents(),this.domElement=e,O.domElement=e,this.addEvents()}addEvents(){if(this.eventsAdded||!this.domElement)return;O.addTickerListener();const e=this.domElement.style;e&&(globalThis.navigator.msPointerEnabled?(e.msContentZooming="none",e.msTouchAction="none"):this.supportsPointerEvents&&(e.touchAction="none")),this.supportsPointerEvents?(globalThis.document.addEventListener("pointermove",this.onPointerMove,!0),this.domElement.addEventListener("pointerdown",this.onPointerDown,!0),this.domElement.addEventListener("pointerleave",this.onPointerOverOut,!0),this.domElement.addEventListener("pointerover",this.onPointerOverOut,!0),globalThis.addEventListener("pointerup",this.onPointerUp,!0)):(globalThis.document.addEventListener("mousemove",this.onPointerMove,!0),this.domElement.addEventListener("mousedown",this.onPointerDown,!0),this.domElement.addEventListener("mouseout",this.onPointerOverOut,!0),this.domElement.addEventListener("mouseover",this.onPointerOverOut,!0),globalThis.addEventListener("mouseup",this.onPointerUp,!0),this.supportsTouchEvents&&(this.domElement.addEventListener("touchstart",this.onPointerDown,!0),this.domElement.addEventListener("touchend",this.onPointerUp,!0),this.domElement.addEventListener("touchmove",this.onPointerMove,!0))),this.domElement.addEventListener("wheel",this.onWheel,{passive:!0,capture:!0}),this.eventsAdded=!0}removeEvents(){if(!this.eventsAdded||!this.domElement)return;O.removeTickerListener();const e=this.domElement.style;globalThis.navigator.msPointerEnabled?(e.msContentZooming="",e.msTouchAction=""):this.supportsPointerEvents&&(e.touchAction=""),this.supportsPointerEvents?(globalThis.document.removeEventListener("pointermove",this.onPointerMove,!0),this.domElement.removeEventListener("pointerdown",this.onPointerDown,!0),this.domElement.removeEventListener("pointerleave",this.onPointerOverOut,!0),this.domElement.removeEventListener("pointerover",this.onPointerOverOut,!0),globalThis.removeEventListener("pointerup",this.onPointerUp,!0)):(globalThis.document.removeEventListener("mousemove",this.onPointerMove,!0),this.domElement.removeEventListener("mousedown",this.onPointerDown,!0),this.domElement.removeEventListener("mouseout",this.onPointerOverOut,!0),this.domElement.removeEventListener("mouseover",this.onPointerOverOut,!0),globalThis.removeEventListener("mouseup",this.onPointerUp,!0),this.supportsTouchEvents&&(this.domElement.removeEventListener("touchstart",this.onPointerDown,!0),this.domElement.removeEventListener("touchend",this.onPointerUp,!0),this.domElement.removeEventListener("touchmove",this.onPointerMove,!0))),this.domElement.removeEventListener("wheel",this.onWheel,!0),this.domElement=null,this.eventsAdded=!1}mapPositionToPoint(e,t,r){const n=this.domElement.isConnected?this.domElement.getBoundingClientRect():{x:0,y:0,width:this.domElement.width,height:this.domElement.height,left:0,top:0},i=1/this.resolution;e.x=(t-n.left)*(this.domElement.width/n.width)*i,e.y=(r-n.top)*(this.domElement.height/n.height)*i}normalizeToPointerData(e){const t=[];if(this.supportsTouchEvents&&e instanceof TouchEvent)for(let r=0,n=e.changedTouches.length;r<n;r++){const n=e.changedTouches[r];typeof n.button>"u"&&(n.button=0),typeof n.buttons>"u"&&(n.buttons=1),typeof n.isPrimary>"u"&&(n.isPrimary=1===e.touches.length&&"touchstart"===e.type),typeof n.width>"u"&&(n.width=n.radiusX||1),typeof n.height>"u"&&(n.height=n.radiusY||1),typeof n.tiltX>"u"&&(n.tiltX=0),typeof n.tiltY>"u"&&(n.tiltY=0),typeof n.pointerType>"u"&&(n.pointerType="touch"),typeof n.pointerId>"u"&&(n.pointerId=n.identifier||0),typeof n.pressure>"u"&&(n.pressure=n.force||.5),typeof n.twist>"u"&&(n.twist=0),typeof n.tangentialPressure>"u"&&(n.tangentialPressure=0),typeof n.layerX>"u"&&(n.layerX=n.offsetX=n.clientX),typeof n.layerY>"u"&&(n.layerY=n.offsetY=n.clientY),n.isNormalized=!0,n.type=e.type,t.push(n)}else if(globalThis.MouseEvent&&(!(e instanceof MouseEvent)||this.supportsPointerEvents&&e instanceof globalThis.PointerEvent))t.push(e);else{const r=e;typeof r.isPrimary>"u"&&(r.isPrimary=!0),typeof r.width>"u"&&(r.width=1),typeof r.height>"u"&&(r.height=1),typeof r.tiltX>"u"&&(r.tiltX=0),typeof r.tiltY>"u"&&(r.tiltY=0),typeof r.pointerType>"u"&&(r.pointerType="mouse"),typeof r.pointerId>"u"&&(r.pointerId=1),typeof r.pressure>"u"&&(r.pressure=.5),typeof r.twist>"u"&&(r.twist=0),typeof r.tangentialPressure>"u"&&(r.tangentialPressure=0),r.isNormalized=!0,t.push(r)}return t}normalizeWheelEvent(e){const t=this.rootWheelEvent;return this.transferMouseData(t,e),t.deltaX=e.deltaX,t.deltaY=e.deltaY,t.deltaZ=e.deltaZ,t.deltaMode=e.deltaMode,this.mapPositionToPoint(t.screen,e.clientX,e.clientY),t.global.copyFrom(t.screen),t.offset.copyFrom(t.screen),t.nativeEvent=e,t.type=e.type,t}bootstrapEvent(e,t){return e.originalEvent=null,e.nativeEvent=t,e.pointerId=t.pointerId,e.width=t.width,e.height=t.height,e.isPrimary=t.isPrimary,e.pointerType=t.pointerType,e.pressure=t.pressure,e.tangentialPressure=t.tangentialPressure,e.tiltX=t.tiltX,e.tiltY=t.tiltY,e.twist=t.twist,this.transferMouseData(e,t),this.mapPositionToPoint(e.screen,t.clientX,t.clientY),e.global.copyFrom(e.screen),e.offset.copyFrom(e.screen),e.isTrusted=t.isTrusted,"pointerleave"===e.type&&(e.type="pointerout"),e.type.startsWith("mouse")&&(e.type=e.type.replace("mouse","pointer")),e.type.startsWith("touch")&&(e.type=D[e.type]||e.type),e}transferMouseData(e,t){e.isTrusted=t.isTrusted,e.srcElement=t.srcElement,e.timeStamp=performance.now(),e.type=t.type,e.altKey=t.altKey,e.button=t.button,e.buttons=t.buttons,e.client.x=t.clientX,e.client.y=t.clientY,e.ctrlKey=t.ctrlKey,e.metaKey=t.metaKey,e.movement.x=t.movementX,e.movement.y=t.movementY,e.page.x=t.pageX,e.page.y=t.pageY,e.relatedTarget=null,e.shiftKey=t.shiftKey}};M.extension={name:"events",type:[n.Ag.RendererSystem,n.Ag.CanvasRendererSystem]},M.defaultEventFeatures={move:!0,globalMove:!0,click:!0,wheel:!0};let L=M;function B(e){return"dynamic"===e||"static"===e}n.XO.add(L);const N={onclick:null,onmousedown:null,onmouseenter:null,onmouseleave:null,onmousemove:null,onglobalmousemove:null,onmouseout:null,onmouseover:null,onmouseup:null,onmouseupoutside:null,onpointercancel:null,onpointerdown:null,onpointerenter:null,onpointerleave:null,onpointermove:null,onglobalpointermove:null,onpointerout:null,onpointerover:null,onpointertap:null,onpointerup:null,onpointerupoutside:null,onrightclick:null,onrightdown:null,onrightup:null,onrightupoutside:null,ontap:null,ontouchcancel:null,ontouchend:null,ontouchendoutside:null,ontouchmove:null,onglobaltouchmove:null,ontouchstart:null,onwheel:null,_internalInteractive:void 0,get interactive(){return this._internalInteractive??B(L.defaultEventMode)},set interactive(e){n.Wp.deprecation("7.2.0","Setting interactive is deprecated, use eventMode = 'none'/'passive'/'auto'/'static'/'dynamic' instead."),this._internalInteractive=e,this.eventMode=e?"static":"auto"},_internalEventMode:void 0,get eventMode(){return this._internalEventMode??L.defaultEventMode},set eventMode(e){this._internalInteractive=B(e),this._internalEventMode=e},isInteractive(){return"static"===this.eventMode||"dynamic"===this.eventMode},interactiveChildren:!0,hitArea:null,addEventListener(e,t,r){const n="boolean"==typeof r&&r||"object"==typeof r&&r.capture,i="object"==typeof r?r.signal:void 0,o="object"==typeof r&&!0===r.once,a="function"==typeof t?void 0:t;e=n?`${e}capture`:e;const s="function"==typeof t?t:t.handleEvent,u=this;i&&i.addEventListener("abort",(()=>{u.off(e,s,a)})),o?u.once(e,s,a):u.on(e,s,a)},removeEventListener(e,t,r){const n="function"==typeof t?void 0:t;e="boolean"==typeof r&&r||"object"==typeof r&&r.capture?`${e}capture`:e,t="function"==typeof t?t:t.handleEvent,this.off(e,t,n)},dispatchEvent(e){if(!(e instanceof A))throw new Error("DisplayObject cannot propagate events outside of the Federated Events API");return e.defaultPrevented=!1,e.path=null,e.target=this,e.manager.dispatchEvent(e),!e.defaultPrevented}};o.mixin(N);const F={accessible:!1,accessibleTitle:null,accessibleHint:null,tabIndex:0,_accessibleActive:!1,_accessibleDiv:null,accessibleType:"button",accessiblePointerEvents:"auto",accessibleChildren:!0,renderId:-1};o.mixin(F);class U{constructor(e){this.debug=!1,this._isActive=!1,this._isMobileAccessibility=!1,this.pool=[],this.renderId=0,this.children=[],this.androidUpdateCount=0,this.androidUpdateFrequency=500,this._hookDiv=null,(n.Wp.isMobile.tablet||n.Wp.isMobile.phone)&&this.createTouchHook();const t=document.createElement("div");t.style.width="100px",t.style.height="100px",t.style.position="absolute",t.style.top="0px",t.style.left="0px",t.style.zIndex=2..toString(),this.div=t,this.renderer=e,this._onKeyDown=this._onKeyDown.bind(this),this._onMouseMove=this._onMouseMove.bind(this),globalThis.addEventListener("keydown",this._onKeyDown,!1)}get isActive(){return this._isActive}get isMobileAccessibility(){return this._isMobileAccessibility}createTouchHook(){const e=document.createElement("button");e.style.width="1px",e.style.height="1px",e.style.position="absolute",e.style.top="-1000px",e.style.left="-1000px",e.style.zIndex=2..toString(),e.style.backgroundColor="#FF0000",e.title="select to enable accessibility for this content",e.addEventListener("focus",(()=>{this._isMobileAccessibility=!0,this.activate(),this.destroyTouchHook()})),document.body.appendChild(e),this._hookDiv=e}destroyTouchHook(){this._hookDiv&&(document.body.removeChild(this._hookDiv),this._hookDiv=null)}activate(){this._isActive||(this._isActive=!0,globalThis.document.addEventListener("mousemove",this._onMouseMove,!0),globalThis.removeEventListener("keydown",this._onKeyDown,!1),this.renderer.on("postrender",this.update,this),this.renderer.view.parentNode?.appendChild(this.div))}deactivate(){!this._isActive||this._isMobileAccessibility||(this._isActive=!1,globalThis.document.removeEventListener("mousemove",this._onMouseMove,!0),globalThis.addEventListener("keydown",this._onKeyDown,!1),this.renderer.off("postrender",this.update),this.div.parentNode?.removeChild(this.div))}updateAccessibleObjects(e){if(!e.visible||!e.accessibleChildren)return;e.accessible&&e.isInteractive()&&(e._accessibleActive||this.addChild(e),e.renderId=this.renderId);const t=e.children;if(t)for(let e=0;e<t.length;e++)this.updateAccessibleObjects(t[e])}update(){const e=performance.now();if(n.Wp.isMobile.android.device&&e<this.androidUpdateCount||(this.androidUpdateCount=e+this.androidUpdateFrequency,!this.renderer.renderingToScreen))return;this.renderer.lastObjectRendered&&this.updateAccessibleObjects(this.renderer.lastObjectRendered);const{x:t,y:r,width:i,height:o}=this.renderer.view.getBoundingClientRect(),{width:a,height:s,resolution:u}=this.renderer,l=i/a*u,h=o/s*u;let c=this.div;c.style.left=`${t}px`,c.style.top=`${r}px`,c.style.width=`${a}px`,c.style.height=`${s}px`;for(let e=0;e<this.children.length;e++){const t=this.children[e];if(t.renderId!==this.renderId)t._accessibleActive=!1,n.Wp.removeItems(this.children,e,1),this.div.removeChild(t._accessibleDiv),this.pool.push(t._accessibleDiv),t._accessibleDiv=null,e--;else{c=t._accessibleDiv;let e=t.hitArea;const r=t.worldTransform;t.hitArea?(c.style.left=(r.tx+e.x*r.a)*l+"px",c.style.top=(r.ty+e.y*r.d)*h+"px",c.style.width=e.width*r.a*l+"px",c.style.height=e.height*r.d*h+"px"):(e=t.getBounds(),this.capHitArea(e),c.style.left=e.x*l+"px",c.style.top=e.y*h+"px",c.style.width=e.width*l+"px",c.style.height=e.height*h+"px",c.title!==t.accessibleTitle&&null!==t.accessibleTitle&&(c.title=t.accessibleTitle),c.getAttribute("aria-label")!==t.accessibleHint&&null!==t.accessibleHint&&c.setAttribute("aria-label",t.accessibleHint)),(t.accessibleTitle!==c.title||t.tabIndex!==c.tabIndex)&&(c.title=t.accessibleTitle,c.tabIndex=t.tabIndex,this.debug&&this.updateDebugHTML(c))}}this.renderId++}updateDebugHTML(e){e.innerHTML=`type: ${e.type}</br> title : ${e.title}</br> tabIndex: ${e.tabIndex}`}capHitArea(e){e.x<0&&(e.width+=e.x,e.x=0),e.y<0&&(e.height+=e.y,e.y=0);const{width:t,height:r}=this.renderer;e.x+e.width>t&&(e.width=t-e.x),e.y+e.height>r&&(e.height=r-e.y)}addChild(e){let t=this.pool.pop();t||(t=document.createElement("button"),t.style.width="100px",t.style.height="100px",t.style.backgroundColor=this.debug?"rgba(255,255,255,0.5)":"transparent",t.style.position="absolute",t.style.zIndex=2..toString(),t.style.borderStyle="none",navigator.userAgent.toLowerCase().includes("chrome")?t.setAttribute("aria-live","off"):t.setAttribute("aria-live","polite"),navigator.userAgent.match(/rv:.*Gecko\//)?t.setAttribute("aria-relevant","additions"):t.setAttribute("aria-relevant","text"),t.addEventListener("click",this._onClick.bind(this)),t.addEventListener("focus",this._onFocus.bind(this)),t.addEventListener("focusout",this._onFocusOut.bind(this))),t.style.pointerEvents=e.accessiblePointerEvents,t.type=e.accessibleType,e.accessibleTitle&&null!==e.accessibleTitle?t.title=e.accessibleTitle:(!e.accessibleHint||null===e.accessibleHint)&&(t.title=`displayObject ${e.tabIndex}`),e.accessibleHint&&null!==e.accessibleHint&&t.setAttribute("aria-label",e.accessibleHint),this.debug&&this.updateDebugHTML(t),e._accessibleActive=!0,e._accessibleDiv=t,t.displayObject=e,this.children.push(e),this.div.appendChild(e._accessibleDiv),e._accessibleDiv.tabIndex=e.tabIndex}_dispatchEvent(e,t){const{displayObject:r}=e.target,n=this.renderer.events.rootBoundary,i=Object.assign(new A(n),{target:r});n.rootTarget=this.renderer.lastObjectRendered,t.forEach((e=>n.dispatchEvent(i,e)))}_onClick(e){this._dispatchEvent(e,["click","pointertap","tap"])}_onFocus(e){e.target.getAttribute("aria-live")||e.target.setAttribute("aria-live","assertive"),this._dispatchEvent(e,["mouseover"])}_onFocusOut(e){e.target.getAttribute("aria-live")||e.target.setAttribute("aria-live","polite"),this._dispatchEvent(e,["mouseout"])}_onKeyDown(e){9===e.keyCode&&this.activate()}_onMouseMove(e){0===e.movementX&&0===e.movementY||this.deactivate()}destroy(){this.destroyTouchHook(),this.div=null,globalThis.document.removeEventListener("mousemove",this._onMouseMove,!0),globalThis.removeEventListener("keydown",this._onKeyDown),this.pool=null,this.children=null,this.renderer=null}}U.extension={name:"accessibility",type:[n.Ag.RendererPlugin,n.Ag.CanvasRendererPlugin]},n.XO.add(U);const j=class e{constructor(t){this.stage=new h,t=Object.assign({forceCanvas:!1},t),this.renderer=(0,n.q5)(t),e._plugins.forEach((e=>{e.init.call(this,t)}))}render(){this.renderer.render(this.stage)}get view(){return this.renderer?.view}get screen(){return this.renderer?.screen}destroy(t,r){const n=e._plugins.slice(0);n.reverse(),n.forEach((e=>{e.destroy.call(this)})),this.stage.destroy(r),this.stage=null,this.renderer.destroy(t),this.renderer=null}};j._plugins=[];let z=j;n.XO.handleByList(n.Ag.Application,z._plugins);class G{static init(e){Object.defineProperty(this,"resizeTo",{set(e){globalThis.removeEventListener("resize",this.queueResize),this._resizeTo=e,e&&(globalThis.addEventListener("resize",this.queueResize),this.resize())},get(){return this._resizeTo}}),this.queueResize=()=>{this._resizeTo&&(this.cancelResize(),this._resizeId=requestAnimationFrame((()=>this.resize())))},this.cancelResize=()=>{this._resizeId&&(cancelAnimationFrame(this._resizeId),this._resizeId=null)},this.resize=()=>{if(!this._resizeTo)return;let e,t;if(this.cancelResize(),this._resizeTo===globalThis.window)e=globalThis.innerWidth,t=globalThis.innerHeight;else{const{clientWidth:r,clientHeight:n}=this._resizeTo;e=r,t=n}this.renderer.resize(e,t),this.render()},this._resizeId=null,this._resizeTo=null,this.resizeTo=e.resizeTo||null}static destroy(){globalThis.removeEventListener("resize",this.queueResize),this.cancelResize(),this.cancelResize=null,this.queueResize=null,this.resizeTo=null,this.resize=null}}G.extension=n.Ag.Application,n.XO.add(G);const V={loader:n.Ag.LoadParser,resolver:n.Ag.ResolveParser,cache:n.Ag.CacheParser,detection:n.Ag.DetectionParser};n.XO.handle(n.Ag.Asset,(e=>{const t=e.ref;Object.entries(V).filter((([e])=>!!t[e])).forEach((([e,r])=>n.XO.add(Object.assign(t[e],{extension:t[e].extension??r}))))}),(e=>{const t=e.ref;Object.keys(V).filter((e=>!!t[e])).forEach((e=>n.XO.remove(t[e])))}));class W{constructor(e,t=!1){this._loader=e,this._assetList=[],this._isLoading=!1,this._maxConcurrent=1,this.verbose=t}add(e){e.forEach((e=>{this._assetList.push(e)})),this.verbose&&console.log("[BackgroundLoader] assets: ",this._assetList),this._isActive&&!this._isLoading&&this._next()}async _next(){if(this._assetList.length&&this._isActive){this._isLoading=!0;const e=[],t=Math.min(this._assetList.length,this._maxConcurrent);for(let r=0;r<t;r++)e.push(this._assetList.pop());await this._loader.load(e),this._isLoading=!1,this._next()}}get active(){return this._isActive}set active(e){this._isActive!==e&&(this._isActive=e,e&&!this._isLoading&&this._next())}}function H(e,t){const r=e.split("?")[0],i=n.Wp.path.extname(r).toLowerCase();return Array.isArray(t)?t.includes(i):i===t}const q=(e,t,r=!1)=>(Array.isArray(e)||(e=[e]),t?e.map((e=>"string"==typeof e||r?t(e):e)):e);const Y=new class{constructor(){this._parsers=[],this._cache=new Map,this._cacheMap=new Map}reset(){this._cacheMap.clear(),this._cache.clear()}has(e){return this._cache.has(e)}get(e){const t=this._cache.get(e);return t||console.warn(`[Assets] Asset id ${e} was not found in the Cache`),t}set(e,t){const r=q(e);let i;for(let e=0;e<this.parsers.length;e++){const n=this.parsers[e];if(n.test(t)){i=n.getCacheableAssets(r,t);break}}i||(i={},r.forEach((e=>{i[e]=t})));const o=Object.keys(i),a={cacheKeys:o,keys:r};if(r.forEach((e=>{this._cacheMap.set(e,a)})),o.forEach((e=>{this._cache.has(e)&&this._cache.get(e)!==t&&console.warn("[Cache] already has key:",e),this._cache.set(e,i[e])})),t instanceof n.gP){const e=t;r.forEach((t=>{e.baseTexture!==n.gP.EMPTY.baseTexture&&n.t5.addToCache(e.baseTexture,t),n.gP.addToCache(e,t)}))}}remove(e){if(!this._cacheMap.has(e))return void console.warn(`[Assets] Asset id ${e} was not found in the Cache`);const t=this._cacheMap.get(e);t.cacheKeys.forEach((e=>{this._cache.delete(e)})),t.keys.forEach((e=>{this._cacheMap.delete(e)}))}get parsers(){return this._parsers}},X=e=>!Array.isArray(e);class K{constructor(){this._parsers=[],this._parsersValidated=!1,this.parsers=new Proxy(this._parsers,{set:(e,t,r)=>(this._parsersValidated=!1,e[t]=r,!0)}),this.promiseCache={}}reset(){this._parsersValidated=!1,this.promiseCache={}}_getLoadPromiseAndParser(e,t){const r={promise:null,parser:null};return r.promise=(async()=>{let n=null,i=null;if(t.loadParser&&(i=this._parserHash[t.loadParser],i||console.warn(`[Assets] specified load parser "${t.loadParser}" not found while loading ${e}`)),!i){for(let r=0;r<this.parsers.length;r++){const n=this.parsers[r];if(n.load&&n.test?.(e,t,this)){i=n;break}}if(!i)return console.warn(`[Assets] ${e} could not be loaded as we don't know how to parse it, ensure the correct parser has been added`),null}n=await i.load(e,t,this),r.parser=i;for(let e=0;e<this.parsers.length;e++){const i=this.parsers[e];i.parse&&i.parse&&await(i.testParse?.(n,t,this))&&(n=await i.parse(n,t,this)||n,r.parser=i)}return n})(),r}async load(e,t){this._parsersValidated||this._validateParsers();let r=0;const i={},o=X(e),a=q(e,(e=>({alias:[e],src:e}))),s=a.length,u=a.map((async e=>{const o=n.Wp.path.toAbsolute(e.src);if(!i[e.src])try{this.promiseCache[o]||(this.promiseCache[o]=this._getLoadPromiseAndParser(o,e)),i[e.src]=await this.promiseCache[o].promise,t&&t(++r/s)}catch(t){throw delete this.promiseCache[o],delete i[e.src],new Error(`[Loader.load] Failed to load ${o}.\n${t}`)}}));return await Promise.all(u),o?i[a[0].src]:i}async unload(e){const t=q(e,(e=>({alias:[e],src:e}))).map((async e=>{const t=n.Wp.path.toAbsolute(e.src),r=this.promiseCache[t];if(r){const n=await r.promise;delete this.promiseCache[t],r.parser?.unload?.(n,e,this)}}));await Promise.all(t)}_validateParsers(){this._parsersValidated=!0,this._parserHash=this._parsers.filter((e=>e.name)).reduce(((e,t)=>(e[t.name]&&console.warn(`[Assets] loadParser name conflict "${t.name}"`),{...e,[t.name]:t})),{})}}var Z=(e=>(e[e.Low=0]="Low",e[e.Normal=1]="Normal",e[e.High=2]="High",e))(Z||{});function J(e,t){if(Array.isArray(t)){for(const r of t)if(e.startsWith(`data:${r}`))return!0;return!1}return e.startsWith(`data:${t}`)}const Q={extension:{type:n.Ag.LoadParser,priority:Z.Low},name:"loadJson",test:e=>J(e,"application/json")||H(e,".json"),load:async e=>await(await n.W0.ADAPTER.fetch(e)).json()};n.XO.add(Q);const ee={name:"loadTxt",extension:{type:n.Ag.LoadParser,priority:Z.Low},test:e=>J(e,"text/plain")||H(e,".txt"),load:async e=>await(await n.W0.ADAPTER.fetch(e)).text()};n.XO.add(ee);const te=["normal","bold","100","200","300","400","500","600","700","800","900"],re=[".ttf",".otf",".woff",".woff2"],ne=["font/ttf","font/otf","font/woff","font/woff2"],ie=/^(--|-?[A-Z_])[0-9A-Z_-]*$/i;function oe(e){const t=n.Wp.path.extname(e),r=n.Wp.path.basename(e,t).replace(/(-|_)/g," ").toLowerCase().split(" ").map((e=>e.charAt(0).toUpperCase()+e.slice(1)));let i=r.length>0;for(const e of r)if(!e.match(ie)){i=!1;break}let o=r.join(" ");return i||(o=`"${o.replace(/[\\"]/g,"\\$&")}"`),o}const ae=/^[0-9A-Za-z%:/?#\[\]@!\$&'()\*\+,;=\-._~]*$/;const se={extension:{type:n.Ag.LoadParser,priority:Z.Low},name:"loadWebFont",test:e=>J(e,ne)||H(e,re),async load(e,t){const r=n.W0.ADAPTER.getFontFaceSet();if(r){const n=[],o=t.data?.family??oe(e),a=t.data?.weights?.filter((e=>te.includes(e)))??["normal"],s=t.data??{};for(let t=0;t<a.length;t++){const u=a[t],l=new FontFace(o,`url(${i=e,ae.test(i)?i:encodeURI(i)})`,{...s,weight:u});await l.load(),r.add(l),n.push(l)}return 1===n.length?n[0]:n}var i;return console.warn("[loadWebFont] FontFace API is not supported. Skipping loading font"),null},unload(e){(Array.isArray(e)?e:[e]).forEach((e=>n.W0.ADAPTER.getFontFaceSet().delete(e)))}};n.XO.add(se);let ue=null;class le{constructor(){ue||(ue=URL.createObjectURL(new Blob(['(function() {\n  "use strict";\n  const WHITE_PNG = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mP8/x8AAwMCAO+ip1sAAAAASUVORK5CYII=";\n  async function checkImageBitmap() {\n    try {\n      if (typeof createImageBitmap != "function")\n        return !1;\n      const imageBlob = await (await fetch(WHITE_PNG)).blob(), imageBitmap = await createImageBitmap(imageBlob);\n      return imageBitmap.width === 1 && imageBitmap.height === 1;\n    } catch {\n      return !1;\n    }\n  }\n  checkImageBitmap().then((result) => {\n    self.postMessage(result);\n  });\n})();\n'],{type:"application/javascript"}))),this.worker=new Worker(ue)}}le.revokeObjectURL=function(){ue&&(URL.revokeObjectURL(ue),ue=null)};let he=null;class ce{constructor(){he||(he=URL.createObjectURL(new Blob(['(function() {\n  "use strict";\n  async function loadImageBitmap(url) {\n    const response = await fetch(url);\n    if (!response.ok)\n      throw new Error(`[WorkerManager.loadImageBitmap] Failed to fetch ${url}: ${response.status} ${response.statusText}`);\n    const imageBlob = await response.blob();\n    return await createImageBitmap(imageBlob);\n  }\n  self.onmessage = async (event) => {\n    try {\n      const imageBitmap = await loadImageBitmap(event.data.data[0]);\n      self.postMessage({\n        data: imageBitmap,\n        uuid: event.data.uuid,\n        id: event.data.id\n      }, [imageBitmap]);\n    } catch (e) {\n      self.postMessage({\n        error: e,\n        uuid: event.data.uuid,\n        id: event.data.id\n      });\n    }\n  };\n})();\n'],{type:"application/javascript"}))),this.worker=new Worker(he)}}ce.revokeObjectURL=function(){he&&(URL.revokeObjectURL(he),he=null)};let fe,de=0;const pe=new class{constructor(){this._initialized=!1,this._createdWorkers=0,this.workerPool=[],this.queue=[],this.resolveHash={}}isImageBitmapSupported(){return void 0!==this._isImageBitmapSupported||(this._isImageBitmapSupported=new Promise((e=>{const{worker:t}=new le;t.addEventListener("message",(r=>{t.terminate(),le.revokeObjectURL(),e(r.data)}))}))),this._isImageBitmapSupported}loadImageBitmap(e){return this._run("loadImageBitmap",[e])}async _initWorkers(){this._initialized||(this._initialized=!0)}getWorker(){void 0===fe&&(fe=navigator.hardwareConcurrency||4);let e=this.workerPool.pop();return!e&&this._createdWorkers<fe&&(this._createdWorkers++,e=(new ce).worker,e.addEventListener("message",(e=>{this.complete(e.data),this.returnWorker(e.target),this.next()}))),e}returnWorker(e){this.workerPool.push(e)}complete(e){void 0!==e.error?this.resolveHash[e.uuid].reject(e.error):this.resolveHash[e.uuid].resolve(e.data),this.resolveHash[e.uuid]=null}async _run(e,t){await this._initWorkers();const r=new Promise(((r,n)=>{this.queue.push({id:e,arguments:t,resolve:r,reject:n})}));return this.next(),r}next(){if(!this.queue.length)return;const e=this.getWorker();if(!e)return;const t=this.queue.pop(),r=t.id;this.resolveHash[de]={resolve:t.resolve,reject:t.reject},e.postMessage({data:t.arguments,uuid:de++,id:r})}};function ye(e,t,r){e.resource.internal=!0;const i=new n.gP(e),o=()=>{delete t.promiseCache[r],Y.has(r)&&Y.remove(r)};return i.baseTexture.once("destroyed",(()=>{r in t.promiseCache&&(console.warn("[Assets] A BaseTexture managed by Assets was destroyed instead of unloaded! Use Assets.unload() instead of destroying the BaseTexture."),o())})),i.once("destroyed",(()=>{e.destroyed||(console.warn("[Assets] A Texture managed by Assets was destroyed instead of unloaded! Use Assets.unload() instead of destroying the Texture."),o())})),i}const me=[".jpeg",".jpg",".png",".webp",".avif"],ge=["image/jpeg","image/png","image/webp","image/avif"];async function we(e){const t=await n.W0.ADAPTER.fetch(e);if(!t.ok)throw new Error(`[loadImageBitmap] Failed to fetch ${e}: ${t.status} ${t.statusText}`);const r=await t.blob();return await createImageBitmap(r)}const ve={name:"loadTextures",extension:{type:n.Ag.LoadParser,priority:Z.High},config:{preferWorkers:!0,preferCreateImageBitmap:!0,crossOrigin:"anonymous"},test:e=>J(e,ge)||H(e,me),async load(e,t,r){const i=globalThis.createImageBitmap&&this.config.preferCreateImageBitmap;let o;o=i?this.config.preferWorkers&&await pe.isImageBitmapSupported()?await pe.loadImageBitmap(e):await we(e):await new Promise(((t,r)=>{const n=new Image;n.crossOrigin=this.config.crossOrigin,n.src=e,n.complete?t(n):(n.onload=()=>t(n),n.onerror=e=>r(e))}));const a={...t.data};a.resolution??(a.resolution=n.Wp.getResolutionOfUrl(e)),i&&void 0===a.resourceOptions?.ownsImageBitmap&&(a.resourceOptions={...a.resourceOptions},a.resourceOptions.ownsImageBitmap=!0);const s=new n.t5(o,a);return s.resource.src=e,ye(s,r,e)},unload(e){e.destroy(!0)}};n.XO.add(ve);const be={extension:{type:n.Ag.LoadParser,priority:Z.High},name:"loadSVG",test:e=>J(e,"image/svg+xml")||H(e,".svg"),testParse:async e=>n.$f.test(e),async parse(e,t,r){const i=new n.$f(e,t?.data?.resourceOptions);await i.load();const o=new n.t5(i,{resolution:n.Wp.getResolutionOfUrl(e),...t?.data});return o.resource.src=t.src,ye(o,r,t.src)},load:async(e,t)=>(await n.W0.ADAPTER.fetch(e)).text(),unload:ve.unload};n.XO.add(be);const xe=[".mp4",".m4v",".webm",".ogv"],_e=["video/mp4","video/webm","video/ogg"],Se={name:"loadVideo",extension:{type:n.Ag.LoadParser,priority:Z.High},config:{defaultAutoPlay:!0,defaultUpdateFPS:0,defaultLoop:!1,defaultMuted:!1,defaultPlaysinline:!0},test:e=>J(e,_e)||H(e,xe),async load(e,t,r){let i;const o=await(await n.W0.ADAPTER.fetch(e)).blob(),a=URL.createObjectURL(o);try{const o={autoPlay:this.config.defaultAutoPlay,updateFPS:this.config.defaultUpdateFPS,loop:this.config.defaultLoop,muted:this.config.defaultMuted,playsinline:this.config.defaultPlaysinline,...t?.data?.resourceOptions,autoLoad:!0},s=new n.A5(a,o);await s.load();const u=new n.t5(s,{alphaMode:await n.Wp.detectVideoAlphaMode(),resolution:n.Wp.getResolutionOfUrl(e),...t?.data});u.resource.src=e,i=ye(u,r,e),i.baseTexture.once("destroyed",(()=>{URL.revokeObjectURL(a)}))}catch(e){throw URL.revokeObjectURL(a),e}return i},unload(e){e.destroy(!0)}};function Te(e,t,r,n,i){const o=t[r];for(let a=0;a<o.length;a++){const s=o[a];r<t.length-1?Te(e.replace(n[r],s),t,r+1,n,i):i.push(e.replace(n[r],s))}}function Ee(e){const t=e.match(/\{(.*?)\}/g),r=[];if(t){const n=[];t.forEach((e=>{const t=e.substring(1,e.length-1).split(",");n.push(t)})),Te(e,n,0,t,r)}else r.push(e);return r}n.XO.add(Se);class Oe{constructor(){this._defaultBundleIdentifierOptions={connector:"-",createBundleAssetId:(e,t)=>`${e}${this._bundleIdConnector}${t}`,extractAssetIdFromBundle:(e,t)=>t.replace(`${e}${this._bundleIdConnector}`,"")},this._bundleIdConnector=this._defaultBundleIdentifierOptions.connector,this._createBundleAssetId=this._defaultBundleIdentifierOptions.createBundleAssetId,this._extractAssetIdFromBundle=this._defaultBundleIdentifierOptions.extractAssetIdFromBundle,this._assetMap={},this._preferredOrder=[],this._parsers=[],this._resolverHash={},this._bundles={}}setBundleIdentifier(e){if(this._bundleIdConnector=e.connector??this._bundleIdConnector,this._createBundleAssetId=e.createBundleAssetId??this._createBundleAssetId,this._extractAssetIdFromBundle=e.extractAssetIdFromBundle??this._extractAssetIdFromBundle,"bar"!==this._extractAssetIdFromBundle("foo",this._createBundleAssetId("foo","bar")))throw new Error("[Resolver] GenerateBundleAssetId are not working correctly")}prefer(...e){e.forEach((e=>{this._preferredOrder.push(e),e.priority||(e.priority=Object.keys(e.params))})),this._resolverHash={}}set basePath(e){this._basePath=e}get basePath(){return this._basePath}set rootPath(e){this._rootPath=e}get rootPath(){return this._rootPath}get parsers(){return this._parsers}reset(){this.setBundleIdentifier(this._defaultBundleIdentifierOptions),this._assetMap={},this._preferredOrder=[],this._resolverHash={},this._rootPath=null,this._basePath=null,this._manifest=null,this._bundles={},this._defaultSearchParams=null}setDefaultSearchParams(e){if("string"==typeof e)this._defaultSearchParams=e;else{const t=e;this._defaultSearchParams=Object.keys(t).map((e=>`${encodeURIComponent(e)}=${encodeURIComponent(t[e])}`)).join("&")}}getAlias(e){const{alias:t,name:r,src:n,srcs:i}=e;return q(t||r||n||i,(e=>"string"==typeof e?e:Array.isArray(e)?e.map((e=>e?.src??e?.srcs??e)):e?.src||e?.srcs?e.src??e.srcs:e),!0)}addManifest(e){this._manifest&&console.warn("[Resolver] Manifest already exists, this will be overwritten"),this._manifest=e,e.bundles.forEach((e=>{this.addBundle(e.name,e.assets)}))}addBundle(e,t){const r=[];Array.isArray(t)?t.forEach((t=>{const n=t.src??t.srcs,i=t.alias??t.name;let o;if("string"==typeof i){const t=this._createBundleAssetId(e,i);r.push(t),o=[i,t]}else{const t=i.map((t=>this._createBundleAssetId(e,t)));r.push(...t),o=[...i,...t]}this.add({...t,alias:o,src:n})})):Object.keys(t).forEach((n=>{const i=[n,this._createBundleAssetId(e,n)];if("string"==typeof t[n])this.add({alias:i,src:t[n]});else if(Array.isArray(t[n]))this.add({alias:i,src:t[n]});else{const e=t[n],r=e.src??e.srcs;this.add({...e,alias:i,src:Array.isArray(r)?r:[r]})}r.push(...i)})),this._bundles[e]=r}add(e,t,r,i,o){const a=[];let s;"string"==typeof e||Array.isArray(e)&&"string"==typeof e[0]?(n.Wp.deprecation("7.2.0","Assets.add now uses an object instead of individual parameters.\nPlease use Assets.add({ alias, src, data, format, loadParser }) instead."),a.push({alias:e,src:t,data:r,format:i,loadParser:o})):Array.isArray(e)?a.push(...e):a.push(e),s=e=>{this.hasKey(e)&&console.warn(`[Resolver] already has key: ${e} overwriting`)},q(a).forEach((e=>{const{src:t,srcs:r}=e;let{data:n,format:i,loadParser:o}=e;const a=q(t||r).map((e=>"string"==typeof e?Ee(e):Array.isArray(e)?e:[e])),u=this.getAlias(e);Array.isArray(u)?u.forEach(s):s(u);const l=[];a.forEach((e=>{e.forEach((e=>{let t={};if("object"!=typeof e){t.src=e;for(let r=0;r<this._parsers.length;r++){const n=this._parsers[r];if(n.test(e)){t=n.parse(e);break}}}else n=e.data??n,i=e.format??i,o=e.loadParser??o,t={...t,...e};if(!u)throw new Error(`[Resolver] alias is undefined for this asset: ${t.src}`);t=this.buildResolvedAsset(t,{aliases:u,data:n,format:i,loadParser:o}),l.push(t)}))})),u.forEach((e=>{this._assetMap[e]=l}))}))}resolveBundle(e){const t=X(e);e=q(e);const r={};return e.forEach((e=>{const t=this._bundles[e];if(t){const n=this.resolve(t),i={};for(const t in n){const r=n[t];i[this._extractAssetIdFromBundle(e,t)]=r}r[e]=i}})),t?r[e[0]]:r}resolveUrl(e){const t=this.resolve(e);if("string"!=typeof e){const e={};for(const r in t)e[r]=t[r].src;return e}return t.src}resolve(e){const t=X(e);e=q(e);const r={};return e.forEach((e=>{if(!this._resolverHash[e])if(this._assetMap[e]){let t=this._assetMap[e];const r=t[0],n=this._getPreferredOrder(t);n?.priority.forEach((e=>{n.params[e].forEach((r=>{const n=t.filter((t=>!!t[e]&&t[e]===r));n.length&&(t=n)}))})),this._resolverHash[e]=t[0]??r}else this._resolverHash[e]=this.buildResolvedAsset({alias:[e],src:e},{});r[e]=this._resolverHash[e]})),t?r[e[0]]:r}hasKey(e){return!!this._assetMap[e]}hasBundle(e){return!!this._bundles[e]}_getPreferredOrder(e){for(let t=0;t<e.length;t++){const t=e[0],r=this._preferredOrder.find((e=>e.params.format.includes(t.format)));if(r)return r}return this._preferredOrder[0]}_appendDefaultSearchParams(e){if(!this._defaultSearchParams)return e;return`${e}${/\?/.test(e)?"&":"?"}${this._defaultSearchParams}`}buildResolvedAsset(e,t){const{aliases:r,data:i,loadParser:o,format:a}=t;return(this._basePath||this._rootPath)&&(e.src=n.Wp.path.toAbsolute(e.src,this._basePath,this._rootPath)),e.alias=r??e.alias??[e.src],e.src=this._appendDefaultSearchParams(e.src),e.data={...i||{},...e.data},e.loadParser=o??e.loadParser,e.format=a??e.format??n.Wp.path.extname(e.src).slice(1),e.srcs=e.src,e.name=e.alias,e}}class Ae{constructor(){this._detections=[],this._initialized=!1,this.resolver=new Oe,this.loader=new K,this.cache=Y,this._backgroundLoader=new W(this.loader),this._backgroundLoader.active=!0,this.reset()}async init(e={}){if(this._initialized)return void console.warn("[Assets]AssetManager already initialized, did you load before calling this Assets.init()?");if(this._initialized=!0,e.defaultSearchParams&&this.resolver.setDefaultSearchParams(e.defaultSearchParams),e.basePath&&(this.resolver.basePath=e.basePath),e.bundleIdentifier&&this.resolver.setBundleIdentifier(e.bundleIdentifier),e.manifest){let t=e.manifest;"string"==typeof t&&(t=await this.load(t)),this.resolver.addManifest(t)}const t=e.texturePreference?.resolution??1,r="number"==typeof t?[t]:t,n=await this._detectFormats({preferredFormats:e.texturePreference?.format,skipDetections:e.skipDetections,detections:this._detections});this.resolver.prefer({params:{format:n,resolution:r}}),e.preferences&&this.setPreferences(e.preferences)}add(e,t,r,n,i){this.resolver.add(e,t,r,n,i)}async load(e,t){this._initialized||await this.init();const r=X(e),n=q(e).map((e=>{if("string"!=typeof e){const t=this.resolver.getAlias(e);return t.some((e=>!this.resolver.hasKey(e)))&&this.add(e),Array.isArray(t)?t[0]:t}return this.resolver.hasKey(e)||this.add({alias:e,src:e}),e})),i=this.resolver.resolve(n),o=await this._mapLoadToResolve(i,t);return r?o[n[0]]:o}addBundle(e,t){this.resolver.addBundle(e,t)}async loadBundle(e,t){this._initialized||await this.init();let r=!1;"string"==typeof e&&(r=!0,e=[e]);const n=this.resolver.resolveBundle(e),i={},o=Object.keys(n);let a=0,s=0;const u=()=>{t?.(++a/s)},l=o.map((e=>{const t=n[e];return s+=Object.keys(t).length,this._mapLoadToResolve(t,u).then((t=>{i[e]=t}))}));return await Promise.all(l),r?i[e[0]]:i}async backgroundLoad(e){this._initialized||await this.init(),"string"==typeof e&&(e=[e]);const t=this.resolver.resolve(e);this._backgroundLoader.add(Object.values(t))}async backgroundLoadBundle(e){this._initialized||await this.init(),"string"==typeof e&&(e=[e]);const t=this.resolver.resolveBundle(e);Object.values(t).forEach((e=>{this._backgroundLoader.add(Object.values(e))}))}reset(){this.resolver.reset(),this.loader.reset(),this.cache.reset(),this._initialized=!1}get(e){if("string"==typeof e)return Y.get(e);const t={};for(let r=0;r<e.length;r++)t[r]=Y.get(e[r]);return t}async _mapLoadToResolve(e,t){const r=Object.values(e),n=Object.keys(e);this._backgroundLoader.active=!1;const i=await this.loader.load(r,t);this._backgroundLoader.active=!0;const o={};return r.forEach(((e,t)=>{const r=i[e.src],a=[e.src];e.alias&&a.push(...e.alias),o[n[t]]=r,Y.set(a,r)})),o}async unload(e){this._initialized||await this.init();const t=q(e).map((e=>"string"!=typeof e?e.src:e)),r=this.resolver.resolve(t);await this._unloadFromResolved(r)}async unloadBundle(e){this._initialized||await this.init(),e=q(e);const t=this.resolver.resolveBundle(e),r=Object.keys(t).map((e=>this._unloadFromResolved(t[e])));await Promise.all(r)}async _unloadFromResolved(e){const t=Object.values(e);t.forEach((e=>{Y.remove(e.src)})),await this.loader.unload(t)}async _detectFormats(e){let t=[];e.preferredFormats&&(t=Array.isArray(e.preferredFormats)?e.preferredFormats:[e.preferredFormats]);for(const r of e.detections)e.skipDetections||await r.test()?t=await r.add(t):e.skipDetections||(t=await r.remove(t));return t=t.filter(((e,r)=>t.indexOf(e)===r)),t}get detections(){return this._detections}get preferWorkers(){return ve.config.preferWorkers}set preferWorkers(e){n.Wp.deprecation("7.2.0","Assets.prefersWorkers is deprecated, use Assets.setPreferences({ preferWorkers: true }) instead."),this.setPreferences({preferWorkers:e})}setPreferences(e){this.loader.parsers.forEach((t=>{t.config&&Object.keys(t.config).filter((t=>t in e)).forEach((r=>{t.config[r]=e[r]}))}))}}const Ie=new Ae;n.XO.handleByList(n.Ag.LoadParser,Ie.loader.parsers).handleByList(n.Ag.ResolveParser,Ie.resolver.parsers).handleByList(n.Ag.CacheParser,Ie.cache.parsers).handleByList(n.Ag.DetectionParser,Ie.detections);const Pe={extension:n.Ag.CacheParser,test:e=>Array.isArray(e)&&e.every((e=>e instanceof n.gP)),getCacheableAssets:(e,t)=>{const r={};return e.forEach((e=>{t.forEach(((t,n)=>{r[e+(0===n?"":n+1)]=t}))})),r}};async function ke(e){if("Image"in globalThis)return new Promise((t=>{const r=new Image;r.onload=()=>{t(!0)},r.onerror=()=>{t(!1)},r.src=e}));if("createImageBitmap"in globalThis&&"fetch"in globalThis){try{const t=await(await fetch(e)).blob();await createImageBitmap(t)}catch{return!1}return!0}return!1}n.XO.add(Pe);const Ce={extension:{type:n.Ag.DetectionParser,priority:1},test:async()=>ke("data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAAB0AAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAIAAAACAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQ0MAAAAABNjb2xybmNseAACAAIAAYAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAACVtZGF0EgAKCBgANogQEAwgMg8f8D///8WfhwB8+ErK42A="),add:async e=>[...e,"avif"],remove:async e=>e.filter((e=>"avif"!==e))};n.XO.add(Ce);const $e={extension:{type:n.Ag.DetectionParser,priority:0},test:async()=>ke("data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAAAAAAfQ//73v/+BiOh/AAA="),add:async e=>[...e,"webp"],remove:async e=>e.filter((e=>"webp"!==e))};n.XO.add($e);const Re=["png","jpg","jpeg"],De={extension:{type:n.Ag.DetectionParser,priority:-1},test:()=>Promise.resolve(!0),add:async e=>[...e,...Re],remove:async e=>e.filter((e=>!Re.includes(e)))};n.XO.add(De);const Me="WorkerGlobalScope"in globalThis&&globalThis instanceof globalThis.WorkerGlobalScope;function Le(e){return!Me&&""!==document.createElement("video").canPlayType(e)}const Be={extension:{type:n.Ag.DetectionParser,priority:0},test:async()=>Le("video/webm"),add:async e=>[...e,"webm"],remove:async e=>e.filter((e=>"webm"!==e))};n.XO.add(Be);const Ne={extension:{type:n.Ag.DetectionParser,priority:0},test:async()=>Le("video/mp4"),add:async e=>[...e,"mp4","m4v"],remove:async e=>e.filter((e=>"mp4"!==e&&"m4v"!==e))};n.XO.add(Ne);const Fe={extension:{type:n.Ag.DetectionParser,priority:0},test:async()=>Le("video/ogg"),add:async e=>[...e,"ogv"],remove:async e=>e.filter((e=>"ogv"!==e))};n.XO.add(Fe);const Ue={extension:n.Ag.ResolveParser,test:ve.test,parse:e=>({resolution:parseFloat(n.W0.RETINA_PREFIX.exec(e)?.[1]??"1"),format:n.Wp.path.extname(e).slice(1),src:e})};n.XO.add(Ue);const je=(e,t)=>{const r=t.split("?")[1];return r&&(e+=`?${r}`),e};var ze=(e=>(e[e.COMPRESSED_RGB_S3TC_DXT1_EXT=33776]="COMPRESSED_RGB_S3TC_DXT1_EXT",e[e.COMPRESSED_RGBA_S3TC_DXT1_EXT=33777]="COMPRESSED_RGBA_S3TC_DXT1_EXT",e[e.COMPRESSED_RGBA_S3TC_DXT3_EXT=33778]="COMPRESSED_RGBA_S3TC_DXT3_EXT",e[e.COMPRESSED_RGBA_S3TC_DXT5_EXT=33779]="COMPRESSED_RGBA_S3TC_DXT5_EXT",e[e.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT=35917]="COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT",e[e.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT=35918]="COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT",e[e.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT=35919]="COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT",e[e.COMPRESSED_SRGB_S3TC_DXT1_EXT=35916]="COMPRESSED_SRGB_S3TC_DXT1_EXT",e[e.COMPRESSED_R11_EAC=37488]="COMPRESSED_R11_EAC",e[e.COMPRESSED_SIGNED_R11_EAC=37489]="COMPRESSED_SIGNED_R11_EAC",e[e.COMPRESSED_RG11_EAC=37490]="COMPRESSED_RG11_EAC",e[e.COMPRESSED_SIGNED_RG11_EAC=37491]="COMPRESSED_SIGNED_RG11_EAC",e[e.COMPRESSED_RGB8_ETC2=37492]="COMPRESSED_RGB8_ETC2",e[e.COMPRESSED_RGBA8_ETC2_EAC=37496]="COMPRESSED_RGBA8_ETC2_EAC",e[e.COMPRESSED_SRGB8_ETC2=37493]="COMPRESSED_SRGB8_ETC2",e[e.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC=37497]="COMPRESSED_SRGB8_ALPHA8_ETC2_EAC",e[e.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2=37494]="COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2",e[e.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2=37495]="COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2",e[e.COMPRESSED_RGB_PVRTC_4BPPV1_IMG=35840]="COMPRESSED_RGB_PVRTC_4BPPV1_IMG",e[e.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG=35842]="COMPRESSED_RGBA_PVRTC_4BPPV1_IMG",e[e.COMPRESSED_RGB_PVRTC_2BPPV1_IMG=35841]="COMPRESSED_RGB_PVRTC_2BPPV1_IMG",e[e.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG=35843]="COMPRESSED_RGBA_PVRTC_2BPPV1_IMG",e[e.COMPRESSED_RGB_ETC1_WEBGL=36196]="COMPRESSED_RGB_ETC1_WEBGL",e[e.COMPRESSED_RGB_ATC_WEBGL=35986]="COMPRESSED_RGB_ATC_WEBGL",e[e.COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL=35987]="COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL",e[e.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL=34798]="COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL",e[e.COMPRESSED_RGBA_ASTC_4x4_KHR=37808]="COMPRESSED_RGBA_ASTC_4x4_KHR",e[e.COMPRESSED_RGBA_BPTC_UNORM_EXT=36492]="COMPRESSED_RGBA_BPTC_UNORM_EXT",e[e.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT=36493]="COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT",e[e.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT=36494]="COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT",e[e.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT=36495]="COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT",e))(ze||{});const Ge={33776:.5,33777:.5,33778:1,33779:1,35916:.5,35917:.5,35918:1,35919:1,37488:.5,37489:.5,37490:1,37491:1,37492:.5,37496:1,37493:.5,37497:1,37494:.5,37495:.5,35840:.5,35842:.5,35841:.25,35843:.25,36196:.5,35986:.5,35987:1,34798:1,37808:1,36492:1,36493:1,36494:1,36495:1};let Ve,We;function He(){We={bptc:Ve.getExtension("EXT_texture_compression_bptc"),astc:Ve.getExtension("WEBGL_compressed_texture_astc"),etc:Ve.getExtension("WEBGL_compressed_texture_etc"),s3tc:Ve.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:Ve.getExtension("WEBGL_compressed_texture_s3tc_srgb"),pvrtc:Ve.getExtension("WEBGL_compressed_texture_pvrtc")||Ve.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),etc1:Ve.getExtension("WEBGL_compressed_texture_etc1"),atc:Ve.getExtension("WEBGL_compressed_texture_atc")}}const qe={extension:{type:n.Ag.DetectionParser,priority:2},test:async()=>{const e=n.W0.ADAPTER.createCanvas().getContext("webgl");return e?(Ve=e,!0):(console.warn("WebGL not available for compressed textures."),!1)},add:async e=>{We||He();const t=[];for(const e in We)We[e]&&t.push(e);return[...t,...e]},remove:async e=>(We||He(),e.filter((e=>!(e in We))))};n.XO.add(qe);class Ye extends n.dZ{constructor(e,t={width:1,height:1,autoLoad:!0}){let r,i;"string"==typeof e?(r=e,i=new Uint8Array):(r=null,i=e),super(i,t),this.origin=r,this.buffer=i?new n.u3(i):null,this._load=null,this.loaded=!1,null!==this.origin&&!1!==t.autoLoad&&this.load(),null===this.origin&&this.buffer&&(this._load=Promise.resolve(this),this.loaded=!0,this.onBlobLoaded(this.buffer.rawBinaryData))}onBlobLoaded(e){}load(){return this._load||(this._load=fetch(this.origin).then((e=>e.blob())).then((e=>e.arrayBuffer())).then((e=>(this.data=new Uint32Array(e),this.buffer=new n.u3(e),this.loaded=!0,this.onBlobLoaded(e),this.update(),this)))),this._load}}class Xe extends Ye{constructor(e,t){super(e,t),this.format=t.format,this.levels=t.levels||1,this._width=t.width,this._height=t.height,this._extension=Xe._formatToExtension(this.format),(t.levelBuffers||this.buffer)&&(this._levelBuffers=t.levelBuffers||Xe._createLevelBuffers(e instanceof Uint8Array?e:this.buffer.uint8View,this.format,this.levels,4,4,this.width,this.height))}upload(e,t,r){const n=e.gl;if(!e.context.extensions[this._extension])throw new Error(`${this._extension} textures are not supported on the current machine`);if(!this._levelBuffers)return!1;n.pixelStorei(n.UNPACK_ALIGNMENT,4);for(let e=0,t=this.levels;e<t;e++){const{levelID:t,levelWidth:r,levelHeight:i,levelBuffer:o}=this._levelBuffers[e];n.compressedTexImage2D(n.TEXTURE_2D,t,this.format,r,i,0,o)}return!0}onBlobLoaded(){this._levelBuffers=Xe._createLevelBuffers(this.buffer.uint8View,this.format,this.levels,4,4,this.width,this.height)}static _formatToExtension(e){if(e>=33776&&e<=33779)return"s3tc";if(e>=35916&&e<=35919)return"s3tc_sRGB";if(e>=37488&&e<=37497)return"etc";if(e>=35840&&e<=35843)return"pvrtc";if(36196===e)return"etc1";if(35986===e||35987===e||34798===e)return"atc";if(e>=36492&&e<=36495)return"bptc";if(37808===e)return"astc";throw new Error(`Invalid (compressed) texture format given: ${e}`)}static _createLevelBuffers(e,t,r,n,i,o,a){const s=new Array(r);let u=e.byteOffset,l=o,h=a,c=l+n-1&~(n-1),f=h+i-1&~(i-1),d=c*f*Ge[t];for(let o=0;o<r;o++)s[o]={levelID:o,levelWidth:r>1?l:c,levelHeight:r>1?h:f,levelBuffer:new Uint8Array(e.buffer,u,d)},u+=d,l=l>>1||1,h=h>>1||1,c=l+n-1&~(n-1),f=h+i-1&~(i-1),d=c*f*Ge[t];return s}}const Ke=4,Ze=124,Je=32,Qe=20,et=542327876,tt={SIZE:1,FLAGS:2,HEIGHT:3,WIDTH:4,MIPMAP_COUNT:7,PIXEL_FORMAT:19},rt={SIZE:0,FLAGS:1,FOURCC:2,RGB_BITCOUNT:3,R_BIT_MASK:4,G_BIT_MASK:5,B_BIT_MASK:6,A_BIT_MASK:7},nt={DXGI_FORMAT:0,RESOURCE_DIMENSION:1,MISC_FLAG:2,ARRAY_SIZE:3,MISC_FLAGS2:4},it=1,ot=2,at=4,st=64,ut=512,lt=131072,ht=827611204,ct=861165636,ft=894720068,dt=808540228,pt=4,yt={[ht]:ze.COMPRESSED_RGBA_S3TC_DXT1_EXT,[ct]:ze.COMPRESSED_RGBA_S3TC_DXT3_EXT,[ft]:ze.COMPRESSED_RGBA_S3TC_DXT5_EXT},mt={70:ze.COMPRESSED_RGBA_S3TC_DXT1_EXT,71:ze.COMPRESSED_RGBA_S3TC_DXT1_EXT,73:ze.COMPRESSED_RGBA_S3TC_DXT3_EXT,74:ze.COMPRESSED_RGBA_S3TC_DXT3_EXT,76:ze.COMPRESSED_RGBA_S3TC_DXT5_EXT,77:ze.COMPRESSED_RGBA_S3TC_DXT5_EXT,72:ze.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT,75:ze.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT,78:ze.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT,96:ze.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT,95:ze.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT,98:ze.COMPRESSED_RGBA_BPTC_UNORM_EXT,99:ze.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT};function gt(e){const t=new Uint32Array(e);if(t[0]!==et)throw new Error("Invalid DDS file magic word");const r=new Uint32Array(e,0,Ze/Uint32Array.BYTES_PER_ELEMENT),n=r[tt.HEIGHT],i=r[tt.WIDTH],o=r[tt.MIPMAP_COUNT],a=new Uint32Array(e,tt.PIXEL_FORMAT*Uint32Array.BYTES_PER_ELEMENT,Je/Uint32Array.BYTES_PER_ELEMENT),s=a[it];if(s&at){const r=a[rt.FOURCC];if(r!==dt){const t=yt[r],a=new Uint8Array(e,Ke+Ze);return[new Xe(a,{format:t,width:i,height:n,levels:o})]}const s=Ke+Ze,u=new Uint32Array(t.buffer,s,Qe/Uint32Array.BYTES_PER_ELEMENT),l=u[nt.DXGI_FORMAT],h=u[nt.RESOURCE_DIMENSION],c=u[nt.MISC_FLAG],f=u[nt.ARRAY_SIZE],d=mt[l];if(void 0===d)throw new Error(`DDSParser cannot parse texture data with DXGI format ${l}`);if(c===pt)throw new Error("DDSParser does not support cubemap textures");if(6===h)throw new Error("DDSParser does not supported 3D texture data");const p=new Array,y=Ke+Ze+Qe;if(1===f)p.push(new Uint8Array(e,y));else{const t=Ge[d];let r=0,a=i,s=n;for(let e=0;e<o;e++){r+=Math.max(1,a+3&-4)*Math.max(1,s+3&-4)*t,a>>>=1,s>>>=1}let u=y;for(let t=0;t<f;t++)p.push(new Uint8Array(e,u,r)),u+=r}return p.map((e=>new Xe(e,{format:d,width:i,height:n,levels:o})))}throw s&st?new Error("DDSParser does not support uncompressed texture data."):s&ut?new Error("DDSParser does not supported YUV uncompressed texture data."):s&lt?new Error("DDSParser does not support single-channel (lumninance) texture data!"):s&ot?new Error("DDSParser does not support single-channel (alpha) texture data!"):new Error("DDSParser failed to load a texture file due to an unknown reason!")}const wt=[171,75,84,88,32,49,49,187,13,10,26,10],vt=67305985,bt={FILE_IDENTIFIER:0,ENDIANNESS:12,GL_TYPE:16,GL_TYPE_SIZE:20,GL_FORMAT:24,GL_INTERNAL_FORMAT:28,GL_BASE_INTERNAL_FORMAT:32,PIXEL_WIDTH:36,PIXEL_HEIGHT:40,PIXEL_DEPTH:44,NUMBER_OF_ARRAY_ELEMENTS:48,NUMBER_OF_FACES:52,NUMBER_OF_MIPMAP_LEVELS:56,BYTES_OF_KEY_VALUE_DATA:60},xt=64,_t={[n.QE.UNSIGNED_BYTE]:1,[n.QE.UNSIGNED_SHORT]:2,[n.QE.INT]:4,[n.QE.UNSIGNED_INT]:4,[n.QE.FLOAT]:4,[n.QE.HALF_FLOAT]:8},St={[n.hR.RGBA]:4,[n.hR.RGB]:3,[n.hR.RG]:2,[n.hR.RED]:1,[n.hR.LUMINANCE]:1,[n.hR.LUMINANCE_ALPHA]:2,[n.hR.ALPHA]:1},Tt={[n.QE.UNSIGNED_SHORT_4_4_4_4]:2,[n.QE.UNSIGNED_SHORT_5_5_5_1]:2,[n.QE.UNSIGNED_SHORT_5_6_5]:2};function Et(e,t,r=!1){const i=new DataView(t);if(!function(e,t){for(let r=0;r<wt.length;r++)if(t.getUint8(r)!==wt[r])return console.error(`${e} is not a valid *.ktx file!`),!1;return!0}(e,i))return null;const o=i.getUint32(bt.ENDIANNESS,!0)===vt,a=i.getUint32(bt.GL_TYPE,o),s=i.getUint32(bt.GL_FORMAT,o),u=i.getUint32(bt.GL_INTERNAL_FORMAT,o),l=i.getUint32(bt.PIXEL_WIDTH,o),h=i.getUint32(bt.PIXEL_HEIGHT,o)||1,c=i.getUint32(bt.PIXEL_DEPTH,o)||1,f=i.getUint32(bt.NUMBER_OF_ARRAY_ELEMENTS,o)||1,d=i.getUint32(bt.NUMBER_OF_FACES,o),p=i.getUint32(bt.NUMBER_OF_MIPMAP_LEVELS,o),y=i.getUint32(bt.BYTES_OF_KEY_VALUE_DATA,o);if(0===h||1!==c)throw new Error("Only 2D textures are supported");if(1!==d)throw new Error("CubeTextures are not supported by KTXLoader yet!");if(1!==f)throw new Error("WebGL does not support array textures");const m=l+3&-4,g=h+3&-4,w=new Array(f);let v,b=l*h;if(0===a&&(b=m*g),v=0!==a?_t[a]?_t[a]*St[s]:Tt[a]:Ge[u],void 0===v)throw new Error("Unable to resolve the pixel format stored in the *.ktx file!");const x=r?function(e,t,r){const n=new Map;let i=0;for(;i<t;){const o=e.getUint32(xt+i,r),a=xt+i+4,s=3-(o+3)%4;if(0===o||o>t-i){console.error("KTXLoader: keyAndValueByteSize out of bounds");break}let u=0;for(;u<o&&0!==e.getUint8(a+u);u++);if(-1===u){console.error("KTXLoader: Failed to find null byte terminating kvData key");break}const l=(new TextDecoder).decode(new Uint8Array(e.buffer,a,u)),h=new DataView(e.buffer,a+u+1,o-u-1);n.set(l,h),i+=4+o+s}return n}(i,y,o):null;let _=b*v,S=l,T=h,E=m,O=g,A=xt+y;for(let e=0;e<p;e++){const r=i.getUint32(A,o);let n=A+4;for(let r=0;r<f;r++){let i=w[r];i||(i=w[r]=new Array(p)),i[e]={levelID:e,levelWidth:p>1||0!==a?S:E,levelHeight:p>1||0!==a?T:O,levelBuffer:new Uint8Array(t,n,_)},n+=_}A+=r+4,A=A%4!=0?A+4-A%4:A,S=S>>1||1,T=T>>1||1,E=S+4-1&-4,O=T+4-1&-4,_=E*O*v}return 0!==a?{uncompressed:w.map((e=>{let t=e[0].levelBuffer,r=!1;return a===n.QE.FLOAT?t=new Float32Array(e[0].levelBuffer.buffer,e[0].levelBuffer.byteOffset,e[0].levelBuffer.byteLength/4):a===n.QE.UNSIGNED_INT?(r=!0,t=new Uint32Array(e[0].levelBuffer.buffer,e[0].levelBuffer.byteOffset,e[0].levelBuffer.byteLength/4)):a===n.QE.INT&&(r=!0,t=new Int32Array(e[0].levelBuffer.buffer,e[0].levelBuffer.byteOffset,e[0].levelBuffer.byteLength/4)),{resource:new n.dZ(t,{width:e[0].levelWidth,height:e[0].levelHeight}),type:a,format:r?Ot(s):s}})),kvData:x}:{compressed:w.map((e=>new Xe(null,{format:u,width:l,height:h,levels:p,levelBuffers:e}))),kvData:x}}function Ot(e){switch(e){case n.hR.RGBA:return n.hR.RGBA_INTEGER;case n.hR.RGB:return n.hR.RGB_INTEGER;case n.hR.RG:return n.hR.RG_INTEGER;case n.hR.RED:return n.hR.RED_INTEGER;default:return e}}const At={extension:{type:n.Ag.LoadParser,priority:Z.High},name:"loadDDS",test:e=>H(e,".dds"),async load(e,t,r){const i=gt(await(await n.W0.ADAPTER.fetch(e)).arrayBuffer()).map((i=>ye(new n.t5(i,{mipmap:n.E8.OFF,alphaMode:n.Gk.NO_PREMULTIPLIED_ALPHA,resolution:n.Wp.getResolutionOfUrl(e),...t.data}),r,e)));return 1===i.length?i[0]:i},unload(e){Array.isArray(e)?e.forEach((e=>e.destroy(!0))):e.destroy(!0)}};n.XO.add(At);const It={extension:{type:n.Ag.LoadParser,priority:Z.High},name:"loadKTX",test:e=>H(e,".ktx"),async load(e,t,r){const i=await(await n.W0.ADAPTER.fetch(e)).arrayBuffer(),{compressed:o,uncompressed:a,kvData:s}=Et(e,i),u=o??a,l={mipmap:n.E8.OFF,alphaMode:n.Gk.NO_PREMULTIPLIED_ALPHA,resolution:n.Wp.getResolutionOfUrl(e),...t.data},h=u.map((t=>{u===a&&Object.assign(l,{type:t.type,format:t.format});const i=t.resource??t,o=new n.t5(i,l);return o.ktxKeyValueData=s,ye(o,r,e)}));return 1===h.length?h[0]:h},unload(e){Array.isArray(e)?e.forEach((e=>e.destroy(!0))):e.destroy(!0)}};n.XO.add(It);const Pt=["s3tc","s3tc_sRGB","etc","etc1","pvrtc","atc","astc","bptc"],kt={extension:n.Ag.ResolveParser,test:e=>{const t=n.Wp.path.extname(e).slice(1);return["basis","ktx","dds"].includes(t)},parse:e=>{const t=e.split("."),r=t.pop();if(["ktx","dds"].includes(r)){const r=t.pop();if(Pt.includes(r))return{resolution:parseFloat(n.W0.RETINA_PREFIX.exec(e)?.[1]??"1"),format:r,src:e}}return{resolution:parseFloat(n.W0.RETINA_PREFIX.exec(e)?.[1]??"1"),format:r,src:e}}};n.XO.add(kt);const Ct=new n.M_,$t=class e{constructor(e){this.renderer=e,this._rendererPremultipliedAlpha=!1}contextChange(){const e=this.renderer?.gl.getContextAttributes();this._rendererPremultipliedAlpha=!!(e&&e.alpha&&e.premultipliedAlpha)}async image(e,t,r,n){const i=new Image;return i.src=await this.base64(e,t,r,n),i}async base64(e,t,r,n){const i=this.canvas(e,n);if(void 0!==i.toBlob)return new Promise(((e,n)=>{i.toBlob((t=>{if(!t)return void n(new Error("ICanvas.toBlob failed!"));const r=new FileReader;r.onload=()=>e(r.result),r.onerror=n,r.readAsDataURL(t)}),t,r)}));if(void 0!==i.toDataURL)return i.toDataURL(t,r);if(void 0!==i.convertToBlob){const e=await i.convertToBlob({type:t,quality:r});return new Promise(((t,r)=>{const n=new FileReader;n.onload=()=>t(n.result),n.onerror=r,n.readAsDataURL(e)}))}throw new Error("Extract.base64() requires ICanvas.toDataURL, ICanvas.toBlob, or ICanvas.convertToBlob to be implemented")}canvas(t,r){const{pixels:i,width:o,height:a,flipY:s,premultipliedAlpha:u}=this._rawPixels(t,r);s&&e._flipY(i,o,a),u&&e._unpremultiplyAlpha(i);const l=new n.Wp.CanvasRenderTarget(o,a,1),h=new ImageData(new Uint8ClampedArray(i.buffer),o,a);return l.context.putImageData(h,0,0),l.canvas}pixels(t,r){const{pixels:n,width:i,height:o,flipY:a,premultipliedAlpha:s}=this._rawPixels(t,r);return a&&e._flipY(n,i,o),s&&e._unpremultiplyAlpha(n),n}_rawPixels(e,t){const r=this.renderer;if(!r)throw new Error("The Extract has already been destroyed");let i,o,a=!1,s=!1,u=!1;e&&(e instanceof n.Y7?o=e:(o=r.generateTexture(e,{region:t,resolution:r.resolution,multisample:r.multisample}),u=!0,t&&(Ct.width=t.width,Ct.height=t.height,t=Ct)));const l=r.gl;if(o){if(i=o.baseTexture.resolution,t=t??o.frame,a=!1,s=o.baseTexture.alphaMode>0&&o.baseTexture.format===n.hR.RGBA,!u){r.renderTexture.bind(o);const e=o.framebuffer.glFramebuffers[r.CONTEXT_UID];e.blitFramebuffer&&r.framebuffer.bind(e.blitFramebuffer)}}else i=r.resolution,t||((t=Ct).width=r.width/i,t.height=r.height/i),a=!0,s=this._rendererPremultipliedAlpha,r.renderTexture.bind();const h=Math.max(Math.round(t.width*i),1),c=Math.max(Math.round(t.height*i),1),f=new Uint8Array(4*h*c);return l.readPixels(Math.round(t.x*i),Math.round(t.y*i),h,c,l.RGBA,l.UNSIGNED_BYTE,f),u&&o?.destroy(!0),{pixels:f,width:h,height:c,flipY:a,premultipliedAlpha:s}}destroy(){this.renderer=null}static _flipY(e,t,r){const n=t<<2,i=r>>1,o=new Uint8Array(n);for(let t=0;t<i;t++){const i=t*n,a=(r-t-1)*n;o.set(e.subarray(i,i+n)),e.copyWithin(i,a,a+n),e.set(o,a)}}static _unpremultiplyAlpha(e){e instanceof Uint8ClampedArray&&(e=new Uint8Array(e.buffer));const t=e.length;for(let r=0;r<t;r+=4){const t=e[r+3];if(0!==t){const n=255.001/t;e[r]=e[r]*n+.5,e[r+1]=e[r+1]*n+.5,e[r+2]=e[r+2]*n+.5}}}};$t.extension={name:"extract",type:n.Ag.RendererSystem};let Rt=$t;n.XO.add(Rt);const Dt={build(e){const t=e.points;let r,i,o,a,s,u;if(e.type===n.HY.CIRC){const t=e.shape;r=t.x,i=t.y,s=u=t.radius,o=a=0}else if(e.type===n.HY.ELIP){const t=e.shape;r=t.x,i=t.y,s=t.width,u=t.height,o=a=0}else{const t=e.shape,n=t.width/2,l=t.height/2;r=t.x+n,i=t.y+l,s=u=Math.max(0,Math.min(t.radius,Math.min(n,l))),o=n-s,a=l-u}if(!(s>=0&&u>=0&&o>=0&&a>=0))return void(t.length=0);const l=Math.ceil(2.3*Math.sqrt(s+u)),h=8*l+(o?4:0)+(a?4:0);if(t.length=h,0===h)return;if(0===l)return t.length=8,t[0]=t[6]=r+o,t[1]=t[3]=i+a,t[2]=t[4]=r-o,void(t[5]=t[7]=i-a);let c=0,f=4*l+(o?2:0)+2,d=f,p=h;{const e=o+s,n=a,u=r+e,l=r-e,h=i+n;if(t[c++]=u,t[c++]=h,t[--f]=h,t[--f]=l,a){const e=i-n;t[d++]=l,t[d++]=e,t[--p]=e,t[--p]=u}}for(let e=1;e<l;e++){const n=Math.PI/2*(e/l),h=o+Math.cos(n)*s,y=a+Math.sin(n)*u,m=r+h,g=r-h,w=i+y,v=i-y;t[c++]=m,t[c++]=w,t[--f]=w,t[--f]=g,t[d++]=g,t[d++]=v,t[--p]=v,t[--p]=m}{const e=a+u,n=r+o,s=r-o,l=i+e,h=i-e;t[c++]=n,t[c++]=l,t[--p]=h,t[--p]=n,o&&(t[c++]=s,t[c++]=l,t[--p]=h,t[--p]=s)}},triangulate(e,t){const r=e.points,i=t.points,o=t.indices;if(0===r.length)return;let a=i.length/2;const s=a;let u,l;if(e.type!==n.HY.RREC){const t=e.shape;u=t.x,l=t.y}else{const t=e.shape;u=t.x+t.width/2,l=t.y+t.height/2}const h=e.matrix;i.push(e.matrix?h.a*u+h.c*l+h.tx:u,e.matrix?h.b*u+h.d*l+h.ty:l),a++,i.push(r[0],r[1]);for(let e=2;e<r.length;e+=2)i.push(r[e],r[e+1]),o.push(a++,s,a);o.push(s+1,s,a)}};function Mt(e,t=!1){const r=e.length;if(r<6)return;let n=0;for(let t=0,i=e[r-2],o=e[r-1];t<r;t+=2){const r=e[t],a=e[t+1];n+=(r-i)*(a+o),i=r,o=a}if(!t&&n>0||t&&n<=0){const t=r/2;for(let n=t+t%2;n<r;n+=2){const t=r-n-2,i=r-n-1,o=n,a=n+1;[e[t],e[o]]=[e[o],e[t]],[e[i],e[a]]=[e[a],e[i]]}}}const Lt={build(e){e.points=e.shape.points.slice()},triangulate(e,t){let r=e.points;const i=e.holes,o=t.points,a=t.indices;if(r.length>=6){Mt(r,!1);const e=[];for(let t=0;t<i.length;t++){const n=i[t];Mt(n.points,!0),e.push(r.length/2),r=r.concat(n.points)}const t=n.Wp.earcut(r,e,2);if(!t)return;const s=o.length/2;for(let e=0;e<t.length;e+=3)a.push(t[e]+s),a.push(t[e+1]+s),a.push(t[e+2]+s);for(let e=0;e<r.length;e++)o.push(r[e])}}},Bt={build(e){const t=e.shape,r=t.x,n=t.y,i=t.width,o=t.height,a=e.points;a.length=0,i>=0&&o>=0&&a.push(r,n,r+i,n,r+i,n+o,r,n+o)},triangulate(e,t){const r=e.points,n=t.points;if(0===r.length)return;const i=n.length/2;n.push(r[0],r[1],r[2],r[3],r[6],r[7],r[4],r[5]),t.indices.push(i,i+1,i+2,i+1,i+2,i+3)}},Nt={build(e){Dt.build(e)},triangulate(e,t){Dt.triangulate(e,t)}};var Ft=(e=>(e.MITER="miter",e.BEVEL="bevel",e.ROUND="round",e))(Ft||{}),Ut=(e=>(e.BUTT="butt",e.ROUND="round",e.SQUARE="square",e))(Ut||{});const jt={adaptive:!0,maxLength:10,minSegments:8,maxSegments:2048,epsilon:1e-4,_segmentsCount(e,t=20){if(!this.adaptive||!e||isNaN(e))return t;let r=Math.ceil(e/this.maxLength);return r<this.minSegments?r=this.minSegments:r>this.maxSegments&&(r=this.maxSegments),r}},zt=jt;class Gt{static curveTo(e,t,r,n,i,o){const a=o[o.length-2],s=o[o.length-1]-t,u=a-e,l=n-t,h=r-e,c=Math.abs(s*h-u*l);if(c<1e-8||0===i)return(o[o.length-2]!==e||o[o.length-1]!==t)&&o.push(e,t),null;const f=s*s+u*u,d=l*l+h*h,p=s*l+u*h,y=i*Math.sqrt(f)/c,m=i*Math.sqrt(d)/c,g=y*p/f,w=m*p/d,v=y*h+m*u,b=y*l+m*s,x=u*(m+g),_=s*(m+g),S=h*(y+w),T=l*(y+w);return{cx:v+e,cy:b+t,radius:i,startAngle:Math.atan2(_-b,x-v),endAngle:Math.atan2(T-b,S-v),anticlockwise:u*l>h*s}}static arc(e,t,r,i,o,a,s,u,l){const h=s-a,c=jt._segmentsCount(Math.abs(h)*o,40*Math.ceil(Math.abs(h)/n.TO)),f=h/(2*c),d=2*f,p=Math.cos(f),y=Math.sin(f),m=c-1,g=m%1/m;for(let e=0;e<=m;++e){const t=f+a+d*(e+g*e),n=Math.cos(t),s=-Math.sin(t);l.push((p*n+y*s)*o+r,(p*-s+y*n)*o+i)}}}class Vt{static curveLength(e,t,r,n,i,o,a,s){let u=0,l=0,h=0,c=0,f=0,d=0,p=0,y=0,m=0,g=0,w=0,v=e,b=t;for(let x=1;x<=10;++x)l=x/10,h=l*l,c=h*l,f=1-l,d=f*f,p=d*f,y=p*e+3*d*l*r+3*f*h*i+c*a,m=p*t+3*d*l*n+3*f*h*o+c*s,g=v-y,w=b-m,v=y,b=m,u+=Math.sqrt(g*g+w*w);return u}static curveTo(e,t,r,n,i,o,a){const s=a[a.length-2],u=a[a.length-1];a.length-=2;const l=jt._segmentsCount(Vt.curveLength(s,u,e,t,r,n,i,o));let h=0,c=0,f=0,d=0,p=0;a.push(s,u);for(let y=1,m=0;y<=l;++y)m=y/l,h=1-m,c=h*h,f=c*h,d=m*m,p=d*m,a.push(f*s+3*c*m*e+3*h*d*r+p*i,f*u+3*c*m*t+3*h*d*n+p*o)}}function Wt(e,t,r,n,i,o,a,s){let u,l;a?(u=n,l=-r):(u=-n,l=r);const h=e-r*i+u,c=t-n*i+l,f=e+r*o+u,d=t+n*o+l;return s.push(h,c,f,d),2}function Ht(e,t,r,n,i,o,a,s){const u=r-e,l=n-t;let h=Math.atan2(u,l),c=Math.atan2(i-e,o-t);s&&h<c?h+=2*Math.PI:!s&&h>c&&(c+=2*Math.PI);let f=h;const d=c-h,p=Math.abs(d),y=Math.sqrt(u*u+l*l),m=1+(15*p*Math.sqrt(y)/Math.PI|0),g=d/m;if(f+=g,s){a.push(e,t,r,n);for(let r=1,n=f;r<m;r++,n+=g)a.push(e,t,e+Math.sin(n)*y,t+Math.cos(n)*y);a.push(e,t,i,o)}else{a.push(r,n,e,t);for(let r=1,n=f;r<m;r++,n+=g)a.push(e+Math.sin(n)*y,t+Math.cos(n)*y,e,t);a.push(i,o,e,t)}return 2*m}function qt(e,t){e.lineStyle.native?function(e,t){let r=0;const i=e.shape,o=e.points||i.points,a=i.type!==n.HY.POLY||i.closeStroke;if(0===o.length)return;const s=t.points,u=t.indices,l=o.length/2,h=s.length/2;let c=h;for(s.push(o[0],o[1]),r=1;r<l;r++)s.push(o[2*r],o[2*r+1]),u.push(c,c+1),c++;a&&u.push(c,h)}(e,t):function(e,t){const r=e.shape;let i=e.points||r.points.slice();const o=t.closePointEps;if(0===i.length)return;const a=e.lineStyle,s=new n.bR(i[0],i[1]),u=new n.bR(i[i.length-2],i[i.length-1]),l=r.type!==n.HY.POLY||r.closeStroke,h=Math.abs(s.x-u.x)<o&&Math.abs(s.y-u.y)<o;if(l){i=i.slice(),h&&(i.pop(),i.pop(),u.set(i[i.length-2],i[i.length-1]));const e=.5*(s.x+u.x),t=.5*(u.y+s.y);i.unshift(e,t),i.push(e,t)}const c=t.points,f=i.length/2;let d=i.length;const p=c.length/2,y=a.width/2,m=y*y,g=a.miterLimit*a.miterLimit;let w=i[0],v=i[1],b=i[2],x=i[3],_=0,S=0,T=-(v-x),E=w-b,O=0,A=0,I=Math.sqrt(T*T+E*E);T/=I,E/=I,T*=y,E*=y;const P=a.alignment,k=2*(1-P),C=2*P;l||(a.cap===Ut.ROUND?d+=Ht(w-T*(k-C)*.5,v-E*(k-C)*.5,w-T*k,v-E*k,w+T*C,v+E*C,c,!0)+2:a.cap===Ut.SQUARE&&(d+=Wt(w,v,T,E,k,C,!0,c))),c.push(w-T*k,v-E*k,w+T*C,v+E*C);for(let e=1;e<f-1;++e){w=i[2*(e-1)],v=i[2*(e-1)+1],b=i[2*e],x=i[2*e+1],_=i[2*(e+1)],S=i[2*(e+1)+1],T=-(v-x),E=w-b,I=Math.sqrt(T*T+E*E),T/=I,E/=I,T*=y,E*=y,O=-(x-S),A=b-_,I=Math.sqrt(O*O+A*A),O/=I,A/=I,O*=y,A*=y;const t=b-w,r=v-x,n=b-_,o=S-x,s=t*n+r*o,u=r*n-o*t,l=u<0;if(Math.abs(u)<.001*Math.abs(s)){c.push(b-T*k,x-E*k,b+T*C,x+E*C),s>=0&&(a.join===Ft.ROUND?d+=Ht(b,x,b-T*k,x-E*k,b-O*k,x-A*k,c,!1)+4:d+=2,c.push(b-O*C,x-A*C,b+O*k,x+A*k));continue}const h=(-T+w)*(-E+x)-(-T+b)*(-E+v),f=(-O+_)*(-A+x)-(-O+b)*(-A+S),p=(t*f-n*h)/u,P=(o*h-r*f)/u,$=(p-b)*(p-b)+(P-x)*(P-x),R=b+(p-b)*k,D=x+(P-x)*k,M=b-(p-b)*C,L=x-(P-x)*C,B=l?k:C,N=$<=Math.min(t*t+r*r,n*n+o*o)+B*B*m;let F=a.join;if(F===Ft.MITER&&$/m>g&&(F=Ft.BEVEL),N)switch(F){case Ft.MITER:c.push(R,D,M,L);break;case Ft.BEVEL:l?c.push(R,D,b+T*C,x+E*C,R,D,b+O*C,x+A*C):c.push(b-T*k,x-E*k,M,L,b-O*k,x-A*k,M,L),d+=2;break;case Ft.ROUND:l?(c.push(R,D,b+T*C,x+E*C),d+=Ht(b,x,b+T*C,x+E*C,b+O*C,x+A*C,c,!0)+4,c.push(R,D,b+O*C,x+A*C)):(c.push(b-T*k,x-E*k,M,L),d+=Ht(b,x,b-T*k,x-E*k,b-O*k,x-A*k,c,!1)+4,c.push(b-O*k,x-A*k,M,L))}else{switch(c.push(b-T*k,x-E*k,b+T*C,x+E*C),F){case Ft.MITER:l?c.push(M,L,M,L):c.push(R,D,R,D),d+=2;break;case Ft.ROUND:d+=l?Ht(b,x,b+T*C,x+E*C,b+O*C,x+A*C,c,!0)+2:Ht(b,x,b-T*k,x-E*k,b-O*k,x-A*k,c,!1)+2}c.push(b-O*k,x-A*k,b+O*C,x+A*C),d+=2}}w=i[2*(f-2)],v=i[2*(f-2)+1],b=i[2*(f-1)],x=i[2*(f-1)+1],T=-(v-x),E=w-b,I=Math.sqrt(T*T+E*E),T/=I,E/=I,T*=y,E*=y,c.push(b-T*k,x-E*k,b+T*C,x+E*C),l||(a.cap===Ut.ROUND?d+=Ht(b-T*(k-C)*.5,x-E*(k-C)*.5,b-T*k,x-E*k,b+T*C,x+E*C,c,!1)+2:a.cap===Ut.SQUARE&&(d+=Wt(b,x,T,E,k,C,!1,c)));const $=t.indices,R=jt.epsilon*jt.epsilon;for(let e=p;e<d+p-2;++e)w=c[2*e],v=c[2*e+1],b=c[2*(e+1)],x=c[2*(e+1)+1],_=c[2*(e+2)],S=c[2*(e+2)+1],!(Math.abs(w*(x-S)+b*(S-v)+_*(v-x))<R)&&$.push(e,e+1,e+2)}(e,t)}class Yt{static curveLength(e,t,r,n,i,o){const a=e-2*r+i,s=t-2*n+o,u=2*r-2*e,l=2*n-2*t,h=4*(a*a+s*s),c=4*(a*u+s*l),f=u*u+l*l,d=2*Math.sqrt(h+c+f),p=Math.sqrt(h),y=2*h*p,m=2*Math.sqrt(f),g=c/p;return(y*d+p*c*(d-m)+(4*f*h-c*c)*Math.log((2*p+g+d)/(g+m)))/(4*y)}static curveTo(e,t,r,n,i){const o=i[i.length-2],a=i[i.length-1],s=jt._segmentsCount(Yt.curveLength(o,a,e,t,r,n));let u=0,l=0;for(let h=1;h<=s;++h){const c=h/s;u=o+(e-o)*c,l=a+(t-a)*c,i.push(u+(e+(r-e)*c-u)*c,l+(t+(n-t)*c-l)*c)}}}const Xt={[n.HY.POLY]:Lt,[n.HY.CIRC]:Dt,[n.HY.ELIP]:Dt,[n.HY.RECT]:Bt,[n.HY.RREC]:Nt},Kt=[],Zt=[];class Jt{constructor(e,t=null,r=null,n=null){this.points=[],this.holes=[],this.shape=e,this.lineStyle=r,this.fillStyle=t,this.matrix=n,this.type=e.type}clone(){return new Jt(this.shape,this.fillStyle,this.lineStyle,this.matrix)}destroy(){this.shape=null,this.holes.length=0,this.holes=null,this.points.length=0,this.points=null,this.lineStyle=null,this.fillStyle=null}}class Qt{constructor(){this.reset()}begin(e,t,r){this.reset(),this.style=e,this.start=t,this.attribStart=r}end(e,t){this.attribSize=t-this.attribStart,this.size=e-this.start}reset(){this.style=null,this.size=0,this.start=0,this.attribStart=0,this.attribSize=0}}const er=new n.bR,tr=class e extends n.JH{constructor(){super(),this.closePointEps=1e-4,this.boundsPadding=0,this.uvsFloat32=null,this.indicesUint16=null,this.batchable=!1,this.points=[],this.colors=[],this.uvs=[],this.indices=[],this.textureIds=[],this.graphicsData=[],this.drawCalls=[],this.batchDirty=-1,this.batches=[],this.dirty=0,this.cacheDirty=-1,this.clearDirty=0,this.shapeIndex=0,this._bounds=new i,this.boundsDirty=-1}get bounds(){return this.updateBatches(),this.boundsDirty!==this.dirty&&(this.boundsDirty=this.dirty,this.calculateBounds()),this._bounds}invalidate(){this.boundsDirty=-1,this.dirty++,this.batchDirty++,this.shapeIndex=0,this.points.length=0,this.colors.length=0,this.uvs.length=0,this.indices.length=0,this.textureIds.length=0;for(let e=0;e<this.drawCalls.length;e++)this.drawCalls[e].texArray.clear(),Zt.push(this.drawCalls[e]);this.drawCalls.length=0;for(let e=0;e<this.batches.length;e++){const t=this.batches[e];t.reset(),Kt.push(t)}this.batches.length=0}clear(){return this.graphicsData.length>0&&(this.invalidate(),this.clearDirty++,this.graphicsData.length=0),this}drawShape(e,t=null,r=null,n=null){const i=new Jt(e,t,r,n);return this.graphicsData.push(i),this.dirty++,this}drawHole(e,t=null){if(!this.graphicsData.length)return null;const r=new Jt(e,null,null,t),n=this.graphicsData[this.graphicsData.length-1];return r.lineStyle=n.lineStyle,n.holes.push(r),this.dirty++,this}destroy(){super.destroy();for(let e=0;e<this.graphicsData.length;++e)this.graphicsData[e].destroy();this.points.length=0,this.points=null,this.colors.length=0,this.colors=null,this.uvs.length=0,this.uvs=null,this.indices.length=0,this.indices=null,this.indexBuffer.destroy(),this.indexBuffer=null,this.graphicsData.length=0,this.graphicsData=null,this.drawCalls.length=0,this.drawCalls=null,this.batches.length=0,this.batches=null,this._bounds=null}containsPoint(e){const t=this.graphicsData;for(let r=0;r<t.length;++r){const n=t[r];if(n.fillStyle.visible&&n.shape&&(n.matrix?n.matrix.applyInverse(e,er):er.copyFrom(e),n.shape.contains(er.x,er.y))){let e=!1;if(n.holes)for(let t=0;t<n.holes.length;t++)if(n.holes[t].shape.contains(er.x,er.y)){e=!0;break}if(!e)return!0}}return!1}updateBatches(){if(!this.graphicsData.length)return void(this.batchable=!0);if(!this.validateBatching())return;this.cacheDirty=this.dirty;const e=this.uvs,t=this.graphicsData;let r=null,i=null;this.batches.length>0&&(r=this.batches[this.batches.length-1],i=r.style);for(let o=this.shapeIndex;o<t.length;o++){this.shapeIndex++;const a=t[o],s=a.fillStyle,u=a.lineStyle;Xt[a.type].build(a),a.matrix&&this.transformPoints(a.points,a.matrix),(s.visible||u.visible)&&this.processHoles(a.holes);for(let t=0;t<2;t++){const o=0===t?s:u;if(!o.visible)continue;const l=o.texture.baseTexture,h=this.indices.length,c=this.points.length/2;l.wrapMode=n.uR.REPEAT,0===t?this.processFill(a):this.processLine(a);const f=this.points.length/2-c;0!==f&&(r&&!this._compareStyles(i,o)&&(r.end(h,c),r=null),r||(r=Kt.pop()||new Qt,r.begin(o,h,c),this.batches.push(r),i=o),this.addUvs(this.points,e,o.texture,c,f,o.matrix))}}const o=this.indices.length,a=this.points.length/2;if(r&&r.end(o,a),0===this.batches.length)return void(this.batchable=!0);const s=a>65535;this.indicesUint16&&this.indices.length===this.indicesUint16.length&&s===this.indicesUint16.BYTES_PER_ELEMENT>2?this.indicesUint16.set(this.indices):this.indicesUint16=s?new Uint32Array(this.indices):new Uint16Array(this.indices),this.batchable=this.isBatchable(),this.batchable?this.packBatches():this.buildDrawCalls()}_compareStyles(e,t){return!(!e||!t||e.texture.baseTexture!==t.texture.baseTexture||e.color+e.alpha!==t.color+t.alpha||!!e.native!=!!t.native)}validateBatching(){if(this.dirty===this.cacheDirty||!this.graphicsData.length)return!1;for(let e=0,t=this.graphicsData.length;e<t;e++){const t=this.graphicsData[e],r=t.fillStyle,n=t.lineStyle;if(r&&!r.texture.baseTexture.valid||n&&!n.texture.baseTexture.valid)return!1}return!0}packBatches(){this.batchDirty++,this.uvsFloat32=new Float32Array(this.uvs);const e=this.batches;for(let t=0,r=e.length;t<r;t++){const r=e[t];for(let e=0;e<r.size;e++){const t=r.start+e;this.indicesUint16[t]=this.indicesUint16[t]-r.attribStart}}}isBatchable(){if(this.points.length>131070)return!1;const t=this.batches;for(let e=0;e<t.length;e++)if(t[e].style.native)return!1;return this.points.length<2*e.BATCHABLE_SIZE}buildDrawCalls(){let e=++n.t5._globalBatch;for(let e=0;e<this.drawCalls.length;e++)this.drawCalls[e].texArray.clear(),Zt.push(this.drawCalls[e]);this.drawCalls.length=0;const t=this.colors,r=this.textureIds;let i=Zt.pop();i||(i=new n.hq,i.texArray=new n.cc),i.texArray.count=0,i.start=0,i.size=0,i.type=n._4.TRIANGLES;let o=0,a=null,s=0,u=!1,l=n._4.TRIANGLES,h=0;this.drawCalls.push(i);for(let c=0;c<this.batches.length;c++){const f=this.batches[c],d=8,p=f.style,y=p.texture.baseTexture;u!==!!p.native&&(u=!!p.native,l=u?n._4.LINES:n._4.TRIANGLES,a=null,o=d,e++),a!==y&&(a=y,y._batchEnabled!==e&&(o===d&&(e++,o=0,i.size>0&&(i=Zt.pop(),i||(i=new n.hq,i.texArray=new n.cc),this.drawCalls.push(i)),i.start=h,i.size=0,i.texArray.count=0,i.type=l),y.touched=1,y._batchEnabled=e,y._batchLocation=o,y.wrapMode=n.uR.REPEAT,i.texArray.elements[i.texArray.count++]=y,o++)),i.size+=f.size,h+=f.size,s=y._batchLocation,this.addColors(t,p.color,p.alpha,f.attribSize,f.attribStart),this.addTextureIds(r,s,f.attribSize,f.attribStart)}n.t5._globalBatch=e,this.packAttributes()}packAttributes(){const e=this.points,t=this.uvs,r=this.colors,n=this.textureIds,i=new ArrayBuffer(3*e.length*4),o=new Float32Array(i),a=new Uint32Array(i);let s=0;for(let i=0;i<e.length/2;i++)o[s++]=e[2*i],o[s++]=e[2*i+1],o[s++]=t[2*i],o[s++]=t[2*i+1],a[s++]=r[i],o[s++]=n[i];this._buffer.update(i),this._indexBuffer.update(this.indicesUint16)}processFill(e){e.holes.length?Lt.triangulate(e,this):Xt[e.type].triangulate(e,this)}processLine(e){qt(e,this);for(let t=0;t<e.holes.length;t++)qt(e.holes[t],this)}processHoles(e){for(let t=0;t<e.length;t++){const r=e[t];Xt[r.type].build(r),r.matrix&&this.transformPoints(r.points,r.matrix)}}calculateBounds(){const e=this._bounds;e.clear(),e.addVertexData(this.points,0,this.points.length),e.pad(this.boundsPadding,this.boundsPadding)}transformPoints(e,t){for(let r=0;r<e.length/2;r++){const n=e[2*r],i=e[2*r+1];e[2*r]=t.a*n+t.c*i+t.tx,e[2*r+1]=t.b*n+t.d*i+t.ty}}addColors(e,t,r,i,o=0){const a=n.Q1.shared.setValue(t).toLittleEndianNumber(),s=n.Q1.shared.setValue(a).toPremultiplied(r);e.length=Math.max(e.length,o+i);for(let t=0;t<i;t++)e[o+t]=s}addTextureIds(e,t,r,n=0){e.length=Math.max(e.length,n+r);for(let i=0;i<r;i++)e[n+i]=t}addUvs(e,t,r,n,i,o=null){let a=0;const s=t.length,u=r.frame;for(;a<i;){let r=e[2*(n+a)],i=e[2*(n+a)+1];if(o){const e=o.a*r+o.c*i+o.tx;i=o.b*r+o.d*i+o.ty,r=e}a++,t.push(r/u.width,i/u.height)}const l=r.baseTexture;(u.width<l.width||u.height<l.height)&&this.adjustUvs(t,r,s,i)}adjustUvs(e,t,r,n){const i=t.baseTexture,o=1e-6,a=r+2*n,s=t.frame,u=s.width/i.width,l=s.height/i.height;let h=s.x/s.width,c=s.y/s.height,f=Math.floor(e[r]+o),d=Math.floor(e[r+1]+o);for(let t=r+2;t<a;t+=2)f=Math.min(f,Math.floor(e[t]+o)),d=Math.min(d,Math.floor(e[t+1]+o));h-=f,c-=d;for(let t=r;t<a;t+=2)e[t]=(e[t]+h)*u,e[t+1]=(e[t+1]+c)*l}};tr.BATCHABLE_SIZE=100;let rr=tr;class nr{constructor(){this.color=16777215,this.alpha=1,this.texture=n.gP.WHITE,this.matrix=null,this.visible=!1,this.reset()}clone(){const e=new nr;return e.color=this.color,e.alpha=this.alpha,e.texture=this.texture,e.matrix=this.matrix,e.visible=this.visible,e}reset(){this.color=16777215,this.alpha=1,this.texture=n.gP.WHITE,this.matrix=null,this.visible=!1}destroy(){this.texture=null,this.matrix=null}}class ir extends nr{constructor(){super(...arguments),this.width=0,this.alignment=.5,this.native=!1,this.cap=Ut.BUTT,this.join=Ft.MITER,this.miterLimit=10}clone(){const e=new ir;return e.color=this.color,e.alpha=this.alpha,e.texture=this.texture,e.matrix=this.matrix,e.visible=this.visible,e.width=this.width,e.alignment=this.alignment,e.native=this.native,e.cap=this.cap,e.join=this.join,e.miterLimit=this.miterLimit,e}reset(){super.reset(),this.color=0,this.alignment=.5,this.width=0,this.native=!1,this.cap=Ut.BUTT,this.join=Ft.MITER,this.miterLimit=10}}const or={},ar=class e extends h{constructor(e=null){super(),this.shader=null,this.pluginName="batch",this.currentPath=null,this.batches=[],this.batchTint=-1,this.batchDirty=-1,this.vertexData=null,this._fillStyle=new nr,this._lineStyle=new ir,this._matrix=null,this._holeMode=!1,this.state=n.Uw.for2d(),this._geometry=e||new rr,this._geometry.refCount++,this._transformID=-1,this._tintColor=new n.Q1(16777215),this.blendMode=n.B9.NORMAL}get geometry(){return this._geometry}clone(){return this.finishPoly(),new e(this._geometry)}set blendMode(e){this.state.blendMode=e}get blendMode(){return this.state.blendMode}get tint(){return this._tintColor.value}set tint(e){this._tintColor.setValue(e)}get fill(){return this._fillStyle}get line(){return this._lineStyle}lineStyle(e=null,t=0,r,n=.5,i=!1){return"number"==typeof e&&(e={width:e,color:t,alpha:r,alignment:n,native:i}),this.lineTextureStyle(e)}lineTextureStyle(e){const t={width:0,texture:n.gP.WHITE,color:e?.texture?16777215:0,matrix:null,alignment:.5,native:!1,cap:Ut.BUTT,join:Ft.MITER,miterLimit:10};e=Object.assign(t,e),this.normalizeColor(e),this.currentPath&&this.startPoly();const r=e.width>0&&e.alpha>0;return r?(e.matrix&&(e.matrix=e.matrix.clone(),e.matrix.invert()),Object.assign(this._lineStyle,{visible:r},e)):this._lineStyle.reset(),this}startPoly(){if(this.currentPath){const e=this.currentPath.points,t=this.currentPath.points.length;t>2&&(this.drawShape(this.currentPath),this.currentPath=new n.tS,this.currentPath.closeStroke=!1,this.currentPath.points.push(e[t-2],e[t-1]))}else this.currentPath=new n.tS,this.currentPath.closeStroke=!1}finishPoly(){this.currentPath&&(this.currentPath.points.length>2?(this.drawShape(this.currentPath),this.currentPath=null):this.currentPath.points.length=0)}moveTo(e,t){return this.startPoly(),this.currentPath.points[0]=e,this.currentPath.points[1]=t,this}lineTo(e,t){this.currentPath||this.moveTo(0,0);const r=this.currentPath.points,n=r[r.length-2],i=r[r.length-1];return(n!==e||i!==t)&&r.push(e,t),this}_initCurve(e=0,t=0){this.currentPath?0===this.currentPath.points.length&&(this.currentPath.points=[e,t]):this.moveTo(e,t)}quadraticCurveTo(e,t,r,n){this._initCurve();const i=this.currentPath.points;return 0===i.length&&this.moveTo(0,0),Yt.curveTo(e,t,r,n,i),this}bezierCurveTo(e,t,r,n,i,o){return this._initCurve(),Vt.curveTo(e,t,r,n,i,o,this.currentPath.points),this}arcTo(e,t,r,n,i){this._initCurve(e,t);const o=this.currentPath.points,a=Gt.curveTo(e,t,r,n,i,o);if(a){const{cx:e,cy:t,radius:r,startAngle:n,endAngle:i,anticlockwise:o}=a;this.arc(e,t,r,n,i,o)}return this}arc(e,t,r,i,o,a=!1){if(i===o)return this;if(!a&&o<=i?o+=n.TO:a&&i<=o&&(i+=n.TO),o-i==0)return this;const s=e+Math.cos(i)*r,u=t+Math.sin(i)*r,l=this._geometry.closePointEps;let h=this.currentPath?this.currentPath.points:null;if(h){const e=Math.abs(h[h.length-2]-s),t=Math.abs(h[h.length-1]-u);e<l&&t<l||h.push(s,u)}else this.moveTo(s,u),h=this.currentPath.points;return Gt.arc(s,u,e,t,r,i,o,a,h),this}beginFill(e=0,t){return this.beginTextureFill({texture:n.gP.WHITE,color:e,alpha:t})}normalizeColor(e){const t=n.Q1.shared.setValue(e.color??0);e.color=t.toNumber(),e.alpha??(e.alpha=t.alpha)}beginTextureFill(e){const t={texture:n.gP.WHITE,color:16777215,matrix:null};e=Object.assign(t,e),this.normalizeColor(e),this.currentPath&&this.startPoly();const r=e.alpha>0;return r?(e.matrix&&(e.matrix=e.matrix.clone(),e.matrix.invert()),Object.assign(this._fillStyle,{visible:r},e)):this._fillStyle.reset(),this}endFill(){return this.finishPoly(),this._fillStyle.reset(),this}drawRect(e,t,r,i){return this.drawShape(new n.M_(e,t,r,i))}drawRoundedRect(e,t,r,i,o){return this.drawShape(new n.TE(e,t,r,i,o))}drawCircle(e,t,r){return this.drawShape(new n.jl(e,t,r))}drawEllipse(e,t,r,i){return this.drawShape(new n.Pp(e,t,r,i))}drawPolygon(...e){let t,r=!0;const i=e[0];i.points?(r=i.closeStroke,t=i.points):t=Array.isArray(e[0])?e[0]:e;const o=new n.tS(t);return o.closeStroke=r,this.drawShape(o),this}drawShape(e){return this._holeMode?this._geometry.drawHole(e,this._matrix):this._geometry.drawShape(e,this._fillStyle.clone(),this._lineStyle.clone(),this._matrix),this}clear(){return this._geometry.clear(),this._lineStyle.reset(),this._fillStyle.reset(),this._boundsID++,this._matrix=null,this._holeMode=!1,this.currentPath=null,this}isFastRect(){const e=this._geometry.graphicsData;return!(1!==e.length||e[0].shape.type!==n.HY.RECT||e[0].matrix||e[0].holes.length||e[0].lineStyle.visible&&e[0].lineStyle.width)}_render(e){this.finishPoly();const t=this._geometry;t.updateBatches(),t.batchable?(this.batchDirty!==t.batchDirty&&this._populateBatches(),this._renderBatched(e)):(e.batch.flush(),this._renderDirect(e))}_populateBatches(){const e=this._geometry,t=this.blendMode,r=e.batches.length;this.batchTint=-1,this._transformID=-1,this.batchDirty=e.batchDirty,this.batches.length=r,this.vertexData=new Float32Array(e.points);for(let i=0;i<r;i++){const r=e.batches[i],o=r.style.color,a=new Float32Array(this.vertexData.buffer,4*r.attribStart*2,2*r.attribSize),s=new Float32Array(e.uvsFloat32.buffer,4*r.attribStart*2,2*r.attribSize),u={vertexData:a,blendMode:t,indices:new Uint16Array(e.indicesUint16.buffer,2*r.start,r.size),uvs:s,_batchRGB:n.Q1.shared.setValue(o).toRgbArray(),_tintRGB:o,_texture:r.style.texture,alpha:r.style.alpha,worldAlpha:1};this.batches[i]=u}}_renderBatched(e){if(this.batches.length){e.batch.setObjectRenderer(e.plugins[this.pluginName]),this.calculateVertices(),this.calculateTints();for(let t=0,r=this.batches.length;t<r;t++){const r=this.batches[t];r.worldAlpha=this.worldAlpha*r.alpha,e.plugins[this.pluginName].render(r)}}}_renderDirect(e){const t=this._resolveDirectShader(e),r=this._geometry,i=this.worldAlpha,o=t.uniforms,a=r.drawCalls;o.translationMatrix=this.transform.worldTransform,n.Q1.shared.setValue(this._tintColor).premultiply(i).toArray(o.tint),e.shader.bind(t),e.geometry.bind(r,t),e.state.set(this.state);for(let t=0,n=a.length;t<n;t++)this._renderDrawCallDirect(e,r.drawCalls[t])}_renderDrawCallDirect(e,t){const{texArray:r,type:n,size:i,start:o}=t,a=r.count;for(let t=0;t<a;t++)e.texture.bind(r.elements[t],t);e.geometry.draw(n,i,o)}_resolveDirectShader(e){let t=this.shader;const r=this.pluginName;if(!t){if(!or[r]){const{maxTextures:t}=e.plugins[r],i=new Int32Array(t);for(let e=0;e<t;e++)i[e]=e;const o={tint:new Float32Array([1,1,1,1]),translationMatrix:new n.uq,default:n.k2.from({uSamplers:i},!0)},a=e.plugins[r]._shader.program;or[r]=new n.Mt(a,o)}t=or[r]}return t}_calculateBounds(){this.finishPoly();const e=this._geometry;if(!e.graphicsData.length)return;const{minX:t,minY:r,maxX:n,maxY:i}=e.bounds;this._bounds.addFrame(this.transform,t,r,n,i)}containsPoint(t){return this.worldTransform.applyInverse(t,e._TEMP_POINT),this._geometry.containsPoint(e._TEMP_POINT)}calculateTints(){if(this.batchTint!==this.tint){this.batchTint=this._tintColor.toNumber();for(let e=0;e<this.batches.length;e++){const t=this.batches[e];t._tintRGB=n.Q1.shared.setValue(this._tintColor).multiply(t._batchRGB).toLittleEndianNumber()}}}calculateVertices(){const e=this.transform._worldID;if(this._transformID===e)return;this._transformID=e;const t=this.transform.worldTransform,r=t.a,n=t.b,i=t.c,o=t.d,a=t.tx,s=t.ty,u=this._geometry.points,l=this.vertexData;let h=0;for(let e=0;e<u.length;e+=2){const t=u[e],c=u[e+1];l[h++]=r*t+i*c+a,l[h++]=o*c+n*t+s}}closePath(){const e=this.currentPath;return e&&(e.closeStroke=!0,this.finishPoly()),this}setMatrix(e){return this._matrix=e,this}beginHole(){return this.finishPoly(),this._holeMode=!0,this}endHole(){return this.finishPoly(),this._holeMode=!1,this}destroy(e){this._geometry.refCount--,0===this._geometry.refCount&&this._geometry.dispose(),this._matrix=null,this.currentPath=null,this._lineStyle.destroy(),this._lineStyle=null,this._fillStyle.destroy(),this._fillStyle=null,this._geometry=null,this.shader=null,this.vertexData=null,this.batches.length=0,this.batches=null,super.destroy(e)}};ar.curves=jt,ar._TEMP_POINT=new n.bR;let sr=ar;const ur={buildPoly:Lt,buildCircle:Dt,buildRectangle:Bt,buildRoundedRectangle:Nt,buildLine:qt,ArcUtils:Gt,BezierUtils:Vt,QuadraticUtils:Yt,BatchPart:Qt,FILL_COMMANDS:Xt,BATCH_POOL:Kt,DRAW_CALL_POOL:Zt};class lr{constructor(e,t){this.uvBuffer=e,this.uvMatrix=t,this.data=null,this._bufferUpdateId=-1,this._textureUpdateId=-1,this._updateID=0}update(e){if(!e&&this._bufferUpdateId===this.uvBuffer._updateID&&this._textureUpdateId===this.uvMatrix._updateID)return;this._bufferUpdateId=this.uvBuffer._updateID,this._textureUpdateId=this.uvMatrix._updateID;const t=this.uvBuffer.data;(!this.data||this.data.length!==t.length)&&(this.data=new Float32Array(t.length)),this.uvMatrix.multiplyUvs(t,this.data),this._updateID++}}const hr=new n.bR,cr=new n.tS,fr=class e extends h{constructor(e,t,r,i=n._4.TRIANGLES){super(),this.geometry=e,this.shader=t,this.state=r||n.Uw.for2d(),this.drawMode=i,this.start=0,this.size=0,this.uvs=null,this.indices=null,this.vertexData=new Float32Array(1),this.vertexDirty=-1,this._transformID=-1,this._roundPixels=n.W0.ROUND_PIXELS,this.batchUvs=null}get geometry(){return this._geometry}set geometry(e){this._geometry!==e&&(this._geometry&&(this._geometry.refCount--,0===this._geometry.refCount&&this._geometry.dispose()),this._geometry=e,this._geometry&&this._geometry.refCount++,this.vertexDirty=-1)}get uvBuffer(){return this.geometry.buffers[1]}get verticesBuffer(){return this.geometry.buffers[0]}set material(e){this.shader=e}get material(){return this.shader}set blendMode(e){this.state.blendMode=e}get blendMode(){return this.state.blendMode}set roundPixels(e){this._roundPixels!==e&&(this._transformID=-1),this._roundPixels=e}get roundPixels(){return this._roundPixels}get tint(){return"tint"in this.shader?this.shader.tint:null}set tint(e){this.shader.tint=e}get tintValue(){return this.shader.tintValue}get texture(){return"texture"in this.shader?this.shader.texture:null}set texture(e){this.shader.texture=e}_render(t){const r=this.geometry.buffers[0].data;this.shader.batchable&&this.drawMode===n._4.TRIANGLES&&r.length<2*e.BATCHABLE_SIZE?this._renderToBatch(t):this._renderDefault(t)}_renderDefault(e){const t=this.shader;t.alpha=this.worldAlpha,t.update&&t.update(),e.batch.flush(),t.uniforms.translationMatrix=this.transform.worldTransform.toArray(!0),e.shader.bind(t),e.state.set(this.state),e.geometry.bind(this.geometry,t),e.geometry.draw(this.drawMode,this.size,this.start,this.geometry.instanceCount)}_renderToBatch(e){const t=this.geometry,r=this.shader;r.uvMatrix&&(r.uvMatrix.update(),this.calculateUvs()),this.calculateVertices(),this.indices=t.indexBuffer.data,this._tintRGB=r._tintRGB,this._texture=r.texture;const n=this.material.pluginName;e.batch.setObjectRenderer(e.plugins[n]),e.plugins[n].render(this)}calculateVertices(){const e=this.geometry.buffers[0],t=e.data,r=e._updateID;if(r===this.vertexDirty&&this._transformID===this.transform._worldID)return;this._transformID=this.transform._worldID,this.vertexData.length!==t.length&&(this.vertexData=new Float32Array(t.length));const i=this.transform.worldTransform,o=i.a,a=i.b,s=i.c,u=i.d,l=i.tx,h=i.ty,c=this.vertexData;for(let e=0;e<c.length/2;e++){const r=t[2*e],n=t[2*e+1];c[2*e]=o*r+s*n+l,c[2*e+1]=a*r+u*n+h}if(this._roundPixels){const e=n.W0.RESOLUTION;for(let t=0;t<c.length;++t)c[t]=Math.round(c[t]*e)/e}this.vertexDirty=r}calculateUvs(){const e=this.geometry.buffers[1],t=this.shader;t.uvMatrix.isSimple?this.uvs=e.data:(this.batchUvs||(this.batchUvs=new lr(e,t.uvMatrix)),this.batchUvs.update(),this.uvs=this.batchUvs.data)}_calculateBounds(){this.calculateVertices(),this._bounds.addVertexData(this.vertexData,0,this.vertexData.length)}containsPoint(e){if(!this.getBounds().contains(e.x,e.y))return!1;this.worldTransform.applyInverse(e,hr);const t=this.geometry.getBuffer("aVertexPosition").data,r=cr.points,n=this.geometry.getIndex().data,i=n.length,o=4===this.drawMode?3:1;for(let e=0;e+2<i;e+=o){const i=2*n[e],o=2*n[e+1],a=2*n[e+2];if(r[0]=t[i],r[1]=t[i+1],r[2]=t[o],r[3]=t[o+1],r[4]=t[a],r[5]=t[a+1],cr.contains(hr.x,hr.y))return!0}return!1}destroy(e){super.destroy(e),this._cachedTexture&&(this._cachedTexture.destroy(),this._cachedTexture=null),this.geometry=null,this.shader=null,this.state=null,this.uvs=null,this.indices=null,this.vertexData=null}};fr.BATCHABLE_SIZE=100;let dr=fr;class pr extends n.V2{constructor(e,t,r){super();const i=new n.hp(e),o=new n.hp(t,!0),a=new n.hp(r,!0,!0);this.addAttribute("aVertexPosition",i,2,!1,n.QE.FLOAT).addAttribute("aTextureCoord",o,2,!1,n.QE.FLOAT).addIndex(a),this._updateId=-1}get vertexDirtyId(){return this.buffers[0]._updateID}}class yr extends n.Mt{constructor(e,t){const r={uSampler:e,alpha:1,uTextureMatrix:n.uq.IDENTITY,uColor:new Float32Array([1,1,1,1])};(t=Object.assign({tint:16777215,alpha:1,pluginName:"batch"},t)).uniforms&&Object.assign(r,t.uniforms),super(t.program||n.BP.from("attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform mat3 uTextureMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;\n}\n","varying vec2 vTextureCoord;\nuniform vec4 uColor;\n\nuniform sampler2D uSampler;\n\nvoid main(void)\n{\n    gl_FragColor = texture2D(uSampler, vTextureCoord) * uColor;\n}\n"),r),this._colorDirty=!1,this.uvMatrix=new n.NW(e),this.batchable=void 0===t.program,this.pluginName=t.pluginName,this._tintColor=new n.Q1(t.tint),this._tintRGB=this._tintColor.toLittleEndianNumber(),this._colorDirty=!0,this.alpha=t.alpha}get texture(){return this.uniforms.uSampler}set texture(e){this.uniforms.uSampler!==e&&(!this.uniforms.uSampler.baseTexture.alphaMode!=!e.baseTexture.alphaMode&&(this._colorDirty=!0),this.uniforms.uSampler=e,this.uvMatrix.texture=e)}set alpha(e){e!==this._alpha&&(this._alpha=e,this._colorDirty=!0)}get alpha(){return this._alpha}set tint(e){e!==this.tint&&(this._tintColor.setValue(e),this._tintRGB=this._tintColor.toLittleEndianNumber(),this._colorDirty=!0)}get tint(){return this._tintColor.value}get tintValue(){return this._tintColor.toNumber()}update(){if(this._colorDirty){this._colorDirty=!1;const e=this.texture.baseTexture.alphaMode;n.Q1.shared.setValue(this._tintColor).premultiply(this._alpha,e).toArray(this.uniforms.uColor)}this.uvMatrix.update()&&(this.uniforms.uTextureMatrix=this.uvMatrix.mapCoord)}}class mr extends pr{constructor(e=100,t=100,r=10,n=10){super(),this.segWidth=r,this.segHeight=n,this.width=e,this.height=t,this.build()}build(){const e=this.segWidth*this.segHeight,t=[],r=[],n=[],i=this.segWidth-1,o=this.segHeight-1,a=this.width/i,s=this.height/o;for(let n=0;n<e;n++){const e=n%this.segWidth,u=n/this.segWidth|0;t.push(e*a,u*s),r.push(e/i,u/o)}const u=i*o;for(let e=0;e<u;e++){const t=e%i,r=e/i|0,o=r*this.segWidth+t,a=r*this.segWidth+t+1,s=(r+1)*this.segWidth+t,u=(r+1)*this.segWidth+t+1;n.push(o,a,s,a,u,s)}this.buffers[0].data=new Float32Array(t),this.buffers[1].data=new Float32Array(r),this.indexBuffer.data=new Uint16Array(n),this.buffers[0].update(),this.buffers[1].update(),this.indexBuffer.update()}}class gr extends pr{constructor(e=200,t,r=0){super(new Float32Array(4*t.length),new Float32Array(4*t.length),new Uint16Array(6*(t.length-1))),this.points=t,this._width=e,this.textureScale=r,this.build()}get width(){return this._width}build(){const e=this.points;if(!e)return;const t=this.getBuffer("aVertexPosition"),r=this.getBuffer("aTextureCoord"),n=this.getIndex();if(e.length<1)return;t.data.length/4!==e.length&&(t.data=new Float32Array(4*e.length),r.data=new Float32Array(4*e.length),n.data=new Uint16Array(6*(e.length-1)));const i=r.data,o=n.data;i[0]=0,i[1]=0,i[2]=0,i[3]=1;let a=0,s=e[0];const u=this._width*this.textureScale,l=e.length;for(let t=0;t<l;t++){const r=4*t;if(this.textureScale>0){const r=s.x-e[t].x,n=s.y-e[t].y,i=Math.sqrt(r*r+n*n);s=e[t],a+=i/u}else a=t/(l-1);i[r]=a,i[r+1]=0,i[r+2]=a,i[r+3]=1}let h=0;for(let e=0;e<l-1;e++){const t=2*e;o[h++]=t,o[h++]=t+1,o[h++]=t+2,o[h++]=t+2,o[h++]=t+1,o[h++]=t+3}r.update(),n.update(),this.updateVertices()}updateVertices(){const e=this.points;if(e.length<1)return;let t,r=e[0],n=0,i=0;const o=this.buffers[0].data,a=e.length,s=this.textureScale>0?this.textureScale*this._width/2:this._width/2;for(let u=0;u<a;u++){const l=e[u],h=4*u;t=u<e.length-1?e[u+1]:l,i=-(t.x-r.x),n=t.y-r.y;let c=10*(1-u/(a-1));c>1&&(c=1);const f=Math.sqrt(n*n+i*i);f<1e-6?(n=0,i=0):(n/=f,i/=f,n*=s,i*=s),o[h]=l.x+n,o[h+1]=l.y+i,o[h+2]=l.x-n,o[h+3]=l.y-i,r=l}this.buffers[0].update()}update(){this.textureScale>0?this.build():this.updateVertices()}}class wr extends dr{constructor(e,t,r){super(new mr(e.width,e.height,t,r),new yr(n.gP.WHITE)),this.texture=e,this.autoResize=!0}textureUpdated(){this._textureID=this.shader.texture._updateID;const e=this.geometry,{width:t,height:r}=this.shader.texture;this.autoResize&&(e.width!==t||e.height!==r)&&(e.width=this.shader.texture.width,e.height=this.shader.texture.height,e.build())}set texture(e){this.shader.texture!==e&&(this.shader.texture=e,this._textureID=-1,e.baseTexture.valid?this.textureUpdated():e.once("update",this.textureUpdated,this))}get texture(){return this.shader.texture}_render(e){this._textureID!==this.shader.texture._updateID&&this.textureUpdated(),super._render(e)}destroy(e){this.shader.texture.off("update",this.textureUpdated,this),super.destroy(e)}}class vr extends wr{constructor(e,t,r,i,o){super(n.gP.WHITE,4,4),this._origWidth=e.orig.width,this._origHeight=e.orig.height,this._width=this._origWidth,this._height=this._origHeight,this._leftWidth=t??e.defaultBorders?.left??10,this._rightWidth=i??e.defaultBorders?.right??10,this._topHeight=r??e.defaultBorders?.top??10,this._bottomHeight=o??e.defaultBorders?.bottom??10,this.texture=e}textureUpdated(){this._textureID=this.shader.texture._updateID,this._refresh()}get vertices(){return this.geometry.getBuffer("aVertexPosition").data}set vertices(e){this.geometry.getBuffer("aVertexPosition").data=e}updateHorizontalVertices(){const e=this.vertices,t=this._getMinScale();e[9]=e[11]=e[13]=e[15]=this._topHeight*t,e[17]=e[19]=e[21]=e[23]=this._height-this._bottomHeight*t,e[25]=e[27]=e[29]=e[31]=this._height}updateVerticalVertices(){const e=this.vertices,t=this._getMinScale();e[2]=e[10]=e[18]=e[26]=this._leftWidth*t,e[4]=e[12]=e[20]=e[28]=this._width-this._rightWidth*t,e[6]=e[14]=e[22]=e[30]=this._width}_getMinScale(){const e=this._leftWidth+this._rightWidth,t=this._width>e?1:this._width/e,r=this._topHeight+this._bottomHeight,n=this._height>r?1:this._height/r;return Math.min(t,n)}get width(){return this._width}set width(e){this._width=e,this._refresh()}get height(){return this._height}set height(e){this._height=e,this._refresh()}get leftWidth(){return this._leftWidth}set leftWidth(e){this._leftWidth=e,this._refresh()}get rightWidth(){return this._rightWidth}set rightWidth(e){this._rightWidth=e,this._refresh()}get topHeight(){return this._topHeight}set topHeight(e){this._topHeight=e,this._refresh()}get bottomHeight(){return this._bottomHeight}set bottomHeight(e){this._bottomHeight=e,this._refresh()}_refresh(){const e=this.texture,t=this.geometry.buffers[1].data;this._origWidth=e.orig.width,this._origHeight=e.orig.height;const r=1/this._origWidth,n=1/this._origHeight;t[0]=t[8]=t[16]=t[24]=0,t[1]=t[3]=t[5]=t[7]=0,t[6]=t[14]=t[22]=t[30]=1,t[25]=t[27]=t[29]=t[31]=1,t[2]=t[10]=t[18]=t[26]=r*this._leftWidth,t[4]=t[12]=t[20]=t[28]=1-r*this._rightWidth,t[9]=t[11]=t[13]=t[15]=n*this._topHeight,t[17]=t[19]=t[21]=t[23]=1-n*this._bottomHeight,this.updateHorizontalVertices(),this.updateVerticalVertices(),this.geometry.buffers[0].update(),this.geometry.buffers[1].update()}}class br extends dr{constructor(e=n.gP.EMPTY,t,r,i,o){const a=new pr(t,r,i);a.getBuffer("aVertexPosition").static=!1;super(a,new yr(e),null,o),this.autoUpdate=!0}get vertices(){return this.geometry.getBuffer("aVertexPosition").data}set vertices(e){this.geometry.getBuffer("aVertexPosition").data=e}_render(e){this.autoUpdate&&this.geometry.getBuffer("aVertexPosition").update(),super._render(e)}}class xr extends dr{constructor(e,t,r=0){const i=new gr(e.height,t,r),o=new yr(e);r>0&&(e.baseTexture.wrapMode=n.uR.REPEAT),super(i,o),this.autoUpdate=!0}_render(e){const t=this.geometry;(this.autoUpdate||t._width!==this.shader.texture.height)&&(t._width=this.shader.texture.height,t.update()),super._render(e)}}class _r extends h{constructor(e=1500,t,r=16384,i=!1){super();r>16384&&(r=16384),this._properties=[!1,!0,!1,!1,!1],this._maxSize=e,this._batchSize=r,this._buffers=null,this._bufferUpdateIDs=[],this._updateID=0,this.interactiveChildren=!1,this.blendMode=n.B9.NORMAL,this.autoResize=i,this.roundPixels=!0,this.baseTexture=null,this.setProperties(t),this._tintColor=new n.Q1(0),this.tintRgb=new Float32Array(3),this.tint=16777215}setProperties(e){e&&(this._properties[0]="vertices"in e||"scale"in e?!!e.vertices||!!e.scale:this._properties[0],this._properties[1]="position"in e?!!e.position:this._properties[1],this._properties[2]="rotation"in e?!!e.rotation:this._properties[2],this._properties[3]="uvs"in e?!!e.uvs:this._properties[3],this._properties[4]="tint"in e||"alpha"in e?!!e.tint||!!e.alpha:this._properties[4])}updateTransform(){this.displayObjectUpdateTransform()}get tint(){return this._tintColor.value}set tint(e){this._tintColor.setValue(e),this._tintColor.toRgbArray(this.tintRgb)}render(e){!this.visible||this.worldAlpha<=0||!this.children.length||!this.renderable||(this.baseTexture||(this.baseTexture=this.children[0]._texture.baseTexture,this.baseTexture.valid||this.baseTexture.once("update",(()=>this.onChildrenChange(0)))),e.batch.setObjectRenderer(e.plugins.particle),e.plugins.particle.render(this))}onChildrenChange(e){const t=Math.floor(e/this._batchSize);for(;this._bufferUpdateIDs.length<t;)this._bufferUpdateIDs.push(0);this._bufferUpdateIDs[t]=++this._updateID}dispose(){if(this._buffers){for(let e=0;e<this._buffers.length;++e)this._buffers[e].destroy();this._buffers=null}}destroy(e){super.destroy(e),this.dispose(),this._properties=null,this._buffers=null,this._bufferUpdateIDs=null}}class Sr{constructor(e,t,r){this.geometry=new n.V2,this.indexBuffer=null,this.size=r,this.dynamicProperties=[],this.staticProperties=[];for(let r=0;r<e.length;++r){let i=e[r];i={attributeName:i.attributeName,size:i.size,uploadFunction:i.uploadFunction,type:i.type||n.QE.FLOAT,offset:i.offset},t[r]?this.dynamicProperties.push(i):this.staticProperties.push(i)}this.staticStride=0,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.dynamicStride=0,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this._updateID=0,this.initBuffers()}initBuffers(){const e=this.geometry;let t=0;this.indexBuffer=new n.hp(n.Wp.createIndicesForQuads(this.size),!0,!0),e.addIndex(this.indexBuffer),this.dynamicStride=0;for(let e=0;e<this.dynamicProperties.length;++e){const r=this.dynamicProperties[e];r.offset=t,t+=r.size,this.dynamicStride+=r.size}const r=new ArrayBuffer(this.size*this.dynamicStride*4*4);this.dynamicData=new Float32Array(r),this.dynamicDataUint32=new Uint32Array(r),this.dynamicBuffer=new n.hp(this.dynamicData,!1,!1);let i=0;this.staticStride=0;for(let e=0;e<this.staticProperties.length;++e){const t=this.staticProperties[e];t.offset=i,i+=t.size,this.staticStride+=t.size}const o=new ArrayBuffer(this.size*this.staticStride*4*4);this.staticData=new Float32Array(o),this.staticDataUint32=new Uint32Array(o),this.staticBuffer=new n.hp(this.staticData,!0,!1);for(let t=0;t<this.dynamicProperties.length;++t){const r=this.dynamicProperties[t];e.addAttribute(r.attributeName,this.dynamicBuffer,0,r.type===n.QE.UNSIGNED_BYTE,r.type,4*this.dynamicStride,4*r.offset)}for(let t=0;t<this.staticProperties.length;++t){const r=this.staticProperties[t];e.addAttribute(r.attributeName,this.staticBuffer,0,r.type===n.QE.UNSIGNED_BYTE,r.type,4*this.staticStride,4*r.offset)}}uploadDynamic(e,t,r){for(let i=0;i<this.dynamicProperties.length;i++){const o=this.dynamicProperties[i];o.uploadFunction(e,t,r,o.type===n.QE.UNSIGNED_BYTE?this.dynamicDataUint32:this.dynamicData,this.dynamicStride,o.offset)}this.dynamicBuffer._updateID++}uploadStatic(e,t,r){for(let i=0;i<this.staticProperties.length;i++){const o=this.staticProperties[i];o.uploadFunction(e,t,r,o.type===n.QE.UNSIGNED_BYTE?this.staticDataUint32:this.staticData,this.staticStride,o.offset)}this.staticBuffer._updateID++}destroy(){this.indexBuffer=null,this.dynamicProperties=null,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this.staticProperties=null,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.geometry.destroy()}}class Tr extends n.Pt{constructor(e){super(e),this.shader=null,this.properties=null,this.tempMatrix=new n.uq,this.properties=[{attributeName:"aVertexPosition",size:2,uploadFunction:this.uploadVertices,offset:0},{attributeName:"aPositionCoord",size:2,uploadFunction:this.uploadPosition,offset:0},{attributeName:"aRotation",size:1,uploadFunction:this.uploadRotation,offset:0},{attributeName:"aTextureCoord",size:2,uploadFunction:this.uploadUvs,offset:0},{attributeName:"aColor",size:1,type:n.QE.UNSIGNED_BYTE,uploadFunction:this.uploadTint,offset:0}],this.shader=n.Mt.from("attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\n\nattribute vec2 aPositionCoord;\nattribute float aRotation;\n\nuniform mat3 translationMatrix;\nuniform vec4 uColor;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nvoid main(void){\n    float x = (aVertexPosition.x) * cos(aRotation) - (aVertexPosition.y) * sin(aRotation);\n    float y = (aVertexPosition.x) * sin(aRotation) + (aVertexPosition.y) * cos(aRotation);\n\n    vec2 v = vec2(x, y);\n    v = v + aPositionCoord;\n\n    gl_Position = vec4((translationMatrix * vec3(v, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vColor = aColor * uColor;\n}\n","varying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n    vec4 color = texture2D(uSampler, vTextureCoord) * vColor;\n    gl_FragColor = color;\n}",{}),this.state=n.Uw.for2d()}render(e){const t=e.children,r=e._maxSize,i=e._batchSize,o=this.renderer;let a=t.length;if(0===a)return;a>r&&!e.autoResize&&(a=r);let s=e._buffers;s||(s=e._buffers=this.generateBuffers(e));const u=t[0]._texture.baseTexture,l=u.alphaMode>0;this.state.blendMode=n.Wp.correctBlendMode(e.blendMode,l),o.state.set(this.state);const h=o.gl,c=e.worldTransform.copyTo(this.tempMatrix);c.prepend(o.globalUniforms.uniforms.projectionMatrix),this.shader.uniforms.translationMatrix=c.toArray(!0),this.shader.uniforms.uColor=n.Q1.shared.setValue(e.tintRgb).premultiply(e.worldAlpha,l).toArray(this.shader.uniforms.uColor),this.shader.uniforms.uSampler=u,this.renderer.shader.bind(this.shader);let f=!1;for(let r=0,n=0;r<a;r+=i,n+=1){let u=a-r;u>i&&(u=i),n>=s.length&&s.push(this._generateOneMoreBuffer(e));const l=s[n];l.uploadDynamic(t,r,u);const c=e._bufferUpdateIDs[n]||0;f=f||l._updateID<c,f&&(l._updateID=e._updateID,l.uploadStatic(t,r,u)),o.geometry.bind(l.geometry),h.drawElements(h.TRIANGLES,6*u,h.UNSIGNED_SHORT,0)}}generateBuffers(e){const t=[],r=e._maxSize,n=e._batchSize,i=e._properties;for(let e=0;e<r;e+=n)t.push(new Sr(this.properties,i,n));return t}_generateOneMoreBuffer(e){const t=e._batchSize,r=e._properties;return new Sr(this.properties,r,t)}uploadVertices(e,t,r,n,i,o){let a=0,s=0,u=0,l=0;for(let h=0;h<r;++h){const r=e[t+h],c=r._texture,f=r.scale.x,d=r.scale.y,p=c.trim,y=c.orig;p?(s=p.x-r.anchor.x*y.width,a=s+p.width,l=p.y-r.anchor.y*y.height,u=l+p.height):(a=y.width*(1-r.anchor.x),s=y.width*-r.anchor.x,u=y.height*(1-r.anchor.y),l=y.height*-r.anchor.y),n[o]=s*f,n[o+1]=l*d,n[o+i]=a*f,n[o+i+1]=l*d,n[o+2*i]=a*f,n[o+2*i+1]=u*d,n[o+3*i]=s*f,n[o+3*i+1]=u*d,o+=4*i}}uploadPosition(e,t,r,n,i,o){for(let a=0;a<r;a++){const r=e[t+a].position;n[o]=r.x,n[o+1]=r.y,n[o+i]=r.x,n[o+i+1]=r.y,n[o+2*i]=r.x,n[o+2*i+1]=r.y,n[o+3*i]=r.x,n[o+3*i+1]=r.y,o+=4*i}}uploadRotation(e,t,r,n,i,o){for(let a=0;a<r;a++){const r=e[t+a].rotation;n[o]=r,n[o+i]=r,n[o+2*i]=r,n[o+3*i]=r,o+=4*i}}uploadUvs(e,t,r,n,i,o){for(let a=0;a<r;++a){const r=e[t+a]._texture._uvs;r?(n[o]=r.x0,n[o+1]=r.y0,n[o+i]=r.x1,n[o+i+1]=r.y1,n[o+2*i]=r.x2,n[o+2*i+1]=r.y2,n[o+3*i]=r.x3,n[o+3*i+1]=r.y3,o+=4*i):(n[o]=0,n[o+1]=0,n[o+i]=0,n[o+i+1]=0,n[o+2*i]=0,n[o+2*i+1]=0,n[o+3*i]=0,n[o+3*i+1]=0,o+=4*i)}}uploadTint(e,t,r,i,o,a){for(let s=0;s<r;++s){const r=e[t+s],u=n.Q1.shared.setValue(r._tintRGB).toPremultiplied(r.alpha,r.texture.baseTexture.alphaMode>0);i[a]=u,i[a+o]=u,i[a+2*o]=u,i[a+3*o]=u,a+=4*o}}destroy(){super.destroy(),this.shader&&(this.shader.destroy(),this.shader=null),this.tempMatrix=null}}Tr.extension={name:"particle",type:n.Ag.RendererPlugin},n.XO.add(Tr);var Er=(e=>(e[e.LINEAR_VERTICAL=0]="LINEAR_VERTICAL",e[e.LINEAR_HORIZONTAL=1]="LINEAR_HORIZONTAL",e))(Er||{});const Or={willReadFrequently:!0},Ar=class e{static get experimentalLetterSpacingSupported(){let t=e._experimentalLetterSpacingSupported;if(void 0!==t){const r=n.W0.ADAPTER.getCanvasRenderingContext2D().prototype;t=e._experimentalLetterSpacingSupported="letterSpacing"in r||"textLetterSpacing"in r}return t}constructor(e,t,r,n,i,o,a,s,u){this.text=e,this.style=t,this.width=r,this.height=n,this.lines=i,this.lineWidths=o,this.lineHeight=a,this.maxLineWidth=s,this.fontProperties=u}static measureText(t,r,n,i=e._canvas){n=n??r.wordWrap;const o=r.toFontString(),a=e.measureFont(o);0===a.fontSize&&(a.fontSize=r.fontSize,a.ascent=r.fontSize);const s=i.getContext("2d",Or);s.font=o;const u=(n?e.wordWrap(t,r,i):t).split(/(?:\r\n|\r|\n)/),l=new Array(u.length);let h=0;for(let t=0;t<u.length;t++){const n=e._measureText(u[t],r.letterSpacing,s);l[t]=n,h=Math.max(h,n)}let c=h+r.strokeThickness;r.dropShadow&&(c+=r.dropShadowDistance);const f=r.lineHeight||a.fontSize+r.strokeThickness;let d=Math.max(f,a.fontSize+2*r.strokeThickness)+r.leading+(u.length-1)*(f+r.leading);return r.dropShadow&&(d+=r.dropShadowDistance),new e(t,r,c,d,u,l,f+r.leading,h,a)}static _measureText(t,r,n){let i=!1;e.experimentalLetterSpacingSupported&&(e.experimentalLetterSpacing?(n.letterSpacing=`${r}px`,n.textLetterSpacing=`${r}px`,i=!0):(n.letterSpacing="0px",n.textLetterSpacing="0px"));let o=n.measureText(t).width;return o>0&&(i?o-=r:o+=(e.graphemeSegmenter(t).length-1)*r),o}static wordWrap(t,r,n=e._canvas){const i=n.getContext("2d",Or);let o=0,a="",s="";const u=Object.create(null),{letterSpacing:l,whiteSpace:h}=r,c=e.collapseSpaces(h),f=e.collapseNewlines(h);let d=!c;const p=r.wordWrapWidth+l,y=e.tokenize(t);for(let t=0;t<y.length;t++){let n=y[t];if(e.isNewline(n)){if(!f){s+=e.addLine(a),d=!c,a="",o=0;continue}n=" "}if(c){const t=e.isBreakingSpace(n),r=e.isBreakingSpace(a[a.length-1]);if(t&&r)continue}const h=e.getFromCache(n,l,u,i);if(h>p)if(""!==a&&(s+=e.addLine(a),a="",o=0),e.canBreakWords(n,r.breakWords)){const t=e.wordWrapSplit(n);for(let h=0;h<t.length;h++){let c=t[h],f=c,y=1;for(;t[h+y];){const i=t[h+y];if(e.canBreakChars(f,i,n,h,r.breakWords))break;c+=i,f=i,y++}h+=y-1;const m=e.getFromCache(c,l,u,i);m+o>p&&(s+=e.addLine(a),d=!1,a="",o=0),a+=c,o+=m}}else{a.length>0&&(s+=e.addLine(a),a="",o=0);const r=t===y.length-1;s+=e.addLine(n,!r),d=!1,a="",o=0}else h+o>p&&(d=!1,s+=e.addLine(a),a="",o=0),(a.length>0||!e.isBreakingSpace(n)||d)&&(a+=n,o+=h)}return s+=e.addLine(a,!1),s}static addLine(t,r=!0){return t=e.trimRight(t),t=r?`${t}\n`:t}static getFromCache(t,r,n,i){let o=n[t];return"number"!=typeof o&&(o=e._measureText(t,r,i)+r,n[t]=o),o}static collapseSpaces(e){return"normal"===e||"pre-line"===e}static collapseNewlines(e){return"normal"===e}static trimRight(t){if("string"!=typeof t)return"";for(let r=t.length-1;r>=0;r--){const n=t[r];if(!e.isBreakingSpace(n))break;t=t.slice(0,-1)}return t}static isNewline(t){return"string"==typeof t&&e._newlines.includes(t.charCodeAt(0))}static isBreakingSpace(t,r){return"string"==typeof t&&e._breakingSpaces.includes(t.charCodeAt(0))}static tokenize(t){const r=[];let n="";if("string"!=typeof t)return r;for(let i=0;i<t.length;i++){const o=t[i],a=t[i+1];e.isBreakingSpace(o,a)||e.isNewline(o)?(""!==n&&(r.push(n),n=""),r.push(o)):n+=o}return""!==n&&r.push(n),r}static canBreakWords(e,t){return t}static canBreakChars(e,t,r,n,i){return!0}static wordWrapSplit(t){return e.graphemeSegmenter(t)}static measureFont(t){if(e._fonts[t])return e._fonts[t];const r={ascent:0,descent:0,fontSize:0},n=e._canvas,i=e._context;i.font=t;const o=e.METRICS_STRING+e.BASELINE_SYMBOL,a=Math.ceil(i.measureText(o).width);let s=Math.ceil(i.measureText(e.BASELINE_SYMBOL).width);const u=Math.ceil(e.HEIGHT_MULTIPLIER*s);if(s=s*e.BASELINE_MULTIPLIER|0,0===a||0===u)return e._fonts[t]=r,r;n.width=a,n.height=u,i.fillStyle="#f00",i.fillRect(0,0,a,u),i.font=t,i.textBaseline="alphabetic",i.fillStyle="#000",i.fillText(o,0,s);const l=i.getImageData(0,0,a,u).data,h=l.length,c=4*a;let f=0,d=0,p=!1;for(f=0;f<s;++f){for(let e=0;e<c;e+=4)if(255!==l[d+e]){p=!0;break}if(p)break;d+=c}for(r.ascent=s-f,d=h-c,p=!1,f=u;f>s;--f){for(let e=0;e<c;e+=4)if(255!==l[d+e]){p=!0;break}if(p)break;d-=c}return r.descent=f-s,r.fontSize=r.ascent+r.descent,e._fonts[t]=r,r}static clearMetrics(t=""){t?delete e._fonts[t]:e._fonts={}}static get _canvas(){if(!e.__canvas){let t;try{const r=new OffscreenCanvas(0,0);if(r.getContext("2d",Or)?.measureText)return e.__canvas=r,r;t=n.W0.ADAPTER.createCanvas()}catch{t=n.W0.ADAPTER.createCanvas()}t.width=t.height=10,e.__canvas=t}return e.__canvas}static get _context(){return e.__context||(e.__context=e._canvas.getContext("2d",Or)),e.__context}};Ar.METRICS_STRING="|ÉqÅ",Ar.BASELINE_SYMBOL="M",Ar.BASELINE_MULTIPLIER=1.4,Ar.HEIGHT_MULTIPLIER=2,Ar.graphemeSegmenter=(()=>{if("function"==typeof Intl?.Segmenter){const e=new Intl.Segmenter;return t=>[...e.segment(t)].map((e=>e.segment))}return e=>[...e]})(),Ar.experimentalLetterSpacing=!1,Ar._fonts={},Ar._newlines=[10,13],Ar._breakingSpaces=[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288];let Ir=Ar;const Pr=["serif","sans-serif","monospace","cursive","fantasy","system-ui"],kr=class e{constructor(e){this.styleID=0,this.reset(),Rr(this,e,e)}clone(){const t={};return Rr(t,this,e.defaultStyle),new e(t)}reset(){Rr(this,e.defaultStyle,e.defaultStyle)}get align(){return this._align}set align(e){this._align!==e&&(this._align=e,this.styleID++)}get breakWords(){return this._breakWords}set breakWords(e){this._breakWords!==e&&(this._breakWords=e,this.styleID++)}get dropShadow(){return this._dropShadow}set dropShadow(e){this._dropShadow!==e&&(this._dropShadow=e,this.styleID++)}get dropShadowAlpha(){return this._dropShadowAlpha}set dropShadowAlpha(e){this._dropShadowAlpha!==e&&(this._dropShadowAlpha=e,this.styleID++)}get dropShadowAngle(){return this._dropShadowAngle}set dropShadowAngle(e){this._dropShadowAngle!==e&&(this._dropShadowAngle=e,this.styleID++)}get dropShadowBlur(){return this._dropShadowBlur}set dropShadowBlur(e){this._dropShadowBlur!==e&&(this._dropShadowBlur=e,this.styleID++)}get dropShadowColor(){return this._dropShadowColor}set dropShadowColor(e){const t=$r(e);this._dropShadowColor!==t&&(this._dropShadowColor=t,this.styleID++)}get dropShadowDistance(){return this._dropShadowDistance}set dropShadowDistance(e){this._dropShadowDistance!==e&&(this._dropShadowDistance=e,this.styleID++)}get fill(){return this._fill}set fill(e){const t=$r(e);this._fill!==t&&(this._fill=t,this.styleID++)}get fillGradientType(){return this._fillGradientType}set fillGradientType(e){this._fillGradientType!==e&&(this._fillGradientType=e,this.styleID++)}get fillGradientStops(){return this._fillGradientStops}set fillGradientStops(e){(function(e,t){if(!Array.isArray(e)||!Array.isArray(t)||e.length!==t.length)return!1;for(let r=0;r<e.length;++r)if(e[r]!==t[r])return!1;return!0})(this._fillGradientStops,e)||(this._fillGradientStops=e,this.styleID++)}get fontFamily(){return this._fontFamily}set fontFamily(e){this.fontFamily!==e&&(this._fontFamily=e,this.styleID++)}get fontSize(){return this._fontSize}set fontSize(e){this._fontSize!==e&&(this._fontSize=e,this.styleID++)}get fontStyle(){return this._fontStyle}set fontStyle(e){this._fontStyle!==e&&(this._fontStyle=e,this.styleID++)}get fontVariant(){return this._fontVariant}set fontVariant(e){this._fontVariant!==e&&(this._fontVariant=e,this.styleID++)}get fontWeight(){return this._fontWeight}set fontWeight(e){this._fontWeight!==e&&(this._fontWeight=e,this.styleID++)}get letterSpacing(){return this._letterSpacing}set letterSpacing(e){this._letterSpacing!==e&&(this._letterSpacing=e,this.styleID++)}get lineHeight(){return this._lineHeight}set lineHeight(e){this._lineHeight!==e&&(this._lineHeight=e,this.styleID++)}get leading(){return this._leading}set leading(e){this._leading!==e&&(this._leading=e,this.styleID++)}get lineJoin(){return this._lineJoin}set lineJoin(e){this._lineJoin!==e&&(this._lineJoin=e,this.styleID++)}get miterLimit(){return this._miterLimit}set miterLimit(e){this._miterLimit!==e&&(this._miterLimit=e,this.styleID++)}get padding(){return this._padding}set padding(e){this._padding!==e&&(this._padding=e,this.styleID++)}get stroke(){return this._stroke}set stroke(e){const t=$r(e);this._stroke!==t&&(this._stroke=t,this.styleID++)}get strokeThickness(){return this._strokeThickness}set strokeThickness(e){this._strokeThickness!==e&&(this._strokeThickness=e,this.styleID++)}get textBaseline(){return this._textBaseline}set textBaseline(e){this._textBaseline!==e&&(this._textBaseline=e,this.styleID++)}get trim(){return this._trim}set trim(e){this._trim!==e&&(this._trim=e,this.styleID++)}get whiteSpace(){return this._whiteSpace}set whiteSpace(e){this._whiteSpace!==e&&(this._whiteSpace=e,this.styleID++)}get wordWrap(){return this._wordWrap}set wordWrap(e){this._wordWrap!==e&&(this._wordWrap=e,this.styleID++)}get wordWrapWidth(){return this._wordWrapWidth}set wordWrapWidth(e){this._wordWrapWidth!==e&&(this._wordWrapWidth=e,this.styleID++)}toFontString(){const e="number"==typeof this.fontSize?`${this.fontSize}px`:this.fontSize;let t=this.fontFamily;Array.isArray(this.fontFamily)||(t=this.fontFamily.split(","));for(let e=t.length-1;e>=0;e--){let r=t[e].trim();!/([\"\'])[^\'\"]+\1/.test(r)&&!Pr.includes(r)&&(r=`"${r}"`),t[e]=r}return`${this.fontStyle} ${this.fontVariant} ${this.fontWeight} ${e} ${t.join(",")}`}};kr.defaultStyle={align:"left",breakWords:!1,dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"black",dropShadowDistance:5,fill:"black",fillGradientType:Er.LINEAR_VERTICAL,fillGradientStops:[],fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",leading:0,letterSpacing:0,lineHeight:0,lineJoin:"miter",miterLimit:10,padding:0,stroke:"black",strokeThickness:0,textBaseline:"alphabetic",trim:!1,whiteSpace:"pre",wordWrap:!1,wordWrapWidth:100};let Cr=kr;function $r(e){const t=n.Q1.shared,r=e=>{const r=t.setValue(e);return 1===r.alpha?r.toHex():r.toRgbaString()};return Array.isArray(e)?e.map(r):r(e)}function Rr(e,t,r){for(const n in r)Array.isArray(t[n])?e[n]=t[n].slice():e[n]=t[n]}const Dr={texture:!0,children:!1,baseTexture:!0},Mr=class e extends d{constructor(t,r,i){let o=!1;i||(i=n.W0.ADAPTER.createCanvas(),o=!0),i.width=3,i.height=3;const a=n.gP.from(i);a.orig=new n.M_,a.trim=new n.M_,super(a),this._ownCanvas=o,this.canvas=i,this.context=i.getContext("2d",{willReadFrequently:!0}),this._resolution=e.defaultResolution??n.W0.RESOLUTION,this._autoResolution=e.defaultAutoResolution,this._text=null,this._style=null,this._styleListener=null,this._font="",this.text=t,this.style=r,this.localStyleID=-1}static get experimentalLetterSpacing(){return Ir.experimentalLetterSpacing}static set experimentalLetterSpacing(e){n.Wp.deprecation("7.1.0","Text.experimentalLetterSpacing is deprecated, use TextMetrics.experimentalLetterSpacing"),Ir.experimentalLetterSpacing=e}updateText(e){const t=this._style;if(this.localStyleID!==t.styleID&&(this.dirty=!0,this.localStyleID=t.styleID),!this.dirty&&e)return;this._font=this._style.toFontString();const r=this.context,i=Ir.measureText(this._text||" ",this._style,this._style.wordWrap,this.canvas),o=i.width,a=i.height,s=i.lines,u=i.lineHeight,l=i.lineWidths,h=i.maxLineWidth,c=i.fontProperties;let f,d;this.canvas.width=Math.ceil(Math.ceil(Math.max(1,o)+2*t.padding)*this._resolution),this.canvas.height=Math.ceil(Math.ceil(Math.max(1,a)+2*t.padding)*this._resolution),r.scale(this._resolution,this._resolution),r.clearRect(0,0,this.canvas.width,this.canvas.height),r.font=this._font,r.lineWidth=t.strokeThickness,r.textBaseline=t.textBaseline,r.lineJoin=t.lineJoin,r.miterLimit=t.miterLimit;const p=t.dropShadow?2:1;for(let e=0;e<p;++e){const o=t.dropShadow&&0===e,p=o?Math.ceil(Math.max(1,a)+2*t.padding):0,y=p*this._resolution;if(o){r.fillStyle="black",r.strokeStyle="black";const e=t.dropShadowColor,i=t.dropShadowBlur*this._resolution,o=t.dropShadowDistance*this._resolution;r.shadowColor=n.Q1.shared.setValue(e).setAlpha(t.dropShadowAlpha).toRgbaString(),r.shadowBlur=i,r.shadowOffsetX=Math.cos(t.dropShadowAngle)*o,r.shadowOffsetY=Math.sin(t.dropShadowAngle)*o+y}else r.fillStyle=this._generateFillStyle(t,s,i),r.strokeStyle=t.stroke,r.shadowColor="black",r.shadowBlur=0,r.shadowOffsetX=0,r.shadowOffsetY=0;let m=(u-c.fontSize)/2;u-c.fontSize<0&&(m=0);for(let e=0;e<s.length;e++)f=t.strokeThickness/2,d=t.strokeThickness/2+e*u+c.ascent+m,"right"===t.align?f+=h-l[e]:"center"===t.align&&(f+=(h-l[e])/2),t.stroke&&t.strokeThickness&&this.drawLetterSpacing(s[e],f+t.padding,d+t.padding-p,!0),t.fill&&this.drawLetterSpacing(s[e],f+t.padding,d+t.padding-p)}this.updateTexture()}drawLetterSpacing(e,t,r,n=!1){const i=this._style.letterSpacing;let o=!1;if(Ir.experimentalLetterSpacingSupported&&(Ir.experimentalLetterSpacing?(this.context.letterSpacing=`${i}px`,this.context.textLetterSpacing=`${i}px`,o=!0):(this.context.letterSpacing="0px",this.context.textLetterSpacing="0px")),0===i||o)return void(n?this.context.strokeText(e,t,r):this.context.fillText(e,t,r));let a=t;const s=Ir.graphemeSegmenter(e);let u=this.context.measureText(e).width,l=0;for(let e=0;e<s.length;++e){const t=s[e];n?this.context.strokeText(t,a,r):this.context.fillText(t,a,r);let o="";for(let t=e+1;t<s.length;++t)o+=s[t];l=this.context.measureText(o).width,a+=u-l+i,u=l}}updateTexture(){const e=this.canvas;if(this._style.trim){const t=n.Wp.trimCanvas(e);t.data&&(e.width=t.width,e.height=t.height,this.context.putImageData(t.data,0,0))}const t=this._texture,r=this._style,i=r.trim?0:r.padding,o=t.baseTexture;t.trim.width=t._frame.width=e.width/this._resolution,t.trim.height=t._frame.height=e.height/this._resolution,t.trim.x=-i,t.trim.y=-i,t.orig.width=t._frame.width-2*i,t.orig.height=t._frame.height-2*i,this._onTextureUpdate(),o.setRealSize(e.width,e.height,this._resolution),t.updateUvs(),this.dirty=!1}_render(e){this._autoResolution&&this._resolution!==e.resolution&&(this._resolution=e.resolution,this.dirty=!0),this.updateText(!0),super._render(e)}updateTransform(){this.updateText(!0),super.updateTransform()}getBounds(e,t){return this.updateText(!0),-1===this._textureID&&(e=!1),super.getBounds(e,t)}getLocalBounds(e){return this.updateText(!0),super.getLocalBounds.call(this,e)}_calculateBounds(){this.calculateVertices(),this._bounds.addQuad(this.vertexData)}_generateFillStyle(e,t,r){const n=e.fill;if(!Array.isArray(n))return n;if(1===n.length)return n[0];let i;const o=e.dropShadow?e.dropShadowDistance:0,a=e.padding||0,s=this.canvas.width/this._resolution-o-2*a,u=this.canvas.height/this._resolution-o-2*a,l=n.slice(),h=e.fillGradientStops.slice();if(!h.length){const e=l.length+1;for(let t=1;t<e;++t)h.push(t/e)}if(l.unshift(n[0]),h.unshift(0),l.push(n[n.length-1]),h.push(1),e.fillGradientType===Er.LINEAR_VERTICAL){i=this.context.createLinearGradient(s/2,a,s/2,u+a);const n=r.fontProperties.fontSize+e.strokeThickness;for(let e=0;e<t.length;e++){const o=r.lineHeight*(e-1)+n,a=r.lineHeight*e;let s=a;e>0&&o>a&&(s=(a+o)/2);const c=a+n,f=r.lineHeight*(e+1);let d=c;e+1<t.length&&f<c&&(d=(c+f)/2);const p=(d-s)/u;for(let e=0;e<l.length;e++){let t=0;t="number"==typeof h[e]?h[e]:e/l.length;let r=Math.min(1,Math.max(0,s/u+t*p));r=Number(r.toFixed(5)),i.addColorStop(r,l[e])}}}else{i=this.context.createLinearGradient(a,u/2,s+a,u/2);const e=l.length+1;let t=1;for(let r=0;r<l.length;r++){let n;n="number"==typeof h[r]?h[r]:t/e,i.addColorStop(n,l[r]),t++}}return i}destroy(e){"boolean"==typeof e&&(e={children:e}),e=Object.assign({},Dr,e),super.destroy(e),this._ownCanvas&&(this.canvas.height=this.canvas.width=0),this.context=null,this.canvas=null,this._style=null}get width(){return this.updateText(!0),Math.abs(this.scale.x)*this._texture.orig.width}set width(e){this.updateText(!0);const t=n.Wp.sign(this.scale.x)||1;this.scale.x=t*e/this._texture.orig.width,this._width=e}get height(){return this.updateText(!0),Math.abs(this.scale.y)*this._texture.orig.height}set height(e){this.updateText(!0);const t=n.Wp.sign(this.scale.y)||1;this.scale.y=t*e/this._texture.orig.height,this._height=e}get style(){return this._style}set style(e){e=e||{},this._style=e instanceof Cr?e:new Cr(e),this.localStyleID=-1,this.dirty=!0}get text(){return this._text}set text(e){e=String(e??""),this._text!==e&&(this._text=e,this.dirty=!0)}get resolution(){return this._resolution}set resolution(e){this._autoResolution=!1,this._resolution!==e&&(this._resolution=e,this.dirty=!0)}};Mr.defaultAutoResolution=!0;let Lr=Mr;class Br{constructor(e){this.maxItemsPerFrame=e,this.itemsLeft=0}beginFrame(){this.itemsLeft=this.maxItemsPerFrame}allowedToUpload(){return this.itemsLeft-- >0}}function Nr(e,t){let r=!1;if(e?._textures?.length)for(let i=0;i<e._textures.length;i++)if(e._textures[i]instanceof n.gP){const n=e._textures[i].baseTexture;t.includes(n)||(t.push(n),r=!0)}return r}function Fr(e,t){if(e.baseTexture instanceof n.t5){const r=e.baseTexture;return t.includes(r)||t.push(r),!0}return!1}function Ur(e,t){if(e._texture&&e._texture instanceof n.gP){const r=e._texture.baseTexture;return t.includes(r)||t.push(r),!0}return!1}function jr(e,t){return t instanceof Lr&&(t.updateText(!0),!0)}function zr(e,t){if(t instanceof Cr){const e=t.toFontString();return Ir.measureFont(e),!0}return!1}function Gr(e,t){if(e instanceof Lr){t.includes(e.style)||t.push(e.style),t.includes(e)||t.push(e);const r=e._texture.baseTexture;return t.includes(r)||t.push(r),!0}return!1}function Vr(e,t){return e instanceof Cr&&(t.includes(e)||t.push(e),!0)}const Wr=class e{constructor(t){this.limiter=new Br(e.uploadsPerFrame),this.renderer=t,this.uploadHookHelper=null,this.queue=[],this.addHooks=[],this.uploadHooks=[],this.completes=[],this.ticking=!1,this.delayedTick=()=>{this.queue&&this.prepareItems()},this.registerFindHook(Gr),this.registerFindHook(Vr),this.registerFindHook(Nr),this.registerFindHook(Fr),this.registerFindHook(Ur),this.registerUploadHook(jr),this.registerUploadHook(zr)}upload(e){return new Promise((t=>{e&&this.add(e),this.queue.length?(this.completes.push(t),this.ticking||(this.ticking=!0,n.Rv.system.addOnce(this.tick,this,n.dQ.UTILITY))):t()}))}tick(){setTimeout(this.delayedTick,0)}prepareItems(){for(this.limiter.beginFrame();this.queue.length&&this.limiter.allowedToUpload();){const e=this.queue[0];let t=!1;if(e&&!e._destroyed)for(let r=0,n=this.uploadHooks.length;r<n;r++)if(this.uploadHooks[r](this.uploadHookHelper,e)){this.queue.shift(),t=!0;break}t||this.queue.shift()}if(this.queue.length)n.Rv.system.addOnce(this.tick,this,n.dQ.UTILITY);else{this.ticking=!1;const e=this.completes.slice(0);this.completes.length=0;for(let t=0,r=e.length;t<r;t++)e[t]()}}registerFindHook(e){return e&&this.addHooks.push(e),this}registerUploadHook(e){return e&&this.uploadHooks.push(e),this}add(e){for(let t=0,r=this.addHooks.length;t<r&&!this.addHooks[t](e,this.queue);t++);if(e instanceof h)for(let t=e.children.length-1;t>=0;t--)this.add(e.children[t]);return this}destroy(){this.ticking&&n.Rv.system.remove(this.tick,this),this.ticking=!1,this.addHooks=null,this.uploadHooks=null,this.renderer=null,this.completes=null,this.queue=null,this.limiter=null,this.uploadHookHelper=null}};Wr.uploadsPerFrame=4;let Hr=Wr;function qr(e,t){return t instanceof n.t5&&(t._glTextures[e.CONTEXT_UID]||e.texture.bind(t),!0)}function Yr(e,t){if(!(t instanceof sr))return!1;const{geometry:r}=t;t.finishPoly(),r.updateBatches();const{batches:n}=r;for(let t=0;t<n.length;t++){const{texture:r}=n[t].style;r&&qr(e,r.baseTexture)}return r.batchable||e.geometry.bind(r,t._resolveDirectShader(e)),!0}function Xr(e,t){return e instanceof sr&&(t.push(e),!0)}Object.defineProperties(n.W0,{UPLOADS_PER_FRAME:{get:()=>Hr.uploadsPerFrame,set(e){n.Wp.deprecation("7.1.0","settings.UPLOADS_PER_FRAME is deprecated, use prepare.BasePrepare.uploadsPerFrame"),Hr.uploadsPerFrame=e}}});class Kr extends Hr{constructor(e){super(e),this.uploadHookHelper=this.renderer,this.registerFindHook(Xr),this.registerUploadHook(qr),this.registerUploadHook(Yr)}}Kr.extension={name:"prepare",type:n.Ag.RendererSystem},n.XO.add(Kr);class Zr{constructor(e){this.maxMilliseconds=e,this.frameStart=0}beginFrame(){this.frameStart=Date.now()}allowedToUpload(){return Date.now()-this.frameStart<this.maxMilliseconds}}class Jr extends d{constructor(e,t=!0){super(e[0]instanceof n.gP?e[0]:e[0].texture),this._textures=null,this._durations=null,this._autoUpdate=t,this._isConnectedToTicker=!1,this.animationSpeed=1,this.loop=!0,this.updateAnchor=!1,this.onComplete=null,this.onFrameChange=null,this.onLoop=null,this._currentTime=0,this._playing=!1,this._previousFrame=null,this.textures=e}stop(){this._playing&&(this._playing=!1,this._autoUpdate&&this._isConnectedToTicker&&(n.Rv.shared.remove(this.update,this),this._isConnectedToTicker=!1))}play(){this._playing||(this._playing=!0,this._autoUpdate&&!this._isConnectedToTicker&&(n.Rv.shared.add(this.update,this,n.dQ.HIGH),this._isConnectedToTicker=!0))}gotoAndStop(e){this.stop(),this.currentFrame=e}gotoAndPlay(e){this.currentFrame=e,this.play()}update(e){if(!this._playing)return;const t=this.animationSpeed*e,r=this.currentFrame;if(null!==this._durations){let r=this._currentTime%1*this._durations[this.currentFrame];for(r+=t/60*1e3;r<0;)this._currentTime--,r+=this._durations[this.currentFrame];const n=Math.sign(this.animationSpeed*e);for(this._currentTime=Math.floor(this._currentTime);r>=this._durations[this.currentFrame];)r-=this._durations[this.currentFrame]*n,this._currentTime+=n;this._currentTime+=r/this._durations[this.currentFrame]}else this._currentTime+=t;this._currentTime<0&&!this.loop?(this.gotoAndStop(0),this.onComplete&&this.onComplete()):this._currentTime>=this._textures.length&&!this.loop?(this.gotoAndStop(this._textures.length-1),this.onComplete&&this.onComplete()):r!==this.currentFrame&&(this.loop&&this.onLoop&&(this.animationSpeed>0&&this.currentFrame<r||this.animationSpeed<0&&this.currentFrame>r)&&this.onLoop(),this.updateTexture())}updateTexture(){const e=this.currentFrame;this._previousFrame!==e&&(this._previousFrame=e,this._texture=this._textures[e],this._textureID=-1,this._textureTrimmedID=-1,this._cachedTint=16777215,this.uvs=this._texture._uvs.uvsFloat32,this.updateAnchor&&this._anchor.copyFrom(this._texture.defaultAnchor),this.onFrameChange&&this.onFrameChange(this.currentFrame))}destroy(e){this.stop(),super.destroy(e),this.onComplete=null,this.onFrameChange=null,this.onLoop=null}static fromFrames(e){const t=[];for(let r=0;r<e.length;++r)t.push(n.gP.from(e[r]));return new Jr(t)}static fromImages(e){const t=[];for(let r=0;r<e.length;++r)t.push(n.gP.from(e[r]));return new Jr(t)}get totalFrames(){return this._textures.length}get textures(){return this._textures}set textures(e){if(e[0]instanceof n.gP)this._textures=e,this._durations=null;else{this._textures=[],this._durations=[];for(let t=0;t<e.length;t++)this._textures.push(e[t].texture),this._durations.push(e[t].time)}this._previousFrame=null,this.gotoAndStop(0),this.updateTexture()}get currentFrame(){let e=Math.floor(this._currentTime)%this._textures.length;return e<0&&(e+=this._textures.length),e}set currentFrame(e){if(e<0||e>this.totalFrames-1)throw new Error(`[AnimatedSprite]: Invalid frame index value ${e}, expected to be between 0 and totalFrames ${this.totalFrames}.`);const t=this.currentFrame;this._currentTime=e,t!==this.currentFrame&&this.updateTexture()}get playing(){return this._playing}get autoUpdate(){return this._autoUpdate}set autoUpdate(e){e!==this._autoUpdate&&(this._autoUpdate=e,!this._autoUpdate&&this._isConnectedToTicker?(n.Rv.shared.remove(this.update,this),this._isConnectedToTicker=!1):this._autoUpdate&&!this._isConnectedToTicker&&this._playing&&(n.Rv.shared.add(this.update,this),this._isConnectedToTicker=!0))}}const Qr=new n.bR;class en extends d{constructor(e,t=100,r=100){super(e),this.tileTransform=new n.dL,this._width=t,this._height=r,this.uvMatrix=this.texture.uvMatrix||new n.NW(e),this.pluginName="tilingSprite",this.uvRespectAnchor=!1}get clampMargin(){return this.uvMatrix.clampMargin}set clampMargin(e){this.uvMatrix.clampMargin=e,this.uvMatrix.update(!0)}get tileScale(){return this.tileTransform.scale}set tileScale(e){this.tileTransform.scale.copyFrom(e)}get tilePosition(){return this.tileTransform.position}set tilePosition(e){this.tileTransform.position.copyFrom(e)}_onTextureUpdate(){this.uvMatrix&&(this.uvMatrix.texture=this._texture),this._cachedTint=16777215}_render(e){const t=this._texture;!t||!t.valid||(this.tileTransform.updateLocalTransform(),this.uvMatrix.update(),e.batch.setObjectRenderer(e.plugins[this.pluginName]),e.plugins[this.pluginName].render(this))}_calculateBounds(){const e=this._width*-this._anchor._x,t=this._height*-this._anchor._y,r=this._width*(1-this._anchor._x),n=this._height*(1-this._anchor._y);this._bounds.addFrame(this.transform,e,t,r,n)}getLocalBounds(e){return 0===this.children.length?(this._bounds.minX=this._width*-this._anchor._x,this._bounds.minY=this._height*-this._anchor._y,this._bounds.maxX=this._width*(1-this._anchor._x),this._bounds.maxY=this._height*(1-this._anchor._y),e||(this._localBoundsRect||(this._localBoundsRect=new n.M_),e=this._localBoundsRect),this._bounds.getRectangle(e)):super.getLocalBounds.call(this,e)}containsPoint(e){this.worldTransform.applyInverse(e,Qr);const t=this._width,r=this._height,n=-t*this.anchor._x;if(Qr.x>=n&&Qr.x<n+t){const e=-r*this.anchor._y;if(Qr.y>=e&&Qr.y<e+r)return!0}return!1}destroy(e){super.destroy(e),this.tileTransform=null,this.uvMatrix=null}static from(e,t){const r=e instanceof n.gP?e:n.gP.from(e,t);return new en(r,t.width,t.height)}get width(){return this._width}set width(e){this._width=e}get height(){return this._height}set height(e){this._height=e}}var tn="#version 100\n#define SHADER_NAME Tiling-Sprite-100\n\nprecision lowp float;\n\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform mat3 uTransform;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;\n}\n";const rn=new n.uq;class nn extends n.Pt{constructor(e){super(e),e.runners.contextChange.add(this),this.quad=new n.X1,this.state=n.Uw.for2d()}contextChange(){const e=this.renderer,t={globals:e.globalUniforms};this.simpleShader=n.Mt.from(tn,"#version 100\n#define SHADER_NAME Tiling-Sprite-Simple-100\n\nprecision lowp float;\n\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform vec4 uColor;\n\nvoid main(void)\n{\n    vec4 texSample = texture2D(uSampler, vTextureCoord);\n    gl_FragColor = texSample * uColor;\n}\n",t),this.shader=e.context.webGLVersion>1?n.Mt.from("#version 300 es\n#define SHADER_NAME Tiling-Sprite-300\n\nprecision lowp float;\n\nin vec2 aVertexPosition;\nin vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform mat3 uTransform;\n\nout vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;\n}\n","#version 300 es\n#define SHADER_NAME Tiling-Sprite-100\n\nprecision lowp float;\n\nin vec2 vTextureCoord;\n\nout vec4 fragmentColor;\n\nuniform sampler2D uSampler;\nuniform vec4 uColor;\nuniform mat3 uMapCoord;\nuniform vec4 uClampFrame;\nuniform vec2 uClampOffset;\n\nvoid main(void)\n{\n    vec2 coord = vTextureCoord + ceil(uClampOffset - vTextureCoord);\n    coord = (uMapCoord * vec3(coord, 1.0)).xy;\n    vec2 unclamped = coord;\n    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);\n\n    vec4 texSample = texture(uSampler, coord, unclamped == coord ? 0.0f : -32.0f);// lod-bias very negative to force lod 0\n\n    fragmentColor = texSample * uColor;\n}\n",t):n.Mt.from(tn,"#version 100\n#ifdef GL_EXT_shader_texture_lod\n    #extension GL_EXT_shader_texture_lod : enable\n#endif\n#define SHADER_NAME Tiling-Sprite-100\n\nprecision lowp float;\n\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform vec4 uColor;\nuniform mat3 uMapCoord;\nuniform vec4 uClampFrame;\nuniform vec2 uClampOffset;\n\nvoid main(void)\n{\n    vec2 coord = vTextureCoord + ceil(uClampOffset - vTextureCoord);\n    coord = (uMapCoord * vec3(coord, 1.0)).xy;\n    vec2 unclamped = coord;\n    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);\n\n    #ifdef GL_EXT_shader_texture_lod\n        vec4 texSample = unclamped == coord\n            ? texture2D(uSampler, coord) \n            : texture2DLodEXT(uSampler, coord, 0);\n    #else\n        vec4 texSample = texture2D(uSampler, coord);\n    #endif\n\n    gl_FragColor = texSample * uColor;\n}\n",t)}render(e){const t=this.renderer,r=this.quad;let i=r.vertices;i[0]=i[6]=e._width*-e.anchor.x,i[1]=i[3]=e._height*-e.anchor.y,i[2]=i[4]=e._width*(1-e.anchor.x),i[5]=i[7]=e._height*(1-e.anchor.y);const o=e.uvRespectAnchor?e.anchor.x:0,a=e.uvRespectAnchor?e.anchor.y:0;i=r.uvs,i[0]=i[6]=-o,i[1]=i[3]=-a,i[2]=i[4]=1-o,i[5]=i[7]=1-a,r.invalidate();const s=e._texture,u=s.baseTexture,l=u.alphaMode>0,h=e.tileTransform.localTransform,c=e.uvMatrix;let f=u.isPowerOfTwo&&s.frame.width===u.width&&s.frame.height===u.height;f&&(u._glTextures[t.CONTEXT_UID]?f=u.wrapMode!==n.uR.CLAMP:u.wrapMode===n.uR.CLAMP&&(u.wrapMode=n.uR.REPEAT));const d=f?this.simpleShader:this.shader,p=s.width,y=s.height,m=e._width,g=e._height;rn.set(h.a*p/m,h.b*p/g,h.c*y/m,h.d*y/g,h.tx/m,h.ty/g),rn.invert(),f?rn.prepend(c.mapCoord):(d.uniforms.uMapCoord=c.mapCoord.toArray(!0),d.uniforms.uClampFrame=c.uClampFrame,d.uniforms.uClampOffset=c.uClampOffset),d.uniforms.uTransform=rn.toArray(!0),d.uniforms.uColor=n.Q1.shared.setValue(e.tint).premultiply(e.worldAlpha,l).toArray(d.uniforms.uColor),d.uniforms.translationMatrix=e.transform.worldTransform.toArray(!0),d.uniforms.uSampler=s,t.shader.bind(d),t.geometry.bind(r),this.state.blendMode=n.Wp.correctBlendMode(e.blendMode,l),t.state.set(this.state),t.geometry.draw(this.renderer.gl.TRIANGLES,6,0)}}nn.extension={name:"tilingSprite",type:n.Ag.RendererPlugin},n.XO.add(nn);const on=class e{constructor(e,t,r){this.linkedSheets=[],(e instanceof n.t5||e instanceof n.gP)&&(e={texture:e,data:t,resolutionFilename:r});const{texture:i,data:o,resolutionFilename:a=null,cachePrefix:s=""}=e;this.cachePrefix=s,this._texture=i instanceof n.gP?i:null,this.baseTexture=i instanceof n.t5?i:this._texture.baseTexture,this.textures={},this.animations={},this.data=o;const u=this.baseTexture.resource;this.resolution=this._updateResolution(a||(u?u.url:null)),this._frames=this.data.frames,this._frameKeys=Object.keys(this._frames),this._batchIndex=0,this._callback=null}_updateResolution(e=null){const{scale:t}=this.data.meta;let r=n.Wp.getResolutionOfUrl(e,null);return null===r&&(r="number"==typeof t?t:parseFloat(t??"1")),1!==r&&this.baseTexture.setResolution(r),r}parse(){return new Promise((t=>{this._callback=t,this._batchIndex=0,this._frameKeys.length<=e.BATCH_SIZE?(this._processFrames(0),this._processAnimations(),this._parseComplete()):this._nextBatch()}))}_processFrames(t){let r=t;const i=e.BATCH_SIZE;for(;r-t<i&&r<this._frameKeys.length;){const e=this._frameKeys[r],t=this._frames[e],i=t.frame;if(i){let r=null,o=null;const a=!1!==t.trimmed&&t.sourceSize?t.sourceSize:t.frame,s=new n.M_(0,0,Math.floor(a.w)/this.resolution,Math.floor(a.h)/this.resolution);r=t.rotated?new n.M_(Math.floor(i.x)/this.resolution,Math.floor(i.y)/this.resolution,Math.floor(i.h)/this.resolution,Math.floor(i.w)/this.resolution):new n.M_(Math.floor(i.x)/this.resolution,Math.floor(i.y)/this.resolution,Math.floor(i.w)/this.resolution,Math.floor(i.h)/this.resolution),!1!==t.trimmed&&t.spriteSourceSize&&(o=new n.M_(Math.floor(t.spriteSourceSize.x)/this.resolution,Math.floor(t.spriteSourceSize.y)/this.resolution,Math.floor(i.w)/this.resolution,Math.floor(i.h)/this.resolution)),this.textures[e]=new n.gP(this.baseTexture,r,s,o,t.rotated?2:0,t.anchor,t.borders),n.gP.addToCache(this.textures[e],this.cachePrefix+e.toString())}r++}}_processAnimations(){const e=this.data.animations||{};for(const t in e){this.animations[t]=[];for(let r=0;r<e[t].length;r++){const n=e[t][r];this.animations[t].push(this.textures[n])}}}_parseComplete(){const e=this._callback;this._callback=null,this._batchIndex=0,e.call(this,this.textures)}_nextBatch(){this._processFrames(this._batchIndex*e.BATCH_SIZE),this._batchIndex++,setTimeout((()=>{this._batchIndex*e.BATCH_SIZE<this._frameKeys.length?this._nextBatch():(this._processAnimations(),this._parseComplete())}),0)}destroy(e=!1){for(const e in this.textures)this.textures[e].destroy();this._frames=null,this._frameKeys=null,this.data=null,this.textures=null,e&&(this._texture?.destroy(),this.baseTexture.destroy()),this._texture=null,this.baseTexture=null,this.linkedSheets=[]}};on.BATCH_SIZE=1e3;let an=on;const sn=["jpg","png","jpeg","avif","webp","s3tc","s3tc_sRGB","etc","etc1","pvrtc","atc","astc","bptc"];function un(e,t,r){const i={};if(e.forEach((e=>{i[e]=t})),Object.keys(t.textures).forEach((e=>{i[`${t.cachePrefix}${e}`]=t.textures[e]})),!r){const r=n.Wp.path.dirname(e[0]);t.linkedSheets.forEach(((e,n)=>{Object.assign(i,un([`${r}/${t.data.meta.related_multi_packs[n]}`],e,!0))}))}return i}const ln={extension:n.Ag.Asset,cache:{test:e=>e instanceof an,getCacheableAssets:(e,t)=>un(e,t,!1)},resolver:{test:e=>{const t=e.split("?")[0].split("."),r=t.pop(),n=t.pop();return"json"===r&&sn.includes(n)},parse:e=>{const t=e.split(".");return{resolution:parseFloat(n.W0.RETINA_PREFIX.exec(e)?.[1]??"1"),format:t[t.length-2],src:e}}},loader:{name:"spritesheetLoader",extension:{type:n.Ag.LoadParser,priority:Z.Normal},testParse:async(e,t)=>".json"===n.Wp.path.extname(t.src).toLowerCase()&&!!e.frames,async parse(e,t,r){const{texture:i,imageFilename:o,cachePrefix:a}=t?.data??{};let s,u=n.Wp.path.dirname(t.src);if(u&&u.lastIndexOf("/")!==u.length-1&&(u+="/"),i&&i.baseTexture)s=i;else{const n=je(u+(o??e.meta.image),t.src);s=(await r.load([n]))[n]}const l=new an({texture:s.baseTexture,data:e,resolutionFilename:t.src,cachePrefix:a});await l.parse();const h=e?.meta?.related_multi_packs;if(Array.isArray(h)){const e=[];for(const n of h){if("string"!=typeof n)continue;let i=u+n;t.data?.ignoreMultiPack||(i=je(i,t.src),e.push(r.load({src:i,data:{ignoreMultiPack:!0}})))}const n=await Promise.all(e);l.linkedSheets=n,n.forEach((e=>{e.linkedSheets=[l].concat(l.linkedSheets.filter((t=>t!==e)))}))}return l},unload(e){e.destroy(!0)}}};n.XO.add(ln);class hn{constructor(){this.info=[],this.common=[],this.page=[],this.char=[],this.kerning=[],this.distanceField=[]}}class cn{static test(e){return"string"==typeof e&&e.startsWith("info face=")}static parse(e){const t=e.match(/^[a-z]+\s+.+$/gm),r={info:[],common:[],page:[],char:[],chars:[],kerning:[],kernings:[],distanceField:[]};for(const e in t){const n=t[e].match(/^[a-z]+/gm)[0],i=t[e].match(/[a-zA-Z]+=([^\s"']+|"([^"]*)")/gm),o={};for(const e in i){const t=i[e].split("="),r=t[0],n=t[1].replace(/"/gm,""),a=parseFloat(n),s=isNaN(a)?n:a;o[r]=s}r[n].push(o)}const n=new hn;return r.info.forEach((e=>n.info.push({face:e.face,size:parseInt(e.size,10)}))),r.common.forEach((e=>n.common.push({lineHeight:parseInt(e.lineHeight,10)}))),r.page.forEach((e=>n.page.push({id:parseInt(e.id,10),file:e.file}))),r.char.forEach((e=>n.char.push({id:parseInt(e.id,10),page:parseInt(e.page,10),x:parseInt(e.x,10),y:parseInt(e.y,10),width:parseInt(e.width,10),height:parseInt(e.height,10),xoffset:parseInt(e.xoffset,10),yoffset:parseInt(e.yoffset,10),xadvance:parseInt(e.xadvance,10)}))),r.kerning.forEach((e=>n.kerning.push({first:parseInt(e.first,10),second:parseInt(e.second,10),amount:parseInt(e.amount,10)}))),r.distanceField.forEach((e=>n.distanceField.push({distanceRange:parseInt(e.distanceRange,10),fieldType:e.fieldType}))),n}}class fn{static test(e){const t=e;return"string"!=typeof e&&"getElementsByTagName"in e&&t.getElementsByTagName("page").length&&null!==t.getElementsByTagName("info")[0].getAttribute("face")}static parse(e){const t=new hn,r=e.getElementsByTagName("info"),n=e.getElementsByTagName("common"),i=e.getElementsByTagName("page"),o=e.getElementsByTagName("char"),a=e.getElementsByTagName("kerning"),s=e.getElementsByTagName("distanceField");for(let e=0;e<r.length;e++)t.info.push({face:r[e].getAttribute("face"),size:parseInt(r[e].getAttribute("size"),10)});for(let e=0;e<n.length;e++)t.common.push({lineHeight:parseInt(n[e].getAttribute("lineHeight"),10)});for(let e=0;e<i.length;e++)t.page.push({id:parseInt(i[e].getAttribute("id"),10)||0,file:i[e].getAttribute("file")});for(let e=0;e<o.length;e++){const r=o[e];t.char.push({id:parseInt(r.getAttribute("id"),10),page:parseInt(r.getAttribute("page"),10)||0,x:parseInt(r.getAttribute("x"),10),y:parseInt(r.getAttribute("y"),10),width:parseInt(r.getAttribute("width"),10),height:parseInt(r.getAttribute("height"),10),xoffset:parseInt(r.getAttribute("xoffset"),10),yoffset:parseInt(r.getAttribute("yoffset"),10),xadvance:parseInt(r.getAttribute("xadvance"),10)})}for(let e=0;e<a.length;e++)t.kerning.push({first:parseInt(a[e].getAttribute("first"),10),second:parseInt(a[e].getAttribute("second"),10),amount:parseInt(a[e].getAttribute("amount"),10)});for(let e=0;e<s.length;e++)t.distanceField.push({fieldType:s[e].getAttribute("fieldType"),distanceRange:parseInt(s[e].getAttribute("distanceRange"),10)});return t}}class dn{static test(e){return!("string"!=typeof e||!e.includes("<font>"))&&fn.test(n.W0.ADAPTER.parseXML(e))}static parse(e){return fn.parse(n.W0.ADAPTER.parseXML(e))}}const pn=[cn,fn,dn];function yn(e){for(let t=0;t<pn.length;t++)if(pn[t].test(e))return pn[t];return null}function mn(e,t,r,i,o,a,s){const u=r.text,l=r.fontProperties;t.translate(i,o),t.scale(a,a);const h=s.strokeThickness/2,c=-s.strokeThickness/2;if(t.font=s.toFontString(),t.lineWidth=s.strokeThickness,t.textBaseline=s.textBaseline,t.lineJoin=s.lineJoin,t.miterLimit=s.miterLimit,t.fillStyle=function(e,t,r,n,i,o){const a=r.fill;if(!Array.isArray(a))return a;if(1===a.length)return a[0];let s;const u=r.dropShadow?r.dropShadowDistance:0,l=r.padding||0,h=e.width/n-u-2*l,c=e.height/n-u-2*l,f=a.slice(),d=r.fillGradientStops.slice();if(!d.length){const e=f.length+1;for(let t=1;t<e;++t)d.push(t/e)}if(f.unshift(a[0]),d.unshift(0),f.push(a[a.length-1]),d.push(1),r.fillGradientType===Er.LINEAR_VERTICAL){s=t.createLinearGradient(h/2,l,h/2,c+l);let e=0;const n=(o.fontProperties.fontSize+r.strokeThickness)/c;for(let t=0;t<i.length;t++){const r=o.lineHeight*t;for(let t=0;t<f.length;t++){let i=0;i="number"==typeof d[t]?d[t]:t/f.length;const o=r/c+i*n;let a=Math.max(e,o);a=Math.min(a,1),s.addColorStop(a,f[t]),e=a}}}else{s=t.createLinearGradient(l,c/2,h+l,c/2);const e=f.length+1;let r=1;for(let t=0;t<f.length;t++){let n;n="number"==typeof d[t]?d[t]:r/e,s.addColorStop(n,f[t]),r++}}return s}(e,t,s,a,[u],r),t.strokeStyle=s.stroke,s.dropShadow){const e=s.dropShadowColor,r=s.dropShadowBlur*a,i=s.dropShadowDistance*a;t.shadowColor=n.Q1.shared.setValue(e).setAlpha(s.dropShadowAlpha).toRgbaString(),t.shadowBlur=r,t.shadowOffsetX=Math.cos(s.dropShadowAngle)*i,t.shadowOffsetY=Math.sin(s.dropShadowAngle)*i}else t.shadowColor="black",t.shadowBlur=0,t.shadowOffsetX=0,t.shadowOffsetY=0;s.stroke&&s.strokeThickness&&t.strokeText(u,h,c+r.lineHeight-l.descent),s.fill&&t.fillText(u,h,c+r.lineHeight-l.descent),t.setTransform(1,0,0,1,0,0),t.fillStyle="rgba(0, 0, 0, 0)"}function gn(e){return Array.from?Array.from(e):e.split("")}function wn(e){return e.codePointAt?e.codePointAt(0):e.charCodeAt(0)}const vn=class e{constructor(e,t,r){const[i]=e.info,[o]=e.common,[a]=e.page,[s]=e.distanceField,u=n.Wp.getResolutionOfUrl(a.file),l={};this._ownsTextures=r,this.font=i.face,this.size=i.size,this.lineHeight=o.lineHeight/u,this.chars={},this.pageTextures=l;for(let r=0;r<e.page.length;r++){const{id:i,file:o}=e.page[r];l[i]=t instanceof Array?t[r]:t[o],s?.fieldType&&"none"!==s.fieldType&&(l[i].baseTexture.alphaMode=n.Gk.NO_PREMULTIPLIED_ALPHA,l[i].baseTexture.mipmap=n.E8.OFF)}for(let t=0;t<e.char.length;t++){const{id:r,page:i}=e.char[t];let{x:o,y:a,width:s,height:h,xoffset:c,yoffset:f,xadvance:d}=e.char[t];o/=u,a/=u,s/=u,h/=u,c/=u,f/=u,d/=u;const p=new n.M_(o+l[i].frame.x/u,a+l[i].frame.y/u,s,h);this.chars[r]={xOffset:c,yOffset:f,xAdvance:d,kerning:{},texture:new n.gP(l[i].baseTexture,p),page:i}}for(let t=0;t<e.kerning.length;t++){let{first:r,second:n,amount:i}=e.kerning[t];r/=u,n/=u,i/=u,this.chars[n]&&(this.chars[n].kerning[r]=i)}this.distanceFieldRange=s?.distanceRange,this.distanceFieldType=s?.fieldType?.toLowerCase()??"none"}destroy(){for(const e in this.chars)this.chars[e].texture.destroy(),this.chars[e].texture=null;for(const e in this.pageTextures)this._ownsTextures&&this.pageTextures[e].destroy(!0),this.pageTextures[e]=null;this.chars=null,this.pageTextures=null}static install(t,r,i){let o;if(t instanceof hn)o=t;else{const e=yn(t);if(!e)throw new Error("Unrecognized data format for font.");o=e.parse(t)}r instanceof n.gP&&(r=[r]);const a=new e(o,r,i);return e.available[a.font]=a,a}static uninstall(t){const r=e.available[t];if(!r)throw new Error(`No font found named '${t}'`);r.destroy(),delete e.available[t]}static from(t,r,i){if(!t)throw new Error("[BitmapFont] Property `name` is required.");const{chars:o,padding:a,resolution:s,textureWidth:u,textureHeight:l,...h}=Object.assign({},e.defaultOptions,i),c=function(e){"string"==typeof e&&(e=[e]);const t=[];for(let r=0,n=e.length;r<n;r++){const n=e[r];if(Array.isArray(n)){if(2!==n.length)throw new Error(`[BitmapFont]: Invalid character range length, expecting 2 got ${n.length}.`);const e=n[0].charCodeAt(0),r=n[1].charCodeAt(0);if(r<e)throw new Error("[BitmapFont]: Invalid character range.");for(let n=e,i=r;n<=i;n++)t.push(String.fromCharCode(n))}else t.push(...gn(n))}if(0===t.length)throw new Error("[BitmapFont]: Empty set when resolving characters.");return t}(o),f=r instanceof Cr?r:new Cr(r),d=u,p=new hn;p.info[0]={face:f.fontFamily,size:f.fontSize},p.common[0]={lineHeight:f.fontSize};let y,m,g,w=0,v=0,b=0;const x=[],_=[];for(let e=0;e<c.length;e++){y||(y=n.W0.ADAPTER.createCanvas(),y.width=u,y.height=l,m=y.getContext("2d"),g=new n.t5(y,{resolution:s,...h}),x.push(g),_.push(new n.gP(g)),p.page.push({id:_.length-1,file:""}));const t=c[e],r=Ir.measureText(t,f,!1,y),i=r.width,o=Math.ceil(r.height),S=Math.ceil(("italic"===f.fontStyle?2:1)*i);if(v>=l-o*s){if(0===v)throw new Error(`[BitmapFont] textureHeight ${l}px is too small (fontFamily: '${f.fontFamily}', fontSize: ${f.fontSize}px, char: '${t}')`);--e,y=null,m=null,g=null,v=0,w=0,b=0;continue}if(b=Math.max(o+r.fontProperties.descent,b),S*s+w>=d){if(0===w)throw new Error(`[BitmapFont] textureWidth ${u}px is too small (fontFamily: '${f.fontFamily}', fontSize: ${f.fontSize}px, char: '${t}')`);--e,v+=b*s,v=Math.ceil(v),w=0,b=0;continue}mn(y,m,r,w,v,s,f);const T=wn(r.text);p.char.push({id:T,page:_.length-1,x:w/s,y:v/s,width:S,height:o,xoffset:0,yoffset:0,xadvance:i-(f.dropShadow?f.dropShadowDistance:0)-(f.stroke?f.strokeThickness:0)}),w+=(S+2*a)*s,w=Math.ceil(w)}if(!i?.skipKerning)for(let e=0,t=c.length;e<t;e++){const r=c[e];for(let e=0;e<t;e++){const t=c[e],n=m.measureText(r).width,i=m.measureText(t).width,o=m.measureText(r+t).width-(n+i);o&&p.kerning.push({first:wn(r),second:wn(t),amount:o})}}const S=new e(p,_,!0);return void 0!==e.available[t]&&e.uninstall(t),e.available[t]=S,S}};vn.ALPHA=[["a","z"],["A","Z"]," "],vn.NUMERIC=[["0","9"]],vn.ALPHANUMERIC=[["a","z"],["A","Z"],["0","9"]," "],vn.ASCII=[[" ","~"]],vn.defaultOptions={resolution:1,textureWidth:512,textureHeight:512,padding:4,chars:vn.ALPHANUMERIC},vn.available={};let bn=vn;const xn=[],_n=[],Sn=[],Tn=class e extends h{constructor(t,r={}){super();const{align:i,tint:o,maxWidth:a,letterSpacing:s,fontName:u,fontSize:l}=Object.assign({},e.styleDefaults,r);if(!bn.available[u])throw new Error(`Missing BitmapFont "${u}"`);this._activePagesMeshData=[],this._textWidth=0,this._textHeight=0,this._align=i,this._tintColor=new n.Q1(o),this._font=void 0,this._fontName=u,this._fontSize=l,this.text=t,this._maxWidth=a,this._maxLineHeight=0,this._letterSpacing=s,this._anchor=new n.oA((()=>{this.dirty=!0}),this,0,0),this._roundPixels=n.W0.ROUND_PIXELS,this.dirty=!0,this._resolution=n.W0.RESOLUTION,this._autoResolution=!0,this._textureCache={}}updateText(){const e=bn.available[this._fontName],t=this.fontSize,r=t/e.size,i=new n.bR,o=[],a=[],s=[],u=gn(this._text.replace(/(?:\r\n|\r)/g,"\n")||" "),l=this._maxWidth*e.size/t,h="none"===e.distanceFieldType?xn:_n;let c=null,f=0,d=0,p=0,y=-1,m=0,g=0,w=0,v=0;for(let t=0;t<u.length;t++){const r=u[t],h=wn(r);if(/(?:\s)/.test(r)&&(y=t,m=f,v++),"\r"===r||"\n"===r){a.push(f),s.push(-1),d=Math.max(d,f),++p,++g,i.x=0,i.y+=e.lineHeight,c=null,v=0;continue}const b=e.chars[h];if(!b)continue;c&&b.kerning[c]&&(i.x+=b.kerning[c]);const x=Sn.pop()||{texture:n.gP.EMPTY,line:0,charCode:0,prevSpaces:0,position:new n.bR};x.texture=b.texture,x.line=p,x.charCode=h,x.position.x=Math.round(i.x+b.xOffset+this._letterSpacing/2),x.position.y=Math.round(i.y+b.yOffset),x.prevSpaces=v,o.push(x),f=x.position.x+Math.max(b.xAdvance-b.xOffset,b.texture.orig.width),i.x+=b.xAdvance+this._letterSpacing,w=Math.max(w,b.yOffset+b.texture.height),c=h,-1!==y&&l>0&&i.x>l&&(++g,n.Wp.removeItems(o,1+y-g,1+t-y),t=y,y=-1,a.push(m),s.push(o.length>0?o[o.length-1].prevSpaces:0),d=Math.max(d,m),p++,i.x=0,i.y+=e.lineHeight,c=null,v=0)}const b=u[u.length-1];"\r"!==b&&"\n"!==b&&(/(?:\s)/.test(b)&&(f=m),a.push(f),d=Math.max(d,f),s.push(-1));const x=[];for(let e=0;e<=p;e++){let t=0;"right"===this._align?t=d-a[e]:"center"===this._align?t=(d-a[e])/2:"justify"===this._align&&(t=s[e]<0?0:(d-a[e])/s[e]),x.push(t)}const _=o.length,S={},T=[],E=this._activePagesMeshData;h.push(...E);for(let t=0;t<_;t++){const r=o[t].texture,i=r.baseTexture.uid;if(!S[i]){let t=h.pop();if(!t){const r=new pr;let i,o;"none"===e.distanceFieldType?(i=new yr(n.gP.EMPTY),o=n.B9.NORMAL):(i=new yr(n.gP.EMPTY,{program:n.BP.from("// Mesh material default fragment\r\nattribute vec2 aVertexPosition;\r\nattribute vec2 aTextureCoord;\r\n\r\nuniform mat3 projectionMatrix;\r\nuniform mat3 translationMatrix;\r\nuniform mat3 uTextureMatrix;\r\n\r\nvarying vec2 vTextureCoord;\r\n\r\nvoid main(void)\r\n{\r\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\r\n\r\n    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;\r\n}\r\n","// Pixi texture info\r\nvarying vec2 vTextureCoord;\r\nuniform sampler2D uSampler;\r\n\r\n// Tint\r\nuniform vec4 uColor;\r\n\r\n// on 2D applications fwidth is screenScale / glyphAtlasScale * distanceFieldRange\r\nuniform float uFWidth;\r\n\r\nvoid main(void) {\r\n\r\n  // To stack MSDF and SDF we need a non-pre-multiplied-alpha texture.\r\n  vec4 texColor = texture2D(uSampler, vTextureCoord);\r\n\r\n  // MSDF\r\n  float median = texColor.r + texColor.g + texColor.b -\r\n                  min(texColor.r, min(texColor.g, texColor.b)) -\r\n                  max(texColor.r, max(texColor.g, texColor.b));\r\n  // SDF\r\n  median = min(median, texColor.a);\r\n\r\n  float screenPxDistance = uFWidth * (median - 0.5);\r\n  float alpha = clamp(screenPxDistance + 0.5, 0.0, 1.0);\r\n  if (median < 0.01) {\r\n    alpha = 0.0;\r\n  } else if (median > 0.99) {\r\n    alpha = 1.0;\r\n  }\r\n\r\n  // Gamma correction for coverage-like alpha\r\n  float luma = dot(uColor.rgb, vec3(0.299, 0.587, 0.114));\r\n  float gamma = mix(1.0, 1.0 / 2.2, luma);\r\n  float coverage = pow(uColor.a * alpha, gamma);  \r\n\r\n  // NPM Textures, NPM outputs\r\n  gl_FragColor = vec4(uColor.rgb, coverage);\r\n}\r\n"),uniforms:{uFWidth:0}}),o=n.B9.NORMAL_NPM);const a=new dr(r,i);a.blendMode=o,t={index:0,indexCount:0,vertexCount:0,uvsCount:0,total:0,mesh:a,vertices:null,uvs:null,indices:null}}t.index=0,t.indexCount=0,t.vertexCount=0,t.uvsCount=0,t.total=0;const{_textureCache:o}=this;o[i]=o[i]||new n.gP(r.baseTexture),t.mesh.texture=o[i],t.mesh.tint=this._tintColor.value,T.push(t),S[i]=t}S[i].total++}for(let e=0;e<E.length;e++)T.includes(E[e])||this.removeChild(E[e].mesh);for(let e=0;e<T.length;e++)T[e].mesh.parent!==this&&this.addChild(T[e].mesh);this._activePagesMeshData=T;for(const e in S){const t=S[e],r=t.total;if(!(t.indices?.length>6*r)||t.vertices.length<2*dr.BATCHABLE_SIZE)t.vertices=new Float32Array(8*r),t.uvs=new Float32Array(8*r),t.indices=new Uint16Array(6*r);else{const e=t.total,r=t.vertices;for(let t=4*e*2;t<r.length;t++)r[t]=0}t.mesh.size=6*r}for(let e=0;e<_;e++){const t=o[e];let n=t.position.x+x[t.line]*("justify"===this._align?t.prevSpaces:1);this._roundPixels&&(n=Math.round(n));const i=n*r,a=t.position.y*r,s=t.texture,u=S[s.baseTexture.uid],l=s.frame,h=s._uvs,c=u.index++;u.indices[6*c+0]=0+4*c,u.indices[6*c+1]=1+4*c,u.indices[6*c+2]=2+4*c,u.indices[6*c+3]=0+4*c,u.indices[6*c+4]=2+4*c,u.indices[6*c+5]=3+4*c,u.vertices[8*c+0]=i,u.vertices[8*c+1]=a,u.vertices[8*c+2]=i+l.width*r,u.vertices[8*c+3]=a,u.vertices[8*c+4]=i+l.width*r,u.vertices[8*c+5]=a+l.height*r,u.vertices[8*c+6]=i,u.vertices[8*c+7]=a+l.height*r,u.uvs[8*c+0]=h.x0,u.uvs[8*c+1]=h.y0,u.uvs[8*c+2]=h.x1,u.uvs[8*c+3]=h.y1,u.uvs[8*c+4]=h.x2,u.uvs[8*c+5]=h.y2,u.uvs[8*c+6]=h.x3,u.uvs[8*c+7]=h.y3}this._textWidth=d*r,this._textHeight=(i.y+e.lineHeight)*r;for(const e in S){const t=S[e];if(0!==this.anchor.x||0!==this.anchor.y){let e=0;const r=this._textWidth*this.anchor.x,n=this._textHeight*this.anchor.y;for(let i=0;i<t.total;i++)t.vertices[e++]-=r,t.vertices[e++]-=n,t.vertices[e++]-=r,t.vertices[e++]-=n,t.vertices[e++]-=r,t.vertices[e++]-=n,t.vertices[e++]-=r,t.vertices[e++]-=n}this._maxLineHeight=w*r;const n=t.mesh.geometry.getBuffer("aVertexPosition"),i=t.mesh.geometry.getBuffer("aTextureCoord"),o=t.mesh.geometry.getIndex();n.data=t.vertices,i.data=t.uvs,o.data=t.indices,n.update(),i.update(),o.update()}for(let e=0;e<o.length;e++)Sn.push(o[e]);this._font=e,this.dirty=!1}updateTransform(){this.validate(),this.containerUpdateTransform()}_render(e){this._autoResolution&&this._resolution!==e.resolution&&(this._resolution=e.resolution,this.dirty=!0);const{distanceFieldRange:t,distanceFieldType:r,size:n}=bn.available[this._fontName];if("none"!==r){const{a:r,b:i,c:o,d:a}=this.worldTransform,s=Math.sqrt(r*r+i*i),u=Math.sqrt(o*o+a*a),l=(Math.abs(s)+Math.abs(u))/2,h=this.fontSize/n,c=e._view.resolution;for(const e of this._activePagesMeshData)e.mesh.shader.uniforms.uFWidth=l*t*h*c}super._render(e)}getLocalBounds(){return this.validate(),super.getLocalBounds()}validate(){const e=bn.available[this._fontName];if(!e)throw new Error(`Missing BitmapFont "${this._fontName}"`);this._font!==e&&(this.dirty=!0),this.dirty&&this.updateText()}get tint(){return this._tintColor.value}set tint(e){if(this.tint!==e){this._tintColor.setValue(e);for(let t=0;t<this._activePagesMeshData.length;t++)this._activePagesMeshData[t].mesh.tint=e}}get align(){return this._align}set align(e){this._align!==e&&(this._align=e,this.dirty=!0)}get fontName(){return this._fontName}set fontName(e){if(!bn.available[e])throw new Error(`Missing BitmapFont "${e}"`);this._fontName!==e&&(this._fontName=e,this.dirty=!0)}get fontSize(){return this._fontSize??bn.available[this._fontName].size}set fontSize(e){this._fontSize!==e&&(this._fontSize=e,this.dirty=!0)}get anchor(){return this._anchor}set anchor(e){"number"==typeof e?this._anchor.set(e):this._anchor.copyFrom(e)}get text(){return this._text}set text(e){e=String(e??""),this._text!==e&&(this._text=e,this.dirty=!0)}get maxWidth(){return this._maxWidth}set maxWidth(e){this._maxWidth!==e&&(this._maxWidth=e,this.dirty=!0)}get maxLineHeight(){return this.validate(),this._maxLineHeight}get textWidth(){return this.validate(),this._textWidth}get letterSpacing(){return this._letterSpacing}set letterSpacing(e){this._letterSpacing!==e&&(this._letterSpacing=e,this.dirty=!0)}get roundPixels(){return this._roundPixels}set roundPixels(e){e!==this._roundPixels&&(this._roundPixels=e,this.dirty=!0)}get textHeight(){return this.validate(),this._textHeight}get resolution(){return this._resolution}set resolution(e){this._autoResolution=!1,this._resolution!==e&&(this._resolution=e,this.dirty=!0)}destroy(e){const{_textureCache:t}=this,r="none"===bn.available[this._fontName].distanceFieldType?xn:_n;r.push(...this._activePagesMeshData);for(const e of this._activePagesMeshData)this.removeChild(e.mesh);this._activePagesMeshData=[],r.filter((e=>t[e.mesh.texture.baseTexture.uid])).forEach((e=>{e.mesh.texture=n.gP.EMPTY}));for(const e in t)t[e].destroy(),delete t[e];this._font=null,this._tintColor=null,this._textureCache=null,super.destroy(e)}};Tn.styleDefaults={align:"left",tint:16777215,maxWidth:0,letterSpacing:0};let En=Tn;const On=[".xml",".fnt"],An={extension:{type:n.Ag.LoadParser,priority:Z.Normal},name:"loadBitmapFont",test:e=>On.includes(n.Wp.path.extname(e).toLowerCase()),testParse:async e=>cn.test(e)||dn.test(e),async parse(e,t,r){const i=cn.test(e)?cn.parse(e):dn.parse(e),{src:o}=t,{page:a}=i,s=[];for(let e=0;e<a.length;++e){const t=a[e].file;let r=n.Wp.path.join(n.Wp.path.dirname(o),t);r=je(r,o),s.push(r)}const u=await r.load(s),l=s.map((e=>u[e]));return bn.install(i,l,!0)},load:async(e,t)=>(await n.W0.ADAPTER.fetch(e)).text(),unload(e){e.destroy()}};n.XO.add(An);const In=class e extends Cr{constructor(){super(...arguments),this._fonts=[],this._overrides=[],this._stylesheet="",this.fontsDirty=!1}static from(t){return new e(Object.keys(e.defaultOptions).reduce(((e,r)=>({...e,[r]:t[r]})),{}))}cleanFonts(){this._fonts.length>0&&(this._fonts.forEach((t=>{URL.revokeObjectURL(t.src),t.refs--,0===t.refs&&(t.fontFace&&document.fonts.delete(t.fontFace),delete e.availableFonts[t.originalUrl])})),this.fontFamily="Arial",this._fonts.length=0,this.styleID++,this.fontsDirty=!0)}loadFont(t,r={}){const{availableFonts:i}=e;if(i[t]){const e=i[t];return this._fonts.push(e),e.refs++,this.styleID++,this.fontsDirty=!0,Promise.resolve()}return n.W0.ADAPTER.fetch(t).then((e=>e.blob())).then((async e=>new Promise(((t,r)=>{const n=URL.createObjectURL(e),i=new FileReader;i.onload=()=>t([n,i.result]),i.onerror=r,i.readAsDataURL(e)})))).then((async([e,o])=>{const a=Object.assign({family:n.Wp.path.basename(t,n.Wp.path.extname(t)),weight:"normal",style:"normal",display:"auto",src:e,dataSrc:o,refs:1,originalUrl:t,fontFace:null},r);i[t]=a,this._fonts.push(a),this.styleID++;const s=new FontFace(a.family,`url(${a.src})`,{weight:a.weight,style:a.style,display:a.display});a.fontFace=s,await s.load(),document.fonts.add(s),await document.fonts.ready,this.styleID++,this.fontsDirty=!0}))}addOverride(...e){const t=e.filter((e=>!this._overrides.includes(e)));t.length>0&&(this._overrides.push(...t),this.styleID++)}removeOverride(...e){const t=e.filter((e=>this._overrides.includes(e)));t.length>0&&(this._overrides=this._overrides.filter((e=>!t.includes(e))),this.styleID++)}toCSS(e){return[`transform: scale(${e})`,"transform-origin: top left","display: inline-block",`color: ${this.normalizeColor(this.fill)}`,`font-size: ${this.fontSize}px`,`font-family: ${this.fontFamily}`,`font-weight: ${this.fontWeight}`,`font-style: ${this.fontStyle}`,`font-variant: ${this.fontVariant}`,`letter-spacing: ${this.letterSpacing}px`,`text-align: ${this.align}`,`padding: ${this.padding}px`,`white-space: ${this.whiteSpace}`,...this.lineHeight?[`line-height: ${this.lineHeight}px`]:[],...this.wordWrap?["word-wrap: "+(this.breakWords?"break-all":"break-word"),`max-width: ${this.wordWrapWidth}px`]:[],...this.strokeThickness?[`-webkit-text-stroke-width: ${this.strokeThickness}px`,`-webkit-text-stroke-color: ${this.normalizeColor(this.stroke)}`,`text-stroke-width: ${this.strokeThickness}px`,`text-stroke-color: ${this.normalizeColor(this.stroke)}`,"paint-order: stroke"]:[],...this.dropShadow?[this.dropShadowToCSS()]:[],...this._overrides].join(";")}toGlobalCSS(){return this._fonts.reduce(((e,t)=>`${e}\n            @font-face {\n                font-family: "${t.family}";\n                src: url('${t.dataSrc}');\n                font-weight: ${t.weight};\n                font-style: ${t.style};\n                font-display: ${t.display};\n            }`),this._stylesheet)}get stylesheet(){return this._stylesheet}set stylesheet(e){this._stylesheet!==e&&(this._stylesheet=e,this.styleID++)}normalizeColor(e){return Array.isArray(e)&&(e=n.Wp.rgb2hex(e)),"number"==typeof e?n.Wp.hex2string(e):e}dropShadowToCSS(){let e=this.normalizeColor(this.dropShadowColor);const t=this.dropShadowAlpha,r=Math.round(Math.cos(this.dropShadowAngle)*this.dropShadowDistance),n=Math.round(Math.sin(this.dropShadowAngle)*this.dropShadowDistance);e.startsWith("#")&&t<1&&(e+=(255*t|0).toString(16).padStart(2,"0"));const i=`${r}px ${n}px`;return this.dropShadowBlur>0?`text-shadow: ${i} ${this.dropShadowBlur}px ${e}`:`text-shadow: ${i} ${e}`}reset(){Object.assign(this,e.defaultOptions)}onBeforeDraw(){const{fontsDirty:e}=this;return this.fontsDirty=!1,this.isSafari&&this._fonts.length>0&&e?new Promise((e=>setTimeout(e,100))):Promise.resolve()}get isSafari(){const{userAgent:e}=n.W0.ADAPTER.getNavigator();return/^((?!chrome|android).)*safari/i.test(e)}set fillGradientStops(e){console.warn("[HTMLTextStyle] fillGradientStops is not supported by HTMLText")}get fillGradientStops(){return super.fillGradientStops}set fillGradientType(e){console.warn("[HTMLTextStyle] fillGradientType is not supported by HTMLText")}get fillGradientType(){return super.fillGradientType}set miterLimit(e){console.warn("[HTMLTextStyle] miterLimit is not supported by HTMLText")}get miterLimit(){return super.miterLimit}set trim(e){console.warn("[HTMLTextStyle] trim is not supported by HTMLText")}get trim(){return super.trim}set textBaseline(e){console.warn("[HTMLTextStyle] textBaseline is not supported by HTMLText")}get textBaseline(){return super.textBaseline}set leading(e){console.warn("[HTMLTextStyle] leading is not supported by HTMLText")}get leading(){return super.leading}set lineJoin(e){console.warn("[HTMLTextStyle] lineJoin is not supported by HTMLText")}get lineJoin(){return super.lineJoin}};In.availableFonts={},In.defaultOptions={align:"left",breakWords:!1,dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"black",dropShadowDistance:5,fill:"black",fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",letterSpacing:0,lineHeight:0,padding:0,stroke:"black",strokeThickness:0,whiteSpace:"normal",wordWrap:!1,wordWrapWidth:100};let Pn=In;const kn=class e extends d{constructor(t="",r={}){super(n.gP.EMPTY),this._text=null,this._style=null,this._autoResolution=!0,this.localStyleID=-1,this.dirty=!1,this._updateID=0,this.ownsStyle=!1;const i=new Image,o=n.gP.from(i,{scaleMode:n.W0.SCALE_MODE,resourceOptions:{autoLoad:!1}});o.orig=new n.M_,o.trim=new n.M_,this.texture=o;const a="http://www.w3.org/2000/svg",s="http://www.w3.org/1999/xhtml",u=document.createElementNS(a,"svg"),l=document.createElementNS(a,"foreignObject"),h=document.createElementNS(s,"div"),c=document.createElementNS(s,"style");l.setAttribute("width","10000"),l.setAttribute("height","10000"),l.style.overflow="hidden",u.appendChild(l),this.maxWidth=e.defaultMaxWidth,this.maxHeight=e.defaultMaxHeight,this._domElement=h,this._styleElement=c,this._svgRoot=u,this._foreignObject=l,this._foreignObject.appendChild(c),this._foreignObject.appendChild(h),this._image=i,this._loadImage=new Image,this._autoResolution=e.defaultAutoResolution,this._resolution=e.defaultResolution??n.W0.RESOLUTION,this.text=t,this.style=r}measureText(e){const{text:t,style:r,resolution:n}=Object.assign({text:this._text,style:this._style,resolution:this._resolution},e);Object.assign(this._domElement,{innerHTML:t,style:r.toCSS(n)}),this._styleElement.textContent=r.toGlobalCSS(),document.body.appendChild(this._svgRoot);const i=this._domElement.getBoundingClientRect();this._svgRoot.remove();const{width:o,height:a}=i;(o>this.maxWidth||a>this.maxHeight)&&console.warn("[HTMLText] Large expanse of text, increase HTMLText.maxWidth or HTMLText.maxHeight property.");const s=Math.min(this.maxWidth,Math.ceil(o)),u=Math.min(this.maxHeight,Math.ceil(a));return this._svgRoot.setAttribute("width",s.toString()),this._svgRoot.setAttribute("height",u.toString()),t!==this._text&&(this._domElement.innerHTML=this._text),r!==this._style&&(Object.assign(this._domElement,{style:this._style?.toCSS(n)}),this._styleElement.textContent=this._style?.toGlobalCSS()),{width:s+2*r.padding,height:u+2*r.padding}}async updateText(e=!0){const{style:t,_image:r,_loadImage:n}=this;if(this.localStyleID!==t.styleID&&(this.dirty=!0,this.localStyleID=t.styleID),!this.dirty&&e)return;const{width:i,height:o}=this.measureText();r.width=n.width=Math.ceil(Math.max(1,i)),r.height=n.height=Math.ceil(Math.max(1,o)),this._updateID++;const a=this._updateID;await new Promise((e=>{n.onload=async()=>{a<this._updateID||(await t.onBeforeDraw(),r.src=n.src,n.onload=null,n.src="",this.updateTexture()),e()};const i=(new XMLSerializer).serializeToString(this._svgRoot);n.src=`data:image/svg+xml;charset=utf8,${encodeURIComponent(i)}`}))}get source(){return this._image}updateTexture(){const{style:e,texture:t,_image:r,resolution:n}=this,{padding:i}=e,{baseTexture:o}=t;t.trim.width=t._frame.width=r.width/n,t.trim.height=t._frame.height=r.height/n,t.trim.x=-i,t.trim.y=-i,t.orig.width=t._frame.width-2*i,t.orig.height=t._frame.height-2*i,this._onTextureUpdate(),o.setRealSize(r.width,r.height,n),this.dirty=!1}_render(e){this._autoResolution&&this._resolution!==e.resolution&&(this._resolution=e.resolution,this.dirty=!0),this.updateText(!0),super._render(e)}_renderCanvas(e){this._autoResolution&&this._resolution!==e.resolution&&(this._resolution=e.resolution,this.dirty=!0),this.updateText(!0),super._renderCanvas(e)}getLocalBounds(e){return this.updateText(!0),super.getLocalBounds(e)}_calculateBounds(){this.updateText(!0),this.calculateVertices(),this._bounds.addQuad(this.vertexData)}_onStyleChange(){this.dirty=!0}destroy(t){"boolean"==typeof t&&(t={children:t}),t=Object.assign({},e.defaultDestroyOptions,t),super.destroy(t);const r=null;this.ownsStyle&&this._style?.cleanFonts(),this._style=r,this._svgRoot?.remove(),this._svgRoot=r,this._domElement?.remove(),this._domElement=r,this._foreignObject?.remove(),this._foreignObject=r,this._styleElement?.remove(),this._styleElement=r,this._loadImage.src="",this._loadImage.onload=null,this._loadImage=r,this._image.src="",this._image=r}get width(){return this.updateText(!0),Math.abs(this.scale.x)*this._image.width/this.resolution}set width(e){this.updateText(!0);const t=n.Wp.sign(this.scale.x)||1;this.scale.x=t*e/this._image.width/this.resolution,this._width=e}get height(){return this.updateText(!0),Math.abs(this.scale.y)*this._image.height/this.resolution}set height(e){this.updateText(!0);const t=n.Wp.sign(this.scale.y)||1;this.scale.y=t*e/this._image.height/this.resolution,this._height=e}get style(){return this._style}set style(e){this._style!==e&&((e=e||{})instanceof Pn?(this.ownsStyle=!1,this._style=e):e instanceof Cr?(console.warn("[HTMLText] Cloning TextStyle, if this is not what you want, use HTMLTextStyle"),this.ownsStyle=!0,this._style=Pn.from(e)):(this.ownsStyle=!0,this._style=new Pn(e)),this.localStyleID=-1,this.dirty=!0)}get text(){return this._text}set text(e){e=String(""===e||null==e?" ":e),e=this.sanitiseText(e),this._text!==e&&(this._text=e,this.dirty=!0)}get resolution(){return this._resolution}set resolution(e){this._autoResolution=!1,this._resolution!==e&&(this._resolution=e,this.dirty=!0)}sanitiseText(e){return e.replace(/<br>/gi,"<br/>").replace(/<hr>/gi,"<hr/>").replace(/&nbsp;/gi,"&#160;")}};kn.defaultDestroyOptions={texture:!0,children:!1,baseTexture:!0},kn.defaultMaxWidth=2024,kn.defaultMaxHeight=2024,kn.defaultAutoResolution=!0;let Cn=kn}},__webpack_module_cache__={};function __webpack_require__(e){var t=__webpack_module_cache__[e];if(void 0!==t)return t.exports;var r=__webpack_module_cache__[e]={id:e,loaded:!1,exports:{}};return __webpack_modules__[e].call(r.exports,r,r.exports,__webpack_require__),r.loaded=!0,r.exports}__webpack_require__.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return __webpack_require__.d(t,{a:t}),t},__webpack_require__.d=(e,t)=>{for(var r in t)__webpack_require__.o(t,r)&&!__webpack_require__.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},__webpack_require__.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),__webpack_require__.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),__webpack_require__.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},__webpack_require__.nmd=e=>(e.paths=[],e.children||(e.children=[]),e);var __webpack_exports__={},_tsvb__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(7940);window.tsvb=_tsvb__WEBPACK_IMPORTED_MODULE_0__.o;